System.register([],(function(e,t){"use strict";return{execute:function(){var n=document.createElement("style");function i(e,t){for(var n=0;n<t.length;n++){const i=t[n];if("string"!=typeof i&&!Array.isArray(i))for(const t in i)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(i,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>i[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}n.textContent="html.ios{--ion-default-font: -apple-system, BlinkMacSystemFont, \"Helvetica Neue\", \"Roboto\", sans-serif}html.md{--ion-default-font: \"Roboto\", \"Helvetica Neue\", sans-serif}html{--ion-font-family: var(--ion-default-font)}body{background:var(--ion-background-color)}body.backdrop-no-scroll{overflow:hidden}html.ios ion-modal.modal-card ion-header ion-toolbar:first-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:first-of-type,html.ios ion-modal ion-footer ion-toolbar:first-of-type{padding-top:6px}html.ios ion-modal.modal-card ion-header ion-toolbar:last-of-type,html.ios ion-modal.modal-sheet ion-header ion-toolbar:last-of-type{padding-bottom:6px}html.ios ion-modal ion-toolbar{padding-right:calc(var(--ion-safe-area-right) + 8px);padding-left:calc(var(--ion-safe-area-left) + 8px)}@media screen and (min-width: 768px){html.ios ion-modal.modal-card:first-of-type{--backdrop-opacity: .18}}ion-modal.modal-default.show-modal~ion-modal.modal-default{--backdrop-opacity: 0;--box-shadow: none}html.ios ion-modal.modal-card .ion-page{border-top-left-radius:var(--border-radius)}.ion-color-primary{--ion-color-base: var(--ion-color-primary, #3880ff) !important;--ion-color-base-rgb: var(--ion-color-primary-rgb, 56, 128, 255) !important;--ion-color-contrast: var(--ion-color-primary-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-primary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-primary-shade, #3171e0) !important;--ion-color-tint: var(--ion-color-primary-tint, #4c8dff) !important}.ion-color-secondary{--ion-color-base: var(--ion-color-secondary, #3dc2ff) !important;--ion-color-base-rgb: var(--ion-color-secondary-rgb, 61, 194, 255) !important;--ion-color-contrast: var(--ion-color-secondary-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-secondary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-secondary-shade, #36abe0) !important;--ion-color-tint: var(--ion-color-secondary-tint, #50c8ff) !important}.ion-color-tertiary{--ion-color-base: var(--ion-color-tertiary, #5260ff) !important;--ion-color-base-rgb: var(--ion-color-tertiary-rgb, 82, 96, 255) !important;--ion-color-contrast: var(--ion-color-tertiary-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-tertiary-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-tertiary-shade, #4854e0) !important;--ion-color-tint: var(--ion-color-tertiary-tint, #6370ff) !important}.ion-color-success{--ion-color-base: var(--ion-color-success, #2dd36f) !important;--ion-color-base-rgb: var(--ion-color-success-rgb, 45, 211, 111) !important;--ion-color-contrast: var(--ion-color-success-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-success-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-success-shade, #28ba62) !important;--ion-color-tint: var(--ion-color-success-tint, #42d77d) !important}.ion-color-warning{--ion-color-base: var(--ion-color-warning, #ffc409) !important;--ion-color-base-rgb: var(--ion-color-warning-rgb, 255, 196, 9) !important;--ion-color-contrast: var(--ion-color-warning-contrast, #000) !important;--ion-color-contrast-rgb: var(--ion-color-warning-contrast-rgb, 0, 0, 0) !important;--ion-color-shade: var(--ion-color-warning-shade, #e0ac08) !important;--ion-color-tint: var(--ion-color-warning-tint, #ffca22) !important}.ion-color-danger{--ion-color-base: var(--ion-color-danger, #eb445a) !important;--ion-color-base-rgb: var(--ion-color-danger-rgb, 235, 68, 90) !important;--ion-color-contrast: var(--ion-color-danger-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-danger-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-danger-shade, #cf3c4f) !important;--ion-color-tint: var(--ion-color-danger-tint, #ed576b) !important}.ion-color-light{--ion-color-base: var(--ion-color-light, #f4f5f8) !important;--ion-color-base-rgb: var(--ion-color-light-rgb, 244, 245, 248) !important;--ion-color-contrast: var(--ion-color-light-contrast, #000) !important;--ion-color-contrast-rgb: var(--ion-color-light-contrast-rgb, 0, 0, 0) !important;--ion-color-shade: var(--ion-color-light-shade, #d7d8da) !important;--ion-color-tint: var(--ion-color-light-tint, #f5f6f9) !important}.ion-color-medium{--ion-color-base: var(--ion-color-medium, #92949c) !important;--ion-color-base-rgb: var(--ion-color-medium-rgb, 146, 148, 156) !important;--ion-color-contrast: var(--ion-color-medium-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-medium-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-medium-shade, #808289) !important;--ion-color-tint: var(--ion-color-medium-tint, #9d9fa6) !important}.ion-color-dark{--ion-color-base: var(--ion-color-dark, #222428) !important;--ion-color-base-rgb: var(--ion-color-dark-rgb, 34, 36, 40) !important;--ion-color-contrast: var(--ion-color-dark-contrast, #fff) !important;--ion-color-contrast-rgb: var(--ion-color-dark-contrast-rgb, 255, 255, 255) !important;--ion-color-shade: var(--ion-color-dark-shade, #1e2023) !important;--ion-color-tint: var(--ion-color-dark-tint, #383a3e) !important}.ion-page{left:0;right:0;top:0;bottom:0;display:flex;position:absolute;flex-direction:column;justify-content:space-between;contain:layout size style;overflow:hidden;z-index:0}ion-modal>.ion-page{position:relative;contain:layout style;height:100%}.split-pane-visible>.ion-page.split-pane-main{position:relative}ion-route,ion-route-redirect,ion-router,ion-select-option,ion-nav-controller,ion-menu-controller,ion-action-sheet-controller,ion-alert-controller,ion-loading-controller,ion-modal-controller,ion-picker-controller,ion-popover-controller,ion-toast-controller,.ion-page-hidden{display:none!important}.ion-page-invisible{opacity:0}.can-go-back>ion-header ion-back-button{display:block}html.plt-ios.plt-hybrid,html.plt-ios.plt-pwa{--ion-statusbar-padding: 20px}@supports (padding-top: 20px){html{--ion-safe-area-top: var(--ion-statusbar-padding)}}@supports (padding-top: constant(safe-area-inset-top)){html{--ion-safe-area-top: constant(safe-area-inset-top);--ion-safe-area-bottom: constant(safe-area-inset-bottom);--ion-safe-area-left: constant(safe-area-inset-left);--ion-safe-area-right: constant(safe-area-inset-right)}}@supports (padding-top: env(safe-area-inset-top)){html{--ion-safe-area-top: env(safe-area-inset-top);--ion-safe-area-bottom: env(safe-area-inset-bottom);--ion-safe-area-left: env(safe-area-inset-left);--ion-safe-area-right: env(safe-area-inset-right)}}ion-card.ion-color .ion-inherit-color,ion-card-header.ion-color .ion-inherit-color{color:inherit}.menu-content{transform:translateZ(0)}.menu-content-open{cursor:pointer;touch-action:manipulation;pointer-events:none}.ios .menu-content-reveal{box-shadow:-8px 0 42px rgba(0,0,0,.08)}[dir=rtl].ios .menu-content-reveal{box-shadow:8px 0 42px rgba(0,0,0,.08)}.md .menu-content-reveal,.md .menu-content-push{box-shadow:4px 0 16px rgba(0,0,0,.18)}ion-accordion-group.accordion-group-expand-inset>ion-accordion:first-of-type{border-top-left-radius:8px;border-top-right-radius:8px}ion-accordion-group.accordion-group-expand-inset>ion-accordion:last-of-type{border-bottom-left-radius:8px;border-bottom-right-radius:8px}ion-accordion-group>ion-accordion:last-of-type ion-item[slot=header]{--border-width: 0px}ion-accordion.accordion-animated>[slot=header] .ion-accordion-toggle-icon{transition:.3s transform cubic-bezier(.25,.8,.5,1)}@media (prefers-reduced-motion: reduce){ion-accordion .ion-accordion-toggle-icon{transition:none!important}}ion-accordion.accordion-expanding>[slot=header] .ion-accordion-toggle-icon,ion-accordion.accordion-expanded>[slot=header] .ion-accordion-toggle-icon{transform:rotate(180deg)}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-previous ion-item[slot=header]{--border-width: 0px;--inner-border-width: 0px}ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanding:first-of-type,ion-accordion-group.accordion-group-expand-inset.md>ion-accordion.accordion-expanded:first-of-type{margin-top:0}ion-input input::-webkit-date-and-time-value{text-align:start}.ion-datetime-button-overlay{--width: fit-content;--height: fit-content}.ion-datetime-button-overlay ion-datetime.datetime-grid{width:320px;min-height:320px}audio,canvas,progress,video{vertical-align:baseline}audio:not([controls]){display:none;height:0}b,strong{font-weight:700}img{max-width:100%}hr{height:1px;border-width:0;box-sizing:content-box}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}label,input,select,textarea{font-family:inherit;line-height:normal}textarea{overflow:auto;height:auto;font:inherit;color:inherit}textarea::placeholder{padding-left:2px}form,input,optgroup,select{margin:0;font:inherit;color:inherit}html input[type=button],input[type=reset],input[type=submit]{cursor:pointer;-webkit-appearance:button}a,a div,a span,a ion-icon,a ion-label,button,button div,button span,button ion-icon,button ion-label,.ion-tappable,[tappable],[tappable] div,[tappable] span,[tappable] ion-icon,[tappable] ion-label,input,textarea{touch-action:manipulation}a ion-label,button ion-label{pointer-events:none}button{padding:0;border:0;border-radius:0;font-family:inherit;font-style:inherit;font-variant:inherit;line-height:1;text-transform:none;cursor:pointer;-webkit-appearance:button}[tappable]{cursor:pointer}a[disabled],button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}*{box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none}html{width:100%;height:100%;text-size-adjust:100%}html:not(.hydrated) body{display:none}html.ion-ce body{display:block}html.plt-pwa{height:100vh}body{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:0;padding:0;position:fixed;width:100%;max-width:100%;height:100%;max-height:100%;transform:translateZ(0);text-rendering:optimizeLegibility;overflow:hidden;touch-action:manipulation;-webkit-user-drag:none;-ms-content-zooming:none;word-wrap:break-word;overscroll-behavior-y:none;text-size-adjust:none}html{font-family:var(--ion-font-family)}a{background-color:transparent;color:var(--ion-color-primary, #3880ff)}h1,h2,h3,h4,h5,h6{margin-top:16px;margin-bottom:10px;font-weight:500;line-height:1.2}h1{margin-top:20px;font-size:26px}h2{margin-top:18px;font-size:24px}h3{font-size:22px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}small{font-size:75%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}.ion-no-padding{--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0;padding:0}.ion-padding{--padding-start: var(--ion-padding, 16px);--padding-end: var(--ion-padding, 16px);--padding-top: var(--ion-padding, 16px);--padding-bottom: var(--ion-padding, 16px);-webkit-padding-start:var(--ion-padding, 16px);padding-inline-start:var(--ion-padding, 16px);-webkit-padding-end:var(--ion-padding, 16px);padding-inline-end:var(--ion-padding, 16px);padding-top:var(--ion-padding, 16px);padding-bottom:var(--ion-padding, 16px)}.ion-padding-top{--padding-top: var(--ion-padding, 16px);padding-top:var(--ion-padding, 16px)}.ion-padding-start{--padding-start: var(--ion-padding, 16px);-webkit-padding-start:var(--ion-padding, 16px);padding-inline-start:var(--ion-padding, 16px)}.ion-padding-end{--padding-end: var(--ion-padding, 16px);-webkit-padding-end:var(--ion-padding, 16px);padding-inline-end:var(--ion-padding, 16px)}.ion-padding-bottom{--padding-bottom: var(--ion-padding, 16px);padding-bottom:var(--ion-padding, 16px)}.ion-padding-vertical{--padding-top: var(--ion-padding, 16px);--padding-bottom: var(--ion-padding, 16px);padding-top:var(--ion-padding, 16px);padding-bottom:var(--ion-padding, 16px)}.ion-padding-horizontal{--padding-start: var(--ion-padding, 16px);--padding-end: var(--ion-padding, 16px);-webkit-padding-start:var(--ion-padding, 16px);padding-inline-start:var(--ion-padding, 16px);-webkit-padding-end:var(--ion-padding, 16px);padding-inline-end:var(--ion-padding, 16px)}.ion-no-margin{--margin-start: 0;--margin-end: 0;--margin-top: 0;--margin-bottom: 0;margin:0}.ion-margin{--margin-start: var(--ion-margin, 16px);--margin-end: var(--ion-margin, 16px);--margin-top: var(--ion-margin, 16px);--margin-bottom: var(--ion-margin, 16px);-webkit-margin-start:var(--ion-margin, 16px);margin-inline-start:var(--ion-margin, 16px);-webkit-margin-end:var(--ion-margin, 16px);margin-inline-end:var(--ion-margin, 16px);margin-top:var(--ion-margin, 16px);margin-bottom:var(--ion-margin, 16px)}.ion-margin-top{--margin-top: var(--ion-margin, 16px);margin-top:var(--ion-margin, 16px)}.ion-margin-start{--margin-start: var(--ion-margin, 16px);-webkit-margin-start:var(--ion-margin, 16px);margin-inline-start:var(--ion-margin, 16px)}.ion-margin-end{--margin-end: var(--ion-margin, 16px);-webkit-margin-end:var(--ion-margin, 16px);margin-inline-end:var(--ion-margin, 16px)}.ion-margin-bottom{--margin-bottom: var(--ion-margin, 16px);margin-bottom:var(--ion-margin, 16px)}.ion-margin-vertical{--margin-top: var(--ion-margin, 16px);--margin-bottom: var(--ion-margin, 16px);margin-top:var(--ion-margin, 16px);margin-bottom:var(--ion-margin, 16px)}.ion-margin-horizontal{--margin-start: var(--ion-margin, 16px);--margin-end: var(--ion-margin, 16px);-webkit-margin-start:var(--ion-margin, 16px);margin-inline-start:var(--ion-margin, 16px);-webkit-margin-end:var(--ion-margin, 16px);margin-inline-end:var(--ion-margin, 16px)}.ion-float-left{float:left!important}.ion-float-right{float:right!important}.ion-float-start{float:left!important}:host-context([dir=rtl]) .ion-float-start{float:right!important}[dir=rtl] .ion-float-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-start:dir(rtl){float:right!important}}.ion-float-end{float:right!important}:host-context([dir=rtl]) .ion-float-end{float:left!important}[dir=rtl] .ion-float-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-end:dir(rtl){float:left!important}}@media (min-width: 576px){.ion-float-sm-left{float:left!important}.ion-float-sm-right{float:right!important}.ion-float-sm-start{float:left!important}:host-context([dir=rtl]) .ion-float-sm-start{float:right!important}[dir=rtl] .ion-float-sm-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-sm-start:dir(rtl){float:right!important}}.ion-float-sm-end{float:right!important}:host-context([dir=rtl]) .ion-float-sm-end{float:left!important}[dir=rtl] .ion-float-sm-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-sm-end:dir(rtl){float:left!important}}}@media (min-width: 768px){.ion-float-md-left{float:left!important}.ion-float-md-right{float:right!important}.ion-float-md-start{float:left!important}:host-context([dir=rtl]) .ion-float-md-start{float:right!important}[dir=rtl] .ion-float-md-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-md-start:dir(rtl){float:right!important}}.ion-float-md-end{float:right!important}:host-context([dir=rtl]) .ion-float-md-end{float:left!important}[dir=rtl] .ion-float-md-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-md-end:dir(rtl){float:left!important}}}@media (min-width: 992px){.ion-float-lg-left{float:left!important}.ion-float-lg-right{float:right!important}.ion-float-lg-start{float:left!important}:host-context([dir=rtl]) .ion-float-lg-start{float:right!important}[dir=rtl] .ion-float-lg-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-lg-start:dir(rtl){float:right!important}}.ion-float-lg-end{float:right!important}:host-context([dir=rtl]) .ion-float-lg-end{float:left!important}[dir=rtl] .ion-float-lg-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-lg-end:dir(rtl){float:left!important}}}@media (min-width: 1200px){.ion-float-xl-left{float:left!important}.ion-float-xl-right{float:right!important}.ion-float-xl-start{float:left!important}:host-context([dir=rtl]) .ion-float-xl-start{float:right!important}[dir=rtl] .ion-float-xl-start{float:right!important}@supports selector(:dir(rtl)){.ion-float-xl-start:dir(rtl){float:right!important}}.ion-float-xl-end{float:right!important}:host-context([dir=rtl]) .ion-float-xl-end{float:left!important}[dir=rtl] .ion-float-xl-end{float:left!important}@supports selector(:dir(rtl)){.ion-float-xl-end:dir(rtl){float:left!important}}}.ion-text-center{text-align:center!important}.ion-text-justify{text-align:justify!important}.ion-text-start{text-align:start!important}.ion-text-end{text-align:end!important}.ion-text-left{text-align:left!important}.ion-text-right{text-align:right!important}.ion-text-nowrap{white-space:nowrap!important}.ion-text-wrap{white-space:normal!important}@media (min-width: 576px){.ion-text-sm-center{text-align:center!important}.ion-text-sm-justify{text-align:justify!important}.ion-text-sm-start{text-align:start!important}.ion-text-sm-end{text-align:end!important}.ion-text-sm-left{text-align:left!important}.ion-text-sm-right{text-align:right!important}.ion-text-sm-nowrap{white-space:nowrap!important}.ion-text-sm-wrap{white-space:normal!important}}@media (min-width: 768px){.ion-text-md-center{text-align:center!important}.ion-text-md-justify{text-align:justify!important}.ion-text-md-start{text-align:start!important}.ion-text-md-end{text-align:end!important}.ion-text-md-left{text-align:left!important}.ion-text-md-right{text-align:right!important}.ion-text-md-nowrap{white-space:nowrap!important}.ion-text-md-wrap{white-space:normal!important}}@media (min-width: 992px){.ion-text-lg-center{text-align:center!important}.ion-text-lg-justify{text-align:justify!important}.ion-text-lg-start{text-align:start!important}.ion-text-lg-end{text-align:end!important}.ion-text-lg-left{text-align:left!important}.ion-text-lg-right{text-align:right!important}.ion-text-lg-nowrap{white-space:nowrap!important}.ion-text-lg-wrap{white-space:normal!important}}@media (min-width: 1200px){.ion-text-xl-center{text-align:center!important}.ion-text-xl-justify{text-align:justify!important}.ion-text-xl-start{text-align:start!important}.ion-text-xl-end{text-align:end!important}.ion-text-xl-left{text-align:left!important}.ion-text-xl-right{text-align:right!important}.ion-text-xl-nowrap{white-space:nowrap!important}.ion-text-xl-wrap{white-space:normal!important}}.ion-text-uppercase{text-transform:uppercase!important}.ion-text-lowercase{text-transform:lowercase!important}.ion-text-capitalize{text-transform:capitalize!important}@media (min-width: 576px){.ion-text-sm-uppercase{text-transform:uppercase!important}.ion-text-sm-lowercase{text-transform:lowercase!important}.ion-text-sm-capitalize{text-transform:capitalize!important}}@media (min-width: 768px){.ion-text-md-uppercase{text-transform:uppercase!important}.ion-text-md-lowercase{text-transform:lowercase!important}.ion-text-md-capitalize{text-transform:capitalize!important}}@media (min-width: 992px){.ion-text-lg-uppercase{text-transform:uppercase!important}.ion-text-lg-lowercase{text-transform:lowercase!important}.ion-text-lg-capitalize{text-transform:capitalize!important}}@media (min-width: 1200px){.ion-text-xl-uppercase{text-transform:uppercase!important}.ion-text-xl-lowercase{text-transform:lowercase!important}.ion-text-xl-capitalize{text-transform:capitalize!important}}.ion-align-self-start{align-self:flex-start!important}.ion-align-self-end{align-self:flex-end!important}.ion-align-self-center{align-self:center!important}.ion-align-self-stretch{align-self:stretch!important}.ion-align-self-baseline{align-self:baseline!important}.ion-align-self-auto{align-self:auto!important}.ion-wrap{flex-wrap:wrap!important}.ion-nowrap{flex-wrap:nowrap!important}.ion-wrap-reverse{flex-wrap:wrap-reverse!important}.ion-justify-content-start{justify-content:flex-start!important}.ion-justify-content-center{justify-content:center!important}.ion-justify-content-end{justify-content:flex-end!important}.ion-justify-content-around{justify-content:space-around!important}.ion-justify-content-between{justify-content:space-between!important}.ion-justify-content-evenly{justify-content:space-evenly!important}.ion-align-items-start{align-items:flex-start!important}.ion-align-items-center{align-items:center!important}.ion-align-items-end{align-items:flex-end!important}.ion-align-items-stretch{align-items:stretch!important}.ion-align-items-baseline{align-items:baseline!important}.ion-hide,.ion-hide-up,.ion-hide-down{display:none!important}@media (min-width: 576px){.ion-hide-sm-up{display:none!important}}@media (max-width: 575.98px){.ion-hide-sm-down{display:none!important}}@media (min-width: 768px){.ion-hide-md-up{display:none!important}}@media (max-width: 767.98px){.ion-hide-md-down{display:none!important}}@media (min-width: 992px){.ion-hide-lg-up{display:none!important}}@media (max-width: 991.98px){.ion-hide-lg-down{display:none!important}}@media (min-width: 1200px){.ion-hide-xl-up{display:none!important}}@media (max-width: 1199.98px){.ion-hide-xl-down{display:none!important}}.mapboxgl-map{-webkit-tap-highlight-color:rgb(0 0 0/0);font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative}.mapboxgl-canvas{left:0;position:absolute;top:0}.mapboxgl-map:-webkit-full-screen{height:100%;width:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:grab;-webkit-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.mapboxgl-ctrl-top-left{left:0;top:0}.mapboxgl-ctrl-top-right{right:0;top:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{bottom:0;right:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{float:left;margin:10px 0 0 10px}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{float:right;margin:10px 10px 0 0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{float:left;margin:0 0 10px 10px}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{float:right;margin:0 10px 10px 0}.mapboxgl-ctrl-group{background:#fff;border-radius:4px}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;overflow:hidden;padding:0;width:29px}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl-group button:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:only-child{border-radius:inherit}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 29 29'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath id='south' d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2' display='none'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23000'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' display='none'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle id='dot' cx='10' cy='10' r='2'/%3E%3Cpath id='stroke' d='M14 5l1 1-9 9-1-1 9-9z' fill='%23f00'/%3E%3C/svg%3E\")}}@keyframes mapboxgl-spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='0.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='0.9' fill='%23fff'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='1' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='1' fill='%23fff'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd' viewBox='0 0 88 23'%3E%3Cdefs%3E%3Cpath id='logo' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='text' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='clip'%3E%3Crect x='0' y='0' width='100%25' height='100%25' fill='white'/%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/mask%3E%3Cg id='outline' opacity='1' stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23clip)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23text' mask='url(%23clip)'/%3E%3C/g%3E%3Cg id='fill' opacity='1' fill='%23000'%3E%3Cuse xlink:href='%23logo'/%3E%3Cuse xlink:href='%23text'/%3E%3C/g%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{background-color:rgba(255,255,255,.5);margin:0;padding:0 5px}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{background-color:#fff;border-radius:12px;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{background-color:rgba(255,255,255,.5);background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{right:0;top:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{left:0;top:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:rgba(255,255,255,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px;white-space:nowrap}.mapboxgl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.mapboxgl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto;position:relative}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{left:0;opacity:1;position:absolute;top:0;transition:opacity .2s;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.mapboxgl-user-location-dot:before{animation:mapboxgl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.mapboxgl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading{height:0;width:0}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after,.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-bottom:7.5px solid #4aa1eb;content:\"\";position:absolute}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:before{border-left:7.5px solid transparent;transform:translateY(-28px) skewY(-20deg)}.mapboxgl-user-location-show-heading .mapboxgl-user-location-heading:after{border-right:7.5px solid transparent;transform:translate(7.5px,-28px) skewY(20deg)}@keyframes mapboxgl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);border-radius:100%;height:1px;width:1px}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}@media print{.mapbox-improve-map{display:none}}.mapboxgl-scroll-zoom-blocker,.mapboxgl-touch-pan-blocker{align-items:center;background:rgba(0,0,0,.7);color:#fff;display:flex;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;text-align:center;top:0;transition:opacity .75s ease-in-out;transition-delay:1s;width:100%}.mapboxgl-scroll-zoom-blocker-show,.mapboxgl-touch-pan-blocker-show{opacity:1;transition:opacity .1s ease-in-out}.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page,.mapboxgl-canvas-container.mapboxgl-touch-pan-blocker-override.mapboxgl-scrollable-page .mapboxgl-canvas{touch-action:pan-x pan-y}:root{--ion-color-primary: #f4900c;--ion-color-primary-rgb: 244, 144, 12;--ion-color-primary-contrast: #000000;--ion-color-primary-contrast-rgb: 0, 0, 0;--ion-color-primary-shade: #d77f0b;--ion-color-primary-tint: #f59b24;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #5260ff;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}@media (prefers-color-scheme: dark){body{--ion-color-primary: #f4900c;--ion-color-primary-rgb: 244, 144, 12;--ion-color-secondary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 0, 0, 0;--ion-color-primary-shade: #d77f0b;--ion-color-primary-tint: #f59b24;--ion-color-secondary: #50c8ff;--ion-color-secondary-rgb: 80,200,255;--ion-color-primary-contrast: #000000;--ion-color-secondary-contrast-rgb: 255,255,255;--ion-color-secondary-shade: #46b0e0;--ion-color-secondary-tint: #62ceff;--ion-color-tertiary: #6a64ff;--ion-color-tertiary-rgb: 106,100,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #5d58e0;--ion-color-tertiary-tint: #7974ff;--ion-color-success: #2fdf75;--ion-color-success-rgb: 47,223,117;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #29c467;--ion-color-success-tint: #44e283;--ion-color-warning: #ffd534;--ion-color-warning-rgb: 255,213,52;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0bb2e;--ion-color-warning-tint: #ffd948;--ion-color-danger: #ff4961;--ion-color-danger-rgb: 255,73,97;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255,255,255;--ion-color-danger-shade: #e04055;--ion-color-danger-tint: #ff5b71;--ion-color-dark: #f4f5f8;--ion-color-dark-rgb: 244,245,248;--ion-color-dark-contrast: #000000;--ion-color-dark-contrast-rgb: 0,0,0;--ion-color-dark-shade: #d7d8da;--ion-color-dark-tint: #f5f6f9;--ion-color-medium: #989aa2;--ion-color-medium-rgb: 152,154,162;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #86888f;--ion-color-medium-tint: #a2a4ab;--ion-color-light: #222428;--ion-color-light-rgb: 34,36,40;--ion-color-light-contrast: #ffffff;--ion-color-light-contrast-rgb: 255,255,255;--ion-color-light-shade: #1e2023;--ion-color-light-tint: #383a3e}.ios body{--ion-background-color: #000000;--ion-background-color-rgb: 0,0,0;--ion-text-color: #ffffff;--ion-text-color-rgb: 255,255,255;--ion-color-step-50: #0d0d0d;--ion-color-step-100: #1a1a1a;--ion-color-step-150: #262626;--ion-color-step-200: #333333;--ion-color-step-250: #404040;--ion-color-step-300: #4d4d4d;--ion-color-step-350: #595959;--ion-color-step-400: #666666;--ion-color-step-450: #737373;--ion-color-step-500: #808080;--ion-color-step-550: #8c8c8c;--ion-color-step-600: #999999;--ion-color-step-650: #a6a6a6;--ion-color-step-700: #b3b3b3;--ion-color-step-750: #bfbfbf;--ion-color-step-800: #cccccc;--ion-color-step-850: #d9d9d9;--ion-color-step-900: #e6e6e6;--ion-color-step-950: #f2f2f2;--ion-item-background: #000000;--ion-card-background: #1c1c1d}.ios body .mapboxgl-popup-content{background-color:#000}.ios body :is(.mapboxgl-popup-anchor-top .mapboxgl-popup-tip, .mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip, .mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip){border-bottom-color:#000}.ios body :is(.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip, .mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip, .mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip){border-top-color:#000}.ios body .mapboxgl-popup-anchor-left .mapboxgl-popup-tip{border-right-color:#000}.ios body .mapboxgl-popup-anchor-right .mapboxgl-popup-tip{border-left-color:#000}.ios ion-modal{--ion-background-color: var(--ion-color-step-100);--ion-toolbar-background: var(--ion-color-step-150);--ion-toolbar-border-color: var(--ion-color-step-250)}.md body{--ion-background-color: #121212;--ion-background-color-rgb: 18,18,18;--ion-text-color: #ffffff;--ion-text-color-rgb: 255,255,255;--ion-border-color: #222222;--ion-color-step-50: #1e1e1e;--ion-color-step-100: #2a2a2a;--ion-color-step-150: #363636;--ion-color-step-200: #414141;--ion-color-step-250: #4d4d4d;--ion-color-step-300: #595959;--ion-color-step-350: #656565;--ion-color-step-400: #717171;--ion-color-step-450: #7d7d7d;--ion-color-step-500: #898989;--ion-color-step-550: #949494;--ion-color-step-600: #a0a0a0;--ion-color-step-650: #acacac;--ion-color-step-700: #b8b8b8;--ion-color-step-750: #c4c4c4;--ion-color-step-800: #d0d0d0;--ion-color-step-850: #dbdbdb;--ion-color-step-900: #e7e7e7;--ion-color-step-950: #f3f3f3;--ion-item-background: #1e1e1e;--ion-toolbar-background: #1f1f1f;--ion-tab-bar-background: #1f1f1f;--ion-card-background: #1e1e1e}.md body .mapboxgl-popup-content{background-color:#1e1e1e}.md body :is(.mapboxgl-popup-anchor-top .mapboxgl-popup-tip, .mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip, .mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip){border-bottom-color:#1e1e1e}.md body :is(.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip, .mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip, .mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip){border-top-color:#1e1e1e}.md body .mapboxgl-popup-anchor-left .mapboxgl-popup-tip{border-right-color:#1e1e1e}.md body .mapboxgl-popup-anchor-right .mapboxgl-popup-tip{border-left-color:#1e1e1e}}.tiptap{padding:2px;border-radius:5px}.titap p{margin-block-start:5px!important;margin-block-end:5px}.tiptap .is-empty:before{content:attr(data-placeholder);float:left;color:#696969;pointer-events:none;height:0}\n",document.head.appendChild(n),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var o={exports:{}},s={},a={exports:{}},l={},c=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),m=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),x=Symbol.iterator,_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,k={};function E(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||_}function S(){}function T(e,t,n){this.props=e,this.context=t,this.refs=k,this.updater=n||_}E.prototype.isReactComponent={},E.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},E.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},S.prototype=E.prototype;var C=T.prototype=new S;C.constructor=T,w(C,E.prototype),C.isPureReactComponent=!0;var M=Array.isArray,I=Object.prototype.hasOwnProperty,A={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function O(e,t,n){var i,r={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)I.call(t,i)&&!P.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(e&&e.defaultProps)for(i in a=e.defaultProps)void 0===r[i]&&(r[i]=a[i]);return{$$typeof:c,type:e,key:o,ref:s,props:r,_owner:A.current}}function D(e){return"object"==typeof e&&null!==e&&e.$$typeof===c}var R=/\/+/g;function z(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function L(e,t,n,i,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var s=!1;if(null===e)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case c:case u:s=!0}}if(s)return r=r(s=e),e=""===i?"."+z(s,0):i,M(r)?(n="",null!=e&&(n=e.replace(R,"$&/")+"/"),L(r,t,n,"",(function(e){return e}))):null!=r&&(D(r)&&(r=function(e,t){return{$$typeof:c,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(r,n+(!r.key||s&&s.key===r.key?"":(""+r.key).replace(R,"$&/")+"/")+e)),t.push(r)),1;if(s=0,i=""===i?".":i+":",M(e))for(var a=0;a<e.length;a++){var l=i+z(o=e[a],a);s+=L(o,t,n,l,r)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=x&&e[x]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),a=0;!(o=e.next()).done;)s+=L(o=o.value,t,n,l=i+z(o,a++),r);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function B(e,t,n){if(null==e)return e;var i=[],r=0;return L(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function N(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var F={current:null},$={transition:null},j={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:$,ReactCurrentOwner:A};l.Children={map:B,forEach:function(e,t,n){B(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return B(e,(function(){t++})),t},toArray:function(e){return B(e,(function(e){return e}))||[]},only:function(e){if(!D(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},l.Component=E,l.Fragment=d,l.Profiler=p,l.PureComponent=T,l.StrictMode=h,l.Suspense=y,l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,l.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=w({},e.props),r=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=A.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)I.call(t,l)&&!P.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==a?a[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:c,type:e.type,key:r,ref:o,props:i,_owner:s}},l.createContext=function(e){return(e={$$typeof:m,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:f,_context:e},e.Consumer=e},l.createElement=O,l.createFactory=function(e){var t=O.bind(null,e);return t.type=e,t},l.createRef=function(){return{current:null}},l.forwardRef=function(e){return{$$typeof:g,render:e}},l.isValidElement=D,l.lazy=function(e){return{$$typeof:b,_payload:{_status:-1,_result:e},_init:N}},l.memo=function(e,t){return{$$typeof:v,type:e,compare:void 0===t?null:t}},l.startTransition=function(e){var t=$.transition;$.transition={};try{e()}finally{$.transition=t}},l.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},l.useCallback=function(e,t){return F.current.useCallback(e,t)},l.useContext=function(e){return F.current.useContext(e)},l.useDebugValue=function(){},l.useDeferredValue=function(e){return F.current.useDeferredValue(e)},l.useEffect=function(e,t){return F.current.useEffect(e,t)},l.useId=function(){return F.current.useId()},l.useImperativeHandle=function(e,t,n){return F.current.useImperativeHandle(e,t,n)},l.useInsertionEffect=function(e,t){return F.current.useInsertionEffect(e,t)},l.useLayoutEffect=function(e,t){return F.current.useLayoutEffect(e,t)},l.useMemo=function(e,t){return F.current.useMemo(e,t)},l.useReducer=function(e,t,n){return F.current.useReducer(e,t,n)},l.useRef=function(e){return F.current.useRef(e)},l.useState=function(e){return F.current.useState(e)},l.useSyncExternalStore=function(e,t,n){return F.current.useSyncExternalStore(e,t,n)},l.useTransition=function(){return F.current.useTransition()},l.version="18.2.0",a.exports=l;var V=a.exports;const U=r(V);
/**
             * @license React
             * react-jsx-runtime.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */var q=V,G=Symbol.for("react.element"),W=Symbol.for("react.fragment"),H=Object.prototype.hasOwnProperty,Z=q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,X={key:!0,ref:!0,__self:!0,__source:!0};function K(e,t,n){var i,r={},o=null,s=null;for(i in void 0!==n&&(o=""+n),void 0!==t.key&&(o=""+t.key),void 0!==t.ref&&(s=t.ref),t)H.call(t,i)&&!X.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:G,type:e,key:o,ref:s,props:r,_owner:Z.current}}s.Fragment=W,s.jsx=K,s.jsxs=K,o.exports=s;var J=o.exports;const Y=J.Fragment,Q=J.jsx,ee=J.jsxs;var te={exports:{}},ne={},ie={exports:{}},re={};
/**
             * @license React
             * scheduler.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */
!function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,o=e[i];if(!(0<r(o,t)))break e;e[i]=t,e[n]=o,n=i}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,o=e.length,s=o>>>1;i<s;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>r(l,n))c<o&&0>r(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<o&&0>r(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,p=!1,f=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var r=n(c);null!==r;){if(null===r.callback)i(c);else{if(!(r.startTime<=e))break;i(c),r.sortIndex=r.expirationTime,t(l,r)}r=n(c)}}function x(e){if(m=!1,b(e),!f)if(null!==n(l))f=!0,O(_);else{var t=n(c);null!==t&&D(x,t.startTime-e)}}function _(t,r){f=!1,m&&(m=!1,y(S),S=-1),p=!0;var o=h;try{for(b(r),d=n(l);null!==d&&(!(d.expirationTime>r)||t&&!M());){var s=d.callback;if("function"==typeof s){d.callback=null,h=d.priorityLevel;var a=s(d.expirationTime<=r);r=e.unstable_now(),"function"==typeof a?d.callback=a:d===n(l)&&i(l),b(r)}else i(l);d=n(l)}if(null!==d)var u=!0;else{var g=n(c);null!==g&&D(x,g.startTime-r),u=!1}return u}finally{d=null,h=o,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,k=!1,E=null,S=-1,T=5,C=-1;function M(){return!(e.unstable_now()-C<T)}function I(){if(null!==E){var t=e.unstable_now();C=t;var n=!0;try{n=E(!0,t)}finally{n?w():(k=!1,E=null)}}else k=!1}if("function"==typeof v)w=function(){v(I)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,P=A.port2;A.port1.onmessage=I,w=function(){P.postMessage(null)}}else w=function(){g(I,0)};function O(e){E=e,k||(k=!0,w())}function D(t,n){S=g((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,O(_))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(i,r,o){var s=e.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,i){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return i={id:u++,callback:r,priorityLevel:i,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(i.sortIndex=o,t(c,i),null===n(l)&&i===n(c)&&(m?(y(S),S=-1):m=!0,D(x,o-s))):(i.sortIndex=a,t(l,i),f||p||(f=!0,O(_))),i},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(re),ie.exports=re;var oe=ie.exports,se=V,ae=oe;
/**
             * @license React
             * react-dom.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ce=new Set,ue={};function de(e,t){he(e,t),he(e+"Capture",t)}function he(e,t){for(ue[e]=t,e=0;e<t.length;e++)ce.add(t[e])}var pe=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),fe=Object.prototype.hasOwnProperty,me=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ge={},ye={};function ve(e,t,n,i,r,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var be={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){be[e]=new ve(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];be[t]=new ve(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){be[e]=new ve(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){be[e]=new ve(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){be[e]=new ve(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){be[e]=new ve(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){be[e]=new ve(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){be[e]=new ve(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){be[e]=new ve(e,5,!1,e.toLowerCase(),null,!1,!1)}));var xe=/[\-:]([a-z])/g;function _e(e){return e[1].toUpperCase()}function we(e,t,n,i){var r=be.hasOwnProperty(t)?be[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null==t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!fe.call(ye,e)||!fe.call(ge,e)&&(me.test(e)?ye[e]=!0:(ge[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(xe,_e);be[t]=new ve(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(xe,_e);be[t]=new ve(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(xe,_e);be[t]=new ve(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){be[e]=new ve(e,1,!1,e.toLowerCase(),null,!1,!1)})),be.xlinkHref=new ve("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){be[e]=new ve(e,1,!1,e.toLowerCase(),null,!0,!0)}));var ke=se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ee=Symbol.for("react.element"),Se=Symbol.for("react.portal"),Te=Symbol.for("react.fragment"),Ce=Symbol.for("react.strict_mode"),Me=Symbol.for("react.profiler"),Ie=Symbol.for("react.provider"),Ae=Symbol.for("react.context"),Pe=Symbol.for("react.forward_ref"),Oe=Symbol.for("react.suspense"),De=Symbol.for("react.suspense_list"),Re=Symbol.for("react.memo"),ze=Symbol.for("react.lazy"),Le=Symbol.for("react.offscreen"),Be=Symbol.iterator;function Ne(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Be&&e[Be]||e["@@iterator"])?e:null}var Fe,$e=Object.assign;function je(e){if(void 0===Fe)try{throw Error()}catch(xT){var t=xT.stack.trim().match(/\n( *(at )?)/);Fe=t&&t[1]||""}return"\n"+Fe+e}var Ve=!1;function Ue(e,t){if(!e||Ve)return"";Ve=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(CT){var i=CT}Reflect.construct(e,[],t)}else{try{t.call()}catch(CT){i=CT}e.call(t.prototype)}else{try{throw Error()}catch(CT){i=CT}e()}}catch(CT){if(CT&&i&&"string"==typeof CT.stack){for(var r=CT.stack.split("\n"),o=i.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{Ve=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?je(e):""}function qe(e){switch(e.tag){case 5:return je(e.type);case 16:return je("Lazy");case 13:return je("Suspense");case 19:return je("SuspenseList");case 0:case 2:case 15:return e=Ue(e.type,!1);case 11:return e=Ue(e.type.render,!1);case 1:return e=Ue(e.type,!0);default:return""}}function Ge(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case Te:return"Fragment";case Se:return"Portal";case Me:return"Profiler";case Ce:return"StrictMode";case Oe:return"Suspense";case De:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case Ae:return(e.displayName||"Context")+".Consumer";case Ie:return(e._context.displayName||"Context")+".Provider";case Pe:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Re:return null!==(t=e.displayName||null)?t:Ge(e.type)||"Memo";case ze:t=e._payload,e=e._init;try{return Ge(e(t))}catch(xT){}}return null}function We(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ge(t);case 8:return t===Ce?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function He(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function Ze(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Xe(e){e._valueTracker||(e._valueTracker=function(e){var t=Ze(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ke(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Ze(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function Je(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(bT){return e.body}}function Ye(e,t){var n=t.checked;return $e({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Qe(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=He(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function et(e,t){null!=(t=t.checked)&&we(e,"checked",t,!1)}function tt(e,t){et(e,t);var n=He(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?it(e,t.type,n):t.hasOwnProperty("defaultValue")&&it(e,t.type,He(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function nt(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function it(e,t,n){"number"===t&&Je(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var rt=Array.isArray;function ot(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+He(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function st(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(le(91));return $e({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function at(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(le(92));if(rt(n)){if(1<n.length)throw Error(le(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:He(n)}}function lt(e,t){var n=He(t.value),i=He(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ct(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ut(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dt(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ut(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ht,pt=function(e){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,i,r){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ht=ht||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ht.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function ft(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var mt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gt=["Webkit","ms","Moz","O"];function yt(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||mt.hasOwnProperty(e)&&mt[e]?(""+t).trim():t+"px"}function vt(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=yt(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(mt).forEach((function(e){gt.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),mt[t]=mt[e]}))}));var bt=$e({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xt(e,t){if(t){if(bt[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(le(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(le(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(le(62))}}function _t(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wt=null;function kt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Et=null,St=null,Tt=null;function Ct(e){if(e=wo(e)){if("function"!=typeof Et)throw Error(le(280));var t=e.stateNode;t&&(t=Eo(t),Et(e.stateNode,e.type,t))}}function Mt(e){St?Tt?Tt.push(e):Tt=[e]:St=e}function It(){if(St){var e=St,t=Tt;if(Tt=St=null,Ct(e),t)for(e=0;e<t.length;e++)Ct(t[e])}}function At(e,t){return e(t)}function Pt(){}var Ot=!1;function Dt(e,t,n){if(Ot)return e(t,n);Ot=!0;try{return At(e,t,n)}finally{Ot=!1,(null!==St||null!==Tt)&&(Pt(),It())}}function Rt(e,t){var n=e.stateNode;if(null===n)return null;var i=Eo(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(le(231,t,typeof n));return n}var zt=!1;if(pe)try{var Lt={};Object.defineProperty(Lt,"passive",{get:function(){zt=!0}}),window.addEventListener("test",Lt,Lt),window.removeEventListener("test",Lt,Lt)}catch(PW){zt=!1}function Bt(e,t,n,i,r,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(MT){this.onError(MT)}}var Nt=!1,Ft=null,$t=!1,jt=null,Vt={onError:function(e){Nt=!0,Ft=e}};function Ut(e,t,n,i,r,o,s,a,l){Nt=!1,Ft=null,Bt.apply(Vt,arguments)}function qt(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Gt(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Wt(e){if(qt(e)!==e)throw Error(le(188))}function Ht(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=qt(e)))throw Error(le(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Wt(r),e;if(o===i)return Wt(r),t;o=o.sibling}throw Error(le(188))}if(n.return!==i.return)n=r,i=o;else{for(var s=!1,a=r.child;a;){if(a===n){s=!0,n=r,i=o;break}if(a===i){s=!0,i=r,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,i=r;break}if(a===i){s=!0,i=o,n=r;break}a=a.sibling}if(!s)throw Error(le(189))}}if(n.alternate!==i)throw Error(le(190))}if(3!==n.tag)throw Error(le(188));return n.stateNode.current===n?e:t}(e),null!==e?Zt(e):null}function Zt(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Zt(e);if(null!==t)return t;e=e.sibling}return null}var Xt=ae.unstable_scheduleCallback,Kt=ae.unstable_cancelCallback,Jt=ae.unstable_shouldYield,Yt=ae.unstable_requestPaint,Qt=ae.unstable_now,en=ae.unstable_getCurrentPriorityLevel,tn=ae.unstable_ImmediatePriority,nn=ae.unstable_UserBlockingPriority,rn=ae.unstable_NormalPriority,on=ae.unstable_LowPriority,sn=ae.unstable_IdlePriority,an=null,ln=null,cn=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(un(e)/dn|0)|0},un=Math.log,dn=Math.LN2,hn=64,pn=4194304;function fn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mn(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?i=fn(a):0!=(o&=s)&&(i=fn(o))}else 0!=(s=n&~r)?i=fn(s):0!==o&&(i=fn(o));if(0===i)return 0;if(0!==t&&t!==i&&0==(t&r)&&((r=i&-i)>=(o=t&-t)||16===r&&0!=(4194240&o)))return t;if(0!=(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-cn(t)),i|=e[n],t&=~r;return i}function gn(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function yn(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vn(){var e=hn;return 0==(4194240&(hn<<=1))&&(hn=64),e}function bn(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xn(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-cn(t)]=n}function _n(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-cn(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var wn=0;function kn(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var En,Sn,Tn,Cn,Mn,In=!1,An=[],Pn=null,On=null,Dn=null,Rn=new Map,zn=new Map,Ln=[],Bn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nn(e,t){switch(e){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":Dn=null;break;case"pointerover":case"pointerout":Rn.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zn.delete(t.pointerId)}}function Fn(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==t&&null!==(t=wo(t))&&Sn(t),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function $n(e){var t=_o(e.target);if(null!==t){var n=qt(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Gt(n)))return e.blockedOn=t,void Mn(e.priority,(function(){Tn(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jn(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yn(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wo(n))&&Sn(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);wt=i,n.target.dispatchEvent(i),wt=null,t.shift()}return!0}function Vn(e,t,n){jn(e)&&n.delete(t)}function Un(){In=!1,null!==Pn&&jn(Pn)&&(Pn=null),null!==On&&jn(On)&&(On=null),null!==Dn&&jn(Dn)&&(Dn=null),Rn.forEach(Vn),zn.forEach(Vn)}function qn(e,t){e.blockedOn===t&&(e.blockedOn=null,In||(In=!0,ae.unstable_scheduleCallback(ae.unstable_NormalPriority,Un)))}function Gn(e){function t(t){return qn(t,e)}if(0<An.length){qn(An[0],e);for(var n=1;n<An.length;n++){var i=An[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Pn&&qn(Pn,e),null!==On&&qn(On,e),null!==Dn&&qn(Dn,e),Rn.forEach(t),zn.forEach(t),n=0;n<Ln.length;n++)(i=Ln[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Ln.length&&null===(n=Ln[0]).blockedOn;)$n(n),null===n.blockedOn&&Ln.shift()}var Wn=ke.ReactCurrentBatchConfig,Hn=!0;function Zn(e,t,n,i){var r=wn,o=Wn.transition;Wn.transition=null;try{wn=1,Kn(e,t,n,i)}finally{wn=r,Wn.transition=o}}function Xn(e,t,n,i){var r=wn,o=Wn.transition;Wn.transition=null;try{wn=4,Kn(e,t,n,i)}finally{wn=r,Wn.transition=o}}function Kn(e,t,n,i){if(Hn){var r=Yn(e,t,n,i);if(null===r)Wr(e,t,i,Jn,n),Nn(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Pn=Fn(Pn,e,t,n,i,r),!0;case"dragenter":return On=Fn(On,e,t,n,i,r),!0;case"mouseover":return Dn=Fn(Dn,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return Rn.set(o,Fn(Rn.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,zn.set(o,Fn(zn.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Nn(e,i),4&t&&-1<Bn.indexOf(e)){for(;null!==r;){var o=wo(r);if(null!==o&&En(o),null===(o=Yn(e,t,n,i))&&Wr(e,t,i,Jn,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else Wr(e,t,i,null,n)}}var Jn=null;function Yn(e,t,n,i){if(Jn=null,null!==(e=_o(e=kt(i))))if(null===(t=qt(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Gt(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jn=e,null}function Qn(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(en()){case tn:return 1;case nn:return 4;case rn:case on:return 16;case sn:return 536870912;default:return 16}default:return 16}}var ei=null,ti=null,ni=null;function ii(){if(ni)return ni;var e,t,n=ti,i=n.length,r="value"in ei?ei.value:ei.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===r[o-t];t++);return ni=r.slice(e,1<t?1-t:void 0)}function ri(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function oi(){return!0}function si(){return!1}function ai(e){function t(t,n,i,r,o){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?oi:si,this.isPropagationStopped=si,this}return $e(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=oi)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=oi)},persist:function(){},isPersistent:oi}),t}var li,ci,ui,di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hi=ai(di),pi=$e({},di,{view:0,detail:0}),fi=ai(pi),mi=$e({},pi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ci,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ui&&(ui&&"mousemove"===e.type?(li=e.screenX-ui.screenX,ci=e.screenY-ui.screenY):ci=li=0,ui=e),li)},movementY:function(e){return"movementY"in e?e.movementY:ci}}),gi=ai(mi),yi=ai($e({},mi,{dataTransfer:0})),vi=ai($e({},pi,{relatedTarget:0})),bi=ai($e({},di,{animationName:0,elapsedTime:0,pseudoElement:0})),xi=$e({},di,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_i=ai(xi),wi=ai($e({},di,{data:0})),ki={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ei={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Si={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ti(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Si[e])&&!!t[e]}function Ci(){return Ti}var Mi=$e({},pi,{key:function(e){if(e.key){var t=ki[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ri(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ei[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ci,charCode:function(e){return"keypress"===e.type?ri(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ri(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ii=ai(Mi),Ai=ai($e({},mi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pi=ai($e({},pi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ci})),Oi=ai($e({},di,{propertyName:0,elapsedTime:0,pseudoElement:0})),Di=$e({},mi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ri=ai(Di),zi=[9,13,27,32],Li=pe&&"CompositionEvent"in window,Bi=null;pe&&"documentMode"in document&&(Bi=document.documentMode);var Ni=pe&&"TextEvent"in window&&!Bi,Fi=pe&&(!Li||Bi&&8<Bi&&11>=Bi),$i=String.fromCharCode(32),ji=!1;function Vi(e,t){switch(e){case"keyup":return-1!==zi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ui(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var qi=!1,Gi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gi[e.type]:"textarea"===t}function Hi(e,t,n,i){Mt(i),0<(t=Zr(t,"onChange")).length&&(n=new hi("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Zi=null,Xi=null;function Ki(e){$r(e,0)}function Ji(e){if(Ke(ko(e)))return e}function Yi(e,t){if("change"===e)return t}var Qi=!1;if(pe){var er;if(pe){var tr="oninput"in document;if(!tr){var nr=document.createElement("div");nr.setAttribute("oninput","return;"),tr="function"==typeof nr.oninput}er=tr}else er=!1;Qi=er&&(!document.documentMode||9<document.documentMode)}function ir(){Zi&&(Zi.detachEvent("onpropertychange",rr),Xi=Zi=null)}function rr(e){if("value"===e.propertyName&&Ji(Xi)){var t=[];Hi(t,Xi,e,kt(e)),Dt(Ki,t)}}function or(e,t,n){"focusin"===e?(ir(),Xi=n,(Zi=t).attachEvent("onpropertychange",rr)):"focusout"===e&&ir()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ji(Xi)}function ar(e,t){if("click"===e)return Ji(t)}function lr(e,t){if("input"===e||"change"===e)return Ji(t)}var cr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function ur(e,t){if(cr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!fe.call(t,r)||!cr(e[r],t[r]))return!1}return!0}function dr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hr(e,t){var n,i=dr(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=dr(i)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=Je();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(_T){n=!1}if(!n)break;t=Je((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=fr(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&pr(n.ownerDocument.documentElement,n)){if(null!==i&&mr(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!e.extend&&o>i&&(r=i,i=o,o=r),r=hr(n,o);var s=hr(n,i);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),o>i?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yr=pe&&"documentMode"in document&&11>=document.documentMode,vr=null,br=null,xr=null,_r=!1;function wr(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==vr||vr!==Je(i)||(i="selectionStart"in(i=vr)&&mr(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},xr&&ur(xr,i)||(xr=i,0<(i=Zr(br,"onSelect")).length&&(t=new hi("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=vr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},Sr={},Tr={};function Cr(e){if(Sr[e])return Sr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tr)return Sr[e]=n[t];return e}pe&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var Mr=Cr("animationend"),Ir=Cr("animationiteration"),Ar=Cr("animationstart"),Pr=Cr("transitionend"),Or=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Or.set(e,t),de(t,[e])}for(var zr=0;zr<Dr.length;zr++){var Lr=Dr[zr];Rr(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Rr(Mr,"onAnimationEnd"),Rr(Ir,"onAnimationIteration"),Rr(Ar,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Pr,"onTransitionEnd"),he("onMouseEnter",["mouseout","mouseover"]),he("onMouseLeave",["mouseout","mouseover"]),he("onPointerEnter",["pointerout","pointerover"]),he("onPointerLeave",["pointerout","pointerover"]),de("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),de("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),de("onBeforeInput",["compositionend","keypress","textInput","paste"]),de("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Br="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Br));function Fr(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,s,a,l){if(Ut.apply(this,arguments),Nt){if(!Nt)throw Error(le(198));var c=Ft;Nt=!1,Ft=null,$t||($t=!0,jt=c)}}(i,t,void 0,e),e.currentTarget=null}function $r(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;Fr(r,a,c),o=l}else for(s=0;s<i.length;s++){if(l=(a=i[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;Fr(r,a,c),o=l}}}if($t)throw e=jt,$t=!1,jt=null,e}function jr(e,t){var n=t[vo];void 0===n&&(n=t[vo]=new Set);var i=e+"__bubble";n.has(i)||(Gr(t,e,2,!1),n.add(i))}function Vr(e,t,n){var i=0;t&&(i|=4),Gr(n,e,i,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[Ur]){e[Ur]=!0,ce.forEach((function(t){"selectionchange"!==t&&(Nr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Vr("selectionchange",!1,t))}}function Gr(e,t,n,i){switch(Qn(t)){case 1:var r=Zn;break;case 4:r=Xn;break;default:r=Kn}n=r.bind(null,t,n,e),r=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Wr(e,t,n,i,r){var o=i;if(0==(1&t)&&0==(2&t)&&null!==i)e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=_o(a)))return;if(5===(l=s.tag)||6===l){i=o=s;continue e}a=a.parentNode}}i=i.return}Dt((function(){var i=o,r=kt(n),s=[];e:{var a=Or.get(e);if(void 0!==a){var l=hi,c=e;switch(e){case"keypress":if(0===ri(n))break e;case"keydown":case"keyup":l=Ii;break;case"focusin":c="focus",l=vi;break;case"focusout":c="blur",l=vi;break;case"beforeblur":case"afterblur":l=vi;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=yi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pi;break;case Mr:case Ir:case Ar:l=bi;break;case Pr:l=Oi;break;case"scroll":l=fi;break;case"wheel":l=Ri;break;case"copy":case"cut":case"paste":l=_i;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ai}var u=0!=(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&null!=(m=Rt(f,h))&&u.push(Hr(f,m,p))),d)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,r),s.push({event:a,listeners:u}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===wt||!(c=n.relatedTarget||n.fromElement)||!_o(c)&&!c[yo])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?_o(c):null)&&(c!==(d=qt(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=gi,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ai,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?a:ko(l),p=null==c?a:ko(c),(a=new u(m,f+"leave",l,n,r)).target=d,a.relatedTarget=p,m=null,_o(r)===i&&((u=new u(h,f+"enter",c,n,r)).target=p,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Xr(p))f++;for(p=0,m=h;m;m=Xr(m))p++;for(;0<f-p;)u=Xr(u),f--;for(;0<p-f;)h=Xr(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Xr(u),h=Xr(h)}u=null}else u=null;null!==l&&Kr(s,a,l,u,!1),null!==c&&null!==d&&Kr(s,d,c,u,!0)}if("select"===(l=(a=i?ko(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yi;else if(Wi(a))if(Qi)g=lr;else{g=sr;var y=or}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=ar);switch(g&&(g=g(e,i))?Hi(s,g,n,r):(y&&y(e,a,i),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&it(a,"number",a.value)),y=i?ko(i):window,e){case"focusin":(Wi(y)||"true"===y.contentEditable)&&(vr=y,br=i,xr=null);break;case"focusout":xr=br=vr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,wr(s,n,r);break;case"selectionchange":if(yr)break;case"keydown":case"keyup":wr(s,n,r)}var v;if(Li)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qi?Vi(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fi&&"ko"!==n.locale&&(qi||"onCompositionStart"!==b?"onCompositionEnd"===b&&qi&&(v=ii()):(ti="value"in(ei=r)?ei.value:ei.textContent,qi=!0)),0<(y=Zr(i,b)).length&&(b=new wi(b,e,null,n,r),s.push({event:b,listeners:y}),(v||null!==(v=Ui(n)))&&(b.data=v))),(v=Ni?function(e,t){switch(e){case"compositionend":return Ui(t);case"keypress":return 32!==t.which?null:(ji=!0,$i);case"textInput":return(e=t.data)===$i&&ji?null:e;default:return null}}(e,n):function(e,t){if(qi)return"compositionend"===e||!Li&&Vi(e,t)?(e=ii(),ni=ti=ei=null,qi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fi&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(i=Zr(i,"onBeforeInput")).length&&(r=new wi("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=v)}$r(s,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Zr(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Rt(e,n))&&i.unshift(Hr(e,o,r)),null!=(o=Rt(e,t))&&i.push(Hr(e,o,r))),e=e.return}return i}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,i,r){for(var o=t._reactName,s=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Rt(n,o))&&s.unshift(Hr(n,l,a)):r||null!=(l=Rt(n,o))&&s.push(Hr(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Jr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Qr(e){return("string"==typeof e?e:""+e).replace(Jr,"\n").replace(Yr,"")}function eo(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(le(425))}function to(){}var no=null,io=null;function ro(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var oo="function"==typeof setTimeout?setTimeout:void 0,so="function"==typeof clearTimeout?clearTimeout:void 0,ao="function"==typeof Promise?Promise:void 0,lo="function"==typeof queueMicrotask?queueMicrotask:void 0!==ao?function(e){return ao.resolve(null).then(e).catch(co)}:oo;function co(e){setTimeout((function(){throw e}))}function uo(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Gn(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Gn(t)}function ho(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function po(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fo=Math.random().toString(36).slice(2),mo="__reactFiber$"+fo,go="__reactProps$"+fo,yo="__reactContainer$"+fo,vo="__reactEvents$"+fo,bo="__reactListeners$"+fo,xo="__reactHandles$"+fo;function _o(e){var t=e[mo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[yo]||n[mo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=po(e);null!==e;){if(n=e[mo])return n;e=po(e)}return t}n=(e=n).parentNode}return null}function wo(e){return!(e=e[mo]||e[yo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ko(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(le(33))}function Eo(e){return e[go]||null}var So=[],To=-1;function Co(e){return{current:e}}function Mo(e){0>To||(e.current=So[To],So[To]=null,To--)}function Io(e,t){To++,So[To]=e.current,e.current=t}var Ao={},Po=Co(Ao),Oo=Co(!1),Do=Ao;function Ro(e,t){var n=e.type.contextTypes;if(!n)return Ao;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function zo(e){return null!=(e=e.childContextTypes)}function Lo(){Mo(Oo),Mo(Po)}function Bo(e,t,n){if(Po.current!==Ao)throw Error(le(168));Io(Po,t),Io(Oo,n)}function No(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(le(108,We(e)||"Unknown",r));return $e({},n,i)}function Fo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ao,Do=Po.current,Io(Po,e),Io(Oo,Oo.current),!0}function $o(e,t,n){var i=e.stateNode;if(!i)throw Error(le(169));n?(e=No(e,t,Do),i.__reactInternalMemoizedMergedChildContext=e,Mo(Oo),Mo(Po),Io(Po,e)):Mo(Oo),Io(Oo,n)}var jo=null,Vo=!1,Uo=!1;function qo(e){null===jo?jo=[e]:jo.push(e)}function Go(){if(!Uo&&null!==jo){Uo=!0;var e=0,t=wn;try{var n=jo;for(wn=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}jo=null,Vo=!1}catch(wT){throw null!==jo&&(jo=jo.slice(e+1)),Xt(tn,Go),wT}finally{wn=t,Uo=!1}}return null}var Wo=[],Ho=0,Zo=null,Xo=0,Ko=[],Jo=0,Yo=null,Qo=1,es="";function ts(e,t){Wo[Ho++]=Xo,Wo[Ho++]=Zo,Zo=e,Xo=t}function ns(e,t,n){Ko[Jo++]=Qo,Ko[Jo++]=es,Ko[Jo++]=Yo,Yo=e;var i=Qo;e=es;var r=32-cn(i)-1;i&=~(1<<r),n+=1;var o=32-cn(t)+r;if(30<o){var s=r-r%5;o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Qo=1<<32-cn(t)+r|n<<r|i,es=o+e}else Qo=1<<o|n<<r|i,es=e}function is(e){null!==e.return&&(ts(e,1),ns(e,1,0))}function rs(e){for(;e===Zo;)Zo=Wo[--Ho],Wo[Ho]=null,Xo=Wo[--Ho],Wo[Ho]=null;for(;e===Yo;)Yo=Ko[--Jo],Ko[Jo]=null,es=Ko[--Jo],Ko[Jo]=null,Qo=Ko[--Jo],Ko[Jo]=null}var ss=null,as=null,ls=!1,cs=null;function us(e,t){var n=zu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ds(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ss=e,as=ho(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ss=e,as=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yo?{id:Qo,overflow:es}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=zu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ss=e,as=null,!0);default:return!1}}function hs(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ps(e){if(ls){var t=as;if(t){var n=t;if(!ds(e,t)){if(hs(e))throw Error(le(418));t=ho(n.nextSibling);var i=ss;t&&ds(e,t)?us(i,n):(e.flags=-4097&e.flags|2,ls=!1,ss=e)}}else{if(hs(e))throw Error(le(418));e.flags=-4097&e.flags|2,ls=!1,ss=e}}}function fs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ss=e}function ms(e){if(e!==ss)return!1;if(!ls)return fs(e),ls=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ro(e.type,e.memoizedProps)),t&&(t=as)){if(hs(e))throw gs(),Error(le(418));for(;t;)us(e,t),t=ho(t.nextSibling)}if(fs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){as=ho(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}as=null}}else as=ss?ho(e.stateNode.nextSibling):null;return!0}function gs(){for(var e=as;e;)e=ho(e.nextSibling)}function ys(){as=ss=null,ls=!1}function vs(e){null===cs?cs=[e]:cs.push(e)}var bs=ke.ReactCurrentBatchConfig;function xs(e,t){if(e&&e.defaultProps){for(var n in t=$e({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var _s=Co(null),ws=null,ks=null,Es=null;function Ss(){Es=ks=ws=null}function Ts(e){var t=_s.current;Mo(_s),e._currentValue=t}function Cs(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ms(e,t){ws=e,Es=ks=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(kl=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(Es!==e)if(e={context:e,memoizedValue:t,next:null},null===ks){if(null===ws)throw Error(le(308));ks=e,ws.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var As=null;function Ps(e){null===As?As=[e]:As.push(e)}function Os(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Ps(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ds(e,i)}function Ds(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Rs=!1;function zs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ns(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!=(2&Oc)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Ds(e,n)}return null===(r=i.interleaved)?(t.next=t,Ps(i)):(t.next=r.next,r.next=t),i.interleaved=t,Ds(e,n)}function Fs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,_n(e,n)}}function $s(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function js(e,t,n,i){var r=e.updateQueue;Rs=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&(a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l)}if(null!==o){var d=r.baseState;for(s=0,u=c=l=null,a=o;;){var h=a.lane,p=a.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(h=t,p=n,m.tag){case 1:if("function"==typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=m.payload)?f.call(p,d,h):f))break e;d=$e({},d,h);break e;case 2:Rs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);$c|=s,e.lanes=s,e.memoizedState=d}}function Vs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!=typeof r)throw Error(le(191,r));r.call(i)}}}var Us=(new se.Component).refs;function qs(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:$e({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Gs={isMounted:function(e){return!!(e=e._reactInternals)&&qt(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=ru(),r=ou(e),o=Bs(i,r);o.payload=t,null!=n&&(o.callback=n),null!==(t=Ns(e,o,r))&&(su(t,e,r,i),Fs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=ru(),r=ou(e),o=Bs(i,r);o.tag=1,o.payload=t,null!=n&&(o.callback=n),null!==(t=Ns(e,o,r))&&(su(t,e,r,i),Fs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ru(),i=ou(e),r=Bs(n,i);r.tag=2,null!=t&&(r.callback=t),null!==(t=Ns(e,r,i))&&(su(t,e,i,n),Fs(t,e,i))}};function Ws(e,t,n,i,r,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,s):!(t.prototype&&t.prototype.isPureReactComponent&&ur(n,i)&&ur(r,o))}function Hs(e,t,n){var i=!1,r=Ao,o=t.contextType;return"object"==typeof o&&null!==o?o=Is(o):(r=zo(t)?Do:Po.current,o=(i=null!=(i=t.contextTypes))?Ro(e,r):Ao),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Gs,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function Zs(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Gs.enqueueReplaceState(t,t.state,null)}function Xs(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=Us,zs(e);var o=t.contextType;"object"==typeof o&&null!==o?r.context=Is(o):(o=zo(t)?Do:Po.current,r.context=Ro(e,o)),r.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(qs(e,t,o,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Gs.enqueueReplaceState(r,r.state,null),js(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}function Ks(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(le(309));var i=n.stateNode}if(!i)throw Error(le(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===Us&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!=typeof e)throw Error(le(284));if(!n._owner)throw Error(le(290,e))}return e}function Js(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ys(e){return(0,e._init)(e._payload)}function Qs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Bu(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function a(e,t,n,i){return null===t||6!==t.tag?((t=ju(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function l(e,t,n,i){var o=n.type;return o===Te?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===ze&&Ys(o)===t.type)?((i=r(t,n.props)).ref=Ks(e,t,n),i.return=e,i):((i=Nu(n.type,n.key,n.props,null,e.mode,i)).ref=Ks(e,t,n),i.return=e,i)}function c(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vu(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function u(e,t,n,i,o){return null===t||7!==t.tag?((t=Fu(n,e.mode,i,o)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=ju(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Ee:return(n=Nu(t.type,t.key,t.props,null,e.mode,n)).ref=Ks(e,null,t),n.return=e,n;case Se:return(t=Vu(t,e.mode,n)).return=e,t;case ze:return d(e,(0,t._init)(t._payload),n)}if(rt(t)||Ne(t))return(t=Fu(t,e.mode,n,null)).return=e,t;Js(e,t)}return null}function h(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:a(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Ee:return n.key===r?l(e,t,n,i):null;case Se:return n.key===r?c(e,t,n,i):null;case ze:return h(e,t,(r=n._init)(n._payload),i)}if(rt(n)||Ne(n))return null!==r?null:u(e,t,n,i,null);Js(e,n)}return null}function p(e,t,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i)return a(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case Ee:return l(t,e=e.get(null===i.key?n:i.key)||null,i,r);case Se:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case ze:return p(e,t,n,(0,i._init)(i._payload),r)}if(rt(i)||Ne(i))return u(t,e=e.get(n)||null,i,r,null);Js(t,i)}return null}function f(r,s,a,l){for(var c=null,u=null,f=s,m=s=0,g=null;null!==f&&m<a.length;m++){f.index>m?(g=f,f=null):g=f.sibling;var y=h(r,f,a[m],l);if(null===y){null===f&&(f=g);break}e&&f&&null===y.alternate&&t(r,f),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y,f=g}if(m===a.length)return n(r,f),ls&&ts(r,m),c;if(null===f){for(;m<a.length;m++)null!==(f=d(r,a[m],l))&&(s=o(f,s,m),null===u?c=f:u.sibling=f,u=f);return ls&&ts(r,m),c}for(f=i(r,f);m<a.length;m++)null!==(g=p(f,r,m,a[m],l))&&(e&&null!==g.alternate&&f.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&f.forEach((function(e){return t(r,e)})),ls&&ts(r,m),c}function m(r,s,a,l){var c=Ne(a);if("function"!=typeof c)throw Error(le(150));if(null==(a=c.call(a)))throw Error(le(151));for(var u=c=null,f=s,m=s=0,g=null,y=a.next();null!==f&&!y.done;m++,y=a.next()){f.index>m?(g=f,f=null):g=f.sibling;var v=h(r,f,y.value,l);if(null===v){null===f&&(f=g);break}e&&f&&null===v.alternate&&t(r,f),s=o(v,s,m),null===u?c=v:u.sibling=v,u=v,f=g}if(y.done)return n(r,f),ls&&ts(r,m),c;if(null===f){for(;!y.done;m++,y=a.next())null!==(y=d(r,y.value,l))&&(s=o(y,s,m),null===u?c=y:u.sibling=y,u=y);return ls&&ts(r,m),c}for(f=i(r,f);!y.done;m++,y=a.next())null!==(y=p(f,r,m,y.value,l))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y);return e&&f.forEach((function(e){return t(r,e)})),ls&&ts(r,m),c}return function e(i,o,a,l){if("object"==typeof a&&null!==a&&a.type===Te&&null===a.key&&(a=a.props.children),"object"==typeof a&&null!==a){switch(a.$$typeof){case Ee:e:{for(var c=a.key,u=o;null!==u;){if(u.key===c){if((c=a.type)===Te){if(7===u.tag){n(i,u.sibling),(o=r(u,a.props.children)).return=i,i=o;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===ze&&Ys(c)===u.type){n(i,u.sibling),(o=r(u,a.props)).ref=Ks(i,u,a),o.return=i,i=o;break e}n(i,u);break}t(i,u),u=u.sibling}a.type===Te?((o=Fu(a.props.children,i.mode,l,a.key)).return=i,i=o):((l=Nu(a.type,a.key,a.props,null,i.mode,l)).ref=Ks(i,o,a),l.return=i,i=l)}return s(i);case Se:e:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(i,o.sibling),(o=r(o,a.children||[])).return=i,i=o;break e}n(i,o);break}t(i,o),o=o.sibling}(o=Vu(a,i.mode,l)).return=i,i=o}return s(i);case ze:return e(i,o,(u=a._init)(a._payload),l)}if(rt(a))return f(i,o,a,l);if(Ne(a))return m(i,o,a,l);Js(i,a)}return"string"==typeof a&&""!==a||"number"==typeof a?(a=""+a,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,a)).return=i,i=o):(n(i,o),(o=ju(a,i.mode,l)).return=i,i=o),s(i)):n(i,o)}}var ea=Qs(!0),ta=Qs(!1),na={},ia=Co(na),ra=Co(na),oa=Co(na);function sa(e){if(e===na)throw Error(le(174));return e}function aa(e,t){switch(Io(oa,t),Io(ra,e),Io(ia,na),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dt(null,"");break;default:t=dt(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Mo(ia),Io(ia,t)}function la(){Mo(ia),Mo(ra),Mo(oa)}function ca(e){sa(oa.current);var t=sa(ia.current),n=dt(t,e.type);t!==n&&(Io(ra,e),Io(ia,n))}function ua(e){ra.current===e&&(Mo(ia),Mo(ra))}var da=Co(0);function ha(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var pa=[];function fa(){for(var e=0;e<pa.length;e++)pa[e]._workInProgressVersionPrimary=null;pa.length=0}var ma=ke.ReactCurrentDispatcher,ga=ke.ReactCurrentBatchConfig,ya=0,va=null,ba=null,xa=null,_a=!1,wa=!1,ka=0,Ea=0;function Sa(){throw Error(le(321))}function Ta(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!cr(e[n],t[n]))return!1;return!0}function Ca(e,t,n,i,r,o){if(ya=o,va=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ma.current=null===e||null===e.memoizedState?ul:dl,e=n(i,r),wa){o=0;do{if(wa=!1,ka=0,25<=o)throw Error(le(301));o+=1,xa=ba=null,t.updateQueue=null,ma.current=hl,e=n(i,r)}while(wa)}if(ma.current=cl,t=null!==ba&&null!==ba.next,ya=0,xa=ba=va=null,_a=!1,t)throw Error(le(300));return e}function Ma(){var e=0!==ka;return ka=0,e}function Ia(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===xa?va.memoizedState=xa=e:xa=xa.next=e,xa}function Aa(){if(null===ba){var e=va.alternate;e=null!==e?e.memoizedState:null}else e=ba.next;var t=null===xa?va.memoizedState:xa.next;if(null!==t)xa=t,ba=e;else{if(null===e)throw Error(le(310));e={memoizedState:(ba=e).memoizedState,baseState:ba.baseState,baseQueue:ba.baseQueue,queue:ba.queue,next:null},null===xa?va.memoizedState=xa=e:xa=xa.next=e}return xa}function Pa(e,t){return"function"==typeof t?t(e):t}function Oa(e){var t=Aa(),n=t.queue;if(null===n)throw Error(le(311));n.lastRenderedReducer=e;var i=ba,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((ya&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(a=l=d,s=i):l=l.next=d,va.lanes|=u,$c|=u}c=c.next}while(null!==c&&c!==o);null===l?s=i:l.next=a,cr(i,t.memoizedState)||(kl=!0),t.memoizedState=i,t.baseState=s,t.baseQueue=l,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,va.lanes|=o,$c|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Da(e){var t=Aa(),n=t.queue;if(null===n)throw Error(le(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{o=e(o,s.action),s=s.next}while(s!==r);cr(o,t.memoizedState)||(kl=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Ra(){}function za(e,t){var n=va,i=Aa(),r=t(),o=!cr(i.memoizedState,r);if(o&&(i.memoizedState=r,kl=!0),i=i.queue,Ha(Na.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==xa&&1&xa.memoizedState.tag){if(n.flags|=2048,Va(9,Ba.bind(null,n,i,r,t),void 0,null),null===Dc)throw Error(le(349));0!=(30&ya)||La(n,t,r)}return r}function La(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ba(e,t,n,i){t.value=n,t.getSnapshot=i,Fa(t)&&$a(e)}function Na(e,t,n){return n((function(){Fa(t)&&$a(e)}))}function Fa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!cr(e,n)}catch(_T){return!0}}function $a(e){var t=Ds(e,1);null!==t&&su(t,e,1,-1)}function ja(e){var t=Ia();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:e},t.queue=e,e=e.dispatch=ol.bind(null,va,e),[t.memoizedState,e]}function Va(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=va.updateQueue)?(t={lastEffect:null,stores:null},va.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ua(){return Aa().memoizedState}function qa(e,t,n,i){var r=Ia();va.flags|=e,r.memoizedState=Va(1|t,n,void 0,void 0===i?null:i)}function Ga(e,t,n,i){var r=Aa();i=void 0===i?null:i;var o=void 0;if(null!==ba){var s=ba.memoizedState;if(o=s.destroy,null!==i&&Ta(i,s.deps))return void(r.memoizedState=Va(t,n,o,i))}va.flags|=e,r.memoizedState=Va(1|t,n,o,i)}function Wa(e,t){return qa(8390656,8,e,t)}function Ha(e,t){return Ga(2048,8,e,t)}function Za(e,t){return Ga(4,2,e,t)}function Xa(e,t){return Ga(4,4,e,t)}function Ka(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ja(e,t,n){return n=null!=n?n.concat([e]):null,Ga(4,4,Ka.bind(null,t,e),n)}function Ya(){}function Qa(e,t){var n=Aa();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Ta(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function el(e,t){var n=Aa();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Ta(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function tl(e,t,n){return 0==(21&ya)?(e.baseState&&(e.baseState=!1,kl=!0),e.memoizedState=n):(cr(n,t)||(n=vn(),va.lanes|=n,$c|=n,e.baseState=!0),t)}function nl(e,t){var n=wn;wn=0!==n&&4>n?n:4,e(!0);var i=ga.transition;ga.transition={};try{e(!1),t()}finally{wn=n,ga.transition=i}}function il(){return Aa().memoizedState}function rl(e,t,n){var i=ou(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},sl(e)?al(t,n):null!==(n=Os(e,t,n,i))&&(su(n,e,i,ru()),ll(n,t,i))}function ol(e,t,n){var i=ou(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(sl(e))al(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(r.hasEagerState=!0,r.eagerState=a,cr(a,s)){var l=t.interleaved;return null===l?(r.next=r,Ps(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(CT){}null!==(n=Os(e,t,r,i))&&(su(n,e,i,r=ru()),ll(n,t,i))}}function sl(e){var t=e.alternate;return e===va||null!==t&&t===va}function al(e,t){wa=_a=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ll(e,t,n){if(0!=(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,_n(e,n)}}var cl={readContext:Is,useCallback:Sa,useContext:Sa,useEffect:Sa,useImperativeHandle:Sa,useInsertionEffect:Sa,useLayoutEffect:Sa,useMemo:Sa,useReducer:Sa,useRef:Sa,useState:Sa,useDebugValue:Sa,useDeferredValue:Sa,useTransition:Sa,useMutableSource:Sa,useSyncExternalStore:Sa,useId:Sa,unstable_isNewReconciler:!1},ul={readContext:Is,useCallback:function(e,t){return Ia().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:Wa,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,qa(4194308,4,Ka.bind(null,t,e),n)},useLayoutEffect:function(e,t){return qa(4194308,4,e,t)},useInsertionEffect:function(e,t){return qa(4,2,e,t)},useMemo:function(e,t){var n=Ia();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Ia();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=rl.bind(null,va,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Ia().memoizedState=e},useState:ja,useDebugValue:Ya,useDeferredValue:function(e){return Ia().memoizedState=e},useTransition:function(){var e=ja(!1),t=e[0];return e=nl.bind(null,e[1]),Ia().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=va,r=Ia();if(ls){if(void 0===n)throw Error(le(407));n=n()}else{if(n=t(),null===Dc)throw Error(le(349));0!=(30&ya)||La(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Wa(Na.bind(null,i,o,e),[e]),i.flags|=2048,Va(9,Ba.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=Ia(),t=Dc.identifierPrefix;if(ls){var n=es;t=":"+t+"R"+(n=(Qo&~(1<<32-cn(Qo)-1)).toString(32)+n),0<(n=ka++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ea++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},dl={readContext:Is,useCallback:Qa,useContext:Is,useEffect:Ha,useImperativeHandle:Ja,useInsertionEffect:Za,useLayoutEffect:Xa,useMemo:el,useReducer:Oa,useRef:Ua,useState:function(){return Oa(Pa)},useDebugValue:Ya,useDeferredValue:function(e){return tl(Aa(),ba.memoizedState,e)},useTransition:function(){return[Oa(Pa)[0],Aa().memoizedState]},useMutableSource:Ra,useSyncExternalStore:za,useId:il,unstable_isNewReconciler:!1},hl={readContext:Is,useCallback:Qa,useContext:Is,useEffect:Ha,useImperativeHandle:Ja,useInsertionEffect:Za,useLayoutEffect:Xa,useMemo:el,useReducer:Da,useRef:Ua,useState:function(){return Da(Pa)},useDebugValue:Ya,useDeferredValue:function(e){var t=Aa();return null===ba?t.memoizedState=e:tl(t,ba.memoizedState,e)},useTransition:function(){return[Da(Pa)[0],Aa().memoizedState]},useMutableSource:Ra,useSyncExternalStore:za,useId:il,unstable_isNewReconciler:!1};function pl(e,t){try{var n="",i=t;do{n+=qe(i),i=i.return}while(i);var r=n}catch(kT){r="\nError generating stack: "+kT.message+"\n"+kT.stack}return{value:e,source:t,stack:r,digest:null}}function fl(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ml(e,t){try{console.error(t.value)}catch(xT){setTimeout((function(){throw xT}))}}var gl="function"==typeof WeakMap?WeakMap:Map;function yl(e,t,n){(n=Bs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Zc||(Zc=!0,Xc=i),ml(0,t)},n}function vl(e,t,n){(n=Bs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){ml(0,t)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){ml(0,t),"function"!=typeof i&&(null===Kc?Kc=new Set([this]):Kc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function bl(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new gl;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Iu.bind(null,e,t,n),t.then(e,e))}function xl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _l(e,t,n,i,r){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bs(-1,1)).tag=2,Ns(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var wl=ke.ReactCurrentOwner,kl=!1;function El(e,t,n,i){t.child=null===e?ta(t,null,n,i):ea(t,e.child,n,i)}function Sl(e,t,n,i,r){n=n.render;var o=t.ref;return Ms(t,r),i=Ca(e,t,n,i,o,r),n=Ma(),null===e||kl?(ls&&n&&is(t),t.flags|=1,El(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zl(e,t,r))}function Tl(e,t,n,i,r){if(null===e){var o=n.type;return"function"!=typeof o||Lu(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Nu(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Cl(e,t,o,i,r))}if(o=e.child,0==(e.lanes&r)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(s,i)&&e.ref===t.ref)return Zl(e,t,r)}return t.flags|=1,(e=Bu(o,i)).ref=t.ref,e.return=t,t.child=e}function Cl(e,t,n,i,r){if(null!==e){var o=e.memoizedProps;if(ur(o,i)&&e.ref===t.ref){if(kl=!1,t.pendingProps=i=o,0==(e.lanes&r))return t.lanes=e.lanes,Zl(e,t,r);0!=(131072&e.flags)&&(kl=!0)}}return Al(e,t,n,i,r)}function Ml(e,t,n){var i=t.pendingProps,r=i.children,o=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Io(Bc,Lc),Lc|=n;else{if(0==(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Io(Bc,Lc),Lc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Io(Bc,Lc),Lc|=i}else null!==o?(i=o.baseLanes|n,t.memoizedState=null):i=n,Io(Bc,Lc),Lc|=i;return El(e,t,r,n),t.child}function Il(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Al(e,t,n,i,r){var o=zo(n)?Do:Po.current;return o=Ro(t,o),Ms(t,r),n=Ca(e,t,n,i,o,r),i=Ma(),null===e||kl?(ls&&i&&is(t),t.flags|=1,El(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Zl(e,t,r))}function Pl(e,t,n,i,r){if(zo(n)){var o=!0;Fo(t)}else o=!1;if(Ms(t,r),null===t.stateNode)Hl(e,t),Hs(t,n,i),Xs(t,n,i,r),i=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;c="object"==typeof c&&null!==c?Is(c):Ro(t,c=zo(n)?Do:Po.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==i||l!==c)&&Zs(t,s,i,c),Rs=!1;var h=t.memoizedState;s.state=h,js(t,i,s,r),l=t.memoizedState,a!==i||h!==l||Oo.current||Rs?("function"==typeof u&&(qs(t,n,u,i),l=t.memoizedState),(a=Rs||Ws(t,n,a,i,h,l,c))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,Ls(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:xs(t.type,a),s.props=c,d=t.pendingProps,h=s.context,l="object"==typeof(l=n.contextType)&&null!==l?Is(l):Ro(t,l=zo(n)?Do:Po.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==d||h!==l)&&Zs(t,s,i,l),Rs=!1,h=t.memoizedState,s.state=h,js(t,i,s,r);var f=t.memoizedState;a!==d||h!==f||Oo.current||Rs?("function"==typeof p&&(qs(t,n,p,i),f=t.memoizedState),(c=Rs||Ws(t,n,c,i,h,f,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,f,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,f,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),s.props=i,s.state=f,s.context=l,i=c):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Ol(e,t,n,i,o,r)}function Ol(e,t,n,i,r,o){Il(e,t);var s=0!=(128&t.flags);if(!i&&!s)return r&&$o(t,n,!1),Zl(e,t,o);i=t.stateNode,wl.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&s?(t.child=ea(t,e.child,null,o),t.child=ea(t,null,a,o)):El(e,t,a,o),t.memoizedState=i.state,r&&$o(t,n,!0),t.child}function Dl(e){var t=e.stateNode;t.pendingContext?Bo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Bo(0,t.context,!1),aa(e,t.containerInfo)}function Rl(e,t,n,i,r){return ys(),vs(r),t.flags|=256,El(e,t,n,i),t.child}var zl,Ll,Bl,Nl,Fl={dehydrated:null,treeContext:null,retryLane:0};function $l(e){return{baseLanes:e,cachePool:null,transitions:null}}function jl(e,t,n){var i,r=t.pendingProps,o=da.current,s=!1,a=0!=(128&t.flags);if((i=a)||(i=(null===e||null!==e.memoizedState)&&0!=(2&o)),i?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Io(da,1&o),null===e)return ps(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(a=r.children,e=r.fallback,s?(r=t.mode,s=t.child,a={mode:"hidden",children:a},0==(1&r)&&null!==s?(s.childLanes=0,s.pendingProps=a):s=$u(a,r,0,null),e=Fu(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=$l(n),t.memoizedState=Fl,e):Vl(t,a));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,s){if(n)return 256&t.flags?(t.flags&=-257,Ul(e,t,s,i=fl(Error(le(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=$u({mode:"visible",children:i.children},r,0,null),(o=Fu(o,r,s,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!=(1&t.mode)&&ea(t,e.child,null,s),t.child.memoizedState=$l(s),t.memoizedState=Fl,o);if(0==(1&t.mode))return Ul(e,t,s,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var a=i.dgst;return i=a,Ul(e,t,s,i=fl(o=Error(le(419)),i,void 0))}if(a=0!=(s&e.childLanes),kl||a){if(null!==(i=Dc)){switch(s&-s){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!=(r&(i.suspendedLanes|s))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Ds(e,r),su(i,e,r,-1))}return bu(),Ul(e,t,s,i=fl(Error(le(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Pu.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,as=ho(r.nextSibling),ss=t,ls=!0,cs=null,null!==e&&(Ko[Jo++]=Qo,Ko[Jo++]=es,Ko[Jo++]=Yo,Qo=e.id,es=e.overflow,Yo=t),(t=Vl(t,i.children)).flags|=4096,t)}(e,t,a,r,i,o,n);if(s){s=r.fallback,a=t.mode,i=(o=e.child).sibling;var l={mode:"hidden",children:r.children};return 0==(1&a)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=l,t.deletions=null):(r=Bu(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==i?s=Bu(i,s):(s=Fu(s,a,n,null)).flags|=2,s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,a=null===(a=e.child.memoizedState)?$l(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~n,t.memoizedState=Fl,r}return e=(s=e.child).sibling,r=Bu(s,{mode:"visible",children:r.children}),0==(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Vl(e,t){return(t=$u({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ul(e,t,n,i){return null!==i&&vs(i),ea(t,e.child,null,n),(e=Vl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ql(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Cs(e.return,t,n)}function Gl(e,t,n,i,r){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Wl(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;if(El(e,t,i.children,n),0!=(2&(i=da.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ql(e,n,t);else if(19===e.tag)ql(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Io(da,i),0==(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ha(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Gl(t,!1,r,n,o);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ha(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Gl(t,!0,n,null,o);break;case"together":Gl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hl(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zl(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),$c|=t.lanes,0==(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(le(153));if(null!==t.child){for(n=Bu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Bu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Xl(e,t){if(!ls)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Kl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Jl(e,t,n){var i=t.pendingProps;switch(rs(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kl(t),null;case 1:case 17:return zo(t.type)&&Lo(),Kl(t),null;case 3:return i=t.stateNode,la(),Mo(Oo),Mo(Po),fa(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ms(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==cs&&(uu(cs),cs=null))),Ll(e,t),Kl(t),null;case 5:ua(t);var r=sa(oa.current);if(n=t.type,null!==e&&null!=t.stateNode)Bl(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(le(166));return Kl(t),null}if(e=sa(ia.current),ms(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[mo]=t,i[go]=o,e=0!=(1&t.mode),n){case"dialog":jr("cancel",i),jr("close",i);break;case"iframe":case"object":case"embed":jr("load",i);break;case"video":case"audio":for(r=0;r<Br.length;r++)jr(Br[r],i);break;case"source":jr("error",i);break;case"img":case"image":case"link":jr("error",i),jr("load",i);break;case"details":jr("toggle",i);break;case"input":Qe(i,o),jr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},jr("invalid",i);break;case"textarea":at(i,o),jr("invalid",i)}for(var s in xt(n,o),r=null,o)if(o.hasOwnProperty(s)){var a=o[s];"children"===s?"string"==typeof a?i.textContent!==a&&(!0!==o.suppressHydrationWarning&&eo(i.textContent,a,e),r=["children",a]):"number"==typeof a&&i.textContent!==""+a&&(!0!==o.suppressHydrationWarning&&eo(i.textContent,a,e),r=["children",""+a]):ue.hasOwnProperty(s)&&null!=a&&"onScroll"===s&&jr("scroll",i)}switch(n){case"input":Xe(i),nt(i,o,!0);break;case"textarea":Xe(i),ct(i);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(i.onclick=to)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{s=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ut(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=s.createElement(n,{is:i.is}):(e=s.createElement(n),"select"===n&&(s=e,i.multiple?s.multiple=!0:i.size&&(s.size=i.size))):e=s.createElementNS(e,n),e[mo]=t,e[go]=i,zl(e,t,!1,!1),t.stateNode=e;e:{switch(s=_t(n,i),n){case"dialog":jr("cancel",e),jr("close",e),r=i;break;case"iframe":case"object":case"embed":jr("load",e),r=i;break;case"video":case"audio":for(r=0;r<Br.length;r++)jr(Br[r],e);r=i;break;case"source":jr("error",e),r=i;break;case"img":case"image":case"link":jr("error",e),jr("load",e),r=i;break;case"details":jr("toggle",e),r=i;break;case"input":Qe(e,i),r=Ye(e,i),jr("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=$e({},i,{value:void 0}),jr("invalid",e);break;case"textarea":at(e,i),r=st(e,i),jr("invalid",e)}for(o in xt(n,r),a=r)if(a.hasOwnProperty(o)){var l=a[o];"style"===o?vt(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&pt(e,l):"children"===o?"string"==typeof l?("textarea"!==n||""!==l)&&ft(e,l):"number"==typeof l&&ft(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(ue.hasOwnProperty(o)?null!=l&&"onScroll"===o&&jr("scroll",e):null!=l&&we(e,o,l,s))}switch(n){case"input":Xe(e),nt(e,i,!1);break;case"textarea":Xe(e),ct(e);break;case"option":null!=i.value&&e.setAttribute("value",""+He(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ot(e,!!i.multiple,o,!1):null!=i.defaultValue&&ot(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof r.onClick&&(e.onclick=to)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Kl(t),null;case 6:if(e&&null!=t.stateNode)Nl(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(le(166));if(n=sa(oa.current),sa(ia.current),ms(t)){if(i=t.stateNode,n=t.memoizedProps,i[mo]=t,(o=i.nodeValue!==n)&&null!==(e=ss))switch(e.tag){case 3:eo(i.nodeValue,n,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&eo(i.nodeValue,n,0!=(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[mo]=t,t.stateNode=i}return Kl(t),null;case 13:if(Mo(da),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ls&&null!==as&&0!=(1&t.mode)&&0==(128&t.flags))gs(),ys(),t.flags|=98560,o=!1;else if(o=ms(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(le(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(le(317));o[mo]=t}else ys(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Kl(t),o=!1}else null!==cs&&(uu(cs),cs=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=n,t):((i=null!==i)!=(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&da.current)?0===Nc&&(Nc=3):bu())),null!==t.updateQueue&&(t.flags|=4),Kl(t),null);case 4:return la(),Ll(e,t),null===e&&qr(t.stateNode.containerInfo),Kl(t),null;case 10:return Ts(t.type._context),Kl(t),null;case 19:if(Mo(da),null===(o=t.memoizedState))return Kl(t),null;if(i=0!=(128&t.flags),null===(s=o.rendering))if(i)Xl(o,!1);else{if(0!==Nc||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=ha(e))){for(t.flags|=128,Xl(o,!1),null!==(i=s.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(s=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Io(da,1&da.current|2),t.child}e=e.sibling}null!==o.tail&&Qt()>Wc&&(t.flags|=128,i=!0,Xl(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ha(s))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Xl(o,!0),null===o.tail&&"hidden"===o.tailMode&&!s.alternate&&!ls)return Kl(t),null}else 2*Qt()-o.renderingStartTime>Wc&&1073741824!==n&&(t.flags|=128,i=!0,Xl(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=o.last)?n.sibling=s:t.child=s,o.last=s)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qt(),t.sibling=null,n=da.current,Io(da,i?1&n|2:1&n),t):(Kl(t),null);case 22:case 23:return mu(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!=(1&t.mode)?0!=(1073741824&Lc)&&(Kl(t),6&t.subtreeFlags&&(t.flags|=8192)):Kl(t),null;case 24:case 25:return null}throw Error(le(156,t.tag))}function Yl(e,t){switch(rs(t),t.tag){case 1:return zo(t.type)&&Lo(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return la(),Mo(Oo),Mo(Po),fa(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ua(t),null;case 13:if(Mo(da),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(le(340));ys()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Mo(da),null;case 4:return la(),null;case 10:return Ts(t.type._context),null;case 22:case 23:return mu(),null;default:return null}}zl=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ll=function(){},Bl=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,sa(ia.current);var o,s=null;switch(n){case"input":r=Ye(e,r),i=Ye(e,i),s=[];break;case"select":r=$e({},r,{value:void 0}),i=$e({},i,{value:void 0}),s=[];break;case"textarea":r=st(e,r),i=st(e,i),s=[];break;default:"function"!=typeof r.onClick&&"function"==typeof i.onClick&&(e.onclick=to)}for(c in xt(n,i),n=null,r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(ue.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=null!=r?r[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(null!=l||null!=a))if("style"===c)if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(s=s||[]).push(c,l)):"children"===c?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(ue.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&jr("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}},Nl=function(e,t,n,i){n!==i&&(t.flags|=4)};var Ql=!1,ec=!1,tc="function"==typeof WeakSet?WeakSet:Set,nc=null;function ic(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(_T){Mu(e,t,_T)}else n.current=null}function rc(e,t,n){try{n()}catch(_T){Mu(e,t,_T)}}var oc=!1;function sc(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,void 0!==o&&rc(t,n,o)}r=r.next}while(r!==i)}}function ac(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function lc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function cc(e){var t=e.alternate;null!==t&&(e.alternate=null,cc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[mo],delete t[go],delete t[vo],delete t[bo],delete t[xo]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function uc(e){return 5===e.tag||3===e.tag||4===e.tag}function dc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||uc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function hc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=to));else if(4!==i&&null!==(e=e.child))for(hc(e,t,n),e=e.sibling;null!==e;)hc(e,t,n),e=e.sibling}function pc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(pc(e,t,n),e=e.sibling;null!==e;)pc(e,t,n),e=e.sibling}var fc=null,mc=!1;function gc(e,t,n){for(n=n.child;null!==n;)yc(e,t,n),n=n.sibling}function yc(e,t,n){if(ln&&"function"==typeof ln.onCommitFiberUnmount)try{ln.onCommitFiberUnmount(an,n)}catch(ST){}switch(n.tag){case 5:ec||ic(n,t);case 6:var i=fc,r=mc;fc=null,gc(e,t,n),mc=r,null!==(fc=i)&&(mc?(e=fc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):fc.removeChild(n.stateNode));break;case 18:null!==fc&&(mc?(e=fc,n=n.stateNode,8===e.nodeType?uo(e.parentNode,n):1===e.nodeType&&uo(e,n),Gn(e)):uo(fc,n.stateNode));break;case 4:i=fc,r=mc,fc=n.stateNode.containerInfo,mc=!0,gc(e,t,n),fc=i,mc=r;break;case 0:case 11:case 14:case 15:if(!ec&&null!==(i=n.updateQueue)&&null!==(i=i.lastEffect)){r=i=i.next;do{var o=r,s=o.destroy;o=o.tag,void 0!==s&&(0!=(2&o)||0!=(4&o))&&rc(n,t,s),r=r.next}while(r!==i)}gc(e,t,n);break;case 1:if(!ec&&(ic(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(ST){Mu(n,t,ST)}gc(e,t,n);break;case 21:gc(e,t,n);break;case 22:1&n.mode?(ec=(i=ec)||null!==n.memoizedState,gc(e,t,n),ec=i):gc(e,t,n);break;default:gc(e,t,n)}}function vc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new tc),t.forEach((function(t){var i=Ou.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function bc(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,s=t,a=s;e:for(;null!==a;){switch(a.tag){case 5:fc=a.stateNode,mc=!1;break e;case 3:case 4:fc=a.stateNode.containerInfo,mc=!0;break e}a=a.return}if(null===fc)throw Error(le(160));yc(o,s,r),fc=null,mc=!1;var l=r.alternate;null!==l&&(l.return=null),r.return=null}catch(CT){Mu(r,t,CT)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)xc(t,e),t=t.sibling}function xc(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bc(t,e),_c(e),4&i){try{sc(3,e,e.return),ac(3,e)}catch(OT){Mu(e,e.return,OT)}try{sc(5,e,e.return)}catch(OT){Mu(e,e.return,OT)}}break;case 1:bc(t,e),_c(e),512&i&&null!==n&&ic(n,n.return);break;case 5:if(bc(t,e),_c(e),512&i&&null!==n&&ic(n,n.return),32&e.flags){var r=e.stateNode;try{ft(r,"")}catch(OT){Mu(e,e.return,OT)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,a=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===a&&"radio"===o.type&&null!=o.name&&et(r,o),_t(a,s);var c=_t(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];"style"===u?vt(r,d):"dangerouslySetInnerHTML"===u?pt(r,d):"children"===u?ft(r,d):we(r,u,d,c)}switch(a){case"input":tt(r,o);break;case"textarea":lt(r,o);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ot(r,!!o.multiple,p,!1):h!==!!o.multiple&&(null!=o.defaultValue?ot(r,!!o.multiple,o.defaultValue,!0):ot(r,!!o.multiple,o.multiple?[]:"",!1))}r[go]=o}catch(OT){Mu(e,e.return,OT)}}break;case 6:if(bc(t,e),_c(e),4&i){if(null===e.stateNode)throw Error(le(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(OT){Mu(e,e.return,OT)}}break;case 3:if(bc(t,e),_c(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Gn(t.containerInfo)}catch(OT){Mu(e,e.return,OT)}break;case 4:default:bc(t,e),_c(e);break;case 13:bc(t,e),_c(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Gc=Qt())),4&i&&vc(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?(ec=(c=ec)||u,bc(t,e),ec=c):bc(t,e),_c(e),8192&i){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!u&&0!=(1&e.mode))for(nc=e,u=e.child;null!==u;){for(d=nc=u;null!==nc;){switch(p=(h=nc).child,h.tag){case 0:case 11:case 14:case 15:sc(4,h,h.return);break;case 1:ic(h,h.return);var f=h.stateNode;if("function"==typeof f.componentWillUnmount){i=h,n=h.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(OT){Mu(i,n,OT)}}break;case 5:ic(h,h.return);break;case 22:if(null!==h.memoizedState){Sc(d);continue}}null!==p?(p.return=h,nc=p):Sc(d)}u=u.sibling}e:for(u=null,d=e;;){if(5===d.tag){if(null===u){u=d;try{r=d.stateNode,c?"function"==typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(a=d.stateNode,s=null!=(l=d.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,a.style.display=yt("display",s))}catch(OT){Mu(e,e.return,OT)}}}else if(6===d.tag){if(null===u)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(OT){Mu(e,e.return,OT)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:bc(t,e),_c(e),4&i&&vc(e);case 21:}}function _c(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(uc(n)){var i=n;break e}n=n.return}throw Error(le(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(ft(r,""),i.flags&=-33),pc(e,dc(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;hc(e,dc(e),o);break;default:throw Error(le(161))}}catch(TT){Mu(e,e.return,TT)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wc(e,t,n){nc=e,kc(e)}function kc(e,t,n){for(var i=0!=(1&e.mode);null!==nc;){var r=nc,o=r.child;if(22===r.tag&&i){var s=null!==r.memoizedState||Ql;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||ec;a=Ql;var c=ec;if(Ql=s,(ec=l)&&!c)for(nc=r;null!==nc;)l=(s=nc).child,22===s.tag&&null!==s.memoizedState?Tc(r):null!==l?(l.return=s,nc=l):Tc(r);for(;null!==o;)nc=o,kc(o),o=o.sibling;nc=r,Ql=a,ec=c}Ec(e)}else 0!=(8772&r.subtreeFlags)&&null!==o?(o.return=r,nc=o):Ec(e)}}function Ec(e){for(;null!==nc;){var t=nc;if(0!=(8772&t.flags)){var n=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:ec||ac(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!ec)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:xs(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Vs(t,o,i);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vs(t,s,n)}break;case 5:var a=t.stateNode;if(null===n&&4&t.flags){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var d=u.dehydrated;null!==d&&Gn(d)}}}break;default:throw Error(le(163))}ec||512&t.flags&&lc(t)}catch(eT){Mu(t,t.return,eT)}}if(t===e){nc=null;break}if(null!==(n=t.sibling)){n.return=t.return,nc=n;break}nc=t.return}}function Sc(e){for(;null!==nc;){var t=nc;if(t===e){nc=null;break}var n=t.sibling;if(null!==n){n.return=t.return,nc=n;break}nc=t.return}}function Tc(e){for(;null!==nc;){var t=nc;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ac(4,t)}catch(TT){Mu(t,n,TT)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(TT){Mu(t,r,TT)}}var o=t.return;try{lc(t)}catch(TT){Mu(t,o,TT)}break;case 5:var s=t.return;try{lc(t)}catch(TT){Mu(t,s,TT)}}}catch(TT){Mu(t,t.return,TT)}if(t===e){nc=null;break}var a=t.sibling;if(null!==a){a.return=t.return,nc=a;break}nc=t.return}}var Cc,Mc=Math.ceil,Ic=ke.ReactCurrentDispatcher,Ac=ke.ReactCurrentOwner,Pc=ke.ReactCurrentBatchConfig,Oc=0,Dc=null,Rc=null,zc=0,Lc=0,Bc=Co(0),Nc=0,Fc=null,$c=0,jc=0,Vc=0,Uc=null,qc=null,Gc=0,Wc=1/0,Hc=null,Zc=!1,Xc=null,Kc=null,Jc=!1,Yc=null,Qc=0,eu=0,tu=null,nu=-1,iu=0;function ru(){return 0!=(6&Oc)?Qt():-1!==nu?nu:nu=Qt()}function ou(e){return 0==(1&e.mode)?1:0!=(2&Oc)&&0!==zc?zc&-zc:null!==bs.transition?(0===iu&&(iu=vn()),iu):0!==(e=wn)?e:e=void 0===(e=window.event)?16:Qn(e.type)}function su(e,t,n,i){if(50<eu)throw eu=0,tu=null,Error(le(185));xn(e,n,i),0!=(2&Oc)&&e===Dc||(e===Dc&&(0==(2&Oc)&&(jc|=n),4===Nc&&du(e,zc)),au(e,i),1===n&&0===Oc&&0==(1&t.mode)&&(Wc=Qt()+500,Vo&&Go()))}function au(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-cn(o),a=1<<s,l=r[s];-1===l?0!=(a&n)&&0==(a&i)||(r[s]=gn(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var i=mn(e,e===Dc?zc:0);if(0===i)null!==n&&Kt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Kt(n),1===t)0===e.tag?function(e){Vo=!0,qo(e)}(hu.bind(null,e)):qo(hu.bind(null,e)),lo((function(){0==(6&Oc)&&Go()})),n=null;else{switch(kn(i)){case 1:n=tn;break;case 4:n=nn;break;case 16:default:n=rn;break;case 536870912:n=sn}n=Du(n,lu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function lu(e,t){if(nu=-1,iu=0,0!=(6&Oc))throw Error(le(327));var n=e.callbackNode;if(Tu()&&e.callbackNode!==n)return null;var i=mn(e,e===Dc?zc:0);if(0===i)return null;if(0!=(30&i)||0!=(i&e.expiredLanes)||t)t=xu(e,i);else{t=i;var r=Oc;Oc|=2;var o=vu();for(Dc===e&&zc===t||(Hc=null,Wc=Qt()+500,gu(e,t));;)try{wu();break}catch(ST){yu(e,ST)}Ss(),Ic.current=o,Oc=r,null!==Rc?t=0:(Dc=null,zc=0,t=Nc)}if(0!==t){if(2===t&&0!==(r=yn(e))&&(i=r,t=cu(e,r)),1===t)throw n=Fc,gu(e,0),du(e,i),au(e,Qt()),n;if(6===t)du(e,i);else{if(r=e.current.alternate,0==(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!cr(o(),r))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=xu(e,i))&&0!==(o=yn(e))&&(i=o,t=cu(e,o)),1===t))throw n=Fc,gu(e,0),du(e,i),au(e,Qt()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(le(345));case 2:case 5:Su(e,qc,Hc);break;case 3:if(du(e,i),(130023424&i)===i&&10<(t=Gc+500-Qt())){if(0!==mn(e,0))break;if(((r=e.suspendedLanes)&i)!==i){ru(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=oo(Su.bind(null,e,qc,Hc),t);break}Su(e,qc,Hc);break;case 4:if(du(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var s=31-cn(i);o=1<<s,(s=t[s])>r&&(r=s),i&=~o}if(i=r,10<(i=(120>(i=Qt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Mc(i/1960))-i)){e.timeoutHandle=oo(Su.bind(null,e,qc,Hc),i);break}Su(e,qc,Hc);break;default:throw Error(le(329))}}}return au(e,Qt()),e.callbackNode===n?lu.bind(null,e):null}function cu(e,t){var n=Uc;return e.current.memoizedState.isDehydrated&&(gu(e,t).flags|=256),2!==(e=xu(e,t))&&(t=qc,qc=n,null!==t&&uu(t)),e}function uu(e){null===qc?qc=e:qc.push.apply(qc,e)}function du(e,t){for(t&=~Vc,t&=~jc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-cn(t),i=1<<n;e[n]=-1,t&=~i}}function hu(e){if(0!=(6&Oc))throw Error(le(327));Tu();var t=mn(e,0);if(0==(1&t))return au(e,Qt()),null;var n=xu(e,t);if(0!==e.tag&&2===n){var i=yn(e);0!==i&&(t=i,n=cu(e,i))}if(1===n)throw n=Fc,gu(e,0),du(e,t),au(e,Qt()),n;if(6===n)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Su(e,qc,Hc),au(e,Qt()),null}function pu(e,t){var n=Oc;Oc|=1;try{return e(t)}finally{0===(Oc=n)&&(Wc=Qt()+500,Vo&&Go())}}function fu(e){null!==Yc&&0===Yc.tag&&0==(6&Oc)&&Tu();var t=Oc;Oc|=1;var n=Pc.transition,i=wn;try{if(Pc.transition=null,wn=1,e)return e()}finally{wn=i,Pc.transition=n,0==(6&(Oc=t))&&Go()}}function mu(){Lc=Bc.current,Mo(Bc)}function gu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,so(n)),null!==Rc)for(n=Rc.return;null!==n;){var i=n;switch(rs(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Lo();break;case 3:la(),Mo(Oo),Mo(Po),fa();break;case 5:ua(i);break;case 4:la();break;case 13:case 19:Mo(da);break;case 10:Ts(i.type._context);break;case 22:case 23:mu()}n=n.return}if(Dc=e,Rc=e=Bu(e.current,null),zc=Lc=t,Nc=0,Fc=null,Vc=jc=$c=0,qc=Uc=null,null!==As){for(t=0;t<As.length;t++)if(null!==(i=(n=As[t]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var s=o.next;o.next=r,i.next=s}n.pending=i}As=null}return e}function yu(e,t){for(;;){var n=Rc;try{if(Ss(),ma.current=cl,_a){for(var i=va.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}_a=!1}if(ya=0,xa=ba=va=null,wa=!1,ka=0,Ac.current=null,null===n||null===n.return){Nc=1,Fc=t,Rc=null;break}e:{var o=e,s=n.return,a=n,l=t;if(t=zc,a.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,u=a,d=u.tag;if(0==(1&u.mode)&&(0===d||11===d||15===d)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=xl(s);if(null!==p){p.flags&=-257,_l(p,s,a,0,t),1&p.mode&&bl(o,c,t),l=c;var f=(t=p).updateQueue;if(null===f){var m=new Set;m.add(l),t.updateQueue=m}else f.add(l);break e}if(0==(1&t)){bl(o,c,t),bu();break e}l=Error(le(426))}else if(ls&&1&a.mode){var g=xl(s);if(null!==g){0==(65536&g.flags)&&(g.flags|=256),_l(g,s,a,0,t),vs(pl(l,a));break e}}o=l=pl(l,a),4!==Nc&&(Nc=2),null===Uc?Uc=[o]:Uc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,$s(o,yl(0,l,t));break e;case 1:a=l;var y=o.type,v=o.stateNode;if(0==(128&o.flags)&&("function"==typeof y.getDerivedStateFromError||null!==v&&"function"==typeof v.componentDidCatch&&(null===Kc||!Kc.has(v)))){o.flags|=65536,t&=-t,o.lanes|=t,$s(o,vl(o,a,t));break e}}o=o.return}while(null!==o)}Eu(n)}catch(b){t=b,Rc===n&&null!==n&&(Rc=n=n.return);continue}break}}function vu(){var e=Ic.current;return Ic.current=cl,null===e?cl:e}function bu(){0!==Nc&&3!==Nc&&2!==Nc||(Nc=4),null===Dc||0==(268435455&$c)&&0==(268435455&jc)||du(Dc,zc)}function xu(e,t){var n=Oc;Oc|=2;var i=vu();for(Dc===e&&zc===t||(Hc=null,gu(e,t));;)try{_u();break}catch(wT){yu(e,wT)}if(Ss(),Oc=n,Ic.current=i,null!==Rc)throw Error(le(261));return Dc=null,zc=0,Nc}function _u(){for(;null!==Rc;)ku(Rc)}function wu(){for(;null!==Rc&&!Jt();)ku(Rc)}function ku(e){var t=Cc(e.alternate,e,Lc);e.memoizedProps=e.pendingProps,null===t?Eu(e):Rc=t,Ac.current=null}function Eu(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(n=Jl(n,t,Lc)))return void(Rc=n)}else{if(null!==(n=Yl(n,t)))return n.flags&=32767,void(Rc=n);if(null===e)return Nc=6,void(Rc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rc=t);Rc=t=e}while(null!==t);0===Nc&&(Nc=5)}function Su(e,t,n){var i=wn,r=Pc.transition;try{Pc.transition=null,wn=1,function(e,t,n,i){do{Tu()}while(null!==Yc);if(0!=(6&Oc))throw Error(le(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-cn(n),o=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~o}}(e,o),e===Dc&&(Rc=Dc=null,zc=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||Jc||(Jc=!0,Du(rn,(function(){return Tu(),null}))),o=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||o){o=Pc.transition,Pc.transition=null;var s=wn;wn=1;var a=Oc;Oc|=4,Ac.current=null,function(e,t){if(no=Hn,mr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var p;d!==n||0!==r&&3!==d.nodeType||(a=s+r),d!==o||0!==i&&3!==d.nodeType||(l=s+i),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)h=d,d=p;for(;;){if(d===e)break t;if(h===n&&++c===r&&(a=s),h===o&&++u===i&&(l=s),null!==(p=d.nextSibling))break;h=(d=h).parentNode}d=p}n=-1===a||-1===l?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(io={focusedElem:e,selectionRange:n},Hn=!1,nc=t;null!==nc;)if(e=(t=nc).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,nc=e;else for(;null!==nc;){t=nc;try{var f=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var m=f.memoizedProps,g=f.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:xs(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(le(163))}}catch(x){Mu(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,nc=e;break}nc=t.return}f=oc,oc=!1}(e,n),xc(n,e),gr(io),Hn=!!no,io=no=null,e.current=n,wc(n),Yt(),Oc=a,wn=s,Pc.transition=o}else e.current=n;if(Jc&&(Jc=!1,Yc=e,Qc=r),0===(o=e.pendingLanes)&&(Kc=null),function(e){if(ln&&"function"==typeof ln.onCommitFiberRoot)try{ln.onCommitFiberRoot(an,e,void 0,128==(128&e.current.flags))}catch(t){}}(n.stateNode),au(e,Qt()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Zc)throw Zc=!1,e=Xc,Xc=null,e;0!=(1&Qc)&&0!==e.tag&&Tu(),0!=(1&(o=e.pendingLanes))?e===tu?eu++:(eu=0,tu=e):eu=0,Go()}(e,t,n,i)}finally{Pc.transition=r,wn=i}return null}function Tu(){if(null!==Yc){var e=kn(Qc),t=Pc.transition,n=wn;try{if(Pc.transition=null,wn=16>e?16:e,null===Yc)var i=!1;else{if(e=Yc,Yc=null,Qc=0,0!=(6&Oc))throw Error(le(331));var r=Oc;for(Oc|=4,nc=e.current;null!==nc;){var o=nc,s=o.child;if(0!=(16&nc.flags)){var a=o.deletions;if(null!==a){for(var l=0;l<a.length;l++){var c=a[l];for(nc=c;null!==nc;){var u=nc;switch(u.tag){case 0:case 11:case 15:sc(8,u,o)}var d=u.child;if(null!==d)d.return=u,nc=d;else for(;null!==nc;){var h=(u=nc).sibling,p=u.return;if(cc(u),u===c){nc=null;break}if(null!==h){h.return=p,nc=h;break}nc=p}}}var f=o.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}nc=o}}if(0!=(2064&o.subtreeFlags)&&null!==s)s.return=o,nc=s;else e:for(;null!==nc;){if(0!=(2048&(o=nc).flags))switch(o.tag){case 0:case 11:case 15:sc(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,nc=y;break e}nc=o.return}}var v=e.current;for(nc=v;null!==nc;){var b=(s=nc).child;if(0!=(2064&s.subtreeFlags)&&null!==b)b.return=s,nc=b;else e:for(s=v;null!==nc;){if(0!=(2048&(a=nc).flags))try{switch(a.tag){case 0:case 11:case 15:ac(9,a)}}catch(_){Mu(a,a.return,_)}if(a===s){nc=null;break e}var x=a.sibling;if(null!==x){x.return=a.return,nc=x;break e}nc=a.return}}if(Oc=r,Go(),ln&&"function"==typeof ln.onPostCommitFiberRoot)try{ln.onPostCommitFiberRoot(an,e)}catch(_){}i=!0}return i}finally{wn=n,Pc.transition=t}}return!1}function Cu(e,t,n){e=Ns(e,t=yl(0,t=pl(n,t),1),1),t=ru(),null!==e&&(xn(e,1,t),au(e,t))}function Mu(e,t,n){if(3===e.tag)Cu(e,e,n);else for(;null!==t;){if(3===t.tag){Cu(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Kc||!Kc.has(i))){t=Ns(t,e=vl(t,e=pl(n,e),1),1),e=ru(),null!==t&&(xn(t,1,e),au(t,e));break}}t=t.return}}function Iu(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=ru(),e.pingedLanes|=e.suspendedLanes&n,Dc===e&&(zc&n)===n&&(4===Nc||3===Nc&&(130023424&zc)===zc&&500>Qt()-Gc?gu(e,0):Vc|=n),au(e,t)}function Au(e,t){0===t&&(0==(1&e.mode)?t=1:(t=pn,0==(130023424&(pn<<=1))&&(pn=4194304)));var n=ru();null!==(e=Ds(e,t))&&(xn(e,t,n),au(e,n))}function Pu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Au(e,n)}function Ou(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(le(314))}null!==i&&i.delete(t),Au(e,n)}function Du(e,t){return Xt(e,t)}function Ru(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zu(e,t,n,i){return new Ru(e,t,n,i)}function Lu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bu(e,t){var n=e.alternate;return null===n?((n=zu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nu(e,t,n,i,r,o){var s=2;if(i=e,"function"==typeof e)Lu(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case Te:return Fu(n.children,r,o,t);case Ce:s=8,r|=8;break;case Me:return(e=zu(12,n,t,2|r)).elementType=Me,e.lanes=o,e;case Oe:return(e=zu(13,n,t,r)).elementType=Oe,e.lanes=o,e;case De:return(e=zu(19,n,t,r)).elementType=De,e.lanes=o,e;case Le:return $u(n,r,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Ie:s=10;break e;case Ae:s=9;break e;case Pe:s=11;break e;case Re:s=14;break e;case ze:s=16,i=null;break e}throw Error(le(130,null==e?e:typeof e,""))}return(t=zu(s,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Fu(e,t,n,i){return(e=zu(7,e,i,t)).lanes=n,e}function $u(e,t,n,i){return(e=zu(22,e,i,t)).elementType=Le,e.lanes=n,e.stateNode={isHidden:!1},e}function ju(e,t,n){return(e=zu(6,e,null,t)).lanes=n,e}function Vu(e,t,n){return(t=zu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uu(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bn(0),this.expirationTimes=bn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bn(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function qu(e,t,n,i,r,o,s,a,l){return e=new Uu(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=zu(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zs(o),e}function Gu(e){if(!e)return Ao;e:{if(qt(e=e._reactInternals)!==e||1!==e.tag)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(le(171))}if(1===e.tag){var n=e.type;if(zo(n))return No(e,n,t)}return t}function Wu(e,t,n,i,r,o,s,a,l){return(e=qu(n,i,!0,e,0,o,0,a,l)).context=Gu(null),n=e.current,(o=Bs(i=ru(),r=ou(n))).callback=null!=t?t:null,Ns(n,o,r),e.current.lanes=r,xn(e,r,i),au(e,i),e}function Hu(e,t,n,i){var r=t.current,o=ru(),s=ou(r);return n=Gu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bs(o,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Ns(r,t,s))&&(su(e,r,s,o),Fs(e,r,s)),s}function Zu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Xu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Ku(e,t){Xu(e,t),(e=e.alternate)&&Xu(e,t)}Cc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Oo.current)kl=!0;else{if(0==(e.lanes&n)&&0==(128&t.flags))return kl=!1,function(e,t,n){switch(t.tag){case 3:Dl(t),ys();break;case 5:ca(t);break;case 1:zo(t.type)&&Fo(t);break;case 4:aa(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Io(_s,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Io(da,1&da.current),t.flags|=128,null):0!=(n&t.child.childLanes)?jl(e,t,n):(Io(da,1&da.current),null!==(e=Zl(e,t,n))?e.sibling:null);Io(da,1&da.current);break;case 19:if(i=0!=(n&t.childLanes),0!=(128&e.flags)){if(i)return Wl(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Io(da,da.current),i)break;return null;case 22:case 23:return t.lanes=0,Ml(e,t,n)}return Zl(e,t,n)}(e,t,n);kl=0!=(131072&e.flags)}else kl=!1,ls&&0!=(1048576&t.flags)&&ns(t,Xo,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Hl(e,t),e=t.pendingProps;var r=Ro(t,Po.current);Ms(t,n),r=Ca(null,t,i,e,r,n);var o=Ma();return t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zo(i)?(o=!0,Fo(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,zs(t),r.updater=Gs,t.stateNode=r,r._reactInternals=t,Xs(t,i,e,n),t=Ol(null,t,i,!0,o,n)):(t.tag=0,ls&&o&&is(t),El(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Hl(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"==typeof e)return Lu(e)?1:0;if(null!=e){if((e=e.$$typeof)===Pe)return 11;if(e===Re)return 14}return 2}(i),e=xs(i,e),r){case 0:t=Al(null,t,i,e,n);break e;case 1:t=Pl(null,t,i,e,n);break e;case 11:t=Sl(null,t,i,e,n);break e;case 14:t=Tl(null,t,i,xs(i.type,e),n);break e}throw Error(le(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Al(e,t,i,r=t.elementType===i?r:xs(i,r),n);case 1:return i=t.type,r=t.pendingProps,Pl(e,t,i,r=t.elementType===i?r:xs(i,r),n);case 3:e:{if(Dl(t),null===e)throw Error(le(387));i=t.pendingProps,r=(o=t.memoizedState).element,Ls(e,t),js(t,i,null,n);var s=t.memoizedState;if(i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Rl(e,t,i,n,r=pl(Error(le(423)),t));break e}if(i!==r){t=Rl(e,t,i,n,r=pl(Error(le(424)),t));break e}for(as=ho(t.stateNode.containerInfo.firstChild),ss=t,ls=!0,cs=null,n=ta(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ys(),i===r){t=Zl(e,t,n);break e}El(e,t,i,n)}t=t.child}return t;case 5:return ca(t),null===e&&ps(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,s=r.children,ro(i,r)?s=null:null!==o&&ro(i,o)&&(t.flags|=32),Il(e,t),El(e,t,s,n),t.child;case 6:return null===e&&ps(t),null;case 13:return jl(e,t,n);case 4:return aa(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ea(t,null,i,n):El(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Sl(e,t,i,r=t.elementType===i?r:xs(i,r),n);case 7:return El(e,t,t.pendingProps,n),t.child;case 8:case 12:return El(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,s=r.value,Io(_s,i._currentValue),i._currentValue=s,null!==o)if(cr(o.value,s)){if(o.children===r.children&&!Oo.current){t=Zl(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var a=o.dependencies;if(null!==a){s=o.child;for(var l=a.firstContext;null!==l;){if(l.context===i){if(1===o.tag){(l=Bs(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var u=(c=c.shared).pending;null===u?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Cs(o.return,n,t),a.lanes|=n;break}l=l.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(le(341));s.lanes|=n,null!==(a=s.alternate)&&(a.lanes|=n),Cs(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}El(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Ms(t,n),i=i(r=Is(r)),t.flags|=1,El(e,t,i,n),t.child;case 14:return r=xs(i=t.type,t.pendingProps),Tl(e,t,i,r=xs(i.type,r),n);case 15:return Cl(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:xs(i,r),Hl(e,t),t.tag=1,zo(i)?(e=!0,Fo(t)):e=!1,Ms(t,n),Hs(t,i,r),Xs(t,i,r,n),Ol(null,t,i,!0,e,n);case 19:return Wl(e,t,n);case 22:return Ml(e,t,n)}throw Error(le(156,t.tag))};var Ju="function"==typeof reportError?reportError:function(e){console.error(e)};function Yu(e){this._internalRoot=e}function Qu(e){this._internalRoot=e}function ed(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function td(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function nd(){}function id(e,t,n,i,r){var o=n._reactRootContainer;if(o){var s=o;if("function"==typeof r){var a=r;r=function(){var e=Zu(s);a.call(e)}}Hu(t,s,e,r)}else s=function(e,t,n,i,r){if(r){if("function"==typeof i){var o=i;i=function(){var e=Zu(s);o.call(e)}}var s=Wu(t,i,e,0,null,!1,0,"",nd);return e._reactRootContainer=s,e[yo]=s.current,qr(8===e.nodeType?e.parentNode:e),fu(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof i){var a=i;i=function(){var e=Zu(l);a.call(e)}}var l=qu(e,0,!1,null,0,!1,0,"",nd);return e._reactRootContainer=l,e[yo]=l.current,qr(8===e.nodeType?e.parentNode:e),fu((function(){Hu(t,l,n,i)})),l}(n,t,e,r,i);return Zu(s)}Qu.prototype.render=Yu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(le(409));Hu(e,t,null,null)},Qu.prototype.unmount=Yu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fu((function(){Hu(null,e,null,null)})),t[yo]=null}},Qu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Cn();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ln.length&&0!==t&&t<Ln[n].priority;n++);Ln.splice(n,0,e),0===n&&$n(e)}},En=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=fn(t.pendingLanes);0!==n&&(_n(t,1|n),au(t,Qt()),0==(6&Oc)&&(Wc=Qt()+500,Go()))}break;case 13:fu((function(){var t=Ds(e,1);if(null!==t){var n=ru();su(t,e,1,n)}})),Ku(e,1)}},Sn=function(e){if(13===e.tag){var t=Ds(e,134217728);null!==t&&su(t,e,134217728,ru()),Ku(e,134217728)}},Tn=function(e){if(13===e.tag){var t=ou(e),n=Ds(e,t);null!==n&&su(n,e,t,ru()),Ku(e,t)}},Cn=function(){return wn},Mn=function(e,t){var n=wn;try{return wn=e,t()}finally{wn=n}},Et=function(e,t,n){switch(t){case"input":if(tt(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Eo(i);if(!r)throw Error(le(90));Ke(i),tt(i,r)}}}break;case"textarea":lt(e,n);break;case"select":null!=(t=n.value)&&ot(e,!!n.multiple,t,!1)}},At=pu,Pt=fu;var rd={usingClientEntryPoint:!1,Events:[wo,ko,Eo,Mt,It,pu]},od={findFiberByHostInstance:_o,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},sd={bundleType:od.bundleType,version:od.version,rendererPackageName:od.rendererPackageName,rendererConfig:od.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ke.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ht(e))?null:e.stateNode},findFiberByHostInstance:od.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{an=ad.inject(sd),ln=ad}catch(PW){}}ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rd,ne.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ed(t))throw Error(le(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Se,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},ne.createRoot=function(e,t){if(!ed(e))throw Error(le(299));var n=!1,i="",r=Ju;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=qu(e,1,!1,null,0,n,0,i,r),e[yo]=t.current,qr(8===e.nodeType?e.parentNode:e),new Yu(t)},ne.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(le(188));throw e=Object.keys(e).join(","),Error(le(268,e))}return e=null===(e=Ht(t))?null:e.stateNode},ne.flushSync=function(e){return fu(e)},ne.hydrate=function(e,t,n){if(!td(t))throw Error(le(200));return id(null,e,t,!0,n)},ne.hydrateRoot=function(e,t,n){if(!ed(e))throw Error(le(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",s=Ju;if(null!=n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Wu(t,null,e,1,null!=n?n:null,r,0,o,s),e[yo]=t.current,qr(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Qu(t)},ne.render=function(e,t,n){if(!td(t))throw Error(le(200));return id(null,e,t,!1,n)},ne.unmountComponentAtNode=function(e){if(!td(e))throw Error(le(40));return!!e._reactRootContainer&&(fu((function(){id(null,null,e,!1,(function(){e._reactRootContainer=null,e[yo]=null}))})),!0)},ne.unstable_batchedUpdates=pu,ne.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!td(n))throw Error(le(200));if(null==e||void 0===e._reactInternals)throw Error(le(38));return id(e,t,n,!1,i)},ne.version="18.2.0-next-9e3b772b8-20220608",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),te.exports=ne;var ld=te.exports;const cd=r(ld);var ud,dd=ld;function hd(e,t){return hd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hd(e,t)}function pd(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,hd(e,t)}ud=dd.createRoot,dd.hydrateRoot;var fd={exports:{}};function md(){}function gd(){}gd.resetWarningCache=md,fd.exports=function(){function e(e,t,n,i,r,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:gd,resetWarningCache:md};return n.PropTypes=n,n}();const yd=r(fd.exports);function vd(){return vd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},vd.apply(this,arguments)}function bd(e){return"/"===e.charAt(0)}function xd(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}function _d(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}function wd(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(Array.isArray(e))return Array.isArray(t)&&e.length===t.length&&e.every((function(e,n){return wd(e,t[n])}));if("object"==typeof e||"object"==typeof t){var n=_d(e),i=_d(t);return n!==e||i!==t?wd(n,i):Object.keys(Object.assign({},e,t)).every((function(n){return wd(e[n],t[n])}))}return!1}var kd=!0,Ed="Invariant failed";function Sd(e,t){if(!e){if(kd)throw new Error(Ed);var n="function"==typeof t?t():t,i=n?"".concat(Ed,": ").concat(n):Ed;throw new Error(i)}}function Td(e){return"/"===e.charAt(0)?e:"/"+e}function Cd(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function Md(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function Id(e){var t=e.pathname,n=e.search,i=e.hash,r=t||"/";return n&&"?"!==n&&(r+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(r+="#"===i.charAt(0)?i:"#"+i),r}function Ad(e,t,n,i){var r;"string"==typeof e?(r=function(e){var t=e||"/",n="",i="",r=t.indexOf("#");-1!==r&&(i=t.substr(r),t=t.substr(0,r));var o=t.indexOf("?");return-1!==o&&(n=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===n?"":n,hash:"#"===i?"":i}}(e),r.state=t):(void 0===(r=vd({},e)).pathname&&(r.pathname=""),r.search?"?"!==r.search.charAt(0)&&(r.search="?"+r.search):r.search="",r.hash?"#"!==r.hash.charAt(0)&&(r.hash="#"+r.hash):r.hash="",void 0!==t&&void 0===r.state&&(r.state=t));try{r.pathname=decodeURI(r.pathname)}catch(wT){throw wT instanceof URIError?new URIError('Pathname "'+r.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):wT}return n&&(r.key=n),i?r.pathname?"/"!==r.pathname.charAt(0)&&(r.pathname=function(e,t){void 0===t&&(t="");var n,i=e&&e.split("/")||[],r=t&&t.split("/")||[],o=e&&bd(e),s=t&&bd(t),a=o||s;if(e&&bd(e)?r=i:i.length&&(r.pop(),r=r.concat(i)),!r.length)return"/";if(r.length){var l=r[r.length-1];n="."===l||".."===l||""===l}else n=!1;for(var c=0,u=r.length;u>=0;u--){var d=r[u];"."===d?xd(r,u):".."===d?(xd(r,u),c++):c&&(xd(r,u),c--)}if(!a)for(;c--;c)r.unshift("..");!a||""===r[0]||r[0]&&bd(r[0])||r.unshift("");var h=r.join("/");return n&&"/"!==h.substr(-1)&&(h+="/"),h}(r.pathname,i.pathname)):r.pathname=i.pathname:r.pathname||(r.pathname="/"),r}function Pd(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&wd(e.state,t.state)}function Od(){var e=null,t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,i,r){if(null!=e){var o="function"==typeof e?e(t,n):e;"string"==typeof o?"function"==typeof i?i(o,r):r(!0):r(!1!==o)}else r(!0)},appendListener:function(e){var n=!0;function i(){n&&e.apply(void 0,arguments)}return t.push(i),function(){n=!1,t=t.filter((function(e){return e!==i}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.forEach((function(e){return e.apply(void 0,n)}))}}}var Dd=!("undefined"==typeof window||!window.document||!window.document.createElement);function Rd(e,t){t(window.confirm(e))}var zd="popstate",Ld="hashchange";function Bd(){try{return window.history.state||{}}catch(wT){return{}}}function Nd(e){void 0===e&&(e={}),Dd||Sd(!1);var t=window.history,n=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),i=!(-1===window.navigator.userAgent.indexOf("Trident")),r=e,o=r.forceRefresh,s=void 0!==o&&o,a=r.getUserConfirmation,l=void 0===a?Rd:a,c=r.keyLength,u=void 0===c?6:c,d=e.basename?Md(Td(e.basename)):"";function h(e){var t=e||{},n=t.key,i=t.state,r=window.location,o=r.pathname+r.search+r.hash;return d&&(o=Cd(o,d)),Ad(o,i,n)}function p(){return Math.random().toString(36).substr(2,u)}var f=Od();function m(e){vd(C,e),C.length=t.length,f.notifyListeners(C.location,C.action)}function g(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||b(h(e.state))}function y(){b(h(Bd()))}var v=!1;function b(e){v?(v=!1,m()):f.confirmTransitionTo(e,"POP",l,(function(t){t?m({action:"POP",location:e}):function(e){var t=C.location,n=_.indexOf(t.key);-1===n&&(n=0);var i=_.indexOf(e.key);-1===i&&(i=0);var r=n-i;r&&(v=!0,k(r))}(e)}))}var x=h(Bd()),_=[x.key];function w(e){return d+Id(e)}function k(e){t.go(e)}var E=0;function S(e){1===(E+=e)&&1===e?(window.addEventListener(zd,g),i&&window.addEventListener(Ld,y)):0===E&&(window.removeEventListener(zd,g),i&&window.removeEventListener(Ld,y))}var T=!1,C={length:t.length,action:"POP",location:x,createHref:w,push:function(e,i){var r="PUSH",o=Ad(e,i,p(),C.location);f.confirmTransitionTo(o,r,l,(function(e){if(e){var i=w(o),a=o.key,l=o.state;if(n)if(t.pushState({key:a,state:l},null,i),s)window.location.href=i;else{var c=_.indexOf(C.location.key),u=_.slice(0,c+1);u.push(o.key),_=u,m({action:r,location:o})}else window.location.href=i}}))},replace:function(e,i){var r="REPLACE",o=Ad(e,i,p(),C.location);f.confirmTransitionTo(o,r,l,(function(e){if(e){var i=w(o),a=o.key,l=o.state;if(n)if(t.replaceState({key:a,state:l},null,i),s)window.location.replace(i);else{var c=_.indexOf(C.location.key);-1!==c&&(_[c]=o.key),m({action:r,location:o})}else window.location.replace(i)}}))},go:k,goBack:function(){k(-1)},goForward:function(){k(1)},block:function(e){void 0===e&&(e=!1);var t=f.setPrompt(e);return T||(S(1),T=!0),function(){return T&&(T=!1,S(-1)),t()}},listen:function(e){var t=f.appendListener(e);return S(1),function(){S(-1),t()}}};return C}var Fd={exports:{}},$d=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};Fd.exports=Kd,Fd.exports.parse=Vd,Fd.exports.compile=function(e,t){return qd(Vd(e,t),t)},Fd.exports.tokensToFunction=qd,Fd.exports.tokensToRegExp=Xd;var jd=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function Vd(e,t){for(var n,i=[],r=0,o=0,s="",a=t&&t.delimiter||"/";null!=(n=jd.exec(e));){var l=n[0],c=n[1],u=n.index;if(s+=e.slice(o,u),o=u+l.length,c)s+=c[1];else{var d=e[o],h=n[2],p=n[3],f=n[4],m=n[5],g=n[6],y=n[7];s&&(i.push(s),s="");var v=null!=h&&null!=d&&d!==h,b="+"===g||"*"===g,x="?"===g||"*"===g,_=n[2]||a,w=f||m;i.push({name:p||r++,prefix:h||"",delimiter:_,optional:x,repeat:b,partial:v,asterisk:!!y,pattern:w?Wd(w):y?".*":"[^"+Gd(_)+"]+?"})}}return o<e.length&&(s+=e.substr(o)),s&&i.push(s),i}function Ud(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function qd(e,t){for(var n=new Array(e.length),i=0;i<e.length;i++)"object"==typeof e[i]&&(n[i]=new RegExp("^(?:"+e[i].pattern+")$",Zd(t)));return function(t,i){for(var r="",o=t||{},s=(i||{}).pretty?Ud:encodeURIComponent,a=0;a<e.length;a++){var l=e[a];if("string"!=typeof l){var c,u=o[l.name];if(null==u){if(l.optional){l.partial&&(r+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if($d(u)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(u)+"`");if(0===u.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var d=0;d<u.length;d++){if(c=s(u[d]),!n[a].test(c))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(c)+"`");r+=(0===d?l.prefix:l.delimiter)+c}}else{if(c=l.asterisk?encodeURI(u).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):s(u),!n[a].test(c))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+c+'"');r+=l.prefix+c}}else r+=l}return r}}function Gd(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function Wd(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function Hd(e,t){return e.keys=t,e}function Zd(e){return e&&e.sensitive?"":"i"}function Xd(e,t,n){$d(t)||(n=t||n,t=[]);for(var i=(n=n||{}).strict,r=!1!==n.end,o="",s=0;s<e.length;s++){var a=e[s];if("string"==typeof a)o+=Gd(a);else{var l=Gd(a.prefix),c="(?:"+a.pattern+")";t.push(a),a.repeat&&(c+="(?:"+l+c+")*"),o+=c=a.optional?a.partial?l+"("+c+")?":"(?:"+l+"("+c+"))?":l+"("+c+")"}}var u=Gd(n.delimiter||"/"),d=o.slice(-u.length)===u;return i||(o=(d?o.slice(0,-u.length):o)+"(?:"+u+"(?=$))?"),o+=r?"$":i&&d?"":"(?="+u+"|$)",Hd(new RegExp("^"+o,Zd(n)),t)}function Kd(e,t,n){return $d(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)t.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return Hd(e,t)}(e,t):$d(e)?function(e,t,n){for(var i=[],r=0;r<e.length;r++)i.push(Kd(e[r],t,n).source);return Hd(new RegExp("(?:"+i.join("|")+")",Zd(n)),t)}(e,t,n):function(e,t,n){return Xd(Vd(e,n),t,n)}(e,t,n)}const Jd=r(Fd.exports);var Yd={exports:{}},Qd={},eh="function"==typeof Symbol&&Symbol.for,th=eh?Symbol.for("react.element"):60103,nh=eh?Symbol.for("react.portal"):60106,ih=eh?Symbol.for("react.fragment"):60107,rh=eh?Symbol.for("react.strict_mode"):60108,oh=eh?Symbol.for("react.profiler"):60114,sh=eh?Symbol.for("react.provider"):60109,ah=eh?Symbol.for("react.context"):60110,lh=eh?Symbol.for("react.async_mode"):60111,ch=eh?Symbol.for("react.concurrent_mode"):60111,uh=eh?Symbol.for("react.forward_ref"):60112,dh=eh?Symbol.for("react.suspense"):60113,hh=eh?Symbol.for("react.suspense_list"):60120,ph=eh?Symbol.for("react.memo"):60115,fh=eh?Symbol.for("react.lazy"):60116,mh=eh?Symbol.for("react.block"):60121,gh=eh?Symbol.for("react.fundamental"):60117,yh=eh?Symbol.for("react.responder"):60118,vh=eh?Symbol.for("react.scope"):60119;function bh(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case th:switch(e=e.type){case lh:case ch:case ih:case oh:case rh:case dh:return e;default:switch(e=e&&e.$$typeof){case ah:case uh:case fh:case ph:case sh:return e;default:return t}}case nh:return t}}}function xh(e){return bh(e)===ch}function _h(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}Qd.AsyncMode=lh,Qd.ConcurrentMode=ch,Qd.ContextConsumer=ah,Qd.ContextProvider=sh,Qd.Element=th,Qd.ForwardRef=uh,Qd.Fragment=ih,Qd.Lazy=fh,Qd.Memo=ph,Qd.Portal=nh,Qd.Profiler=oh,Qd.StrictMode=rh,Qd.Suspense=dh,Qd.isAsyncMode=function(e){return xh(e)||bh(e)===lh},Qd.isConcurrentMode=xh,Qd.isContextConsumer=function(e){return bh(e)===ah},Qd.isContextProvider=function(e){return bh(e)===sh},Qd.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===th},Qd.isForwardRef=function(e){return bh(e)===uh},Qd.isFragment=function(e){return bh(e)===ih},Qd.isLazy=function(e){return bh(e)===fh},Qd.isMemo=function(e){return bh(e)===ph},Qd.isPortal=function(e){return bh(e)===nh},Qd.isProfiler=function(e){return bh(e)===oh},Qd.isStrictMode=function(e){return bh(e)===rh},Qd.isSuspense=function(e){return bh(e)===dh},Qd.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===ih||e===ch||e===oh||e===rh||e===dh||e===hh||"object"==typeof e&&null!==e&&(e.$$typeof===fh||e.$$typeof===ph||e.$$typeof===sh||e.$$typeof===ah||e.$$typeof===uh||e.$$typeof===gh||e.$$typeof===yh||e.$$typeof===vh||e.$$typeof===mh)},Qd.typeOf=bh,Yd.exports=Qd;var wh=Yd.exports,kh={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Eh={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Sh={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Th={};function Ch(e){return wh.isMemo(e)?Sh:Th[e.$$typeof]||kh}Th[wh.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Th[wh.Memo]=Sh;var Mh=Object.defineProperty,Ih=Object.getOwnPropertyNames,Ah=Object.getOwnPropertySymbols,Ph=Object.getOwnPropertyDescriptor,Oh=Object.getPrototypeOf,Dh=Object.prototype,Rh=function e(t,n,i){if("string"!=typeof n){if(Dh){var r=Oh(n);r&&r!==Dh&&e(t,r,i)}var o=Ih(n);Ah&&(o=o.concat(Ah(n)));for(var s=Ch(t),a=Ch(n),l=0;l<o.length;++l){var c=o[l];if(!(Eh[c]||i&&i[c]||a&&a[c]||s&&s[c])){var u=Ph(n,c);try{Mh(t,c,u)}catch(wT){}}}}return t};const zh=r(Rh);var Lh=1073741823,Bh="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},Nh=U.createContext||function(e,t){var n,i,r,o="__create-react-context-"+(Bh[r="__global_unique_id__"]=(Bh[r]||0)+1)+"__",s=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))||this).emitter=function(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(n,i){e=n,t.forEach((function(t){return t(e,i)}))}}}(t.props.value),t}pd(n,e);var i=n.prototype;return i.getChildContext=function(){var e;return(e={})[o]=this.emitter,e},i.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,i=this.props.value,r=e.value;!function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(i,r)?(n="function"==typeof t?t(i,r):Lh,0!=(n|=0)&&this.emitter.set(e.value,n)):n=0}},i.render=function(){return this.props.children},n}(U.Component);s.childContextTypes=((n={})[o]=yd.object.isRequired,n);var a=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).observedBits=void 0,e.state={value:e.getValue()},e.onUpdate=function(t,n){0!=((0|e.observedBits)&n)&&e.setState({value:e.getValue()})},e}pd(n,t);var i=n.prototype;return i.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?Lh:t},i.componentDidMount=function(){this.context[o]&&this.context[o].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?Lh:e},i.componentWillUnmount=function(){this.context[o]&&this.context[o].off(this.onUpdate)},i.getValue=function(){return this.context[o]?this.context[o].get():e},i.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(U.Component);return a.contextTypes=((i={})[o]=yd.object,i),{Provider:s,Consumer:a}},Fh=function(e){var t=Nh();return t.displayName=e,t},$h=Fh("Router-History"),jh=Fh("Router"),Vh=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._pendingLocation=e}))),n}pd(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){var e=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen((function(t){e._isMounted&&e.setState({location:t})}))),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return U.createElement(jh.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},U.createElement($h.Provider,{children:this.props.children||null,value:this.props.history}))},t}(U.Component);U.Component;var Uh=function(e){function t(){return e.apply(this,arguments)||this}pd(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(e){this.props.onUpdate&&this.props.onUpdate.call(this,this,e)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(U.Component),qh={},Gh=1e4,Wh=0;function Hh(e,t){return void 0===e&&(e="/"),void 0===t&&(t={}),"/"===e?e:function(e){if(qh[e])return qh[e];var t=Jd.compile(e);return Wh<Gh&&(qh[e]=t,Wh++),t}(e)(t,{pretty:!0})}function Zh(e){var t=e.computedMatch,n=e.to,i=e.push,r=void 0!==i&&i;return U.createElement(jh.Consumer,null,(function(e){e||Sd(!1);var i=e.history,o=e.staticContext,s=r?i.push:i.replace,a=Ad(t?"string"==typeof n?Hh(n,t.params):vd({},n,{pathname:Hh(n.pathname,t.params)}):n);return o?(s(a),null):U.createElement(Uh,{onMount:function(){s(a)},onUpdate:function(e,t){var n=Ad(t.to);Pd(n,vd({},a,{key:n.key}))||s(a)},to:n})}))}var Xh={},Kh=1e4,Jh=0;function Yh(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var n=t,i=n.path,r=n.exact,o=void 0!==r&&r,s=n.strict,a=void 0!==s&&s,l=n.sensitive,c=void 0!==l&&l;return[].concat(i).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var i=function(e,t){var n=""+t.end+t.strict+t.sensitive,i=Xh[n]||(Xh[n]={});if(i[e])return i[e];var r=[],o={regexp:Jd(e,r,t),keys:r};return Jh<Kh&&(i[e]=o,Jh++),o}(n,{end:o,strict:a,sensitive:c}),r=i.regexp,s=i.keys,l=r.exec(e);if(!l)return null;var u=l[0],d=l.slice(1),h=e===u;return o&&!h?null:{path:n,url:"/"===n&&""===u?"/":u,isExact:h,params:s.reduce((function(e,t,n){return e[t.name]=d[n],e}),{})}}),null)}var Qh=function(e){function t(){return e.apply(this,arguments)||this}return pd(t,e),t.prototype.render=function(){var e=this;return U.createElement(jh.Consumer,null,(function(t){t||Sd(!1);var n=e.props.location||t.location,i=vd({},t,{location:n,match:e.props.computedMatch?e.props.computedMatch:e.props.path?Yh(n.pathname,e.props):t.match}),r=e.props,o=r.children,s=r.component,a=r.render;return Array.isArray(o)&&function(e){return 0===U.Children.count(e)}(o)&&(o=null),U.createElement(jh.Provider,{value:i},i.match?o?"function"==typeof o?o(i):o:s?U.createElement(s,i):a?a(i):null:"function"==typeof o?o(i):null)}))},t}(U.Component);U.Component,U.Component,U.useContext;const ep=function(e,t,n){return e()},tp=!0,np=!0,ip=!0,rp=!1,op=!1;let sp,ap,lp,cp=!1,up=!1,dp=!1,hp=!1,pp=null,fp=!1;const mp=!0,gp="http://www.w3.org/1999/xlink",yp={},vp=e=>"object"==(e=typeof e)||"function"===e,bp=(e,t,...n)=>{let i=null,r=null,o=null,s=!1,a=!1;const l=[],c=t=>{for(let n=0;n<t.length;n++)i=t[n],Array.isArray(i)?c(i):null!=i&&"boolean"!=typeof i&&((s="function"!=typeof e&&!vp(i))&&(i=String(i)),s&&a?l[l.length-1].$text$+=i:l.push(s?xp(null,i):i),a=s)};if(c(n),t){t.key&&(r=t.key),t.name&&(o=t.name);{const e=t.className||t.class;e&&(t.class="object"!=typeof e?e:Object.keys(e).filter((t=>e[t])).join(" "))}}if("function"==typeof e)return e(null===t?{}:t,l,wp);const u=xp(e,null);return u.$attrs$=t,l.length>0&&(u.$children$=l),u.$key$=r,u.$name$=o,u},xp=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null};return n},_p={},wp={forEach:(e,t)=>e.map(kp).forEach(t),map:(e,t)=>e.map(kp).map(t).map(Ep)},kp=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),Ep=e=>{if("function"==typeof e.vtag){const t=Object.assign({},e.vattrs);return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),bp(e.vtag,t,...e.vchildren||[])}const t=xp(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},Sp=(e,t,n)=>{const i=e;return{emit:e=>Tp(i,t,{bubbles:!!(4&n),composed:!!(2&n),cancelable:!!(1&n),detail:e})}},Tp=(e,t,n)=>{const i=kf.ce(t,n);return e.dispatchEvent(i),i},Cp=new WeakMap,Mp=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,i=t.$flags$,r=(t.$tagName$,()=>{}),o=((e,t,n,i)=>{var r;let o=Ip(t,n);const s=vf.get(o);if(e=11===e.nodeType?e:_f,s)if("string"==typeof s){e=e.head||e;let t,n=Cp.get(e);if(n||Cp.set(e,n=new Set),!n.has(o)){{t=_f.createElement("style"),t.innerHTML=s;const n=null!==(r=kf.$nonce$)&&void 0!==r?r:function(e){var t,n,i;return null!==(i=null===(n=null===(t=e.head)||void 0===t?void 0:t.querySelector('meta[name="csp-nonce"]'))||void 0===n?void 0:n.getAttribute("content"))&&void 0!==i?i:void 0}(_f);null!=n&&t.setAttribute("nonce",n),e.insertBefore(t,e.querySelector("link"))}n&&n.add(o)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s]);return o})(n.shadowRoot?n.shadowRoot:n.getRootNode(),t,e.$modeName$);10&i&&(n["s-sc"]=o,n.classList.add(o+"-h"),2&i&&n.classList.add(o+"-s")),r()},Ip=(e,t)=>"sc-"+(t&&32&e.$flags$?e.$tagName$+"-"+t:e.$tagName$),Ap=(e,t,n,i,r,o)=>{if(n!==i){let s=gf(e,t),a=t.toLowerCase();if("class"===t){const t=e.classList,r=Op(n),o=Op(i);t.remove(...r.filter((e=>e&&!o.includes(e)))),t.add(...o.filter((e=>e&&!r.includes(e))))}else if("style"===t){for(const t in n)i&&null!=i[t]||(t.includes("-")?e.style.removeProperty(t):e.style[t]="");for(const t in i)n&&i[t]===n[t]||(t.includes("-")?e.style.setProperty(t,i[t]):e.style[t]=i[t])}else if("key"===t);else if("ref"===t)i&&i(e);else if(e.__lookupSetter__(t)||"o"!==t[0]||"n"!==t[1]){const l=vp(i);if((s||l&&null!==i)&&!r)try{if(e.tagName.includes("-"))e[t]=i;else{const r=null==i?"":i;"list"===t?s=!1:null!=n&&e[t]==r||(e[t]=r)}}catch(wT){}let c=!1;a!==(a=a.replace(/^xlink\:?/,""))&&(t=a,c=!0),null==i||!1===i?!1===i&&""!==e.getAttribute(t)||(c?e.removeAttributeNS(gp,t):e.removeAttribute(t)):(!s||4&o||r)&&!l&&(i=!0===i?"":i,c?e.setAttributeNS(gp,t,i):e.setAttribute(t,i))}else t="-"===t[2]?t.slice(3):gf(xf,a)?a.slice(2):a[2]+t.slice(3),n&&kf.rel(e,t,n,!1),i&&kf.ael(e,t,i,!1)}},Pp=/\s/,Op=e=>e?e.split(Pp):[],Dp=(e,t,n,i)=>{const r=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,o=e&&e.$attrs$||yp,s=t.$attrs$||yp;for(i in o)i in s||Ap(r,i,o[i],void 0,n,t.$flags$);for(i in s)Ap(r,i,o[i],s[i],n,t.$flags$)},Rp=(e,t,n,i)=>{const r=t.$children$[n];let o,s,a,l=0;if(cp||(dp=!0,"slot"===r.$tag$&&(sp&&i.classList.add(sp+"-s"),r.$flags$|=r.$children$?2:1)),null!==r.$text$)o=r.$elm$=_f.createTextNode(r.$text$);else if(1&r.$flags$)o=r.$elm$=_f.createTextNode("");else{if(hp||(hp="svg"===r.$tag$),o=r.$elm$=_f.createElementNS(hp?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&r.$flags$?"slot-fb":r.$tag$),hp&&"foreignObject"===r.$tag$&&(hp=!1),Dp(null,r,hp),(e=>null!=e)(sp)&&o["s-si"]!==sp&&o.classList.add(o["s-si"]=sp),r.$children$)for(l=0;l<r.$children$.length;++l)s=Rp(e,r,l,o),s&&o.appendChild(s);"svg"===r.$tag$?hp=!1:"foreignObject"===o.tagName&&(hp=!0)}return o["s-hn"]=lp,3&r.$flags$&&(o["s-sr"]=!0,o["s-cr"]=ap,o["s-sn"]=r.$name$||"",a=e&&e.$children$&&e.$children$[n],a&&a.$tag$===r.$tag$&&e.$elm$&&zp(e.$elm$,!1)),o},zp=(e,t)=>{kf.$flags$|=1;const n=e.childNodes;for(let i=n.length-1;i>=0;i--){const e=n[i];e["s-hn"]!==lp&&e["s-ol"]&&($p(e).insertBefore(e,Fp(e)),e["s-ol"].remove(),e["s-ol"]=void 0,dp=!0),t&&zp(e,t)}kf.$flags$&=-2},Lp=(e,t,n,i,r,o)=>{let s,a=e["s-cr"]&&e["s-cr"].parentNode||e;for(a.shadowRoot&&a.tagName===lp&&(a=a.shadowRoot);r<=o;++r)i[r]&&(s=Rp(null,n,r,e),s&&(i[r].$elm$=s,a.insertBefore(s,Fp(t))))},Bp=(e,t,n)=>{for(let i=t;i<=n;++i){const t=e[i];if(t){const e=t.$elm$;Wp(t),e&&(up=!0,e["s-ol"]?e["s-ol"].remove():zp(e,!0),e.remove())}}},Np=(e,t)=>e.$tag$===t.$tag$&&("slot"===e.$tag$?e.$name$===t.$name$:e.$key$===t.$key$),Fp=e=>e&&e["s-ol"]||e,$p=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,jp=(e,t)=>{const n=t.$elm$=e.$elm$,i=e.$children$,r=t.$children$,o=t.$tag$,s=t.$text$;let a;null===s?(hp="svg"===o||"foreignObject"!==o&&hp,"slot"===o||Dp(e,t,hp),null!==i&&null!==r?((e,t,n,i)=>{let r,o,s=0,a=0,l=0,c=0,u=t.length-1,d=t[0],h=t[u],p=i.length-1,f=i[0],m=i[p];for(;s<=u&&a<=p;)if(null==d)d=t[++s];else if(null==h)h=t[--u];else if(null==f)f=i[++a];else if(null==m)m=i[--p];else if(Np(d,f))jp(d,f),d=t[++s],f=i[++a];else if(Np(h,m))jp(h,m),h=t[--u],m=i[--p];else if(Np(d,m))"slot"!==d.$tag$&&"slot"!==m.$tag$||zp(d.$elm$.parentNode,!1),jp(d,m),e.insertBefore(d.$elm$,h.$elm$.nextSibling),d=t[++s],m=i[--p];else if(Np(h,f))"slot"!==d.$tag$&&"slot"!==m.$tag$||zp(h.$elm$.parentNode,!1),jp(h,f),e.insertBefore(h.$elm$,d.$elm$),h=t[--u],f=i[++a];else{for(l=-1,c=s;c<=u;++c)if(t[c]&&null!==t[c].$key$&&t[c].$key$===f.$key$){l=c;break}l>=0?(o=t[l],o.$tag$!==f.$tag$?r=Rp(t&&t[a],n,l,e):(jp(o,f),t[l]=void 0,r=o.$elm$),f=i[++a]):(r=Rp(t&&t[a],n,a,e),f=i[++a]),r&&$p(d.$elm$).insertBefore(r,Fp(d.$elm$))}s>u?Lp(e,null==i[p+1]?null:i[p+1].$elm$,n,i,a,p):a>p&&Bp(t,s,u)})(n,i,t,r):null!==r?(null!==e.$text$&&(n.textContent=""),Lp(n,null,t,r,0,r.length-1)):null!==i&&Bp(i,0,i.length-1),hp&&"svg"===o&&(hp=!1)):(a=n["s-cr"])?a.parentNode.textContent=s:e.$text$!==s&&(n.data=s)},Vp=e=>{const t=e.childNodes;let n,i,r,o,s,a;for(i=0,r=t.length;i<r;i++)if(n=t[i],1===n.nodeType){if(n["s-sr"])for(s=n["s-sn"],n.hidden=!1,o=0;o<r;o++)if(a=t[o].nodeType,t[o]["s-hn"]!==n["s-hn"]||""!==s){if(1===a&&s===t[o].getAttribute("slot")){n.hidden=!0;break}}else if(1===a||3===a&&""!==t[o].textContent.trim()){n.hidden=!0;break}Vp(n)}},Up=[],qp=e=>{let t,n,i,r,o,s,a=0;const l=e.childNodes,c=l.length;for(;a<c;a++){if(t=l[a],t["s-sr"]&&(n=t["s-cr"])&&n.parentNode)for(i=n.parentNode.childNodes,r=t["s-sn"],s=i.length-1;s>=0;s--)n=i[s],n["s-cn"]||n["s-nr"]||n["s-hn"]===t["s-hn"]||(Gp(n,r)?(o=Up.find((e=>e.$nodeToRelocate$===n)),up=!0,n["s-sn"]=n["s-sn"]||r,o?o.$slotRefNode$=t:Up.push({$slotRefNode$:t,$nodeToRelocate$:n}),n["s-sr"]&&Up.map((e=>{Gp(e.$nodeToRelocate$,n["s-sn"])&&(o=Up.find((e=>e.$nodeToRelocate$===n)),o&&!e.$slotRefNode$&&(e.$slotRefNode$=o.$slotRefNode$))}))):Up.some((e=>e.$nodeToRelocate$===n))||Up.push({$nodeToRelocate$:n}));1===t.nodeType&&qp(t)}},Gp=(e,t)=>1===e.nodeType?null===e.getAttribute("slot")&&""===t||e.getAttribute("slot")===t:e["s-sn"]===t||""===t,Wp=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(Wp)},Hp=(e,t)=>{const n=e.$hostElement$,i=e.$cmpMeta$,r=e.$vnode$||xp(null,null),o=(s=t)&&s.$tag$===_p?t:bp(null,null,t);var s;if(lp=n.tagName,i.$attrsToReflect$&&(o.$attrs$=o.$attrs$||{},i.$attrsToReflect$.map((([e,t])=>o.$attrs$[t]=n[e]))),o.$tag$=null,o.$flags$|=4,e.$vnode$=o,o.$elm$=r.$elm$=n.shadowRoot||n,sp=n["s-sc"],ap=n["s-cr"],cp=0!=(1&i.$flags$),up=!1,jp(r,o),kf.$flags$|=1,dp){let e,t,n,i,r,s;qp(o.$elm$);let a=0;for(;a<Up.length;a++)e=Up[a],t=e.$nodeToRelocate$,t["s-ol"]||(n=_f.createTextNode(""),n["s-nr"]=t,t.parentNode.insertBefore(t["s-ol"]=n,t));for(a=0;a<Up.length;a++)if(e=Up[a],t=e.$nodeToRelocate$,e.$slotRefNode$){for(i=e.$slotRefNode$.parentNode,r=e.$slotRefNode$.nextSibling,n=t["s-ol"];n=n.previousSibling;)if(s=n["s-nr"],s&&s["s-sn"]===t["s-sn"]&&i===s.parentNode&&(s=s.nextSibling,!s||!s["s-nr"])){r=s;break}(!r&&i!==t.parentNode||t.nextSibling!==r)&&t!==r&&(!t["s-hn"]&&t["s-ol"]&&(t["s-hn"]=t["s-ol"].parentNode.nodeName),i.insertBefore(t,r))}else 1===t.nodeType&&(t.hidden=!0)}up&&Vp(o.$elm$),kf.$flags$&=-2,Up.length=0},Zp=(e,t)=>(e.$flags$|=16,e.$ancestorComponent$,Df((()=>Xp(e,t)))),Xp=(e,t)=>{const n=e.$hostElement$,i=(e.$cmpMeta$.$tagName$,()=>{}),r=n;let o;return o=nf(r,t?"componentWillLoad":"componentWillUpdate"),o=Kp(o,(()=>nf(r,"componentWillRender"))),i(),Kp(o,(()=>Yp(e,r,t)))},Kp=(e,t)=>Jp(e)?e.then(t):t(),Jp=e=>e instanceof Promise||e&&e.then&&"function"==typeof e.then,Yp=async(e,t,n)=>{const i=e.$hostElement$,r=(e.$cmpMeta$.$tagName$,()=>{});i["s-rc"],n&&Mp(e);const o=(e.$cmpMeta$.$tagName$,()=>{});Qp(e,t,i),o(),r(),ef(e)},Qp=(e,t,n)=>{try{pp=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(tp||np)&&(ip||np)&&(rp||Hp(e,t))}catch(wT){yf(wT,e.$hostElement$)}return pp=null,null},ef=e=>{e.$cmpMeta$.$tagName$;const t=()=>{},n=e.$hostElement$;e.$ancestorComponent$,nf(n,"componentDidRender"),64&e.$flags$?(nf(n,"componentDidUpdate"),t()):(e.$flags$|=64,nf(n,"componentDidLoad"),t())},tf=e=>{{const t=ff(e),n=t.$hostElement$.isConnected;return n&&2==(18&t.$flags$)&&Zp(t,!1),n}},nf=(e,t,n)=>{if(e&&e[t])try{return e[t](n)}catch(wT){yf(wT)}},rf=(e,t,n,i)=>{const r=ff(e),o=e,s=r.$instanceValues$.get(t),a=r.$flags$,l=o;var c,u;c=n,u=i.$members$[t][0],n=null==c||vp(c)?c:4&u?"false"!==c&&(""===c||!!c):2&u?parseFloat(c):1&u?String(c):c;const d=Number.isNaN(s)&&Number.isNaN(n);if(n!==s&&!d){if(r.$instanceValues$.set(t,n),i.$watchers$&&128&a){const e=i.$watchers$[t];e&&e.map((e=>{try{l[e](n,s,t)}catch(wT){yf(wT,o)}}))}if(2==(18&a)){if(l.componentShouldUpdate&&!1===l.componentShouldUpdate(n,s,t))return;Zp(r,!1)}}},of=(e,t,n)=>{if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const n=Object.entries(t.$members$),i=e.prototype;n.map((([e,[n]])=>{(31&n||32&n)&&Object.defineProperty(i,e,{get(){return t=e,ff(this).$instanceValues$.get(t);var t},set(n){rf(this,e,n,t)},configurable:!0,enumerable:!0})}));{const r=new Map;i.attributeChangedCallback=function(e,t,n){kf.jmp((()=>{const t=r.get(e);if(this.hasOwnProperty(t))n=this[t],delete this[t];else if(i.hasOwnProperty(t)&&"number"==typeof this[t]&&this[t]==n)return;this[t]=(null!==n||"boolean"!=typeof this[t])&&n}))},e.observedAttributes=n.filter((([e,t])=>15&t[0])).map((([e,n])=>{const i=n[1]||e;return r.set(i,e),512&n[0]&&t.$attrsToReflect$.push([e,i]),i}))}}return e},sf=async(e,t,n,i,r)=>{if(0==(32&t.$flags$)&&(t.$flags$|=32,r=e.constructor,customElements.whenDefined(n.$tagName$).then((()=>t.$flags$|=128)),r.style)){let i=r.style;"string"!=typeof i&&(i=i[t.$modeName$=(e=>bf.map((t=>t(e))).find((e=>!!e)))(e)]);const o=Ip(n,t.$modeName$);if(!vf.has(o)){const e=(n.$tagName$,()=>{});((e,t,n)=>{let i=vf.get(e);Sf&&n?(i=i||new CSSStyleSheet,"string"==typeof i?i=t:i.replaceSync(t)):i=t,vf.set(e,i)})(o,i,!!(1&n.$flags$)),e()}}t.$ancestorComponent$,Zp(t,!0)},af=e=>{const t=e["s-cr"]=_f.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},lf=(e,t)=>{const n={$flags$:t[0],$tagName$:t[1]};n.$members$=t[2],n.$listeners$=t[3],n.$watchers$=e.$watchers$,n.$attrsToReflect$=[];const i=e.prototype.connectedCallback,r=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){mf(this,n)},connectedCallback(){(e=>{if(0==(1&kf.$flags$)){const t=ff(e),n=t.$cmpMeta$,i=(n.$tagName$,()=>{});1&t.$flags$?(cf(e,t,n.$listeners$),t.$lazyInstance$):(t.$flags$|=1,12&n.$flags$&&af(e),n.$members$&&Object.entries(n.$members$).map((([t,[n]])=>{if(31&n&&e.hasOwnProperty(t)){const n=e[t];delete e[t],e[t]=n}})),sf(e,t,n)),i()}})(this),i&&i.call(this)},disconnectedCallback(){(e=>{if(0==(1&kf.$flags$)){const t=ff(e);t.$rmListeners$&&(t.$rmListeners$.map((e=>e())),t.$rmListeners$=void 0)}})(this),r&&r.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(16&n.$flags$)})}}),e.is=n.$tagName$,of(e,n)},cf=(e,t,n,i)=>{n&&n.map((([n,i,r])=>{const o=df(e,n),s=uf(t,r),a=hf(n);kf.ael(o,i,s,a),(t.$rmListeners$=t.$rmListeners$||[]).push((()=>kf.rel(o,i,s,a)))}))},uf=(e,t)=>n=>{try{op||e.$hostElement$[t](n)}catch(wT){yf(wT)}},df=(e,t)=>4&t?_f:8&t?xf:16&t?_f.body:e,hf=e=>Ef?{passive:0!=(1&e),capture:0!=(2&e)}:0!=(2&e),pf=new WeakMap,ff=e=>pf.get(e),mf=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return cf(e,n,t.$listeners$),pf.set(e,n)},gf=(e,t)=>t in e,yf=(e,t)=>(0,console.error)(e,t),vf=new Map,bf=[],xf="undefined"!=typeof window?window:{},_f=xf.document||{head:{}},wf=xf.HTMLElement||class{},kf={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,i)=>e.addEventListener(t,n,i),rel:(e,t,n,i)=>e.removeEventListener(t,n,i),ce:(e,t)=>new CustomEvent(e,t)},Ef=(()=>{let e=!1;try{_f.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch(wT){}return e})(),Sf=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch(wT){}return!1})(),Tf=[],Cf=[],Mf=(e,t)=>n=>{e.push(n),fp||(fp=!0,t&&4&kf.$flags$?Pf(Af):kf.raf(Af))},If=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(wT){yf(wT)}e.length=0},Af=()=>{If(Tf),If(Cf),(fp=Tf.length>0)&&kf.raf(Af)},Pf=e=>(e=>Promise.resolve(e))().then(e),Of=e("r",Mf(Tf,!1)),Df=e("w",Mf(Cf,!0)),Rf="undefined"!=typeof window?window:void 0,zf="undefined"!=typeof document?document:void 0,Lf=e("b",((e,t)=>{e.componentOnReady?e.componentOnReady().then((e=>t(e))):qf((()=>t(e)))})),Bf=e=>void 0!==e.componentOnReady,Nf=(e,t=[])=>{const n={};return t.forEach((t=>{e.hasAttribute(t)&&(null!==e.getAttribute(t)&&(n[t]=e.getAttribute(t)),e.removeAttribute(t))})),n},Ff=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],$f=(e,t)=>{let n=Ff;return t&&t.length>0&&(n=n.filter((e=>!t.includes(e)))),Nf(e,n)},jf=e("d",((e,t,n,i)=>{var r;if("undefined"!=typeof window){const o=window,s=null===(r=null==o?void 0:o.Ionic)||void 0===r?void 0:r.config;if(s){const r=s.get("_ael");if(r)return r(e,t,n,i);if(s._ael)return s._ael(e,t,n,i)}}return e.addEventListener(t,n,i)})),Vf=e("e",((e,t,n,i)=>{var r;if("undefined"!=typeof window){const o=window,s=null===(r=null==o?void 0:o.Ionic)||void 0===r?void 0:r.config;if(s){const r=s.get("_rel");if(r)return r(e,t,n,i);if(s._rel)return s._rel(e,t,n,i)}}return e.removeEventListener(t,n,i)})),Uf=(e,t=e)=>e.shadowRoot||t,qf=e("h",(e=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(e):"function"==typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e))),Gf=e=>{const t=e.closest("ion-item");return t?t.querySelector("ion-label"):null},Wf=e("a",((e,t,n)=>Math.max(e,Math.min(t,n)))),Hf=(e,t)=>{if(!e){const e="ASSERT: "+t;throw console.error(e),new Error(e)}},Zf=(e("n",(e=>e.timeStamp||Date.now())),e("p",(e=>{if(e){const t=e.changedTouches;if(t&&t.length>0){const e=t[0];return{x:e.clientX,y:e.clientY}}if(void 0!==e.pageX)return{x:e.pageX,y:e.pageY}}return{x:0,y:0}})),e=>{const t="rtl"===document.dir;switch(e){case"start":return t;case"end":return!t;default:throw new Error(`"${e}" is not a valid value for [side]. Use "start" or "end" instead.`)}}),Xf=(e,t)=>{const n=e._original||e;return{_original:e,emit:Kf(n.emit.bind(n),t)}},Kf=(e,t=0)=>{let n;return(...i)=>{clearTimeout(n),n=setTimeout(e,t,...i)}},Jf=(e,t)=>{if(null!=e||(e={}),null!=t||(t={}),e===t)return!0;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const i of n){if(!(i in t))return!1;if(e[i]!==t[i])return!1}return!0};
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
let Yf;const Qf=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),em=e=>{if(void 0===Yf){const t=void 0!==e.style.animationName,n=void 0!==e.style.webkitAnimationName;Yf=!t&&n?"-webkit-":""}return Yf},tm=(e,t,n)=>{const i=t.startsWith("animation")?em(e):"";e.style.setProperty(i+t,n)},nm=(e,t)=>{const n=t.startsWith("animation")?em(e):"";e.style.removeProperty(n+t)},im=[],rm=(e=[],t)=>{if(void 0!==t){const n=Array.isArray(t)?t:[t];return[...e,...n]}return e},om=e("l",(e=>{let t,n,i,r,o,s,a,l,c,u,d,h,p,f=[],m=[],g=[],y=!1,v={},b=[],x=[],_={},w=0,k=!1,E=!1,S=!0,T=!1,C=!0,M=!1;const I=e,A=[],P=[],O=[],D=[],R=[],z=[],L=[],B=[],N=[],F=[],$="function"==typeof AnimationEffect||void 0!==Rf&&"function"==typeof Rf.AnimationEffect,j="function"==typeof Element&&"function"==typeof Element.prototype.animate&&$,V=()=>F,U=e=>{W(),e&&H()},q=(e,t)=>(((null==t?void 0:t.oneTimeCallback)?P:A).push({c:e,o:t}),p),G=()=>(A.length=0,P.length=0,p),W=()=>{if(j)F.forEach((e=>{e.cancel()})),F.length=0;else{const e=O.slice();qf((()=>{e.forEach((e=>{nm(e,"animation-name"),nm(e,"animation-duration"),nm(e,"animation-timing-function"),nm(e,"animation-iteration-count"),nm(e,"animation-delay"),nm(e,"animation-play-state"),nm(e,"animation-fill-mode"),nm(e,"animation-direction")}))}))}},H=()=>{R.forEach((e=>{(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)})),R.length=0},Z=()=>void 0!==o?o:a?a.getFill():"both",X=()=>void 0!==c?c:void 0!==s?s:a?a.getDirection():"normal",K=()=>k?"linear":void 0!==i?i:a?a.getEasing():"linear",J=()=>E?0:void 0!==u?u:void 0!==n?n:a?a.getDuration():0,Y=()=>void 0!==r?r:a?a.getIterations():1,Q=()=>void 0!==d?d:void 0!==t?t:a?a.getDelay():0,ee=e=>{j?V().forEach((t=>{if(t.effect.setKeyframes)t.effect.setKeyframes(e);else{const n=new KeyframeEffect(t.effect.target,e,t.effect.getTiming());t.effect=n}})):ne()},te=()=>{0!==w&&(w--,0===w&&((()=>{ue(),B.forEach((e=>e())),N.forEach((e=>e()));const e=S?1:0,t=b,n=x,i=_;O.forEach((e=>{const r=e.classList;t.forEach((e=>r.add(e))),n.forEach((e=>r.remove(e)));for(const t in i)i.hasOwnProperty(t)&&tm(e,t,i[t])})),A.forEach((t=>t.c(e,p))),P.forEach((t=>t.c(e,p))),P.length=0,C=!0,S&&(T=!0),S=!0})(),a&&a.animationFinish()))},ne=(t=!0)=>{H();const n=(e=>(e.forEach((e=>{for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];if("easing"===t)e["animation-timing-function"]=n,delete e[t];else{const i=Qf(t);i!==t&&(e[i]=n,delete e[t])}}})),e))(f);O.forEach((i=>{if(n.length>0){const r=((e=[])=>e.map((e=>{const t=e.offset,n=[];for(const i in e)e.hasOwnProperty(i)&&"offset"!==i&&n.push(`${i}: ${e[i]};`);return`${100*t}% { ${n.join(" ")} }`})).join(" "))(n);h=void 0!==e?e:(e=>{let t=im.indexOf(e);return t<0&&(t=im.push(e)-1),`ion-animation-${t}`})(r);const o=((e,t,n)=>{var i;const r=(e=>{const t=void 0!==e.getRootNode?e.getRootNode():e;return t.head||t})(n),o=em(n),s=r.querySelector("#"+e);if(s)return s;const a=(null!==(i=n.ownerDocument)&&void 0!==i?i:document).createElement("style");return a.id=e,a.textContent=`@${o}keyframes ${e} { ${t} } @${o}keyframes ${e}-alt { ${t} }`,r.appendChild(a),a})(h,r,i);R.push(o),tm(i,"animation-duration",`${J()}ms`),tm(i,"animation-timing-function",K()),tm(i,"animation-delay",`${Q()}ms`),tm(i,"animation-fill-mode",Z()),tm(i,"animation-direction",X());const s=Y()===1/0?"infinite":Y().toString();tm(i,"animation-iteration-count",s),tm(i,"animation-play-state","paused"),t&&tm(i,"animation-name",`${o.id}-alt`),qf((()=>{tm(i,"animation-name",o.id||null)}))}}))},ie=(e=!0)=>{(()=>{z.forEach((e=>e())),L.forEach((e=>e()));const e=m,t=g,n=v;O.forEach((i=>{const r=i.classList;e.forEach((e=>r.add(e))),t.forEach((e=>r.remove(e)));for(const e in n)n.hasOwnProperty(e)&&tm(i,e,n[e])}))})(),f.length>0&&(j?(O.forEach((e=>{const t=e.animate(f,{id:I,delay:Q(),duration:J(),easing:K(),iterations:Y(),fill:Z(),direction:X()});t.pause(),F.push(t)})),F.length>0&&(F[0].onfinish=()=>{te()})):ne(e)),y=!0},re=e=>{if(e=Math.min(Math.max(e,0),.9999),j)F.forEach((t=>{t.currentTime=t.effect.getComputedTiming().delay+J()*e,t.pause()}));else{const t=`-${J()*e}ms`;O.forEach((e=>{f.length>0&&(tm(e,"animation-delay",t),tm(e,"animation-play-state","paused"))}))}},oe=e=>{F.forEach((e=>{e.effect.updateTiming({delay:Q(),duration:J(),easing:K(),iterations:Y(),fill:Z(),direction:X()})})),void 0!==e&&re(e)},se=(e=!0,t)=>{qf((()=>{O.forEach((n=>{tm(n,"animation-name",h||null),tm(n,"animation-duration",`${J()}ms`),tm(n,"animation-timing-function",K()),tm(n,"animation-delay",void 0!==t?`-${t*J()}ms`:`${Q()}ms`),tm(n,"animation-fill-mode",Z()||null),tm(n,"animation-direction",X()||null);const i=Y()===1/0?"infinite":Y().toString();tm(n,"animation-iteration-count",i),e&&tm(n,"animation-name",`${h}-alt`),qf((()=>{tm(n,"animation-name",h||null)}))}))}))},ae=(e=!1,t=!0,n)=>(e&&D.forEach((i=>{i.update(e,t,n)})),j?oe(n):se(t,n),p),le=()=>{y&&(j?F.forEach((e=>{e.pause()})):O.forEach((e=>{tm(e,"animation-play-state","paused")})),M=!0)},ce=()=>{l=void 0,te()},ue=()=>{l&&clearTimeout(l)},de=()=>{O.forEach((e=>{nm(e,"animation-duration"),nm(e,"animation-delay"),nm(e,"animation-play-state")}))},he=e=>new Promise((t=>{(null==e?void 0:e.sync)&&(E=!0,q((()=>E=!1),{oneTimeCallback:!0})),y||ie(),T&&(j?(re(0),oe()):se(),T=!1),C&&(w=D.length+1,C=!1),q((()=>t()),{oneTimeCallback:!0}),D.forEach((e=>{e.play()})),j?(F.forEach((e=>{e.play()})),0!==f.length&&0!==O.length||te()):(()=>{if(ue(),qf((()=>{O.forEach((e=>{f.length>0&&tm(e,"animation-play-state","running")}))})),0===f.length||0===O.length)te();else{const e=Q()||0,t=J()||0,n=Y()||1;isFinite(n)&&(l=setTimeout(ce,e+t*n+100)),((e,t)=>{let n;const i={passive:!0},r=()=>{n&&n()},o=n=>{e===n.target&&(r(),t(n))};e&&(e.addEventListener("webkitAnimationEnd",o,i),e.addEventListener("animationend",o,i),n=()=>{e.removeEventListener("webkitAnimationEnd",o,i),e.removeEventListener("animationend",o,i)})})(O[0],(()=>{ue(),qf((()=>{de(),qf(te)}))}))}})(),M=!1})),pe=(e,t)=>{const n=f[0];return void 0===n||void 0!==n.offset&&0!==n.offset?f=[{offset:0,[e]:t},...f]:n[e]=t,p};return p={parentAnimation:a,elements:O,childAnimations:D,id:I,animationFinish:te,from:pe,to:(e,t)=>{const n=f[f.length-1];return void 0===n||void 0!==n.offset&&1!==n.offset?f=[...f,{offset:1,[e]:t}]:n[e]=t,p},fromTo:(e,t,n)=>pe(e,t).to(e,n),parent:e=>(a=e,p),play:he,pause:()=>(D.forEach((e=>{e.pause()})),le(),p),stop:()=>{D.forEach((e=>{e.stop()})),y&&(W(),y=!1),k=!1,E=!1,C=!0,c=void 0,u=void 0,d=void 0,w=0,T=!1,S=!0,M=!1},destroy:e=>(D.forEach((t=>{t.destroy(e)})),U(e),O.length=0,D.length=0,f.length=0,G(),y=!1,C=!0,p),keyframes:e=>{const t=f!==e;return f=e,t&&ee(f),p},addAnimation:e=>{if(null!=e)if(Array.isArray(e))for(const t of e)t.parent(p),D.push(t);else e.parent(p),D.push(e);return p},addElement:e=>{if(null!=e)if(1===e.nodeType)O.push(e);else if(e.length>=0)for(let t=0;t<e.length;t++)O.push(e[t]);else console.error("Invalid addElement value");return p},update:ae,fill:e=>(o=e,ae(!0),p),direction:e=>(s=e,ae(!0),p),iterations:e=>(r=e,ae(!0),p),duration:e=>(j||0!==e||(e=1),n=e,ae(!0),p),easing:e=>(i=e,ae(!0),p),delay:e=>(t=e,ae(!0),p),getWebAnimations:V,getKeyframes:()=>f,getFill:Z,getDirection:X,getDelay:Q,getIterations:Y,getEasing:K,getDuration:J,afterAddRead:e=>(B.push(e),p),afterAddWrite:e=>(N.push(e),p),afterClearStyles:(e=[])=>{for(const t of e)_[t]="";return p},afterStyles:(e={})=>(_=e,p),afterRemoveClass:e=>(x=rm(x,e),p),afterAddClass:e=>(b=rm(b,e),p),beforeAddRead:e=>(z.push(e),p),beforeAddWrite:e=>(L.push(e),p),beforeClearStyles:(e=[])=>{for(const t of e)v[t]="";return p},beforeStyles:(e={})=>(v=e,p),beforeRemoveClass:e=>(g=rm(g,e),p),beforeAddClass:e=>(m=rm(m,e),p),onFinish:q,isRunning:()=>0!==w&&!M,progressStart:(e=!1,t)=>(D.forEach((n=>{n.progressStart(e,t)})),le(),k=e,y||ie(),ae(!1,!0,t),p),progressStep:e=>(D.forEach((t=>{t.progressStep(e)})),re(e),p),progressEnd:(e,t,n)=>(k=!1,D.forEach((i=>{i.progressEnd(e,t,n)})),void 0!==n&&(u=n),T=!1,S=!0,0===e?(c="reverse"===X()?"normal":"reverse","reverse"===c&&(S=!1),j?(ae(),re(1-t)):(d=(1-t)*J()*-1,ae(!1,!1))):1===e&&(j?(ae(),re(t)):(d=t*J()*-1,ae(!1,!1))),void 0!==e&&(q((()=>{u=void 0,c=void 0,d=void 0}),{oneTimeCallback:!0}),a||he()),p)}})),sm="ionViewWillLeave",am="ionViewDidLeave",lm="ionViewWillUnload",cm=e=>new Promise(((t,n)=>{Df((()=>{um(e),dm(e).then((n=>{n.animation&&n.animation.destroy(),hm(e),t(n)}),(t=>{hm(e),n(t)}))}))})),um=e=>{const t=e.enteringEl,n=e.leavingEl;Em(t,n,e.direction),e.showGoBack?t.classList.add("can-go-back"):t.classList.remove("can-go-back"),km(t,!1),t.style.setProperty("pointer-events","none"),n&&(km(n,!1),n.style.setProperty("pointer-events","none"))},dm=async e=>{const t=await pm(e);return t&&mp?fm(t,e):mm(e)},hm=e=>{const t=e.enteringEl,n=e.leavingEl;t.classList.remove("ion-page-invisible"),t.style.removeProperty("pointer-events"),void 0!==n&&(n.classList.remove("ion-page-invisible"),n.style.removeProperty("pointer-events"))},pm=async e=>{if(e.leavingEl&&e.animated&&0!==e.duration)return e.animationBuilder?e.animationBuilder:"ios"===e.mode?(await ep((()=>t.import("./ios.transition-legacy-3447fcea.js")))).iosTransitionAnimation:(await ep((()=>t.import("./md.transition-legacy-89def899.js")))).mdTransitionAnimation},fm=async(e,t)=>{await gm(t,!0);const n=e(t.baseEl,t);bm(t.enteringEl,t.leavingEl);const i=await vm(n,t);return t.progressCallback&&t.progressCallback(void 0),i&&xm(t.enteringEl,t.leavingEl),{hasCompleted:i,animation:n}},mm=async e=>{const t=e.enteringEl,n=e.leavingEl;return await gm(e,!1),bm(t,n),xm(t,n),{hasCompleted:!0}},gm=async(e,t)=>{(void 0!==e.deepWait?e.deepWait:t)&&await Promise.all([wm(e.enteringEl),wm(e.leavingEl)]),await ym(e.viewIsReady,e.enteringEl)},ym=async(e,t)=>{e&&await e(t)},vm=(e,t)=>{const n=t.progressCallback,i=new Promise((t=>{e.onFinish((e=>t(1===e)))}));return n?(e.progressStart(!0),n(e)):e.play(),i},bm=(e,t)=>{_m(t,sm),_m(e,"ionViewWillEnter")},xm=(e,t)=>{_m(e,"ionViewDidEnter"),_m(t,am)},_m=(e,t)=>{if(e){const n=new CustomEvent(t,{bubbles:!1,cancelable:!1});e.dispatchEvent(n)}},wm=async e=>{const t=e;if(t){if(null!=t.componentOnReady){if(null!=await t.componentOnReady())return}else if(null!=t.__registerHost){const e=new Promise((e=>qf(e)));return void(await e)}await Promise.all(Array.from(t.children).map(wm))}},km=(e,t)=>{t?(e.setAttribute("aria-hidden","true"),e.classList.add("ion-page-hidden")):(e.hidden=!1,e.removeAttribute("aria-hidden"),e.classList.remove("ion-page-hidden"))},Em=(e,t,n)=>{void 0!==e&&(e.style.zIndex="back"===n?"99":"101"),void 0!==t&&(t.style.zIndex="100")},Sm=(e("m",(e=>{if(e.classList.contains("ion-page"))return e;const t=e.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return t||e})),(e,t,n,i,r)=>Cm(e[1],t[1],n[1],i[1],r).map((r=>Tm(e[0],t[0],n[0],i[0],r)))),Tm=(e,t,n,i,r)=>r*(3*t*Math.pow(r-1,2)+r*(-3*n*r+3*n+i*r))-e*Math.pow(r-1,3),Cm=(e,t,n,i,r)=>Mm((i-=r)-3*(n-=r)+3*(t-=r)-(e-=r),3*n-6*t+3*e,3*t-3*e,e).filter((e=>e>=0&&e<=1)),Mm=(e,t,n,i)=>{if(0===e)return((e,t,n)=>{const i=t*t-4*e*n;return i<0?[]:[(-t+Math.sqrt(i))/(2*e),(-t-Math.sqrt(i))/(2*e)]})(t,n,i);const r=(3*(n/=e)-(t/=e)*t)/3,o=(2*t*t*t-9*t*n+27*(i/=e))/27;if(0===r)return[Math.pow(-o,1/3)];if(0===o)return[Math.sqrt(-r),-Math.sqrt(-r)];const s=Math.pow(o/2,2)+Math.pow(r/3,3);if(0===s)return[Math.pow(o/2,.5)-t/3];if(s>0)return[Math.pow(-o/2+Math.sqrt(s),1/3)-Math.pow(o/2+Math.sqrt(s),1/3)-t/3];const a=Math.sqrt(Math.pow(-r/3,3)),l=Math.acos(-o/(2*Math.sqrt(Math.pow(-r/3,3)))),c=2*Math.pow(a,1/3);return[c*Math.cos(l/3)-t/3,c*Math.cos((l+2*Math.PI)/3)-t/3,c*Math.cos((l+4*Math.PI)/3)-t/3]};class Im{constructor(e,t,n,i,r){this.id=t,this.name=n,this.disableScroll=r,this.priority=1e6*i+t,this.ctrl=e}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const e=this.ctrl.capture(this.name,this.id,this.priority);return e&&this.disableScroll&&this.ctrl.disableScroll(this.id),e}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class Am{constructor(e,t,n,i){this.id=t,this.disable=n,this.disableScroll=i,this.ctrl=e}block(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.disableGesture(e,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.enableGesture(e,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const Pm="backdrop-no-scroll",Om=new
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
class{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(e){var t;return new Im(this,this.newID(),e.name,null!==(t=e.priority)&&void 0!==t?t:0,!!e.disableScroll)}createBlocker(e={}){return new Am(this,this.newID(),e.disable,!!e.disableScroll)}start(e,t,n){return this.canStart(e)?(this.requestedStart.set(t,n),!0):(this.requestedStart.delete(t),!1)}capture(e,t,n){if(!this.start(e,t,n))return!1;const i=this.requestedStart;let r=-1e4;if(i.forEach((e=>{r=Math.max(r,e)})),r===n){this.capturedId=t,i.clear();const n=new CustomEvent("ionGestureCaptured",{detail:{gestureName:e}});return document.dispatchEvent(n),!0}return i.delete(t),!1}release(e){this.requestedStart.delete(e),this.capturedId===e&&(this.capturedId=void 0)}disableGesture(e,t){let n=this.disabledGestures.get(e);void 0===n&&(n=new Set,this.disabledGestures.set(e,n)),n.add(t)}enableGesture(e,t){const n=this.disabledGestures.get(e);void 0!==n&&n.delete(t)}disableScroll(e){this.disabledScroll.add(e),1===this.disabledScroll.size&&document.body.classList.add(Pm)}enableScroll(e){this.disabledScroll.delete(e),0===this.disabledScroll.size&&document.body.classList.remove(Pm)}canStart(e){return void 0===this.capturedId&&!this.isDisabled(e)}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(e){const t=this.disabledGestures.get(e);return!!(t&&t.size>0)}newID(){return this.gestureId++,this.gestureId}},Dm=(e,t,n,i)=>{const r=Rm(e)?{capture:!!i.capture,passive:!!i.passive}:!!i.capture;let o,s;return e.__zone_symbol__addEventListener?(o="__zone_symbol__addEventListener",s="__zone_symbol__removeEventListener"):(o="addEventListener",s="removeEventListener"),e[o](t,n,r),()=>{e[s](t,n,r)}},Rm=e=>{if(void 0===zm)try{const t=Object.defineProperty({},"passive",{get:()=>{zm=!0}});e.addEventListener("optsTest",(()=>{}),t)}catch(wT){zm=!1}return!!zm};let zm;const Lm=e=>e instanceof Document?e:e.ownerDocument,Bm=e("c",(e=>{let t=!1,n=!1,i=!0,r=!1;const o=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},e),s=o.canStart,a=o.onWillStart,l=o.onStart,c=o.onEnd,u=o.notCaptured,d=o.onMove,h=o.threshold,p=o.passive,f=o.blurOnStart,m={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},g=((e,t,n)=>{const i=n*(Math.PI/180),r="x"===e,o=Math.cos(i),s=t*t;let a=0,l=0,c=!1,u=0;return{start(e,t){a=e,l=t,u=0,c=!0},detect(e,t){if(!c)return!1;const n=e-a,i=t-l,d=n*n+i*i;if(d<s)return!1;const h=Math.sqrt(d),p=(r?n:i)/h;return u=p>o?1:p<-o?-1:0,c=!1,!0},isGesture:()=>0!==u,getDirection:()=>u}})(o.direction,o.threshold,o.maxAngle),y=Om.createGesture({name:e.gestureName,priority:e.gesturePriority,disableScroll:e.disableScroll}),v=()=>{t&&(r=!1,d&&d(m))},b=()=>!!y.capture()&&(t=!0,i=!1,m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime,a?a(m).then(x):x(),!0),x=()=>{f&&(()=>{if("undefined"!=typeof document){const e=document.activeElement;(null==e?void 0:e.blur)&&e.blur()}})(),l&&l(m),i=!0},_=()=>{t=!1,n=!1,r=!1,i=!0,y.release()},w=e=>{const n=t,r=i;_(),r&&(Nm(m,e),n?c&&c(m):u&&u(m))},k=((e,t,n,i,r)=>{let o,s,a,l,c,u,d,h=0;const p=i=>{h=Date.now()+2e3,t(i)&&(!s&&n&&(s=Dm(e,"touchmove",n,r)),a||(a=Dm(i.target,"touchend",m,r)),l||(l=Dm(i.target,"touchcancel",m,r)))},f=i=>{h>Date.now()||t(i)&&(!u&&n&&(u=Dm(Lm(e),"mousemove",n,r)),d||(d=Dm(Lm(e),"mouseup",g,r)))},m=e=>{y(),i&&i(e)},g=e=>{v(),i&&i(e)},y=()=>{s&&s(),a&&a(),l&&l(),s=a=l=void 0},v=()=>{u&&u(),d&&d(),u=d=void 0},b=()=>{y(),v()},x=(t=!0)=>{t?(o||(o=Dm(e,"touchstart",p,r)),c||(c=Dm(e,"mousedown",f,r))):(o&&o(),c&&c(),o=c=void 0,b())};return{enable:x,stop:b,destroy:()=>{x(!1),i=n=t=void 0}}})(o.el,(e=>{const t=$m(e);return!(n||!i)&&(Fm(e,m),m.startX=m.currentX,m.startY=m.currentY,m.startTime=m.currentTime=t,m.velocityX=m.velocityY=m.deltaX=m.deltaY=0,m.event=e,(!s||!1!==s(m))&&(y.release(),!!y.start()&&(n=!0,0===h?b():(g.start(m.startX,m.startY),!0))))}),(e=>{t?!r&&i&&(r=!0,Nm(m,e),requestAnimationFrame(v)):(Nm(m,e),g.detect(m.currentX,m.currentY)&&(g.isGesture()&&b()||E()))}),w,{capture:!1,passive:p}),E=()=>{_(),k.stop(),u&&u(m)};return{enable(e=!0){e||(t&&w(void 0),_()),k.enable(e)},destroy(){y.destroy(),k.destroy()}}})),Nm=(e,t)=>{if(!t)return;const n=e.currentX,i=e.currentY,r=e.currentTime;Fm(t,e);const o=e.currentX,s=e.currentY,a=(e.currentTime=$m(t))-r;if(a>0&&a<100){const t=(o-n)/a,r=(s-i)/a;e.velocityX=.7*t+.3*e.velocityX,e.velocityY=.7*r+.3*e.velocityY}e.deltaX=o-e.startX,e.deltaY=s-e.startY,e.event=t},Fm=(e,t)=>{let n=0,i=0;if(e){const t=e.changedTouches;if(t&&t.length>0){const e=t[0];n=e.clientX,i=e.clientY}else void 0!==e.pageX&&(n=e.pageX,i=e.pageY)}t.currentX=n,t.currentY=i},$m=e=>e.timeStamp||Date.now(),jm=Object.freeze(Object.defineProperty({__proto__:null,GESTURE_CONTROLLER:Om,createGesture:Bm},Symbol.toStringTag,{value:"Module"}));
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
class Vm{constructor(){this.m=new Map}reset(e){this.m=new Map(Object.entries(e))}get(e,t){const n=this.m.get(e);return void 0!==n?n:t}getBoolean(e,t=!1){const n=this.m.get(e);return void 0===n?t:"string"==typeof n?"true"===n:!!n}getNumber(e,t){const n=parseFloat(this.m.get(e));return isNaN(n)?void 0!==t?t:NaN:n}set(e,t){this.m.set(e,t)}}const Um=new Vm,qm=(e,t)=>e.substr(0,t.length)===t,Gm="ionic:",Wm="ionic-persist-config",Hm=(e,t)=>("string"==typeof e&&(t=e,e=void 0),(e=>Zm(e))(e).includes(t)),Zm=(e=window)=>{if(void 0===e)return[];e.Ionic=e.Ionic||{};let t=e.Ionic.platforms;return null==t&&(t=e.Ionic.platforms=Xm(e),t.forEach((t=>e.document.documentElement.classList.add(`plt-${t}`)))),t},Xm=e=>{const t=Um.get("platform");return Object.keys(rg).filter((n=>{const i=null==t?void 0:t[n];return"function"==typeof i?i(e):rg[n](e)}))},Km=e=>!!ng(e,/iPad/i)||!(!ng(e,/Macintosh/i)||!Ym(e)),Jm=e=>ng(e,/android|sink/i),Ym=e=>ig(e,"(any-pointer:coarse)"),Qm=e=>eg(e)||tg(e),eg=e=>!!(e.cordova||e.phonegap||e.PhoneGap),tg=e=>{const t=e.Capacitor;return!!(null==t?void 0:t.isNative)},ng=(e,t)=>t.test(e.navigator.userAgent),ig=(e,t)=>{var n;return null===(n=e.matchMedia)||void 0===n?void 0:n.call(e,t).matches},rg={ipad:Km,iphone:e=>ng(e,/iPhone/i),ios:e=>ng(e,/iPhone|iPod/i)||Km(e),android:Jm,phablet:e=>{const t=e.innerWidth,n=e.innerHeight,i=Math.min(t,n),r=Math.max(t,n);return i>390&&i<520&&r>620&&r<800},tablet:e=>{const t=e.innerWidth,n=e.innerHeight,i=Math.min(t,n),r=Math.max(t,n);return Km(e)||(e=>Jm(e)&&!ng(e,/mobile/i))(e)||i>460&&i<820&&r>780&&r<1400},cordova:eg,capacitor:tg,electron:e=>ng(e,/electron/i),pwa:e=>{var t;return!(!(null===(t=e.matchMedia)||void 0===t?void 0:t.call(e,"(display-mode: standalone)").matches)&&!e.navigator.standalone)},mobile:Ym,mobileweb:e=>Ym(e)&&!Qm(e),desktop:e=>!Ym(e),hybrid:Qm};let og;const sg=e=>e&&(e=>ff(e).$modeName$)(e)||og,ag=(e={})=>{if("undefined"==typeof window)return;const t=window.document,n=window,i=n.Ionic=n.Ionic||{},r={};var o;e._ael&&(r.ael=e._ael),e._rel&&(r.rel=e._rel),e._ce&&(r.ce=e._ce),o=r,Object.assign(kf,o);const s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(e=>{try{const t=e.sessionStorage.getItem(Wm);return null!==t?JSON.parse(t):{}}catch(wT){return{}}})(n)),{persistConfig:!1}),i.config),(e=>{const t={};return e.location.search.slice(1).split("&").map((e=>e.split("="))).map((([e,t])=>[decodeURIComponent(e),decodeURIComponent(t)])).filter((([e])=>qm(e,Gm))).map((([e,t])=>[e.slice(Gm.length),t])).forEach((([e,n])=>{t[e]=n})),t})(n)),e);Um.reset(s),Um.getBoolean("persistConfig")&&((e,t)=>{try{e.sessionStorage.setItem(Wm,JSON.stringify(t))}catch(wT){return}})(n,s),Zm(n),i.config=Um,i.mode=og=Um.get("mode",t.documentElement.getAttribute("mode")||(Hm(n,"ios")?"ios":"md")),Um.set("mode",og),t.documentElement.setAttribute("mode",og),t.documentElement.classList.add(og),Um.getBoolean("_testing")&&Um.set("animated",!1);const a=e=>{var t;return null===(t=e.tagName)||void 0===t?void 0:t.startsWith("ION-")},l=e=>["ios","md"].includes(e);var c;c=e=>{for(;e;){const t=e.mode||e.getAttribute("mode");if(t){if(l(t))return t;a(e)&&console.warn('Invalid ionic mode: "'+t+'", expected: "ios" or "md"')}e=e.parentElement}return og},bf.push(c)},lg=e=>{try{if(e instanceof fg)return e.value;if(!dg()||"string"!=typeof e||""===e)return e;if(e.includes("onload="))return"";const t=document.createDocumentFragment(),n=document.createElement("div");t.appendChild(n),n.innerHTML=e,pg.forEach((e=>{const n=t.querySelectorAll(e);for(let i=n.length-1;i>=0;i--){const e=n[i];e.parentNode?e.parentNode.removeChild(e):t.removeChild(e);const r=ug(e);for(let t=0;t<r.length;t++)cg(r[t])}}));const i=ug(t);for(let e=0;e<i.length;e++)cg(i[e]);const r=document.createElement("div");r.appendChild(t);const o=r.querySelector("div");return null!==o?o.innerHTML:r.innerHTML}catch(t){return console.error(t),""}},cg=e=>{if(e.nodeType&&1!==e.nodeType)return;if("undefined"!=typeof NamedNodeMap&&!(e.attributes instanceof NamedNodeMap))return void e.remove();for(let n=e.attributes.length-1;n>=0;n--){const t=e.attributes.item(n),i=t.name;if(!hg.includes(i.toLowerCase())){e.removeAttribute(i);continue}const r=t.value,o=e[i];(null!=r&&r.toLowerCase().includes("javascript:")||null!=o&&o.toLowerCase().includes("javascript:"))&&e.removeAttribute(i)}const t=ug(e);for(let n=0;n<t.length;n++)cg(t[n])},ug=e=>null!=e.children?e.children:e.childNodes,dg=()=>{var e;const t=window,n=null===(e=null==t?void 0:t.Ionic)||void 0===e?void 0:e.config;return!n||(n.get?n.get("sanitizerEnabled",!0):!0===n.sanitizerEnabled||void 0===n.sanitizerEnabled)},hg=["class","id","href","src","name","slot"],pg=["script","style","iframe","meta","link","object","embed"];class fg{constructor(e){this.value=e}}const mg=Object.freeze(Object.defineProperty({__proto__:null,MENU_BACK_BUTTON_PRIORITY:99,OVERLAY_BACK_BUTTON_PRIORITY:100,blockHardwareBackButton:()=>{document.addEventListener("backbutton",(()=>{}))},startHardwareBackButton:()=>{const e=document;let t=!1;e.addEventListener("backbutton",(()=>{if(t)return;let n=0,i=[];const r=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(e,t){i.push({priority:e,handler:t,id:n++})}}});e.dispatchEvent(r);const o=()=>{if(i.length>0){let e={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};i.forEach((t=>{t.priority>=e.priority&&(e=t)})),t=!0,i=i.filter((t=>t.id!==e.id)),(async e=>{try{if(null==e?void 0:e.handler){const t=e.handler(o);null!=t&&await t}}catch(wT){console.error(wT)}})(e).then((()=>t=!1))}};o()}))}},Symbol.toStringTag,{value:"Module"})),gg=e=>om().duration(e?400:300),yg=e=>{let t,n;const i=e.width+8,r=om(),o=om();e.isEndSide?(t=i+"px",n="0px"):(t=-i+"px",n="0px"),r.addElement(e.menuInnerEl).fromTo("transform",`translateX(${t})`,`translateX(${n})`);const s="ios"===sg(e),a=s?.2:.25;return o.addElement(e.backdropEl).fromTo("opacity",.01,a),gg(s).addAnimation([r,o])},vg=e=>{let t,n;const i=sg(e),r=e.width;e.isEndSide?(t=-r+"px",n=r+"px"):(t=r+"px",n=-r+"px");const o=om().addElement(e.menuInnerEl).fromTo("transform",`translateX(${n})`,"translateX(0px)"),s=om().addElement(e.contentEl).fromTo("transform","translateX(0px)",`translateX(${t})`),a=om().addElement(e.backdropEl).fromTo("opacity",.01,.32);return gg("ios"===i).addAnimation([o,s,a])},bg=e=>{const t=sg(e),n=e.width*(e.isEndSide?-1:1)+"px",i=om().addElement(e.contentEl).fromTo("transform","translateX(0px)",`translateX(${n})`);return gg("ios"===t).addAnimation(i)},xg=()=>{const e=new Map,t=[],n=async e=>{if(await u(),"start"===e||"end"===e){const t=c((t=>t.side===e&&!t.disabled));return t||c((t=>t.side===e))}if(null!=e)return c((t=>t.menuId===e));const n=c((e=>!e.disabled));return n||(t.length>0?t[0].el:void 0)},i=async()=>(await u(),s()),r=(t,n)=>{e.set(t,n)},o=e=>{const n=e.side;t.filter((t=>t.side===n&&t!==e)).forEach((e=>e.disabled=!0))},s=()=>c((e=>e._isOpen)),a=()=>t.map((e=>e.el)),l=()=>t.some((e=>e.isAnimating)),c=e=>{const n=t.find(e);if(void 0!==n)return n.el},u=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map((e=>new Promise((t=>Lf(e,t))))));return r("reveal",bg),r("push",vg),r("overlay",yg),"undefined"!=typeof document&&document.addEventListener("ionBackButton",(e=>{const t=s();t&&e.detail.register(99,(()=>t.close()))})),{registerAnimation:r,get:n,getMenus:async()=>(await u(),a()),getOpen:i,isEnabled:async e=>{const t=await n(e);return!!t&&!t.disabled},swipeGesture:async(e,t)=>{const i=await n(t);return i&&(i.swipeGesture=e),i},isAnimating:async()=>(await u(),l()),isOpen:async e=>{if(null!=e){const t=await n(e);return void 0!==t&&t.isOpen()}return void 0!==await i()},enable:async(e,t)=>{const i=await n(t);return i&&(i.disabled=!e),i},toggle:async e=>{const t=await n(e);return!!t&&t.toggle()},close:async e=>{const t=await(void 0!==e?n(e):i());return void 0!==t&&t.close()},open:async e=>{const t=await n(e);return!!t&&t.open()},_getOpenSync:s,_createAnimation:(t,n)=>{const i=e.get(t);if(!i)throw new Error("animation not registered");return i(n)},_register:e=>{t.indexOf(e)<0&&(e.disabled||o(e),t.push(e))},_unregister:e=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},_setOpen:async(e,t,n)=>{if(l())return!1;if(t){const t=await i();t&&e.el!==t&&await t.setOpen(!1,!1)}return e._setOpen(t,n)},_setActiveMenu:o}},_g=xg(),wg=async(e,t,n,i,r,o)=>{var s;if(e)return e.attachViewToDom(t,n,r,i);if(!(o||"string"==typeof n||n instanceof HTMLElement))throw new Error("framework delegate is missing");const a="string"==typeof n?null===(s=t.ownerDocument)||void 0===s?void 0:s.createElement(n):n;return i&&i.forEach((e=>a.classList.add(e))),r&&Object.assign(a,r),t.appendChild(a),await new Promise((e=>Lf(a,e))),a},kg=(e,t)=>{if(t){if(e){const n=t.parentElement;return e.removeViewFromDom(n,t)}t.remove()}return Promise.resolve()},Eg=()=>{let e,t;return{attachViewToDom:async(n,i,r={},o=[])=>{var s,a;if(e=n,i){const t="string"==typeof i?null===(s=e.ownerDocument)||void 0===s?void 0:s.createElement(i):i;o.forEach((e=>t.classList.add(e))),Object.assign(t,r),e.appendChild(t),await new Promise((e=>Lf(t,e)))}else if(e.children.length>0&&("ION-MODAL"===e.tagName||"ION-POPOVER"===e.tagName)&&!e.children[0].classList.contains("ion-delegate-host")){const t=null===(a=e.ownerDocument)||void 0===a?void 0:a.createElement("div");t.classList.add("ion-delegate-host"),o.forEach((e=>t.classList.add(e))),t.append(...e.children),e.appendChild(t)}const l=document.querySelector("ion-app")||document.body;return t=document.createComment("ionic teleport"),e.parentNode.insertBefore(t,e),l.appendChild(e),e},removeViewFromDom:()=>(e&&t&&(t.parentNode.insertBefore(e,t),t.remove()),Promise.resolve())}},Sg=(e,...t)=>console.warn(`[Ionic Warning]: ${e}`,...t),Tg=(e,...t)=>console.error(`[Ionic Error]: ${e}`,...t);
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
let Cg=0,Mg=0;const Ig=new WeakMap,Ag=e=>({create:t=>Rg(e,t),dismiss:(t,n,i)=>$g(document,t,n,e,i),getTop:async()=>jg(document,e)}),Pg=Ag("ion-toast"),Og=e=>{"undefined"!=typeof document&&Fg(document);const t=Cg++;e.overlayIndex=t},Dg=e=>(e.hasAttribute("id")||(e.id="ion-overlay-"+ ++Mg),e.id),Rg=(e,t)=>"undefined"!=typeof window&&void 0!==window.customElements?window.customElements.whenDefined(e).then((()=>{const n=document.createElement(e);return n.classList.add("overlay-hidden"),Object.assign(n,Object.assign(Object.assign({},t),{hasController:!0})),Wg(document).appendChild(n),new Promise((e=>Lf(n,e)))})):Promise.resolve(),zg='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Lg=(e,t)=>{let n=e.querySelector(zg);const i=null==n?void 0:n.shadowRoot;i&&(n=i.querySelector(zg)||n),n?(e=>{if(e.focus(),e.classList.contains("ion-focusable")){const t=e.closest("ion-app");t&&t.setFocus([e])}})(n):t.focus()},Bg=(e,t)=>{const n=Array.from(e.querySelectorAll(zg));let i=n.length>0?n[n.length-1]:null;const r=null==i?void 0:i.shadowRoot;r&&(i=r.querySelector(zg)||i),i?i.focus():t.focus()},Ng=(e,t)=>{const n=jg(t,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),i=e.target;n&&i&&(n.classList.contains("ion-disable-focus-trap")||(n.shadowRoot?(()=>{if(n.contains(i))n.lastFocus=i;else{const e=n.lastFocus;Lg(n,n),e===t.activeElement&&Bg(n,n),n.lastFocus=t.activeElement}})():(()=>{if(n===i)n.lastFocus=void 0;else{const e=Uf(n);if(!e.contains(i))return;const r=e.querySelector(".ion-overlay-wrapper");if(!r)return;if(r.contains(i))n.lastFocus=i;else{const e=n.lastFocus;Lg(r,n),e===t.activeElement&&Bg(r,n),n.lastFocus=t.activeElement}}})()))},Fg=e=>{0===Cg&&(Cg=1,e.addEventListener("focus",(t=>{Ng(t,e)}),!0),e.addEventListener("ionBackButton",(t=>{const n=jg(e);(null==n?void 0:n.backdropDismiss)&&t.detail.register(100,(()=>n.dismiss(void 0,Yg)))})),e.addEventListener("keydown",(t=>{if("Escape"===t.key){const t=jg(e);(null==t?void 0:t.backdropDismiss)&&t.dismiss(void 0,Yg)}})))},$g=(e,t,n,i,r)=>{const o=jg(e,i,r);return o?o.dismiss(t,n):Promise.reject("overlay does not exist")},jg=(e,t,n)=>{const i=((e,t)=>(void 0===t&&(t="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(e.querySelectorAll(t)).filter((e=>e.overlayIndex>0))))(e,t).filter((e=>!e.classList.contains("overlay-hidden")));return void 0===n?i[i.length-1]:i.find((e=>e.id===n))},Vg=(e=!1)=>{const t=Wg(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");t&&(e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden"))},Ug=async(e,t,n,i,r)=>{var o,s;if(e.presented)return;Vg(!0),e.presented=!0,e.willPresent.emit(),null===(o=e.willPresentShorthand)||void 0===o||o.emit();const a=sg(e),l=e.enterAnimation?e.enterAnimation:Um.get(t,"ios"===a?n:i);await Hg(e,l,e.el,r)&&(e.didPresent.emit(),null===(s=e.didPresentShorthand)||void 0===s||s.emit()),"ION-TOAST"!==e.el.tagName&&qg(e.el),!e.keyboardClose||null!==document.activeElement&&e.el.contains(document.activeElement)||e.el.focus()},qg=async e=>{let t=document.activeElement;if(!t)return;const n=null==t?void 0:t.shadowRoot;n&&(t=n.querySelector(zg)||t),await e.onDidDismiss(),t.focus()},Gg=async(e,t,n,i,r,o,s)=>{var a,l;if(!e.presented)return!1;Vg(!1),e.presented=!1;try{e.el.style.setProperty("pointer-events","none"),e.willDismiss.emit({data:t,role:n}),null===(a=e.willDismissShorthand)||void 0===a||a.emit({data:t,role:n});const c=sg(e),u=e.leaveAnimation?e.leaveAnimation:Um.get(i,"ios"===c?r:o);n!==Qg&&await Hg(e,u,e.el,s),e.didDismiss.emit({data:t,role:n}),null===(l=e.didDismissShorthand)||void 0===l||l.emit({data:t,role:n}),Ig.delete(e),e.el.classList.add("overlay-hidden"),e.el.style.removeProperty("pointer-events"),void 0!==e.el.lastFocus&&(e.el.lastFocus=void 0)}catch(c){console.error(c)}return e.el.remove(),!0},Wg=e=>e.querySelector("ion-app")||e.body,Hg=async(e,t,n,i)=>{n.classList.remove("overlay-hidden");const r=t(e.el,i);e.animated&&Um.getBoolean("animated",!0)||r.duration(0),e.keyboardClose&&r.beforeAddWrite((()=>{const e=n.ownerDocument.activeElement;(null==e?void 0:e.matches("input,ion-input, ion-textarea"))&&e.blur()}));const o=Ig.get(e)||[];return Ig.set(e,[...o,r]),await r.play(),!0},Zg=(e,t)=>{let n;const i=new Promise((e=>n=e));return Xg(e,t,(e=>{n(e.detail)})),i},Xg=(e,t,n)=>{const i=r=>{Vf(e,t,i),n(r)};jf(e,t,i)},Kg=e=>"cancel"===e||e===Yg,Jg=e=>e(),Yg="backdrop",Qg="gesture",ey=()=>{let e;const t=()=>{e&&(e(),e=void 0)};return{addClickListener:(n,i)=>{t();const r=void 0!==i?document.getElementById(i):null;r?e=((e,t)=>{const n=()=>{t.present()};return e.addEventListener("click",n),()=>{e.removeEventListener("click",n)}})(r,n):Sg(`A trigger element with the ID "${i}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,n)},removeClickListener:t}};var ty=function(e,t){return ty=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ty(e,t)};function ny(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ty(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var iy=function(){return iy=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},iy.apply(this,arguments)};function ry(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function oy(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(wT){o(wT)}}function a(e){try{l(i.throw(e))}catch(wT){o(wT)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}function sy(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(wT){a=[6,wT],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function ay(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */const ly="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M184 112l144 144-144 144' class='ionicon-fill-none'/></svg>",cy="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm75.31 260.69a16 16 0 11-22.62 22.62L256 278.63l-52.69 52.68a16 16 0 01-22.62-22.62L233.37 256l-52.68-52.69a16 16 0 0122.62-22.62L256 233.37l52.69-52.68a16 16 0 0122.62 22.62L278.63 256z'/></svg>",uy="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M400 145.49L366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49z'/></svg>";
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
let dy;const hy=e=>{const t=(()=>{if("undefined"==typeof window)return new Map;if(!dy){const e=window;e.Ionicons=e.Ionicons||{},dy=e.Ionicons.map=e.Ionicons.map||new Map}return dy})().get(e);return t||(e=>{const t=new URL(e,kf.$resourcesUrl$);return t.origin!==xf.location.origin?t.href:t.pathname})(`svg/${e}.svg`)},py=(e,t,n,i,r)=>(n="ios"===(n&&yy(n))?"ios":"md",i&&"ios"===n?e=yy(i):r&&"md"===n?e=yy(r):(e||!t||my(t)||(e=t),gy(e)&&(e=yy(e))),gy(e)&&""!==e.trim()?""!==e.replace(/[a-z]|-|\d/gi,"")?null:e:null),fy=e=>gy(e)&&(e=e.trim(),my(e))?e:null,my=e=>e.length>0&&/(\/|\.)/.test(e),gy=e=>"string"==typeof e,yy=e=>e.toLowerCase(),vy=e=>{if(1===e.nodeType){if("script"===e.nodeName.toLowerCase())return!1;for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t].name;if(gy(n)&&0===n.toLowerCase().indexOf("on"))return!1}for(let t=0;t<e.childNodes.length;t++)if(!vy(e.childNodes[t]))return!1}return!0},by=new Map,xy=new Map;let _y;const wy=(e,t)=>{let n=xy.get(e);if(!n){if("undefined"==typeof fetch||"undefined"==typeof document)return by.set(e,""),Promise.resolve();if((e=>e.startsWith("data:image/svg+xml"))(e)&&(e=>-1!==e.indexOf(";utf8,"))(e)){_y||(_y=new DOMParser);const t=_y.parseFromString(e,"text/html").querySelector("svg");return t&&by.set(e,t.outerHTML),Promise.resolve()}n=fetch(e).then((n=>{if(n.ok)return n.text().then((n=>{n&&!1!==t&&(n=(e=>{const t=document.createElement("div");t.innerHTML=e;for(let i=t.childNodes.length-1;i>=0;i--)"svg"!==t.childNodes[i].nodeName.toLowerCase()&&t.removeChild(t.childNodes[i]);const n=t.firstElementChild;if(n&&"svg"===n.nodeName.toLowerCase()){const e=n.getAttribute("class")||"";if(n.setAttribute("class",(e+" s-ion-icon").trim()),vy(n))return t.innerHTML}return""})(n)),by.set(e,n||"")}));by.set(e,"")})),xy.set(e,n)}return n},ky=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.isVisible=!1,this.mode=Ey(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=((e,t=[])=>{const n={};return t.forEach((t=>{e.hasAttribute(t)&&(null!==e.getAttribute(t)&&(n[t]=e.getAttribute(t)),e.removeAttribute(t))})),n})(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",(()=>{this.isVisible=!0,this.loadIcon()}))}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,t,n){if(this.lazy&&"undefined"!=typeof window&&window.IntersectionObserver){const i=this.io=new window.IntersectionObserver((e=>{e[0].isIntersecting&&(i.disconnect(),this.io=void 0,n())}),{rootMargin:t});i.observe(e)}else n()}loadIcon(){if(this.isVisible){const e=(e=>{let t=fy(e.src);if(t)return t;if(t=py(e.name,e.icon,e.mode,e.ios,e.md),t)return hy(t);if(e.icon){if(t=fy(e.icon),t)return t;if(t=fy(e.icon[e.mode]),t)return t}return null})(this);e&&(by.has(e)?this.svgContent=by.get(e):wy(e,this.sanitize).then((()=>this.svgContent=by.get(e))))}this.iconName=py(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{iconName:e,el:t,inheritedAttributes:n}=this,i=this.mode||"md",r=this.flipRtl||e&&(e.indexOf("arrow")>-1||e.indexOf("chevron")>-1)&&!1!==this.flipRtl;return bp(_p,Object.assign({role:"img",class:Object.assign(Object.assign({[i]:!0},Sy(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":!!r&&(o=t,o&&""!==o.dir?"rtl"===o.dir.toLowerCase():"rtl"===(null===document||void 0===document?void 0:document.dir.toLowerCase()))})},n),this.svgContent?bp("div",{class:"icon-inner",innerHTML:this.svgContent}):bp("div",{class:"icon-inner"}));var o}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}:host(.flip-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.icon-small){font-size:18px !important}:host(.icon-large){font-size:32px !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}"}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]}]),Ey=()=>"undefined"!=typeof document&&document.documentElement.getAttribute("mode")||"md",Sy=e=>e?{"ion-color":!0,[`ion-color-${e}`]:!0}:null;function Ty(){"undefined"!=typeof customElements&&["ion-icon"].forEach((e=>{"ion-icon"===e&&(customElements.get(e)||customElements.define(e,ky))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */const Cy=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow()}render(){return bp(_p,{class:sg(this)},bp("slot",null))}static get style(){return{ios:":host{border-radius:var(--border-radius);display:block}::slotted(ion-img),::slotted(img){border-radius:var(--border-radius);width:100%;height:100%;-o-object-fit:cover;object-fit:cover;overflow:hidden}:host{--border-radius:50%;width:48px;height:48px}",md:":host{border-radius:var(--border-radius);display:block}::slotted(ion-img),::slotted(img){border-radius:var(--border-radius);width:100%;height:100%;-o-object-fit:cover;object-fit:cover;overflow:hidden}:host{--border-radius:50%;width:64px;height:64px}"}}},[33,"ion-avatar"]),My=function(){"undefined"!=typeof customElements&&["ion-avatar"].forEach((e=>{"ion-avatar"===e&&(customElements.get(e)||customElements.define(e,Cy))}))},Iy=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionBackdropTap=Sp(this,"ionBackdropTap",7),this.blocker=Om.createBlocker({disableScroll:!0}),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}connectedCallback(){this.stopPropagation&&this.blocker.block()}disconnectedCallback(){this.blocker.unblock()}onMouseDown(e){this.emitTap(e)}emitTap(e){this.stopPropagation&&(e.preventDefault(),e.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const e=sg(this);return bp(_p,{tabindex:"-1","aria-hidden":"true",class:{[e]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",md:":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}"}}},[33,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]);function Ay(){"undefined"!=typeof customElements&&["ion-backdrop"].forEach((e=>{"ion-backdrop"===e&&(customElements.get(e)||customElements.define(e,Iy))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */const Py=(e,t)=>null!==t.closest(e),Oy=(e,t)=>"string"==typeof e&&e.length>0?Object.assign({"ion-color":!0,[`ion-color-${e}`]:!0},t):t,Dy=e=>{const t={};return(e=>void 0!==e?(Array.isArray(e)?e:e.split(" ")).filter((e=>null!=e)).map((e=>e.trim())).filter((e=>""!==e)):[])(e).forEach((e=>t[e]=!0)),t},Ry=/^[a-z][a-z0-9+\-.]*:/,zy=async(e,t,n,i)=>{if(null!=e&&"#"!==e[0]&&!Ry.test(e)){const r=document.querySelector("ion-router");if(r)return null!=t&&t.preventDefault(),r.push(e,n,i)}return!1},Ly=lf(class extends wf{constructor(){super(),this.__registerHost(),this.collapse=!1}render(){const e=sg(this);return bp(_p,{class:{[e]:!0,"buttons-collapse":this.collapse}})}static get style(){return{ios:".sc-ion-buttons-ios-h{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:99}.sc-ion-buttons-ios-s ion-button{--padding-top:0;--padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.sc-ion-buttons-ios-s ion-button{--padding-start:5px;--padding-end:5px;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;height:32px}.sc-ion-buttons-ios-s ion-button:not(.button-round){--border-radius:4px}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button{--color:initial;--border-color:initial;--background-focused:var(--ion-color-contrast)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-solid,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-solid{--background:var(--ion-color-contrast);--background-focused:#000;--background-focused-opacity:.12;--background-activated:#000;--background-activated-opacity:.12;--background-hover:var(--ion-color-base);--background-hover-opacity:0.45;--color:var(--ion-color-base);--color-focused:var(--ion-color-base)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-clear,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-clear{--color-activated:var(--ion-color-contrast);--color-focused:var(--ion-color-contrast)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-outline,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-outline{--color-activated:var(--ion-color-base);--color-focused:var(--ion-color-contrast);--background-activated:var(--ion-color-contrast)}.sc-ion-buttons-ios-s .button-clear,.sc-ion-buttons-ios-s .button-outline{--background-activated:transparent;--background-focused:currentColor;--background-hover:transparent}.sc-ion-buttons-ios-s .button-solid:not(.ion-color){--background-focused:#000;--background-focused-opacity:.12;--background-activated:#000;--background-activated-opacity:.12}.sc-ion-buttons-ios-s ion-icon[slot=start]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-end:0.3em;margin-inline-end:0.3em;font-size:24px;line-height:0.67}.sc-ion-buttons-ios-s ion-icon[slot=end]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-start:0.4em;margin-inline-start:0.4em;font-size:24px;line-height:0.67}.sc-ion-buttons-ios-s ion-icon[slot=icon-only]{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;font-size:28px;line-height:0.67}",md:".sc-ion-buttons-md-h{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:99}.sc-ion-buttons-md-s ion-button{--padding-top:0;--padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.sc-ion-buttons-md-s ion-button{--padding-top:0;--padding-bottom:0;--padding-start:8px;--padding-end:8px;--box-shadow:none;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;height:32px}.sc-ion-buttons-md-s ion-button:not(.button-round){--border-radius:2px}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button{--color:initial;--color-focused:var(--ion-color-contrast);--color-hover:var(--ion-color-contrast);--background-activated:transparent;--background-focused:var(--ion-color-contrast);--background-hover:var(--ion-color-contrast)}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button-solid,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button-solid{--background:var(--ion-color-contrast);--background-activated:transparent;--background-focused:var(--ion-color-shade);--background-hover:var(--ion-color-base);--color:var(--ion-color-base);--color-focused:var(--ion-color-base);--color-hover:var(--ion-color-base)}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button-outline,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button-outline{--border-color:var(--ion-color-contrast)}.sc-ion-buttons-md-s .button-has-icon-only.button-clear{--padding-top:12px;--padding-end:12px;--padding-bottom:12px;--padding-start:12px;--border-radius:50%;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;width:48px;height:48px}.sc-ion-buttons-md-s .button{--background-hover:currentColor}.sc-ion-buttons-md-s .button-solid{--color:var(--ion-toolbar-background, var(--ion-background-color, #fff));--background:var(--ion-toolbar-color, var(--ion-text-color, #424242));--background-activated:transparent;--background-focused:currentColor}.sc-ion-buttons-md-s .button-outline{--color:initial;--background:transparent;--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--border-color:currentColor}.sc-ion-buttons-md-s .button-clear{--color:initial;--background:transparent;--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor}.sc-ion-buttons-md-s ion-icon[slot=start]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-end:0.3em;margin-inline-end:0.3em;font-size:1.4em}.sc-ion-buttons-md-s ion-icon[slot=end]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-start:0.4em;margin-inline-start:0.4em;font-size:1.4em}.sc-ion-buttons-md-s ion-icon[slot=icon-only]{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;font-size:1.8em}"}}},[34,"ion-buttons",{collapse:[4]}]),By=function(){"undefined"!=typeof customElements&&["ion-buttons"].forEach((e=>{"ion-buttons"===e&&(customElements.get(e)||customElements.define(e,Ly))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */,Ny=e=>!!(null!==e.shadowRoot&&(Fy.includes(e.tagName)&&null!==e.querySelector('[slot="label"]')||$y.includes(e.tagName)&&""!==e.textContent)),Fy=["ION-RANGE"],$y=["ION-TOGGLE","ION-CHECKBOX","ION-RADIO"],jy=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(e,t){return new Promise((n=>{Of((()=>{const i=this.el.getBoundingClientRect(),r=i.width,o=i.height,s=Math.sqrt(r*r+o*o),a=Math.max(o,r),l=this.unbounded?a:s+Uy,c=Math.floor(a*qy),u=l/c;let d=e-i.left,h=t-i.top;this.unbounded&&(d=.5*r,h=.5*o);const p=d-.5*c,f=h-.5*c,m=.5*r-d,g=.5*o-h;Df((()=>{const e=document.createElement("div");e.classList.add("ripple-effect");const t=e.style;t.top=f+"px",t.left=p+"px",t.width=t.height=c+"px",t.setProperty("--final-scale",`${u}`),t.setProperty("--translate-end",`${m}px, ${g}px`),(this.el.shadowRoot||this.el).appendChild(e),setTimeout((()=>{n((()=>{Vy(e)}))}),325)}))}))}))}get unbounded(){return"unbounded"===this.type}render(){const e=sg(this);return bp(_p,{role:"presentation",class:{[e]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}"}},[1,"ion-ripple-effect",{type:[1],addRipple:[64]}]),Vy=e=>{e.classList.add("fade-out"),setTimeout((()=>{e.remove()}),200)},Uy=10,qy=.5;function Gy(){"undefined"!=typeof customElements&&["ion-ripple-effect"].forEach((e=>{"ion-ripple-effect"===e&&(customElements.get(e)||customElements.define(e,jy))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */const Wy="undefined"!=typeof window?window:void 0;Wy&&Wy.CSS&&Wy.CSS.supports&&Wy.CSS.supports("--a: 0");
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
const Hy=e("i",(e=>e&&""!==e.dir?"rtl"===e.dir.toLowerCase():"rtl"===(null===document||void 0===document?void 0:document.dir.toLowerCase()))),Zy=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionScrollStart=Sp(this,"ionScrollStart",7),this.ionScroll=Sp(this,"ionScroll",7),this.ionScrollEnd=Sp(this,"ionScrollEnd",7),this.watchDog=null,this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.isMainContent=!0,this.resizeTimeout=null,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.color=void 0,this.fullscreen=!1,this.forceOverscroll=void 0,this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1}connectedCallback(){this.isMainContent=null===this.el.closest("ion-menu, ion-popover, ion-modal")}disconnectedCallback(){this.onScrollEnd()}onAppLoad(){this.resize()}onResize(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeTimeout=setTimeout((()=>{null!==this.el.offsetParent&&this.resize()}),100)}shouldForceOverscroll(){const{forceOverscroll:e}=this,t=sg(this);return void 0===e?"ios"===t&&Hm("ios"):e}resize(){this.fullscreen?Of((()=>this.readDimensions())):0===this.cTop&&0===this.cBottom||(this.cTop=this.cBottom=0,tf(this))}readDimensions(){const e=Xy(this.el),t=Math.max(this.el.offsetTop,0),n=Math.max(e.offsetHeight-t-this.el.offsetHeight,0);(t!==this.cTop||n!==this.cBottom)&&(this.cTop=t,this.cBottom=n,tf(this))}onScroll(e){const t=Date.now(),n=!this.isScrolling;this.lastScroll=t,n&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,Of((t=>{this.queued=!1,this.detail.event=e,Ky(this.detail,this.scrollEl,t,n),this.ionScroll.emit(this.detail)})))}async getScrollElement(){return this.scrollEl||await new Promise((e=>Lf(this.el,e))),Promise.resolve(this.scrollEl)}async getBackgroundElement(){return this.backgroundContentEl||await new Promise((e=>Lf(this.el,e))),Promise.resolve(this.backgroundContentEl)}scrollToTop(e=0){return this.scrollToPoint(void 0,0,e)}async scrollToBottom(e=0){const t=await this.getScrollElement(),n=t.scrollHeight-t.clientHeight;return this.scrollToPoint(void 0,n,e)}async scrollByPoint(e,t,n){const i=await this.getScrollElement();return this.scrollToPoint(e+i.scrollLeft,t+i.scrollTop,n)}async scrollToPoint(e,t,n=0){const i=await this.getScrollElement();if(n<32)return null!=t&&(i.scrollTop=t),void(null!=e&&(i.scrollLeft=e));let r,o=0;const s=new Promise((e=>r=e)),a=i.scrollTop,l=i.scrollLeft,c=null!=t?t-a:0,u=null!=e?e-l:0,d=e=>{const t=Math.min(1,(e-o)/n)-1,s=Math.pow(t,3)+1;0!==c&&(i.scrollTop=Math.floor(s*c+a)),0!==u&&(i.scrollLeft=Math.floor(s*u+l)),s<1?requestAnimationFrame(d):r()};return requestAnimationFrame((e=>{o=e,d(e)})),s}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval((()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()}),100)}onScrollEnd(){this.watchDog&&clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{isMainContent:e,scrollX:t,scrollY:n,el:i}=this,r=Hy(i)?"rtl":"ltr",o=sg(this),s=this.shouldForceOverscroll(),a="ios"===o,l=e?"main":"div";return this.resize(),bp(_p,{class:Oy(this.color,{[o]:!0,"content-sizing":Py("ion-popover",this.el),overscroll:s,[`content-${r}`]:!0}),style:{"--offset-top":`${this.cTop}px`,"--offset-bottom":`${this.cBottom}px`}},bp("div",{ref:e=>this.backgroundContentEl=e,id:"background-content",part:"background"}),bp(l,{class:{"inner-scroll":!0,"scroll-x":t,"scroll-y":n,overscroll:(t||n)&&s},ref:e=>this.scrollEl=e,onScroll:this.scrollEvents?e=>this.onScroll(e):void 0,part:"scroll"},bp("slot",null)),a?bp("div",{class:"transition-effect"},bp("div",{class:"transition-cover"}),bp("div",{class:"transition-shadow"})):null,bp("slot",{name:"fixed"}))}get el(){return this}static get style(){return':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.outer-content){--background:var(--ion-color-step-50, #f2f2f2)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-ms-touch-action:pan-x pan-y pinch-zoom;touch-action:pan-x pan-y pinch-zoom}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;z-index:0;will-change:scroll-position}.scroll-y{overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{overflow-x:var(--overflow);overscroll-behavior-x:contain}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:0;contain:none}:host(.content-sizing) .inner-scroll{position:relative;top:0;bottom:0;margin-top:calc(var(--offset-top) * -1);margin-bottom:calc(var(--offset-bottom) * -1)}.transition-effect{display:none;position:absolute;width:100%;height:100vh;opacity:0;pointer-events:none}:host(.content-ltr) .transition-effect{left:-100%;}:host(.content-rtl) .transition-effect{right:-100%;}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;width:100%;height:100%;-webkit-box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03);box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03)}:host(.content-ltr) .transition-shadow{right:0;}:host(.content-rtl) .transition-shadow{left:0;-webkit-transform:scaleX(-1);transform:scaleX(-1)}::slotted([slot=fixed]){position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}'}},[1,"ion-content",{color:[513],fullscreen:[4],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"],getScrollElement:[64],getBackgroundElement:[64],scrollToTop:[64],scrollToBottom:[64],scrollByPoint:[64],scrollToPoint:[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]]),Xy=e=>{const t=e.closest("ion-tabs");if(t)return t;const n=e.closest("ion-app, ion-page, .ion-page, page-inner, .popover-content");return n||(e=>{var t;return e.parentElement?e.parentElement:(null===(t=e.parentNode)||void 0===t?void 0:t.host)?e.parentNode.host:null})(e)},Ky=(e,t,n,i)=>{const r=e.currentX,o=e.currentY,s=e.currentTime,a=t.scrollLeft,l=t.scrollTop,c=n-s;if(i&&(e.startTime=n,e.startX=a,e.startY=l,e.velocityX=e.velocityY=0),e.currentTime=n,e.currentX=e.scrollLeft=a,e.currentY=e.scrollTop=l,e.deltaX=a-e.startX,e.deltaY=l-e.startY,c>0&&c<100){const t=(a-r)/c,n=(l-o)/c;e.velocityX=.7*t+.3*e.velocityX,e.velocityY=.7*n+.3*e.velocityY}},Jy=function(){"undefined"!=typeof customElements&&["ion-content"].forEach((e=>{"ion-content"===e&&(customElements.get(e)||customElements.define(e,Zy))}))},Yy=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionFocus=Sp(this,"ionFocus",7),this.ionBlur=Sp(this,"ionBlur",7),this.inItem=!1,this.inListHeader=!1,this.inToolbar=!1,this.inheritedAttributes={},this.handleClick=e=>{const{el:t}=this;if("button"===this.type)zy(this.href,e,this.routerDirection,this.routerAnimation);else if((e=>!!e.shadowRoot&&!!e.attachShadow)(t)){let n=this.findForm();const{form:i}=this;if(!n&&void 0!==i)return void Sg("string"==typeof i?`Form with selector: "#${i}" could not be found. Verify that the id is correct and the form is rendered in the DOM.`:'The provided "form" element is invalid. Verify that the form is a HTMLFormElement and rendered in the DOM.',t);if(n||(n=t.closest("form")),n){e.preventDefault();const t=document.createElement("button");t.type=this.type,t.style.display="none",n.appendChild(t),t.click(),t.remove()}}},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.color=void 0,this.buttonType="button",this.disabled=!1,this.expand=void 0,this.fill=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.download=void 0,this.href=void 0,this.rel=void 0,this.shape=void 0,this.size=void 0,this.strong=!1,this.target=void 0,this.type="button",this.form=void 0}componentWillLoad(){this.inToolbar=!!this.el.closest("ion-buttons"),this.inListHeader=!!this.el.closest("ion-list-header"),this.inItem=!!this.el.closest("ion-item")||!!this.el.closest("ion-item-divider"),this.inheritedAttributes=$f(this.el)}get hasIconOnly(){return!!this.el.querySelector('[slot="icon-only"]')}get rippleType(){return(void 0===this.fill||"clear"===this.fill)&&this.hasIconOnly&&this.inToolbar?"unbounded":"bounded"}findForm(){const{form:e}=this;if(e instanceof HTMLFormElement)return e;if("string"==typeof e){const t=document.getElementById(e);if(t instanceof HTMLFormElement)return t}return null}render(){const e=sg(this),{buttonType:t,type:n,disabled:i,rel:r,target:o,size:s,href:a,color:l,expand:c,hasIconOnly:u,shape:d,strong:h,inheritedAttributes:p}=this,f=void 0===s&&this.inItem?"small":s,m=void 0===a?"button":"a",g="button"===m?{type:n}:{download:this.download,href:a,rel:r,target:o};let y=this.fill;return null==y&&(y=this.inToolbar||this.inListHeader?"clear":"solid"),bp(_p,{onClick:this.handleClick,"aria-disabled":i?"true":null,class:Oy(l,{[e]:!0,[t]:!0,[`${t}-${c}`]:void 0!==c,[`${t}-${f}`]:void 0!==f,[`${t}-${d}`]:void 0!==d,[`${t}-${y}`]:!0,[`${t}-strong`]:h,"in-toolbar":Py("ion-toolbar",this.el),"in-toolbar-color":Py("ion-toolbar[color]",this.el),"in-buttons":Py("ion-buttons",this.el),"button-has-icon-only":u,"button-disabled":i,"ion-activatable":!0,"ion-focusable":!0})},bp(m,Object.assign({},g,{class:"button-native",part:"native",disabled:i,onFocus:this.onFocus,onBlur:this.onBlur},p),bp("span",{class:"button-inner"},bp("slot",{name:"icon-only"}),bp("slot",{name:"start"}),bp("slot",null),bp("slot",{name:"end"})),"md"===e&&bp("ion-ripple-effect",{type:this.rippleType})))}get el(){return this}static get style(){return{ios:':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:14px;--padding-top:0;--padding-bottom:0;--padding-start:1em;--padding-end:1em;--transition:background-color, opacity 100ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:3.1em;font-size:16px;font-weight:500;letter-spacing:0}:host(.in-buttons){font-size:17px;font-weight:400}:host(.button-solid){--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1}:host(.button-outline){--border-radius:14px;--border-width:1px;--border-style:solid;--background-activated:var(--ion-color-primary, #3880ff);--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;--color-activated:var(--ion-color-primary-contrast, #fff)}:host(.button-clear){--background-activated:transparent;--background-activated-opacity:0;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;font-size:17px;font-weight:normal}:host(.button-large){--border-radius:16px;--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:3.1em;font-size:20px}:host(.button-small){--border-radius:6px;--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-strong){font-weight:600}:host(.button-outline.ion-focused.ion-color) .button-native,:host(.button-clear.ion-focused.ion-color) .button-native{color:var(--ion-color-base)}:host(.button-outline.ion-focused.ion-color) .button-native::after,:host(.button-clear.ion-focused.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.button-clear:not(.ion-activated):hover),:host(.button-outline:not(.ion-activated):hover){opacity:0.6}:host(.button-clear.ion-color:hover) .button-native,:host(.button-outline.ion-color:hover) .button-native{color:var(--ion-color-base)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:transparent}:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}:host(:hover.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color):not(.ion-activated)) .button-native::after{background:#fff;opacity:0.1}}:host(.button-clear.ion-activated){opacity:0.4}:host(.button-outline.ion-activated.ion-color) .button-native{color:var(--ion-color-contrast)}:host(.button-outline.ion-activated.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}',md:':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:4px;--padding-top:0;--padding-bottom:0;--padding-start:1.1em;--padding-end:1.1em;--transition:box-shadow 280ms cubic-bezier(.4, 0, .2, 1),\n                background-color 15ms linear,\n                color 15ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:36px;font-size:14px;font-weight:500;letter-spacing:0.06em;text-transform:uppercase}:host(.button-solid){--background-activated:transparent;--background-hover:var(--ion-color-primary-contrast, #fff);--background-focused:var(--ion-color-primary-contrast, #fff);--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}:host(.button-solid.ion-activated){--box-shadow:0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12)}:host(.button-outline){--border-width:2px;--border-style:solid;--box-shadow:none;--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-outline.ion-activated.ion-color) .button-native{background:transparent}:host(.button-clear){--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-large){--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:2.8em;font-size:20px}:host(.button-small){--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-strong){font-weight:bold}::slotted(ion-icon[slot=icon-only]){padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color.ion-focused) .button-native::after,:host(.button-outline.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}'}}},[33,"ion-button",{color:[513],buttonType:[1025,"button-type"],disabled:[516],expand:[513],fill:[1537],routerDirection:[1,"router-direction"],routerAnimation:[16],download:[1],href:[1],rel:[1],shape:[513],size:[513],strong:[4],target:[1],type:[1],form:[1]}]),Qy=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.labelColorStyles={},this.itemStyles=new Map,this.inheritedAriaAttributes={},this.multipleInputs=!1,this.focusable=!0,this.color=void 0,this.button=!1,this.detail=void 0,this.detailIcon=ly,this.disabled=!1,this.download=void 0,this.fill=void 0,this.shape=void 0,this.href=void 0,this.rel=void 0,this.lines=void 0,this.counter=!1,this.routerAnimation=void 0,this.routerDirection="forward",this.target=void 0,this.type="button",this.counterFormatter=void 0,this.counterString=void 0}counterFormatterChanged(){this.updateCounterOutput(this.getFirstInput())}handleIonInput(e){this.counter&&e.target===this.getFirstInput()&&this.updateCounterOutput(e.target)}labelColorChanged(e){const{color:t}=this;void 0===t&&(this.labelColorStyles=e.detail)}itemStyle(e){e.stopPropagation();const t=e.target.tagName,n=e.detail,i={},r=this.itemStyles.get(t)||{};let o=!1;Object.keys(n).forEach((e=>{if(n[e]){const t=`item-${e}`;r[t]||(o=!0),i[t]=!0}})),o||Object.keys(i).length===Object.keys(r).length||(o=!0),o&&(this.itemStyles.set(t,i),tf(this))}connectedCallback(){this.counter&&this.updateCounterOutput(this.getFirstInput()),this.hasStartEl()}componentWillLoad(){this.inheritedAriaAttributes=Nf(this.el,["aria-label"])}componentDidLoad(){const{el:e,counter:t,counterFormatter:n,fill:i,shape:r}=this;null!==e.querySelector('[slot="helper"]')&&Sg('The "helper" slot has been deprecated in favor of using the "helperText" property on ion-input or ion-textarea.',e),null!==e.querySelector('[slot="error"]')&&Sg('The "error" slot has been deprecated in favor of using the "errorText" property on ion-input or ion-textarea.',e),!0===t&&Sg('The "counter" property has been deprecated in favor of using the "counter" property on ion-input or ion-textarea.',e),void 0!==n&&Sg('The "counterFormatter" property has been deprecated in favor of using the "counterFormatter" property on ion-input or ion-textarea.',e),void 0!==i&&Sg('The "fill" property has been deprecated in favor of using the "fill" property on ion-input or ion-textarea.',e),void 0!==r&&Sg('The "shape" property has been deprecated in favor of using the "shape" property on ion-input or ion-textarea.',e),qf((()=>{this.setMultipleInputs(),this.focusable=this.isFocusable()}))}setMultipleInputs(){const e=this.el.querySelectorAll("ion-checkbox, ion-datetime, ion-select, ion-radio"),t=this.el.querySelectorAll("ion-input, ion-range, ion-searchbar, ion-segment, ion-textarea, ion-toggle"),n=this.el.querySelectorAll("ion-anchor, ion-button, a, button");this.multipleInputs=e.length+t.length>1||e.length+n.length>1||e.length>0&&this.isClickable()}hasCover(){return 1===this.el.querySelectorAll("ion-checkbox, ion-datetime, ion-select, ion-radio").length&&!this.multipleInputs}isClickable(){return void 0!==this.href||this.button}canActivate(){return this.isClickable()||this.hasCover()}isFocusable(){const e=this.el.querySelector(".ion-focusable");return this.canActivate()||null!==e}getFirstInput(){return this.el.querySelectorAll("ion-input, ion-textarea")[0]}updateCounterOutput(e){var t,n;const{counter:i,counterFormatter:r,defaultCounterFormatter:o}=this;if(i&&!this.multipleInputs&&void 0!==(null==e?void 0:e.maxlength)){const i=null!==(n=null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.toString().length)&&void 0!==n?n:0;if(void 0===r)this.counterString=o(i,e.maxlength);else try{this.counterString=r(i,e.maxlength)}catch(wT){Tg("Exception in provided `counterFormatter`.",wT),this.counterString=o(i,e.maxlength)}}}defaultCounterFormatter(e,t){return`${e} / ${t}`}hasStartEl(){null!==this.el.querySelector('[slot="start"]')&&this.el.classList.add("item-has-start-slot")}render(){const{counterString:e,detail:t,detailIcon:n,download:i,fill:r,labelColorStyles:o,lines:s,disabled:a,href:l,rel:c,shape:u,target:d,routerAnimation:h,routerDirection:p,inheritedAriaAttributes:f}=this,m={},g=sg(this),y=this.isClickable(),v=this.canActivate(),b=y?void 0===l?"button":"a":"div",x="button"===b?{type:this.type}:{download:i,href:l,rel:c,target:d},_=y?{onClick:e=>{zy(l,e,p,h)}}:{},w=void 0!==t?t:"ios"===g&&y;this.itemStyles.forEach((e=>{Object.assign(m,e)}));const k=a||m["item-interactive-disabled"]?"true":null,E=r||"none",S=Py("ion-list",this.el);return bp(_p,{"aria-disabled":k,class:Object.assign(Object.assign(Object.assign({},m),o),Oy(this.color,{item:!0,[g]:!0,"item-lines-default":void 0===s,[`item-lines-${s}`]:void 0!==s,[`item-fill-${E}`]:!0,[`item-shape-${u}`]:void 0!==u,"item-disabled":a,"in-list":S,"item-multiple-inputs":this.multipleInputs,"ion-activatable":v,"ion-focusable":this.focusable,"item-rtl":"rtl"===document.dir})),role:S?"listitem":null},bp(b,Object.assign({},x,f,{class:"item-native",part:"native",disabled:a},_),bp("slot",{name:"start"}),bp("div",{class:"item-inner"},bp("div",{class:"input-wrapper"},bp("slot",null)),bp("slot",{name:"end"}),w&&bp("ion-icon",{icon:n,lazy:!1,class:"item-detail-icon",part:"detail-icon","aria-hidden":"true","flip-rtl":n===ly}),bp("div",{class:"item-inner-highlight"})),v&&"md"===g&&bp("ion-ripple-effect",null),bp("div",{class:"item-highlight"})),bp("div",{class:"item-bottom"},bp("slot",{name:"error"}),bp("slot",{name:"helper"}),e&&bp("ion-note",{class:"item-counter"},e)))}static get delegatesFocus(){return!0}get el(){return this}static get watchers(){return{counterFormatter:["counterFormatterChanged"]}}static get style(){return{ios:':host{--border-radius:0px;--border-width:0px;--border-style:solid;--padding-top:0px;--padding-bottom:0px;--padding-end:0px;--padding-start:0px;--inner-border-width:0px;--inner-padding-top:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;--inner-padding-end:0px;--inner-box-shadow:none;--show-full-highlight:0;--show-inset-highlight:0;--detail-icon-color:initial;--detail-icon-font-size:20px;--detail-icon-opacity:0.25;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:initial;text-decoration:none;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native,:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-inner{border-color:var(--ion-color-shade)}:host(.ion-activated) .item-native{color:var(--color-activated)}:host(.ion-activated) .item-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-color.ion-activated) .item-native{color:var(--ion-color-contrast)}:host(.ion-focused) .item-native{color:var(--color-focused)}:host(.ion-focused) .item-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-color.ion-focused) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .item-native::after{background:var(--ion-color-contrast)}@media (any-hover: hover){:host(.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--color-hover)}:host(.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--ion-color-contrast)}}:host(.item-interactive-disabled:not(.item-multiple-inputs)){cursor:default;pointer-events:none}:host(.item-disabled){cursor:default;opacity:0.3;pointer-events:none}.item-native{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.item-native::-moz-focus-inner{border:0}.item-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0;-webkit-transition:var(--transition);transition:var(--transition);z-index:-1}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}.item-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);-webkit-box-shadow:var(--inner-box-shadow);box-shadow:var(--inner-box-shadow);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.item-bottom{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--inner-padding-end);padding-inline-end:var(--inner-padding-end);padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.item-detail-icon{-webkit-margin-start:calc(var(--inner-padding-end) / 2);margin-inline-start:calc(var(--inner-padding-end) / 2);-webkit-margin-end:-6px;margin-inline-end:-6px;color:var(--detail-icon-color);font-size:var(--detail-icon-font-size);opacity:var(--detail-icon-opacity)}::slotted(ion-icon){font-size:1.6em}::slotted(ion-button){--margin-top:0;--margin-bottom:0;--margin-start:0;--margin-end:0;z-index:1}::slotted(ion-label:not([slot=end])){-ms-flex:1;flex:1}:host(.item-input){-ms-flex-align:center;align-items:center}.input-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.item-label-stacked),:host(.item-label-floating){-ms-flex-align:start;align-items:start}:host(.item-label-stacked) .input-wrapper,:host(.item-label-floating) .input-wrapper{-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column}.item-highlight,.item-inner-highlight{left:0;right:0;top:0;bottom:0;border-radius:inherit;position:absolute;width:100%;height:100%;-webkit-transform:scaleX(0);transform:scaleX(0);-webkit-transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:transform 200ms, border-bottom-width 200ms;transition:transform 200ms, border-bottom-width 200ms, -webkit-transform 200ms;z-index:2;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus),:host(.item-interactive.ion-touched.ion-invalid){--full-highlight-height:calc(var(--highlight-height) * var(--show-full-highlight));--inset-highlight-height:calc(var(--highlight-height) * var(--show-inset-highlight))}:host(.ion-focused) .item-highlight,:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-highlight,:host(.item-has-focus) .item-inner-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-style:var(--border-style);border-color:var(--highlight-background)}:host(.ion-focused) .item-highlight,:host(.item-has-focus) .item-highlight{border-width:var(--full-highlight-height);opacity:var(--show-full-highlight)}:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-inner-highlight{border-bottom-width:var(--inset-highlight-height);opacity:var(--show-inset-highlight)}:host(.ion-focused.item-fill-solid) .item-highlight,:host(.item-has-focus.item-fill-solid) .item-highlight{border-width:calc(var(--full-highlight-height) - 1px)}:host(.ion-focused) .item-inner-highlight,:host(.ion-focused:not(.item-fill-outline)) .item-highlight,:host(.item-has-focus) .item-inner-highlight,:host(.item-has-focus:not(.item-fill-outline)) .item-highlight{border-top:none;border-right:none;border-left:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus){--highlight-background:var(--highlight-color-focused)}:host(.item-interactive.ion-valid){--highlight-background:var(--highlight-color-valid)}:host(.item-interactive.ion-invalid){--highlight-background:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=helper]){display:none}::slotted([slot=error]){display:none;color:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=error]){display:block}:host(:not(.item-label)) ::slotted(ion-select.legacy-select){--padding-start:0;max-width:none}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0;-ms-flex-item-align:stretch;align-self:stretch;width:100%;max-width:100%}:host(:not(.item-label)) ::slotted(ion-datetime){--padding-start:0}:host(.item-label-stacked) ::slotted(ion-datetime),:host(.item-label-floating) ::slotted(ion-datetime){--padding-start:0;width:100%}:host(.item-multiple-inputs) ::slotted(ion-checkbox),:host(.item-multiple-inputs) ::slotted(ion-datetime),:host(.item-multiple-inputs) ::slotted(ion-radio),:host(.item-multiple-inputs) ::slotted(ion-select.legacy-select){position:relative}:host(.item-textarea){-ms-flex-align:stretch;align-items:stretch}::slotted(ion-reorder[slot]){margin-top:0;margin-bottom:0}ion-ripple-effect{color:var(--ripple-color)}:host(.item-fill-solid) ::slotted([slot=start]),:host(.item-fill-solid) ::slotted([slot=end]),:host(.item-fill-outline) ::slotted([slot=start]),:host(.item-fill-outline) ::slotted([slot=end]){-ms-flex-item-align:center;align-self:center}::slotted([slot=helper]),::slotted([slot=error]),.item-counter{padding-top:5px;font-size:12px;z-index:1}.item-counter{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}@media (prefers-reduced-motion: reduce){.item-highlight,.item-inner-highlight{-webkit-transition:none;transition:none}}:host{--min-height:44px;--transition:background-color 200ms linear, opacity 200ms linear;--padding-start:16px;--inner-padding-end:16px;--inner-border-width:0px 0px 0.55px 0px;--background:var(--ion-item-background, var(--ion-background-color, #fff));--background-activated:var(--ion-text-color, #000);--background-focused:var(--ion-text-color, #000);--background-hover:currentColor;--background-activated-opacity:.12;--background-focused-opacity:.15;--background-hover-opacity:.04;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));--color:var(--ion-item-color, var(--ion-text-color, #000));--highlight-height:0px;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);--bottom-padding-start:0px;font-size:16px}:host(.ion-activated){--transition:none}:host(.ion-color.ion-focused) .item-native::after{background:#000;opacity:0.15}:host(.ion-color.ion-activated) .item-native::after{background:#000;opacity:0.12}:host(.item-interactive){--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-full){--border-width:0px 0px 0.55px 0px;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-inset){--inner-border-width:0px 0px 0.55px 0px;--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-inset),:host(.item-lines-none){--border-width:0px;--show-full-highlight:0}:host(.item-lines-full),:host(.item-lines-none){--inner-border-width:0px;--show-inset-highlight:0}.item-highlight,.item-inner-highlight{-webkit-transition:none;transition:none}:host(.item-has-focus) .item-inner-highlight,:host(.item-has-focus) .item-highlight{border-top:none;border-right:none;border-left:none}::slotted([slot=start]){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:2px;margin-bottom:2px}::slotted(ion-icon[slot=start]),::slotted(ion-icon[slot=end]){margin-top:7px;margin-bottom:7px}::slotted(ion-toggle[slot=start]),::slotted(ion-toggle[slot=end]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}:host(.item-label-stacked) ::slotted([slot=end]),:host(.item-label-floating) ::slotted([slot=end]){margin-top:7px;margin-bottom:7px}::slotted(.button-small){--padding-top:0px;--padding-bottom:0px;--padding-start:.5em;--padding-end:.5em;height:24px;font-size:13px}::slotted(ion-avatar){width:36px;height:36px}::slotted(ion-thumbnail){--size:56px}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px;margin-bottom:8px}:host(.item-radio) ::slotted(ion-label),:host(.item-toggle) ::slotted(ion-label){-webkit-margin-start:0px;margin-inline-start:0px}::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:10px;margin-bottom:10px}:host(.item-label-floating),:host(.item-label-stacked){--min-height:68px}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0px}:host(.item-label-fixed) ::slotted(ion-select.legacy-select),:host(.item-label-fixed) ::slotted(ion-datetime){--padding-start:0}',md:':host{--border-radius:0px;--border-width:0px;--border-style:solid;--padding-top:0px;--padding-bottom:0px;--padding-end:0px;--padding-start:0px;--inner-border-width:0px;--inner-padding-top:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;--inner-padding-end:0px;--inner-box-shadow:none;--show-full-highlight:0;--show-inset-highlight:0;--detail-icon-color:initial;--detail-icon-font-size:20px;--detail-icon-opacity:0.25;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:initial;text-decoration:none;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native,:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-inner{border-color:var(--ion-color-shade)}:host(.ion-activated) .item-native{color:var(--color-activated)}:host(.ion-activated) .item-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-color.ion-activated) .item-native{color:var(--ion-color-contrast)}:host(.ion-focused) .item-native{color:var(--color-focused)}:host(.ion-focused) .item-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-color.ion-focused) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .item-native::after{background:var(--ion-color-contrast)}@media (any-hover: hover){:host(.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--color-hover)}:host(.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--ion-color-contrast)}}:host(.item-interactive-disabled:not(.item-multiple-inputs)){cursor:default;pointer-events:none}:host(.item-disabled){cursor:default;opacity:0.3;pointer-events:none}.item-native{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.item-native::-moz-focus-inner{border:0}.item-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0;-webkit-transition:var(--transition);transition:var(--transition);z-index:-1}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}.item-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);-webkit-box-shadow:var(--inner-box-shadow);box-shadow:var(--inner-box-shadow);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.item-bottom{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--inner-padding-end);padding-inline-end:var(--inner-padding-end);padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.item-detail-icon{-webkit-margin-start:calc(var(--inner-padding-end) / 2);margin-inline-start:calc(var(--inner-padding-end) / 2);-webkit-margin-end:-6px;margin-inline-end:-6px;color:var(--detail-icon-color);font-size:var(--detail-icon-font-size);opacity:var(--detail-icon-opacity)}::slotted(ion-icon){font-size:1.6em}::slotted(ion-button){--margin-top:0;--margin-bottom:0;--margin-start:0;--margin-end:0;z-index:1}::slotted(ion-label:not([slot=end])){-ms-flex:1;flex:1}:host(.item-input){-ms-flex-align:center;align-items:center}.input-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.item-label-stacked),:host(.item-label-floating){-ms-flex-align:start;align-items:start}:host(.item-label-stacked) .input-wrapper,:host(.item-label-floating) .input-wrapper{-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column}.item-highlight,.item-inner-highlight{left:0;right:0;top:0;bottom:0;border-radius:inherit;position:absolute;width:100%;height:100%;-webkit-transform:scaleX(0);transform:scaleX(0);-webkit-transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:transform 200ms, border-bottom-width 200ms;transition:transform 200ms, border-bottom-width 200ms, -webkit-transform 200ms;z-index:2;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus),:host(.item-interactive.ion-touched.ion-invalid){--full-highlight-height:calc(var(--highlight-height) * var(--show-full-highlight));--inset-highlight-height:calc(var(--highlight-height) * var(--show-inset-highlight))}:host(.ion-focused) .item-highlight,:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-highlight,:host(.item-has-focus) .item-inner-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-style:var(--border-style);border-color:var(--highlight-background)}:host(.ion-focused) .item-highlight,:host(.item-has-focus) .item-highlight{border-width:var(--full-highlight-height);opacity:var(--show-full-highlight)}:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-inner-highlight{border-bottom-width:var(--inset-highlight-height);opacity:var(--show-inset-highlight)}:host(.ion-focused.item-fill-solid) .item-highlight,:host(.item-has-focus.item-fill-solid) .item-highlight{border-width:calc(var(--full-highlight-height) - 1px)}:host(.ion-focused) .item-inner-highlight,:host(.ion-focused:not(.item-fill-outline)) .item-highlight,:host(.item-has-focus) .item-inner-highlight,:host(.item-has-focus:not(.item-fill-outline)) .item-highlight{border-top:none;border-right:none;border-left:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus){--highlight-background:var(--highlight-color-focused)}:host(.item-interactive.ion-valid){--highlight-background:var(--highlight-color-valid)}:host(.item-interactive.ion-invalid){--highlight-background:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=helper]){display:none}::slotted([slot=error]){display:none;color:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=error]){display:block}:host(:not(.item-label)) ::slotted(ion-select.legacy-select){--padding-start:0;max-width:none}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0;-ms-flex-item-align:stretch;align-self:stretch;width:100%;max-width:100%}:host(:not(.item-label)) ::slotted(ion-datetime){--padding-start:0}:host(.item-label-stacked) ::slotted(ion-datetime),:host(.item-label-floating) ::slotted(ion-datetime){--padding-start:0;width:100%}:host(.item-multiple-inputs) ::slotted(ion-checkbox),:host(.item-multiple-inputs) ::slotted(ion-datetime),:host(.item-multiple-inputs) ::slotted(ion-radio),:host(.item-multiple-inputs) ::slotted(ion-select.legacy-select){position:relative}:host(.item-textarea){-ms-flex-align:stretch;align-items:stretch}::slotted(ion-reorder[slot]){margin-top:0;margin-bottom:0}ion-ripple-effect{color:var(--ripple-color)}:host(.item-fill-solid) ::slotted([slot=start]),:host(.item-fill-solid) ::slotted([slot=end]),:host(.item-fill-outline) ::slotted([slot=start]),:host(.item-fill-outline) ::slotted([slot=end]){-ms-flex-item-align:center;align-self:center}::slotted([slot=helper]),::slotted([slot=error]),.item-counter{padding-top:5px;font-size:12px;z-index:1}.item-counter{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}@media (prefers-reduced-motion: reduce){.item-highlight,.item-inner-highlight{-webkit-transition:none;transition:none}}:host{--min-height:48px;--background:var(--ion-item-background, var(--ion-background-color, #fff));--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));--color:var(--ion-item-color, var(--ion-text-color, #000));--transition:opacity 15ms linear, background-color 15ms linear;--padding-start:16px;--inner-padding-end:16px;--inner-border-width:0 0 1px 0;--highlight-height:1px;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);font-size:16px;font-weight:normal;text-transform:none}:host(.item-fill-outline){--highlight-height:2px}:host(.item-fill-none.item-interactive.ion-focus) .item-highlight,:host(.item-fill-none.item-interactive.item-has-focus) .item-highlight,:host(.item-fill-none.item-interactive.ion-touched.ion-invalid) .item-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-width:0 0 var(--full-highlight-height) 0;border-style:var(--border-style);border-color:var(--highlight-background)}:host(.item-fill-none.item-interactive.ion-focus) .item-native,:host(.item-fill-none.item-interactive.item-has-focus) .item-native,:host(.item-fill-none.item-interactive.ion-touched.ion-invalid) .item-native{border-bottom-color:var(--highlight-background)}:host(.item-fill-outline.item-interactive.ion-focus) .item-highlight,:host(.item-fill-outline.item-interactive.item-has-focus) .item-highlight{-webkit-transform:scaleX(1);transform:scaleX(1)}:host(.item-fill-outline.item-interactive.ion-focus) .item-highlight,:host(.item-fill-outline.item-interactive.item-has-focus) .item-highlight,:host(.item-fill-outline.item-interactive.ion-touched.ion-invalid) .item-highlight{border-width:var(--full-highlight-height);border-style:var(--border-style);border-color:var(--highlight-background)}:host(.item-fill-outline.item-interactive.ion-touched.ion-invalid) .item-native{border-color:var(--highlight-background)}:host(.item-fill-solid.item-interactive.ion-focus) .item-highlight,:host(.item-fill-solid.item-interactive.item-has-focus) .item-highlight,:host(.item-fill-solid.item-interactive.ion-touched.ion-invalid) .item-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-width:0 0 var(--full-highlight-height) 0;border-style:var(--border-style);border-color:var(--highlight-background)}:host(.item-fill-solid.item-interactive.ion-focus) .item-native,:host(.item-fill-solid.item-interactive.item-has-focus) .item-native,:host(.item-fill-solid.item-interactive.ion-touched.ion-invalid) .item-native{border-bottom-color:var(--highlight-background)}:host(.ion-color.ion-activated) .item-native::after{background:transparent}:host(.item-has-focus) .item-native{caret-color:var(--highlight-background)}:host(.item-interactive){--border-width:0 0 1px 0;--inner-border-width:0;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-full){--border-width:0 0 1px 0;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-inset){--inner-border-width:0 0 1px 0;--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-inset),:host(.item-lines-none){--border-width:0;--show-full-highlight:0}:host(.item-lines-full),:host(.item-lines-none){--inner-border-width:0;--show-inset-highlight:0}:host(.item-fill-outline) .item-highlight{--position-offset:calc(-1 * var(--border-width));top:var(--position-offset);width:calc(100% + 2 * var(--border-width));height:calc(100% + 2 * var(--border-width));-webkit-transition:none;transition:none}@supports (inset-inline-start: 0){:host(.item-fill-outline) .item-highlight{inset-inline-start:var(--position-offset)}}@supports not (inset-inline-start: 0){:host(.item-fill-outline) .item-highlight{left:var(--position-offset)}:host-context([dir=rtl]):host(.item-fill-outline) .item-highlight,:host-context([dir=rtl]).item-fill-outline .item-highlight{left:unset;right:unset;right:var(--position-offset)}@supports selector(:dir(rtl)){:host(.item-fill-outline) .item-highlight:dir(rtl){left:unset;right:unset;right:var(--position-offset)}}}:host(.item-fill-outline.ion-focused) .item-native,:host(.item-fill-outline.item-has-focus) .item-native{border-color:transparent}:host(.item-multi-line) ::slotted([slot=start]),:host(.item-multi-line) ::slotted([slot=end]){margin-top:16px;margin-bottom:16px;-ms-flex-item-align:start;align-self:flex-start}::slotted([slot=start]){-webkit-margin-end:32px;margin-inline-end:32px}::slotted([slot=end]){-webkit-margin-start:32px;margin-inline-start:32px}:host(.item-fill-solid) ::slotted([slot=start]),:host(.item-fill-solid) ::slotted([slot=end]),:host(.item-fill-outline) ::slotted([slot=start]),:host(.item-fill-outline) ::slotted([slot=end]){-ms-flex-item-align:center;align-self:center}::slotted(ion-icon){color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);font-size:24px}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) ::slotted(ion-icon){color:var(--ion-color-contrast)}::slotted(ion-icon[slot]){margin-top:12px;margin-bottom:12px}::slotted(ion-icon[slot=start]){-webkit-margin-end:32px;margin-inline-end:32px}::slotted(ion-icon[slot=end]){-webkit-margin-start:16px;margin-inline-start:16px}:host(.item-fill-solid) ::slotted(ion-icon[slot=start]),:host(.item-fill-outline) ::slotted(ion-icon[slot=start]){-webkit-margin-end:8px;margin-inline-end:8px}::slotted(ion-toggle[slot=start]),::slotted(ion-toggle[slot=end]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}::slotted(ion-note){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-ms-flex-item-align:start;align-self:flex-start;font-size:11px}::slotted(ion-note[slot]:not([slot=helper]):not([slot=error])){padding-left:0;padding-right:0;padding-top:18px;padding-bottom:10px}::slotted(ion-note[slot=start]){-webkit-padding-end:16px;padding-inline-end:16px}::slotted(ion-note[slot=end]){-webkit-padding-start:16px;padding-inline-start:16px}::slotted(ion-avatar){width:40px;height:40px}::slotted(ion-thumbnail){--size:56px}::slotted(ion-avatar),::slotted(ion-thumbnail){margin-top:8px;margin-bottom:8px}::slotted(ion-avatar[slot=start]),::slotted(ion-thumbnail[slot=start]){-webkit-margin-end:16px;margin-inline-end:16px}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){-webkit-margin-start:16px;margin-inline-start:16px}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:10px;margin-bottom:10px}:host(.item-label-stacked) ::slotted([slot=end]),:host(.item-label-floating) ::slotted([slot=end]){margin-top:7px;margin-bottom:7px}:host(.item-label-fixed) ::slotted(ion-select.legacy-select),:host(.item-label-fixed) ::slotted(ion-datetime){--padding-start:8px}:host(.item-toggle) ::slotted(ion-label),:host(.item-radio) ::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0}::slotted(.button-small){--padding-top:0;--padding-bottom:0;--padding-start:.6em;--padding-end:.6em;height:25px;font-size:12px}:host(.item-label-floating),:host(.item-label-stacked){--min-height:55px}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0}:host(.ion-focused:not(.ion-color)) ::slotted(.label-stacked),:host(.ion-focused:not(.ion-color)) ::slotted(.label-floating),:host(.item-has-focus:not(.ion-color)) ::slotted(.label-stacked),:host(.item-has-focus:not(.ion-color)) ::slotted(.label-floating){color:var(--ion-color-primary, #3880ff)}:host(.ion-color){--highlight-color-focused:var(--ion-color-contrast)}:host(.item-label-color){--highlight-color-focused:var(--ion-color-base)}:host(.item-fill-solid.ion-color),:host(.item-fill-outline.ion-color){--highlight-color-focused:var(--ion-color-base)}:host(.item-fill-solid){--background:var(--ion-color-step-50, #f2f2f2);--background-hover:var(--ion-color-step-100, #e6e6e6);--background-focused:var(--ion-color-step-150, #d9d9d9);--border-width:0 0 1px 0;--inner-border-width:0;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.item-fill-solid),:host-context([dir=rtl]).item-fill-solid{border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.item-fill-solid):dir(rtl){border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}}:host(.item-fill-solid) .item-native{--border-color:var(--ion-color-step-500, gray)}:host(.item-fill-solid.ion-focused) .item-native,:host(.item-fill-solid.item-has-focus) .item-native{--background:var(--background-focused)}:host(.item-fill-solid.item-shape-round){border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.item-fill-solid.item-shape-round),:host-context([dir=rtl]).item-fill-solid.item-shape-round{border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.item-fill-solid.item-shape-round):dir(rtl){border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-right-radius:0;border-bottom-left-radius:0}}@media (any-hover: hover){:host(.item-fill-solid:hover) .item-native{--background:var(--background-hover);--border-color:var(--ion-color-step-750, #404040)}}:host(.item-fill-outline){--ripple-color:transparent;--background-focused:transparent;--background-hover:transparent;--border-color:var(--ion-color-step-500, gray);--border-width:1px;border:none;overflow:visible}:host(.item-fill-outline) .item-native{--native-padding-left:16px;border-radius:4px}:host(.item-fill-outline.item-shape-round) .item-native{--inner-padding-start:16px;border-radius:28px}:host(.item-fill-outline.item-shape-round) .item-bottom{-webkit-padding-start:32px;padding-inline-start:32px}:host(.item-fill-outline.item-label-floating.ion-focused) .item-native ::slotted(ion-input:not(:first-child)),:host(.item-fill-outline.item-label-floating.ion-focused) .item-native ::slotted(ion-textarea:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-focus) .item-native ::slotted(ion-input:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-focus) .item-native ::slotted(ion-textarea:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-value) .item-native ::slotted(ion-input:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-value) .item-native ::slotted(ion-textarea:not(:first-child)){-webkit-transform:translateY(-14px);transform:translateY(-14px)}@media (any-hover: hover){:host(.item-fill-outline:hover) .item-native{--border-color:var(--ion-color-step-750, #404040)}}.item-counter{letter-spacing:0.0333333333em}'}}},[49,"ion-item",{color:[513],button:[4],detail:[4],detailIcon:[1,"detail-icon"],disabled:[4],download:[1],fill:[1],shape:[1],href:[1],rel:[1],lines:[1],counter:[4],routerAnimation:[16],routerDirection:[1,"router-direction"],target:[1],type:[1],counterFormatter:[16],multipleInputs:[32],focusable:[32],counterString:[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]]),ev=lf(class extends wf{constructor(){super(),this.__registerHost(),this.ionColor=Sp(this,"ionColor",7),this.ionStyle=Sp(this,"ionStyle",7),this.inRange=!1,this.color=void 0,this.position=void 0,this.noAnimate=!1}componentWillLoad(){this.inRange=!!this.el.closest("ion-range"),this.noAnimate="floating"===this.position,this.emitStyle(),this.emitColor()}componentDidLoad(){this.noAnimate&&setTimeout((()=>{this.noAnimate=!1}),1e3)}colorChanged(){this.emitColor()}positionChanged(){this.emitStyle()}emitColor(){const{color:e}=this;this.ionColor.emit({"item-label-color":void 0!==e,[`ion-color-${e}`]:void 0!==e})}emitStyle(){const{inRange:e,position:t}=this;e||this.ionStyle.emit({label:!0,[`label-${t}`]:void 0!==t})}render(){const e=this.position,t=sg(this);return bp(_p,{class:Oy(this.color,{[t]:!0,"in-item-color":Py("ion-item.ion-color",this.el),[`label-${e}`]:void 0!==e,"label-no-animate":this.noAnimate,"label-rtl":"rtl"===document.dir})})}get el(){return this}static get watchers(){return{color:["colorChanged"],position:["positionChanged"]}}static get style(){return{ios:".item.sc-ion-label-ios-h,.item .sc-ion-label-ios-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-ios-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{white-space:normal}.item-interactive-disabled.sc-ion-label-ios-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-ios-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-ios-h,.item-input .sc-ion-label-ios-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-ios-h,.item-textarea .sc-ion-label-ios-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-ios-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-ios-h,.label-floating.sc-ion-label-ios-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-ios-h{-webkit-transition:none;transition:none}.sc-ion-label-ios-s h1,.sc-ion-label-ios-s h2,.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{font-size:14px;line-height:1.5}.label-stacked.sc-ion-label-ios-h{margin-bottom:4px;font-size:14px}.label-floating.sc-ion-label-ios-h{margin-bottom:0;-webkit-transform:translate(0, 29px);transform:translate(0, 29px);-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform 150ms ease-in-out;transition:-webkit-transform 150ms ease-in-out;transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out, -webkit-transform 150ms ease-in-out}[dir=rtl].sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl] .sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl].label-floating.sc-ion-label-ios-h,[dir=rtl] .label-floating.sc-ion-label-ios-h{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.label-floating.sc-ion-label-ios-h:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.item-textarea.label-floating.sc-ion-label-ios-h,.item-textarea .label-floating.sc-ion-label-ios-h{-webkit-transform:translate(0, 28px);transform:translate(0, 28px)}.item-has-focus.label-floating.sc-ion-label-ios-h,.item-has-focus .label-floating.sc-ion-label-ios-h,.item-has-placeholder.sc-ion-label-ios-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-ios-h,.item-has-value.label-floating.sc-ion-label-ios-h,.item-has-value .label-floating.sc-ion-label-ios-h{-webkit-transform:scale(0.82);transform:scale(0.82)}.sc-ion-label-ios-s h1{margin-left:0;margin-right:0;margin-top:3px;margin-bottom:2px;font-size:22px;font-weight:normal}.sc-ion-label-ios-s h2{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:17px;font-weight:normal}.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{margin-left:0;margin-right:0;margin-top:0;margin-bottom:3px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-ios-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}.sc-ion-label-ios-s>p{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.4)}.sc-ion-label-ios-h.in-item-color.sc-ion-label-ios-s>p{color:inherit}.sc-ion-label-ios-s h2:last-child,.sc-ion-label-ios-s h3:last-child,.sc-ion-label-ios-s h4:last-child,.sc-ion-label-ios-s h5:last-child,.sc-ion-label-ios-s h6:last-child,.sc-ion-label-ios-s p:last-child{margin-bottom:0}",md:'.item.sc-ion-label-md-h,.item .sc-ion-label-md-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-md-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{white-space:normal}.item-interactive-disabled.sc-ion-label-md-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-md-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-md-h,.item-input .sc-ion-label-md-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-md-h,.item-textarea .sc-ion-label-md-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-md-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-md-h{-webkit-transition:none;transition:none}.sc-ion-label-md-s h1,.sc-ion-label-md-s h2,.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{line-height:1.5}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-transform-origin:top left;transform-origin:top left}.label-stacked.label-rtl.sc-ion-label-md-h,.label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform-origin:top right;transform-origin:top right}.label-stacked.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.label-floating.sc-ion-label-md-h{-webkit-transform:translateY(96%);transform:translateY(96%);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1)}.ion-focused.label-floating.sc-ion-label-md-h,.ion-focused .label-floating.sc-ion-label-md-h,.item-has-focus.label-floating.sc-ion-label-md-h,.item-has-focus .label-floating.sc-ion-label-md-h,.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-has-value.label-floating.sc-ion-label-md-h,.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(-6px) scale(0.75);transform:translateY(-6px) scale(0.75);position:relative;max-width:-webkit-min-content;max-width:-moz-min-content;max-width:min-content;background-color:var(--ion-item-background, var(--ion-background-color, #fff));overflow:visible;z-index:3}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{position:absolute;width:4px;height:100%;background-color:var(--ion-item-background, var(--ion-background-color, #fff));content:""}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before{left:calc(-1 * 4px)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{right:calc(-1 * 4px)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.sc-ion-label-md-h{-webkit-transform:translateX(-32px) translateY(-6px) scale(0.75);transform:translateX(-32px) translateY(-6px) scale(0.75)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating.label-rtl,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75);transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75)}.ion-focused.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-primary, #3880ff)}.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-contrast)}.item-fill-solid.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-base)}.ion-invalid.ion-touched.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--highlight-color-invalid)}.sc-ion-label-md-s h1{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}.sc-ion-label-md-s h2{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-md-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:20px;text-overflow:inherit;overflow:inherit}.sc-ion-label-md-s>p{color:var(--ion-color-step-600, #666666)}.sc-ion-label-md-h.in-item-color.sc-ion-label-md-s>p{color:inherit}'}}},[34,"ion-label",{color:[513],position:[1],noAnimate:[32]}]),tv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.horizontal=void 0,this.vertical=void 0,this.edge=!1,this.activated=!1}activatedChanged(){const e=this.activated,t=this.getFab();t&&(t.activated=e),Array.from(this.el.querySelectorAll("ion-fab-list")).forEach((t=>{t.activated=e}))}componentDidLoad(){this.activated&&this.activatedChanged()}async close(){this.activated=!1}getFab(){return this.el.querySelector("ion-fab-button")}async toggle(){this.el.querySelector("ion-fab-list")&&(this.activated=!this.activated)}render(){const{horizontal:e,vertical:t,edge:n}=this,i=sg(this);return bp(_p,{class:{[i]:!0,[`fab-horizontal-${e}`]:void 0!==e,[`fab-vertical-${t}`]:void 0!==t,"fab-edge":n}},bp("slot",null))}get el(){return this}static get watchers(){return{activated:["activatedChanged"]}}static get style(){return":host{position:absolute;z-index:999}:host(.fab-horizontal-center){-webkit-margin-start:-28px;margin-inline-start:-28px}@supports (inset-inline-start: 0){:host(.fab-horizontal-center){inset-inline-start:50%}}@supports not (inset-inline-start: 0){:host(.fab-horizontal-center){left:50%}:host-context([dir=rtl]):host(.fab-horizontal-center),:host-context([dir=rtl]).fab-horizontal-center{left:unset;right:unset;right:50%}@supports selector(:dir(rtl)){:host(.fab-horizontal-center):dir(rtl){left:unset;right:unset;right:50%}}}@supports (inset-inline-start: 0){:host(.fab-horizontal-start){inset-inline-start:calc(10px + var(--ion-safe-area-left, 0px))}}@supports not (inset-inline-start: 0){:host(.fab-horizontal-start){left:calc(10px + var(--ion-safe-area-left, 0px))}:host-context([dir=rtl]):host(.fab-horizontal-start),:host-context([dir=rtl]).fab-horizontal-start{left:unset;right:unset;right:calc(10px + var(--ion-safe-area-left, 0px))}@supports selector(:dir(rtl)){:host(.fab-horizontal-start):dir(rtl){left:unset;right:unset;right:calc(10px + var(--ion-safe-area-left, 0px))}}}@supports (inset-inline-start: 0){:host(.fab-horizontal-end){inset-inline-end:calc(10px + var(--ion-safe-area-right, 0px))}}@supports not (inset-inline-start: 0){:host(.fab-horizontal-end){right:calc(10px + var(--ion-safe-area-right, 0px))}:host-context([dir=rtl]):host(.fab-horizontal-end),:host-context([dir=rtl]).fab-horizontal-end{left:unset;right:unset;left:calc(10px + var(--ion-safe-area-right, 0px))}@supports selector(:dir(rtl)){:host(.fab-horizontal-end):dir(rtl){left:unset;right:unset;left:calc(10px + var(--ion-safe-area-right, 0px))}}}:host(.fab-vertical-top){top:10px}:host(.fab-vertical-top.fab-edge){top:-28px}:host(.fab-vertical-bottom){bottom:10px}:host(.fab-vertical-bottom.fab-edge){bottom:-28px}:host(.fab-vertical-center){margin-top:-28px;top:50%}"}},[1,"ion-fab",{horizontal:[1],vertical:[1],edge:[4],activated:[1028],close:[64],toggle:[64]}]),nv=function(){"undefined"!=typeof customElements&&["ion-fab"].forEach((e=>{"ion-fab"===e&&(customElements.get(e)||customElements.define(e,tv))}))},iv="ion-content",rv=".ion-content-scroll-host",ov=`${iv}, ${rv}`,sv=e=>"ION-CONTENT"===e.tagName,av=e("j",(async e=>sv(e)?(await new Promise((t=>Lf(e,t))),e.getScrollElement()):e)),lv=e=>{const t=e.querySelector(rv);return t||e.querySelector(ov)},cv=e("f",(e=>e.closest(ov))),uv=(e("s",((e,t)=>sv(e)?e.scrollToTop(t):Promise.resolve(e.scrollTo({top:0,left:0,behavior:t>0?"smooth":"auto"})))),e("k",((e,t,n,i)=>sv(e)?e.scrollByPoint(t,n,i):Promise.resolve(e.scrollBy({top:n,left:t,behavior:i>0?"smooth":"auto"})))),e=>((e,...t)=>console.error(`<${e.tagName.toLowerCase()}> must be used inside ${t.join(" or ")}.`))(e,iv)),dv=e=>{if(sv(e)){const t=e,n=t.scrollY;return t.scrollY=!1,n}return e.style.setProperty("overflow","hidden"),!0};
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
var hv;e("g",hv),function(e){e.Body="body",e.Ionic="ionic",e.Native="native",e.None="none"}(hv||e("g",hv={}));const pv=e("K",{getEngine(){var e;return(null===(e=null==Rf?void 0:Rf.Capacitor)||void 0===e?void 0:e.isPluginAvailable("Keyboard"))&&(null==Rf?void 0:Rf.Capacitor.Plugins.Keyboard)},getResizeMode(){const e=this.getEngine();return(null==e?void 0:e.getResizeMode)?e.getResizeMode().catch((e=>{if("UNIMPLEMENTED"!==e.code)throw e})):Promise.resolve(void 0)}}),fv=e=>{if(void 0===zf||e===hv.None||void 0===e)return null;const t=zf.querySelector("ion-app");return null!=t?t:zf.body},mv=e=>{const t=fv(e);return null===t?0:t.clientHeight},gv=e=>{const t=document.querySelector(`${e}.ion-cloned-element`);if(null!==t)return t;const n=document.createElement(e);return n.classList.add("ion-cloned-element"),n.style.setProperty("display","none"),document.body.appendChild(n),n},yv=e=>{if(!e)return;const t=e.querySelectorAll("ion-toolbar");return{el:e,toolbars:Array.from(t).map((e=>{const t=e.querySelector("ion-title");return{el:e,background:e.shadowRoot.querySelector(".toolbar-background"),ionTitleEl:t,innerTitleEl:t?t.shadowRoot.querySelector(".toolbar-title"):null,ionButtonsEl:Array.from(e.querySelectorAll("ion-buttons"))}}))}},vv=(e,t)=>{"fade"!==e.collapse&&(void 0===t?e.style.removeProperty("--opacity-scale"):e.style.setProperty("--opacity-scale",t.toString()))},bv=(e,t,n,i)=>{Df((()=>{const r=i.scrollTop;((e,t,n)=>{if(!e[0].isIntersecting)return;const i=e[0].intersectionRatio>.9||n<=0?0:100*(1-e[0].intersectionRatio)/75;vv(t.el,1===i?void 0:i)})(e,t,r);const o=e[0],s=o.intersectionRect,a=s.width*s.height,l=o.rootBounds.width*o.rootBounds.height,c=0===a&&0===l,u=Math.abs(s.left-o.boundingClientRect.left),d=Math.abs(s.right-o.boundingClientRect.right);c||a>0&&(u>=5||d>=5)||(o.isIntersecting?(xv(t,!1),xv(n)):(0===s.x&&0===s.y||0!==s.width&&0!==s.height)&&r>0&&(xv(t),xv(n,!1),vv(t.el)))}))},xv=(e,t=!0)=>{const n=e.el;t?(n.classList.remove("header-collapse-condense-inactive"),n.removeAttribute("aria-hidden")):(n.classList.add("header-collapse-condense-inactive"),n.setAttribute("aria-hidden","true"))},_v=(e=[],t=1,n=!1)=>{e.forEach((e=>{const i=e.ionTitleEl,r=e.innerTitleEl;i&&"large"===i.size&&(r.style.transition=n?"all 0.2s ease-in-out":"",r.style.transform=`scale3d(${t}, ${t}, 1)`)}))},wv=(e,t,n)=>{Of((()=>{const i=e.scrollTop,r=t.clientHeight,o=n?n.clientHeight:0;if(null!==n&&i<o)return t.style.setProperty("--opacity-scale","0"),void e.style.setProperty("clip-path",`inset(${r}px 0px 0px 0px)`);const s=Wf(0,(i-o)/10,1);Df((()=>{e.style.removeProperty("clip-path"),t.style.setProperty("--opacity-scale",s.toString())}))}))},kv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.inheritedAttributes={},this.setupFadeHeader=async(e,t)=>{const n=this.scrollEl=await av(e);this.contentScrollCallback=()=>{wv(this.scrollEl,this.el,t)},n.addEventListener("scroll",this.contentScrollCallback),wv(this.scrollEl,this.el,t)},this.collapse=void 0,this.translucent=!1}componentWillLoad(){this.inheritedAttributes=$f(this.el)}componentDidLoad(){this.checkCollapsibleHeader()}componentDidUpdate(){this.checkCollapsibleHeader()}disconnectedCallback(){this.destroyCollapsibleHeader()}async checkCollapsibleHeader(){if("ios"!==sg(this))return;const{collapse:e}=this,t="condense"===e,n="fade"===e;if(this.destroyCollapsibleHeader(),t){const e=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),t=e?lv(e):null;Df((()=>{gv("ion-title").size="large",gv("ion-back-button")})),await this.setupCondenseHeader(t,e)}else if(n){const e=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),t=e?lv(e):null;if(!t)return void uv(this.el);const n=t.querySelector('ion-header[collapse="condense"]');await this.setupFadeHeader(t,n)}}destroyCollapsibleHeader(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0),this.scrollEl&&this.contentScrollCallback&&(this.scrollEl.removeEventListener("scroll",this.contentScrollCallback),this.contentScrollCallback=void 0),this.collapsibleMainHeader&&(this.collapsibleMainHeader.classList.remove("header-collapse-main"),this.collapsibleMainHeader=void 0)}async setupCondenseHeader(e,t){if(!e||!t)return void uv(this.el);if("undefined"==typeof IntersectionObserver)return;this.scrollEl=await av(e);const n=t.querySelectorAll("ion-header");if(this.collapsibleMainHeader=Array.from(n).find((e=>"condense"!==e.collapse)),!this.collapsibleMainHeader)return;const i=yv(this.collapsibleMainHeader),r=yv(this.el);i&&r&&(xv(i,!1),vv(i.el,0),this.intersectionObserver=new IntersectionObserver((e=>{bv(e,i,r,this.scrollEl)}),{root:e,threshold:[.25,.3,.4,.5,.6,.7,.8,.9,1]}),this.intersectionObserver.observe(r.toolbars[r.toolbars.length-1].el),this.contentScrollCallback=()=>{((e,t,n)=>{Of((()=>{const i=e.scrollTop,r=Wf(1,1+-i/500,1.1);null===n.querySelector("ion-refresher.refresher-native")&&Df((()=>{_v(t.toolbars,r)}))}))})(this.scrollEl,r,e)},this.scrollEl.addEventListener("scroll",this.contentScrollCallback),Df((()=>{void 0!==this.collapsibleMainHeader&&this.collapsibleMainHeader.classList.add("header-collapse-main")})))}render(){const{translucent:e,inheritedAttributes:t}=this,n=sg(this),i=this.collapse||"none",r=Py("ion-menu",this.el)?"none":"banner";return bp(_p,Object.assign({role:r,class:{[n]:!0,[`header-${n}`]:!0,"header-translucent":this.translucent,[`header-collapse-${i}`]:!0,[`header-translucent-${n}`]:this.translucent}},t),"ios"===n&&e&&bp("div",{class:"header-background"}),bp("slot",null))}get el(){return this}static get style(){return{ios:"ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-ios ion-toolbar:last-of-type{--border-width:0 0 0.55px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.header-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.header-translucent-ios ion-toolbar{--opacity:.8}.header-collapse-condense-inactive .header-background{-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}}.header-ios.ion-no-border ion-toolbar:last-of-type{--border-width:0}.header-collapse-fade ion-toolbar{--opacity-scale:inherit}.header-collapse-condense{z-index:9}.header-collapse-condense ion-toolbar{position:-webkit-sticky;position:sticky;top:0}.header-collapse-condense ion-toolbar:first-of-type{padding-top:7px;z-index:1}.header-collapse-condense ion-toolbar{--background:var(--ion-background-color, #fff);z-index:0}.header-collapse-condense ion-toolbar:last-of-type{--border-width:0px}.header-collapse-condense ion-toolbar ion-searchbar{height:48px;padding-top:0px;padding-bottom:13px}.header-collapse-main{--opacity-scale:1}.header-collapse-main ion-toolbar{--opacity-scale:inherit}.header-collapse-main ion-toolbar.in-toolbar ion-title,.header-collapse-main ion-toolbar.in-toolbar ion-buttons{-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-buttons.buttons-collapse{opacity:0;pointer-events:none}.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-buttons.buttons-collapse{visibility:hidden}",md:"ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-md{-webkit-box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12);box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12)}.header-collapse-condense{display:none}.header-md.ion-no-border{-webkit-box-shadow:none;box-shadow:none}"}}},[36,"ion-header",{collapse:[1],translucent:[4]}]),Ev=function(){"undefined"!=typeof customElements&&["ion-header"].forEach((e=>{"ion-header"===e&&(customElements.get(e)||customElements.define(e,kv))}))},Sv={bubbles:{dur:1e3,circles:9,fn:(e,t,n)=>{const i=e*t/n-e+"ms",r=2*Math.PI*t/n;return{r:5,style:{top:32*Math.sin(r)+"%",left:32*Math.cos(r)+"%","animation-delay":i}}}},circles:{dur:1e3,circles:8,fn:(e,t,n)=>{const i=t/n,r=e*i-e+"ms",o=2*Math.PI*i;return{r:5,style:{top:32*Math.sin(o)+"%",left:32*Math.cos(o)+"%","animation-delay":r}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(e,t)=>({r:6,style:{left:32-32*t+"%","animation-delay":-110*t+"ms"}})},lines:{dur:1e3,lines:8,fn:(e,t,n)=>({y1:14,y2:26,style:{transform:`rotate(${360/n*t+(t<n/2?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})},"lines-small":{dur:1e3,lines:8,fn:(e,t,n)=>({y1:12,y2:20,style:{transform:`rotate(${360/n*t+(t<n/2?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})},"lines-sharp":{dur:1e3,lines:12,fn:(e,t,n)=>({y1:17,y2:29,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})},"lines-sharp-small":{dur:1e3,lines:12,fn:(e,t,n)=>({y1:12,y2:20,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})}},Tv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.color=void 0,this.duration=void 0,this.name=void 0,this.paused=!1}getName(){const e=this.name||Um.get("spinner"),t=sg(this);return e||("ios"===t?"lines":"circular")}render(){var e;const t=this,n=sg(t),i=t.getName(),r=null!==(e=Sv[i])&&void 0!==e?e:Sv.lines,o="number"==typeof t.duration&&t.duration>10?t.duration:r.dur,s=[];if(void 0!==r.circles)for(let a=0;a<r.circles;a++)s.push(Cv(r,o,a,r.circles));else if(void 0!==r.lines)for(let a=0;a<r.lines;a++)s.push(Mv(r,o,a,r.lines));return bp(_p,{class:Oy(t.color,{[n]:!0,[`spinner-${i}`]:!0,"spinner-paused":t.paused||Um.getBoolean("_testing")}),role:"progressbar",style:r.elmDuration?{animationDuration:o+"ms"}:{}},s)}static get style(){return":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{-webkit-transform-origin:center;transform-origin:center;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}[dir=rtl] svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}@supports selector(:dir(rtl)){svg:dir(rtl){-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:7px}:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-width:4px}:host(.spinner-lines) line,:host(.spinner-lines-small) line,:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg,:host(.spinner-lines-sharp) svg,:host(.spinner-lines-sharp-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular) svg{-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}"}},[1,"ion-spinner",{color:[513],duration:[2],name:[1],paused:[4]}]),Cv=(e,t,n,i)=>{const r=e.fn(t,n,i);return r.style["animation-duration"]=t+"ms",bp("svg",{viewBox:r.viewBox||"0 0 64 64",style:r.style},bp("circle",{transform:r.transform||"translate(32,32)",cx:r.cx,cy:r.cy,r:r.r,style:e.elmDuration?{animationDuration:t+"ms"}:{}}))},Mv=(e,t,n,i)=>{const r=e.fn(t,n,i);return r.style["animation-duration"]=t+"ms",bp("svg",{viewBox:r.viewBox||"0 0 64 64",style:r.style},bp("line",{transform:"translate(32,32)",y1:r.y1,y2:r.y2}))},Iv=(e,t)=>`${e} / ${t}`,Av=lf(class extends wf{constructor(){super(),this.__registerHost(),this.ionInput=Sp(this,"ionInput",7),this.ionChange=Sp(this,"ionChange",7),this.ionBlur=Sp(this,"ionBlur",7),this.ionFocus=Sp(this,"ionFocus",7),this.ionStyle=Sp(this,"ionStyle",7),this.inputId="ion-input-"+Pv++,this.inheritedAttributes={},this.isComposing=!1,this.hasLoggedDeprecationWarning=!1,this.didInputClearOnEdit=!1,this.onInput=e=>{const t=e.target;t&&(this.value=t.value||""),this.emitInputChange(e)},this.onChange=e=>{this.emitValueChange(e)},this.onBlur=e=>{this.hasFocus=!1,this.emitStyle(),this.focusedValue!==this.value&&this.emitValueChange(e),this.didInputClearOnEdit=!1,this.ionBlur.emit(e)},this.onFocus=e=>{this.hasFocus=!0,this.focusedValue=this.value,this.emitStyle(),this.ionFocus.emit(e)},this.onKeydown=e=>{this.checkClearOnEdit(e)},this.onCompositionStart=()=>{this.isComposing=!0},this.onCompositionEnd=()=>{this.isComposing=!1},this.clearTextInput=e=>{this.clearInput&&!this.readonly&&!this.disabled&&e&&(e.preventDefault(),e.stopPropagation(),this.setFocus()),this.value="",this.emitInputChange(e)},this.hasFocus=!1,this.color=void 0,this.accept=void 0,this.autocapitalize="off",this.autocomplete="off",this.autocorrect="off",this.autofocus=!1,this.clearInput=!1,this.clearOnEdit=void 0,this.counter=!1,this.counterFormatter=void 0,this.debounce=void 0,this.disabled=!1,this.enterkeyhint=void 0,this.errorText=void 0,this.fill=void 0,this.inputmode=void 0,this.helperText=void 0,this.label=void 0,this.labelPlacement="start",this.legacy=void 0,this.max=void 0,this.maxlength=void 0,this.min=void 0,this.minlength=void 0,this.multiple=void 0,this.name=this.inputId,this.pattern=void 0,this.placeholder=void 0,this.readonly=!1,this.required=!1,this.shape=void 0,this.spellcheck=!1,this.step=void 0,this.size=void 0,this.type="text",this.value=""}debounceChanged(){const{ionInput:e,debounce:t,originalIonInput:n}=this;this.ionInput=void 0===t?null!=n?n:e:Xf(e,t)}disabledChanged(){this.emitStyle()}placeholderChanged(){this.emitStyle()}valueChanged(){const e=this.nativeInput,t=this.getValue();e&&e.value!==t&&!this.isComposing&&(e.value=t),this.emitStyle()}componentWillLoad(){this.inheritedAttributes=Object.assign(Object.assign({},$f(this.el)),Nf(this.el,["tabindex","title","data-form-type"]))}connectedCallback(){const{el:e}=this;this.legacyFormController=(e=>{const t=e;let n;return{hasLegacyControl:()=>{if(void 0===n){const e=void 0!==t.label||Ny(t),i=t.hasAttribute("aria-label")||t.hasAttribute("aria-labelledby")&&null===t.shadowRoot,r=Gf(t);n=!0===t.legacy||!e&&!i&&null!==r}return n}}})(e),this.slotMutationController=((e,t,n)=>{let i,r;void 0!==Rf&&"MutationObserver"in Rf&&(i=new MutationObserver((e=>{for(const i of e)for(const e of i.addedNodes)if(e.nodeType===Node.ELEMENT_NODE&&e.slot===t)return n(),void qf((()=>o(e)))})),i.observe(e,{childList:!0}));const o=e=>{var i;r&&(r.disconnect(),r=void 0),r=new MutationObserver((e=>{n();for(const n of e)for(const e of n.removedNodes)e.nodeType===Node.ELEMENT_NODE&&e.slot===t&&s()})),r.observe(null!==(i=e.parentElement)&&void 0!==i?i:e,{subtree:!0,childList:!0})},s=()=>{r&&(r.disconnect(),r=void 0)};return{destroy:()=>{i&&(i.disconnect(),i=void 0),s()}}})(e,"label",(()=>tf(this))),this.notchController=((e,t,n)=>{let i;const r=()=>void 0!==t()&&void 0===e.label&&null!==n(),o=()=>{const s=t();if(void 0===s)return;if(!r())return void s.style.removeProperty("width");const a=n().scrollWidth;if(0===a&&null===s.offsetParent&&void 0!==Rf&&"IntersectionObserver"in Rf){if(void 0!==i)return;const t=i=new IntersectionObserver((e=>{1===e[0].intersectionRatio&&(o(),t.disconnect(),i=void 0)}),{threshold:.01,root:e});t.observe(s)}else s.style.setProperty("width",.75*a+"px")};return{calculateNotchWidth:()=>{r()&&qf((()=>{o()}))},destroy:()=>{i&&(i.disconnect(),i=void 0)}}})(e,(()=>this.notchSpacerEl),(()=>this.labelSlot)),this.emitStyle(),this.debounceChanged(),document.dispatchEvent(new CustomEvent("ionInputDidLoad",{detail:this.el}))}componentDidLoad(){this.originalIonInput=this.ionInput}componentDidRender(){var e;null===(e=this.notchController)||void 0===e||e.calculateNotchWidth()}disconnectedCallback(){document.dispatchEvent(new CustomEvent("ionInputDidUnload",{detail:this.el})),this.slotMutationController&&(this.slotMutationController.destroy(),this.slotMutationController=void 0),this.notchController&&(this.notchController.destroy(),this.notchController=void 0)}async setFocus(){this.nativeInput&&this.nativeInput.focus()}getInputElement(){return Promise.resolve(this.nativeInput)}emitValueChange(e){const{value:t}=this,n=null==t?t:t.toString();this.focusedValue=n,this.ionChange.emit({value:n,event:e})}emitInputChange(e){const{value:t}=this,n=null==t?t:t.toString();this.ionInput.emit({value:n,event:e})}shouldClearOnEdit(){const{type:e,clearOnEdit:t}=this;return void 0===t?"password"===e:t}getValue(){return"number"==typeof this.value?this.value.toString():(this.value||"").toString()}emitStyle(){this.legacyFormController.hasLegacyControl()&&this.ionStyle.emit({interactive:!0,input:!0,"has-placeholder":void 0!==this.placeholder,"has-value":this.hasValue(),"has-focus":this.hasFocus,"interactive-disabled":this.disabled})}checkClearOnEdit(e){this.shouldClearOnEdit()&&(!this.didInputClearOnEdit&&this.hasValue()&&"Enter"!==e.key&&(this.value="",this.emitInputChange(e)),this.didInputClearOnEdit=!0)}hasValue(){return this.getValue().length>0}renderHintText(){const{helperText:e,errorText:t}=this;return[bp("div",{class:"helper-text"},e),bp("div",{class:"error-text"},t)]}renderCounter(){const{counter:e,maxlength:t,counterFormatter:n,value:i}=this;if(!0===e&&void 0!==t)return bp("div",{class:"counter"},((e,t,n)=>{const i=null==e?0:e.toString().length,r=Iv(i,t);if(void 0===n)return r;try{return n(i,t)}catch(wT){return Tg("Exception in provided `counterFormatter`.",wT),r}})(i,t,n))}renderBottomContent(){const{counter:e,helperText:t,errorText:n,maxlength:i}=this;if(t||n||!0===e&&void 0!==i)return bp("div",{class:"input-bottom"},this.renderHintText(),this.renderCounter())}renderLabel(){const{label:e}=this;return bp("div",{class:{"label-text-wrapper":!0,"label-text-wrapper-hidden":!this.hasLabel}},void 0===e?bp("slot",{name:"label"}):bp("div",{class:"label-text"},e))}get labelSlot(){return this.el.querySelector('[slot="label"]')}get hasLabel(){return void 0!==this.label||null!==this.labelSlot}renderLabelContainer(){return"md"===sg(this)&&"outline"===this.fill?[bp("div",{class:"input-outline-container"},bp("div",{class:"input-outline-start"}),bp("div",{class:{"input-outline-notch":!0,"input-outline-notch-hidden":!this.hasLabel}},bp("div",{class:"notch-spacer","aria-hidden":"true",ref:e=>this.notchSpacerEl=e},this.label)),bp("div",{class:"input-outline-end"})),this.renderLabel()]:this.renderLabel()}renderInput(){const{disabled:e,fill:t,readonly:n,shape:i,inputId:r,labelPlacement:o}=this,s=sg(this),a=this.getValue(),l=Py("ion-item",this.el),c="md"===s&&"outline"!==t&&!l;return bp(_p,{class:Oy(this.color,{[s]:!0,"has-value":this.hasValue(),"has-focus":this.hasFocus,[`input-fill-${t}`]:void 0!==t,[`input-shape-${i}`]:void 0!==i,[`input-label-placement-${o}`]:!0,"in-item":l,"in-item-color":Py("ion-item.ion-color",this.el),"input-disabled":e})},bp("label",{class:"input-wrapper"},this.renderLabelContainer(),bp("div",{class:"native-wrapper"},bp("input",Object.assign({class:"native-input",ref:e=>this.nativeInput=e,id:r,disabled:e,accept:this.accept,autoCapitalize:this.autocapitalize,autoComplete:this.autocomplete,autoCorrect:this.autocorrect,autoFocus:this.autofocus,enterKeyHint:this.enterkeyhint,inputMode:this.inputmode,min:this.min,max:this.max,minLength:this.minlength,maxLength:this.maxlength,multiple:this.multiple,name:this.name,pattern:this.pattern,placeholder:this.placeholder||"",readOnly:n,required:this.required,spellcheck:this.spellcheck,step:this.step,size:this.size,type:this.type,value:a,onInput:this.onInput,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeydown,onCompositionstart:this.onCompositionStart,onCompositionend:this.onCompositionEnd},this.inheritedAttributes)),this.clearInput&&!n&&!e&&bp("button",{"aria-label":"reset",type:"button",class:"input-clear-icon",onPointerDown:e=>{e.preventDefault()},onClick:this.clearTextInput},bp("ion-icon",{"aria-hidden":"true",icon:"ios"===s?cy:uy}))),c&&bp("div",{class:"input-highlight"})),this.renderBottomContent())}renderLegacyInput(){this.hasLoggedDeprecationWarning||(Sg('ion-input now requires providing a label with either the "label" property or the "aria-label" attribute. To migrate, remove any usage of "ion-label" and pass the label text to either the "label" property or the "aria-label" attribute.\n\nExample: <ion-input label="Email"></ion-input>\nExample with aria-label: <ion-input aria-label="Email"></ion-input>\n\nFor inputs that do not render the label immediately next to the input, developers may continue to use "ion-label" but must manually associate the label with the input by using "aria-labelledby".\n\nDevelopers can use the "legacy" property to continue using the legacy form markup. This property will be removed in an upcoming major release of Ionic where this form control will use the modern form markup.',this.el),this.legacy&&Sg('ion-input is being used with the "legacy" property enabled which will forcibly enable the legacy form markup. This property will be removed in an upcoming major release of Ionic where this form control will use the modern form markup.\n\nDevelopers can dismiss this warning by removing their usage of the "legacy" property and using the new input syntax.',this.el),this.hasLoggedDeprecationWarning=!0);const e=sg(this),t=this.getValue(),n=this.inputId+"-lbl",i=Gf(this.el);return i&&(i.id=n),bp(_p,{"aria-disabled":this.disabled?"true":null,class:Oy(this.color,{[e]:!0,"has-value":this.hasValue(),"has-focus":this.hasFocus,"legacy-input":!0,"in-item-color":Py("ion-item.ion-color",this.el)})},bp("input",Object.assign({class:"native-input",ref:e=>this.nativeInput=e,"aria-labelledby":i?i.id:null,disabled:this.disabled,accept:this.accept,autoCapitalize:this.autocapitalize,autoComplete:this.autocomplete,autoCorrect:this.autocorrect,autoFocus:this.autofocus,enterKeyHint:this.enterkeyhint,inputMode:this.inputmode,min:this.min,max:this.max,minLength:this.minlength,maxLength:this.maxlength,multiple:this.multiple,name:this.name,pattern:this.pattern,placeholder:this.placeholder||"",readOnly:this.readonly,required:this.required,spellcheck:this.spellcheck,step:this.step,size:this.size,type:this.type,value:t,onInput:this.onInput,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeydown},this.inheritedAttributes)),this.clearInput&&!this.readonly&&!this.disabled&&bp("button",{"aria-label":"reset",type:"button",class:"input-clear-icon",onPointerDown:e=>{e.preventDefault()},onClick:this.clearTextInput},bp("ion-icon",{"aria-hidden":"true",icon:"ios"===e?cy:uy})))}render(){const{legacyFormController:e}=this;return e.hasLegacyControl()?this.renderLegacyInput():this.renderInput()}get el(){return this}static get watchers(){return{debounce:["debounceChanged"],disabled:["disabledChanged"],placeholder:["placeholderChanged"],value:["valueChanged"]}}static get style(){return{ios:".sc-ion-input-ios-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:0.6;--padding-top:0px;--padding-end:0px;--padding-bottom:0px;--padding-start:0px;--background:transparent;--color:initial;--border-style:solid;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);--highlight-color:var(--highlight-color-focused);display:block;position:relative;width:100%;padding:0 !important;color:var(--color);font-family:var(--ion-font-family, inherit);z-index:2}.legacy-input.sc-ion-input-ios-h{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;background:var(--background)}.legacy-input.sc-ion-input-ios-h .native-input.sc-ion-input-ios{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius)}ion-item.sc-ion-input-ios-h:not(.item-label):not(.item-has-modern-input),ion-item:not(.item-label):not(.item-has-modern-input) .sc-ion-input-ios-h{--padding-start:0}ion-item[slot=start].sc-ion-input-ios-h,ion-item [slot=start].sc-ion-input-ios-h,ion-item[slot=end].sc-ion-input-ios-h,ion-item [slot=end].sc-ion-input-ios-h{width:auto}.legacy-input.ion-color.sc-ion-input-ios-h{color:var(--ion-color-base)}.ion-color.sc-ion-input-ios-h{--highlight-color-focused:var(--ion-color-base)}.native-input.sc-ion-input-ios{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:inline-block;position:relative;-ms-flex:1;flex:1;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none;z-index:1}.native-input.sc-ion-input-ios::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios:-webkit-autofill{background-color:transparent}.native-input.sc-ion-input-ios:invalid{-webkit-box-shadow:none;box-shadow:none}.native-input.sc-ion-input-ios::-ms-clear{display:none}.cloned-input.sc-ion-input-ios{top:0;bottom:0;position:absolute;pointer-events:none}@supports (inset-inline-start: 0){.cloned-input.sc-ion-input-ios{inset-inline-start:0}}@supports not (inset-inline-start: 0){.cloned-input.sc-ion-input-ios{left:0}[dir=rtl].sc-ion-input-ios-h .cloned-input.sc-ion-input-ios,[dir=rtl] .sc-ion-input-ios-h .cloned-input.sc-ion-input-ios{left:unset;right:unset;right:0}[dir=rtl].sc-ion-input-ios .cloned-input.sc-ion-input-ios{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.cloned-input.sc-ion-input-ios:dir(rtl){left:unset;right:unset;right:0}}}.cloned-input.sc-ion-input-ios:disabled{opacity:1}.legacy-input.sc-ion-input-ios-h .input-clear-icon.sc-ion-input-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.input-clear-icon.sc-ion-input-ios{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;background-position:center;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:30px;height:30px;border:0;outline:none;background-color:transparent;background-repeat:no-repeat;color:var(--ion-color-step-600, #666666);visibility:hidden;-webkit-appearance:none;-moz-appearance:none;appearance:none}.in-item-color.sc-ion-input-ios-h .input-clear-icon.sc-ion-input-ios{color:inherit}.input-clear-icon.sc-ion-input-ios:focus{opacity:0.5}.has-value.sc-ion-input-ios-h .input-clear-icon.sc-ion-input-ios{visibility:visible}.has-focus.sc-ion-input-ios-h{pointer-events:none}.has-focus.sc-ion-input-ios-h input.sc-ion-input-ios,.has-focus.sc-ion-input-ios-h a.sc-ion-input-ios,.has-focus.sc-ion-input-ios-h button.sc-ion-input-ios{pointer-events:auto}.item-label-floating.item-has-placeholder.sc-ion-input-ios-h:not(.item-has-value),.item-label-floating.item-has-placeholder:not(.item-has-value) .sc-ion-input-ios-h{opacity:0}.item-label-floating.item-has-placeholder.sc-ion-input-ios-h:not(.item-has-value).item-has-focus,.item-label-floating.item-has-placeholder:not(.item-has-value).item-has-focus .sc-ion-input-ios-h{-webkit-transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.input-wrapper.sc-ion-input-ios{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:stretch;align-items:stretch;height:inherit;min-height:inherit;-webkit-transition:background-color 15ms linear;transition:background-color 15ms linear;background:var(--background);line-height:normal}.native-wrapper.sc-ion-input-ios{display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;width:100%}.ion-touched.ion-invalid.sc-ion-input-ios-h{--highlight-color:var(--highlight-color-invalid)}.ion-valid.sc-ion-input-ios-h{--highlight-color:var(--highlight-color-valid)}.input-bottom.sc-ion-input-ios{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:5px;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;border-top:var(--border-width) var(--border-style) var(--border-color);font-size:12px}.has-focus.ion-valid.sc-ion-input-ios-h,.ion-touched.ion-invalid.sc-ion-input-ios-h{--border-color:var(--highlight-color)}.input-bottom.sc-ion-input-ios .error-text.sc-ion-input-ios{display:none;color:var(--highlight-color-invalid)}.input-bottom.sc-ion-input-ios .helper-text.sc-ion-input-ios{display:block;color:var(--ion-color-step-550, #737373)}.ion-touched.ion-invalid.sc-ion-input-ios-h .input-bottom.sc-ion-input-ios .error-text.sc-ion-input-ios{display:block}.ion-touched.ion-invalid.sc-ion-input-ios-h .input-bottom.sc-ion-input-ios .helper-text.sc-ion-input-ios{display:none}.input-bottom.sc-ion-input-ios .counter.sc-ion-input-ios{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}.has-focus.sc-ion-input-ios-h input.sc-ion-input-ios{caret-color:var(--highlight-color)}.label-text-wrapper.sc-ion-input-ios{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;max-width:200px;-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);pointer-events:none}.label-text.sc-ion-input-ios,.sc-ion-input-ios-s>[slot=label]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.label-text-wrapper-hidden.sc-ion-input-ios,.input-outline-notch-hidden.sc-ion-input-ios{display:none}.input-wrapper.sc-ion-input-ios input.sc-ion-input-ios{-webkit-transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.input-label-placement-start.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios{-ms-flex-direction:row;flex-direction:row}.input-label-placement-start.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-end.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.input-label-placement-end.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:0;margin-inline-end:0;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-ios-h .label-text.sc-ion-input-ios{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.input-label-placement-stacked.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios,.input-label-placement-floating.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:start}.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform-origin:left top;transform-origin:left top;max-width:100%}[dir=rtl].sc-ion-input-ios-h -no-combinator.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .sc-ion-input-ios-h -no-combinator.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl].input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl].sc-ion-input-ios-h -no-combinator.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .sc-ion-input-ios-h -no-combinator.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl].input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios:dir(rtl),.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.input-label-placement-stacked.sc-ion-input-ios-h input.sc-ion-input-ios,.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios{margin-left:0;margin-right:0;margin-top:1px;margin-bottom:0}.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform:translateY(100%) scale(1);transform:translateY(100%) scale(1)}.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios{opacity:0}.has-focus.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios,.has-value.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios{opacity:1}.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,.has-focus.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,.has-value.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);max-width:calc(100% / 0.75)}.sc-ion-input-ios-h{--border-width:0.55px;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));font-size:inherit}.legacy-input.sc-ion-input-ios-h{--padding-top:10px;--padding-end:8px;--padding-bottom:10px;--padding-start:0}.item-label-stacked.sc-ion-input-ios-h,.item-label-stacked .sc-ion-input-ios-h,.item-label-floating.sc-ion-input-ios-h,.item-label-floating .sc-ion-input-ios-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0px}.input-clear-icon.sc-ion-input-ios ion-icon.sc-ion-input-ios{width:18px;height:18px}.sc-ion-input-ios-h:not(.legacy-input){min-height:44px}.input-label-placement-floating.sc-ion-input-ios-h,.input-label-placement-stacked.sc-ion-input-ios-h{min-height:56px}.legacy-input.sc-ion-input-ios-h .native-input[disabled].sc-ion-input-ios,.input-disabled.sc-ion-input-ios-h{opacity:0.3}",md:".sc-ion-input-md-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:0.6;--padding-top:0px;--padding-end:0px;--padding-bottom:0px;--padding-start:0px;--background:transparent;--color:initial;--border-style:solid;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);--highlight-color:var(--highlight-color-focused);display:block;position:relative;width:100%;padding:0 !important;color:var(--color);font-family:var(--ion-font-family, inherit);z-index:2}.legacy-input.sc-ion-input-md-h{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;background:var(--background)}.legacy-input.sc-ion-input-md-h .native-input.sc-ion-input-md{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius)}ion-item.sc-ion-input-md-h:not(.item-label):not(.item-has-modern-input),ion-item:not(.item-label):not(.item-has-modern-input) .sc-ion-input-md-h{--padding-start:0}ion-item[slot=start].sc-ion-input-md-h,ion-item [slot=start].sc-ion-input-md-h,ion-item[slot=end].sc-ion-input-md-h,ion-item [slot=end].sc-ion-input-md-h{width:auto}.legacy-input.ion-color.sc-ion-input-md-h{color:var(--ion-color-base)}.ion-color.sc-ion-input-md-h{--highlight-color-focused:var(--ion-color-base)}.native-input.sc-ion-input-md{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:inline-block;position:relative;-ms-flex:1;flex:1;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none;z-index:1}.native-input.sc-ion-input-md::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md:-webkit-autofill{background-color:transparent}.native-input.sc-ion-input-md:invalid{-webkit-box-shadow:none;box-shadow:none}.native-input.sc-ion-input-md::-ms-clear{display:none}.cloned-input.sc-ion-input-md{top:0;bottom:0;position:absolute;pointer-events:none}@supports (inset-inline-start: 0){.cloned-input.sc-ion-input-md{inset-inline-start:0}}@supports not (inset-inline-start: 0){.cloned-input.sc-ion-input-md{left:0}[dir=rtl].sc-ion-input-md-h .cloned-input.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h .cloned-input.sc-ion-input-md{left:unset;right:unset;right:0}[dir=rtl].sc-ion-input-md .cloned-input.sc-ion-input-md{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.cloned-input.sc-ion-input-md:dir(rtl){left:unset;right:unset;right:0}}}.cloned-input.sc-ion-input-md:disabled{opacity:1}.legacy-input.sc-ion-input-md-h .input-clear-icon.sc-ion-input-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.input-clear-icon.sc-ion-input-md{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;background-position:center;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:30px;height:30px;border:0;outline:none;background-color:transparent;background-repeat:no-repeat;color:var(--ion-color-step-600, #666666);visibility:hidden;-webkit-appearance:none;-moz-appearance:none;appearance:none}.in-item-color.sc-ion-input-md-h .input-clear-icon.sc-ion-input-md{color:inherit}.input-clear-icon.sc-ion-input-md:focus{opacity:0.5}.has-value.sc-ion-input-md-h .input-clear-icon.sc-ion-input-md{visibility:visible}.has-focus.sc-ion-input-md-h{pointer-events:none}.has-focus.sc-ion-input-md-h input.sc-ion-input-md,.has-focus.sc-ion-input-md-h a.sc-ion-input-md,.has-focus.sc-ion-input-md-h button.sc-ion-input-md{pointer-events:auto}.item-label-floating.item-has-placeholder.sc-ion-input-md-h:not(.item-has-value),.item-label-floating.item-has-placeholder:not(.item-has-value) .sc-ion-input-md-h{opacity:0}.item-label-floating.item-has-placeholder.sc-ion-input-md-h:not(.item-has-value).item-has-focus,.item-label-floating.item-has-placeholder:not(.item-has-value).item-has-focus .sc-ion-input-md-h{-webkit-transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.input-wrapper.sc-ion-input-md{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:stretch;align-items:stretch;height:inherit;min-height:inherit;-webkit-transition:background-color 15ms linear;transition:background-color 15ms linear;background:var(--background);line-height:normal}.native-wrapper.sc-ion-input-md{display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;width:100%}.ion-touched.ion-invalid.sc-ion-input-md-h{--highlight-color:var(--highlight-color-invalid)}.ion-valid.sc-ion-input-md-h{--highlight-color:var(--highlight-color-valid)}.input-bottom.sc-ion-input-md{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:5px;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;border-top:var(--border-width) var(--border-style) var(--border-color);font-size:12px}.has-focus.ion-valid.sc-ion-input-md-h,.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}.input-bottom.sc-ion-input-md .error-text.sc-ion-input-md{display:none;color:var(--highlight-color-invalid)}.input-bottom.sc-ion-input-md .helper-text.sc-ion-input-md{display:block;color:var(--ion-color-step-550, #737373)}.ion-touched.ion-invalid.sc-ion-input-md-h .input-bottom.sc-ion-input-md .error-text.sc-ion-input-md{display:block}.ion-touched.ion-invalid.sc-ion-input-md-h .input-bottom.sc-ion-input-md .helper-text.sc-ion-input-md{display:none}.input-bottom.sc-ion-input-md .counter.sc-ion-input-md{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}.has-focus.sc-ion-input-md-h input.sc-ion-input-md{caret-color:var(--highlight-color)}.label-text-wrapper.sc-ion-input-md{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;max-width:200px;-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);pointer-events:none}.label-text.sc-ion-input-md,.sc-ion-input-md-s>[slot=label]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.label-text-wrapper-hidden.sc-ion-input-md,.input-outline-notch-hidden.sc-ion-input-md{display:none}.input-wrapper.sc-ion-input-md input.sc-ion-input-md{-webkit-transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.input-label-placement-start.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{-ms-flex-direction:row;flex-direction:row}.input-label-placement-start.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-end.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.input-label-placement-end.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:0;margin-inline-end:0;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-md-h .label-text.sc-ion-input-md{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.input-label-placement-stacked.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,.input-label-placement-floating.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:start}.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:left top;transform-origin:left top;max-width:100%}[dir=rtl].sc-ion-input-md-h -no-combinator.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].sc-ion-input-md-h -no-combinator.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl),.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.input-label-placement-stacked.sc-ion-input-md-h input.sc-ion-input-md,.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{margin-left:0;margin-right:0;margin-top:1px;margin-bottom:0}.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform:translateY(100%) scale(1);transform:translateY(100%) scale(1)}.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{opacity:0}.has-focus.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md,.has-value.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{opacity:1}.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-focus.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-value.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);max-width:calc(100% / 0.75)}.input-fill-solid.sc-ion-input-md-h{--background:var(--ion-color-step-50, #f2f2f2);--border-color:var(--ion-color-step-500, gray);--border-radius:4px;--padding-start:16px;--padding-end:16px}.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-bottom:var(--border-width) var(--border-style) var(--border-color)}.has-focus.input-fill-solid.ion-valid.sc-ion-input-md-h,.input-fill-solid.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}.input-fill-solid.sc-ion-input-md-h .input-bottom.sc-ion-input-md{border-top:none}@media (any-hover: hover){.input-fill-solid.sc-ion-input-md-h:hover{--background:var(--ion-color-step-100, #e6e6e6);--border-color:var(--ion-color-step-750, #404040)}}.input-fill-solid.has-focus.sc-ion-input-md-h{--background:var(--ion-color-step-150, #d9d9d9);--border-color:var(--ion-color-step-750, #404040)}.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0px;border-bottom-left-radius:0px}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,[dir=rtl].input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,[dir=rtl] .input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0px;border-bottom-left-radius:0px}@supports selector(:dir(rtl)){.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0px;border-bottom-left-radius:0px}}.input-fill-solid.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-focus.input-fill-solid.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-value.input-fill-solid.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{max-width:calc(100% / 0.75)}.input-fill-outline.sc-ion-input-md-h{--border-color:var(--ion-color-step-300, #b3b3b3);--border-radius:4px;--padding-start:16px;--padding-end:16px}.input-fill-outline.input-shape-round.sc-ion-input-md-h{--border-radius:28px;--padding-start:32px;--padding-end:32px}.has-focus.input-fill-outline.ion-valid.sc-ion-input-md-h,.input-fill-outline.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}@media (any-hover: hover){.input-fill-outline.sc-ion-input-md-h:hover{--border-color:var(--ion-color-step-750, #404040)}}.input-fill-outline.has-focus.sc-ion-input-md-h{--border-width:2px;--border-color:var(--highlight-color)}.input-fill-outline.sc-ion-input-md-h .input-bottom.sc-ion-input-md{border-top:none}.input-fill-outline.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-bottom:none}.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:left top;transform-origin:left top;position:absolute;max-width:calc(100% - var(--padding-start) - var(--padding-end))}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl),.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.input-fill-outline.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{position:relative;z-index:1}.has-focus.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-value.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform:translateY(-32%) scale(0.75);transform:translateY(-32%) scale(0.75);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;max-width:calc((100% - var(--padding-start) - var(--padding-end) - 8px) / 0.75)}.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h input.sc-ion-input-md,.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{margin-left:0;margin-right:0;margin-top:6px;margin-bottom:6px}.input-fill-outline.sc-ion-input-md-h .input-outline-container.sc-ion-input-md{left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;width:100%;height:100%}.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{pointer-events:none}.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,.input-fill-outline.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md,.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{border-top:var(--border-width) var(--border-style) var(--border-color);border-bottom:var(--border-width) var(--border-style) var(--border-color)}.input-fill-outline.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md{max-width:calc(100% - var(--padding-start) - var(--padding-end))}.input-fill-outline.sc-ion-input-md-h .notch-spacer.sc-ion-input-md{-webkit-padding-end:8px;padding-inline-end:8px;font-size:calc(1em * 0.75);opacity:0;pointer-events:none;-webkit-box-sizing:content-box;box-sizing:content-box}.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:var(--border-radius);-webkit-border-start:var(--border-width) var(--border-style) var(--border-color);border-inline-start:var(--border-width) var(--border-style) var(--border-color);width:calc(var(--padding-start) - 4px)}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,[dir=rtl].input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,[dir=rtl] .input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md{border-top-left-radius:0px;border-top-right-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-bottom-left-radius:0px}@supports selector(:dir(rtl)){.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md:dir(rtl){border-top-left-radius:0px;border-top-right-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-bottom-left-radius:0px}}.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{-webkit-border-end:var(--border-width) var(--border-style) var(--border-color);border-inline-end:var(--border-width) var(--border-style) var(--border-color);border-top-left-radius:0px;border-top-right-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-bottom-left-radius:0px;-ms-flex-positive:1;flex-grow:1}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md,[dir=rtl].input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md,[dir=rtl] .input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:var(--border-radius)}@supports selector(:dir(rtl)){.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:var(--border-radius)}}.has-focus.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md,.has-value.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md,.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md{border-top:none}.sc-ion-input-md-h{--border-width:1px;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));font-size:inherit}.legacy-input.sc-ion-input-md-h{--padding-top:10px;--padding-end:0;--padding-bottom:10px;--padding-start:8px}.item-label-stacked.sc-ion-input-md-h,.item-label-stacked .sc-ion-input-md-h,.item-label-floating.sc-ion-input-md-h,.item-label-floating .sc-ion-input-md-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0}.input-clear-icon.sc-ion-input-md ion-icon.sc-ion-input-md{width:22px;height:22px}.legacy-input.sc-ion-input-md-h .native-input[disabled].sc-ion-input-md,.input-disabled.sc-ion-input-md-h{opacity:0.38}.has-focus.ion-valid.sc-ion-input-md-h,.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}.input-bottom.sc-ion-input-md .counter.sc-ion-input-md{letter-spacing:0.0333333333em}.sc-ion-input-md-h:not(.legacy-input){min-height:56px}.input-label-placement-floating.has-focus.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-stacked.has-focus.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{color:var(--highlight-color)}.has-focus.input-label-placement-floating.ion-valid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-floating.ion-touched.ion-invalid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-focus.input-label-placement-stacked.ion-valid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-stacked.ion-touched.ion-invalid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{color:var(--highlight-color)}.input-highlight.sc-ion-input-md{bottom:-1px;position:absolute;width:100%;height:2px;-webkit-transform:scale(0);transform:scale(0);-webkit-transition:-webkit-transform 200ms;transition:-webkit-transform 200ms;transition:transform 200ms;transition:transform 200ms, -webkit-transform 200ms;background:var(--highlight-color)}@supports (inset-inline-start: 0){.input-highlight.sc-ion-input-md{inset-inline-start:0}}@supports not (inset-inline-start: 0){.input-highlight.sc-ion-input-md{left:0}[dir=rtl].sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h .input-highlight.sc-ion-input-md{left:unset;right:unset;right:0}[dir=rtl].sc-ion-input-md .input-highlight.sc-ion-input-md{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.input-highlight.sc-ion-input-md:dir(rtl){left:unset;right:unset;right:0}}}.has-focus.sc-ion-input-md-h .input-highlight.sc-ion-input-md{-webkit-transform:scale(1);transform:scale(1)}.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{bottom:0}@supports (inset-inline-start: 0){.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{inset-inline-start:0}}@supports not (inset-inline-start: 0){.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{left:0}[dir=rtl].sc-ion-input-md-h -no-combinator.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl].in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl] .in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md:dir(rtl){left:unset;right:unset;right:0}}}.input-shape-round.sc-ion-input-md-h{--border-radius:16px}"}}},[38,"ion-input",{color:[513],accept:[1],autocapitalize:[1],autocomplete:[1],autocorrect:[1],autofocus:[4],clearInput:[4,"clear-input"],clearOnEdit:[4,"clear-on-edit"],counter:[4],counterFormatter:[16],debounce:[2],disabled:[4],enterkeyhint:[1],errorText:[1,"error-text"],fill:[1],inputmode:[1],helperText:[1,"helper-text"],label:[1],labelPlacement:[1,"label-placement"],legacy:[4],max:[8],maxlength:[2],min:[8],minlength:[2],multiple:[4],name:[1],pattern:[1],placeholder:[1],readonly:[4],required:[4],shape:[1],spellcheck:[4],step:[1],size:[2],type:[1],value:[1032],hasFocus:[32],setFocus:[64],getInputElement:[64]}]);
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */let Pv=0;const Ov=function(){"undefined"!=typeof customElements&&["ion-input","ion-icon"].forEach((e=>{switch(e){case"ion-input":customElements.get(e)||customElements.define(e,Av);break;case"ion-icon":customElements.get(e)||Ty()}}))},Dv=function(){"undefined"!=typeof customElements&&["ion-label"].forEach((e=>{"ion-label"===e&&(customElements.get(e)||customElements.define(e,ev))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */,Rv='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .ion-focusable:not([tabindex^="-"])',zv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionWillOpen=Sp(this,"ionWillOpen",7),this.ionWillClose=Sp(this,"ionWillClose",7),this.ionDidOpen=Sp(this,"ionDidOpen",7),this.ionDidClose=Sp(this,"ionDidClose",7),this.ionMenuChange=Sp(this,"ionMenuChange",7),this.lastOnEnd=0,this.blocker=Om.createBlocker({disableScroll:!0}),this.isAnimating=!1,this._isOpen=!1,this.inheritedAttributes={},this.handleFocus=e=>{const t=jg(document);t&&!t.contains(this.el)||this.trapKeyboardFocus(e,document)},this.isPaneVisible=!1,this.isEndSide=!1,this.contentId=void 0,this.menuId=void 0,this.type=void 0,this.disabled=!1,this.side="start",this.swipeGesture=!0,this.maxEdgeStart=50}typeChanged(e,t){const n=this.contentEl;n&&(void 0!==t&&n.classList.remove(`menu-content-${t}`),n.classList.add(`menu-content-${e}`),n.removeAttribute("style")),this.menuInnerEl&&this.menuInnerEl.removeAttribute("style"),this.animation=void 0}disabledChanged(){this.updateState(),this.ionMenuChange.emit({disabled:this.disabled,open:this._isOpen})}sideChanged(){this.isEndSide=Zf(this.side),this.animation=void 0}swipeGestureChanged(){this.updateState()}async connectedCallback(){"undefined"!=typeof customElements&&null!=customElements&&await customElements.whenDefined("ion-menu"),void 0===this.type&&(this.type=Um.get("menuType","overlay"));const e=void 0!==this.contentId?document.getElementById(this.contentId):null;null!==e?(this.el.contains(e)&&console.error('Menu: "contentId" should refer to the main view\'s ion-content, not the ion-content inside of the ion-menu.'),this.contentEl=e,e.classList.add("menu-content"),this.typeChanged(this.type,void 0),this.sideChanged(),_g._register(this),this.gesture=(await ep((()=>Promise.resolve().then((()=>jm))))).createGesture({el:document,gestureName:"menu-swipe",gesturePriority:30,threshold:10,blurOnStart:!0,canStart:e=>this.canStart(e),onWillStart:()=>this.onWillStart(),onStart:()=>this.onStart(),onMove:e=>this.onMove(e),onEnd:e=>this.onEnd(e)}),this.updateState()):console.error('Menu: must have a "content" element to listen for drag events on.')}componentWillLoad(){this.inheritedAttributes=$f(this.el)}async componentDidLoad(){this.ionMenuChange.emit({disabled:this.disabled,open:this._isOpen}),this.updateState()}async disconnectedCallback(){await this.close(!1),this.blocker.destroy(),_g._unregister(this),this.animation&&this.animation.destroy(),this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.animation=void 0,this.contentEl=void 0}onSplitPaneChanged(e){this.isPaneVisible=e.detail.isPane(this.el),this.updateState()}onBackdropClick(e){this._isOpen&&this.lastOnEnd<e.timeStamp-100&&e.composedPath&&!e.composedPath().includes(this.menuInnerEl)&&(e.preventDefault(),e.stopPropagation(),this.close())}onKeydown(e){"Escape"===e.key&&this.close()}isOpen(){return Promise.resolve(this._isOpen)}isActive(){return Promise.resolve(this._isActive())}open(e=!0){return this.setOpen(!0,e)}close(e=!0){return this.setOpen(!1,e)}toggle(e=!0){return this.setOpen(!this._isOpen,e)}setOpen(e,t=!0){return _g._setOpen(this,e,t)}focusFirstDescendant(){const{el:e}=this,t=e.querySelector(Rv);t?t.focus():e.focus()}focusLastDescendant(){const{el:e}=this,t=Array.from(e.querySelectorAll(Rv)),n=t.length>0?t[t.length-1]:null;n?n.focus():e.focus()}trapKeyboardFocus(e,t){const n=e.target;n&&(this.el.contains(n)?this.lastFocus=n:(this.focusFirstDescendant(),this.lastFocus===t.activeElement&&this.focusLastDescendant()))}async _setOpen(e,t=!0){return!(!this._isActive()||this.isAnimating||e===this._isOpen||(this.beforeAnimation(e),await this.loadAnimation(),await this.startAnimation(e,t),this.afterAnimation(e),0))}async loadAnimation(){const e=this.menuInnerEl.offsetWidth,t=Zf(this.side);e===this.width&&void 0!==this.animation&&t===this.isEndSide||(this.width=e,this.isEndSide=t,this.animation&&(this.animation.destroy(),this.animation=void 0),this.animation=await _g._createAnimation(this.type,this),Um.getBoolean("animated",!0)||this.animation.duration(0),this.animation.fill("both"))}async startAnimation(e,t){const n=!e,i=sg(this),r="ios"===i?"cubic-bezier(0.32,0.72,0,1)":"cubic-bezier(0.0,0.0,0.2,1)",o="ios"===i?"cubic-bezier(1, 0, 0.68, 0.28)":"cubic-bezier(0.4, 0, 0.6, 1)",s=this.animation.direction(n?"reverse":"normal").easing(n?o:r).onFinish((()=>{"reverse"===s.getDirection()&&s.direction("normal")}));t?await s.play():s.play({sync:!0})}_isActive(){return!this.disabled&&!this.isPaneVisible}canSwipe(){return this.swipeGesture&&!this.isAnimating&&this._isActive()}canStart(e){return!(document.querySelector("ion-modal.show-modal")||!this.canSwipe())&&(!!this._isOpen||!_g._getOpenSync()&&Bv(window,e.currentX,this.isEndSide,this.maxEdgeStart))}onWillStart(){return this.beforeAnimation(!this._isOpen),this.loadAnimation()}onStart(){this.isAnimating&&this.animation?this.animation.progressStart(!0,this._isOpen?1:0):Hf(!1,"isAnimating has to be true")}onMove(e){if(!this.isAnimating||!this.animation)return void Hf(!1,"isAnimating has to be true");const t=Lv(e.deltaX,this._isOpen,this.isEndSide)/this.width;this.animation.progressStep(this._isOpen?1-t:t)}onEnd(e){if(!this.isAnimating||!this.animation)return void Hf(!1,"isAnimating has to be true");const t=this._isOpen,n=this.isEndSide,i=Lv(e.deltaX,t,n),r=this.width,o=i/r,s=e.velocityX,a=r/2,l=s>=0&&(s>.2||e.deltaX>a),c=s<=0&&(s<-.2||e.deltaX<-a),u=t?n?l:c:n?c:l;let d=!t&&u;t&&!u&&(d=!0),this.lastOnEnd=e.currentTime;let h=u?.001:-.001;h+=Sm([0,0],[.4,0],[.6,1],[1,1],Wf(0,o<0?.01:o,.9999))[0]||0;const p=this._isOpen?!u:u;this.animation.easing("cubic-bezier(0.4, 0.0, 0.6, 1)").onFinish((()=>this.afterAnimation(d)),{oneTimeCallback:!0}).progressEnd(p?1:0,this._isOpen?1-h:h,300)}beforeAnimation(e){Hf(!this.isAnimating,"_before() should not be called while animating"),this.el.classList.add(Nv),this.el.setAttribute("tabindex","0"),this.backdropEl&&this.backdropEl.classList.add(Fv),this.contentEl&&(this.contentEl.classList.add($v),this.contentEl.setAttribute("aria-hidden","true")),this.blocker.block(),this.isAnimating=!0,e?this.ionWillOpen.emit():this.ionWillClose.emit()}afterAnimation(e){var t;Hf(this.isAnimating,"_before() should be called while animating"),this._isOpen=e,this.isAnimating=!1,this._isOpen||this.blocker.unblock(),e?(this.ionDidOpen.emit(),(null===(t=document.activeElement)||void 0===t?void 0:t.closest("ion-menu"))!==this.el&&this.el.focus(),document.addEventListener("focus",this.handleFocus,!0)):(this.el.classList.remove(Nv),this.el.removeAttribute("tabindex"),this.contentEl&&(this.contentEl.classList.remove($v),this.contentEl.removeAttribute("aria-hidden")),this.backdropEl&&this.backdropEl.classList.remove(Fv),this.animation&&this.animation.stop(),this.ionDidClose.emit(),document.removeEventListener("focus",this.handleFocus,!0))}updateState(){const e=this._isActive();this.gesture&&this.gesture.enable(e&&this.swipeGesture),!e&&this._isOpen&&this.forceClosing(),this.disabled||_g._setActiveMenu(this),Hf(!this.isAnimating,"can not be animating")}forceClosing(){Hf(this._isOpen,"menu cannot be closed"),this.isAnimating=!0,this.animation.direction("reverse").play({sync:!0}),this.afterAnimation(!1)}render(){const{type:e,disabled:t,isPaneVisible:n,inheritedAttributes:i,side:r}=this,o=sg(this);return bp(_p,{role:"navigation","aria-label":i["aria-label"]||"menu",class:{[o]:!0,[`menu-type-${e}`]:!0,"menu-enabled":!t,[`menu-side-${r}`]:!0,"menu-pane-visible":n}},bp("div",{class:"menu-inner",part:"container",ref:e=>this.menuInnerEl=e},bp("slot",null)),bp("ion-backdrop",{ref:e=>this.backdropEl=e,class:"menu-backdrop",tappable:!1,stopPropagation:!1,part:"backdrop"}))}get el(){return this}static get watchers(){return{type:["typeChanged"],disabled:["disabledChanged"],side:["sideChanged"],swipeGesture:["swipeGestureChanged"]}}static get style(){return{ios:":host{--width:304px;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--background:var(--ion-background-color, #fff);left:0;right:0;top:0;bottom:0;display:none;position:absolute;contain:strict}:host(.show-menu){display:block}.menu-inner{-webkit-transform:translateX(-9999px);transform:translateX(-9999px);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:strict}:host(.menu-side-start) .menu-inner{--ion-safe-area-right:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{inset-inline-start:0;inset-inline-end:auto}}@supports not (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{left:0;right:auto}:host-context([dir=rtl]):host(.menu-side-start) .menu-inner,:host-context([dir=rtl]).menu-side-start .menu-inner{left:unset;right:unset;left:auto;right:0}@supports selector(:dir(rtl)){:host(.menu-side-start) .menu-inner:dir(rtl){left:unset;right:unset;left:auto;right:0}}}:host(.menu-side-end) .menu-inner{--ion-safe-area-left:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{inset-inline-start:auto;inset-inline-end:0}}@supports not (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{left:auto;right:0}:host-context([dir=rtl]):host(.menu-side-end) .menu-inner,:host-context([dir=rtl]).menu-side-end .menu-inner{left:unset;right:unset;left:0;right:auto}@supports selector(:dir(rtl)){:host(.menu-side-end) .menu-inner:dir(rtl){left:unset;right:unset;left:0;right:auto}}}ion-backdrop{display:none;opacity:0.01;z-index:-1}@media (max-width: 340px){.menu-inner{--width:264px}}:host(.menu-type-reveal){z-index:0}:host(.menu-type-reveal.show-menu) .menu-inner{-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0)}:host(.menu-type-overlay){z-index:1000}:host(.menu-type-overlay) .show-backdrop{display:block;cursor:pointer}:host(.menu-pane-visible){width:var(--width);min-width:var(--min-width);max-width:var(--max-width)}:host(.menu-pane-visible) .menu-inner{left:0;right:0;width:auto;-webkit-transform:none !important;transform:none !important;-webkit-box-shadow:none !important;box-shadow:none !important}:host(.menu-pane-visible) ion-backdrop{display:hidden !important;}:host(.menu-type-push){z-index:1000}:host(.menu-type-push) .show-backdrop{display:block}",md:":host{--width:304px;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--background:var(--ion-background-color, #fff);left:0;right:0;top:0;bottom:0;display:none;position:absolute;contain:strict}:host(.show-menu){display:block}.menu-inner{-webkit-transform:translateX(-9999px);transform:translateX(-9999px);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:strict}:host(.menu-side-start) .menu-inner{--ion-safe-area-right:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{inset-inline-start:0;inset-inline-end:auto}}@supports not (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{left:0;right:auto}:host-context([dir=rtl]):host(.menu-side-start) .menu-inner,:host-context([dir=rtl]).menu-side-start .menu-inner{left:unset;right:unset;left:auto;right:0}@supports selector(:dir(rtl)){:host(.menu-side-start) .menu-inner:dir(rtl){left:unset;right:unset;left:auto;right:0}}}:host(.menu-side-end) .menu-inner{--ion-safe-area-left:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{inset-inline-start:auto;inset-inline-end:0}}@supports not (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{left:auto;right:0}:host-context([dir=rtl]):host(.menu-side-end) .menu-inner,:host-context([dir=rtl]).menu-side-end .menu-inner{left:unset;right:unset;left:0;right:auto}@supports selector(:dir(rtl)){:host(.menu-side-end) .menu-inner:dir(rtl){left:unset;right:unset;left:0;right:auto}}}ion-backdrop{display:none;opacity:0.01;z-index:-1}@media (max-width: 340px){.menu-inner{--width:264px}}:host(.menu-type-reveal){z-index:0}:host(.menu-type-reveal.show-menu) .menu-inner{-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0)}:host(.menu-type-overlay){z-index:1000}:host(.menu-type-overlay) .show-backdrop{display:block;cursor:pointer}:host(.menu-pane-visible){width:var(--width);min-width:var(--min-width);max-width:var(--max-width)}:host(.menu-pane-visible) .menu-inner{left:0;right:0;width:auto;-webkit-transform:none !important;transform:none !important;-webkit-box-shadow:none !important;box-shadow:none !important}:host(.menu-pane-visible) ion-backdrop{display:hidden !important;}:host(.menu-type-overlay) .menu-inner{-webkit-box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18);box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}"}}},[33,"ion-menu",{contentId:[513,"content-id"],menuId:[513,"menu-id"],type:[1025],disabled:[1028],side:[513],swipeGesture:[4,"swipe-gesture"],maxEdgeStart:[2,"max-edge-start"],isPaneVisible:[32],isEndSide:[32],isOpen:[64],isActive:[64],open:[64],close:[64],toggle:[64],setOpen:[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]]),Lv=(e,t,n)=>Math.max(0,t!==n?-e:e),Bv=(e,t,n,i)=>n?t>=e.innerWidth-i:t<=i,Nv="show-menu",Fv="show-backdrop",$v="menu-content-open",jv=function(){"undefined"!=typeof customElements&&["ion-menu","ion-backdrop"].forEach((e=>{switch(e){case"ion-menu":customElements.get(e)||customElements.define(e,zv);break;case"ion-backdrop":customElements.get(e)||Ay()}}))},Vv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.onClick=()=>_g.toggle(this.menu),this.visible=!1,this.menu=void 0,this.autoHide=!0}connectedCallback(){this.visibilityChanged()}async visibilityChanged(){this.visible=await(async e=>{const t=await _g.get(e);return!(!t||!(await t.isActive()))})(this.menu)}render(){const e=sg(this),t=this.autoHide&&!this.visible;return bp(_p,{onClick:this.onClick,"aria-hidden":t?"true":null,class:{[e]:!0,"menu-toggle-hidden":t}},bp("slot",null))}static get style(){return":host(.menu-toggle-hidden){display:none}"}},[1,"ion-menu-toggle",{menu:[1],autoHide:[4,"auto-hide"],visible:[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]),Uv=function(){"undefined"!=typeof customElements&&["ion-menu-toggle"].forEach((e=>{"ion-menu-toggle"===e&&(customElements.get(e)||customElements.define(e,Vv))}))};
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */class qv{constructor(e,t){this.component=e,this.params=t,this.state=1}async init(e){if(this.state=2,!this.element){const t=this.component;this.element=await wg(this.delegate,e,t,["ion-page","ion-page-invisible"],this.params)}}_destroy(){Hf(3!==this.state,"view state must be ATTACHED");const e=this.element;e&&(this.delegate?this.delegate.removeViewFromDom(e.parentElement,e):e.remove()),this.nav=void 0,this.state=3}}const Gv=(e,t,n)=>!!e&&e.component===t&&Jf(e.params,n),Wv=(e,t)=>e?e instanceof qv?e:new qv(e,t):null,Hv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Sp(this,"ionNavWillLoad",7),this.ionNavWillChange=Sp(this,"ionNavWillChange",3),this.ionNavDidChange=Sp(this,"ionNavDidChange",3),this.transInstr=[],this.animationEnabled=!0,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.delegate=void 0,this.swipeGesture=void 0,this.animated=!0,this.animation=void 0,this.rootParams=void 0,this.root=void 0}swipeGestureChanged(){this.gesture&&this.gesture.enable(!0===this.swipeGesture)}rootChanged(){void 0!==this.root&&!1!==this.didLoad&&(this.useRouter||void 0!==this.root&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=null!==document.querySelector("ion-router")&&null===this.el.closest("[no-router]"),void 0===this.swipeGesture){const e=sg(this);this.swipeGesture=Um.getBoolean("swipeBackEnabled","ios"===e)}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await ep((()=>t.import("./swipe-back-legacy-46a9e6f1.js")))).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const e of this.views)_m(e.element,lm),e._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(e,t,n,i){return this.insert(-1,e,t,n,i)}insert(e,t,n,i,r){return this.insertPages(e,[{component:t,componentProps:n}],i,r)}insertPages(e,t,n,i){return this.queueTrns({insertStart:e,insertViews:t,opts:n},i)}pop(e,t){return this.removeIndex(-1,1,e,t)}popTo(e,t,n){const i={removeStart:-1,removeCount:-1,opts:t};return"object"==typeof e&&e.component?(i.removeView=e,i.removeStart=1):"number"==typeof e&&(i.removeStart=e+1),this.queueTrns(i,n)}popToRoot(e,t){return this.removeIndex(1,-1,e,t)}removeIndex(e,t=1,n,i){return this.queueTrns({removeStart:e,removeCount:t,opts:n},i)}setRoot(e,t,n,i){return this.setPages([{component:e,componentProps:t}],n,i)}setPages(e,t,n){return null!=t||(t={}),!0!==t.animated&&(t.animated=!1),this.queueTrns({insertStart:0,insertViews:e,removeStart:0,removeCount:-1,opts:t},n)}setRouteId(e,t,n,i){const r=this.getActiveSync();if(Gv(r,e,t))return Promise.resolve({changed:!1,element:r.element});let o;const s=new Promise((e=>o=e));let a;const l={updateURL:!1,viewIsReady:e=>{let t;const n=new Promise((e=>t=e));return o({changed:!0,element:e,markVisible:async()=>{t(),await a}}),n}};if("root"===n)a=this.setRoot(e,t,l);else{const r=this.views.find((n=>Gv(n,e,t)));r?a=this.popTo(r,Object.assign(Object.assign({},l),{direction:"back",animationBuilder:i})):"forward"===n?a=this.push(e,t,Object.assign(Object.assign({},l),{animationBuilder:i})):"back"===n&&(a=this.setRoot(e,t,Object.assign(Object.assign({},l),{direction:"back",animated:!0,animationBuilder:i})))}return s}async getRouteId(){const e=this.getActiveSync();if(e)return{id:e.element.tagName,params:e.params,element:e.element}}async getActive(){return this.getActiveSync()}async getByIndex(e){return this.views[e]}async canGoBack(e){return this.canGoBackSync(e)}async getPrevious(e){return this.getPreviousSync(e)}getLength(){return this.views.length}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(e=this.getActiveSync()){return!(!e||!this.getPreviousSync(e))}getPreviousSync(e=this.getActiveSync()){if(!e)return;const t=this.views,n=t.indexOf(e);return n>0?t[n-1]:void 0}async queueTrns(e,t){var n,i;if(this.isTransitioning&&(null===(n=e.opts)||void 0===n?void 0:n.skipIfBusy))return!1;const r=new Promise(((t,n)=>{e.resolve=t,e.reject=n}));if(e.done=t,e.opts&&!1!==e.opts.updateURL&&this.useRouter){const t=document.querySelector("ion-router");if(t){const n=await t.canTransition();if(!1===n)return!1;if("string"==typeof n)return t.push(n,e.opts.direction||"back"),!1}}return 0===(null===(i=e.insertViews)||void 0===i?void 0:i.length)&&(e.insertViews=void 0),this.transInstr.push(e),this.nextTrns(),r}success(e,t){if(this.destroyed)this.fireError("nav controller was destroyed",t);else if(t.done&&t.done(e.hasCompleted,e.requiresTransition,e.enteringView,e.leavingView,e.direction),t.resolve(e.hasCompleted),!1!==t.opts.updateURL&&this.useRouter){const t=document.querySelector("ion-router");if(t){const n="back"===e.direction?"back":"forward";t.navChanged(n)}}}failed(e,t){this.destroyed?this.fireError("nav controller was destroyed",t):(this.transInstr.length=0,this.fireError(e,t))}fireError(e,t){t.done&&t.done(!1,!1,e),t.reject&&!this.destroyed?t.reject(e):t.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const e=this.transInstr.shift();return!!e&&(this.runTransition(e),!0)}async runTransition(e){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(e);const t=this.getActiveSync(),n=this.getEnteringView(e,t);if(!t&&!n)throw new Error("no views in the stack to be removed");n&&1===n.state&&await n.init(this.el),this.postViewInit(n,t,e);const i=(e.enteringRequiresTransition||e.leavingRequiresTransition)&&n!==t;let r;i&&e.opts&&t&&("back"===e.opts.direction&&(e.opts.animationBuilder=e.opts.animationBuilder||(null==n?void 0:n.animationBuilder)),t.animationBuilder=e.opts.animationBuilder),r=i?await this.transition(n,t,e):{hasCompleted:!0,requiresTransition:!1},this.success(r,e),this.ionNavDidChange.emit()}catch(t){this.failed(t,e)}this.isTransitioning=!1,this.nextTrns()}prepareTI(e){var t,n,i;const r=this.views.length;if(null!==(t=e.opts)&&void 0!==t||(e.opts={}),null!==(n=(i=e.opts).delegate)&&void 0!==n||(i.delegate=this.delegate),void 0!==e.removeView){Hf(void 0!==e.removeStart,"removeView needs removeStart"),Hf(void 0!==e.removeCount,"removeView needs removeCount");const t=this.views.indexOf(e.removeView);if(t<0)throw new Error("removeView was not found");e.removeStart+=t}void 0!==e.removeStart&&(e.removeStart<0&&(e.removeStart=r-1),e.removeCount<0&&(e.removeCount=r-e.removeStart),e.leavingRequiresTransition=e.removeCount>0&&e.removeStart+e.removeCount===r),e.insertViews&&((e.insertStart<0||e.insertStart>r)&&(e.insertStart=r),e.enteringRequiresTransition=e.insertStart===r);const o=e.insertViews;if(!o)return;Hf(o.length>0,"length can not be zero");const s=o.map((e=>e instanceof qv?e:"component"in e?Wv(e.component,null===e.componentProps?void 0:e.componentProps):Wv(e,void 0))).filter((e=>null!==e));if(0===s.length)throw new Error("invalid views to insert");for(const a of s){a.delegate=e.opts.delegate;const t=a.nav;if(t&&t!==this)throw new Error("inserted view was already inserted");if(3===a.state)throw new Error("inserted view was already destroyed")}e.insertViews=s}getEnteringView(e,t){const n=e.insertViews;if(void 0!==n)return n[n.length-1];const i=e.removeStart;if(void 0!==i){const n=this.views,r=i+e.removeCount;for(let e=n.length-1;e>=0;e--){const o=n[e];if((e<i||e>=r)&&o!==t)return o}}}postViewInit(e,t,n){var i,r,o;Hf(t||e,"Both leavingView and enteringView are null"),Hf(n.resolve,"resolve must be valid"),Hf(n.reject,"reject must be valid");const s=n.opts,{insertViews:a,removeStart:l,removeCount:c}=n;let u;if(void 0!==l&&void 0!==c){Hf(l>=0,"removeStart can not be negative"),Hf(c>=0,"removeCount can not be negative"),u=[];for(let n=l;n<l+c;n++){const i=this.views[n];void 0!==i&&i!==e&&i!==t&&u.push(i)}null!==(i=s.direction)&&void 0!==i||(s.direction="back")}const d=this.views.length+(null!==(r=null==a?void 0:a.length)&&void 0!==r?r:0)-(null!=c?c:0);if(Hf(d>=0,"final balance can not be negative"),0===d)throw console.warn("You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(a){let e=n.insertStart;for(const t of a)this.insertViewAt(t,e),e++;n.enteringRequiresTransition&&(null!==(o=s.direction)&&void 0!==o||(s.direction="forward"))}if(u&&u.length>0){for(const e of u)_m(e.element,sm),_m(e.element,am),_m(e.element,lm);for(const e of u)this.destroyView(e)}}async transition(e,t,n){const i=n.opts,r=i.progressAnimation?e=>this.sbAni=e:void 0,o=sg(this),s=e.element,a=t&&t.element,l=Object.assign(Object.assign({mode:o,showGoBack:this.canGoBackSync(e),baseEl:this.el,progressCallback:r,animated:this.animated&&Um.getBoolean("animated",!0),enteringEl:s,leavingEl:a},i),{animationBuilder:i.animationBuilder||this.animation||Um.get("navAnimation")}),{hasCompleted:c}=await cm(l);return this.transitionFinish(c,e,t,i)}transitionFinish(e,t,n,i){const r=e?t:n;return r&&this.unmountInactiveViews(r),{hasCompleted:e,requiresTransition:!0,enteringView:t,leavingView:n,direction:i.direction}}insertViewAt(e,t){const n=this.views,i=n.indexOf(e);i>-1?(Hf(e.nav===this,"view is not part of the nav"),n.splice(i,1),n.splice(t,0,e)):(Hf(!e.nav,"nav is used"),e.nav=this,n.splice(t,0,e))}removeView(e){Hf(2===e.state||3===e.state,"view state should be loaded or destroyed");const t=this.views,n=t.indexOf(e);Hf(n>-1,"view must be part of the stack"),n>=0&&t.splice(n,1)}destroyView(e){e._destroy(),this.removeView(e)}unmountInactiveViews(e){if(this.destroyed)return;const t=this.views,n=t.indexOf(e);for(let i=t.length-1;i>=0;i--){const e=t[i],r=e.element;r&&(i>n?(_m(r,lm),this.destroyView(e)):i<n&&km(r,!0))}}canStart(){return!!this.swipeGesture&&!this.isTransitioning&&0===this.transInstr.length&&this.animationEnabled&&this.canGoBackSync()}onStart(){this.pop({direction:"back",progressAnimation:!0})}onMove(e){this.sbAni&&this.sbAni.progressStep(e)}onEnd(e,t,n){if(this.sbAni){this.animationEnabled=!1,this.sbAni.onFinish((()=>{this.animationEnabled=!0}),{oneTimeCallback:!0});let i=e?-.001:.001;e?i+=Sm([0,0],[.32,.72],[0,1],[1,1],t)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),i+=Sm([0,0],[1,0],[.68,.28],[1,1],t)[0]),this.sbAni.progressEnd(e?1:0,i,n)}}render(){return bp("slot",null)}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}"}},[1,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64]}]),Zv=function(){"undefined"!=typeof customElements&&["ion-nav"].forEach((e=>{"ion-nav"===e&&(customElements.get(e)||customElements.define(e,Hv))}))},Xv=function(){"undefined"!=typeof customElements&&["ion-spinner"].forEach((e=>{"ion-spinner"===e&&(customElements.get(e)||customElements.define(e,Tv))}))}
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */,Kv=Yy,Jv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.inheritedAriaAttributes={},this.color=void 0,this.button=!1,this.type="button",this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.target=void 0}componentWillLoad(){this.inheritedAriaAttributes=Nf(this.el,["aria-label"])}isClickable(){return void 0!==this.href||this.button}renderCard(e){const t=this.isClickable();if(!t)return[bp("slot",null)];const{href:n,routerAnimation:i,routerDirection:r,inheritedAriaAttributes:o}=this,s=t?void 0===n?"button":"a":"div",a="button"===s?{type:this.type}:{download:this.download,href:this.href,rel:this.rel,target:this.target};return bp(s,Object.assign({},a,o,{class:"card-native",part:"native",disabled:this.disabled,onClick:e=>zy(n,e,r,i)}),bp("slot",null),t&&"md"===e&&bp("ion-ripple-effect",null))}render(){const e=sg(this);return bp(_p,{class:Oy(this.color,{[e]:!0,"card-disabled":this.disabled,"ion-activatable":this.isClickable()})},this.renderCard(e))}get el(){return this}static get style(){return{ios:":host{--ion-safe-area-left:0px;--ion-safe-area-right:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);contain:content;overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.card-disabled){cursor:default;opacity:0.3;pointer-events:none}.card-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:inherit}.card-native::-moz-focus-inner{border:0}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}ion-ripple-effect{color:var(--ripple-color)}:host{--background:var(--ion-card-background, var(--ion-item-background, var(--ion-background-color, #fff)));--color:var(--ion-card-color, var(--ion-item-color, var(--ion-color-step-600, #666666)));-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:24px;margin-bottom:24px;border-radius:8px;-webkit-transition:-webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:-webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1), -webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);font-size:14px;-webkit-box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);box-shadow:0 4px 16px rgba(0, 0, 0, 0.12)}:host(.ion-activated){-webkit-transform:scale3d(0.97, 0.97, 1);transform:scale3d(0.97, 0.97, 1)}",md:":host{--ion-safe-area-left:0px;--ion-safe-area-right:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);contain:content;overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.card-disabled){cursor:default;opacity:0.3;pointer-events:none}.card-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:inherit}.card-native::-moz-focus-inner{border:0}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}ion-ripple-effect{color:var(--ripple-color)}:host{--background:var(--ion-card-background, var(--ion-item-background, var(--ion-background-color, #fff)));--color:var(--ion-card-color, var(--ion-item-color, var(--ion-color-step-550, #737373)));-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px;margin-top:10px;margin-bottom:10px;border-radius:4px;font-size:14px;-webkit-box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12);box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}"}}},[33,"ion-card",{color:[513],button:[4],type:[1],disabled:[4],download:[1],href:[1],rel:[1],routerDirection:[1,"router-direction"],routerAnimation:[16],target:[1]}]),Yv=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionFocus=Sp(this,"ionFocus",7),this.ionBlur=Sp(this,"ionBlur",7),this.fab=null,this.inheritedAttributes={},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.onClick=()=>{const{fab:e}=this;e&&e.toggle()},this.color=void 0,this.activated=!1,this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.target=void 0,this.show=!1,this.translucent=!1,this.type="button",this.size=void 0,this.closeIcon="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z'/></svg>"}connectedCallback(){this.fab=this.el.closest("ion-fab")}componentWillLoad(){this.inheritedAttributes=$f(this.el)}render(){const{el:e,disabled:t,color:n,href:i,activated:r,show:o,translucent:s,size:a,inheritedAttributes:l}=this,c=Py("ion-fab-list",e),u=sg(this),d=void 0===i?"button":"a",h="button"===d?{type:this.type}:{download:this.download,href:i,rel:this.rel,target:this.target};return bp(_p,{onClick:this.onClick,"aria-disabled":t?"true":null,class:Oy(n,{[u]:!0,"fab-button-in-list":c,"fab-button-translucent-in-list":c&&s,"fab-button-close-active":r,"fab-button-show":o,"fab-button-disabled":t,"fab-button-translucent":s,"ion-activatable":!0,"ion-focusable":!0,[`fab-button-${a}`]:void 0!==a})},bp(d,Object.assign({},h,{class:"button-native",part:"native",disabled:t,onFocus:this.onFocus,onBlur:this.onBlur,onClick:e=>zy(i,e,this.routerDirection,this.routerAnimation)},l),bp("ion-icon",{"aria-hidden":"true",icon:this.closeIcon,part:"close-icon",class:"close-icon",lazy:!1}),bp("span",{class:"button-inner"},bp("slot",null)),"md"===u&&bp("ion-ripple-effect",null)))}get el(){return this}static get style(){return{ios:':host{--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--background-hover:var(--ion-color-primary-contrast, #fff);--background-hover-opacity:.08;--transition:background-color, opacity 100ms linear;--ripple-color:currentColor;--border-radius:50%;--border-width:0;--border-style:none;--border-color:initial;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:56px;height:56px;font-size:14px;text-align:center;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transform:var(--transform);transform:var(--transform);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);background-clip:padding-box;color:var(--color);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:strict;cursor:pointer;overflow:hidden;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-icon){line-height:1}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;z-index:1}:host(.fab-button-disabled){cursor:default;opacity:0.5;pointer-events:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-activated) .button-native{color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}::slotted(ion-icon){line-height:1}:host(.fab-button-small){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px;margin-bottom:8px;width:40px;height:40px}.close-icon{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;left:0;right:0;top:0;position:absolute;height:100%;-webkit-transform:scale(0.4) rotateZ(-45deg);transform:scale(0.4) rotateZ(-45deg);-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;font-size:var(--close-icon-font-size);opacity:0;z-index:1}:host(.fab-button-close-active) .close-icon{-webkit-transform:scale(1) rotateZ(0deg);transform:scale(1) rotateZ(0deg);opacity:1}:host(.fab-button-close-active) .button-inner{-webkit-transform:scale(0.4) rotateZ(45deg);transform:scale(0.4) rotateZ(45deg);opacity:0}ion-ripple-effect{color:var(--ripple-color)}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent) .button-native{-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter)}}:host(.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{--background:var(--ion-color-primary, #3880ff);--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1;--color:var(--ion-color-primary-contrast, #fff);--box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);--transition:0.2s transform cubic-bezier(0.25, 1.11, 0.78, 1.59);--close-icon-font-size:28px}:host(.ion-activated){--box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);--transform:scale(1.1);--transition:0.2s transform ease-out}::slotted(ion-icon){font-size:28px}:host(.fab-button-in-list){--background:var(--ion-color-light, #f4f5f8);--background-activated:var(--ion-color-light-shade, #d7d8da);--background-focused:var(--background-activated);--background-hover:var(--ion-color-light-tint, #f5f6f9);--color:var(--ion-color-light-contrast, #000);--color-activated:var(--ion-color-light-contrast, #000);--color-focused:var(--color-activated);--transition:transform 200ms ease 10ms, opacity 200ms ease 10ms}:host(.fab-button-in-list) ::slotted(ion-icon){font-size:18px}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}:host(.ion-color.ion-focused) .button-native,:host(.ion-color.ion-activated) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .button-native::after,:host(.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-contrast)}:host(.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent){--background:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.9);--background-hover:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.8);--background-focused:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.82);--backdrop-filter:saturate(180%) blur(20px)}:host(.fab-button-translucent-in-list){--background:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.9);--background-hover:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.8);--background-focused:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.82)}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){@media (any-hover: hover){:host(.fab-button-translucent.ion-color:hover) .button-native{background:rgba(var(--ion-color-base-rgb), 0.8)}}:host(.ion-color.fab-button-translucent) .button-native{background:rgba(var(--ion-color-base-rgb), 0.9)}:host(.ion-color.ion-focused.fab-button-translucent) .button-native,:host(.ion-color.ion-activated.fab-button-translucent) .button-native{background:var(--ion-color-base)}}',md:':host{--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--background-hover:var(--ion-color-primary-contrast, #fff);--background-hover-opacity:.08;--transition:background-color, opacity 100ms linear;--ripple-color:currentColor;--border-radius:50%;--border-width:0;--border-style:none;--border-color:initial;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:56px;height:56px;font-size:14px;text-align:center;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transform:var(--transform);transform:var(--transform);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);background-clip:padding-box;color:var(--color);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:strict;cursor:pointer;overflow:hidden;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-icon){line-height:1}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;z-index:1}:host(.fab-button-disabled){cursor:default;opacity:0.5;pointer-events:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-activated) .button-native{color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}::slotted(ion-icon){line-height:1}:host(.fab-button-small){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px;margin-bottom:8px;width:40px;height:40px}.close-icon{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;left:0;right:0;top:0;position:absolute;height:100%;-webkit-transform:scale(0.4) rotateZ(-45deg);transform:scale(0.4) rotateZ(-45deg);-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;font-size:var(--close-icon-font-size);opacity:0;z-index:1}:host(.fab-button-close-active) .close-icon{-webkit-transform:scale(1) rotateZ(0deg);transform:scale(1) rotateZ(0deg);opacity:1}:host(.fab-button-close-active) .button-inner{-webkit-transform:scale(0.4) rotateZ(45deg);transform:scale(0.4) rotateZ(45deg);opacity:0}ion-ripple-effect{color:var(--ripple-color)}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent) .button-native{-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter)}}:host(.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{--background:var(--ion-color-primary, #3880ff);--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--color:var(--ion-color-primary-contrast, #fff);--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1), background-color 280ms cubic-bezier(0.4, 0, 0.2, 1), color 280ms cubic-bezier(0.4, 0, 0.2, 1), opacity 15ms linear 30ms, transform 270ms cubic-bezier(0, 0, 0.2, 1) 0ms;--close-icon-font-size:24px}:host(.ion-activated){--box-shadow:0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 12px 17px 2px rgba(0, 0, 0, 0.14), 0 5px 22px 4px rgba(0, 0, 0, 0.12)}::slotted(ion-icon){font-size:24px}:host(.fab-button-in-list){--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);--color-activated:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);--color-focused:var(--color-activated);--background:var(--ion-color-light, #f4f5f8);--background-activated:transparent;--background-focused:var(--ion-color-light-shade, #d7d8da);--background-hover:var(--ion-color-light-tint, #f5f6f9)}:host(.fab-button-in-list) ::slotted(ion-icon){font-size:18px}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast)}:host(.ion-color.ion-activated) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activated) .button-native::after{background:transparent}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-contrast)}:host(.ion-color:hover) .button-native::after{background:var(--ion-color-contrast)}}'}}},[33,"ion-fab-button",{color:[513],activated:[4],disabled:[4],download:[1],href:[1],rel:[1],routerDirection:[1,"router-direction"],routerAnimation:[16],target:[1],show:[4],translucent:[4],type:[1],size:[1],closeIcon:[1,"close-icon"]}]),Qv=Yv,eb=Qy,tb=(e,t)=>{const n=om(),i=om(),r=Uf(e).querySelector(".toast-wrapper");switch(i.addElement(r),t){case"top":i.fromTo("transform","translateY(-100%)","translateY(calc(10px + var(--ion-safe-area-top, 0px)))");break;case"middle":const t=Math.floor(e.clientHeight/2-r.clientHeight/2);r.style.top=`${t}px`,i.fromTo("opacity",.01,1);break;default:i.fromTo("transform","translateY(100%)","translateY(calc(-10px - var(--ion-safe-area-bottom, 0px)))")}return n.easing("cubic-bezier(.155,1.105,.295,1.12)").duration(400).addAnimation(i)},nb=(e,t)=>{const n=om(),i=om(),r=Uf(e).querySelector(".toast-wrapper");switch(i.addElement(r),t){case"top":i.fromTo("transform","translateY(calc(10px + var(--ion-safe-area-top, 0px)))","translateY(-100%)");break;case"middle":i.fromTo("opacity",.99,0);break;default:i.fromTo("transform","translateY(calc(-10px - var(--ion-safe-area-bottom, 0px)))","translateY(100%)")}return n.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(i)},ib=(e,t)=>{const n=om(),i=om(),r=Uf(e).querySelector(".toast-wrapper");switch(i.addElement(r),t){case"top":r.style.top="calc(8px + var(--ion-safe-area-top, 0px))",i.fromTo("opacity",.01,1);break;case"middle":const t=Math.floor(e.clientHeight/2-r.clientHeight/2);r.style.top=`${t}px`,i.fromTo("opacity",.01,1);break;default:r.style.bottom="calc(8px + var(--ion-safe-area-bottom, 0px))",i.fromTo("opacity",.01,1)}return n.easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation(i)},rb=e=>{const t=om(),n=om(),i=Uf(e).querySelector(".toast-wrapper");return n.addElement(i).fromTo("opacity",.99,0),t.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(n)},ob=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.didPresent=Sp(this,"ionToastDidPresent",7),this.willPresent=Sp(this,"ionToastWillPresent",7),this.willDismiss=Sp(this,"ionToastWillDismiss",7),this.didDismiss=Sp(this,"ionToastDidDismiss",7),this.didPresentShorthand=Sp(this,"didPresent",7),this.willPresentShorthand=Sp(this,"willPresent",7),this.willDismissShorthand=Sp(this,"willDismiss",7),this.didDismissShorthand=Sp(this,"didDismiss",7),this.delegateController=(e=>{let t,n=!1;const i=Eg(),r=(r=!1)=>{if(t&&!r)return{delegate:t,inline:n};const{el:o,hasController:s,delegate:a}=e,l=o.parentNode;return n=null!==l&&!s,t=n?a||i:a,{inline:n,delegate:t}};return{attachViewToDom:async t=>{const{delegate:n}=r(!0);if(n)return await n.attachViewToDom(e.el,t);const{hasController:i}=e;if(i&&void 0!==t)throw new Error("framework delegate is missing");return null},removeViewFromDom:()=>{const{delegate:t}=r();t&&void 0!==e.el&&t.removeViewFromDom(e.el.parentElement,e.el)}}})(this),this.triggerController=ey(),this.customHTMLEnabled=Um.get("innerHTMLTemplatesEnabled",!1),this.presented=!1,this.dispatchCancelHandler=e=>{const t=e.detail.role;if(Kg(t)){const e=this.getButtons().find((e=>"cancel"===e.role));this.callButtonHandler(e)}},this.revealContentToScreenReader=!1,this.overlayIndex=void 0,this.delegate=void 0,this.hasController=!1,this.color=void 0,this.enterAnimation=void 0,this.leaveAnimation=void 0,this.cssClass=void 0,this.duration=Um.getNumber("toastDuration",0),this.header=void 0,this.layout="baseline",this.message=void 0,this.keyboardClose=!1,this.position="bottom",this.buttons=void 0,this.translucent=!1,this.animated=!0,this.icon=void 0,this.htmlAttributes=void 0,this.isOpen=!1,this.trigger=void 0}onIsOpenChange(e,t){!0===e&&!1===t?this.present():!1===e&&!0===t&&this.dismiss()}triggerChanged(){const{trigger:e,el:t,triggerController:n}=this;e&&n.addClickListener(t,e)}connectedCallback(){Og(this.el),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){Dg(this.el)}async present(){void 0!==this.currentTransition&&await this.currentTransition,await this.delegateController.attachViewToDom(),this.currentTransition=Ug(this,"toastEnter",tb,ib,this.position),await this.currentTransition,this.revealContentToScreenReader=!0,this.currentTransition=void 0,this.duration>0&&(this.durationTimeout=setTimeout((()=>this.dismiss(void 0,"timeout")),this.duration))}async dismiss(e,t){this.durationTimeout&&clearTimeout(this.durationTimeout),this.currentTransition=Gg(this,e,t,"toastLeave",nb,rb,this.position);const n=await this.currentTransition;return n&&(this.delegateController.removeViewFromDom(),this.revealContentToScreenReader=!1),n}onDidDismiss(){return Zg(this.el,"ionToastDidDismiss")}onWillDismiss(){return Zg(this.el,"ionToastWillDismiss")}getButtons(){const e=this.buttons?this.buttons.map((e=>"string"==typeof e?{text:e}:e)):[];return e}async buttonClick(e){const t=e.role;return Kg(t)||await this.callButtonHandler(e)?this.dismiss(void 0,t):Promise.resolve()}async callButtonHandler(e){if(null==e?void 0:e.handler)try{const t=await((e,t)=>{if("function"==typeof e)return Um.get("_zoneGate",Jg)((()=>{try{return e(t)}catch(wT){throw wT}}))})(e.handler);if(!1===t)return!1}catch(wT){console.error(wT)}return!0}renderButtons(e,t){if(0===e.length)return;const n=sg(this);return bp("div",{class:{"toast-button-group":!0,[`toast-button-group-${t}`]:!0}},e.map((e=>bp("button",{type:"button",class:sb(e),tabIndex:0,onClick:()=>this.buttonClick(e),part:"button"},bp("div",{class:"toast-button-inner"},e.icon&&bp("ion-icon",{"aria-hidden":"true",icon:e.icon,slot:void 0===e.text?"icon-only":void 0,class:"toast-button-icon"}),e.text),"md"===n&&bp("ion-ripple-effect",{type:void 0!==e.icon&&void 0===e.text?"unbounded":"bounded"})))))}renderToastMessage(e,t=null){const{customHTMLEnabled:n,message:i}=this;return n?bp("div",{key:e,"aria-hidden":t,class:"toast-message",part:"message",innerHTML:lg(i)}):bp("div",{key:e,"aria-hidden":t,class:"toast-message",part:"message"},i)}renderHeader(e,t=null){return bp("div",{key:e,class:"toast-header","aria-hidden":t,part:"header"},this.header)}render(){const{layout:e,el:t,revealContentToScreenReader:n,header:i,message:r}=this,o=this.getButtons(),s=o.filter((e=>"start"===e.side)),a=o.filter((e=>"start"!==e.side)),l=sg(this),c={"toast-wrapper":!0,[`toast-${this.position}`]:!0,[`toast-layout-${e}`]:!0};return"stacked"===e&&s.length>0&&a.length>0&&Sg("This toast is using start and end buttons with the stacked toast layout. We recommend following the best practice of using either start or end buttons with the stacked toast layout.",t),bp(_p,Object.assign({tabindex:"-1"},this.htmlAttributes,{style:{zIndex:`${6e4+this.overlayIndex}`},class:Oy(this.color,Object.assign(Object.assign({[l]:!0},Dy(this.cssClass)),{"overlay-hidden":!0,"toast-translucent":this.translucent})),onIonToastWillDismiss:this.dispatchCancelHandler}),bp("div",{class:c},bp("div",{class:"toast-container",part:"container"},this.renderButtons(s,"start"),void 0!==this.icon&&bp("ion-icon",{class:"toast-icon",part:"icon",icon:this.icon,lazy:!1,"aria-hidden":"true"}),bp("div",{class:"toast-content",role:"status","aria-atomic":"true","aria-live":"polite"},!n&&void 0!==i&&this.renderHeader("oldHeader","true"),!n&&void 0!==r&&this.renderToastMessage("oldMessage","true"),n&&void 0!==i&&this.renderHeader("header"),n&&void 0!==r&&this.renderToastMessage("header")),this.renderButtons(a,"end"))))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}@supports (inset-inline-start: 0){:host{inset-inline-start:0}}@supports not (inset-inline-start: 0){:host{left:0}:host-context([dir=rtl]){left:unset;right:unset;right:0}@supports selector(:dir(rtl)){:host:dir(rtl){left:unset;right:unset;right:0}}}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}@supports (inset-inline-start: 0){.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}}@supports not (inset-inline-start: 0){.toast-wrapper{left:var(--start);right:var(--end)}:host-context([dir=rtl]) .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}[dir=rtl] .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}@supports selector(:dir(rtl)){.toast-wrapper:dir(rtl){left:unset;right:unset;left:var(--end);right:var(--start)}}}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;pointer-events:auto;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-50, #f2f2f2);--border-radius:14px;--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-850, #262626);--max-width:700px;--start:10px;--end:10px;font-size:14px}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;z-index:10}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.toast-translucent) .toast-wrapper{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}:host(.ion-color.toast-translucent) .toast-wrapper{background:rgba(var(--ion-color-base-rgb), 0.8)}}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-middle{opacity:0.01}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-content{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:15px;padding-bottom:15px}.toast-header{margin-bottom:2px;font-weight:500}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;height:44px;-webkit-transition:background-color, opacity 100ms linear;transition:background-color, opacity 100ms linear;border:0;background-color:transparent;font-family:var(--ion-font-family);font-size:17px;font-weight:500;overflow:hidden}.toast-button.ion-activated{opacity:0.4}@media (any-hover: hover){.toast-button:hover{opacity:0.6}}",md:":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}@supports (inset-inline-start: 0){:host{inset-inline-start:0}}@supports not (inset-inline-start: 0){:host{left:0}:host-context([dir=rtl]){left:unset;right:unset;right:0}@supports selector(:dir(rtl)){:host:dir(rtl){left:unset;right:unset;right:0}}}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}@supports (inset-inline-start: 0){.toast-wrapper{inset-inline-start:var(--start);inset-inline-end:var(--end)}}@supports not (inset-inline-start: 0){.toast-wrapper{left:var(--start);right:var(--end)}:host-context([dir=rtl]) .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}[dir=rtl] .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}@supports selector(:dir(rtl)){.toast-wrapper:dir(rtl){left:unset;right:unset;left:var(--end);right:var(--start)}}}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;pointer-events:auto;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-layout-stacked .toast-container{-ms-flex-wrap:wrap;flex-wrap:wrap}.toast-layout-baseline .toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{-webkit-margin-start:16px;margin-inline-start:16px}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-layout-stacked .toast-button-group{-ms-flex-pack:end;justify-content:end;width:100%}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-800, #333333);--border-radius:4px;--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-50, #f2f2f2);--max-width:700px;--start:8px;--end:8px;font-size:14px}.toast-wrapper{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;opacity:0.01;z-index:10}.toast-content{-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px;padding-top:14px;padding-bottom:14px}.toast-header{margin-bottom:2px;font-weight:500;line-height:20px}.toast-message{line-height:20px}.toast-layout-baseline .toast-button-group-start{-webkit-margin-start:8px;margin-inline-start:8px}.toast-layout-stacked .toast-button-group-start{-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px}.toast-layout-baseline .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px}.toast-layout-stacked .toast-button-group-end{-webkit-margin-end:8px;margin-inline-end:8px;margin-bottom:8px}.toast-button{-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;font-family:var(--ion-font-family);font-size:14px;font-weight:500;letter-spacing:0.84px;text-transform:uppercase;overflow:hidden}.toast-button-cancel{color:var(--ion-color-step-100, #e6e6e6)}.toast-button-icon-only{border-radius:50%;-webkit-padding-start:9px;padding-inline-start:9px;-webkit-padding-end:9px;padding-inline-end:9px;padding-top:9px;padding-bottom:9px;width:36px;height:36px}@media (any-hover: hover){.toast-button:hover{background-color:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.08)}.toast-button-cancel:hover{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.08)}}"}}},[33,"ion-toast",{overlayIndex:[2,"overlay-index"],delegate:[16],hasController:[4,"has-controller"],color:[513],enterAnimation:[16],leaveAnimation:[16],cssClass:[1,"css-class"],duration:[2],header:[1],layout:[1],message:[1],keyboardClose:[4,"keyboard-close"],position:[1],buttons:[16],translucent:[4],animated:[4],icon:[1],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],revealContentToScreenReader:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64]}]),sb=e=>Object.assign({"toast-button":!0,"toast-button-icon-only":void 0!==e.icon&&void 0===e.text,[`toast-button-${e.role}`]:void 0!==e.role,"ion-focusable":!0,"ion-activatable":!0},Dy(e.cssClass)),ab=function(){"undefined"!=typeof customElements&&["ion-toast","ion-icon","ion-ripple-effect"].forEach((e=>{switch(e){case"ion-toast":customElements.get(e)||customElements.define(e,ob);break;case"ion-icon":customElements.get(e)||Ty();break;case"ion-ripple-effect":customElements.get(e)||Gy()}}))},lb="ionKeyboardDidShow",cb="ionKeyboardDidHide";let ub={},db={},hb=!1;const pb=e=>{e.addEventListener("keyboardDidShow",(t=>fb(e,t))),e.addEventListener("keyboardDidHide",(()=>mb(e)))},fb=(e,t)=>{bb(e,t),hb=!0},mb=e=>{xb(e),hb=!1},gb=()=>{const e=(ub.height-db.height)*db.scale;return!hb&&ub.width===db.width&&e>150},yb=e=>hb&&!vb(e),vb=e=>hb&&db.height===e.innerHeight,bb=(e,t)=>{const n=t?t.keyboardHeight:e.innerHeight-db.height,i=new CustomEvent(lb,{detail:{keyboardHeight:n}});e.dispatchEvent(i)},xb=e=>{const t=new CustomEvent(cb);e.dispatchEvent(t)},_b=e=>{ub=Object.assign({},db),db=wb(e.visualViewport)},wb=e=>({width:Math.round(e.width),height:Math.round(e.height),offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,pageTop:e.pageTop,pageLeft:e.pageLeft,scale:e.scale}),kb=Object.freeze(Object.defineProperty({__proto__:null,KEYBOARD_DID_CLOSE:cb,KEYBOARD_DID_OPEN:lb,copyVisualViewport:wb,keyboardDidClose:vb,keyboardDidOpen:gb,keyboardDidResize:yb,resetKeyboardAssist:()=>{ub={},db={},hb=!1},setKeyboardClose:mb,setKeyboardOpen:fb,startKeyboardAssist:e=>{if(pv.getEngine())pb(e);else{if(!e.visualViewport)return;db=wb(e.visualViewport),e.visualViewport.onresize=()=>{_b(e),gb()||yb(e)?fb(e):vb(e)&&mb(e)}}},trackViewportChanges:_b},Symbol.toStringTag,{value:"Module"}));
/*!
             * (C) Ionic http://ionicframework.com - MIT License
             */
var Eb;!function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(Eb||(Eb={}));const Sb={getEngine(){var e;return(null===(e=null==Rf?void 0:Rf.Capacitor)||void 0===e?void 0:e.isPluginAvailable("StatusBar"))&&(null==Rf?void 0:Rf.Capacitor.Plugins.StatusBar)},supportsDefaultStatusBarStyle(){var e;return!!(null===(e=null==Rf?void 0:Rf.Capacitor)||void 0===e?void 0:e.PluginHeaders)},setStyle(e){const t=this.getEngine();t&&t.setStyle(e)},getStyle:async function(){const e=this.getEngine();if(!e)return Eb.Default;const{style:t}=await e.getInfo();return t}},Tb=(e,t)=>{if(1===t)return 0;const n=1/(1-t);return e*n+-t*n},Cb=()=>{!Rf||Rf.innerWidth>=768||!Sb.supportsDefaultStatusBarStyle()||Sb.setStyle({style:Eb.Dark})},Mb=(e=Eb.Default)=>{!Rf||Rf.innerWidth>=768||!Sb.supportsDefaultStatusBarStyle()||Sb.setStyle({style:e})},Ib=async(e,t)=>{"function"==typeof e.canDismiss&&await e.canDismiss(void 0,Qg)&&(t.isRunning()?t.onFinish((()=>{e.dismiss(void 0,"handler")}),{oneTimeCallback:!0}):e.dismiss(void 0,"handler"))},Ab=e=>.00255275*2.71828**(-14.9619*e)-1.00255*2.71828**(-.0380968*e)+1,Pb=.93,Ob=(e,t,n,i)=>{const r=.5,o=e.offsetHeight;let s=!1,a=!1,l=null,c=null,u=!0,d=0;const h=Bm({el:e,gestureName:"modalSwipeToClose",gesturePriority:39,direction:"y",threshold:10,canStart:e=>{const t=e.event.target;if(null===t||!t.closest)return!0;if(l=cv(t),l){if(sv(l)){const e=Uf(l);c=e.querySelector(".inner-scroll")}else c=l;return!l.querySelector("ion-refresher")&&0===c.scrollTop}return null===t.closest("ion-footer")},onStart:n=>{const{deltaY:i}=n;u=!l||!sv(l)||l.scrollY,a=void 0!==e.canDismiss&&!0!==e.canDismiss,i>0&&l&&dv(l),t.progressStart(!0,s?1:0)},onMove:e=>{const{deltaY:i}=e;i>0&&l&&dv(l);const s=e.deltaY/o,c=s>=0&&a,u=c?.2:.9999,h=c?Ab(s/u):s,p=Wf(1e-4,h,u);t.progressStep(p),p>=r&&d<r?Mb(n):p<r&&d>=r&&Cb(),d=p},onEnd:n=>{const c=n.velocityY,d=n.deltaY/o,p=d>=0&&a,f=p?.2:.9999,m=p?Ab(d/f):d,g=Wf(1e-4,m,f),y=(n.deltaY+1e3*c)/o,v=!p&&y>=r;let b=v?-.001:.001;v?(t.easing("cubic-bezier(0.32, 0.72, 0, 1)"),b+=Sm([0,0],[.32,.72],[0,1],[1,1],g)[0]):(t.easing("cubic-bezier(1, 0, 0.68, 0.28)"),b+=Sm([0,0],[1,0],[.68,.28],[1,1],g)[0]);const x=Db(v?d*o:(1-g)*o,c);s=v,h.enable(!1),l&&((e,t)=>{sv(e)?e.scrollY=t:e.style.removeProperty("overflow")})(l,u),t.onFinish((()=>{v||h.enable(!0)})).progressEnd(v?1:0,b,x),p&&g>f/4?Ib(e,t):v&&i()}});return h},Db=(e,t)=>Wf(400,e/Math.abs(1.1*t),500),Rb=e=>{const{currentBreakpoint:t,backdropBreakpoint:n}=e,i=void 0===n||n<t,r=i?`calc(var(--backdrop-opacity) * ${t})`:"0",o=om("backdropAnimation").fromTo("opacity",0,r);return i&&o.beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),{wrapperAnimation:om("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:`translateY(${100-100*t}%)`}]),backdropAnimation:o}},zb=e=>{const{currentBreakpoint:t,backdropBreakpoint:n}=e,i=`calc(var(--backdrop-opacity) * ${Tb(t,n)})`,r=[{offset:0,opacity:i},{offset:1,opacity:0}],o=[{offset:0,opacity:i},{offset:n,opacity:0},{offset:1,opacity:0}],s=om("backdropAnimation").keyframes(0!==n?o:r);return{wrapperAnimation:om("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:`translateY(${100-100*t}%)`},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:s}},Lb=(e,t)=>{const{presentingEl:n,currentBreakpoint:i}=t,r=Uf(e),{wrapperAnimation:o,backdropAnimation:s}=void 0!==i?Rb(t):{backdropAnimation:om().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),wrapperAnimation:om().fromTo("transform","translateY(100vh)","translateY(0vh)")};s.addElement(r.querySelector("ion-backdrop")),o.addElement(r.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const a=om("entering-base").addElement(e).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation(o);if(n){const e=window.innerWidth<768,t="ION-MODAL"===n.tagName&&void 0!==n.presentingElement,i=Uf(n),r=om().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),l=document.body;if(e){const e=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",i=`translateY(${t?"-10px":e}) scale(${Pb})`;r.afterStyles({transform:i}).beforeAddWrite((()=>l.style.setProperty("background-color","black"))).addElement(n).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:i,borderRadius:"10px 10px 0 0"}]),a.addAnimation(r)}else if(a.addAnimation(s),t){const e=`translateY(-10px) scale(${t?Pb:1})`;r.afterStyles({transform:e}).addElement(i.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:e}]);const n=om().afterStyles({transform:e}).addElement(i.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:e}]);a.addAnimation([r,n])}else o.fromTo("opacity","0","1")}else a.addAnimation(s);return a},Bb=(e,t,n=500)=>{const{presentingEl:i,currentBreakpoint:r}=t,o=Uf(e),{wrapperAnimation:s,backdropAnimation:a}=void 0!==r?zb(t):{backdropAnimation:om().fromTo("opacity","var(--backdrop-opacity)",0),wrapperAnimation:om().fromTo("transform","translateY(0vh)","translateY(100vh)")};a.addElement(o.querySelector("ion-backdrop")),s.addElement(o.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const l=om("leaving-base").addElement(e).easing("cubic-bezier(0.32,0.72,0,1)").duration(n).addAnimation(s);if(i){const e=window.innerWidth<768,t="ION-MODAL"===i.tagName&&void 0!==i.presentingElement,n=Uf(i),r=om().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish((e=>{if(1!==e)return;i.style.setProperty("overflow","");const t=Array.from(o.querySelectorAll("ion-modal")).filter((e=>void 0!==e.presentingElement)).length;t<=1&&o.style.setProperty("background-color","")})),o=document.body;if(e){const e=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",n=`translateY(${t?"-10px":e}) scale(${Pb})`;r.addElement(i).keyframes([{offset:0,filter:"contrast(0.85)",transform:n,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),l.addAnimation(r)}else if(l.addAnimation(a),t){const e=`translateY(-10px) scale(${t?Pb:1})`;r.addElement(n.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:e},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const i=om().addElement(n.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:e},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);l.addAnimation([r,i])}else s.fromTo("opacity","1","0")}else l.addAnimation(a);return l},Nb=(e,t)=>{const{currentBreakpoint:n}=t,i=Uf(e),{wrapperAnimation:r,backdropAnimation:o}=void 0!==n?Rb(t):{backdropAnimation:om().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),wrapperAnimation:om().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}])};return o.addElement(i.querySelector("ion-backdrop")),r.addElement(i.querySelector(".modal-wrapper")),om().addElement(e).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([o,r])},Fb=(e,t)=>{const{currentBreakpoint:n}=t,i=Uf(e),{wrapperAnimation:r,backdropAnimation:o}=void 0!==n?zb(t):{backdropAnimation:om().fromTo("opacity","var(--backdrop-opacity)",0),wrapperAnimation:om().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}])};return o.addElement(i.querySelector("ion-backdrop")),r.addElement(i.querySelector(".modal-wrapper")),om().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([o,r])},$b=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.didPresent=Sp(this,"ionModalDidPresent",7),this.willPresent=Sp(this,"ionModalWillPresent",7),this.willDismiss=Sp(this,"ionModalWillDismiss",7),this.didDismiss=Sp(this,"ionModalDidDismiss",7),this.ionBreakpointDidChange=Sp(this,"ionBreakpointDidChange",7),this.didPresentShorthand=Sp(this,"didPresent",7),this.willPresentShorthand=Sp(this,"willPresent",7),this.willDismissShorthand=Sp(this,"willDismiss",7),this.didDismissShorthand=Sp(this,"didDismiss",7),this.ionMount=Sp(this,"ionMount",7),this.triggerController=ey(),this.coreDelegate=Eg(),this.isSheetModal=!1,this.inheritedAttributes={},this.inline=!1,this.gestureAnimationDismissing=!1,this.onHandleClick=()=>{const{sheetTransition:e,handleBehavior:t}=this;"cycle"===t&&void 0===e&&this.moveToNextBreakpoint()},this.onBackdropTap=()=>{const{sheetTransition:e}=this;void 0===e&&this.dismiss(void 0,Yg)},this.onLifecycle=e=>{const t=this.usersElement,n=jb[e.type];if(t&&n){const i=new CustomEvent(n,{bubbles:!1,cancelable:!1,detail:e.detail});t.dispatchEvent(i)}},this.presented=!1,this.hasController=!1,this.overlayIndex=void 0,this.delegate=void 0,this.keyboardClose=!0,this.enterAnimation=void 0,this.leaveAnimation=void 0,this.breakpoints=void 0,this.initialBreakpoint=void 0,this.backdropBreakpoint=0,this.handle=void 0,this.handleBehavior="none",this.component=void 0,this.componentProps=void 0,this.cssClass=void 0,this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.presentingElement=void 0,this.htmlAttributes=void 0,this.isOpen=!1,this.trigger=void 0,this.keepContentsMounted=!1,this.canDismiss=!0}onIsOpenChange(e,t){!0===e&&!1===t?this.present():!1===e&&!0===t&&this.dismiss()}triggerChanged(){const{trigger:e,el:t,triggerController:n}=this;e&&n.addClickListener(t,e)}breakpointsChanged(e){void 0!==e&&(this.sortedBreakpoints=e.sort(((e,t)=>e-t)))}connectedCallback(){const{el:e}=this;Og(e),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){const{breakpoints:e,initialBreakpoint:t,el:n}=this,i=this.isSheetModal=void 0!==e&&void 0!==t;this.inheritedAttributes=Nf(n,["aria-label","role"]),i&&(this.currentBreakpoint=this.initialBreakpoint),void 0===e||void 0===t||e.includes(t)||Sg("Your breakpoints array must include the initialBreakpoint value."),Dg(n)}componentDidLoad(){!0===this.isOpen&&qf((()=>this.present())),this.breakpointsChanged(this.breakpoints)}getDelegate(e=!1){if(this.workingDelegate&&!e)return{delegate:this.workingDelegate,inline:this.inline};const t=this.el.parentNode,n=this.inline=null!==t&&!this.hasController;return{inline:n,delegate:this.workingDelegate=n?this.delegate||this.coreDelegate:this.delegate}}async checkCanDismiss(e,t){const{canDismiss:n}=this;return"function"==typeof n?n(e,t):n}async present(){if(this.presented)return;const{presentingElement:e,el:t}=this;void 0!==this.currentTransition&&await this.currentTransition,this.currentBreakpoint=this.initialBreakpoint;const{inline:n,delegate:i}=this.getDelegate(!0);this.usersElement=await wg(i,t,this.component,["ion-page"],this.componentProps,n),this.ionMount.emit(),Bf(t)?await wm(this.usersElement):this.keepContentsMounted||await new Promise((e=>qf((()=>qf((()=>e())))))),Df((()=>this.el.classList.add("show-modal"))),this.currentTransition=Ug(this,"modalEnter",Lb,Nb,{presentingEl:e,currentBreakpoint:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint}),"undefined"!=typeof window&&(this.keyboardOpenCallback=()=>{this.gesture&&(this.gesture.enable(!1),qf((()=>{this.gesture&&this.gesture.enable(!0)})))},window.addEventListener(lb,this.keyboardOpenCallback));const r=void 0!==e;r&&"ios"===sg(this)&&(this.statusBarStyle=await Sb.getStyle(),Cb()),await this.currentTransition,this.isSheetModal?this.initSheetGesture():r&&this.initSwipeToClose(),this.currentTransition=void 0}initSwipeToClose(){var e;if("ios"!==sg(this))return;const{el:t}=this,n=this.leaveAnimation||Um.get("modalLeave",Bb),i=this.animation=n(t,{presentingEl:this.presentingElement});if(!lv(t))return void uv(t);const r=null!==(e=this.statusBarStyle)&&void 0!==e?e:Eb.Default;this.gesture=Ob(t,i,r,(()=>{this.gestureAnimationDismissing=!0,this.animation.onFinish((async()=>{await this.dismiss(void 0,Qg),this.gestureAnimationDismissing=!1}))})),this.gesture.enable(!0)}initSheetGesture(){const{wrapperEl:e,initialBreakpoint:t,backdropBreakpoint:n}=this;if(!e||void 0===t)return;const i=this.enterAnimation||Um.get("modalEnter",Lb),r=this.animation=i(this.el,{presentingEl:this.presentingElement,currentBreakpoint:t,backdropBreakpoint:n});r.progressStart(!0,1);const{gesture:o,moveSheetToBreakpoint:s}=((e,t,n,i,r,o,s=[],a,l,c)=>{const u={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:0!==r?[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-r,opacity:0},{offset:1,opacity:0}]:[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}]},d=e.querySelector("ion-content"),h=n.clientHeight;let p=i,f=0,m=!1;const g=o.childAnimations.find((e=>"wrapperAnimation"===e.id)),y=o.childAnimations.find((e=>"backdropAnimation"===e.id)),v=s[s.length-1],b=s[0],x=()=>{e.style.setProperty("pointer-events","auto"),t.style.setProperty("pointer-events","auto"),e.classList.remove("ion-disable-focus-trap")},_=()=>{e.style.setProperty("pointer-events","none"),t.style.setProperty("pointer-events","none"),e.classList.add("ion-disable-focus-trap")};g&&y&&(g.keyframes([...u.WRAPPER_KEYFRAMES]),y.keyframes([...u.BACKDROP_KEYFRAMES]),o.progressStart(!0,1-p),p>r?x():_()),d&&p!==v&&(d.scrollY=!1);const w=t=>{const{breakpoint:n,canDismiss:i,breakpointOffset:a}=t,h=i&&0===n,f=h?p:n,m=0!==f;return p=0,g&&y&&(g.keyframes([{offset:0,transform:`translateY(${100*a}%)`},{offset:1,transform:`translateY(${100*(1-f)}%)`}]),y.keyframes([{offset:0,opacity:`calc(var(--backdrop-opacity) * ${Tb(1-a,r)})`},{offset:1,opacity:`calc(var(--backdrop-opacity) * ${Tb(f,r)})`}]),o.progressStep(0)),k.enable(!1),h?Ib(e,o):m||l(),new Promise((e=>{o.onFinish((()=>{m?g&&y?qf((()=>{g.keyframes([...u.WRAPPER_KEYFRAMES]),y.keyframes([...u.BACKDROP_KEYFRAMES]),o.progressStart(!0,1-f),p=f,c(p),d&&p===s[s.length-1]&&(d.scrollY=!0),p>r?x():_(),k.enable(!0),e()})):(k.enable(!0),e()):e()}),{oneTimeCallback:!0}).progressEnd(1,0,500)}))},k=Bm({el:n,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:e=>{const t=e.event.target.closest("ion-content");return p=a(),1!==p||!t},onStart:()=>{m=void 0!==e.canDismiss&&!0!==e.canDismiss&&0===b,d&&(d.scrollY=!1),qf((()=>{e.focus()})),o.progressStart(!0,1-p)},onMove:e=>{const t=1-p,n=s.length>1?1-s[1]:void 0,i=t+e.deltaY/h,r=void 0!==n&&i>=n&&m,a=r?.95:.9999,l=r&&void 0!==n?n+Ab((i-n)/(a-n)):i;f=Wf(1e-4,l,a),o.progressStep(f)},onEnd:e=>{const t=e.velocityY,n=(e.deltaY+350*t)/h,i=p-n,r=s.reduce(((e,t)=>Math.abs(t-i)<Math.abs(e-i)?t:e));w({breakpoint:r,breakpointOffset:f,canDismiss:m})}});return{gesture:k,moveSheetToBreakpoint:w}})(this.el,this.backdropEl,e,t,n,r,this.sortedBreakpoints,(()=>{var e;return null!==(e=this.currentBreakpoint)&&void 0!==e?e:0}),(()=>this.sheetOnDismiss()),(e=>{this.currentBreakpoint!==e&&(this.currentBreakpoint=e,this.ionBreakpointDidChange.emit({breakpoint:e}))}));this.gesture=o,this.moveSheetToBreakpoint=s,this.gesture.enable(!0)}sheetOnDismiss(){this.gestureAnimationDismissing=!0,this.animation.onFinish((async()=>{this.currentBreakpoint=0,this.ionBreakpointDidChange.emit({breakpoint:this.currentBreakpoint}),await this.dismiss(void 0,Qg),this.gestureAnimationDismissing=!1}))}async dismiss(e,t){var n;if(this.gestureAnimationDismissing&&t!==Qg)return!1;if("handler"!==t&&!(await this.checkCanDismiss(e,t)))return!1;const{presentingElement:i}=this;void 0!==i&&"ios"===sg(this)&&Mb(this.statusBarStyle),"undefined"!=typeof window&&this.keyboardOpenCallback&&(window.removeEventListener(lb,this.keyboardOpenCallback),this.keyboardOpenCallback=void 0),void 0!==this.currentTransition&&await this.currentTransition;const r=Ig.get(this)||[];this.currentTransition=Gg(this,e,t,"modalLeave",Bb,Fb,{presentingEl:i,currentBreakpoint:null!==(n=this.currentBreakpoint)&&void 0!==n?n:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint});const o=await this.currentTransition;if(o){const{delegate:e}=this.getDelegate();await kg(e,this.usersElement),Df((()=>this.el.classList.remove("show-modal"))),this.animation&&this.animation.destroy(),this.gesture&&this.gesture.destroy(),r.forEach((e=>e.destroy()))}return this.currentBreakpoint=void 0,this.currentTransition=void 0,this.animation=void 0,o}onDidDismiss(){return Zg(this.el,"ionModalDidDismiss")}onWillDismiss(){return Zg(this.el,"ionModalWillDismiss")}async setCurrentBreakpoint(e){if(!this.isSheetModal)return void Sg("setCurrentBreakpoint is only supported on sheet modals.");if(!this.breakpoints.includes(e))return void Sg(`Attempted to set invalid breakpoint value ${e}. Please double check that the breakpoint value is part of your defined breakpoints.`);const{currentBreakpoint:t,moveSheetToBreakpoint:n,canDismiss:i,breakpoints:r}=this;t!==e&&n&&(this.sheetTransition=n({breakpoint:e,breakpointOffset:1-t,canDismiss:void 0!==i&&!0!==i&&0===r[0]}),await this.sheetTransition,this.sheetTransition=void 0)}async getCurrentBreakpoint(){return this.currentBreakpoint}async moveToNextBreakpoint(){const{breakpoints:e,currentBreakpoint:t}=this;if(!e||null==t)return!1;const n=e.filter((e=>0!==e)),i=n.indexOf(t),r=n[(i+1)%n.length];return await this.setCurrentBreakpoint(r),!0}render(){const{handle:e,isSheetModal:t,presentingElement:n,htmlAttributes:i,handleBehavior:r,inheritedAttributes:o}=this,s=!1!==e&&t,a=sg(this),l=void 0!==n&&"ios"===a,c="cycle"===r;return bp(_p,Object.assign({"no-router":!0,tabindex:"-1"},i,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[a]:!0,"modal-default":!l&&!t,"modal-card":l,"modal-sheet":t,"overlay-hidden":!0},Dy(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle}),bp("ion-backdrop",{ref:e=>this.backdropEl=e,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),"ios"===a&&bp("div",{class:"modal-shadow"}),bp("div",Object.assign({role:"dialog"},o,{"aria-modal":"true",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:e=>this.wrapperEl=e}),s&&bp("button",{class:"modal-handle",tabIndex:c?0:-1,"aria-label":"Activate to adjust the size of the dialog overlaying the screen",onClick:c?this.onHandleClick:void 0,part:"handle"}),bp("slot",null)))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-card) .modal-wrapper,:host-context([dir=rtl]).modal-card .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-card) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-sheet) .modal-wrapper,:host-context([dir=rtl]).modal-sheet .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-sheet) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}',md:':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}'}}},[33,"ion-modal",{hasController:[4,"has-controller"],overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],breakpoints:[16],initialBreakpoint:[2,"initial-breakpoint"],backdropBreakpoint:[2,"backdrop-breakpoint"],handle:[4],handleBehavior:[1,"handle-behavior"],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],presentingElement:[16],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],keepContentsMounted:[4,"keep-contents-mounted"],canDismiss:[4,"can-dismiss"],presented:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64],setCurrentBreakpoint:[64],getCurrentBreakpoint:[64]}]),jb={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"},Vb=function(){"undefined"!=typeof customElements&&["ion-modal","ion-backdrop"].forEach((e=>{switch(e){case"ion-modal":customElements.get(e)||customElements.define(e,$b);break;case"ion-backdrop":customElements.get(e)||Ay()}}))},Ub=lf(class extends wf{constructor(){super(),this.__registerHost()}componentDidLoad(){Gb((async()=>{const e=Hm(window,"hybrid");if(Um.getBoolean("_testing")||ep((()=>t.import("./index9-legacy-129376aa.js"))).then((e=>e.startTapClick(Um))),Um.getBoolean("statusTap",e)&&ep((()=>t.import("./status-tap-legacy-f4e40044.js"))).then((e=>e.startStatusTap())),Um.getBoolean("inputShims",qb())){const e=Hm(window,"ios")?"ios":"android";ep((()=>t.import("./input-shims-legacy-048f9c28.js"))).then((t=>t.startInputShims(Um,e)))}const n=await ep((()=>Promise.resolve().then((()=>mg))));Um.getBoolean("hardwareBackButton",e)?n.startHardwareBackButton():n.blockHardwareBackButton(),"undefined"!=typeof window&&ep((()=>Promise.resolve().then((()=>kb)))).then((e=>e.startKeyboardAssist(window))),ep((()=>t.import("./focus-visible-legacy-b3e947fe.js"))).then((e=>this.focusVisible=e.startFocusVisible()))}))}async setFocus(e){this.focusVisible&&this.focusVisible.setFocus(e)}render(){const e=sg(this);return bp(_p,{class:{[e]:!0,"ion-page":!0,"force-statusbar-padding":Um.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return"html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html.plt-mobile ion-app [contenteditable]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}"}},[0,"ion-app",{setFocus:[64]}]),qb=()=>!(!Hm(window,"ios")||!Hm(window,"mobile"))||!(!Hm(window,"android")||!Hm(window,"mobileweb")),Gb=e=>{"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,32)},Wb=function(){"undefined"!=typeof customElements&&["ion-app"].forEach((e=>{"ion-app"===e&&(customElements.get(e)||customElements.define(e,Ub))}))},Hb=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Sp(this,"ionNavWillLoad",7),this.ionNavWillChange=Sp(this,"ionNavWillChange",3),this.ionNavDidChange=Sp(this,"ionNavDidChange",3),this.gestureOrAnimationInProgress=!1,this.mode=sg(this),this.delegate=void 0,this.animated=!0,this.animation=void 0,this.swipeHandler=void 0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(void 0!==this.swipeHandler)}async connectedCallback(){const e=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await ep((()=>t.import("./swipe-back-legacy-46a9e6f1.js")))).createSwipeBackGesture(this.el,(()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart()),(()=>e()),(e=>{var t;return null===(t=this.ani)||void 0===t?void 0:t.progressStep(e)}),((e,t,n)=>{if(this.ani){this.ani.onFinish((()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(e)}),{oneTimeCallback:!0});let i=e?-.001:.001;e?i+=Sm([0,0],[.32,.72],[0,1],[1,1],t)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),i+=Sm([0,0],[1,0],[.68,.28],[1,1],t)[0]),this.ani.progressEnd(e?1:0,i,n)}else this.gestureOrAnimationInProgress=!1})),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(e,t,n){const i=await this.lock();let r=!1;try{r=await this.transition(e,t,n)}catch(wT){console.error(wT)}return i(),r}async setRouteId(e,t,n,i){return{changed:await this.setRoot(e,t,{duration:"root"===n?0:void 0,direction:"back"===n?"back":"forward",animationBuilder:i}),element:this.activeEl}}async getRouteId(){const e=this.activeEl;return e?{id:e.tagName,element:e,params:this.activeParams}:void 0}async setRoot(e,t,n){if(this.activeComponent===e&&Jf(t,this.activeParams))return!1;const i=this.activeEl,r=await wg(this.delegate,this.el,e,["ion-page","ion-page-invisible"],t);return this.activeComponent=e,this.activeEl=r,this.activeParams=t,await this.commit(r,i,n),await kg(this.delegate,i),!0}async transition(e,t,n={}){if(t===e)return!1;this.ionNavWillChange.emit();const{el:i,mode:r}=this,o=this.animated&&Um.getBoolean("animated",!0),s=n.animationBuilder||this.animation||Um.get("navAnimation");return await cm(Object.assign(Object.assign({mode:r,animated:o,enteringEl:e,leavingEl:t,baseEl:i,deepWait:Bf(i),progressCallback:n.progressAnimation?e=>{void 0===e||this.gestureOrAnimationInProgress?this.ani=e:(this.gestureOrAnimationInProgress=!0,e.onFinish((()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)}),{oneTimeCallback:!0}),e.progressEnd(0,0,0))}:void 0},n),{animationBuilder:s})),this.ionNavDidChange.emit(),!0}async lock(){const e=this.waitPromise;let t;return this.waitPromise=new Promise((e=>t=e)),void 0!==e&&await e,t}render(){return bp("slot",null)}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}"}},[1,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]}]),Zb=function(){"undefined"!=typeof customElements&&["ion-router-outlet"].forEach((e=>{"ion-router-outlet"===e&&(customElements.get(e)||customElements.define(e,Hb))}))},Xb=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=Sp(this,"ionTabBarChanged",7),this.keyboardCtrl=null,this.keyboardVisible=!1,this.color=void 0,this.selectedTab=void 0,this.translucent=!1}selectedTabChanged(){void 0!==this.selectedTab&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentWillLoad(){this.selectedTabChanged()}async connectedCallback(){this.keyboardCtrl=await(async e=>{let t,n,i,r;const o=async()=>{const e=await pv.getResizeMode(),o=void 0===e?void 0:e.mode;t=()=>{void 0===r&&(r=mv(o)),i=!0,s(i,o)},n=()=>{i=!1,s(i,o)},null==Rf||Rf.addEventListener("keyboardWillShow",t),null==Rf||Rf.addEventListener("keyboardWillHide",n)},s=(t,n)=>{e&&e(t,a(n))},a=e=>{if(0===r||r===mv(e))return;const t=fv(e);return null!==t?new Promise((e=>{const n=new ResizeObserver((()=>{t.clientHeight===r&&(n.disconnect(),e())}));n.observe(t)})):void 0};return await o(),{init:o,destroy:()=>{null==Rf||Rf.removeEventListener("keyboardWillShow",t),null==Rf||Rf.removeEventListener("keyboardWillHide",n),t=n=void 0},isKeyboardVisible:()=>i}})((async(e,t)=>{!1===e&&void 0!==t&&await t,this.keyboardVisible=e}))}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}render(){const{color:e,translucent:t,keyboardVisible:n}=this,i=sg(this),r=n&&"top"!==this.el.getAttribute("slot");return bp(_p,{role:"tablist","aria-hidden":r?"true":null,class:Oy(e,{[i]:!0,"tab-bar-translucent":t,"tab-bar-hidden":r})},bp("slot",null))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.2))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, #666666));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",md:":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.07))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, #595959));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:56px}"}}},[33,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]}]),Kb=function(){"undefined"!=typeof customElements&&["ion-tab-bar"].forEach((e=>{"ion-tab-bar"===e&&(customElements.get(e)||customElements.define(e,Xb))}))},Jb=lf(class extends wf{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=Sp(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.onKeyUp=e=>{"Enter"!==e.key&&" "!==e.key||this.selectTab(e)},this.onClick=e=>{this.selectTab(e)},this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.layout=void 0,this.selected=!1,this.tab=void 0,this.target=void 0}onTabBarChanged(e){const t=e.target,n=this.el.parentElement;(e.composedPath().includes(n)||(null==t?void 0:t.contains(this.el)))&&(this.selected=this.tab===e.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},Nf(this.el,["aria-label"])),void 0===this.layout&&(this.layout=Um.get("tabButtonLayout","icon-top"))}selectTab(e){void 0!==this.tab&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),e.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:e,hasIcon:t,hasLabel:n,href:i,rel:r,target:o,layout:s,selected:a,tab:l,inheritedAttributes:c}=this,u=sg(this),d={download:this.download,href:i,rel:r,target:o};return bp(_p,{onClick:this.onClick,onKeyup:this.onKeyUp,id:void 0!==l?`tab-button-${l}`:null,class:{[u]:!0,"tab-selected":a,"tab-disabled":e,"tab-has-label":n,"tab-has-icon":t,"tab-has-label-only":n&&!t,"tab-has-icon-only":t&&!n,[`tab-layout-${s}`]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},bp("a",Object.assign({},d,{class:"button-native",part:"native",role:"tab","aria-selected":a?"true":null,"aria-disabled":e?"true":null,tabindex:e?"-1":void 0},c),bp("span",{class:"button-inner"},bp("slot",null)),"md"===u&&bp("ion-ripple-effect",{type:"unbounded"})))}get el(){return this}static get style(){return{ios:':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:30px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:calc(50% + 12px)}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 12px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 12px)}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:calc(50% + 35px)}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 35px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 35px)}}}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:calc(50% + 30px)}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 30px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 30px)}}}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}',md:':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:80%}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:80%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:80%}}}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}'}}},[33,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]),Yb=function(){"undefined"!=typeof customElements&&["ion-tab-button","ion-ripple-effect"].forEach((e=>{switch(e){case"ion-tab-button":customElements.get(e)||customElements.define(e,Jb);break;case"ion-ripple-effect":customElements.get(e)||Gy()}}))},Qb=!0,ex=!0,tx=!0,nx=!1,ix=!1;let rx,ox,sx,ax=!1,lx=!1,cx=!1,ux=!1,dx=null,hx=!1;const px="http://www.w3.org/1999/xlink",fx={},mx=e=>"object"==(e=typeof e)||"function"===e,gx=(e,t,...n)=>{let i=null,r=null,o=null,s=!1,a=!1;const l=[],c=t=>{for(let n=0;n<t.length;n++)i=t[n],Array.isArray(i)?c(i):null!=i&&"boolean"!=typeof i&&((s="function"!=typeof e&&!mx(i))&&(i=String(i)),s&&a?l[l.length-1].$text$+=i:l.push(s?yx(null,i):i),a=s)};if(c(n),t){t.key&&(r=t.key),t.name&&(o=t.name);{const e=t.className||t.class;e&&(t.class="object"!=typeof e?e:Object.keys(e).filter((t=>e[t])).join(" "))}}if("function"==typeof e)return e(null===t?{}:t,l,bx);const u=yx(e,null);return u.$attrs$=t,l.length>0&&(u.$children$=l),u.$key$=r,u.$name$=o,u},yx=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null};return n},vx={},bx={forEach:(e,t)=>e.map(xx).forEach(t),map:(e,t)=>e.map(xx).map(t).map(_x)},xx=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),_x=e=>{if("function"==typeof e.vtag){const t=Object.assign({},e.vattrs);return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),gx(e.vtag,t,...e.vchildren||[])}const t=yx(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},wx=new WeakMap,kx=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,i=t.$flags$,r=(t.$tagName$,()=>{}),o=((e,t,n,i)=>{var r;let o=Ex(t,n);const s=u_.get(o);if(e=11===e.nodeType?e:p_,s)if("string"==typeof s){e=e.head||e;let t,n=wx.get(e);if(n||wx.set(e,n=new Set),!n.has(o)){{t=p_.createElement("style"),t.innerHTML=s;const n=null!==(r=m_.$nonce$)&&void 0!==r?r:function(e){var t,n,i;return null!==(i=null===(n=null===(t=e.head)||void 0===t?void 0:t.querySelector('meta[name="csp-nonce"]'))||void 0===n?void 0:n.getAttribute("content"))&&void 0!==i?i:void 0}(p_);null!=n&&t.setAttribute("nonce",n),e.insertBefore(t,e.querySelector("link"))}n&&n.add(o)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s]);return o})(n.shadowRoot?n.shadowRoot:n.getRootNode(),t,e.$modeName$);10&i&&(n["s-sc"]=o,n.classList.add(o+"-h"),2&i&&n.classList.add(o+"-s")),r()},Ex=(e,t)=>"sc-"+(t&&32&e.$flags$?e.$tagName$+"-"+t:e.$tagName$),Sx=(e,t,n,i,r,o)=>{if(n!==i){let s=l_(e,t),a=t.toLowerCase();if("class"===t){const t=e.classList,r=Cx(n),o=Cx(i);t.remove(...r.filter((e=>e&&!o.includes(e)))),t.add(...o.filter((e=>e&&!r.includes(e))))}else if("style"===t){for(const t in n)i&&null!=i[t]||(t.includes("-")?e.style.removeProperty(t):e.style[t]="");for(const t in i)n&&i[t]===n[t]||(t.includes("-")?e.style.setProperty(t,i[t]):e.style[t]=i[t])}else if("key"===t);else if("ref"===t)i&&i(e);else if(e.__lookupSetter__(t)||"o"!==t[0]||"n"!==t[1]){const l=mx(i);if((s||l&&null!==i)&&!r)try{if(e.tagName.includes("-"))e[t]=i;else{const r=null==i?"":i;"list"===t?s=!1:null!=n&&e[t]==r||(e[t]=r)}}catch(wT){}let c=!1;a!==(a=a.replace(/^xlink\:?/,""))&&(t=a,c=!0),null==i||!1===i?!1===i&&""!==e.getAttribute(t)||(c?e.removeAttributeNS(px,t):e.removeAttribute(t)):(!s||4&o||r)&&!l&&(i=!0===i?"":i,c?e.setAttributeNS(px,t,i):e.setAttribute(t,i))}else t="-"===t[2]?t.slice(3):l_(h_,a)?a.slice(2):a[2]+t.slice(3),n&&m_.rel(e,t,n,!1),i&&m_.ael(e,t,i,!1)}},Tx=/\s/,Cx=e=>e?e.split(Tx):[],Mx=(e,t,n,i)=>{const r=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,o=e&&e.$attrs$||fx,s=t.$attrs$||fx;for(i in o)i in s||Sx(r,i,o[i],void 0,n,t.$flags$);for(i in s)Sx(r,i,o[i],s[i],n,t.$flags$)},Ix=(e,t,n,i)=>{const r=t.$children$[n];let o,s,a,l=0;if(ax||(cx=!0,"slot"===r.$tag$&&(rx&&i.classList.add(rx+"-s"),r.$flags$|=r.$children$?2:1)),null!==r.$text$)o=r.$elm$=p_.createTextNode(r.$text$);else if(1&r.$flags$)o=r.$elm$=p_.createTextNode("");else{if(ux||(ux="svg"===r.$tag$),o=r.$elm$=p_.createElementNS(ux?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&r.$flags$?"slot-fb":r.$tag$),ux&&"foreignObject"===r.$tag$&&(ux=!1),Mx(null,r,ux),(e=>null!=e)(rx)&&o["s-si"]!==rx&&o.classList.add(o["s-si"]=rx),r.$children$)for(l=0;l<r.$children$.length;++l)s=Ix(e,r,l,o),s&&o.appendChild(s);"svg"===r.$tag$?ux=!1:"foreignObject"===o.tagName&&(ux=!0)}return o["s-hn"]=sx,3&r.$flags$&&(o["s-sr"]=!0,o["s-cr"]=ox,o["s-sn"]=r.$name$||"",a=e&&e.$children$&&e.$children$[n],a&&a.$tag$===r.$tag$&&e.$elm$&&Ax(e.$elm$,!1)),o},Ax=(e,t)=>{m_.$flags$|=1;const n=e.childNodes;for(let i=n.length-1;i>=0;i--){const e=n[i];e["s-hn"]!==sx&&e["s-ol"]&&(zx(e).insertBefore(e,Rx(e)),e["s-ol"].remove(),e["s-ol"]=void 0,cx=!0),t&&Ax(e,t)}m_.$flags$&=-2},Px=(e,t,n,i,r,o)=>{let s,a=e["s-cr"]&&e["s-cr"].parentNode||e;for(a.shadowRoot&&a.tagName===sx&&(a=a.shadowRoot);r<=o;++r)i[r]&&(s=Ix(null,n,r,e),s&&(i[r].$elm$=s,a.insertBefore(s,Rx(t))))},Ox=(e,t,n,i,r)=>{for(;t<=n;++t)(i=e[t])&&(r=i.$elm$,jx(i),lx=!0,r["s-ol"]?r["s-ol"].remove():Ax(r,!0),r.remove())},Dx=(e,t)=>e.$tag$===t.$tag$&&("slot"===e.$tag$?e.$name$===t.$name$:e.$key$===t.$key$),Rx=e=>e&&e["s-ol"]||e,zx=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,Lx=(e,t)=>{const n=t.$elm$=e.$elm$,i=e.$children$,r=t.$children$,o=t.$tag$,s=t.$text$;let a;null===s?(ux="svg"===o||"foreignObject"!==o&&ux,"slot"===o||Mx(e,t,ux),null!==i&&null!==r?((e,t,n,i)=>{let r,o,s=0,a=0,l=0,c=0,u=t.length-1,d=t[0],h=t[u],p=i.length-1,f=i[0],m=i[p];for(;s<=u&&a<=p;)if(null==d)d=t[++s];else if(null==h)h=t[--u];else if(null==f)f=i[++a];else if(null==m)m=i[--p];else if(Dx(d,f))Lx(d,f),d=t[++s],f=i[++a];else if(Dx(h,m))Lx(h,m),h=t[--u],m=i[--p];else if(Dx(d,m))"slot"!==d.$tag$&&"slot"!==m.$tag$||Ax(d.$elm$.parentNode,!1),Lx(d,m),e.insertBefore(d.$elm$,h.$elm$.nextSibling),d=t[++s],m=i[--p];else if(Dx(h,f))"slot"!==d.$tag$&&"slot"!==m.$tag$||Ax(h.$elm$.parentNode,!1),Lx(h,f),e.insertBefore(h.$elm$,d.$elm$),h=t[--u],f=i[++a];else{for(l=-1,c=s;c<=u;++c)if(t[c]&&null!==t[c].$key$&&t[c].$key$===f.$key$){l=c;break}l>=0?(o=t[l],o.$tag$!==f.$tag$?r=Ix(t&&t[a],n,l,e):(Lx(o,f),t[l]=void 0,r=o.$elm$),f=i[++a]):(r=Ix(t&&t[a],n,a,e),f=i[++a]),r&&zx(d.$elm$).insertBefore(r,Rx(d.$elm$))}s>u?Px(e,null==i[p+1]?null:i[p+1].$elm$,n,i,a,p):a>p&&Ox(t,s,u)})(n,i,t,r):null!==r?(null!==e.$text$&&(n.textContent=""),Px(n,null,t,r,0,r.length-1)):null!==i&&Ox(i,0,i.length-1),ux&&"svg"===o&&(ux=!1)):(a=n["s-cr"])?a.parentNode.textContent=s:e.$text$!==s&&(n.data=s)},Bx=e=>{const t=e.childNodes;let n,i,r,o,s,a;for(i=0,r=t.length;i<r;i++)if(n=t[i],1===n.nodeType){if(n["s-sr"])for(s=n["s-sn"],n.hidden=!1,o=0;o<r;o++)if(a=t[o].nodeType,t[o]["s-hn"]!==n["s-hn"]||""!==s){if(1===a&&s===t[o].getAttribute("slot")){n.hidden=!0;break}}else if(1===a||3===a&&""!==t[o].textContent.trim()){n.hidden=!0;break}Bx(n)}},Nx=[],Fx=e=>{let t,n,i,r,o,s,a=0;const l=e.childNodes,c=l.length;for(;a<c;a++){if(t=l[a],t["s-sr"]&&(n=t["s-cr"])&&n.parentNode)for(i=n.parentNode.childNodes,r=t["s-sn"],s=i.length-1;s>=0;s--)n=i[s],n["s-cn"]||n["s-nr"]||n["s-hn"]===t["s-hn"]||($x(n,r)?(o=Nx.find((e=>e.$nodeToRelocate$===n)),lx=!0,n["s-sn"]=n["s-sn"]||r,o?o.$slotRefNode$=t:Nx.push({$slotRefNode$:t,$nodeToRelocate$:n}),n["s-sr"]&&Nx.map((e=>{$x(e.$nodeToRelocate$,n["s-sn"])&&(o=Nx.find((e=>e.$nodeToRelocate$===n)),o&&!e.$slotRefNode$&&(e.$slotRefNode$=o.$slotRefNode$))}))):Nx.some((e=>e.$nodeToRelocate$===n))||Nx.push({$nodeToRelocate$:n}));1===t.nodeType&&Fx(t)}},$x=(e,t)=>1===e.nodeType?null===e.getAttribute("slot")&&""===t||e.getAttribute("slot")===t:e["s-sn"]===t||""===t,jx=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(jx)},Vx=(e,t)=>{const n=e.$hostElement$,i=e.$cmpMeta$,r=e.$vnode$||yx(null,null),o=(s=t)&&s.$tag$===vx?t:gx(null,null,t);var s;if(sx=n.tagName,i.$attrsToReflect$&&(o.$attrs$=o.$attrs$||{},i.$attrsToReflect$.map((([e,t])=>o.$attrs$[t]=n[e]))),o.$tag$=null,o.$flags$|=4,e.$vnode$=o,o.$elm$=r.$elm$=n.shadowRoot||n,rx=n["s-sc"],ox=n["s-cr"],ax=0!=(1&i.$flags$),lx=!1,Lx(r,o),m_.$flags$|=1,cx){let e,t,n,i,r,s;Fx(o.$elm$);let a=0;for(;a<Nx.length;a++)e=Nx[a],t=e.$nodeToRelocate$,t["s-ol"]||(n=p_.createTextNode(""),n["s-nr"]=t,t.parentNode.insertBefore(t["s-ol"]=n,t));for(a=0;a<Nx.length;a++)if(e=Nx[a],t=e.$nodeToRelocate$,e.$slotRefNode$){for(i=e.$slotRefNode$.parentNode,r=e.$slotRefNode$.nextSibling,n=t["s-ol"];n=n.previousSibling;)if(s=n["s-nr"],s&&s["s-sn"]===t["s-sn"]&&i===s.parentNode&&(s=s.nextSibling,!s||!s["s-nr"])){r=s;break}(!r&&i!==t.parentNode||t.nextSibling!==r)&&t!==r&&(!t["s-hn"]&&t["s-ol"]&&(t["s-hn"]=t["s-ol"].parentNode.nodeName),i.insertBefore(t,r))}else 1===t.nodeType&&(t.hidden=!0)}lx&&Bx(o.$elm$),m_.$flags$&=-2,Nx.length=0},Ux=(e,t)=>(e.$flags$|=16,e.$ancestorComponent$,E_((()=>qx(e,t)))),qx=(e,t)=>{const n=e.$hostElement$,i=(e.$cmpMeta$.$tagName$,()=>{}),r=n;let o;return o=Zx(r,t?"componentWillLoad":"componentWillUpdate"),o=Xx(o,(()=>Zx(r,"componentWillRender"))),i(),Xx(o,(()=>Gx(e,r,t)))},Gx=async(e,t,n)=>{const i=e.$hostElement$,r=(e.$cmpMeta$.$tagName$,()=>{});i["s-rc"],n&&kx(e);const o=(e.$cmpMeta$.$tagName$,()=>{});Wx(e,t,i),o(),r(),Hx(e)},Wx=(e,t,n)=>{try{dx=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(Qb||ex)&&(tx||ex)&&(nx||Vx(e,t))}catch(wT){c_(wT,e.$hostElement$)}return dx=null,null},Hx=e=>{e.$cmpMeta$.$tagName$;const t=()=>{},n=e.$hostElement$;e.$ancestorComponent$,Zx(n,"componentDidRender"),64&e.$flags$?(Zx(n,"componentDidUpdate"),t()):(e.$flags$|=64,Zx(n,"componentDidLoad"),t())},Zx=(e,t,n)=>{if(e&&e[t])try{return e[t](n)}catch(wT){c_(wT)}},Xx=(e,t)=>e&&e.then?e.then(t):t(),Kx=(e,t,n,i)=>{const r=s_(e),o=e,s=r.$instanceValues$.get(t),a=r.$flags$,l=o;var c,u;c=n,u=i.$members$[t][0],n=null==c||mx(c)?c:4&u?"false"!==c&&(""===c||!!c):2&u?parseFloat(c):1&u?String(c):c;const d=Number.isNaN(s)&&Number.isNaN(n);if(n!==s&&!d){if(r.$instanceValues$.set(t,n),i.$watchers$&&128&a){const e=i.$watchers$[t];e&&e.map((e=>{try{l[e](n,s,t)}catch(wT){c_(wT,o)}}))}if(2==(18&a)){if(l.componentShouldUpdate&&!1===l.componentShouldUpdate(n,s,t))return;Ux(r,!1)}}},Jx=(e,t,n)=>{if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const n=Object.entries(t.$members$),i=e.prototype;n.map((([e,[n]])=>{(31&n||32&n)&&Object.defineProperty(i,e,{get(){return t=e,s_(this).$instanceValues$.get(t);var t},set(n){Kx(this,e,n,t)},configurable:!0,enumerable:!0})}));{const r=new Map;i.attributeChangedCallback=function(e,t,n){m_.jmp((()=>{const t=r.get(e);if(this.hasOwnProperty(t))n=this[t],delete this[t];else if(i.hasOwnProperty(t)&&"number"==typeof this[t]&&this[t]==n)return;this[t]=(null!==n||"boolean"!=typeof this[t])&&n}))},e.observedAttributes=n.filter((([e,t])=>15&t[0])).map((([e,n])=>{const i=n[1]||e;return r.set(i,e),512&n[0]&&t.$attrsToReflect$.push([e,i]),i}))}}return e},Yx=async(e,t,n,i,r)=>{if(0==(32&t.$flags$)&&(r=e.constructor,t.$flags$|=32,customElements.whenDefined(n.$tagName$).then((()=>t.$flags$|=128)),r.style)){let i=r.style;"string"!=typeof i&&(i=i[t.$modeName$=(e=>d_.map((t=>t(e))).find((e=>!!e)))(e)]);const o=Ex(n,t.$modeName$);if(!u_.has(o)){const e=(n.$tagName$,()=>{});((e,t,n)=>{let i=u_.get(e);y_&&n?(i=i||new CSSStyleSheet,"string"==typeof i?i=t:i.replaceSync(t)):i=t,u_.set(e,i)})(o,i,!!(1&n.$flags$)),e()}}t.$ancestorComponent$,Ux(t,!0)},Qx=e=>{const t=e["s-cr"]=p_.createComment("");t["s-cn"]=!0,e.insertBefore(t,e.firstChild)},e_=(e,t)=>{const n={$flags$:t[0],$tagName$:t[1]};n.$members$=t[2],n.$listeners$=t[3],n.$watchers$=e.$watchers$,n.$attrsToReflect$=[];const i=e.prototype.connectedCallback,r=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){a_(this,n)},connectedCallback(){(e=>{if(0==(1&m_.$flags$)){const t=s_(e),n=t.$cmpMeta$,i=(n.$tagName$,()=>{});1&t.$flags$?(t_(e,t,n.$listeners$),t.$lazyInstance$):(t.$flags$|=1,12&n.$flags$&&Qx(e),n.$members$&&Object.entries(n.$members$).map((([t,[n]])=>{if(31&n&&e.hasOwnProperty(t)){const n=e[t];delete e[t],e[t]=n}})),Yx(e,t,n)),i()}})(this),i&&i.call(this)},disconnectedCallback(){(e=>{if(0==(1&m_.$flags$)){const t=s_(e);t.$rmListeners$&&(t.$rmListeners$.map((e=>e())),t.$rmListeners$=void 0)}})(this),r&&r.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(16&n.$flags$)})}}),e.is=n.$tagName$,Jx(e,n)},t_=(e,t,n,i)=>{n&&n.map((([n,i,r])=>{const o=i_(e,n),s=n_(t,r),a=r_(n);m_.ael(o,i,s,a),(t.$rmListeners$=t.$rmListeners$||[]).push((()=>m_.rel(o,i,s,a)))}))},n_=(e,t)=>n=>{try{ix||e.$hostElement$[t](n)}catch(wT){c_(wT)}},i_=(e,t)=>4&t?p_:8&t?h_:16&t?p_.body:e,r_=e=>g_?{passive:0!=(1&e),capture:0!=(2&e)}:0!=(2&e),o_=new WeakMap,s_=e=>o_.get(e),a_=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return t_(e,n,t.$listeners$),o_.set(e,n)},l_=(e,t)=>t in e,c_=(e,t)=>(0,console.error)(e,t),u_=new Map,d_=[],h_="undefined"!=typeof window?window:{},p_=h_.document||{head:{}},f_=h_.HTMLElement||class{},m_={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,i)=>e.addEventListener(t,n,i),rel:(e,t,n,i)=>e.removeEventListener(t,n,i),ce:(e,t)=>new CustomEvent(e,t)},g_=(()=>{let e=!1;try{p_.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch(wT){}return e})(),y_=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch(wT){}return!1})(),v_=[],b_=[],x_=(e,t)=>n=>{e.push(n),hx||(hx=!0,t&&4&m_.$flags$?k_(w_):m_.raf(w_))},__=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(wT){c_(wT)}e.length=0},w_=()=>{__(v_),__(b_),(hx=v_.length>0)&&m_.raf(w_)},k_=e=>(e=>Promise.resolve(e))().then(e),E_=x_(b_,!0);let S_;const T_=e=>{const t=(()=>{if("undefined"==typeof window)return new Map;if(!S_){const e=window;e.Ionicons=e.Ionicons||{},S_=e.Ionicons.map=e.Ionicons.map||new Map}return S_})().get(e);return t||(e=>{const t=new URL(e,m_.$resourcesUrl$);return t.origin!==h_.location.origin?t.href:t.pathname})(`svg/${e}.svg`)},C_=(e,t,n,i,r)=>(n="ios"===(n&&P_(n))?"ios":"md",i&&"ios"===n?e=P_(i):r&&"md"===n?e=P_(r):(e||!t||I_(t)||(e=t),A_(e)&&(e=P_(e))),A_(e)&&""!==e.trim()?""!==e.replace(/[a-z]|-|\d/gi,"")?null:e:null),M_=e=>A_(e)&&(e=e.trim(),I_(e))?e:null,I_=e=>e.length>0&&/(\/|\.)/.test(e),A_=e=>"string"==typeof e,P_=e=>e.toLowerCase(),O_=e=>{if(1===e.nodeType){if("script"===e.nodeName.toLowerCase())return!1;for(let t=0;t<e.attributes.length;t++){const n=e.attributes[t].name;if(A_(n)&&0===n.toLowerCase().indexOf("on"))return!1}for(let t=0;t<e.childNodes.length;t++)if(!O_(e.childNodes[t]))return!1}return!0},D_=new Map,R_=new Map;let z_;const L_=(e,t)=>{let n=R_.get(e);if(!n){if("undefined"==typeof fetch||"undefined"==typeof document)return D_.set(e,""),Promise.resolve();if((e=>e.startsWith("data:image/svg+xml"))(e)&&(e=>-1!==e.indexOf(";utf8,"))(e)){z_||(z_=new DOMParser);const t=z_.parseFromString(e,"text/html").querySelector("svg");return t&&D_.set(e,t.outerHTML),Promise.resolve()}n=fetch(e).then((n=>{if(n.ok)return n.text().then((n=>{n&&!1!==t&&(n=(e=>{const t=document.createElement("div");t.innerHTML=e;for(let i=t.childNodes.length-1;i>=0;i--)"svg"!==t.childNodes[i].nodeName.toLowerCase()&&t.removeChild(t.childNodes[i]);const n=t.firstElementChild;if(n&&"svg"===n.nodeName.toLowerCase()){const e=n.getAttribute("class")||"";if(n.setAttribute("class",(e+" s-ion-icon").trim()),O_(n))return t.innerHTML}return""})(n)),D_.set(e,n||"")}));D_.set(e,"")})),R_.set(e,n)}return n},B_=e_(class extends f_{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.isVisible=!1,this.mode=N_(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=((e,t=[])=>{const n={};return t.forEach((t=>{e.hasAttribute(t)&&(null!==e.getAttribute(t)&&(n[t]=e.getAttribute(t)),e.removeAttribute(t))})),n})(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",(()=>{this.isVisible=!0,this.loadIcon()}))}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,t,n){if(this.lazy&&"undefined"!=typeof window&&window.IntersectionObserver){const i=this.io=new window.IntersectionObserver((e=>{e[0].isIntersecting&&(i.disconnect(),this.io=void 0,n())}),{rootMargin:t});i.observe(e)}else n()}loadIcon(){if(this.isVisible){const e=(e=>{let t=M_(e.src);if(t)return t;if(t=C_(e.name,e.icon,e.mode,e.ios,e.md),t)return T_(t);if(e.icon){if(t=M_(e.icon),t)return t;if(t=M_(e.icon[e.mode]),t)return t}return null})(this);e&&(D_.has(e)?this.svgContent=D_.get(e):L_(e,this.sanitize).then((()=>this.svgContent=D_.get(e))))}this.iconName=C_(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:e,iconName:t,inheritedAttributes:n,el:i}=this,r=this.mode||"md",o=!!t&&(t.includes("arrow")||t.includes("chevron"))&&!1!==e,s=e||o;return gx(vx,Object.assign({role:"img",class:Object.assign(Object.assign({[r]:!0},F_(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":s,"icon-rtl":s&&(a=i,a&&""!==a.dir?"rtl"===a.dir.toLowerCase():"rtl"===(null===document||void 0===document?void 0:document.dir.toLowerCase()))})},n),this.svgContent?gx("div",{class:"icon-inner",innerHTML:this.svgContent}):gx("div",{class:"icon-inner"}));var a}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:18px !important}:host(.icon-large){font-size:32px !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}"}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]}]),N_=()=>"undefined"!=typeof document&&document.documentElement.getAttribute("mode")||"md",F_=e=>e?{"ion-color":!0,[`ion-color-${e}`]:!0}:null,$_=function(){"undefined"!=typeof customElements&&["ion-icon"].forEach((e=>{"ion-icon"===e&&(customElements.get(e)||customElements.define(e,B_))}))},j_=U.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{}}),V_=U.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:e=>{"undefined"!=typeof window&&("string"==typeof e?window.location.pathname=e:window.history.back())},navigate:e=>{"undefined"!=typeof window&&(window.location.pathname=e)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(e,t)=>{"undefined"!=typeof window&&(window.location.pathname=t)},resetTab:(e,t)=>{"undefined"!=typeof window&&(window.location.pathname=t)}}),U_=e=>e.toLowerCase().split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(""),q_=e=>e.replace(/([A-Z])/g,(e=>`-${e[0].toLowerCase()}`)),G_=(e,t,n={})=>{if(e instanceof Element){const i=W_(e.classList,t,n);""!==i&&(e.className=i),Object.keys(t).forEach((n=>{if("children"!==n&&"style"!==n&&"ref"!==n&&"class"!==n&&"className"!==n&&"forwardedRef"!==n)if(0===n.indexOf("on")&&n[2]===n[2].toUpperCase()){const i=n.substring(2),r=i[0].toLowerCase()+i.substring(1);H_(r)||Z_(e,r,t[n])}else e[n]=t[n],"string"==typeof t[n]&&e.setAttribute(q_(n),t[n])}))}},W_=(e,t,n)=>{const i=t.className||t.class,r=n.className||n.class,o=X_(e),s=X_(i?i.split(" "):[]),a=X_(r?r.split(" "):[]),l=[];return o.forEach((e=>{s.has(e)?(l.push(e),s.delete(e)):a.has(e)||l.push(e)})),s.forEach((e=>l.push(e))),l.join(" ")},H_=e=>{if("undefined"==typeof document)return!0;{const t="on"+(e=>"doubleclick"===e?"dblclick":e)(e);let n=t in document;if(!n){const e=document.createElement("div");e.setAttribute(t,"return;"),n="function"==typeof e[t]}return n}},Z_=(e,t,n)=>{const i=e.__events||(e.__events={}),r=i[t];r&&e.removeEventListener(t,r),e.addEventListener(t,i[t]=function(e){n&&n.call(this,e)})},X_=e=>{const t=new Map;return e.forEach((e=>t.set(e,e))),t},K_=(...e)=>t=>{e.forEach((e=>{((e,t)=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})(e,t)}))},J_=(e,t,n,i)=>{void 0!==i&&i();const r=U_(e),o=class extends U.Component{constructor(e){super(e),this.setComponentElRef=e=>{this.componentEl=e}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(e){G_(this.componentEl,this.props,e)}render(){const t=this.props,{children:i,forwardedRef:r,style:o,className:s,ref:a}=t,l=ry(t,["children","forwardedRef","style","className","ref"]);let c=Object.keys(l).reduce(((e,t)=>{const n=l[t];if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const i=t.substring(2).toLowerCase();"undefined"!=typeof document&&H_(i)&&(e[t]=n)}else{const i=typeof n;"string"!==i&&"boolean"!==i&&"number"!==i||(e[q_(t)]=n)}return e}),{});n&&(c=n(this.props,c));const u=Object.assign(Object.assign({},c),{ref:K_(r,this.setComponentElRef),style:o});return V.createElement(e,u,i)}static get displayName(){return r}};return t&&(o.contextType=t),((e,t)=>{const n=(t,n)=>U.createElement(e,Object.assign({},t,{forwardedRef:n}));return n.displayName=t,U.forwardRef(n)})(o,r)},Y_=J_("ion-avatar",void 0,void 0,My),Q_=J_("ion-buttons",void 0,void 0,By),ew=J_("ion-content",void 0,void 0,Jy),tw=J_("ion-fab",void 0,void 0,nv),nw=J_("ion-header",void 0,void 0,Ev),iw=J_("ion-input",void 0,void 0,Ov),rw=J_("ion-label",void 0,void 0,Dv),ow=J_("ion-menu",void 0,void 0,jv),sw=J_("ion-menu-toggle",void 0,void 0,Uv),aw=J_("ion-spinner",void 0,void 0,Xv),lw=(e,t)=>{const n=(t,n)=>U.createElement(e,Object.assign({},t,{forwardedRef:n}));return n.displayName=t,U.forwardRef(n)},cw=e=>Hm(window,e),uw=()=>{if("undefined"!=typeof window){const e=window.Ionic;if(e&&e.config)return e.config}return null},dw=(e,t)=>{((e,t)=>{void 0===t||"undefined"==typeof customElements||customElements.get(e)||customElements.define(e,t)})(e,t);const n=U_(e),i=class extends U.Component{constructor(e){super(e),this.handleClick=e=>{const{routerLink:t,routerDirection:n,routerOptions:i,routerAnimation:r}=this.props;void 0!==t&&(e.preventDefault(),this.context.navigate(t,n,void 0,r,i))},this.ref=U.createRef(),this.stableMergedRefs=K_(this.ref,this.props.forwardedRef)}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(e){const t=this.ref.current;G_(t,this.props,e)}render(){const t=this.props,{children:n,forwardedRef:i,style:r,className:o,ref:s}=t,a=ry(t,["children","forwardedRef","style","className","ref"]),l=Object.keys(a).reduce(((e,t)=>{if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const n=t.substring(2).toLowerCase();H_(n)&&(e[t]=a[t])}else["string","boolean","number"].includes(typeof a[t])&&(e[q_(t)]=a[t]);return e}),{}),c=Object.assign(Object.assign({},l),{ref:this.stableMergedRefs,style:r});if(this.props.routerLink&&!this.props.href&&(c.href=this.props.routerLink),c.onClick){const e=c.onClick;c.onClick=t=>{e(t),t.defaultPrevented||this.handleClick(t)}}else c.onClick=this.handleClick;return V.createElement(e,c,n)}static get displayName(){return n}static get contextType(){return V_}};return lw(i,n)},hw=dw("ion-button",Kv),pw=dw("ion-card",Jv),fw=dw("ion-fab-button",Qv),mw=dw("ion-item",eb),gw=(e,t)=>{const n=e.__events||(e.__events={}),i=n[t];i&&(e.removeEventListener(t,i),n[t]=void 0)},yw=(e,t,n)=>{t&&t();const i=U_(e),r=class extends U.Component{constructor(e){super(e),this.handleIonMount=()=>{this.setState({isOpen:!0})},this.handleWillPresent=e=>{this.setState({isOpen:!0}),this.props.onWillPresent&&this.props.onWillPresent(e)},this.handleDidDismiss=e=>{const t=this.wrapperRef.current,n=this.ref.current;t&&n&&(n.append(t),this.setState({isOpen:!1})),this.props.onDidDismiss&&this.props.onDidDismiss(e)},this.ref=U.createRef(),this.stableMergedRefs=K_(this.ref,this.props.forwardedRef),this.state={isOpen:!1},this.wrapperRef=U.createRef()}componentDidMount(){var e,t,n;this.componentDidUpdate(this.props),null===(e=this.ref.current)||void 0===e||e.addEventListener("ionMount",this.handleIonMount),null===(t=this.ref.current)||void 0===t||t.addEventListener("willPresent",this.handleWillPresent),null===(n=this.ref.current)||void 0===n||n.addEventListener("didDismiss",this.handleDidDismiss)}componentDidUpdate(e){const t=this.ref.current;G_(t,this.props,e)}componentWillUnmount(){const e=this.ref.current;e&&this.state.isOpen&&(e.removeEventListener("didDismiss",this.handleDidDismiss),e.remove(),((e,t)=>{e instanceof Element&&Object.keys(t).forEach((t=>{if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const n=t.substring(2),i=n[0].toLowerCase()+n.substring(1);H_(i)||gw(e,i)}}))})(e,this.props))}render(){const t=this.props,{children:i,forwardedRef:r,style:o,className:s,ref:a}=t,l=ry(t,["children","forwardedRef","style","className","ref"]),c=Object.keys(l).reduce(((e,t)=>{if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){const n=t.substring(2).toLowerCase();H_(n)&&(e[t]=l[t])}else["string","boolean","number"].includes(typeof l[t])&&(e[q_(t)]=l[t]);return e}),{}),u=Object.assign(Object.assign({},c),{ref:this.stableMergedRefs,style:o});return V.createElement("template",{},V.createElement(e,u,this.state.isOpen||this.props.keepContentsMounted?V.createElement("div",{ref:this.wrapperRef,className:n?`${vw} ion-page`:vw},i):null))}static get displayName(){return i}};return lw(r,i)},vw="ion-delegate-host",bw=yw("ion-modal",Vb,!0),xw=U.createContext({addOverlay:()=>{},removeOverlay:()=>{}}),_w=({onAddOverlay:e,onRemoveOverlay:t})=>{const[n,i]=V.useState({}),r=V.useRef({});r.current=n,V.useEffect((()=>{e(o),t(s)}),[]);const o=(e,t,n)=>{const o=Object.assign({},r.current);o[e]={component:t,containerElement:n},i(o)},s=e=>{const t=Object.assign({},r.current);delete t[e],i(t)},a=Object.keys(n);return U.createElement(U.Fragment,null,a.map((e=>{const t=n[e];return cd.createPortal(t.component,t.containerElement,`overlay-${e}`)})))},ww=J_("ion-tab-button",void 0,void 0,Yb),kw=J_("ion-tab-bar",void 0,void 0,Kb),Ew=J_("ion-router-outlet",void 0,void 0,Zb),Sw=J_("ion-app",void 0,void 0,Wb),Tw=J_("ion-icon",void 0,void 0,$_),Cw=(()=>class extends U.Component{constructor(e){super(e),this.ionContext={addOverlay:(e,t,n)=>{this.addOverlayCallback&&this.addOverlayCallback(e,t,n)},removeOverlay:e=>{this.removeOverlayCallback&&this.removeOverlayCallback(e)}}}render(){return U.createElement(xw.Provider,{value:this.ionContext},U.createElement(Sw,Object.assign({},this.props),this.props.children),U.createElement(_w,{onAddOverlay:e=>{this.addOverlayCallback=e},onRemoveOverlay:e=>{this.removeOverlayCallback=e}}))}static get displayName(){return"IonApp"}})(),Mw=U.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class Iw extends U.PureComponent{constructor(e){super(e),this.ionPageElementRef=U.createRef(),this.stableMergedRefs=K_(this.ionPageElementRef,this.props.forwardedRef)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const e=this.props,{className:t,children:n,routeInfo:i,forwardedRef:r}=e,o=ry(e,["className","children","routeInfo","forwardedRef"]);return U.createElement(j_.Consumer,null,(e=>(this.ionLifeCycleContext=e,U.createElement("div",Object.assign({className:t?`${t} ion-page`:"ion-page",ref:this.stableMergedRefs},o),n))))}static get contextType(){return Mw}}class Aw extends U.Component{constructor(e){super(e)}render(){const e=this.props,{className:t,children:n,forwardedRef:i}=e,r=ry(e,["className","children","forwardedRef"]);return this.context.hasIonicRouter()?U.createElement(Iw,Object.assign({className:t?`${t}`:"",routeInfo:this.context.routeInfo,forwardedRef:i},r),n):U.createElement("div",Object.assign({className:t?`ion-page ${t}`:"ion-page",ref:i},r),n)}static get displayName(){return"IonPage"}static get contextType(){return V_}}const Pw=lw(Aw,"IonPage"),Ow=J_("ion-nav",void 0,void 0,Zv);lw((e=>{var{children:t,forwardedRef:n}=e,i=ry(e,["children","forwardedRef"]);const[r,o]=V.useState([]),s=e=>o((t=>[...t,e])),a=e=>o((t=>t.filter((t=>t!==e)))),l=V.useMemo((()=>((e,t)=>{const n=new WeakMap;return{attachViewToDom:async(t,i,r,o)=>{const s=document.createElement("div");o&&s.classList.add(...o),t.appendChild(s);const a=i(r),l=ld.createPortal(a,s);return n.set(s,l),e(l),Promise.resolve(s)},removeViewFromDom:(e,i)=>{const r=n.get(i);return r&&t(r),i.remove(),Promise.resolve()}}})(s,a)),[]);return U.createElement(Ow,Object.assign({delegate:l,ref:n},i),r)}),"IonNav");const Dw=U.createContext({activeTab:void 0,selectTab:()=>!1}),Rw="undefined"!=typeof HTMLElement?HTMLElement:class{};class zw extends U.Component{constructor(e){super(e),this.outletIsReady=!1}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||Lf(this.ionRouterOutlet,(()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)})),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const e=this.props,{StackManager:t,children:n,routeInfo:i}=e,r=ry(e,["StackManager","children","routeInfo"]);return U.createElement(j_.Consumer,null,(e=>(this.ionLifeCycleContext=e,U.createElement(t,{routeInfo:i},U.createElement(Ew,Object.assign({setRef:e=>this.ionRouterOutlet=e},r),n)))))}static get contextType(){return Mw}}class Lw extends U.Component{constructor(e){super(e)}render(){const e=this.context.getStackManager(),t=this.props,{children:n,forwardedRef:i}=t,r=ry(t,["children","forwardedRef"]);return this.context.hasIonicRouter()?r.ionPage?U.createElement(zw,Object.assign({StackManager:e,routeInfo:this.context.routeInfo},r),n):U.createElement(e,{routeInfo:this.context.routeInfo},U.createElement(Ew,Object.assign({},r,{forwardedRef:i}),n)):U.createElement(Ew,Object.assign({ref:i},this.props),this.props.children)}static get contextType(){return V_}}const Bw=lw(Lw,"IonRouterOutlet"),Nw=(()=>class extends U.Component{constructor(e){super(e),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const e=ry(this.props,["onClick"]);return U.createElement(ww,Object.assign({onIonTabButtonClick:this.handleIonTabButtonClick},e))}static get displayName(){return"IonTabButton"}})();class Fw extends U.PureComponent{constructor(e){super(e),this.setActiveTabOnContext=e=>{};const t={};U.Children.forEach(e.children,(n=>{var i,r,o,s;null!=n&&"object"==typeof n&&n.props&&(n.type===Nw||n.type.isTabButton)&&(t[n.props.tab]={originalHref:n.props.href,currentHref:n.props.href,originalRouteOptions:n.props.href===(null===(i=e.routeInfo)||void 0===i?void 0:i.pathname)?null===(r=e.routeInfo)||void 0===r?void 0:r.routeOptions:void 0,currentRouteOptions:n.props.href===(null===(o=e.routeInfo)||void 0===o?void 0:o.pathname)?null===(s=e.routeInfo)||void 0===s?void 0:s.routeOptions:void 0})})),this.state={tabs:t},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const e=this.state.tabs,t=Object.keys(e).find((t=>{const n=e[t].originalHref;return this.props.routeInfo.pathname.startsWith(n)}));t&&this.setState({activeTab:t})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(e){const t=this.state.tabs[e];return!!t&&(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:t.currentHref,tab:e,selected:e===this.state.activeTab,routeOptions:void 0}})),!0)}static getDerivedStateFromProps(e,t){var n,i,r;const o=Object.assign({},t.tabs),s=Object.keys(t.tabs).find((n=>{const i=t.tabs[n].originalHref;return e.routeInfo.pathname.startsWith(i)}));U.Children.forEach(e.children,(e=>{if(null!=e&&"object"==typeof e&&e.props&&(e.type===Nw||e.type.isTabButton)){const t=o[e.props.tab];t&&t.originalHref===e.props.href||(o[e.props.tab]={originalHref:e.props.href,currentHref:e.props.href,originalRouteOptions:e.props.routeOptions,currentRouteOptions:e.props.routeOptions})}}));const{activeTab:a}=t;if(s&&a){const l=t.tabs[a].currentHref,c=t.tabs[a].currentRouteOptions;s===a&&l===(null===(n=e.routeInfo)||void 0===n?void 0:n.pathname)&&c===(null===(i=e.routeInfo)||void 0===i?void 0:i.routeOptions)||(o[s]={originalHref:o[s].originalHref,currentHref:e.routeInfo.pathname+(e.routeInfo.search||""),originalRouteOptions:o[s].originalRouteOptions,currentRouteOptions:null===(r=e.routeInfo)||void 0===r?void 0:r.routeOptions},"pop"===e.routeInfo.routeAction&&s!==a&&(o[a]={originalHref:o[a].originalHref,currentHref:o[a].originalHref,originalRouteOptions:o[a].originalRouteOptions,currentRouteOptions:o[a].currentRouteOptions}))}return s&&e.onSetCurrentTab(s,e.routeInfo),{activeTab:s,tabs:o}}onTabButtonClick(e,t){const n=this.state.tabs[e.detail.tab],i=n.originalHref,r=e.detail.href,{activeTab:o}=this.state;t&&t(e),o===e.detail.tab?i!==r&&this.context.resetTab(e.detail.tab,i,n.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:e.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:e.detail.tab}})),this.setActiveTabOnContext(e.detail.tab),this.context.changeTab(e.detail.tab,r,e.detail.routeOptions))}renderTabButton(e){return t=>{var n,i;if(null!=t&&t.props&&(t.type===Nw||t.type.isTabButton)){const r=t.props.tab===e?null===(n=this.props.routeInfo)||void 0===n?void 0:n.pathname:this.state.tabs[t.props.tab].currentHref,o=t.props.tab===e?null===(i=this.props.routeInfo)||void 0===i?void 0:i.routeOptions:this.state.tabs[t.props.tab].currentRouteOptions;return U.cloneElement(t,{href:r,routeOptions:o,onClick:e=>this.onTabButtonClick(e,t.props.onClick)})}return null}}render(){const{activeTab:e}=this.state;return U.createElement(kw,Object.assign({},this.props,{selectedTab:e}),U.Children.map(this.props.children,this.renderTabButton(e)))}static get contextType(){return V_}}const $w=U.memo((e=>{var{forwardedRef:t}=e,n=ry(e,["forwardedRef"]);const i=V.useContext(V_);return U.createElement(Fw,Object.assign({ref:t},n,{routeInfo:n.routeInfo||i.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:i.setCurrentTab}),n.children)})),jw=lw($w,"IonTabBar");class Vw extends Rw{constructor(){super()}}"undefined"!=typeof window&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",Vw));const Uw={display:"flex",position:"absolute",top:"0",left:"0",right:"0",bottom:"0",flexDirection:"column",width:"100%",height:"100%",contain:"layout size style"},qw={position:"relative",flex:1,contain:"layout size style"},Gw=(()=>class extends U.Component{constructor(e){super(e),this.routerOutletRef=U.createRef(),this.tabBarRef=U.createRef(),this.ionTabContextState={activeTab:void 0,selectTab:()=>!1}}componentDidMount(){this.tabBarRef.current&&(this.ionTabContextState.activeTab=this.tabBarRef.current.state.activeTab,this.tabBarRef.current.setActiveTabOnContext=e=>{this.ionTabContextState.activeTab=e},this.ionTabContextState.selectTab=this.tabBarRef.current.selectTab)}render(){let e,t;const n=this.props,{className:i,onIonTabsDidChange:r,onIonTabsWillChange:o}=n,s=ry(n,["className","onIonTabsDidChange","onIonTabsWillChange"]),a="function"==typeof this.props.children?this.props.children(this.ionTabContextState):this.props.children;if(U.Children.forEach(a,(n=>{if(null==n||"object"!=typeof n||!n.hasOwnProperty("type"))return;n.type===Bw||n.type.isRouterOutlet?e=U.cloneElement(n):n.type===V.Fragment&&n.props.children[0].type===Bw&&(e=n.props.children[0]);let i={ref:this.tabBarRef};void 0!==r&&(i=Object.assign(Object.assign({},i),{onIonTabsDidChange:r})),void 0!==o&&(i=Object.assign(Object.assign({},i),{onIonTabsWillChange:o})),n.type===jw||n.type.isTabBar?t=U.cloneElement(n,i):n.type!==V.Fragment||n.props.children[1].type!==jw&&!n.props.children[1].type.isTabBar||(t=U.cloneElement(n.props.children[1],i))})),!e)throw new Error("IonTabs must contain an IonRouterOutlet");if(!t)throw new Error("IonTabs needs a IonTabBar");return U.createElement(Dw.Provider,{value:this.ionTabContextState},this.context.hasIonicRouter()?U.createElement(Iw,Object.assign({className:i?`${i}`:"",routeInfo:this.context.routeInfo},s),U.createElement("ion-tabs",{className:"ion-tabs",style:Uw},"top"===t.props.slot?t:null,U.createElement("div",{style:qw,className:"tabs-inner"},e),"bottom"===t.props.slot?t:null)):U.createElement("div",Object.assign({className:i?`${i}`:"ion-tabs"},s,{style:Uw}),"top"===t.props.slot?t:null,U.createElement("div",{style:qw,className:"tabs-inner"},e),"bottom"===t.props.slot?t:null))}static get contextType(){return V_}})();class Ww extends U.PureComponent{constructor(e){super(e),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){var e,t;const n=this.props,{icon:i,ios:r,md:o,mode:s}=n,a=ry(n,["icon","ios","md","mode"]);let l;const c=uw(),u=s||(null==c?void 0:c.get("mode"));return l=r||o?"ios"===u?null!==(e=null!=r?r:o)&&void 0!==e?e:i:null!==(t=null!=o?o:r)&&void 0!==t?t:i:i,U.createElement(Tw,Object.assign({ref:this.props.forwardedRef,icon:l},a),this.props.children)}static get contextType(){return V_}}const Hw=lw(Ww,"IonIcon");class Zw extends U.PureComponent{render(){const e=this.context.getIonRoute();return this.context.hasIonicRouter()&&Zw?U.createElement(e,Object.assign({},this.props)):(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null)}static get contextType(){return V_}}class Xw extends U.PureComponent{render(){const e=this.context.getIonRedirect();return this.context.hasIonicRouter()&&Xw?U.createElement(e,Object.assign({},this.props)):(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRedirect>"),null)}static get contextType(){return V_}}const Kw=U.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});function Jw(){const e=V.useContext(Kw);return V.useMemo((()=>({back:e.back,push:e.push,goBack:e.back,canGoBack:e.canGoBack,routeInfo:e.routeInfo})),[e.back,e.push,e.canGoBack,e.routeInfo])}class Yw extends U.PureComponent{constructor(e){super(e),this.nodes=new Map,this.animation=om(e.id)}setupAnimation(e){const t=this.animation;this.nodes.size>0&&t.addElement(Array.from(this.nodes.values())),checkConfig(t,e),checkPlayback(t,e)}componentDidMount(){const e=this.props;this.setupAnimation(e)}componentDidUpdate(e){const t=this.animation,n=this.props;checkConfig(t,n,e),checkProgress(t,n,e),checkPlayback(t,n,e)}render(){const{children:e}=this.props;return U.createElement(U.Fragment,null,U.Children.map(e,((e,t)=>U.cloneElement(e,{ref:e=>this.nodes.set(t,e)}))))}}function Qw(){const e=function(e,t,n){const i=V.useRef(),r=V.useMemo((()=>`on${e}DidDismiss`),[e]),o=V.useMemo((()=>`on${e}DidPresent`),[e]),s=V.useMemo((()=>`on${e}WillDismiss`),[e]),a=V.useMemo((()=>`on${e}WillPresent`),[e]);n();const l=V.useCallback((async e=>{if(i.current)return;const{onDidDismiss:n,onWillDismiss:l,onDidPresent:c,onWillPresent:u}=e,d=ry(e,["onDidDismiss","onWillDismiss","onDidPresent","onWillPresent"]);i.current=await t.create(Object.assign({},d)),G_(i.current,{[r]:e=>{n&&n(e),i.current=void 0},[o]:e=>c&&c(e),[s]:e=>l&&l(e),[a]:e=>u&&u(e)}),i.current.present()}),[t]);return{present:l,dismiss:V.useCallback((async()=>{i.current&&await i.current.dismiss(),i.current=void 0}),[])}}("IonToast",Pg,ab);return[V.useCallback(((t,n)=>"string"==typeof t?e.present({message:t,duration:n}):e.present(t)),[e.present]),e.dismiss]}const ek={main:0},tk=(e="main")=>{var t;const n=(null!==(t=ek[e])&&void 0!==t?t:0)+1;return ek[e]=n,n.toString()},nk=U.createContext({addViewItem:()=>{},canGoBack:()=>{},clearOutlet:()=>{},createViewItem:()=>{},findViewItemByPathname:()=>{},findLeavingViewItemByRouteInfo:()=>{},findViewItemByRouteInfo:()=>{},getChildrenToRender:()=>{},goBack:()=>{},unMountViewItem:()=>{}});class ik extends U.Component{constructor(e){super(e),this.ionLifeCycleContext=new class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[]}onIonViewWillEnter(e){if(e.id){const t=this.ionViewWillEnterCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewWillEnterCallbacks[t]=e:this.ionViewWillEnterCallbacks.push(e)}else this.ionViewWillEnterCallbacks.push(e)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach((e=>e()))}onIonViewDidEnter(e){if(e.id){const t=this.ionViewDidEnterCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewDidEnterCallbacks[t]=e:this.ionViewDidEnterCallbacks.push(e)}else this.ionViewDidEnterCallbacks.push(e)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach((e=>e()))}onIonViewWillLeave(e){if(e.id){const t=this.ionViewWillLeaveCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewWillLeaveCallbacks[t]=e:this.ionViewWillLeaveCallbacks.push(e)}else this.ionViewWillLeaveCallbacks.push(e)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach((e=>e()))}onIonViewDidLeave(e){if(e.id){const t=this.ionViewDidLeaveCallbacks.findIndex((t=>t.id===e.id));t>-1?this.ionViewDidLeaveCallbacks[t]=e:this.ionViewDidLeaveCallbacks.push(e)}else this.ionViewDidLeaveCallbacks.push(e)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach((e=>e())),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(e){this.componentCanBeDestroyedCallback=e}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed((()=>{this.props.mount||this._isMounted&&this.setState({show:!1},(()=>this.props.removeView()))})),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:e}=this.state;return U.createElement(j_.Provider,{value:this.ionLifeCycleContext},e&&this.props.children)}}class rk{constructor(){this.locationHistory=[],this.tabHistory={}}add(e){"push"===e.routeAction||null==e.routeAction?this._add(e):"pop"===e.routeAction?this._pop(e):"replace"===e.routeAction&&this._replace(e),"root"===e.routeDirection&&(this._clear(),this._add(e))}clearTabStack(e){const t=this._getRouteInfosByKey(e);t&&(t.forEach((e=>{this.locationHistory=this.locationHistory.filter((t=>t.id!==e.id))})),this.tabHistory[e]=[])}update(e){const t=this.locationHistory.findIndex((t=>t.id===e.id));t>-1&&this.locationHistory.splice(t,1,e);const n=this.tabHistory[e.tab||""];if(n){const t=n.findIndex((t=>t.id===e.id));t>-1?n.splice(t,1,e):n.push(e)}else e.tab&&(this.tabHistory[e.tab]=[e])}_add(e){const t=this._getRouteInfosByKey(e.tab);t&&(this._areRoutesEqual(t[t.length-1],e)&&t.pop(),t.push(e)),this.locationHistory.push(e)}_areRoutesEqual(e,t){return!(!e||!t)&&e.pathname===t.pathname&&e.search===t.search}_pop(e){const t=this._getRouteInfosByKey(e.tab);t&&(t.pop(),t.pop(),t.push(e)),this.locationHistory.pop(),this.locationHistory.pop(),this.locationHistory.push(e)}_replace(e){const t=this._getRouteInfosByKey(e.tab);t&&t.pop(),this.locationHistory.pop(),this._add(e)}_clear(){Object.keys(this.tabHistory).forEach((e=>this.tabHistory[e]=[])),this.locationHistory=[]}_getRouteInfosByKey(e){let t;return e&&(t=this.tabHistory[e],t||(t=this.tabHistory[e]=[])),t}getFirstRouteInfoForTab(e){const t=this._getRouteInfosByKey(e);if(t)return t[0]}getCurrentRouteInfoForTab(e){const t=this._getRouteInfosByKey(e);if(t)return t[t.length-1]}findLastLocation(e){const t=this._getRouteInfosByKey(e.tab);if(t)for(let n=t.length-2;n>=0;n--){const i=t[n];if(i&&i.pathname===e.pushedByRoute)return i}for(let n=this.locationHistory.length-2;n>=0;n--){const t=this.locationHistory[n];if(t&&t.pathname===e.pushedByRoute)return t}}previous(){return this.locationHistory[this.locationHistory.length-2]||this.locationHistory[this.locationHistory.length-1]}current(){return this.locationHistory[this.locationHistory.length-1]}canGoBack(){return this.locationHistory.length>1}}class ok extends U.PureComponent{constructor(e){super(e),this.ionRouterContextValue={push:(e,t,n,i,r)=>{this.navigate(e,t,n,r,i)},back:e=>{this.goBack(void 0,e)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){"undefined"!=typeof document&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){"undefined"!=typeof document&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(e){e.detail.register(0,(e=>{this.nativeGoBack(),e()}))}goBack(e,t){this.props.onNavigateBack(e,t)}nativeGoBack(){this.props.onNativeBack()}navigate(e,t="forward",n="push",i,r,o){this.props.onNavigate(e,n,t,i,r,o)}getPageManager(){return Iw}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return U.createElement(V_.Provider,{value:Object.assign(Object.assign({},this.state),{routeInfo:this.props.routeInfo})},U.createElement(Kw.Provider,{value:Object.assign(Object.assign({},this.ionRouterContextValue),{routeInfo:this.props.routeInfo})},this.props.children))}}class sk{constructor(){this.viewStacks={},this.add=this.add.bind(this),this.clear=this.clear.bind(this),this.getViewItemsForOutlet=this.getViewItemsForOutlet.bind(this),this.remove=this.remove.bind(this)}add(e){const{outletId:t}=e;this.viewStacks[t]?this.viewStacks[t].push(e):this.viewStacks[t]=[e]}clear(e){return setTimeout((()=>{delete this.viewStacks[e]}),500)}getViewItemsForOutlet(e){return this.viewStacks[e]||[]}remove(e){const{outletId:t}=e,n=this.viewStacks[t];if(n){const i=n.find((t=>t.id===e.id));i&&(i.mount=!1,this.viewStacks[t]=n.filter((e=>e.id!==i.id)))}}getStackIds(){return Object.keys(this.viewStacks)}getAllViewItems(){const e=this.getStackIds(),t=[];return e.forEach((e=>{t.push(...this.viewStacks[e])})),t}}class ak extends U.PureComponent{render(){return U.createElement(Qh,Object.assign({path:this.props.path,exact:this.props.exact,render:this.props.render},void 0!==this.props.computedMatch?{computedMatch:this.props.computedMatch}:{}))}}class lk extends sk{constructor(){super(),this.createViewItem=this.createViewItem.bind(this),this.findViewItemByRouteInfo=this.findViewItemByRouteInfo.bind(this),this.findLeavingViewItemByRouteInfo=this.findLeavingViewItemByRouteInfo.bind(this),this.getChildrenToRender=this.getChildrenToRender.bind(this),this.findViewItemByPathname=this.findViewItemByPathname.bind(this)}createViewItem(e,t,n,i){const r={id:tk("viewItem"),outletId:e,ionPageElement:i,reactElement:t,mount:!0,ionRoute:!1},o={exact:t.props.exact,path:t.props.path||t.props.from,component:t.props.component},s=Yh(n.pathname,o);return t.type===Zw&&(r.ionRoute=!0,r.disableIonPageManagement=t.props.disableIonPageManagement),r.routeData={match:s,childProps:t.props},r}getChildrenToRender(e,t,n){const i=this.getViewItemsForOutlet(e);return U.Children.forEach(t.props.children,(e=>{const t=i.find((t=>ck(e,t.routeData.childProps.path||t.routeData.childProps.from)));t&&(t.reactElement=e)})),i.map((e=>{let t;if(e.ionRoute&&!e.disableIonPageManagement)t=U.createElement(ik,{key:`view-${e.id}`,mount:e.mount,removeView:()=>this.remove(e)},U.cloneElement(e.reactElement,{computedMatch:e.routeData.match}));else{const i=ck(e.reactElement,n.pathname);t=U.createElement(ik,{key:`view-${e.id}`,mount:e.mount,removeView:()=>this.remove(e)},U.cloneElement(e.reactElement,{computedMatch:e.routeData.match})),!i&&e.routeData.match&&(e.routeData.match=void 0,e.mount=!1)}return t}))}findViewItemByRouteInfo(e,t,n){const{viewItem:i,match:r}=this.findViewItemByPath(e.pathname,t);return(void 0===n||!0===n)&&i&&r&&(i.routeData.match=r),i}findLeavingViewItemByRouteInfo(e,t,n=!0){const{viewItem:i}=this.findViewItemByPath(e.lastPathname,t,!1,n);return i}findViewItemByPathname(e,t){const{viewItem:n}=this.findViewItemByPath(e,t);return n}findViewItemByPath(e,t,n,i){let r,o,s;if(t)s=this.getViewItemsForOutlet(t),s.some(a),r||s.some(l);else{const e=this.getAllViewItems();e.some(a),r||e.some(l)}return{viewItem:r,match:o};function a(t){if(i&&!t.ionRoute)return!1;const s={exact:!!n||t.routeData.childProps.exact,path:t.routeData.childProps.path||t.routeData.childProps.from,component:t.routeData.childProps.component},a=Yh(e,s);return!!a&&(r=t,o=a,!0)}function l(t){return!t.routeData.childProps.path&&!t.routeData.childProps.from&&(o={path:e,url:e,isExact:!0,params:{}},r=t,!0)}}}function ck(e,t,n){return Yh(t,{exact:!!n||e.props.exact,path:e.props.path||e.props.from,component:e.props.component})}const uk=e=>!e.classList.contains("ion-page-invisible")&&!e.classList.contains("ion-page-hidden");class dk extends U.PureComponent{constructor(e){super(e),this.stackContextValue={registerIonPage:this.registerIonPage.bind(this),isInOutlet:()=>!0},this.pendingPageTransition=!1,this.registerIonPage=this.registerIonPage.bind(this),this.transitionPage=this.transitionPage.bind(this),this.handlePageTransition=this.handlePageTransition.bind(this),this.id=tk("routerOutlet"),this.prevProps=void 0,this.skipTransition=!1}componentDidMount(){this.clearOutletTimeout&&clearTimeout(this.clearOutletTimeout),this.routerOutletElement&&(this.setupRouterOutlet(this.routerOutletElement),this.handlePageTransition(this.props.routeInfo))}componentDidUpdate(e){const{pathname:t}=this.props.routeInfo,{pathname:n}=e.routeInfo;t!==n?(this.prevProps=e,this.handlePageTransition(this.props.routeInfo)):this.pendingPageTransition&&(this.handlePageTransition(this.props.routeInfo),this.pendingPageTransition=!1)}componentWillUnmount(){this.clearOutletTimeout=this.context.clearOutlet(this.id)}async handlePageTransition(e){var t,n;if(this.routerOutletElement&&this.routerOutletElement.commit){let i=this.context.findViewItemByRouteInfo(e,this.id),r=this.context.findLeavingViewItemByRouteInfo(e,this.id);!r&&e.prevRouteLastPathname&&(r=this.context.findViewItemByPathname(e.prevRouteLastPathname,this.id)),r&&("replace"===e.routeAction?r.mount=!1:"push"!==e.routeAction||"forward"!==e.routeDirection?"none"!==e.routeDirection&&i!==r&&(r.mount=!1):(null===(t=e.routeOptions)||void 0===t?void 0:t.unmount)&&(r.mount=!1));const o=function(e,t){let n;return U.Children.forEach(e,(e=>{const i={exact:e.props.exact,path:e.props.path||e.props.from,component:e.props.component};Yh(t.pathname,i)&&(n=e)})),n||(U.Children.forEach(e,(e=>{e.props.path||e.props.from||(n=e)})),n)}(null===(n=this.ionRouterOutlet)||void 0===n?void 0:n.props.children,e);if(i?i.reactElement=o:o&&(i=this.context.createViewItem(this.id,o,e),this.context.addViewItem(i)),i&&i.ionPageElement){if(i===r&&i.routeData.match.url!==e.pathname)return;if(!r&&this.props.routeInfo.prevRouteLastPathname&&(r=this.context.findViewItemByPathname(this.props.routeInfo.prevRouteLastPathname,this.id)),uk(i.ionPageElement)&&void 0!==r&&!uk(r.ionPageElement))return;this.transitionPage(e,i,r)}else!r||o||i||r.ionPageElement&&(r.ionPageElement.classList.add("ion-page-hidden"),r.ionPageElement.setAttribute("aria-hidden","true"));this.forceUpdate()}else this.pendingPageTransition=!0}registerIonPage(e,t){const n=this.context.findViewItemByRouteInfo(t,this.id);if(n){const t=n.ionPageElement;if(n.ionPageElement=e,n.ionRoute=!0,t===e)return}this.handlePageTransition(t)}async setupRouterOutlet(e){e.swipeHandler={canStart:()=>{const t=uw();if(!t||!t.get("swipeBackEnabled","ios"===e.mode))return!1;const{routeInfo:n}=this.props,i=this.prevProps&&this.prevProps.routeInfo.pathname===n.pushedByRoute?this.prevProps.routeInfo:{pathname:n.pushedByRoute||""},r=this.context.findViewItemByRouteInfo(i,this.id,!1);return!!r&&r.mount&&r.routeData.match.path!==n.pathname},onStart:async()=>{const{routeInfo:e}=this.props,t=this.prevProps&&this.prevProps.routeInfo.pathname===e.pushedByRoute?this.prevProps.routeInfo:{pathname:e.pushedByRoute||""},n=this.context.findViewItemByRouteInfo(t,this.id,!1),i=this.context.findViewItemByRouteInfo(e,this.id,!1);return n&&i&&await this.transitionPage(e,n,i,"back",!0),Promise.resolve()},onEnd:e=>{if(e)this.skipTransition=!0,this.context.goBack();else{const{routeInfo:e}=this.props,t=this.prevProps&&this.prevProps.routeInfo.pathname===e.pushedByRoute?this.prevProps.routeInfo:{pathname:e.pushedByRoute||""},n=this.context.findViewItemByRouteInfo(t,this.id,!1);if(n!==this.context.findViewItemByRouteInfo(e,this.id,!1)&&void 0!==(null==n?void 0:n.ionPageElement)){const{ionPageElement:e}=n;e.setAttribute("aria-hidden","true"),e.classList.add("ion-page-hidden")}}}}}async transitionPage(e,t,n,i,r=!1){const o=async(t,n)=>{const i=this.skipTransition;i?this.skipTransition=!1:(t.classList.add("ion-page"),t.classList.add("ion-page-invisible")),await s.commit(t,n,{duration:i||void 0===l?0:void 0,direction:l,showGoBack:!!e.pushedByRoute,progressAnimation:r,animationBuilder:e.routeAnimation})},s=this.routerOutletElement,a="none"===e.routeDirection||"root"===e.routeDirection?void 0:e.routeDirection,l=null!=i?i:a;if(t&&t.ionPageElement&&this.routerOutletElement)if(n&&n.ionPageElement&&t===n)if(function(e,t,n){const i={exact:!!n||e.props.exact,path:e.props.path||e.props.from,component:e.props.component},r=Yh(t,i);return r}(n.reactElement,e.pathname,!0)){const e=function(e){let t;if(t="string"==typeof e?e:e.outerHTML,document){const e=document.createElement("div");e.innerHTML=t,e.style.zIndex="";const n=e.getElementsByTagName("ion-back-button");return n[0]&&n[0].remove(),e.firstChild}}(n.ionPageElement.outerHTML);e&&(this.routerOutletElement.appendChild(e),await o(t.ionPageElement,e),this.routerOutletElement.removeChild(e))}else await o(t.ionPageElement,void 0);else await o(t.ionPageElement,null==n?void 0:n.ionPageElement),n&&n.ionPageElement&&!r&&(n.ionPageElement.classList.add("ion-page-hidden"),n.ionPageElement.setAttribute("aria-hidden","true"))}render(){const{children:e}=this.props,t=U.Children.only(e);this.ionRouterOutlet=t;const n=this.context.getChildrenToRender(this.id,this.ionRouterOutlet,this.props.routeInfo,(()=>{this.forceUpdate()}));return U.createElement(Mw.Provider,{value:this.stackContextValue},U.cloneElement(t,{ref:e=>{t.props.setRef&&t.props.setRef(e),t.props.forwardedRef&&(t.props.forwardedRef.current=e),this.routerOutletElement=e;const{ref:n}=t;"function"==typeof n&&n(e)}},n))}static get contextType(){return nk}}class hk extends U.PureComponent{constructor(e){super(e),this.exitViewFromOtherOutletHandlers=[],this.locationHistory=new rk,this.viewStack=new lk,this.routeMangerContextState={canGoBack:()=>this.locationHistory.canGoBack(),clearOutlet:this.viewStack.clear,findViewItemByPathname:this.viewStack.findViewItemByPathname,getChildrenToRender:this.viewStack.getChildrenToRender,goBack:()=>this.handleNavigateBack(),createViewItem:this.viewStack.createViewItem,findViewItemByRouteInfo:this.viewStack.findViewItemByRouteInfo,findLeavingViewItemByRouteInfo:this.viewStack.findLeavingViewItemByRouteInfo,addViewItem:this.viewStack.add,unMountViewItem:this.viewStack.remove};const t={id:tk("routeInfo"),pathname:this.props.location.pathname,search:this.props.location.search};this.locationHistory.add(t),this.handleChangeTab=this.handleChangeTab.bind(this),this.handleResetTab=this.handleResetTab.bind(this),this.handleNativeBack=this.handleNativeBack.bind(this),this.handleNavigate=this.handleNavigate.bind(this),this.handleNavigateBack=this.handleNavigateBack.bind(this),this.props.registerHistoryListener(this.handleHistoryChange.bind(this)),this.handleSetCurrentTab=this.handleSetCurrentTab.bind(this),this.state={routeInfo:t}}handleChangeTab(e,t,n){if(!t)return;const i=this.locationHistory.getCurrentRouteInfoForTab(e),[r,o]=t.split("?");i?(this.incomingRouteParams=Object.assign(Object.assign({},i),{routeAction:"push",routeDirection:"none"}),i.pathname===r?(this.incomingRouteParams.routeOptions=n,this.props.history.push(i.pathname+(i.search||""))):(this.incomingRouteParams.pathname=r,this.incomingRouteParams.search=o?"?"+o:void 0,this.incomingRouteParams.routeOptions=n,this.props.history.push(r+(o?"?"+o:"")))):this.handleNavigate(r,"push","none",void 0,n,e)}handleHistoryChange(e,t){var n,i,r;let o;if(o=this.incomingRouteParams&&"replace"===this.incomingRouteParams.routeAction?this.locationHistory.previous():this.locationHistory.current(),o.pathname+o.search!==e.pathname){if(!this.incomingRouteParams){if("REPLACE"===t&&(this.incomingRouteParams={routeAction:"replace",routeDirection:"none",tab:this.currentTab}),"POP"===t){const e=this.locationHistory.current();if(e&&e.pushedByRoute){const t=this.locationHistory.findLastLocation(e);this.incomingRouteParams=Object.assign(Object.assign({},t),{routeAction:"pop",routeDirection:"back"})}else this.incomingRouteParams={routeAction:"pop",routeDirection:"none",tab:this.currentTab}}this.incomingRouteParams||(this.incomingRouteParams={routeAction:"push",routeDirection:(null===(n=e.state)||void 0===n?void 0:n.direction)||"forward",routeOptions:null===(i=e.state)||void 0===i?void 0:i.routerOptions,tab:this.currentTab})}let s;if(null===(r=this.incomingRouteParams)||void 0===r?void 0:r.id)s=Object.assign(Object.assign({},this.incomingRouteParams),{lastPathname:o.pathname}),this.locationHistory.add(s);else{const t="push"===this.incomingRouteParams.routeAction&&"forward"===this.incomingRouteParams.routeDirection;if(s=Object.assign(Object.assign({id:tk("routeInfo")},this.incomingRouteParams),{lastPathname:o.pathname,pathname:e.pathname,search:e.search,params:this.props.match.params,prevRouteLastPathname:o.lastPathname}),t)s.tab=o.tab,s.pushedByRoute=o.pathname;else if("pop"===s.routeAction){const e=this.locationHistory.findLastLocation(s);s.pushedByRoute=null==e?void 0:e.pushedByRoute}else if("push"===s.routeAction&&s.tab!==o.tab){const e=this.locationHistory.getCurrentRouteInfoForTab(s.tab);s.pushedByRoute=null==e?void 0:e.pushedByRoute}else if("replace"===s.routeAction){const e=this.locationHistory.current(),t=null==e?void 0:e.pushedByRoute,n=void 0!==t&&t!==s.pathname?t:s.pushedByRoute;s.lastPathname=(null==e?void 0:e.pathname)||s.lastPathname,s.prevRouteLastPathname=null==e?void 0:e.lastPathname,s.pushedByRoute=n,s.routeDirection=(null==e?void 0:e.routeDirection)||s.routeDirection,s.routeAnimation=(null==e?void 0:e.routeAnimation)||s.routeAnimation}this.locationHistory.add(s)}this.setState({routeInfo:s})}this.incomingRouteParams=void 0}handleNativeBack(){const e=this.props.history;(e.goBack||e.back)()}handleNavigate(e,t,n,i,r,o){this.incomingRouteParams=Object.assign(this.incomingRouteParams||{},{routeAction:t,routeDirection:n,routeOptions:r,routeAnimation:i,tab:o}),"push"===t?this.props.history.push(e):this.props.history.replace(e)}handleNavigateBack(e="/",t){const n=uw();e=e||n&&n.get("backButtonDefaultHref");const i=this.locationHistory.current();if(i&&i.pushedByRoute){const n=this.locationHistory.findLastLocation(i);if(n)if(this.incomingRouteParams=Object.assign(Object.assign({},n),{routeAction:"pop",routeDirection:"back",routeAnimation:t||i.routeAnimation}),i.lastPathname===i.pushedByRoute||n.pathname===i.pushedByRoute&&""===i.tab&&""===n.tab){const e=this.props.history;(e.goBack||e.back)()}else this.handleNavigate(n.pathname+(n.search||""),"pop","back");else this.handleNavigate(e,"pop","back")}else this.handleNavigate(e,"pop","back")}handleResetTab(e,t,n){const i=this.locationHistory.getFirstRouteInfoForTab(e);if(i){const e=Object.assign({},i);e.pathname=t,e.routeOptions=n,this.incomingRouteParams=Object.assign(Object.assign({},e),{routeAction:"pop",routeDirection:"back"}),this.props.history.push(e.pathname+(e.search||""))}}handleSetCurrentTab(e){this.currentTab=e;const t=Object.assign({},this.locationHistory.current());t.tab!==e&&(t.tab=e,this.locationHistory.update(t))}render(){return U.createElement(nk.Provider,{value:this.routeMangerContextState},U.createElement(ok,{ionRoute:ak,ionRedirect:{},stackManager:dk,routeInfo:this.state.routeInfo,onNativeBack:this.handleNativeBack,onNavigateBack:this.handleNavigateBack,onNavigate:this.handleNavigate,onSetCurrentTab:this.handleSetCurrentTab,onChangeTab:this.handleChangeTab,onResetTab:this.handleResetTab,locationHistory:this.locationHistory},this.props.children))}}const pk=function(e){var t="withRouter("+(e.displayName||e.name)+")",n=function(t){var n=t.wrappedComponentRef,i=_h(t,["wrappedComponentRef"]);return U.createElement(jh.Consumer,null,(function(t){return t||Sd(!1),U.createElement(e,vd({},i,t,{ref:n}))}))};return n.displayName=t,n.WrappedComponent=e,zh(n,e)}(hk);pk.displayName="IonRouter";class fk extends U.Component{constructor(e){super(e);const{history:t}=e,n=ry(e,["history"]);this.history=t||Nd(n),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,t){const n=e.location||e,i=e.action||t;this.historyListenHandler&&this.historyListenHandler(n,i)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:t}=e,n=ry(e,["children"]);return U.createElement(Vh,Object.assign({history:this.history},n),U.createElement(pk,{registerHistoryListener:this.registerHistoryListener},t))}}class mk extends U.Component{constructor(e){super(e),this.history=e.history,this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,t){const n=e.location||e,i=e.action||t;this.historyListenHandler&&this.historyListenHandler(n,i)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:t}=e,n=ry(e,["children"]);return U.createElement(Vh,Object.assign({},n),U.createElement(pk,{registerHistoryListener:this.registerHistoryListener},t))}}class gk extends U.Component{constructor(e){super(e);const{history:t}=e;ry(e,["history"]);this.history=t||createHashHistory(),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,t){const n=e.location||e,i=e.action||t;this.historyListenHandler&&this.historyListenHandler(n,i)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:t}=e,n=ry(e,["children"]);return U.createElement(Vh,Object.assign({history:this.history},n),U.createElement(pk,{registerHistoryListener:this.registerHistoryListener},t))}}const yk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M368 368L144 144M368 144L144 368' class='ionicon-fill-none ionicon-stroke-width'/></svg>",vk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M394 480a16 16 0 01-9.39-3L256 383.76 127.39 477a16 16 0 01-24.55-18.08L153 310.35 23 221.2a16 16 0 019-29.2h160.38l48.4-148.95a16 16 0 0130.44 0l48.4 149H480a16 16 0 019.05 29.2L359 310.35l50.13 148.53A16 16 0 01394 480z'/></svg>",bk="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M480 208H308L256 48l-52 160H32l140 96-54 160 138-100 138 100-54-160z' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",xk=()=>Q(Pw,{children:Q(ew,{fullscreen:!0})});var _k={exports:{}};!function(e,t){e.exports=function(){var e,t,n;function i(i,r){if(e)if(t){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",s={};e(s),n=r(s),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(n.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else t=r;else e=r}i(["exports"],(function(e){var t="undefined"!=typeof self?self:{},n="2.15.0";let i;const r={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==i){const e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{i=null!={}.API_URL_REGEX?new RegExp({}.API_URL_REGEX):e}catch(t){i=e}}return i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!r.API_URL)return null;try{const e=new URL(r.API_URL);return"api.mapbox.cn"===e.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===e.hostname?"https://events.mapbox.com/events/v2":null}catch(e){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},o={supported:!1,testSupport:function(e){!l&&a&&(c?u(e):s=e)}};let s,a,l=!1,c=!1;function u(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),e.isContextLost())return;o.supported=!0}catch(e){}e.deleteTexture(t),l=!0}t.document&&(a=t.document.createElement("img"),a.onload=function(){s&&u(s),s=null,c=!0},a.onerror=function(){l=!0,s=null},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const d="01";function h(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var p=f;function f(e,t,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=i}f.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,i=0;i<8;i++){var r=this.sampleCurveX(n)-e;if(Math.abs(r)<t)return n;var o=this.sampleCurveDerivativeX(n);if(Math.abs(o)<1e-6)break;n-=r/o}var s=0,a=1;for(n=e,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-e)<t));i++)e>r?s=n:a=n,n=.5*(a-s)+s;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var m=h(p),g=y;function y(e,t){this.x=e,this.y=t}y.prototype={clone:function(){return new y(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=i,this},_rotateAround:function(e,t){var n=Math.cos(e),i=Math.sin(e),r=t.y+i*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-i*(this.y-t.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},y.convert=function(e){return e instanceof y?e:Array.isArray(e)?new y(e[0],e[1]):e};var v=h(g);const b=Math.PI/180,x=180/Math.PI;function _(e){return e*b}function w(e){return e*x}const k=[[0,0],[1,0],[1,1],[0,1]];function E(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}function S(e,t,n,i){const r=new m(e,t,n,i);return function(e){return r.solve(e)}}const T=S(.25,.1,.25,1);function C(e,t,n){return Math.min(n,Math.max(t,e))}function M(e,t,n){return(n=C((n-e)/(t-e),0,1))*n*(3-2*n)}function I(e,t,n){const i=n-t,r=((e-t)%i+i)%i+t;return r===t?n:r}function A(e,t,n){if(!e.length)return n(null,[]);let i=e.length;const r=new Array(e.length);let o=null;e.forEach(((e,s)=>{t(e,((e,t)=>{e&&(o=e),r[s]=t,0==--i&&n(o,r)}))}))}function P(e){const t=[];for(const n in e)t.push(e[n]);return t}function O(e,...t){for(const n of t)for(const t in n)e[t]=n[t];return e}let D=1;function R(){return D++}function z(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function L(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function B(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function N(e,t){e.forEach((e=>{t[e]&&(t[e]=t[e].bind(t))}))}function F(e,t){return-1!==e.indexOf(t,e.length-t.length)}function $(e,t,n){const i={};for(const r in e)i[r]=t.call(n||this,e[r],r,e);return i}function j(e,t,n){const i={};for(const r in e)t.call(n||this,e[r],r,e)&&(i[r]=e[r]);return i}function V(e){return Array.isArray(e)?e.map(V):"object"==typeof e&&e?$(e,V):e}const U={};function q(e){U[e]||("undefined"!=typeof console&&console.warn(e),U[e]=!0)}function G(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function W(e){let t=0;for(let n,i,r=0,o=e.length,s=o-1;r<o;s=r++)n=e[r],i=e[s],t+=(i.x-n.x)*(n.y+i.y);return t}function H(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Z(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,n,i,r)=>{const o=i||r;return t[n]=!o||o.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let X=null;function K(e){if(null==X){const t=e.navigator?e.navigator.userAgent:null;X=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return X}function J(e){try{const n=t[e];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function Y(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}const Q="mapbox-tiles";let ee,te,ne=500,ie=50;function re(){try{return t.caches}catch(e){}}function oe(){re()&&!ee&&(ee=t.caches.open(Q))}function se(e){const t=e.indexOf("?");if(t<0)return e;const n=function(e){const t=e.indexOf("?");return t>0?e.slice(t+1).split("&"):[]}(e),i=n.filter((e=>{const t=e.split("=");return"language"===t[0]||"worldview"===t[0]}));return i.length?`${e.slice(0,t)}?${i.join("&")}`:e.slice(0,t)}let ae=1/0;const le={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(le);class ce extends Error{constructor(e,t,n){401===t&&xe(n)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=t,this.url=n}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ue=H()?()=>self.worker&&self.worker.referrer:()=>("blob:"===t.location.protocol?t.parent:t).location.href,de=function(e,n){if(!(/^file:/.test(i=e.url)||/^file:/.test(ue())&&!/^\w+:/.test(i))){if(t.fetch&&t.Request&&t.AbortController&&t.Request.prototype.hasOwnProperty("signal"))return function(e,n){const i=new t.AbortController,r=new t.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:ue(),referrerPolicy:e.referrerPolicy,signal:i.signal});let o=!1,s=!1;const a=(l=r.url).indexOf("sku=")>0&&xe(l);var l;"json"===e.type&&r.headers.set("Accept","application/json");const c=(i,o,l)=>{if(s)return;if(i&&"SecurityError"!==i.message&&q(i.toString()),o&&l)return u(o);const c=Date.now();t.fetch(r).then((t=>{if(t.ok){const e=a?t.clone():null;return u(t,e,c)}return n(new ce(t.statusText,t.status,e.url))})).catch((t=>{"AbortError"!==t.name&&n(new Error(`${t.message} ${e.url}`))}))},u=(i,a,l)=>{("arrayBuffer"===e.type?i.arrayBuffer():"json"===e.type?i.json():i.text()).then((e=>{s||(a&&l&&function(e,n,i){if(oe(),!ee)return;const r={status:n.status,statusText:n.statusText,headers:new t.Headers};n.headers.forEach(((e,t)=>r.headers.set(t,e)));const o=Z(n.headers.get("Cache-Control")||"");if(o["no-store"])return;o["max-age"]&&r.headers.set("Expires",new Date(i+1e3*o["max-age"]).toUTCString());const s=r.headers.get("Expires");s&&(new Date(s).getTime()-i<42e4||function(e,t){if(void 0===te)try{new Response(new ReadableStream),te=!0}catch(e){te=!1}te?t(e.body):e.blob().then(t)}(n,(n=>{const i=new t.Response(n,r);oe(),ee&&ee.then((t=>t.put(se(e.url),i))).catch((e=>q(e.message)))})))}(r,a,l),o=!0,n(null,e,i.headers.get("Cache-Control"),i.headers.get("Expires")))})).catch((e=>{s||n(new Error(e.message))}))};return a?function(e,t){if(oe(),!ee)return t(null);const n=se(e.url);ee.then((e=>{e.match(n).then((i=>{const r=function(e){if(!e)return!1;const t=new Date(e.headers.get("Expires")||0),n=Z(e.headers.get("Cache-Control")||"");return t>Date.now()&&!n["no-cache"]}(i);e.delete(n),r&&e.put(n,i.clone()),t(null,i,r)})).catch(t)})).catch(t)}(r,c):c(null,null),{cancel:()=>{s=!0,o||i.abort()}}}(e,n);if(H()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,n,void 0,!0)}var i;return function(e,n){const i=new t.XMLHttpRequest;i.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(i.responseType="arraybuffer");for(const t in e.headers)i.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===e.credentials,i.onerror=()=>{n(new Error(i.statusText))},i.onload=()=>{if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){let t=i.response;if("json"===e.type)try{t=JSON.parse(i.response)}catch(e){return n(e)}n(null,t,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else n(new ce(i.statusText,i.status,e.url))},i.send(e.body),{cancel:()=>i.abort()}}(e,n)},he=function(e,t){return de(O(e,{type:"arrayBuffer"}),t)};function pe(e){const n=t.document.createElement("a");return n.href=e,n.protocol===t.document.location.protocol&&n.host===t.document.location.host}const fe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let me,ge;me=[],ge=0;const ye=function(e,n){if(o.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ge>=r.MAX_PARALLEL_IMAGE_REQUESTS){const t={requestParameters:e,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return me.push(t),t}ge++;let i=!1;const s=()=>{if(!i)for(i=!0,ge--;me.length&&ge<r.MAX_PARALLEL_IMAGE_REQUESTS;){const e=me.shift(),{requestParameters:t,callback:n,cancelled:i}=e;i||(e.cancel=ye(t,n).cancel)}},a=he(e,((e,i,r,o)=>{s(),e?n(e):i&&(t.createImageBitmap?function(e,n){const i=new t.Blob([new Uint8Array(e)],{type:"image/png"});t.createImageBitmap(i).then((e=>{n(null,e)})).catch((e=>{n(new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(i,((e,t)=>n(e,t,r,o))):function(e,n){const i=new t.Image,r=t.URL;i.onload=()=>{n(null,i),r.revokeObjectURL(i.src),i.onload=null,t.requestAnimationFrame((()=>{i.src=fe}))},i.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const o=new t.Blob([new Uint8Array(e)],{type:"image/png"});i.src=e.byteLength?r.createObjectURL(o):fe}(i,((e,t)=>n(e,t,r,o))))}));return{cancel:()=>{a.cancel(),s()}}},ve="NO_ACCESS_TOKEN";function be(e){return 0===e.indexOf("mapbox:")}function xe(e){return r.API_URL_REGEX.test(e)}function _e(e){return r.API_CDN_URL_REGEX.test(e)}function we(e){return r.API_STYLE_REGEX.test(e)&&!ke(e)}function ke(e){return r.API_SPRITE_REGEX.test(e)}const Ee=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Se(e){const t=e.match(Ee);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Te(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}const Ce="mapbox.eventData";function Me(e){if(!e)return null;const n=e.split(".");if(!n||3!==n.length)return null;try{return JSON.parse(decodeURIComponent(t.atob(n[1]).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch(e){return null}}class Ie{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=Me(r.ACCESS_TOKEN);let i="";return i=n&&n.u?t.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode(Number("0x"+t))))):r.ACCESS_TOKEN||"",e?`${Ce}.${e}:${i}`:`${Ce}:${i}`}fetchEventData(){const e=J("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{const e=t.localStorage.getItem(n);e&&(this.eventData=JSON.parse(e));const r=t.localStorage.getItem(i);r&&(this.anonId=r)}catch(e){q("Unable to read from LocalStorage")}}saveEventData(){const e=J("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{t.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&t.localStorage.setItem(n,JSON.stringify(this.eventData))}catch(e){q("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,t,n,i){if(!r.EVENTS_URL)return;const o=Se(r.EVENTS_URL);o.params.push(`access_token=${i||r.ACCESS_TOKEN||""}`);const s={event:this.type,created:new Date(e).toISOString()},a=t?O(s,t):s,l={url:Te(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([a])};this.pendingRequest=function(e,t){return de(O(e,{method:"POST"}),t)}(l,(e=>{this.pendingRequest=null,n(e),this.saveEventData(),this.processRequests(i)}))}queueRequest(e,t){this.queue.push(e),this.processRequests(t)}}const Ae=new class extends Ie{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(e,t){r.EVENTS_URL&&r.ACCESS_TOKEN&&Array.isArray(e)&&e.some((e=>be(e)||xe(e)))&&this.queueRequest(Date.now(),t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Me(r.ACCESS_TOKEN),i=t?t.u:r.ACCESS_TOKEN;let o=i!==this.eventData.tokenU;B(this.anonId)||(this.anonId=z(),o=!0);const s=this.queue.shift();if(this.eventData.lastSuccess){const e=new Date(this.eventData.lastSuccess),t=new Date(s),n=(s-this.eventData.lastSuccess)/864e5;o=o||n>=1||n<-1||e.getDate()!==t.getDate()}else o=!0;o?this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:d,"enabled.telemetry":!1,userId:this.anonId},(e=>{e||(this.eventData.lastSuccess=s,this.eventData.tokenU=i)}),e):this.processRequests()}},Pe=Ae.postTurnstileEvent.bind(Ae),Oe=new class extends Ie{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(e,t,n,i){this.skuToken=t,this.errorCb=i,r.EVENTS_URL&&(n||r.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},n):this.errorCb(new Error(ve)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:i}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),B(this.anonId)||(this.anonId=z()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:d,skuToken:this.skuToken,userId:this.anonId},(e=>{e?this.errorCb(e):t&&(this.success[t]=!0)}),e))}},De=Oe.postMapLoadEvent.bind(Oe),Re=new class extends Ie{constructor(){super("gljs.performance")}postPerformanceEvent(e,t){r.EVENTS_URL&&(e||r.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:i,performanceData:r}=this.queue.shift(),o=function(e){const i=t.performance.getEntriesByType("resource"),r=t.performance.getEntriesByType("mark"),o=function(e){const t={};if(e)for(const n in e)if("other"!==n)for(const i of e[n]){const e=`${n}ResolveRangeMin`,r=`${n}ResolveRangeMax`,o=`${n}RequestCount`,s=`${n}RequestCachedCount`;t[e]=Math.min(t[e]||1/0,i.startTime),t[r]=Math.max(t[r]||-1/0,i.responseEnd);const a=e=>{void 0===t[e]&&(t[e]=0),++t[e]};void 0!==i.transferSize&&0===i.transferSize&&a(s),a(o)}return t}(function(e,t){const n={};if(e)for(const i of e){const e=t(i);void 0===n[e]&&(n[e]=[]),n[e].push(i)}return n}(i,je)),s=t.devicePixelRatio,a=t.navigator.connection||t.navigator.mozConnection||t.navigator.webkitConnection,l={counters:[],metadata:[],attributes:[]},c=(e,t,n)=>{null!=n&&e.push({name:t,value:n.toString()})};for(const t in o)c(l.counters,t,o[t]);if(e.interactionRange[0]!==1/0&&e.interactionRange[1]!==-1/0&&(c(l.counters,"interactionRangeMin",e.interactionRange[0]),c(l.counters,"interactionRangeMax",e.interactionRange[1])),r)for(const t of Object.keys(Fe)){const e=Fe[t],n=r.find((t=>t.name===e));n&&c(l.counters,e,n.startTime)}return c(l.counters,"visibilityHidden",e.visibilityHidden),c(l.attributes,"style",function(e){if(e)for(const t of e){const e=t.name.split("?")[0];if(we(e)){const t=e.split("/").slice(-2);if(2===t.length)return`mapbox://styles/${t[0]}/${t[1]}`}}}(i)),c(l.attributes,"terrainEnabled",e.terrainEnabled?"true":"false"),c(l.attributes,"fogEnabled",e.fogEnabled?"true":"false"),c(l.attributes,"projection",e.projection),c(l.attributes,"zoom",e.zoom),c(l.metadata,"devicePixelRatio",s),c(l.metadata,"connectionEffectiveType",a?a.effectiveType:void 0),c(l.metadata,"navigatorUserAgent",t.navigator.userAgent),c(l.metadata,"screenWidth",t.screen.width),c(l.metadata,"screenHeight",t.screen.height),c(l.metadata,"windowWidth",t.innerWidth),c(l.metadata,"windowHeight",t.innerHeight),c(l.metadata,"mapWidth",e.width/s),c(l.metadata,"mapHeight",e.height/s),c(l.metadata,"webglRenderer",e.renderer),c(l.metadata,"webglVendor",e.vendor),c(l.metadata,"sdkVersion",n),c(l.metadata,"sdkIdentifier","mapbox-gl-js"),l}(r);for(const t of o.metadata);for(const t of o.counters);for(const t of o.attributes);this.postEvent(i,o,(()=>{}),e)}},ze=Re.postPerformanceEvent.bind(Re),Le=new class extends Ie{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(e,t,n,i){if(!r.API_URL||!r.SESSION_PATH)return;const o=Se(r.API_URL+r.SESSION_PATH);o.params.push(`sku=${t||""}`),o.params.push(`access_token=${i||r.ACCESS_TOKEN||""}`);const s={url:Te(o),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(e,t){return de(O(e,{method:"GET"}),t)}(s,(e=>{this.pendingRequest=null,n(e),this.saveEventData(),this.processRequests(i)}))}getSessionAPI(e,t,n,i){this.skuToken=t,this.errorCb=i,r.SESSION_PATH&&r.API_URL&&(n||r.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},n):this.errorCb(new Error(ve)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||this.getSession(n,this.skuToken,(e=>{e?this.errorCb(e):t&&(this.success[t]=!0)}),e)}},Be=Le.getSessionAPI.bind(Le),Ne=new Set,Fe={create:"create",load:"load",fullLoad:"fullLoad"},$e={mark(e){t.performance.mark(e)},measure(e,n,i){t.performance.measure(e,n,i)}};function je(e){const t=e.name.split("?")[0];return _e(t)&&t.includes("mapbox-gl.js")?"javascript":_e(t)&&t.includes("mapbox-gl.css")?"css":function(e){return r.API_FONTS_REGEX.test(e)}(t)?"fontRange":ke(t)?"sprite":we(t)?"style":function(e){return r.API_TILEJSON_REGEX.test(e)}(t)?"tilejson":"other"}const Ve=t.performance;function Ue(e){const t=e?e.url.toString():void 0;return Ve.getEntriesByName(t)}let qe,Ge,We,He;const Ze={now:()=>void 0!==We?We:t.performance.now(),setNow(e){We=e},restoreNow(){We=void 0},frame(e){const n=t.requestAnimationFrame(e);return{cancel:()=>t.cancelAnimationFrame(n)}},getImageData(e,n=0){const{width:i,height:r}=e;He||(He=t.document.createElement("canvas"));const o=He.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return(i>He.width||r>He.height)&&(He.width=i,He.height=r),o.clearRect(-n,-n,i+2*n,r+2*n),o.drawImage(e,0,0,i,r),o.getImageData(-n,-n,i+2*n,r+2*n)},resolveURL:e=>(qe||(qe=t.document.createElement("a")),qe.href=e,qe.href),get devicePixelRatio(){return t.devicePixelRatio},get prefersReducedMotion(){return!!t.matchMedia&&(null==Ge&&(Ge=t.matchMedia("(prefers-reduced-motion: reduce)")),Ge.matches)}};function Xe(e,t,n){n[e]&&-1!==n[e].indexOf(t)||(n[e]=n[e]||[],n[e].push(t))}function Ke(e,t,n){if(n&&n[e]){const i=n[e].indexOf(t);-1!==i&&n[e].splice(i,1)}}class Je{constructor(e,t={}){O(this,t),this.type=e}}class Ye extends Je{constructor(e,t={}){super("error",O({error:e},t))}}class Qe{on(e,t){return this._listeners=this._listeners||{},Xe(e,t,this._listeners),this}off(e,t){return Ke(e,t,this._listeners),Ke(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},Xe(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){"string"==typeof e&&(e=new Je(e,t||{}));const n=e.type;if(this.listens(n)){e.target=this;const t=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of t)n.call(this,e);const i=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const o of i)Ke(n,o,this._oneTimeListeners),o.call(this,e);const r=this._eventedParent;r&&(O(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(e))}else e instanceof Ye&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var et=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function tt(e,...t){for(const n of t)for(const t in n)e[t]=n[t];return e}function nt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function it(e){if(Array.isArray(e))return e.map(it);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const n in e)t[n]=it(e[n]);return t}return nt(e)}class rt extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}var ot=rt;class st{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[n,i]of t)this.bindings[n]=i}concat(e){return new st(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var at=st;const lt={kind:"null"},ct={kind:"number"},ut={kind:"string"},dt={kind:"boolean"},ht={kind:"color"},pt={kind:"object"},ft={kind:"value"},mt={kind:"collator"},gt={kind:"formatted"},yt={kind:"resolvedImage"};function vt(e,t){return{kind:"array",itemType:e,N:t}}function bt(e){if("array"===e.kind){const t=bt(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const xt=[lt,ct,ut,dt,ht,gt,pt,vt(ft),yt];function _t(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!_t(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of xt)if(!_t(e,t))return null}return`Expected ${bt(e)} but found ${bt(t)} instead.`}function wt(e,t){return t.some((t=>t.kind===e.kind))}function kt(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}var Et,St={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Tt(e){return(e=Math.round(e))<0?0:e>255?255:e}function Ct(e){return Tt("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function Mt(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function It(e,t,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}try{Et={}.parseCSSColor=function(e){var t,n=e.replace(/ /g,"").toLowerCase();if(n in St)return St[n].slice();if("#"===n[0])return 4===n.length?(t=parseInt(n.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===n.length&&(t=parseInt(n.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var i=n.indexOf("("),r=n.indexOf(")");if(-1!==i&&r+1===n.length){var o=n.substr(0,i),s=n.substr(i+1,r-(i+1)).split(","),a=1;switch(o){case"rgba":if(4!==s.length)return null;a=Mt(s.pop());case"rgb":return 3!==s.length?null:[Ct(s[0]),Ct(s[1]),Ct(s[2]),a];case"hsla":if(4!==s.length)return null;a=Mt(s.pop());case"hsl":if(3!==s.length)return null;var l=(parseFloat(s[0])%360+360)%360/360,c=Mt(s[1]),u=Mt(s[2]),d=u<=.5?u*(c+1):u+c-u*c,h=2*u-d;return[Tt(255*It(h,d,l+1/3)),Tt(255*It(h,d,l)),Tt(255*It(h,d,l-1/3)),a];default:return null}}return null}}catch(e){}class At{constructor(e,t,n,i=1){this.r=e,this.g=t,this.b=n,this.a=i}static parse(e){if(!e)return;if(e instanceof At)return e;if("string"!=typeof e)return;const t=Et(e);return t?new At(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toString(){const[e,t,n,i]=this.toArray();return`rgba(${Math.round(e)},${Math.round(t)},${Math.round(n)},${i})`}toArray(){const{r:e,g:t,b:n,a:i}=this;return 0===i?[0,0,0,0]:[255*e/i,255*t/i,255*n/i,i]}toArray01(){const{r:e,g:t,b:n,a:i}=this;return 0===i?[0,0,0,0]:[e/i,t/i,n/i,i]}toArray01PremultipliedAlpha(){const{r:e,g:t,b:n,a:i}=this;return[e,t,n,i]}}At.black=new At(0,0,0,1),At.white=new At(1,1,1,1),At.transparent=new At(0,0,0,0),At.red=new At(1,0,0,1),At.blue=new At(0,0,1,1);var Pt=At;class Ot{constructor(e,t,n){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Dt{constructor(e,t,n,i,r){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=n,this.fontStack=i,this.textColor=r}}class Rt{constructor(e){this.sections=e}static fromString(e){return new Rt([new Dt(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Rt?e:Rt.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.name]);continue}e.push(t.text);const n={};t.fontStack&&(n["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(n["font-scale"]=t.scale),t.textColor&&(n["text-color"]=["rgba"].concat(t.textColor.toArray())),e.push(n)}return e}}class zt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new zt({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Lt(e,t,n,i){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[e,t,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[e,t,n,i]:[e,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Bt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Pt)return!0;if(e instanceof Ot)return!0;if(e instanceof Rt)return!0;if(e instanceof zt)return!0;if(Array.isArray(e)){for(const t of e)if(!Bt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Bt(e[t]))return!1;return!0}return!1}function Nt(e){if(null===e)return lt;if("string"==typeof e)return ut;if("boolean"==typeof e)return dt;if("number"==typeof e)return ct;if(e instanceof Pt)return ht;if(e instanceof Ot)return mt;if(e instanceof Rt)return gt;if(e instanceof zt)return yt;if(Array.isArray(e)){const t=e.length;let n;for(const i of e){const e=Nt(i);if(n){if(n===e)continue;n=ft;break}n=e}return vt(n||ft,t)}return pt}function Ft(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Pt||e instanceof Rt||e instanceof zt?e.toString():JSON.stringify(e)}class $t{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Bt(e[1]))return t.error("invalid value");const n=e[1];let i=Nt(n);const r=t.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new $t(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Pt?["rgba"].concat(this.value.toArray()):this.value instanceof Rt?this.value.serialize():this.value}}var jt=$t,Vt=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};const Ut={string:ut,number:ct,boolean:dt,object:pt};class qt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n,i=1;const r=e[0];if("array"===r){let r,o;if(e.length>2){const n=e[1];if("string"!=typeof n||!(n in Ut)||"object"===n)return t.error('The item type argument of "array" must be one of string, number, boolean',1);r=Ut[n],i++}else r=ft;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],i++}n=vt(r,o)}else n=Ut[r];const o=[];for(;i<e.length;i++){const n=t.parse(e[i],i,ft);if(!n)return null;o.push(n)}return new qt(n,o)}evaluate(e){for(let t=0;t<this.args.length;t++){const n=this.args[t].evaluate(e);if(!_t(this.type,Nt(n)))return n;if(t===this.args.length-1)throw new Vt(`Expected value to be of type ${bt(this.type)}, but found ${bt(Nt(n))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=this.type,t=[e.kind];if("array"===e.kind){const n=e.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){t.push(n.kind);const i=e.N;("number"==typeof i||this.args.length>1)&&t.push(i)}}return t.concat(this.args.map((e=>e.serialize())))}}var Gt=qt;class Wt{constructor(e){this.type=gt,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&"object"==typeof n)return t.error("First argument must be an image or text section.");const i=[];let r=!1;for(let o=1;o<=e.length-1;++o){const n=e[o];if(r&&"object"==typeof n&&!Array.isArray(n)){r=!1;let e=null;if(n["font-scale"]&&(e=t.parse(n["font-scale"],1,ct),!e))return null;let o=null;if(n["text-font"]&&(o=t.parse(n["text-font"],1,vt(ut)),!o))return null;let s=null;if(n["text-color"]&&(s=t.parse(n["text-color"],1,ht),!s))return null;const a=i[i.length-1];a.scale=e,a.font=o,a.textColor=s}else{const n=t.parse(e[o],1,ft);if(!n)return null;const s=n.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:n,scale:null,font:null,textColor:null})}}return new Wt(i)}evaluate(e){return new Rt(this.sections.map((t=>{const n=t.content.evaluate(e);return Nt(n)===yt?new Dt("",n,null,null,null):new Dt(Ft(n),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const n={};t.scale&&(n["font-scale"]=t.scale.serialize()),t.font&&(n["text-font"]=t.font.serialize()),t.textColor&&(n["text-color"]=t.textColor.serialize()),e.push(n)}return e}}class Ht{constructor(e){this.type=yt,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const n=t.parse(e[1],1,ut);return n?new Ht(n):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),n=zt.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Zt={"to-boolean":dt,"to-color":ht,"to-number":ct,"to-string":ut};class Xt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[0];if(("to-boolean"===n||"to-string"===n)&&2!==e.length)return t.error("Expected one argument.");const i=Zt[n],r=[];for(let o=1;o<e.length;o++){const n=t.parse(e[o],o,ft);if(!n)return null;r.push(n)}return new Xt(i,r)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,n;for(const i of this.args){if(t=i.evaluate(e),n=null,t instanceof Pt)return t;if("string"==typeof t){const n=e.parseColor(t);if(n)return n}else if(Array.isArray(t)&&(n=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:Lt(t[0],t[1],t[2],t[3]),!n))return new Pt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Vt(n||`Could not parse color from value '${"string"==typeof t?t:String(JSON.stringify(t))}'`)}if("number"===this.type.kind){let t=null;for(const n of this.args){if(t=n.evaluate(e),null===t)return 0;const i=Number(t);if(!isNaN(i))return i}throw new Vt(`Could not convert ${JSON.stringify(t)} to number.`)}return"formatted"===this.type.kind?Rt.fromString(Ft(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?zt.fromString(Ft(this.args[0].evaluate(e))):Ft(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new Wt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ht(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild((t=>{e.push(t.serialize())})),e}}var Kt=Xt;const Jt=["Unknown","Point","LineString","Polygon"];var Yt=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Jt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:n,y:i}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*t-e[0])+this.featureDistanceData.bearing[1]*(i*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Pt.parse(e)),t}};class Qt{constructor(e,t,n,i){this.name=e,this.type=t,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((e=>e.serialize())))}static parse(e,t){const n=e[0],i=Qt.definitions[n];if(!i)return t.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=o.filter((([t])=>!Array.isArray(t)||t.length===e.length-1));let a=null;for(const[l,c]of s){a=new Cn(t.registry,t.path,null,t.scope);const i=[];let o=!1;for(let t=1;t<e.length;t++){const n=e[t],r=Array.isArray(l)?l[t-1]:l.type,s=a.parse(n,1+i.length,r);if(!s){o=!0;break}i.push(s)}if(!o)if(Array.isArray(l)&&l.length!==i.length)a.error(`Expected ${l.length} arguments, but found ${i.length} instead.`);else{for(let e=0;e<i.length;e++){const t=Array.isArray(l)?l[e]:l.type,n=i[e];a.concat(e+1).checkSubtype(t,n.type)}if(0===a.errors.length)return new Qt(n,r,c,i)}}if(1===s.length)t.errors.push(...a.errors);else{const n=(s.length?s:o).map((([e])=>{return t=e,Array.isArray(t)?`(${t.map(bt).join(", ")})`:`(${bt(t.type)}...)`;var t})).join(" | "),i=[];for(let r=1;r<e.length;r++){const n=t.parse(e[r],1+i.length);if(!n)return null;i.push(bt(n.type))}t.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(e,t){Qt.definitions=t;for(const n in t)e[n]=Qt}}var en=Qt;class tn{constructor(e,t,n){this.type=mt,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const n=e[1];if("object"!=typeof n||Array.isArray(n))return t.error("Collator options argument must be an object.");const i=t.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,dt);if(!i)return null;const r=t.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,dt);if(!r)return null;let o=null;return n.locale&&(o=t.parse(n.locale,1,ut),!o)?null:new tn(i,r,o)}evaluate(e){return new Ot(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const nn=8192;function rn(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function on(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function sn(e,t){const n=(180+e[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,r=Math.pow(2,t.z);return[Math.round(n*r*nn),Math.round(i*r*nn)]}function an(e,t,n){const i=e[0]-t[0],r=e[1]-t[1],o=e[0]-n[0],s=e[1]-n[1];return i*s-o*r==0&&i*o<=0&&r*s<=0}function ln(e,t){let n=!1;for(let s=0,a=t.length;s<a;s++){const a=t[s];for(let t=0,s=a.length;t<s-1;t++){if(an(e,a[t],a[t+1]))return!1;(r=a[t])[1]>(i=e)[1]!=(o=a[t+1])[1]>i[1]&&i[0]<(o[0]-r[0])*(i[1]-r[1])/(o[1]-r[1])+r[0]&&(n=!n)}}var i,r,o;return n}function cn(e,t){for(let n=0;n<t.length;n++)if(ln(e,t[n]))return!0;return!1}function un(e,t,n,i){const r=i[0]-n[0],o=i[1]-n[1],s=(e[0]-n[0])*o-r*(e[1]-n[1]),a=(t[0]-n[0])*o-r*(t[1]-n[1]);return s>0&&a<0||s<0&&a>0}function dn(e,t,n){for(const c of n)for(let n=0;n<c.length-1;++n)if(0!=(a=[(s=c[n+1])[0]-(o=c[n])[0],s[1]-o[1]])[0]*(l=[(r=t)[0]-(i=e)[0],r[1]-i[1]])[1]-a[1]*l[0]&&un(i,r,o,s)&&un(o,s,i,r))return!0;var i,r,o,s,a,l;return!1}function hn(e,t){for(let n=0;n<e.length;++n)if(!ln(e[n],t))return!1;for(let n=0;n<e.length-1;++n)if(dn(e[n],e[n+1],t))return!1;return!0}function pn(e,t){for(let n=0;n<t.length;n++)if(hn(e,t[n]))return!0;return!1}function fn(e,t,n){const i=[];for(let r=0;r<e.length;r++){const o=[];for(let i=0;i<e[r].length;i++){const s=sn(e[r][i],n);rn(t,s),o.push(s)}i.push(o)}return i}function mn(e,t,n){const i=[];for(let r=0;r<e.length;r++){const o=fn(e[r],t,n);i.push(o)}return i}function gn(e,t,n,i){if(e[0]<n[0]||e[0]>n[2]){const t=.5*i;let r=e[0]-n[0]>t?-i:n[0]-e[0]>t?i:0;0===r&&(r=e[0]-n[2]>t?-i:n[2]-e[0]>t?i:0),e[0]+=r}rn(t,e)}function yn(e,t,n,i){const r=Math.pow(2,i.z)*nn,o=[i.x*nn,i.y*nn],s=[];if(!e)return s;for(const a of e)for(const e of a){const i=[e.x+o[0],e.y+o[1]];gn(i,t,n,r),s.push(i)}return s}function vn(e,t,n,i){const r=Math.pow(2,i.z)*nn,o=[i.x*nn,i.y*nn],s=[];if(!e)return s;for(const l of e){const e=[];for(const n of l){const i=[n.x+o[0],n.y+o[1]];rn(t,i),e.push(i)}s.push(e)}if(t[2]-t[0]<=r/2){(a=t)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const e of s)for(const i of e)gn(i,t,n,r)}var a;return s}class bn{constructor(e,t){this.type=dt,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Bt(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const n=t.features[e].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new bn(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new bn(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new bn(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){const o=fn(t.coordinates,i,r),s=yn(e.geometry(),n,i,r);if(!on(n,i))return!1;for(const e of s)if(!ln(e,o))return!1}if("MultiPolygon"===t.type){const o=mn(t.coordinates,i,r),s=yn(e.geometry(),n,i,r);if(!on(n,i))return!1;for(const e of s)if(!cn(e,o))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=e.canonicalID();if(!r)return!1;if("Polygon"===t.type){const o=fn(t.coordinates,i,r),s=vn(e.geometry(),n,i,r);if(!on(n,i))return!1;for(const e of s)if(!hn(e,o))return!1}if("MultiPolygon"===t.type){const o=mn(t.coordinates,i,r),s=vn(e.geometry(),n,i,r);if(!on(n,i))return!1;for(const e of s)if(!pn(e,o))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var xn=bn;function _n(e){if(e instanceof en){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof xn)return!1;let t=!0;return e.eachChild((e=>{t&&!_n(e)&&(t=!1)})),t}function wn(e){if(e instanceof en&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!wn(e)&&(t=!1)})),t}function kn(e,t){if(e instanceof en&&t.indexOf(e.name)>=0)return!1;let n=!0;return e.eachChild((e=>{n&&!kn(e,t)&&(n=!1)})),n}class En{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const n=e[1];return t.scope.has(n)?new En(n,t.scope.get(n)):t.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Sn=En;class Tn{constructor(e,t=[],n,i=new at,r=[]){this.registry=e,this.path=t,this.key=t.map((e=>`[${e}]`)).join(""),this.scope=i,this.errors=r,this.expectedType=n}parse(e,t,n,i,r={}){return t?this.concat(t,n,i)._parse(e,r):this._parse(e,r)}_parse(e,t){function n(e,t,n){return"assert"===n?new Gt(t,[e]):"coerce"===n?new Kt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=e[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[i];if(r){let i=r.parse(e,this);if(!i)return null;if(this.expectedType){const e=this.expectedType,r=i.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==r.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(e,r))return null}else i=n(i,e,t.typeAnnotation||"coerce");else i=n(i,e,t.typeAnnotation||"assert")}if(!(i instanceof jt)&&"resolvedImage"!==i.type.kind&&Mn(i)){const t=new Yt;try{i=new jt(i.type,i.evaluate(t))}catch(e){return this.error(e.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,n){const i="number"==typeof e?this.path.concat(e):this.path,r=n?this.scope.concat(n):this.scope;return new Tn(this.registry,i,t||null,r,this.errors)}error(e,...t){const n=`${this.key}${t.map((e=>`[${e}]`)).join("")}`;this.errors.push(new ot(n,e))}checkSubtype(e,t){const n=_t(e,t);return n&&this.error(n),n}}var Cn=Tn;function Mn(e){if(e instanceof Sn)return Mn(e.boundExpression);if(e instanceof en&&"error"===e.name)return!1;if(e instanceof tn)return!1;if(e instanceof xn)return!1;const t=e instanceof Kt||e instanceof Gt;let n=!0;return e.eachChild((e=>{n=t?n&&Mn(e):n&&e instanceof jt})),!!n&&_n(e)&&kn(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function In(e,t){const n=e.length-1;let i,r,o=0,s=n,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),i=e[a],r=e[a+1],i<=t){if(a===n||t<r)return a;o=a+1}else{if(!(i>t))throw new Vt("Input is not a number.");s=a-1}return 0}class An{constructor(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[i,r]of n)this.labels.push(i),this.outputs.push(r)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const n=t.parse(e[1],1,ct);if(!n)return null;const i=[];let r=null;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(let o=1;o<e.length;o+=2){const n=1===o?-1/0:e[o],s=e[o+1],a=o,l=o+1;if("number"!=typeof n)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(i.length&&i[i.length-1][0]>=n)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const c=t.parse(s,l,r);if(!c)return null;r=r||c.type,i.push([n,c])}return new An(r,n,i)}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);const r=t.length;return i>=t[r-1]?n[r-1].evaluate(e):n[In(t,i)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}var Pn=An;function On(e,t,n){return e*(1-n)+t*n}var Dn=Object.freeze({__proto__:null,array:function(e,t,n){return e.map(((e,i)=>On(e,t[i],n)))},color:function(e,t,n){return new Pt(On(e.r,t.r,n),On(e.g,t.g,n),On(e.b,t.b,n),On(e.a,t.a,n))},number:On});const Rn=.95047,zn=1.08883,Ln=4/29,Bn=6/29,Nn=3*Bn*Bn,Fn=Bn*Bn*Bn,$n=Math.PI/180,jn=180/Math.PI;function Vn(e){return e>Fn?Math.pow(e,1/3):e/Nn+Ln}function Un(e){return e>Bn?e*e*e:Nn*(e-Ln)}function qn(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gn(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Wn(e){const t=Gn(e.r),n=Gn(e.g),i=Gn(e.b),r=Vn((.4124564*t+.3575761*n+.1804375*i)/Rn),o=Vn((.2126729*t+.7151522*n+.072175*i)/1);return{l:116*o-16,a:500*(r-o),b:200*(o-Vn((.0193339*t+.119192*n+.9503041*i)/zn)),alpha:e.a}}function Hn(e){let t=(e.l+16)/116,n=isNaN(e.a)?t:t+e.a/500,i=isNaN(e.b)?t:t-e.b/200;return t=1*Un(t),n=Rn*Un(n),i=zn*Un(i),new Pt(qn(3.2404542*n-1.5371385*t-.4985314*i),qn(-.969266*n+1.8760108*t+.041556*i),qn(.0556434*n-.2040259*t+1.0572252*i),e.alpha)}function Zn(e,t,n){const i=t-e;return e+n*(i>180||i<-180?i-360*Math.round(i/360):i)}const Xn={forward:Wn,reverse:Hn,interpolate:function(e,t,n){return{l:On(e.l,t.l,n),a:On(e.a,t.a,n),b:On(e.b,t.b,n),alpha:On(e.alpha,t.alpha,n)}}},Kn={forward:function(e){const{l:t,a:n,b:i}=Wn(e),r=Math.atan2(i,n)*jn;return{h:r<0?r+360:r,c:Math.sqrt(n*n+i*i),l:t,alpha:e.a}},reverse:function(e){const t=e.h*$n,n=e.c;return Hn({l:e.l,a:Math.cos(t)*n,b:Math.sin(t)*n,alpha:e.alpha})},interpolate:function(e,t,n){return{h:Zn(e.h,t.h,n),c:On(e.c,t.c,n),l:On(e.l,t.l,n),alpha:On(e.alpha,t.alpha,n)}}};var Jn=Object.freeze({__proto__:null,hcl:Kn,lab:Xn});class Yn{constructor(e,t,n,i,r){this.type=e,this.operator=t,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[o,s]of r)this.labels.push(o),this.outputs.push(s)}static interpolationFactor(e,t,n,i){let r=0;if("exponential"===e.name)r=Qn(t,e.base,n,i);else if("linear"===e.name)r=Qn(t,1,n,i);else if("cubic-bezier"===e.name){const o=e.controlPoints;r=new m(o[0],o[1],o[2],o[3]).solve(Qn(t,1,n,i))}return r}static parse(e,t){let[n,i,r,...o]=e;if(!Array.isArray(i)||0===i.length)return t.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const e=i[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:e}}else{if("cubic-bezier"!==i[0])return t.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const e=i.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(r=t.parse(r,2,ct),!r)return null;const s=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=ht:t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType);for(let l=0;l<o.length;l+=2){const e=o[l],n=o[l+1],i=l+3,r=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(s.length&&s[s.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const c=t.parse(n,r,a);if(!c)return null;a=a||c.type,s.push([e,c])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new Yn(a,n,i,r,s):t.error(`Type ${bt(a)} is not interpolatable.`)}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);const r=t.length;if(i>=t[r-1])return n[r-1].evaluate(e);const o=In(t,i),s=Yn.interpolationFactor(this.interpolation,i,t[o],t[o+1]),a=n[o].evaluate(e),l=n[o+1].evaluate(e);return"interpolate"===this.operator?Dn[this.type.kind.toLowerCase()](a,l,s):"interpolate-hcl"===this.operator?Kn.reverse(Kn.interpolate(Kn.forward(a),Kn.forward(l),s)):Xn.reverse(Xn.interpolate(Xn.forward(a),Xn.forward(l),s))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];for(let n=0;n<this.labels.length;n++)t.push(this.labels[n],this.outputs[n].serialize());return t}}function Qn(e,t,n,i){const r=i-n,o=e-n;return 0===r?0:1===t?o/r:(Math.pow(t,o)-1)/(Math.pow(t,r)-1)}var ei=Yn;class ti{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let n=null;const i=t.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const s of e.slice(1)){const e=t.parse(s,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!e)return null;n=n||e.type,r.push(e)}const o=i&&r.some((e=>_t(i,e.type)));return new ti(o?ft:n,r)}evaluate(e){let t,n=null,i=0;for(const r of this.args){if(i++,n=r.evaluate(e),n&&n instanceof zt&&!n.available&&(t||(t=n),n=null,i===this.args.length))return t;if(null!==n)break}return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=["coalesce"];return this.eachChild((t=>{e.push(t.serialize())})),e}}var ni=ti;class ii{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const n=[];for(let r=1;r<e.length-1;r+=2){const i=e[r];if("string"!=typeof i)return t.error(`Expected string, but found ${typeof i} instead.`,r);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",r);const o=t.parse(e[r+1],r+1);if(!o)return null;n.push([i,o])}const i=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return i?new ii(n,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,n]of this.bindings)e.push(t,n.serialize());return e.push(this.result.serialize()),e}}var ri=ii;class oi{constructor(e,t,n){this.type=e,this.index=t,this.input=n}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,ct),i=t.parse(e[2],2,vt(t.expectedType||ft));return n&&i?new oi(i.type.itemType,n,i):null}evaluate(e){const t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new Vt(`Array index out of bounds: ${t} < 0.`);if(t>=n.length)throw new Vt(`Array index out of bounds: ${t} > ${n.length-1}.`);if(t!==Math.floor(t))throw new Vt(`Array index must be an integer, but found ${t} instead.`);return n[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var si=oi;class ai{constructor(e,t){this.type=dt,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,ft),i=t.parse(e[2],2,ft);return n&&i?wt(n.type,[dt,ut,ct,lt,ft])?new ai(n,i):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${bt(n.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(null==n)return!1;if(!kt(t,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${bt(Nt(t))} instead.`);if(!kt(n,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${bt(Nt(n))} instead.`);return n.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var li=ai;class ci{constructor(e,t,n){this.type=ct,this.needle=e,this.haystack=t,this.fromIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,ft),i=t.parse(e[2],2,ft);if(!n||!i)return null;if(!wt(n.type,[dt,ut,ct,lt,ft]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${bt(n.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,ct);return r?new ci(n,i,r):null}return new ci(n,i)}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!kt(t,["boolean","string","number","null"]))throw new Vt(`Expected first argument to be of type boolean, string, number or null, but found ${bt(Nt(t))} instead.`);if(!kt(n,["string","array"]))throw new Vt(`Expected second argument to be of type array or string, but found ${bt(Nt(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(e);return n.indexOf(t,i)}return n.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var ui=ci;class di{constructor(e,t,n,i,r,o){this.inputType=e,this.type=t,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let n,i;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);const r={},o=[];for(let l=2;l<e.length-1;l+=2){let s=e[l];const a=e[l+1];Array.isArray(s)||(s=[s]);const c=t.concat(l);if(0===s.length)return c.error("Expected at least one branch label.");for(const e of s){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,Nt(e)))return null}else n=Nt(e);if(void 0!==r[String(e)])return c.error("Branch labels must be unique.");r[String(e)]=o.length}const u=t.parse(a,l,i);if(!u)return null;i=i||u.type,o.push(u)}const s=t.parse(e[1],1,ft);if(!s)return null;const a=t.parse(e[e.length-1],e.length-1,i);return a?"value"!==s.type.kind&&t.concat(1).checkSubtype(n,s.type)?null:new di(n,i,s,r,o,a):null}evaluate(e){const t=this.input.evaluate(e);return(Nt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),n=[],i={};for(const o of t){const e=i[this.cases[o]];void 0===e?(i[this.cases[o]]=n.length,n.push([this.cases[o],[o]])):n[e][1].push(o)}const r=e=>"number"===this.inputType.kind?Number(e):e;for(const[o,s]of n)e.push(1===s.length?r(s[0]):s.map(r)),e.push(this.outputs[o].serialize());return e.push(this.otherwise.serialize()),e}}var hi=di;class pi{constructor(e,t,n){this.type=e,this.branches=t,this.otherwise=n}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i=[];for(let o=1;o<e.length-1;o+=2){const r=t.parse(e[o],o,dt);if(!r)return null;const s=t.parse(e[o+1],o+1,n);if(!s)return null;i.push([r,s]),n=n||s.type}const r=t.parse(e[e.length-1],e.length-1,n);return r?new pi(n,i,r):null}evaluate(e){for(const[t,n]of this.branches)if(t.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,n]of this.branches)e(t),e(n);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild((t=>{e.push(t.serialize())})),e}}var fi=pi;class mi{constructor(e,t,n,i){this.type=e,this.input=t,this.beginIndex=n,this.endIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,ft),i=t.parse(e[2],2,ct);if(!n||!i)return null;if(!wt(n.type,[vt(ft),ut,ft]))return t.error(`Expected first argument to be of type array or string, but found ${bt(n.type)} instead`);if(4===e.length){const r=t.parse(e[3],3,ct);return r?new mi(n.type,n,i,r):null}return new mi(n.type,n,i)}evaluate(e){const t=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!kt(t,["string","array"]))throw new Vt(`Expected first argument to be of type array or string, but found ${bt(Nt(t))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(e);return t.slice(n,i)}return t.slice(n)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var gi=mi;function yi(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function vi(e,t,n,i){return 0===i.compare(t,n)}function bi(e,t,n){const i="=="!==e&&"!="!==e;return class r{constructor(e,t,n){this.type=dt,this.lhs=e,this.rhs=t,this.collator=n,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const n=e[0];let o=t.parse(e[1],1,ft);if(!o)return null;if(!yi(n,o.type))return t.concat(1).error(`"${n}" comparisons are not supported for type '${bt(o.type)}'.`);let s=t.parse(e[2],2,ft);if(!s)return null;if(!yi(n,s.type))return t.concat(2).error(`"${n}" comparisons are not supported for type '${bt(s.type)}'.`);if(o.type.kind!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return t.error(`Cannot compare types '${bt(o.type)}' and '${bt(s.type)}'.`);i&&("value"===o.type.kind&&"value"!==s.type.kind?o=new Gt(s.type,[o]):"value"!==o.type.kind&&"value"===s.type.kind&&(s=new Gt(o.type,[s])));let a=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return t.error("Cannot use collator to compare non-string types.");if(a=t.parse(e[3],3,mt),!a)return null}return new r(o,s,a)}evaluate(r){const o=this.lhs.evaluate(r),s=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const t=Nt(o),n=Nt(s);if(t.kind!==n.kind||"string"!==t.kind&&"number"!==t.kind)throw new Vt(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const e=Nt(o),n=Nt(s);if("string"!==e.kind||"string"!==n.kind)return t(r,o,s)}return this.collator?n(r,o,s,this.collator.evaluate(r)):t(r,o,s)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}serialize(){const t=[e];return this.eachChild((e=>{t.push(e.serialize())})),t}}}const xi=bi("==",(function(e,t,n){return t===n}),vi),_i=bi("!=",(function(e,t,n){return t!==n}),(function(e,t,n,i){return!vi(0,t,n,i)})),wi=bi("<",(function(e,t,n){return t<n}),(function(e,t,n,i){return i.compare(t,n)<0})),ki=bi(">",(function(e,t,n){return t>n}),(function(e,t,n,i){return i.compare(t,n)>0})),Ei=bi("<=",(function(e,t,n){return t<=n}),(function(e,t,n,i){return i.compare(t,n)<=0})),Si=bi(">=",(function(e,t,n){return t>=n}),(function(e,t,n,i){return i.compare(t,n)>=0}));class Ti{constructor(e,t,n,i,r,o){this.type=ut,this.number=e,this.locale=t,this.currency=n,this.unit=i,this.minFractionDigits=r,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const n=t.parse(e[1],1,ct);if(!n)return null;const i=e[2];if("object"!=typeof i||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=t.parse(i.locale,1,ut),!r))return null;let o=null;if(i.currency&&(o=t.parse(i.currency,1,ut),!o))return null;let s=null;if(i.unit&&(s=t.parse(i.unit,1,ut),!s))return null;let a=null;if(i["min-fraction-digits"]&&(a=t.parse(i["min-fraction-digits"],1,ct),!a))return null;let l=null;return i["max-fraction-digits"]&&(l=t.parse(i["max-fraction-digits"],1,ct),!l)?null:new Ti(n,r,o,s,a,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ci{constructor(e){this.type=ct,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const n=t.parse(e[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?t.error(`Expected argument of type string or array, but found ${bt(n.type)} instead.`):new Ci(n):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Vt(`Expected value to be of type string or array, but found ${bt(Nt(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild((t=>{e.push(t.serialize())})),e}}const Mi={"==":xi,"!=":_i,">":ki,"<":wi,">=":Si,"<=":Ei,array:Gt,at:si,boolean:Gt,case:fi,coalesce:ni,collator:tn,format:Wt,image:Ht,in:li,"index-of":ui,interpolate:ei,"interpolate-hcl":ei,"interpolate-lab":ei,length:Ci,let:ri,literal:jt,match:hi,number:Gt,"number-format":Ti,object:Gt,slice:gi,step:Pn,string:Gt,"to-boolean":Kt,"to-color":Kt,"to-number":Kt,"to-string":Kt,var:Sn,within:xn};function Ii(e,[t,n,i,r]){t=t.evaluate(e),n=n.evaluate(e),i=i.evaluate(e);const o=r?r.evaluate(e):1,s=Lt(t,n,i,o);if(s)throw new Vt(s);return new Pt(t/255*o,n/255*o,i/255*o,o)}function Ai(e,t){return e in t}function Pi(e,t){const n=t[e];return void 0===n?null:n}function Oi(e){return{type:e}}en.register(Mi,{error:[{kind:"error"},[ut],(e,[t])=>{throw new Vt(t.evaluate(e))}],typeof:[ut,[ft],(e,[t])=>bt(Nt(t.evaluate(e)))],"to-rgba":[vt(ct,4),[ht],(e,[t])=>t.evaluate(e).toArray()],rgb:[ht,[ct,ct,ct],Ii],rgba:[ht,[ct,ct,ct,ct],Ii],has:{type:dt,overloads:[[[ut],(e,[t])=>Ai(t.evaluate(e),e.properties())],[[ut,pt],(e,[t,n])=>Ai(t.evaluate(e),n.evaluate(e))]]},get:{type:ft,overloads:[[[ut],(e,[t])=>Pi(t.evaluate(e),e.properties())],[[ut,pt],(e,[t,n])=>Pi(t.evaluate(e),n.evaluate(e))]]},"feature-state":[ft,[ut],(e,[t])=>Pi(t.evaluate(e),e.featureState||{})],properties:[pt,[],e=>e.properties()],"geometry-type":[ut,[],e=>e.geometryType()],id:[ft,[],e=>e.id()],zoom:[ct,[],e=>e.globals.zoom],pitch:[ct,[],e=>e.globals.pitch||0],"distance-from-center":[ct,[],e=>e.distanceFromCenter()],"heatmap-density":[ct,[],e=>e.globals.heatmapDensity||0],"line-progress":[ct,[],e=>e.globals.lineProgress||0],"sky-radial-progress":[ct,[],e=>e.globals.skyRadialProgress||0],accumulated:[ft,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[ct,Oi(ct),(e,t)=>{let n=0;for(const i of t)n+=i.evaluate(e);return n}],"*":[ct,Oi(ct),(e,t)=>{let n=1;for(const i of t)n*=i.evaluate(e);return n}],"-":{type:ct,overloads:[[[ct,ct],(e,[t,n])=>t.evaluate(e)-n.evaluate(e)],[[ct],(e,[t])=>-t.evaluate(e)]]},"/":[ct,[ct,ct],(e,[t,n])=>t.evaluate(e)/n.evaluate(e)],"%":[ct,[ct,ct],(e,[t,n])=>t.evaluate(e)%n.evaluate(e)],ln2:[ct,[],()=>Math.LN2],pi:[ct,[],()=>Math.PI],e:[ct,[],()=>Math.E],"^":[ct,[ct,ct],(e,[t,n])=>Math.pow(t.evaluate(e),n.evaluate(e))],sqrt:[ct,[ct],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[ct,[ct],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[ct,[ct],(e,[t])=>Math.log(t.evaluate(e))],log2:[ct,[ct],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[ct,[ct],(e,[t])=>Math.sin(t.evaluate(e))],cos:[ct,[ct],(e,[t])=>Math.cos(t.evaluate(e))],tan:[ct,[ct],(e,[t])=>Math.tan(t.evaluate(e))],asin:[ct,[ct],(e,[t])=>Math.asin(t.evaluate(e))],acos:[ct,[ct],(e,[t])=>Math.acos(t.evaluate(e))],atan:[ct,[ct],(e,[t])=>Math.atan(t.evaluate(e))],min:[ct,Oi(ct),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[ct,Oi(ct),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[ct,[ct],(e,[t])=>Math.abs(t.evaluate(e))],round:[ct,[ct],(e,[t])=>{const n=t.evaluate(e);return n<0?-Math.round(-n):Math.round(n)}],floor:[ct,[ct],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[ct,[ct],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[dt,[ut,ft],(e,[t,n])=>e.properties()[t.value]===n.value],"filter-id-==":[dt,[ft],(e,[t])=>e.id()===t.value],"filter-type-==":[dt,[ut],(e,[t])=>e.geometryType()===t.value],"filter-<":[dt,[ut,ft],(e,[t,n])=>{const i=e.properties()[t.value],r=n.value;return typeof i==typeof r&&i<r}],"filter-id-<":[dt,[ft],(e,[t])=>{const n=e.id(),i=t.value;return typeof n==typeof i&&n<i}],"filter->":[dt,[ut,ft],(e,[t,n])=>{const i=e.properties()[t.value],r=n.value;return typeof i==typeof r&&i>r}],"filter-id->":[dt,[ft],(e,[t])=>{const n=e.id(),i=t.value;return typeof n==typeof i&&n>i}],"filter-<=":[dt,[ut,ft],(e,[t,n])=>{const i=e.properties()[t.value],r=n.value;return typeof i==typeof r&&i<=r}],"filter-id-<=":[dt,[ft],(e,[t])=>{const n=e.id(),i=t.value;return typeof n==typeof i&&n<=i}],"filter->=":[dt,[ut,ft],(e,[t,n])=>{const i=e.properties()[t.value],r=n.value;return typeof i==typeof r&&i>=r}],"filter-id->=":[dt,[ft],(e,[t])=>{const n=e.id(),i=t.value;return typeof n==typeof i&&n>=i}],"filter-has":[dt,[ft],(e,[t])=>t.value in e.properties()],"filter-has-id":[dt,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[dt,[vt(ut)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[dt,[vt(ft)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[dt,[ut,vt(ft)],(e,[t,n])=>n.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[dt,[ut,vt(ft)],(e,[t,n])=>function(e,t,n,i){for(;n<=i;){const r=n+i>>1;if(t[r]===e)return!0;t[r]>e?i=r-1:n=r+1}return!1}(e.properties()[t.value],n.value,0,n.value.length-1)],all:{type:dt,overloads:[[[dt,dt],(e,[t,n])=>t.evaluate(e)&&n.evaluate(e)],[Oi(dt),(e,t)=>{for(const n of t)if(!n.evaluate(e))return!1;return!0}]]},any:{type:dt,overloads:[[[dt,dt],(e,[t,n])=>t.evaluate(e)||n.evaluate(e)],[Oi(dt),(e,t)=>{for(const n of t)if(n.evaluate(e))return!0;return!1}]]},"!":[dt,[dt],(e,[t])=>!t.evaluate(e)],"is-supported-script":[dt,[ut],(e,[t])=>{const n=e.globals&&e.globals.isSupportedScript;return!n||n(t.evaluate(e))}],upcase:[ut,[ut],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[ut,[ut],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[ut,Oi(ft),(e,t)=>t.map((t=>Ft(t.evaluate(e)))).join("")],"resolved-locale":[ut,[mt],(e,[t])=>t.evaluate(e).resolvedLocale()]});var Di=Mi;function Ri(e){return{result:"success",value:e}}function zi(e){return{result:"error",value:e}}function Li(e){return"data-driven"===e["property-type"]}function Bi(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Ni(e){return!!e.expression&&e.expression.interpolated}function Fi(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function $i(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function ji(e){return e}function Vi(e,t){const n="color"===t.type,i=e.stops&&"object"==typeof e.stops[0][0],r=i||!(i||void 0!==e.property),o=e.type||(Ni(t)?"exponential":"interval");if(n&&((e=tt({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],Pt.parse(e[1])]))),e.default=Pt.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Jn[e.colorSpace])throw new Error(`Unknown color space: ${e.colorSpace}`);let s,a,l;if("exponential"===o)s=Wi;else if("interval"===o)s=Gi;else if("categorical"===o){s=qi,a=Object.create(null);for(const t of e.stops)a[t[0]]=t[1];l=typeof e.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);s=Hi}if(i){const n={},i=[];for(let t=0;t<e.stops.length;t++){const r=e.stops[t],o=r[0].zoom;void 0===n[o]&&(n[o]={zoom:o,type:e.type,property:e.property,default:e.default,stops:[]},i.push(o)),n[o].stops.push([r[0].value,r[1]])}const r=[];for(const e of i)r.push([n[e].zoom,Vi(n[e],t)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:ei.interpolationFactor.bind(void 0,o),zoomStops:r.map((e=>e[0])),evaluate:({zoom:n},i)=>Wi({stops:r,base:e.base},t,n).evaluate(n,i)}}if(r){const n="exponential"===o?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:ei.interpolationFactor.bind(void 0,n),zoomStops:e.stops.map((e=>e[0])),evaluate:({zoom:n})=>s(e,t,n,a,l)}}return{kind:"source",evaluate(n,i){const r=i&&i.properties?i.properties[e.property]:void 0;return void 0===r?Ui(e.default,t.default):s(e,t,r,a,l)}}}function Ui(e,t,n){return void 0!==e?e:void 0!==t?t:void 0!==n?n:void 0}function qi(e,t,n,i,r){return Ui(typeof n===r?i[n]:void 0,e.default,t.default)}function Gi(e,t,n){if("number"!==Fi(n))return Ui(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[i-1][0])return e.stops[i-1][1];const r=In(e.stops.map((e=>e[0])),n);return e.stops[r][1]}function Wi(e,t,n){const i=void 0!==e.base?e.base:1;if("number"!==Fi(n))return Ui(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[r-1][0])return e.stops[r-1][1];const o=In(e.stops.map((e=>e[0])),n),s=function(e,t,n,i){const r=i-n,o=e-n;return 0===r?0:1===t?o/r:(Math.pow(t,o)-1)/(Math.pow(t,r)-1)}(n,i,e.stops[o][0],e.stops[o+1][0]),a=e.stops[o][1],l=e.stops[o+1][1];let c=Dn[t.type]||ji;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=Jn[e.colorSpace];c=(e,n)=>t.reverse(t.interpolate(t.forward(e),t.forward(n),s))}return"function"==typeof a.evaluate?{evaluate(...e){const t=a.evaluate.apply(void 0,e),n=l.evaluate.apply(void 0,e);if(void 0!==t&&void 0!==n)return c(t,n,s)}}:c(a,l,s)}function Hi(e,t,n){return"color"===t.type?n=Pt.parse(n):"formatted"===t.type?n=Rt.fromString(n.toString()):"resolvedImage"===t.type?n=zt.fromString(n.toString()):Fi(n)===t.type||"enum"===t.type&&t.values[n]||(n=void 0),Ui(n,e.default,t.default)}class Zi{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Yt,this._defaultValue=t?function(e){return"color"===e.type&&($i(e.default)||Array.isArray(e.default))?new Pt(0,0,0,0):"color"===e.type?Pt.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,n,i,r,o,s,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,n,i,r,o,s,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Vt(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Xi(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Di}function Ki(e,t){const n=new Cn(Di,[],t?function(e){const t={color:ht,string:ut,number:ct,enum:ut,boolean:dt,formatted:gt,resolvedImage:yt};return"array"===e.type?vt(t[e.value]||ft,e.length):t[e.type]}(t):void 0),i=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return i?Ri(new Zi(i,t)):zi(n.errors)}class Ji{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!wn(t.expression)}evaluateWithoutErrorHandling(e,t,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,r,o)}evaluate(e,t,n,i,r,o){return this._styleExpression.evaluate(e,t,n,i,r,o)}}class Yi{constructor(e,t,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent="camera"!==e&&!wn(t.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,t,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,r,o)}evaluate(e,t,n,i,r,o){return this._styleExpression.evaluate(e,t,n,i,r,o)}interpolationFactor(e,t,n){return this.interpolationType?ei.interpolationFactor(this.interpolationType,e,t,n):0}}function Qi(e,t){if("error"===(e=Ki(e,t)).result)return e;const n=e.value.expression,i=_n(n);if(!i&&!Li(t))return zi([new ot("","data expressions not supported")]);const r=kn(n,["zoom","pitch","distance-from-center"]);if(!r&&!Bi(t))return zi([new ot("","zoom expressions not supported")]);const o=tr(n);return o||r?o instanceof ot?zi([o]):o instanceof ei&&!Ni(t)?zi([new ot("",'"interpolate" expressions cannot be used with this property')]):Ri(o?new Yi(i?"camera":"composite",e.value,o.labels,o instanceof ei?o.interpolation:void 0):new Ji(i?"constant":"source",e.value)):zi([new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class er{constructor(e,t){this._parameters=e,this._specification=t,tt(this,Vi(this._parameters,this._specification))}static deserialize(e){return new er(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function tr(e){let t=null;if(e instanceof ri)t=tr(e.result);else if(e instanceof ni){for(const n of e.args)if(t=tr(n),t)break}else(e instanceof Pn||e instanceof ei)&&e.input instanceof en&&"zoom"===e.input.name&&(t=e);return t instanceof ot||e.eachChild((e=>{const n=tr(e);n instanceof ot?t=n:!t&&n?t=new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&n&&t!==n&&(t=new ot("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}class nr{constructor(e,t,n,i){this.message=(e?`${e}: `:"")+n,i&&(this.identifier=i),null!=t&&t.__line__&&(this.line=t.__line__)}}function ir(e){const t=e.key,n=e.value,i=e.valueSpec||{},r=e.objectElementValidators||{},o=e.style,s=e.styleSpec;let a=[];const l=Fi(n);if("object"!==l)return[new nr(t,n,`object expected, ${l} found`)];for(const c in n){const e=c.split(".")[0];let l;r[e]?l=r[e]:i[e]?l=Br:r["*"]?l=r["*"]:i["*"]&&(l=Br),l?a=a.concat(l({key:(t?`${t}.`:t)+c,value:n[c],valueSpec:i[e]||i["*"],style:o,styleSpec:s,object:n,objectKey:c},n)):a.push(new nr(t,n[c],`unknown property "${c}"`))}for(const c in i)r[c]||i[c].required&&void 0===i[c].default&&void 0===n[c]&&a.push(new nr(t,n,`missing required property "${c}"`));return a}function rr(e){const t=e.value,n=e.valueSpec,i=e.style,r=e.styleSpec,o=e.key,s=e.arrayElementValidator||Br;if("array"!==Fi(t))return[new nr(o,t,`array expected, ${Fi(t)} found`)];if(n.length&&t.length!==n.length)return[new nr(o,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new nr(o,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let a={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};r.$version<7&&(a.function=n.function),"object"===Fi(n.value)&&(a=n.value);let l=[];for(let c=0;c<t.length;c++)l=l.concat(s({array:t,arrayIndex:c,value:t[c],valueSpec:a,style:i,styleSpec:r,key:`${o}[${c}]`}));return l}function or(e){const t=e.key,n=e.value,i=e.valueSpec;let r=Fi(n);if("number"===r&&n!=n&&(r="NaN"),"number"!==r)return[new nr(t,n,`number expected, ${r} found`)];if("minimum"in i){let r=i.minimum;if("array"===Fi(i.minimum)&&(r=i.minimum[e.arrayIndex]),n<r)return[new nr(t,n,`${n} is less than the minimum value ${r}`)]}if("maximum"in i){let r=i.maximum;if("array"===Fi(i.maximum)&&(r=i.maximum[e.arrayIndex]),n>r)return[new nr(t,n,`${n} is greater than the maximum value ${r}`)]}return[]}function sr(e){const t=e.valueSpec,n=nt(e.value.type);let i,r,o,s={};const a="categorical"!==n&&void 0===e.value.property,l=!a,c="array"===Fi(e.value.stops)&&"array"===Fi(e.value.stops[0])&&"object"===Fi(e.value.stops[0][0]),u=ir({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===n)return[new nr(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const i=e.value;return t=t.concat(rr({key:e.key,value:i,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:d})),"array"===Fi(i)&&0===i.length&&t.push(new nr(e.key,i,"array must have at least one stop")),t},default:function(e){return Br({key:e.key,value:e.value,valueSpec:t,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===n&&a&&u.push(new nr(e.key,e.value,'missing required property "property"')),"identity"===n||e.value.stops||u.push(new nr(e.key,e.value,'missing required property "stops"')),"exponential"===n&&e.valueSpec.expression&&!Ni(e.valueSpec)&&u.push(new nr(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!Li(e.valueSpec)?u.push(new nr(e.key,e.value,"property functions not supported")):a&&!Bi(e.valueSpec)&&u.push(new nr(e.key,e.value,"zoom functions not supported"))),"categorical"!==n&&!c||void 0!==e.value.property||u.push(new nr(e.key,e.value,'"property" property is required')),u;function d(e){let n=[];const i=e.value,a=e.key;if("array"!==Fi(i))return[new nr(a,i,`array expected, ${Fi(i)} found`)];if(2!==i.length)return[new nr(a,i,`array length 2 expected, length ${i.length} found`)];if(c){if("object"!==Fi(i[0]))return[new nr(a,i,`object expected, ${Fi(i[0])} found`)];if(void 0===i[0].zoom)return[new nr(a,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new nr(a,i,"object stop key must have value")];const t=nt(i[0].zoom);if("number"!=typeof t)return[new nr(a,i[0].zoom,"stop zoom values must be numbers")];if(o&&o>t)return[new nr(a,i[0].zoom,"stop zoom values must appear in ascending order")];t!==o&&(o=t,r=void 0,s={}),n=n.concat(ir({key:`${a}[0]`,value:i[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:or,value:h}}))}else n=n.concat(h({key:`${a}[0]`,value:i[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},i));return Xi(it(i[1]))?n.concat([new nr(`${a}[1]`,i[1],"expressions are not allowed in function stops.")]):n.concat(Br({key:`${a}[1]`,value:i[1],valueSpec:t,style:e.style,styleSpec:e.styleSpec}))}function h(e,o){const a=Fi(e.value),l=nt(e.value),c=null!==e.value?e.value:o;if(i){if(a!==i)return[new nr(e.key,c,`${a} stop domain type must match previous stop domain type ${i}`)]}else i=a;if("number"!==a&&"string"!==a&&"boolean"!==a&&"number"!=typeof l&&"string"!=typeof l&&"boolean"!=typeof l)return[new nr(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==a&&"categorical"!==n){let i=`number expected, ${a} found`;return Li(t)&&void 0===n&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new nr(e.key,c,i)]}return"categorical"!==n||"number"!==a||"number"==typeof l&&isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===a&&"number"==typeof l&&"number"==typeof r&&void 0!==r&&l<r?[new nr(e.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===n&&l in s?[new nr(e.key,c,"stop domain values must be unique")]:(s[l]=!0,[])):[new nr(e.key,c,`integer expected, found ${String(l)}`)]}}function ar(e){const t=("property"===e.expressionContext?Qi:Ki)(it(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new nr(`${e.key}${t.key}`,e.value,t.message)));const n=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!n.outputDefined())return[new nr(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!wn(n))return[new nr(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return lr(n,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!kn(n,["zoom","feature-state"]))return[new nr(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!_n(n))return[new nr(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function lr(e,t){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const r of t.valueSpec.expression.parameters)n.delete(r);if(0===n.size)return[];const i=[];return e instanceof en&&n.has(e.name)?[new nr(t.key,t.value,`["${e.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(e.eachChild((e=>{i.push(...lr(e,t))})),i)}function cr(e){const t=e.key,n=e.value,i=e.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(nt(n))&&r.push(new nr(t,n,`expected one of [${i.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(i.values).indexOf(nt(n))&&r.push(new nr(t,n,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(n)} found`)),r}function ur(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!ur(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function dr(e,t="fill"){if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ur(e)||(e=vr(e));const n=e;let i=!0;try{i=function(e){if(!fr(e))return e;let t=it(e);return pr(t),t=hr(t),t}(n)}catch(e){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(n,null,2)}\n        `)}const r=et[`filter_${t}`],o=Ki(i,r);let s=null;if("error"===o.result)throw new Error(o.value.map((e=>`${e.key}: ${e.message}`)).join(", "));s=(e,t,n)=>o.value.evaluate(e,t,{},n);let a=null,l=null;if(i!==n){const e=Ki(n,r);if("error"===e.result)throw new Error(e.value.map((e=>`${e.key}: ${e.message}`)).join(", "));a=(t,n,i,r,o)=>e.value.evaluate(t,n,{},i,void 0,void 0,r,o),l=!_n(e.value.expression)}return{filter:s,dynamicFilter:a||void 0,needGeometry:yr(i),needFeature:!!l}}function hr(e){if(!Array.isArray(e))return e;const t=function(e){if(mr.has(e[0]))for(let t=1;t<e.length;t++)if(fr(e[t]))return!0;return e}(e);return!0===t?t:t.map((e=>hr(e)))}function pr(e){let t=!1;const n=[];if("case"===e[0]){for(let i=1;i<e.length-1;i+=2)t=t||fr(e[i]),n.push(e[i+1]);n.push(e[e.length-1])}else if("match"===e[0]){t=t||fr(e[1]);for(let t=2;t<e.length-1;t+=2)n.push(e[t+1]);n.push(e[e.length-1])}else if("step"===e[0]){t=t||fr(e[1]);for(let t=1;t<e.length-1;t+=2)n.push(e[t+1])}t&&(e.length=0,e.push("any",...n));for(let i=1;i<e.length;i++)pr(e[i])}function fr(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let n=1;n<e.length;n++)if(fr(e[n]))return!0;return!1}const mr=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function gr(e,t){return e<t?-1:e>t?1:0}function yr(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if(yr(e[t]))return!0;return!1}function vr(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?br(e[1],e[2],"=="):"!="===t?wr(br(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?br(e[1],e[2],t):"any"===t?(n=e.slice(1),["any"].concat(n.map(vr))):"all"===t?["all"].concat(e.slice(1).map(vr)):"none"===t?["all"].concat(e.slice(1).map(vr).map(wr)):"in"===t?xr(e[1],e.slice(2)):"!in"===t?wr(xr(e[1],e.slice(2))):"has"===t?_r(e[1]):"!has"===t?wr(_r(e[1])):"within"!==t||e;var n}function br(e,t,n){switch(e){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,e,t]}}function xr(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(gr)]]:["filter-in-small",e,["literal",t]]}}function _r(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function wr(e){return["!",e]}function kr(e){return ur(it(e.value))?ar(tt({},e,{expressionContext:"filter",valueSpec:e.styleSpec[`filter_${e.layerType||"fill"}`]})):Er(e)}function Er(e){const t=e.value,n=e.key;if("array"!==Fi(t))return[new nr(n,t,`array expected, ${Fi(t)} found`)];const i=e.styleSpec;let r,o=[];if(t.length<1)return[new nr(n,t,"filter array must have at least 1 element")];switch(o=o.concat(cr({key:`${n}[0]`,value:t[0],valueSpec:i.filter_operator,style:e.style,styleSpec:e.styleSpec})),nt(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===nt(t[1])&&o.push(new nr(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&o.push(new nr(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(r=Fi(t[1]),"string"!==r&&o.push(new nr(`${n}[1]`,t[1],`string expected, ${r} found`)));for(let s=2;s<t.length;s++)r=Fi(t[s]),"$type"===nt(t[1])?o=o.concat(cr({key:`${n}[${s}]`,value:t[s],valueSpec:i.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&o.push(new nr(`${n}[${s}]`,t[s],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let i=1;i<t.length;i++)o=o.concat(Er({key:`${n}[${i}]`,value:t[i],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":r=Fi(t[1]),2!==t.length?o.push(new nr(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==r&&o.push(new nr(`${n}[1]`,t[1],`string expected, ${r} found`));break;case"within":r=Fi(t[1]),2!==t.length?o.push(new nr(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):"object"!==r&&o.push(new nr(`${n}[1]`,t[1],`object expected, ${r} found`))}return o}function Sr(e,t){const n=e.key,i=e.style,r=e.styleSpec,o=e.value,s=e.objectKey,a=r[`${t}_${e.layerType}`];if(!a)return[];const l=s.match(/^(.*)-transition$/);if("paint"===t&&l&&a[l[1]]&&a[l[1]].transition)return Br({key:n,value:o,valueSpec:r.transition,style:i,styleSpec:r});const c=e.valueSpec||a[s];if(!c)return[new nr(n,o,`unknown property "${s}"`)];let u;if("string"===Fi(o)&&Li(c)&&!c.tokens&&(u=/^{([^}]+)}$/.exec(o))){const e=`\`{ "type": "identity", "property": ${u?JSON.stringify(u[1]):'"_"'} }\``;return[new nr(n,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: ${e}.`)]}const d=[];return"symbol"===e.layerType&&("text-field"===s&&i&&!i.glyphs&&d.push(new nr(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&$i(it(o))&&"identity"===nt(o.type)&&d.push(new nr(n,o,'"text-font" does not support identity functions'))),d.concat(Br({key:e.key,value:o,valueSpec:c,style:i,styleSpec:r,expressionContext:"property",propertyType:t,propertyKey:s}))}function Tr(e){return Sr(e,"paint")}function Cr(e){return Sr(e,"layout")}function Mr(e){let t=[];const n=e.value,i=e.key,r=e.style,o=e.styleSpec;n.type||n.ref||t.push(new nr(i,n,'either "type" or "ref" is required'));let s=nt(n.type);const a=nt(n.ref);if(n.id){const o=nt(n.id);for(let s=0;s<e.arrayIndex;s++){const e=r.layers[s];nt(e.id)===o&&t.push(new nr(i,n.id,`duplicate layer id "${n.id}", previously used at line ${e.id.__line__}`))}}if("ref"in n){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in n&&t.push(new nr(i,n[e],`"${e}" is prohibited for ref layers`))})),r.layers.forEach((t=>{nt(t.id)===a&&(e=t)})),e?e.ref?t.push(new nr(i,n.ref,"ref cannot reference another ref layer")):s=nt(e.type):"string"==typeof a&&t.push(new nr(i,n.ref,`ref layer "${a}" not found`))}else if("background"!==s&&"sky"!==s)if(n.source){const e=r.sources&&r.sources[n.source],o=e&&nt(e.type);e?"vector"===o&&"raster"===s?t.push(new nr(i,n.source,`layer "${n.id}" requires a raster source`)):"raster"===o&&"raster"!==s?t.push(new nr(i,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==o||n["source-layer"]?"raster-dem"===o&&"hillshade"!==s?t.push(new nr(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||"geojson"===o&&e.lineMetrics||t.push(new nr(i,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new nr(i,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new nr(i,n.source,`source "${n.source}" not found`))}else t.push(new nr(i,n,'missing required property "source"'));return t=t.concat(ir({key:i,value:n,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Br({key:`${i}.type`,value:n.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,object:n,objectKey:"type"}),filter:e=>kr(tt({layerType:s},e)),layout:e=>ir({layer:n,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>Cr(tt({layerType:s},e))}}),paint:e=>ir({layer:n,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>Tr(tt({layerType:s},e))}})}})),t}function Ir(e){const t=e.value,n=e.key,i=Fi(t);return"string"!==i?[new nr(n,t,`string expected, ${i} found`)]:[]}const Ar={promoteId:function({key:e,value:t}){if("string"===Fi(t))return Ir({key:e,value:t});{const n=[];for(const i in t)n.push(...Ir({key:`${e}.${i}`,value:t[i]}));return n}}};function Pr(e){const t=e.value,n=e.key,i=e.styleSpec,r=e.style;if(!t.type)return[new nr(n,t,'"type" is required')];const o=nt(t.type);let s;switch(o){case"vector":case"raster":case"raster-dem":return s=ir({key:n,value:t,valueSpec:i[`source_${o.replace("-","_")}`],style:e.style,styleSpec:i,objectElementValidators:Ar}),s;case"geojson":if(s=ir({key:n,value:t,valueSpec:i.source_geojson,style:r,styleSpec:i,objectElementValidators:Ar}),t.cluster)for(const e in t.clusterProperties){const[i,r]=t.clusterProperties[e],o="string"==typeof i?[i,["accumulated"],["get",e]]:i;s.push(...ar({key:`${n}.${e}.map`,value:r,expressionContext:"cluster-map"})),s.push(...ar({key:`${n}.${e}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return s;case"video":return ir({key:n,value:t,valueSpec:i.source_video,style:r,styleSpec:i});case"image":return ir({key:n,value:t,valueSpec:i.source_image,style:r,styleSpec:i});case"canvas":return[new nr(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cr({key:`${n}.type`,value:t.type,valueSpec:{values:Or(i)},style:r,styleSpec:i})}}function Or(e){return e.source.reduce(((t,n)=>{const i=e[n];return"enum"===i.type.type&&(t=t.concat(Object.keys(i.type.values))),t}),[])}function Dr(e){const t=e.value,n=e.styleSpec,i=n.light,r=e.style;let o=[];const s=Fi(t);if(void 0===t)return o;if("object"!==s)return o=o.concat([new nr("light",t,`object expected, ${s} found`)]),o;for(const a in t){const e=a.match(/^(.*)-transition$/);o=o.concat(e&&i[e[1]]&&i[e[1]].transition?Br({key:a,value:t[a],valueSpec:n.transition,style:r,styleSpec:n}):i[a]?Br({key:a,value:t[a],valueSpec:i[a],style:r,styleSpec:n}):[new nr(a,t[a],`unknown property "${a}"`)])}return o}function Rr(e){const t=e.value,n=e.key,i=e.style,r=e.styleSpec,o=r.terrain;let s=[];const a=Fi(t);if(void 0===t)return s;if("object"!==a)return s=s.concat([new nr("terrain",t,`object expected, ${a} found`)]),s;for(const l in t){const e=l.match(/^(.*)-transition$/);s=s.concat(e&&o[e[1]]&&o[e[1]].transition?Br({key:l,value:t[l],valueSpec:r.transition,style:i,styleSpec:r}):o[l]?Br({key:l,value:t[l],valueSpec:o[l],style:i,styleSpec:r}):[new nr(l,t[l],`unknown property "${l}"`)])}if(t.source){const e=i.sources&&i.sources[t.source],r=e&&nt(e.type);e?"raster-dem"!==r&&s.push(new nr(n,t.source,`terrain cannot be used with a source of type ${String(r)}, it only be used with a "raster-dem" source type`)):s.push(new nr(n,t.source,`source "${t.source}" not found`))}else s.push(new nr(n,t,'terrain is missing required property "source"'));return s}function zr(e){const t=e.value,n=e.style,i=e.styleSpec,r=i.fog;let o=[];const s=Fi(t);if(void 0===t)return o;if("object"!==s)return o=o.concat([new nr("fog",t,`object expected, ${s} found`)]),o;for(const a in t){const e=a.match(/^(.*)-transition$/);o=o.concat(e&&r[e[1]]&&r[e[1]].transition?Br({key:a,value:t[a],valueSpec:i.transition,style:n,styleSpec:i}):r[a]?Br({key:a,value:t[a],valueSpec:r[a],style:n,styleSpec:i}):[new nr(a,t[a],`unknown property "${a}"`)])}return o}const Lr={"*":()=>[],array:rr,boolean:function(e){const t=e.value,n=e.key,i=Fi(t);return"boolean"!==i?[new nr(n,t,`boolean expected, ${i} found`)]:[]},number:or,color:function(e){const t=e.key,n=e.value,i=Fi(n);return"string"!==i?[new nr(t,n,`color expected, ${i} found`)]:null===Et(n)?[new nr(t,n,`color expected, "${n}" found`)]:[]},enum:cr,filter:kr,function:sr,layer:Mr,object:ir,source:Pr,light:Dr,terrain:Rr,fog:zr,string:Ir,formatted:function(e){return 0===Ir(e).length?[]:ar(e)},resolvedImage:function(e){return 0===Ir(e).length?[]:ar(e)},projection:function(e){const t=e.value,n=e.styleSpec,i=n.projection,r=e.style;let o=[];const s=Fi(t);if("object"===s)for(const a in t)o=o.concat(Br({key:a,value:t[a],valueSpec:i[a],style:r,styleSpec:n}));else"string"!==s&&(o=o.concat([new nr("projection",t,`object or string expected, ${s} found`)]));return o}};function Br(e){const t=e.value,n=e.valueSpec,i=e.styleSpec;return n.expression&&$i(nt(t))?sr(e):n.expression&&Xi(it(t))?ar(e):n.type&&Lr[n.type]?Lr[n.type](e):ir(tt({},e,{valueSpec:n.type?i[n.type]:n}))}function Nr(e){const t=e.value,n=e.key,i=Ir(e);return i.length||(-1===t.indexOf("{fontstack}")&&i.push(new nr(n,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&i.push(new nr(n,t,'"glyphs" url must include a "{range}" token'))),i}function Fr(e,t=et){return Vr(Br({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Nr,"*":()=>[]}}))}const $r=e=>Vr(Tr(e)),jr=e=>Vr(Cr(e));function Vr(e){return e.slice().sort(((e,t)=>e.line&&t.line?e.line-t.line:0))}function Ur(e,t){let n=!1;if(t&&t.length)for(const i of t)e.fire(new Ye(new Error(i.message))),n=!0;return n}var qr=Wr,Gr=3;function Wr(e,t,n){var i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var r=new Int32Array(this.arrayBuffer);e=r[0],this.d=(t=r[1])+2*(n=r[2]);for(var o=0;o<this.d*this.d;o++){var s=r[Gr+o],a=r[Gr+o+1];i.push(s===a?null:r.subarray(s,a))}var l=r[Gr+i.length+1];this.keys=r.subarray(r[Gr+i.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*n;for(var c=0;c<this.d*this.d;c++)i.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=n,this.scale=t/e,this.uid=0;var u=n/t*e;this.min=-u,this.max=e+u}Wr.prototype.insert=function(e,t,n,i,r){this._forEachCell(t,n,i,r,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)},Wr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Wr.prototype._insertCell=function(e,t,n,i,r,o){this.cells[r].push(o)},Wr.prototype.query=function(e,t,n,i,r){var o=this.min,s=this.max;if(e<=o&&t<=o&&s<=n&&s<=i&&!r)return Array.prototype.slice.call(this.keys);var a=[];return this._forEachCell(e,t,n,i,this._queryCell,a,{},r),a},Wr.prototype._queryCell=function(e,t,n,i,r,o,s,a){var l=this.cells[r];if(null!==l)for(var c=this.keys,u=this.bboxes,d=0;d<l.length;d++){var h=l[d];if(void 0===s[h]){var p=4*h;(a?a(u[p+0],u[p+1],u[p+2],u[p+3]):e<=u[p+2]&&t<=u[p+3]&&n>=u[p+0]&&i>=u[p+1])?(s[h]=!0,o.push(c[h])):s[h]=!1}}},Wr.prototype._forEachCell=function(e,t,n,i,r,o,s,a){for(var l=this._convertToCellCoord(e),c=this._convertToCellCoord(t),u=this._convertToCellCoord(n),d=this._convertToCellCoord(i),h=l;h<=u;h++)for(var p=c;p<=d;p++){var f=this.d*p+h;if((!a||a(this._convertFromCellCoord(h),this._convertFromCellCoord(p),this._convertFromCellCoord(h+1),this._convertFromCellCoord(p+1)))&&r.call(this,e,t,n,i,f,o,s,a))return}},Wr.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Wr.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Wr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=Gr+this.cells.length+1+1,n=0,i=0;i<this.cells.length;i++)n+=this.cells[i].length;var r=new Int32Array(t+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var o=t,s=0;s<e.length;s++){var a=e[s];r[Gr+s]=o,r.set(a,o),o+=a.length}return r[Gr+e.length]=o,r.set(this.keys,o),r[Gr+e.length+1]=o+=this.keys.length,r.set(this.bboxes,o),o+=this.bboxes.length,r.buffer};var Hr=h(qr);const Zr={};function Xr(e,t,n={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Zr[t]={klass:e,omit:n.omit||[]}}Xr(Object,"Object"),Hr.serialize=function(e,t){const n=e.toArrayBuffer();return t&&t.push(n),{buffer:n}},Hr.deserialize=function(e){return new Hr(e.buffer)},Object.defineProperty(Hr,"name",{value:"Grid"}),Xr(Hr,"Grid"),Xr(Pt,"Color"),Xr(Error,"Error"),Xr(ce,"AJAXError"),Xr(zt,"ResolvedImage"),Xr(er,"StylePropertyFunction"),Xr(Zi,"StyleExpression",{omit:["_evaluator"]}),Xr(Yi,"ZoomDependentExpression"),Xr(Ji,"ZoomConstantExpression"),Xr(en,"CompoundExpression",{omit:["_evaluate"]});for(const km in Di)Zr[Di[km]._classRegistryKey]||Xr(Di[km],`Expression${km}`);function Kr(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Jr(e){return t.ImageBitmap&&e instanceof t.ImageBitmap}function Yr(e,n){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Kr(e)||Jr(e))return n&&n.push(e),e;if(ArrayBuffer.isView(e)){const t=e;return n&&n.push(t.buffer),t}if(e instanceof t.ImageData)return n&&n.push(e.data.buffer),e;if(Array.isArray(e)){const t=[];for(const i of e)t.push(Yr(i,n));return t}if("object"==typeof e){const t=e.constructor,i=t._classRegistryKey;if(!i)throw new Error(`can't serialize object of unregistered class ${i}`);const r=t.serialize?t.serialize(e,n):{};if(!t.serialize){for(const t in e)e.hasOwnProperty(t)&&(Zr[i].omit.indexOf(t)>=0||(r[t]=Yr(e[t],n)));e instanceof Error&&(r.message=e.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(r.$name=i),r}throw new Error("can't serialize object of type "+typeof e)}function Qr(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Kr(e)||Jr(e)||ArrayBuffer.isView(e)||e instanceof t.ImageData)return e;if(Array.isArray(e))return e.map(Qr);if("object"==typeof e){const t=e.$name||"Object",{klass:n}=Zr[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(e);const i=Object.create(n.prototype);for(const r of Object.keys(e))"$name"!==r&&(i[r]=Qr(e[r]));return i}throw new Error("can't deserialize object of type "+typeof e)}const eo={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function to(e){for(const t of e)if(ro(t.charCodeAt(0)))return!0;return!1}function no(e){for(const t of e)if(!io(t.charCodeAt(0)))return!1;return!0}function io(e){return!(eo.Arabic(e)||eo["Arabic Supplement"](e)||eo["Arabic Extended-A"](e)||eo["Arabic Presentation Forms-A"](e)||eo["Arabic Presentation Forms-B"](e))}function ro(e){return!(746!==e&&747!==e&&(e<4352||!(eo["Bopomofo Extended"](e)||eo.Bopomofo(e)||eo["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||eo["CJK Compatibility Ideographs"](e)||eo["CJK Compatibility"](e)||eo["CJK Radicals Supplement"](e)||eo["CJK Strokes"](e)||!(!eo["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||eo["CJK Unified Ideographs Extension A"](e)||eo["CJK Unified Ideographs"](e)||eo["Enclosed CJK Letters and Months"](e)||eo["Hangul Compatibility Jamo"](e)||eo["Hangul Jamo Extended-A"](e)||eo["Hangul Jamo Extended-B"](e)||eo["Hangul Jamo"](e)||eo["Hangul Syllables"](e)||eo.Hiragana(e)||eo["Ideographic Description Characters"](e)||eo.Kanbun(e)||eo["Kangxi Radicals"](e)||eo["Katakana Phonetic Extensions"](e)||eo.Katakana(e)&&12540!==e||!(!eo["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!eo["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||eo["Unified Canadian Aboriginal Syllabics"](e)||eo["Unified Canadian Aboriginal Syllabics Extended"](e)||eo["Vertical Forms"](e)||eo["Yijing Hexagram Symbols"](e)||eo["Yi Syllables"](e)||eo["Yi Radicals"](e))))}function oo(e){return!(ro(e)||function(e){return!!(eo["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||eo["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||eo["Letterlike Symbols"](e)||eo["Number Forms"](e)||eo["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||eo["Control Pictures"](e)&&9251!==e||eo["Optical Character Recognition"](e)||eo["Enclosed Alphanumerics"](e)||eo["Geometric Shapes"](e)||eo["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||eo["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||eo["CJK Symbols and Punctuation"](e)||eo.Katakana(e)||eo["Private Use Area"](e)||eo["CJK Compatibility Forms"](e)||eo["Small Form Variants"](e)||eo["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function so(e){return e>=1424&&e<=2303||eo["Arabic Presentation Forms-A"](e)||eo["Arabic Presentation Forms-B"](e)}function ao(e,t){return!(!t&&so(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||eo.Khmer(e))}function lo(e){for(const t of e)if(so(t.charCodeAt(0)))return!0;return!1}const co="deferred",uo="loading",ho="loaded";let po=null,fo="unavailable",mo=null;const go=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(fo="error"),po&&po(e)};function yo(){vo.fire(new Je("pluginStateChange",{pluginStatus:fo,pluginURL:mo}))}const vo=new Qe,bo=function(){return fo},xo=function(){if(fo!==co||!mo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fo=uo,yo(),mo&&he({url:mo},(e=>{e?go(e):(fo=ho,yo())}))},_o={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>fo===ho||null!=_o.applyArabicShaping,isLoading:()=>fo===uo,setState(e){fo=e.pluginStatus,mo=e.pluginURL},isParsed:()=>null!=_o.applyArabicShaping&&null!=_o.processBidirectionalText&&null!=_o.processStyledBidirectionalText,getPluginURL:()=>mo};class wo{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.transition=t.transition,this.pitch=t.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(e,t){for(const n of e)if(!ao(n.charCodeAt(0),t))return!1;return!0}(e,_o.isLoaded())}}class ko{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if($i(e))return new er(e,t);if(Xi(e)){const n=Qi(e,t);if("error"===n.result)throw new Error(n.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return n.value}{let n=e;return"string"==typeof e&&"color"===t.type&&(n=Pt.parse(e)),{kind:"constant",evaluate:()=>n}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,n){return this.property.possiblyEvaluate(this,e,t,n)}}class Eo{constructor(e){this.property=e,this.value=new ko(e,void 0)}transitioned(e,t){return new To(this.property,this.value,t,O({},e.transition,this.transition),e.now)}untransitioned(){return new To(this.property,this.value,null,{},0)}}class So{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return V(this._values[e].value.value)}setValue(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Eo(this._values[e].property)),this._values[e].value=new ko(this._values[e].property,null===t?void 0:V(t))}getTransition(e){return V(this._values[e].transition)}setTransition(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Eo(this._values[e].property)),this._values[e].transition=V(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n);const i=this.getTransition(t);void 0!==i&&(e[`${t}-transition`]=i)}return e}transitioned(e,t){const n=new Co(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(e,t._values[i]);return n}untransitioned(){const e=new Co(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class To{constructor(e,t,n,i,r){const o=i.delay||0,s=i.duration||0;r=r||0,this.property=e,this.value=t,this.begin=r+o,this.end=this.begin+s,e.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(e,t,n){const i=e.now||0,r=this.value.possiblyEvaluate(e,t,n),o=this.prior;if(o){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return o.possiblyEvaluate(e,t,n);{const s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,n),r,E(s))}}return r}}class Co{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,n){const i=new Ao(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(e,t,n);return i}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Mo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return V(this._values[e].value)}setValue(e,t){this._values[e]=new ko(this._values[e].property,null===t?void 0:V(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n)}return e}possiblyEvaluate(e,t,n){const i=new Ao(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(e,t,n);return i}}class Io{constructor(e,t,n){this.property=e,this.value=t,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,n,i){return this.property.evaluate(this.value,this.parameters,e,t,n,i)}}class Ao{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Po{constructor(e){this.specification=e}possiblyEvaluate(e,t){return e.expression.evaluate(t)}interpolate(e,t,n){const i=Dn[this.specification.type];return i?i(e,t,n):e}}class Oo{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,n,i){return new Io(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},n,i)}:e.expression,t)}interpolate(e,t,n){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Io(this,{kind:"constant",value:void 0},e.parameters);const i=Dn[this.specification.type];return i?new Io(this,{kind:"constant",value:i(e.value.value,t.value.value,n)},e.parameters):e}evaluate(e,t,n,i,r,o){return"constant"===e.kind?e.value:e.evaluate(t,n,i,r,o)}}class Do{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,i){return!!e.expression.evaluate(t,null,{},n,i)}interpolate(){return!1}}class Ro{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const t=new wo(0,{});for(const n in e){const i=e[n];i.specification.overridable&&this.overridableProperties.push(n);const r=this.defaultPropertyValues[n]=new ko(i,void 0),o=this.defaultTransitionablePropertyValues[n]=new Eo(i);this.defaultTransitioningPropertyValues[n]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=r.possiblyEvaluate(t)}}}function zo(e,t){return 256*(e=C(Math.floor(e),0,255))+C(Math.floor(t),0,255)}Xr(Oo,"DataDrivenProperty"),Xr(Po,"DataConstantProperty"),Xr(Do,"ColorRampProperty");const Lo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Bo{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class No{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Fo(e,t=1){let n=0,i=0;return{members:e.map((e=>{const r=Lo[e.type].BYTES_PER_ELEMENT,o=n=$o(n,Math.max(t,r)),s=e.components||1;return i=Math.max(i,r),n+=r*s,{name:e.name,type:e.type,components:s,offset:o}})),size:$o(n,Math.max(i,t)),alignment:t}}function $o(e,t){return Math.ceil(e/t)*t}class jo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const i=2*e;return this.int16[i+0]=t,this.int16[i+1]=n,e}}jo.prototype.bytesPerElement=4,Xr(jo,"StructArrayLayout2i4");class Vo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=3*e;return this.int16[r+0]=t,this.int16[r+1]=n,this.int16[r+2]=i,e}}Vo.prototype.bytesPerElement=6,Xr(Vo,"StructArrayLayout3i6");class Uo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}emplace(e,t,n,i,r){const o=4*e;return this.int16[o+0]=t,this.int16[o+1]=n,this.int16[o+2]=i,this.int16[o+3]=r,e}}Uo.prototype.bytesPerElement=8,Xr(Uo,"StructArrayLayout4i8");class qo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,i,r,o,s)}emplace(e,t,n,i,r,o,s,a){const l=6*e,c=12*e,u=3*e;return this.int16[l+0]=t,this.int16[l+1]=n,this.uint8[c+4]=i,this.uint8[c+5]=r,this.uint8[c+6]=o,this.uint8[c+7]=s,this.float32[u+2]=a,e}}qo.prototype.bytesPerElement=12,Xr(qo,"StructArrayLayout2i4ub1f12");class Go extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}emplace(e,t,n,i,r){const o=4*e;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=i,this.float32[o+3]=r,e}}Go.prototype.bytesPerElement=16,Xr(Go,"StructArrayLayout4f16");class Wo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r)}emplace(e,t,n,i,r,o){const s=6*e,a=3*e;return this.uint16[s+0]=t,this.uint16[s+1]=n,this.uint16[s+2]=i,this.uint16[s+3]=r,this.float32[a+2]=o,e}}Wo.prototype.bytesPerElement=12,Xr(Wo,"StructArrayLayout4ui1f12");class Ho extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}emplace(e,t,n,i,r){const o=4*e;return this.uint16[o+0]=t,this.uint16[o+1]=n,this.uint16[o+2]=i,this.uint16[o+3]=r,e}}Ho.prototype.bytesPerElement=8,Xr(Ho,"StructArrayLayout4ui8");class Zo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,i,r,o)}emplace(e,t,n,i,r,o,s){const a=6*e;return this.int16[a+0]=t,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=r,this.int16[a+4]=o,this.int16[a+5]=s,e}}Zo.prototype.bytesPerElement=12,Xr(Zo,"StructArrayLayout6i12");class Xo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o,s,a,l,c,u,d){const h=this.length;return this.resize(h+1),this.emplace(h,e,t,n,i,r,o,s,a,l,c,u,d)}emplace(e,t,n,i,r,o,s,a,l,c,u,d,h){const p=12*e;return this.int16[p+0]=t,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=r,this.uint16[p+4]=o,this.uint16[p+5]=s,this.uint16[p+6]=a,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=d,this.int16[p+11]=h,e}}Xo.prototype.bytesPerElement=24,Xr(Xo,"StructArrayLayout4i4ui4i24");class Ko extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,n,i,r,o)}emplace(e,t,n,i,r,o,s){const a=10*e,l=5*e;return this.int16[a+0]=t,this.int16[a+1]=n,this.int16[a+2]=i,this.float32[l+2]=r,this.float32[l+3]=o,this.float32[l+4]=s,e}}Ko.prototype.bytesPerElement=20,Xr(Ko,"StructArrayLayout3i3f20");class Jo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}Jo.prototype.bytesPerElement=4,Xr(Jo,"StructArrayLayout1ul4");class Yo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o,s,a,l,c,u,d,h){const p=this.length;return this.resize(p+1),this.emplace(p,e,t,n,i,r,o,s,a,l,c,u,d,h)}emplace(e,t,n,i,r,o,s,a,l,c,u,d,h,p){const f=20*e,m=10*e;return this.int16[f+0]=t,this.int16[f+1]=n,this.int16[f+2]=i,this.int16[f+3]=r,this.int16[f+4]=o,this.float32[m+3]=s,this.float32[m+4]=a,this.float32[m+5]=l,this.float32[m+6]=c,this.int16[f+14]=u,this.uint32[m+8]=d,this.uint16[f+18]=h,this.uint16[f+19]=p,e}}Yo.prototype.bytesPerElement=40,Xr(Yo,"StructArrayLayout5i4f1i1ul2ui40");class Qo extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,i,r,o,s)}emplace(e,t,n,i,r,o,s,a){const l=8*e;return this.int16[l+0]=t,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+4]=r,this.int16[l+5]=o,this.int16[l+6]=s,this.int16[l+7]=a,e}}Qo.prototype.bytesPerElement=16,Xr(Qo,"StructArrayLayout3i2i2i16");class es extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r)}emplace(e,t,n,i,r,o){const s=4*e,a=8*e;return this.float32[s+0]=t,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[a+6]=r,this.int16[a+7]=o,e}}es.prototype.bytesPerElement=16,Xr(es,"StructArrayLayout2f1f2i16");class ts extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}emplace(e,t,n,i,r){const o=12*e,s=3*e;return this.uint8[o+0]=t,this.uint8[o+1]=n,this.float32[s+1]=i,this.float32[s+2]=r,e}}ts.prototype.bytesPerElement=12,Xr(ts,"StructArrayLayout2ub2f12");class ns extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=3*e;return this.float32[r+0]=t,this.float32[r+1]=n,this.float32[r+2]=i,e}}ns.prototype.bytesPerElement=12,Xr(ns,"StructArrayLayout3f12");class is extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n)}emplace(e,t,n,i){const r=3*e;return this.uint16[r+0]=t,this.uint16[r+1]=n,this.uint16[r+2]=i,e}}is.prototype.bytesPerElement=6,Xr(is,"StructArrayLayout3ui6");class rs extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,x){const _=this.length;return this.resize(_+1),this.emplace(_,e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,x)}emplace(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,x,_){const w=30*e,k=15*e,E=60*e;return this.int16[w+0]=t,this.int16[w+1]=n,this.int16[w+2]=i,this.float32[k+2]=r,this.float32[k+3]=o,this.uint16[w+8]=s,this.uint16[w+9]=a,this.uint32[k+5]=l,this.uint32[k+6]=c,this.uint32[k+7]=u,this.uint16[w+16]=d,this.uint16[w+17]=h,this.uint16[w+18]=p,this.float32[k+10]=f,this.float32[k+11]=m,this.uint8[E+48]=g,this.uint8[E+49]=y,this.uint8[E+50]=v,this.uint32[k+13]=b,this.int16[w+28]=x,this.uint8[E+58]=_,e}}rs.prototype.bytesPerElement=60,Xr(rs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class os extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,x,_,w,k,E,S,T,C,M,I){const A=this.length;return this.resize(A+1),this.emplace(A,e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,x,_,w,k,E,S,T,C,M,I)}emplace(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,x,_,w,k,E,S,T,C,M,I,A){const P=38*e,O=19*e;return this.int16[P+0]=t,this.int16[P+1]=n,this.int16[P+2]=i,this.float32[O+2]=r,this.float32[O+3]=o,this.int16[P+8]=s,this.int16[P+9]=a,this.int16[P+10]=l,this.int16[P+11]=c,this.int16[P+12]=u,this.int16[P+13]=d,this.uint16[P+14]=h,this.uint16[P+15]=p,this.uint16[P+16]=f,this.uint16[P+17]=m,this.uint16[P+18]=g,this.uint16[P+19]=y,this.uint16[P+20]=v,this.uint16[P+21]=b,this.uint16[P+22]=x,this.uint16[P+23]=_,this.uint16[P+24]=w,this.uint16[P+25]=k,this.uint16[P+26]=E,this.uint16[P+27]=S,this.uint16[P+28]=T,this.uint32[O+15]=C,this.float32[O+16]=M,this.float32[O+17]=I,this.float32[O+18]=A,e}}os.prototype.bytesPerElement=76,Xr(os,"StructArrayLayout3i2f6i15ui1ul3f76");class ss extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}ss.prototype.bytesPerElement=4,Xr(ss,"StructArrayLayout1f4");class as extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,i,r){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,i,r)}emplace(e,t,n,i,r,o){const s=5*e;return this.float32[s+0]=t,this.float32[s+1]=n,this.float32[s+2]=i,this.float32[s+3]=r,this.float32[s+4]=o,e}}as.prototype.bytesPerElement=20,Xr(as,"StructArrayLayout5f20");class ls extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n,i)}emplace(e,t,n,i,r){const o=6*e;return this.uint32[3*e+0]=t,this.uint16[o+2]=n,this.uint16[o+3]=i,this.uint16[o+4]=r,e}}ls.prototype.bytesPerElement=12,Xr(ls,"StructArrayLayout1ul3ui12");class cs extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const i=2*e;return this.uint16[i+0]=t,this.uint16[i+1]=n,e}}cs.prototype.bytesPerElement=4,Xr(cs,"StructArrayLayout2ui4");class us extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}us.prototype.bytesPerElement=2,Xr(us,"StructArrayLayout1ui2");class ds extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const i=2*e;return this.float32[i+0]=t,this.float32[i+1]=n,e}}ds.prototype.bytesPerElement=8,Xr(ds,"StructArrayLayout2f8");class hs extends Bo{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}hs.prototype.size=40;class ps extends Yo{get(e){return new hs(this,e)}}Xr(ps,"CollisionBoxArray");class fs extends Bo{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}fs.prototype.size=60;class ms extends rs{get(e){return new fs(this,e)}}Xr(ms,"PlacedSymbolArray");class gs extends Bo{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}gs.prototype.size=76;class ys extends os{get(e){return new gs(this,e)}}Xr(ys,"SymbolInstanceArray");class vs extends ss{getoffsetX(e){return this.float32[1*e+0]}}Xr(vs,"GlyphOffsetArray");class bs extends jo{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Xr(bs,"SymbolLineVertexArray");class xs extends Bo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}xs.prototype.size=12;class _s extends ls{get(e){return new xs(this,e)}}Xr(_s,"FeatureIndexArray");class ws extends cs{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Xr(ws,"FillExtrusionCentroidArray");const ks=Fo([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Es=Fo([{name:"a_dash",components:4,type:"Uint16"}]);var Ss={exports:{}},Ts={exports:{}};Ts.exports=function(e,t){var n,i,r,o,s,a,l,c;for(i=e.length-(n=3&e.length),r=t,s=3432918353,a=461845907,c=0;c<i;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,r=27492+(65535&(o=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<15|l>>>17))*a+(((l>>>16)*a&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};var Cs=Ts.exports,Ms={exports:{}};Ms.exports=function(e,t){for(var n,i=e.length,r=t^i,o=0;i>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:r^=(255&e.charCodeAt(o+2))<<16;case 2:r^=(255&e.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};var Is=Cs,As=Ms.exports;Ss.exports=Is,Ss.exports.murmur3=Is,Ss.exports.murmur2=As;var Ps=h(Ss.exports);class Os{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,n,i){this.ids.push(Ds(e)),this.positions.push(t,n,i)}getPositions(e){const t=Ds(e);let n=0,i=this.ids.length-1;for(;n<i;){const e=n+i>>1;this.ids[e]>=t?i=e:n=e+1}const r=[];for(;this.ids[n]===t;)r.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return r}static serialize(e,t){const n=new Float64Array(e.ids),i=new Uint32Array(e.positions);return Rs(n,i,0,n.length-1),t&&t.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(e){const t=new Os;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function Ds(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Ps(String(e))}function Rs(e,t,n,i){for(;n<i;){const r=e[n+i>>1];let o=n-1,s=i+1;for(;;){do{o++}while(e[o]<r);do{s--}while(e[s]>r);if(o>=s)break;zs(e,o,s),zs(t,3*o,3*s),zs(t,3*o+1,3*s+1),zs(t,3*o+2,3*s+2)}s-n<i-s?(Rs(e,t,n,s),n=s+1):(Rs(e,t,s+1,i),i=s)}}function zs(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}Xr(Os,"FeaturePositionMap");class Ls{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,t){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}}class Bs extends Ls{constructor(e){super(e),this.current=0}set(e,t,n){this.fetchUniformLocation(e,t)&&this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Ns extends Ls{constructor(e){super(e),this.current=[0,0,0,0]}set(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3])))}}class Fs extends Ls{constructor(e){super(e),this.current=Pt.transparent}set(e,t,n){this.fetchUniformLocation(e,t)&&(n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a)))}}const $s=new Float32Array(16),js=new Float32Array(9),Vs=new Float32Array(4);function Us(e){return[zo(255*e.r,255*e.g),zo(255*e.b,255*e.a)]}class qs{constructor(e,t,n){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=n}setUniform(e,t,n,i,r){t.set(e,r,i.constantOr(this.value))}getBinding(e,t){return"color"===this.type?new Fs(e):new Bs(e)}}class Gs{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,t,n,i,r){const o="u_pattern"===r||"u_dash"===r?this.pattern:"u_pixel_ratio"===r?this.pixelRatio:null;o&&t.set(e,r,o)}getBinding(e,t){return"u_pattern"===t||"u_dash"===t?new Ns(e):new Bs(e)}}class Ws{constructor(e,t,n,i){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new i}populatePaintArray(e,t,n,i,r,o){const s=this.paintVertexArray.length,a=this.expression.evaluate(new wo(0),t,{},r,i,o);this.paintVertexArray.resize(e),this._setPaintValue(s,e,a)}updatePaintArray(e,t,n,i,r){const o=this.expression.evaluate({zoom:0},n,i,void 0,r);this._setPaintValue(e,t,o)}_setPaintValue(e,t,n){if("color"===this.type){const i=Us(n);for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i[0],i[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Hs{constructor(e,t,n,i,r,o){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(e,t,n,i,r,o){const s=this.expression.evaluate(new wo(this.zoom),t,{},r,i,o),a=this.expression.evaluate(new wo(this.zoom+1),t,{},r,i,o),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,s,a)}updatePaintArray(e,t,n,i,r){const o=this.expression.evaluate({zoom:this.zoom},n,i,void 0,r),s=this.expression.evaluate({zoom:this.zoom+1},n,i,void 0,r);this._setPaintValue(e,t,o,s)}_setPaintValue(e,t,n,i){if("color"===this.type){const r=Us(n),o=Us(i);for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r[0],r[1],o[0],o[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t,n,i,r){const o=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,s=C(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(e,r,s)}getBinding(e,t){return new Bs(e)}}class Zs{constructor(e,t,n,i,r){this.expression=e,this.layerId=r,this.paintVertexAttributes=("array"===n?Es:ks).members;for(let o=0;o<t.length;++o);this.paintVertexArray=new i}populatePaintArray(e,t,n){const i=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(i,e,t.patterns&&t.patterns[this.layerId],n)}updatePaintArray(e,t,n,i,r,o){this._setPaintValues(e,t,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(e,t,n,i){if(!i||!n)return;const r=i[n];if(!r)return;const{tl:o,br:s,pixelRatio:a}=r;for(let l=e;l<t;l++)this.paintVertexArray.emplace(l,o[0],o[1],s[0],s[1],a)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xs{constructor(e,t,n=(()=>!0)){this.binders={},this._buffers=[];const i=[];for(const r in e.paint._values){if(!n(r))continue;const o=e.paint.get(r);if(!(o instanceof Io&&Li(o.property.specification)))continue;const s=Ys(r,e.type),a=o.value,l=o.property.specification.type,c=!!o.property.useIntegerZoom,u="line-dasharray"===r||r.endsWith("pattern"),d="line-dasharray"===r&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==a.kind||d)if("source"===a.kind||d||u){const t=ta(r,l,"source");this.binders[r]=u?new Zs(a,s,l,t,e.id):new Ws(a,s,l,t),i.push(`/a_${r}`)}else{const e=ta(r,l,"composite");this.binders[r]=new Hs(a,s,l,c,t,e),i.push(`/z_${r}`)}else this.binders[r]=u?new Gs(a.value,s):new qs(a.value,s,l),i.push(`/u_${r}`)}this.cacheKey=i.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof Ws||t instanceof Hs?t.maxValue:0}populatePaintArrays(e,t,n,i,r,o){for(const s in this.binders){const a=this.binders[s];(a instanceof Ws||a instanceof Hs||a instanceof Zs)&&a.populatePaintArray(e,t,n,i,r,o)}}setConstantPatternPositions(e){for(const t in this.binders){const n=this.binders[t];n instanceof Gs&&n.setConstantPatternPositions(e)}}updatePaintArrays(e,t,n,i,r,o){let s=!1;for(const a in e){const l=t.getPositions(a);for(const t of l){const l=n.feature(t.index);for(const n in this.binders){const c=this.binders[n];if((c instanceof Ws||c instanceof Hs||c instanceof Zs)&&!0===c.expression.isStateDependent){const u=i.paint.get(n);c.expression=u.value,c.updatePaintArray(t.start,t.end,l,e[a],r,o),s=!0}}}}return s}defines(){const e=[];for(const t in this.binders){const n=this.binders[t];(n instanceof qs||n instanceof Gs)&&e.push(...n.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof Ws||n instanceof Hs||n instanceof Zs)for(let t=0;t<n.paintVertexAttributes.length;t++)e.push(n.paintVertexAttributes[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof qs||n instanceof Gs||n instanceof Hs)for(const t of n.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const t=[];for(const n in this.binders){const i=this.binders[n];if(i instanceof qs||i instanceof Gs||i instanceof Hs)for(const r of i.uniformNames)t.push({name:r,property:n,binding:i.getBinding(e,r)})}return t}setUniforms(e,t,n,i,r){for(const{name:o,property:s,binding:a}of n)this.binders[s].setUniform(e,a,r,i.get(s),o)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const t=this.binders[e];(t instanceof Ws||t instanceof Hs||t instanceof Zs)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}upload(e){for(const t in this.binders){const n=this.binders[t];(n instanceof Ws||n instanceof Hs||n instanceof Zs)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof Ws||t instanceof Hs||t instanceof Zs)&&t.destroy()}}}class Ks{constructor(e,t,n=(()=>!0)){this.programConfigurations={};for(const i of e)this.programConfigurations[i.id]=new Xs(i,t,n);this.needsUpload=!1,this._featureMap=new Os,this._bufferOffset=0}populatePaintArrays(e,t,n,i,r,o,s){for(const a in this.programConfigurations)this.programConfigurations[a].populatePaintArrays(e,t,i,r,o,s);void 0!==t.id&&this._featureMap.add(t.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,n,i,r){for(const o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,t,o,i,r)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Js={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ys(e,t){return Js[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}const Qs={"line-pattern":{source:Wo,composite:Wo},"fill-pattern":{source:Wo,composite:Wo},"fill-extrusion-pattern":{source:Wo,composite:Wo},"line-dasharray":{source:Ho,composite:Ho}},ea={color:{source:ds,composite:Go},number:{source:ss,composite:ds}};function ta(e,t,n){const i=Qs[e];return i&&i[n]||ea[t][n]}Xr(qs,"ConstantBinder"),Xr(Gs,"PatternConstantBinder"),Xr(Ws,"SourceExpressionBinder"),Xr(Zs,"PatternCompositeBinder"),Xr(Hs,"CompositeExpressionBinder"),Xr(Xs,"ProgramConfiguration",{omit:["_buffers"]}),Xr(Ks,"ProgramConfigurationSet");const na="-transition";class ia extends Qe{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Mo(t.layout)),t.paint)){this._transitionablePaint=new So(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ao(t.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,n={}){null!=t&&this._validate(jr,`layers.${this.id}.layout.${e}`,e,t,n)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return F(e,na)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,n={}){if(null!=t&&this._validate($r,`layers.${this.id}.paint.${e}`,e,t,n))return!1;if(F(e,na))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const n=this._transitionablePaint._values[e],i=n.value.isDataDriven(),r=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value,s=o.isDataDriven(),a=F(e,"pattern")||"line-dasharray"===e;return s||i||a||this._handleOverridablePaintPropertyUpdate(e,r,o)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,t,n){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),j(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,n,i,r={}){return(!r||!1!==r.validate)&&Ur(this,e.call(Fr,{key:t,layerType:this.type,objectKey:n,value:i,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof Io&&Li(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=dr(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ra=Fo([{name:"a_pos",components:2,type:"Int16"}],4),oa=Fo([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class sa{constructor(e=[]){this.segments=e}prepareSegment(e,t,n,i){let r=this.segments[this.segments.length-1];return e>sa.MAX_VERTEX_ARRAY_LENGTH&&q(`Max vertices per segment is ${sa.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!r||r.vertexLength+e>sa.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i)&&(r={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(r.sortKey=i),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,n,i){return new sa([{vertexOffset:e,primitiveOffset:t,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}sa.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xr(sa,"SegmentVector");var aa=8192;class la{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Vl?new Vl(e.lng,e.lat):Vl.convert(e),this}setSouthWest(e){return this._sw=e instanceof Vl?new Vl(e.lng,e.lat):Vl.convert(e),this}extend(e){const t=this._sw,n=this._ne;let i,r;if(e instanceof Vl)i=e,r=e;else{if(!(e instanceof la))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(la.convert(e)):this.extend(Vl.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Vl.convert(e)):this;if(i=e._sw,r=e._ne,!i||!r)return this}return t||n?(t.lng=Math.min(i.lng,t.lng),t.lat=Math.min(i.lat,t.lat),n.lng=Math.max(r.lng,n.lng),n.lat=Math.max(r.lat,n.lat)):(this._sw=new Vl(i.lng,i.lat),this._ne=new Vl(r.lng,r.lat)),this}getCenter(){return new Vl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Vl(this.getWest(),this.getNorth())}getSouthEast(){return new Vl(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:n}=Vl.convert(e);let i=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=t&&t>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}static convert(e){return!e||e instanceof la?e:new la(e)}}var ca=1e-6,ua="undefined"!=typeof Float32Array?Float32Array:Array;function da(){var e=new ua(9);return ua!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function ha(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=n[0],p=n[1],f=n[2],m=n[3],g=n[4],y=n[5],v=n[6],b=n[7],x=n[8];return e[0]=h*i+p*s+f*c,e[1]=h*r+p*a+f*u,e[2]=h*o+p*l+f*d,e[3]=m*i+g*s+y*c,e[4]=m*r+g*a+y*u,e[5]=m*o+g*l+y*d,e[6]=v*i+b*s+x*c,e[7]=v*r+b*a+x*u,e[8]=v*o+b*l+x*d,e}function pa(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fa(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8],d=t[9],h=t[10],p=t[11],f=t[12],m=t[13],g=t[14],y=t[15],v=n*a-i*s,b=n*l-r*s,x=n*c-o*s,_=i*l-r*a,w=i*c-o*a,k=r*c-o*l,E=u*m-d*f,S=u*g-h*f,T=u*y-p*f,C=d*g-h*m,M=d*y-p*m,I=h*y-p*g,A=v*I-b*M+x*C+_*T-w*S+k*E;return A?(e[0]=(a*I-l*M+c*C)*(A=1/A),e[1]=(r*M-i*I-o*C)*A,e[2]=(m*k-g*w+y*_)*A,e[3]=(h*w-d*k-p*_)*A,e[4]=(l*T-s*I-c*S)*A,e[5]=(n*I-r*T+o*S)*A,e[6]=(g*x-f*k-y*b)*A,e[7]=(u*k-h*x+p*b)*A,e[8]=(s*M-a*T+c*E)*A,e[9]=(i*T-n*M-o*E)*A,e[10]=(f*w-m*x+y*v)*A,e[11]=(d*x-u*w-p*v)*A,e[12]=(a*S-s*C-l*E)*A,e[13]=(n*C-i*S+r*E)*A,e[14]=(m*b-f*_-g*v)*A,e[15]=(u*_-d*b+h*v)*A,e):null}function ma(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],p=t[10],f=t[11],m=t[12],g=t[13],y=t[14],v=t[15],b=n[0],x=n[1],_=n[2],w=n[3];return e[0]=b*i+x*a+_*d+w*m,e[1]=b*r+x*l+_*h+w*g,e[2]=b*o+x*c+_*p+w*y,e[3]=b*s+x*u+_*f+w*v,e[4]=(b=n[4])*i+(x=n[5])*a+(_=n[6])*d+(w=n[7])*m,e[5]=b*r+x*l+_*h+w*g,e[6]=b*o+x*c+_*p+w*y,e[7]=b*s+x*u+_*f+w*v,e[8]=(b=n[8])*i+(x=n[9])*a+(_=n[10])*d+(w=n[11])*m,e[9]=b*r+x*l+_*h+w*g,e[10]=b*o+x*c+_*p+w*y,e[11]=b*s+x*u+_*f+w*v,e[12]=(b=n[12])*i+(x=n[13])*a+(_=n[14])*d+(w=n[15])*m,e[13]=b*r+x*l+_*h+w*g,e[14]=b*o+x*c+_*p+w*y,e[15]=b*s+x*u+_*f+w*v,e}function ga(e,t,n){var i,r,o,s,a,l,c,u,d,h,p,f,m=n[0],g=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=t[9],p=t[10],f=t[11],e[0]=i=t[0],e[1]=r,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=d,e[9]=h,e[10]=p,e[11]=f,e[12]=i*m+a*g+d*y+t[12],e[13]=r*m+l*g+h*y+t[13],e[14]=o*m+c*g+p*y+t[14],e[15]=s*m+u*g+f*y+t[15]),e}function ya(e,t,n){var i=n[0],r=n[1],o=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function va(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[4],s=t[5],a=t[6],l=t[7],c=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*r+c*i,e[5]=s*r+u*i,e[6]=a*r+d*i,e[7]=l*r+h*i,e[8]=c*r-o*i,e[9]=u*r-s*i,e[10]=d*r-a*i,e[11]=h*r-l*i,e}function ba(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[8],u=t[9],d=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r-c*i,e[1]=s*r-u*i,e[2]=a*r-d*i,e[3]=l*r-h*i,e[8]=o*i+c*r,e[9]=s*i+u*r,e[10]=a*i+d*r,e[11]=l*i+h*r,e}function xa(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _a(e,t,n){var i,r,o,s=n[0],a=n[1],l=n[2],c=Math.hypot(s,a,l);return c<ca?null:(s*=c=1/c,a*=c,l*=c,i=Math.sin(t),r=Math.cos(t),e[0]=s*s*(o=1-r)+r,e[1]=a*s*o+l*i,e[2]=l*s*o-a*i,e[3]=0,e[4]=s*a*o-l*i,e[5]=a*a*o+r,e[6]=l*a*o+s*i,e[7]=0,e[8]=s*l*o+a*i,e[9]=a*l*o-s*i,e[10]=l*l*o+r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var wa=ma;function ka(){var e=new ua(3);return ua!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ea(e){var t=new ua(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Sa(e){return Math.hypot(e[0],e[1],e[2])}function Ta(e,t,n){var i=new ua(3);return i[0]=e,i[1]=t,i[2]=n,i}function Ca(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Ma(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function Ia(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function Aa(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function Pa(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function Oa(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Da(e,t,n,i){return e[0]=t[0]+n[0]*i,e[1]=t[1]+n[1]*i,e[2]=t[2]+n[2]*i,e}function Ra(e,t){var n=t[0],i=t[1],r=t[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function za(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function La(e,t,n){var i=t[0],r=t[1],o=t[2],s=n[0],a=n[1],l=n[2];return e[0]=r*l-o*a,e[1]=o*s-i*l,e[2]=i*a-r*s,e}function Ba(e,t,n){var i=t[0],r=t[1],o=t[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return e[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/(s=s||1),e[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,e[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,e}function Na(e,t,n){var i=n[0],r=n[1],o=n[2],s=t[0],a=t[1],l=t[2],c=r*l-o*a,u=o*s-i*l,d=i*a-r*s,h=r*d-o*u,p=o*c-i*d,f=i*u-r*c,m=2*n[3];return u*=m,d*=m,p*=2,f*=2,e[0]=s+(c*=m)+(h*=2),e[1]=a+u+p,e[2]=l+d+f,e}var Fa,$a=Ma,ja=Ia,Va=Sa;function Ua(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function qa(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),e[0]=n*s,e[1]=i*s,e[2]=r*s,e[3]=o*s,e}function Ga(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3];return e[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,e[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,e[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,e[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,e}function Wa(){var e=new ua(4);return ua!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ha(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Za(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);return e[0]=i*l+s*a,e[1]=r*l+o*a,e[2]=o*l-r*a,e[3]=s*l-i*a,e}function Xa(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);return e[0]=i*l-o*a,e[1]=r*l+s*a,e[2]=o*l+i*a,e[3]=s*l-r*a,e}ka(),Fa=new ua(4),ua!=Float32Array&&(Fa[0]=0,Fa[1]=0,Fa[2]=0,Fa[3]=0);var Ka=qa;ka(),Ta(1,0,0),Ta(0,1,0),Wa(),Wa(),da();const Ja=Fo([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ya}=Ja,Qa=Fo([{name:"a_pos_3",components:3,type:"Int16"}]);var el=Fo([{name:"a_pos",type:"Int16",components:2}]);class tl{constructor(e,t){this.pos=e,this.dir=t}intersectsPlane(e,t,n){const i=za(t,this.dir);if(Math.abs(i)<1e-6)return!1;const r=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/i;return n[0]=this.pos[0]+this.dir[0]*r,n[1]=this.pos[1]+this.dir[1]*r,n[2]=this.pos[2]+this.dir[2]*r,!0}closestPointOnSphere(e,t,n){if(function(e,t){var n=e[0],i=e[1],r=e[2],o=t[0],s=t[1],a=t[2];return Math.abs(n-o)<=ca*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=ca*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-a)<=ca*Math.max(1,Math.abs(r),Math.abs(a))}(this.pos,e)||0===t)return n[0]=n[1]=n[2]=0,!1;const[i,r,o]=this.dir,s=this.pos[0]-e[0],a=this.pos[1]-e[1],l=this.pos[2]-e[2],c=i*i+r*r+o*o,u=2*(s*i+a*r+l*o),d=u*u-4*c*(s*s+a*a+l*l-t*t);if(d<0){const e=Math.max(-u/2,0),c=s+i*e,d=a+r*e,h=l+o*e,p=Math.hypot(c,d,h);return n[0]=c*t/p,n[1]=d*t/p,n[2]=h*t/p,!1}{const e=(-u-Math.sqrt(d))/(2*c);if(e<0){const e=Math.hypot(s,a,l);return n[0]=s*t/e,n[1]=a*t/e,n[2]=l*t/e,!1}return n[0]=s+i*e,n[1]=a+r*e,n[2]=l+o*e,!0}}}class nl{constructor(e,t,n,i,r){this.TL=e,this.TR=t,this.BR=n,this.BL=i,this.horizon=r}static fromInvProjectionMatrix(e,t,n){const i=[-1,1,1],r=[1,1,1],o=[1,-1,1],s=[-1,-1,1],a=Ba(i,i,e),l=Ba(r,r,e),c=Ba(o,o,e),u=Ba(s,s,e);return new nl(a,l,c,u,t/n)}}class il{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,t,n,i){const r=Math.pow(2,n),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((n=>{const o=Ga([],n,e),s=1/o[3]/t*r;return function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}(o,o,[s,s,i?1/o[3]:s,s])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const t=Ra([],La([],$a([],o[e[0]],o[e[1]]),$a([],o[e[2]],o[e[1]]))),n=-za(t,o[e[1]]);return t.concat(n)}));return new il(o,s)}}class rl{static fromPoints(e){const t=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0];for(const i of e)Aa(t,t,i),Pa(n,n,i);return new rl(t,n)}static applyTransform(e,t){const n=e.getCorners();for(let i=0;i<n.length;++i)Ba(n[i],n[i],t);return rl.fromPoints(n)}constructor(e,t){this.min=e,this.max=t,this.center=Oa([],Ca([],this.min,this.max),.5)}quadrant(e){const t=[e%2==0,e<2],n=Ea(this.min),i=Ea(this.max);for(let r=0;r<t.length;r++)n[r]=t[r]?this.min[r]:this.center[r],i[r]=t[r]?this.center[r]:this.max[r];return i[2]=this.max[2],new rl(n,i)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}intersects(e){const t=this.getCorners();let n=!0;for(let i=0;i<e.planes.length;i++){const r=e.planes[i];let o=0;for(let e=0;e<t.length;e++)o+=za(r,t[e])+r[3]>=0;if(0===o)return 0;o!==t.length&&(n=!1)}if(n)return 2;for(let i=0;i<3;i++){let t=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const o=e.points[r][i]-this.min[i];t=Math.min(t,o),n=Math.max(n,o)}if(n<0||t>this.max[i]-this.min[i])return 0}return 1}}const ol=5,sl=6,al=aa/Math.PI/2,ll=16383,cl=64,ul=[cl,32,16],dl=-al,hl=al,pl=[new rl([dl,dl,dl],[hl,hl,hl]),new rl([dl,dl,dl],[0,0,hl]),new rl([0,dl,dl],[hl,0,hl]),new rl([dl,0,dl],[0,hl,hl]),new rl([0,0,dl],[hl,hl,hl])];function fl(e){return e*al/Fl}function ml(e,t,n,i=!0){const r=Oa([],e._camera.position,e.worldSize),o=[t,n,1,1];Ga(o,o,e.pixelMatrixInverse),Ua(o,o,1/o[3]);const s=Ra([],$a([],o,r)),a=e.globeMatrix,l=[a[12],a[13],a[14]],c=$a([],l,r),u=Sa(c),d=Ra([],c),h=e.worldSize/(2*Math.PI),p=za(d,s),f=Math.asin(h/u);if(f<Math.acos(p)){if(!i)return null;const e=[],t=[];Oa(e,s,u/p),Ra(t,$a(t,e,c)),Ra(s,Ca(s,c,Oa(s,t,Math.tan(f)*u)))}const m=[];new tl(r,s).closestPointOnSphere(l,h,m);const g=Ra([],Y(a,0)),y=Ra([],Y(a,1)),v=Ra([],Y(a,2)),b=za(g,m),x=za(y,m),_=za(v,m),k=w(Math.asin(-x/h));let E=w(Math.atan2(b,_));E=e.center.lng+function(e,t){const n=(t-e+180)%360-180;return n<-180?n+360:n}(e.center.lng,E);const S=ql(E),T=C(Gl(k),0,1);return new Yl(S,T)}class gl{constructor(e,t,n){this.a=$a([],e,n),this.b=$a([],t,n),this.center=n;const i=Ra([],this.a),r=Ra([],this.b);this.angle=Math.acos(za(i,r))}}function yl(e,t){if(0===e.angle)return null;let n;return n=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),n<0||n>1?null:function(e,t,n,i){const r=Math.sin(n);return e*(Math.sin((1-i)*n)/r)+t*(Math.sin(i*n)/r)}(e.a[t],e.b[t],e.angle,C(n,0,1))+e.center[t]}function vl(e){if(e.z<=1)return pl[e.z+2*e.y+e.x];const t=El(kl(e));return rl.fromPoints(t)}function bl(e,t,n){return Oa(e,e,1-n),Da(e,e,t,n)}function xl(e,t){const n=Dl(t.zoom);if(0===n)return vl(e);const i=kl(e),r=El(i),o=ql(i.getWest())*t.worldSize,s=ql(i.getEast())*t.worldSize,a=Gl(i.getNorth())*t.worldSize,l=Gl(i.getSouth())*t.worldSize,c=[o,a,0],u=[s,a,0],d=[o,l,0],h=[s,l,0],p=fa([],t.globeMatrix);return Ba(c,c,p),Ba(u,u,p),Ba(d,d,p),Ba(h,h,p),r[0]=bl(r[0],d,n),r[1]=bl(r[1],h,n),r[2]=bl(r[2],u,n),r[3]=bl(r[3],c,n),rl.fromPoints(r)}function _l(e,t,n){for(const i of e)Ba(i,i,t),Oa(i,i,n)}function wl(e,t,n){const i=t/e.worldSize,r=e.globeMatrix;if(n.z<=1){const e=vl(n).getCorners();return _l(e,r,i),rl.fromPoints(e)}const o=kl(n),s=El(o);_l(s,r,i);const a=Number.MAX_VALUE,l=[-a,-a,-a],c=[a,a,a];if(o.contains(e.center)){for(const e of s)Aa(c,c,e),Pa(l,l,e);l[2]=0;const t=e.point,n=[t.x*i,t.y*i,0];return Aa(c,c,n),Pa(l,l,n),new rl(c,l)}const u=[r[12]*i,r[13]*i,r[14]*i],d=o.getCenter(),h=C(e.center.lat,-Kl,Kl),p=C(d.lat,-Kl,Kl),f=ql(e.center.lng),m=Gl(h);let g=f-ql(d.lng);const y=m-Gl(p);g>.5?g-=1:g<-.5&&(g+=1);let v=0;Math.abs(g)>Math.abs(y)?v=g>=0?1:3:(v=y>=0?0:2,Da(u,u,[r[4]*i,r[5]*i,r[6]*i],-Math.sin(_(y>=0?o.getSouth():o.getNorth()))*al));const b=s[v],x=s[(v+1)%4],w=new gl(b,x,u),k=[yl(w,0)||b[0],yl(w,1)||b[1],yl(w,2)||b[2]],E=Dl(e.zoom);if(E>0){const i=function({x:e,y:t,z:n},i,r,o,s){const a=1/(1<<n);let l=e*a,c=l+a,u=t*a,d=u+a,h=0;const p=(l+c)/2-o;return p>.5?h=-1:p<-.5&&(h=1),l=((l+h)*i-(o*=i))*r+o,c=((c+h)*i-o)*r+o,u=(u*i-(s*=i))*r+s,d=(d*i-s)*r+s,[[l,d,0],[c,d,0],[c,u,0],[l,u,0]]}(n,t,e._pixelsPerMercatorPixel,f,m);for(let e=0;e<s.length;e++)bl(s[e],i[e],E);const r=Ca([],i[v],i[(v+1)%4]);Oa(r,r,.5),bl(k,r,E)}for(const _ of s)Aa(c,c,_),Pa(l,l,_);return c[2]=Math.min(b[2],x[2]),Aa(c,c,k),Pa(l,l,k),new rl(c,l)}function kl({x:e,y:t,z:n}){const i=1/(1<<n),r=new Vl(Hl(e*i),Zl((t+1)*i)),o=new Vl(Hl((e+1)*i),Zl(t*i));return new la(r,o)}function El(e){const t=_(e.getNorth()),n=_(e.getSouth()),i=Math.cos(t),r=Math.cos(n),o=Math.sin(t),s=Math.sin(n),a=e.getWest(),l=e.getEast();return[Sl(r,s,a),Sl(r,s,l),Sl(i,o,l),Sl(i,o,a)]}function Sl(e,t,n,i=al){return n=_(n),[e*Math.sin(n)*i,-t*i,e*Math.cos(n)*i]}function Tl(e,t,n){return Sl(Math.cos(_(e)),Math.sin(_(e)),t,n)}function Cl(e,t,n,i){const r=1<<n.z,o=(e/aa+n.x)/r;return Tl(Zl((t/aa+n.y)/r),Hl(o),i)}function Ml({min:e,max:t}){return ll/Math.max(t[0]-e[0],t[1]-e[1],t[2]-e[2])}const Il=new Float64Array(16);function Al(e){const t=Ml(e),n=xa(Il,[t,t,t]);return ga(n,n,((i=[])[0]=-(r=e.min)[0],i[1]=-r[1],i[2]=-r[2],i));var i,r}function Pl(e){const t=(i=e.min,(n=Il)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n);var n,i;const r=1/Ml(e);return ya(t,t,[r,r,r])}function Ol(e,t,n,i,r){const o=function(e){const t=aa/(2*Math.PI);return e/(2*Math.PI)/t}(n),s=[e,t,-n/(2*Math.PI)],a=pa(new Float64Array(16));return ga(a,a,s),ya(a,a,[o,o,o]),va(a,a,_(-r)),ba(a,a,_(-i)),a}function Dl(e){return M(ol,sl,e)}function Rl(e,t){const n=Tl(t.lat,t.lng),i=function(e){const t=Tl(e._center.lat,e._center.lng);let n=La([],Ta(0,1,0),t);const i=_a([],-e.angle,t);n=Ba(n,n,i),_a(i,-e._pitch,n);const r=Ra([],t);return Oa(r,r,fl(e.cameraToCenterDistance/e.pixelsPerMeter)),Ba(r,r,i),Ca([],t,r)}(e);return s=(r=Ma([],i,n))[0],a=r[1],l=r[2],c=(o=n)[0],u=o[1],d=o[2],p=(h=Math.sqrt(s*s+a*a+l*l)*Math.sqrt(c*c+u*u+d*d))&&za(r,o)/h,Math.acos(Math.min(Math.max(p,-1),1));var r,o,s,a,l,c,u,d,h,p}function zl(e,t){return Rl(e,t)>Math.PI/2*1.01}const Ll=_(85),Bl=Math.cos(Ll),Nl=Math.sin(Ll),Fl=6371008.8,$l=2*Math.PI*Fl;class jl{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new jl(I(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,n=this.lat*t,i=e.lat*t,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((e.lng-this.lng)*t);return Fl*Math.acos(Math.min(r,1))}toBounds(e=0){const t=360*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return new la(new jl(this.lng-n,this.lat-t),new jl(this.lng+n,this.lat+t))}toEcef(e){const t=fl(e);return Tl(this.lat,this.lng,al+t)}static convert(e){if(e instanceof jl)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new jl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new jl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Vl=jl;function Ul(e){return $l*Math.cos(e*Math.PI/180)}function ql(e){return(180+e)/360}function Gl(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Wl(e,t){return e/Ul(t)}function Hl(e){return 360*e-180}function Zl(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function Xl(e,t){return e*Ul(Zl(t))}const Kl=85.051129;function Jl(e){return 1/Math.cos(e*Math.PI/180)}class Yl{constructor(e,t,n=0){this.x=+e,this.y=+t,this.z=+n}static fromLngLat(e,t=0){const n=Vl.convert(e);return new Yl(ql(n.lng),Gl(n.lat),Wl(t,n.lat))}toLngLat(){return new Vl(Hl(this.x),Zl(this.y))}toAltitude(){return Xl(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/$l*Jl(Zl(this.y))}}function Ql(e,t,n,i,r,o,s,a,l){const c=(t+i)/2,u=(n+r)/2,d=new v(c,u);a(d),function(e,t,n,i,r,o){const s=n-r,a=i-o;return Math.abs((i-t)*s-(n-e)*a)/Math.hypot(s,a)}(d.x,d.y,o.x,o.y,s.x,s.y)>=l?(Ql(e,t,n,c,u,o,d,a,l),Ql(e,c,u,i,r,d,s,a,l)):e.push(s)}function ec(e,t,n){let i=e[0],r=i.x,o=i.y;t(i);const s=[i];for(let a=1;a<e.length;a++){const l=e[a],{x:c,y:u}=l;t(l),Ql(s,r,o,c,u,i,l,t,n),r=c,o=u,i=l}return s}function tc(e,t,n,i){if(i(t,n)){const r=t.add(n)._mult(.5);tc(e,t,r,i),tc(e,r,n,i)}else e.push(n)}function nc(e,t){let n=e[0];const i=[n];for(let r=1;r<e.length;r++){const o=e[r];tc(i,n,o,t),n=o}return i}const ic=Math.pow(2,14)-1,rc=-ic-1;function oc(e,t){const n=Math.round(e.x*t),i=Math.round(e.y*t);return e.x=C(n,rc,ic),e.y=C(i,rc,ic),(n<e.x||n>e.x+1||i<e.y||i>e.y+1)&&q("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function sc(e,t,n){const i=e.loadGeometry(),r=e.extent,o=aa/r;if(t&&n&&n.projection.isReprojectedInTileSpace){const o=1<<t.z,{scale:s,x:a,y:l,projection:c}=n,u=e=>{const n=Hl((t.x+e.x/r)/o),i=Zl((t.y+e.y/r)/o),u=c.project(n,i);e.x=(u.x*s-a)*r,e.y=(u.y*s-l)*r};for(let t=0;t<i.length;t++)if(1!==e.type)i[t]=ec(i[t],u,1);else{const e=[];for(const n of i[t])n.x<0||n.x>=r||n.y<0||n.y>=r||(u(n),e.push(n));i[t]=e}}for(const s of i)for(const e of s)oc(e,o);return i}function ac(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?sc(e):[]}}function lc(e,t,n,i,r){e.emplaceBack(2*t+(i+1)/2,2*n+(r+1)/2)}function cc(e,t,n){const i=16384;e.emplaceBack(t.x,t.y,t.z,n[0]*i,n[1]*i,n[2]*i)}class uc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new jo,this.indexArray=new is,this.segments=new sa,this.programConfigurations=new Ks(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,n,i){const r=this.layers[0],o=[];let s=null;"circle"===r.type&&(s=r.layout.get("circle-sort-key"));for(const{feature:l,id:c,index:u,sourceLayerIndex:d}of e){const e=this.layers[0]._featureFilter.needGeometry,t=ac(l,e);if(!this.layers[0]._featureFilter.filter(new wo(this.zoom),t,n))continue;const r=s?s.evaluate(t,{},n):void 0,a={id:c,properties:l.properties,type:l.type,sourceLayerIndex:d,index:u,geometry:e?t.geometry:sc(l,n,i),patterns:{},sortKey:r};o.push(a)}s&&o.sort(((e,t)=>e.sortKey-t.sortKey));let a=null;"globe"===i.projection.name&&(this.globeExtVertexArray=new Zo,a=i.projection);for(const l of o){const{geometry:i,index:r,sourceLayerIndex:o}=l,s=e[r].feature;this.addFeature(l,i,r,t.availableImages,n,a),t.featureIndex.insert(s,i,r,o,this.index)}}update(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ra.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,oa.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,t,n,i,r,o){for(const s of t)for(const t of s){const n=t.x,i=t.y;if(n<0||n>=aa||i<0||i>=aa)continue;if(o){const e=o.projectTilePoint(n,i,r),t=o.upVector(r,n,i),s=this.globeExtVertexArray;cc(s,e,t),cc(s,e,t),cc(s,e,t),cc(s,e,t)}const s=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=s.vertexLength;lc(this.layoutVertexArray,n,i,-1,-1),lc(this.layoutVertexArray,n,i,1,-1),lc(this.layoutVertexArray,n,i,1,1),lc(this.layoutVertexArray,n,i,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+2,a+3),s.vertexLength+=4,s.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},i,r)}}function dc(e,t){for(let n=0;n<e.length;n++)if(xc(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(xc(e,t[n]))return!0;return!!mc(e,t)}function hc(e,t,n){return!!xc(e,t)||!!yc(t,e,n)}function pc(e,t){if(1===e.length)return bc(t,e[0]);for(let n=0;n<t.length;n++){const i=t[n];for(let t=0;t<i.length;t++)if(xc(e,i[t]))return!0}for(let n=0;n<e.length;n++)if(bc(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(mc(e,t[n]))return!0;return!1}function fc(e,t,n){if(e.length>1){if(mc(e,t))return!0;for(let i=0;i<t.length;i++)if(yc(t[i],e,n))return!0}for(let i=0;i<e.length;i++)if(yc(e[i],t,n))return!0;return!1}function mc(e,t){if(0===e.length||0===t.length)return!1;for(let n=0;n<e.length-1;n++){const i=e[n],r=e[n+1];for(let e=0;e<t.length-1;e++)if(gc(i,r,t[e],t[e+1]))return!0}return!1}function gc(e,t,n,i){return G(e,n,i)!==G(t,n,i)&&G(e,t,n)!==G(e,t,i)}function yc(e,t,n){const i=n*n;if(1===t.length)return e.distSqr(t[0])<i;for(let r=1;r<t.length;r++)if(vc(e,t[r-1],t[r])<i)return!0;return!1}function vc(e,t,n){const i=t.distSqr(n);if(0===i)return e.distSqr(t);const r=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/i;return e.distSqr(r<0?t:r>1?n:n.sub(t)._mult(r)._add(t))}function bc(e,t){let n,i,r,o=!1;for(let s=0;s<e.length;s++){n=e[s];for(let e=0,s=n.length-1;e<n.length;s=e++)i=n[e],r=n[s],i.y>t.y!=r.y>t.y&&t.x<(r.x-i.x)*(t.y-i.y)/(r.y-i.y)+i.x&&(o=!o)}return o}function xc(e,t){let n=!1;for(let i=0,r=e.length-1;i<e.length;r=i++){const o=e[i],s=e[r];o.y>t.y!=s.y>t.y&&t.x<(s.x-o.x)*(t.y-o.y)/(s.y-o.y)+o.x&&(n=!n)}return n}function _c(e,t,n,i,r){for(const s of e)if(t<=s.x&&n<=s.y&&i>=s.x&&r>=s.y)return!0;const o=[new v(t,n),new v(t,r),new v(i,r),new v(i,n)];if(e.length>2)for(const s of o)if(xc(e,s))return!0;for(let s=0;s<e.length-1;s++)if(wc(e[s],e[s+1],o))return!0;return!1}function wc(e,t,n){const i=n[0],r=n[2];if(e.x<i.x&&t.x<i.x||e.x>r.x&&t.x>r.x||e.y<i.y&&t.y<i.y||e.y>r.y&&t.y>r.y)return!1;const o=G(e,t,n[0]);return o!==G(e,t,n[1])||o!==G(e,t,n[2])||o!==G(e,t,n[3])}function kc(e,t,n){const i=t.paint.get(e).value;return"constant"===i.kind?i.value:n.programConfigurations.get(t.id).getMaxValue(e)}function Ec(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Sc(e,t,n,i,r){if(!t[0]&&!t[1])return e;const o=v.convert(t)._mult(r);"viewport"===n&&o._rotate(-i);const s=[];for(let a=0;a<e.length;a++)s.push(e[a].sub(o));return s}function Tc(e,t,n,i){const r=v.convert(e)._mult(i);return"viewport"===t&&r._rotate(-n),r}Xr(uc,"CircleBucket",{omit:["layers"]});const Cc=new Ro({"circle-sort-key":new Oo(et.layout_circle["circle-sort-key"])});var Mc={paint:new Ro({"circle-radius":new Oo(et.paint_circle["circle-radius"]),"circle-color":new Oo(et.paint_circle["circle-color"]),"circle-blur":new Oo(et.paint_circle["circle-blur"]),"circle-opacity":new Oo(et.paint_circle["circle-opacity"]),"circle-translate":new Po(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Po(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Po(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Po(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Oo(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Oo(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Oo(et.paint_circle["circle-stroke-opacity"])}),layout:Cc};function Ic(e,t,n,i,r,o,s,a,l){if(o&&e.queryGeometry.isAboveHorizon)return!1;o&&(l*=e.pixelToTileUnitsFactor);const c=e.tileID.canonical,u=n.projection.upVectorScale(c,n.center.lat,n.worldSize).metersToTile;for(const d of t)for(const t of d){const d=t.add(a),h=r&&n.elevation?n.elevation.exaggeration()*r.getElevationAt(d.x,d.y,!0):0,p=n.projection.projectTilePoint(d.x,d.y,c);if(h>0){const e=n.projection.upVector(c,d.x,d.y);p.x+=e[0]*u*h,p.y+=e[1]*u*h,p.z+=e[2]*u*h}const f=o?d:Ac(p.x,p.y,p.z,i),m=o?e.tilespaceRays.map((e=>Dc(e,h))):e.queryGeometry.screenGeometry,g=Ga([],[p.x,p.y,p.z,1],i);if(!s&&o?l*=g[3]/n.cameraToCenterDistance:s&&!o&&(l*=n.cameraToCenterDistance/g[3]),o){const e=Zl((t.y/aa+c.y)/(1<<c.z));l/=n.projection.pixelsPerMeter(e,1)/Wl(1,e)}if(hc(m,f,l))return!0}return!1}function Ac(e,t,n,i){const r=Ga([],[e,t,n,1],i);return new v(r[0]/r[3],r[1]/r[3])}const Pc=Ta(0,0,0),Oc=Ta(0,0,1);function Dc(e,t){const n=ka();return Pc[2]=t,e.intersectsPlane(Pc,Oc,n),new v(n[0],n[1])}class Rc extends uc{}function zc(e,{width:t,height:n},i,r){if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==t*n*i)throw new RangeError("mismatched image size")}else r=new Uint8Array(t*n*i);return e.width=t,e.height=n,e.data=r,e}function Lc(e,t,n){const{width:i,height:r}=t;i===e.width&&r===e.height||(Bc(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,i),height:Math.min(e.height,r)},n),e.width=i,e.height=r,e.data=t.data)}function Bc(e,t,n,i,r,o){if(0===r.width||0===r.height)return t;if(r.width>e.width||r.height>e.height||n.x>e.width-r.width||n.y>e.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>t.width||r.height>t.height||i.x>t.width-r.width||i.y>t.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const s=e.data,a=t.data;for(let l=0;l<r.height;l++){const c=((n.y+l)*e.width+n.x)*o,u=((i.y+l)*t.width+i.x)*o;for(let e=0;e<r.width*o;e++)a[u+e]=s[c+e]}return t}Xr(Rc,"HeatmapBucket",{omit:["layers"]});class Nc{constructor(e,t){zc(this,e,1,t)}resize(e){Lc(this,new Nc(e),1)}clone(){return new Nc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,i,r){Bc(e,t,n,i,r,1)}}class Fc{constructor(e,t){zc(this,e,4,t)}resize(e){Lc(this,new Fc(e),4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Fc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,i,r){Bc(e,t,n,i,r,4)}}Xr(Nc,"AlphaImage"),Xr(Fc,"RGBAImage");var $c={paint:new Ro({"heatmap-radius":new Oo(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Oo(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Po(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Do(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Po(et.paint_heatmap["heatmap-opacity"])})};function jc(e){const t={},n=e.resolution||256,i=e.clips?e.clips.length:1,r=e.image||new Fc({width:n,height:i}),o=(n,i,o)=>{t[e.evaluationKey]=o;const s=e.expression.evaluate(t);r.data[n+i+0]=Math.floor(255*s.r/s.a),r.data[n+i+1]=Math.floor(255*s.g/s.a),r.data[n+i+2]=Math.floor(255*s.b/s.a),r.data[n+i+3]=Math.floor(255*s.a)};if(e.clips)for(let s=0,a=0;s<i;++s,a+=4*n)for(let t=0,i=0;t<n;t++,i+=4){const r=t/(n-1),{start:l,end:c}=e.clips[s];o(a,i,l*(1-r)+c*r)}else for(let s=0,a=0;s<n;s++,a+=4)o(0,a,s/(n-1));return r}var Vc={paint:new Ro({"hillshade-illumination-direction":new Po(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Po(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Po(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Po(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Po(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Po(et.paint_hillshade["hillshade-accent-color"])})};const Uc=Fo([{name:"a_pos",components:2,type:"Int16"}],4),{members:qc}=Uc;var Gc={exports:{}};function Wc(e,t,n){n=n||2;var i,r,o,s,a,l,c,u=t&&t.length,d=u?t[0]*n:e.length,h=Hc(e,0,d,n,!0),p=[];if(!h||h.next===h.prev)return p;if(u&&(h=function(e,t,n,i){var r,o,s,a=[];for(r=0,o=t.length;r<o;r++)(s=Hc(e,t[r]*i,r<o-1?t[r+1]*i:e.length,i,!1))===s.next&&(s.steiner=!0),a.push(ru(s));for(a.sort(eu),r=0;r<a.length;r++)n=tu(a[r],n);return n}(e,t,h,n)),e.length>80*n){i=o=e[0],r=s=e[1];for(var f=n;f<d;f+=n)(a=e[f])<i&&(i=a),(l=e[f+1])<r&&(r=l),a>o&&(o=a),l>s&&(s=l);c=0!==(c=Math.max(o-i,s-r))?32767/c:0}return Xc(h,p,n,i,r,c,0),p}function Hc(e,t,n,i,r){var o,s;if(r===yu(e,t,n,i)>0)for(o=t;o<n;o+=i)s=fu(o,e[o],e[o+1],s);else for(o=n-i;o>=t;o-=i)s=fu(o,e[o],e[o+1],s);return s&&lu(s,s.next)&&(mu(s),s=s.next),s}function Zc(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!lu(i,i.next)&&0!==au(i.prev,i,i.next))i=i.next;else{if(mu(i),(i=t=i.prev)===i.next)break;n=!0}}while(n||i!==t);return t}function Xc(e,t,n,i,r,o,s){if(e){!s&&o&&function(e,t,n,i){var r=e;do{0===r.z&&(r.z=iu(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,o,s,a,l,c=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,i=n,a=0,t=0;t<c&&(a++,i=i.nextZ);t++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(s>1)}(r)}(e,i,r,o);for(var a,l,c=e;e.prev!==e.next;)if(a=e.prev,l=e.next,o?Jc(e,i,r,o):Kc(e))t.push(a.i/n|0),t.push(e.i/n|0),t.push(l.i/n|0),mu(e),e=l.next,c=l.next;else if((e=l)===c){s?1===s?Xc(e=Yc(Zc(e),t,n),t,n,i,r,o,2):2===s&&Qc(e,t,n,i,r,o):Xc(Zc(e),t,n,i,r,o,1);break}}}function Kc(e){var t=e.prev,n=e,i=e.next;if(au(t,n,i)>=0)return!1;for(var r=t.x,o=n.x,s=i.x,a=t.y,l=n.y,c=i.y,u=r<o?r<s?r:s:o<s?o:s,d=a<l?a<c?a:c:l<c?l:c,h=r>o?r>s?r:s:o>s?o:s,p=a>l?a>c?a:c:l>c?l:c,f=i.next;f!==t;){if(f.x>=u&&f.x<=h&&f.y>=d&&f.y<=p&&ou(r,a,o,l,s,c,f.x,f.y)&&au(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Jc(e,t,n,i){var r=e.prev,o=e,s=e.next;if(au(r,o,s)>=0)return!1;for(var a=r.x,l=o.x,c=s.x,u=r.y,d=o.y,h=s.y,p=a<l?a<c?a:c:l<c?l:c,f=u<d?u<h?u:h:d<h?d:h,m=a>l?a>c?a:c:l>c?l:c,g=u>d?u>h?u:h:d>h?d:h,y=iu(p,f,t,n,i),v=iu(m,g,t,n,i),b=e.prevZ,x=e.nextZ;b&&b.z>=y&&x&&x.z<=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==s&&ou(a,u,l,d,c,h,b.x,b.y)&&au(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==s&&ou(a,u,l,d,c,h,x.x,x.y)&&au(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;b&&b.z>=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==r&&b!==s&&ou(a,u,l,d,c,h,b.x,b.y)&&au(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=v;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==s&&ou(a,u,l,d,c,h,x.x,x.y)&&au(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Yc(e,t,n){var i=e;do{var r=i.prev,o=i.next.next;!lu(r,o)&&cu(r,i,i.next,o)&&hu(r,o)&&hu(o,r)&&(t.push(r.i/n|0),t.push(i.i/n|0),t.push(o.i/n|0),mu(i),mu(i.next),i=e=o),i=i.next}while(i!==e);return Zc(i)}function Qc(e,t,n,i,r,o){var s=e;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&su(s,a)){var l=pu(s,a);return s=Zc(s,s.next),l=Zc(l,l.next),Xc(s,t,n,i,r,o,0),void Xc(l,t,n,i,r,o,0)}a=a.next}s=s.next}while(s!==e)}function eu(e,t){return e.x-t.x}function tu(e,t){var n=function(e,t){var n,i=t,r=e.x,o=e.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==t);if(!n)return null;var l,c=n,u=n.x,d=n.y,h=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&ou(o<d?r:s,o,u,d,o<d?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),hu(i,e)&&(l<h||l===h&&(i.x>n.x||i.x===n.x&&nu(n,i)))&&(n=i,h=l)),i=i.next}while(i!==c);return n}(e,t);if(!n)return t;var i=pu(n,e);return Zc(i,i.next),Zc(n,n.next)}function nu(e,t){return au(e.prev,e,t.prev)<0&&au(t.next,e,e.next)<0}function iu(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ru(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function ou(e,t,n,i,r,o,s,a){return(r-s)*(t-a)>=(e-s)*(o-a)&&(e-s)*(i-a)>=(n-s)*(t-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function su(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&cu(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(hu(e,t)&&hu(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(au(e.prev,e,t.prev)||au(e,t.prev,t))||lu(e,t)&&au(e.prev,e,e.next)>0&&au(t.prev,t,t.next)>0)}function au(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function lu(e,t){return e.x===t.x&&e.y===t.y}function cu(e,t,n,i){var r=du(au(e,t,n)),o=du(au(e,t,i)),s=du(au(n,i,e)),a=du(au(n,i,t));return r!==o&&s!==a||!(0!==r||!uu(e,n,t))||!(0!==o||!uu(e,i,t))||!(0!==s||!uu(n,e,i))||!(0!==a||!uu(n,t,i))}function uu(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function du(e){return e>0?1:e<0?-1:0}function hu(e,t){return au(e.prev,e,e.next)<0?au(e,t,e.next)>=0&&au(e,e.prev,t)>=0:au(e,t,e.prev)<0||au(e,e.next,t)<0}function pu(e,t){var n=new gu(e.i,e.x,e.y),i=new gu(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function fu(e,t,n,i){var r=new gu(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function mu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function gu(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function yu(e,t,n,i){for(var r=0,o=t,s=n-i;o<n;o+=i)r+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return r}Gc.exports=Wc,Gc.exports.default=Wc,Wc.deviation=function(e,t,n,i){var r=t&&t.length,o=Math.abs(yu(e,0,r?t[0]*n:e.length,n));if(r)for(var s=0,a=t.length;s<a;s++)o-=Math.abs(yu(e,t[s]*n,s<a-1?t[s+1]*n:e.length,n));var l=0;for(s=0;s<i.length;s+=3){var c=i[s]*n,u=i[s+1]*n,d=i[s+2]*n;l+=Math.abs((e[c]-e[d])*(e[u+1]-e[c+1])-(e[c]-e[u])*(e[d+1]-e[c+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},Wc.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var o=0;o<e[r].length;o++)for(var s=0;s<t;s++)n.vertices.push(e[r][o][s]);r>0&&n.holes.push(i+=e[r-1].length)}return n};var vu=h(Gc.exports);function bu(e,t,n,i,r){xu(e,t,n||0,i||e.length-1,r||wu)}function xu(e,t,n,i,r){for(;i>n;){if(i-n>600){var o=i-n+1,s=t-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);xu(e,t,Math.max(n,Math.floor(t-s*l/o+c)),Math.min(i,Math.floor(t+(o-s)*l/o+c)),r)}var u=e[t],d=n,h=i;for(_u(e,n,t),r(e[i],u)>0&&_u(e,n,i);d<h;){for(_u(e,d,h),d++,h--;r(e[d],u)<0;)d++;for(;r(e[h],u)>0;)h--}0===r(e[n],u)?_u(e,n,h):_u(e,++h,i),h<=t&&(n=h+1),t<=h&&(i=h-1)}}function _u(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function wu(e,t){return e<t?-1:e>t?1:0}function ku(e,t){const n=e.length;if(n<=1)return[e];const i=[];let r,o;for(let s=0;s<n;s++){const t=W(e[s]);0!==t&&(e[s].area=Math.abs(t),void 0===o&&(o=t<0),o===t<0?(r&&i.push(r),r=[e[s]]):r.push(e[s]))}if(r&&i.push(r),t>1)for(let s=0;s<i.length;s++)i[s].length<=t||(bu(i[s],t,1,i[s].length-1,Eu),i[s]=i[s].slice(0,t));return i}function Eu(e,t){return t.area-e.area}function Su(e,t,n){const i=n.patternDependencies;let r=!1;for(const o of t){const t=o.paint.get(`${e}-pattern`);t.isConstant()||(r=!0);const n=t.constantOr(null);n&&(r=!0,i[n]=!0)}return r}function Tu(e,t,n,i,r){const o=r.patternDependencies;for(const s of t){const t=s.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:i},n,{},r.availableImages);e=e&&e.name?e.name:e,o[e]=!0,n.patterns[s.id]=e}}return n}class Cu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new jo,this.indexArray=new is,this.indexArray2=new cs,this.programConfigurations=new Ks(e.layers,e.zoom),this.segments=new sa,this.segments2=new sa,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.projection=e.projection}populate(e,t,n,i){this.hasPattern=Su("fill",this.layers,t);const r=this.layers[0].layout.get("fill-sort-key"),o=[];for(const{feature:s,id:a,index:l,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,u=ac(s,e);if(!this.layers[0]._featureFilter.filter(new wo(this.zoom),u,n))continue;const d=r?r.evaluate(u,{},n,t.availableImages):void 0,h={id:a,properties:s.properties,type:s.type,sourceLayerIndex:c,index:l,geometry:e?u.geometry:sc(s,n,i),patterns:{},sortKey:d};o.push(h)}r&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const s of o){const{geometry:i,index:r,sourceLayerIndex:o}=s;if(this.hasPattern){const e=Tu("fill",this.layers,s,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(s,i,r,n,{},t.availableImages);t.featureIndex.insert(e[r].feature,i,r,o,this.index)}}update(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}addFeatures(e,t,n,i,r){for(const o of this.patternFeatures)this.addFeature(o,o.geometry,o.index,t,n,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,qc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,n,i,r,o=[]){for(const s of ku(t,500)){let e=0;for(const a of s)e+=a.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),n=t.vertexLength,i=[],r=[];for(const a of s){if(0===a.length)continue;a!==s[0]&&r.push(i.length/2);const e=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(t+a.length-1,t),i.push(a[0].x),i.push(a[0].y);for(let n=1;n<a.length;n++)this.layoutVertexArray.emplaceBack(a[n].x,a[n].y),this.indexArray2.emplaceBack(t+n-1,t+n),i.push(a[n].x),i.push(a[n].y);e.vertexLength+=a.length,e.primitiveLength+=a.length}const o=vu(i,r);for(let s=0;s<o.length;s+=3)this.indexArray.emplaceBack(n+o[s],n+o[s+1],n+o[s+2]);t.vertexLength+=e,t.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,o,i)}}Xr(Cu,"FillBucket",{omit:["layers","patternFeatures"]});const Mu=new Ro({"fill-sort-key":new Oo(et.layout_fill["fill-sort-key"])});var Iu={paint:new Ro({"fill-antialias":new Po(et.paint_fill["fill-antialias"]),"fill-opacity":new Oo(et.paint_fill["fill-opacity"]),"fill-color":new Oo(et.paint_fill["fill-color"]),"fill-outline-color":new Oo(et.paint_fill["fill-outline-color"]),"fill-translate":new Po(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Po(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new Oo(et.paint_fill["fill-pattern"])}),layout:Mu};const Au=Fo([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Pu=Fo([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ou=Fo([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Du}=Au;var Ru={},zu=g,Lu=Bu;function Bu(e,t,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=i,this._values=r,e.readFields(Nu,this,t)}function Nu(e,t,n){1==e?t.id=n.readVarint():2==e?function(e,t){for(var n=e.readVarint()+e.pos;e.pos<n;){var i=t._keys[e.readVarint()],r=t._values[e.readVarint()];t.properties[i]=r}}(n,t):3==e?t.type=n.readVarint():4==e&&(t._geometry=n.pos)}function Fu(e){for(var t,n,i=0,r=0,o=e.length,s=o-1;r<o;s=r++)i+=((n=e[s]).x-(t=e[r]).x)*(t.y+n.y);return i}Bu.types=["Unknown","Point","LineString","Polygon"],Bu.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,n=e.readVarint()+e.pos,i=1,r=0,o=0,s=0,a=[];e.pos<n;){if(r<=0){var l=e.readVarint();i=7&l,r=l>>3}if(r--,1===i||2===i)o+=e.readSVarint(),s+=e.readSVarint(),1===i&&(t&&a.push(t),t=[]),t.push(new zu(o,s));else{if(7!==i)throw new Error("unknown command "+i);t&&t.push(t[0].clone())}}return t&&a.push(t),a},Bu.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,i=0,r=0,o=0,s=1/0,a=-1/0,l=1/0,c=-1/0;e.pos<t;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)(r+=e.readSVarint())<s&&(s=r),r>a&&(a=r),(o+=e.readSVarint())<l&&(l=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command "+n)}return[s,l,a,c]},Bu.prototype.toGeoJSON=function(e,t,n){var i,r,o=this.extent*Math.pow(2,n),s=this.extent*e,a=this.extent*t,l=this.loadGeometry(),c=Bu.types[this.type];function u(e){for(var t=0;t<e.length;t++){var n=e[t];e[t]=[360*(n.x+s)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+a)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(i=0;i<l.length;i++)d[i]=l[i][0];u(l=d);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var n,i,r=[],o=0;o<t;o++){var s=Fu(e[o]);0!==s&&(void 0===i&&(i=s<0),i===s<0?(n&&r.push(n),n=[e[o]]):n.push(e[o]))}return n&&r.push(n),r}(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)u(l[i][r])}1===l.length?l=l[0]:c="Multi"+c;var h={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var $u=Lu,ju=Vu;function Vu(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Uu,this,t),this.length=this._features.length}function Uu(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){for(var t=null,n=e.readVarint()+e.pos;e.pos<n;){var i=e.readVarint()>>3;t=1===i?e.readString():2===i?e.readFloat():3===i?e.readDouble():4===i?e.readVarint64():5===i?e.readVarint():6===i?e.readSVarint():7===i?e.readBoolean():null}return t}(n))}Vu.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new $u(this._pbf,t,this.extent,this._keys,this._values)};var qu=ju;function Gu(e,t,n){if(3===e){var i=new qu(n,n.readVarint()+n.pos);i.length&&(t[i.name]=i)}}var Wu=Ru.VectorTile=function(e,t){this.layers=e.readFields(Gu,{},t)},Hu=Ru.VectorTileFeature=Lu;function Zu(e,t,n,i){const r=[],o=0===i?(e,t,n,i,r,o)=>{e.push(new v(o,n+(o-t)/(i-t)*(r-n)))}:(e,t,n,i,r,o)=>{e.push(new v(t+(o-n)/(r-n)*(i-t),o))};for(const s of e){const e=[];for(const r of s){if(r.length<=2)continue;const s=[];for(let e=0;e<r.length-1;e++){const a=r[e].x,l=r[e].y,c=r[e+1].x,u=r[e+1].y,d=0===i?a:l,h=0===i?c:u;d<t?h>t&&o(s,a,l,c,u,t):d>n?h<n&&o(s,a,l,c,u,n):s.push(r[e]),h<t&&d>=t&&o(s,a,l,c,u,t),h>n&&d<=n&&o(s,a,l,c,u,n)}let a=r[r.length-1];const l=0===i?a.x:a.y;l>=t&&l<=n&&s.push(a),s.length&&(a=s[s.length-1],s[0].x===a.x&&s[0].y===a.y||s.push(s[0]),e.push(s))}e.length&&r.push(e)}return r}Ru.VectorTileLayer=ju;const Xu=Hu.types,Ku=Math.pow(2,13);function Ju(e,t,n,i,r,o,s,a){e.emplaceBack((t<<1)+s,(n<<1)+o,(Math.floor(i*Ku)<<1)+r,Math.round(a))}function Yu(e,t,n){const i=16384;e.emplaceBack(t.x,t.y,t.z,n[0]*i,n[1]*i,n[2]*i)}class Qu{constructor(){this.acc=new v(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new v(e.x,e.y),this.max=new v(e.x,e.y))}append(e,t){this.currentPolyCount.edges++,this.acc._add(e);const n=this.min,i=this.max;e.x<n.x?n.x=e.x:e.x>i.x&&(i.x=e.x),e.y<n.y?n.y=e.y:e.y>i.y&&(i.y=e.y),((0===e.x||e.x===aa)&&e.x===t.x)!=((0===e.y||e.y===aa)&&e.y===t.y)&&this.processBorderOverlap(e,t),t.x<0!=e.x<0&&this.addBorderIntersection(0,On(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>aa!=e.x>aa&&this.addBorderIntersection(1,On(t.y,e.y,(aa-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,On(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>aa!=e.y>aa&&this.addBorderIntersection(3,On(t.x,e.x,(aa-t.y)/(e.y-t.y)))}addBorderIntersection(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const n=this.borders[e];t<n[0]&&(n[0]=t),t>n[1]&&(n[1]=t)}processBorderOverlap(e,t){if(e.x===t.x){if(e.y===t.y)return;const n=0===e.x?0:1;this.addBorderIntersection(n,t.y),this.addBorderIntersection(n,e.y)}else{const n=0===e.y?2:3;this.addBorderIntersection(n,t.x),this.addBorderIntersection(n,e.x)}}centroid(){const e=this.polyCount.reduce(((e,t)=>e+t.edges),0);return 0!==e?this.acc.div(e)._round():new v(0,0)}span(){return new v(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((e,t)=>e+ +(t[0]!==Number.MAX_VALUE)),0)}}class ed{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Uo,this.centroidVertexArray=new ws,this.indexArray=new is,this.programConfigurations=new Ks(e.layers,e.zoom),this.segments=new sa,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.enableTerrain=e.enableTerrain}populate(e,t,n,i){this.features=[],this.hasPattern=Su("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(e){const t=Math.exp(Math.PI*(1-e.y/(1<<e.z)*2));return 80150034*t/(t*t+1)/aa/(1<<e.z)}(n),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:r,id:o,index:s,sourceLayerIndex:a}of e){const e=this.layers[0]._featureFilter.needGeometry,l=ac(r,e);if(!this.layers[0]._featureFilter.filter(new wo(this.zoom),l,n))continue;const c={id:o,sourceLayerIndex:a,index:s,geometry:e?l.geometry:sc(r,n,i),properties:r.properties,type:r.type,patterns:{}},u=this.layoutVertexArray.length;this.hasPattern?this.features.push(Tu("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,s,n,{},t.availableImages,i),t.featureIndex.insert(r,c.geometry,s,a,this.index,u)}this.sortBorders()}addFeatures(e,t,n,i,r){for(const o of this.features){const{geometry:e}=o;this.addFeature(o,e,o.index,t,n,i,r)}this.sortBorders()}update(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Du),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Ou.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Pu.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,n,i,r,o,s){const a=[new v(0,0),new v(aa,aa)],l=s.projection,c="globe"===l.name,u=this.enableTerrain&&!c?new Qu:null,d="Polygon"===Xu[e.type];c&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Zo);const h=ku(t,500);for(let g=h.length-1;g>=0;g--){const e=h[g];(0===e.length||(p=e[0]).every((e=>e.x<=0))||p.every((e=>e.x>=aa))||p.every((e=>e.y<=0))||p.every((e=>e.y>=aa)))&&h.splice(g,1)}var p;let f;if(c)f=ld(h,a,i);else{f=[];for(const e of h)f.push({polygon:e,bounds:a})}const m=d?this.edgeRadius:0;for(const{polygon:g,bounds:y}of f){let e=0,t=0;for(const i of g)d&&!i[0].equals(i[i.length-1])&&i.push(i[0]),t+=d?i.length-1:i.length;const n=this.segments.prepareSegment((d?5:4)*t,this.layoutVertexArray,this.indexArray);if(d){const t=[],r=[];e=n.vertexLength;for(const e of g){let o,s;e.length&&e!==g[0]&&r.push(t.length/2),o=e[1].sub(e[0])._perp()._unit();for(let r=1;r<e.length;r++){const a=e[r],u=e[r===e.length-1?1:r+1];let{x:d,y:h}=a;if(m){s=u.sub(a)._perp()._unit();const e=o.add(s)._unit(),t=m*Math.min(4,1/(o.x*e.x+o.y*e.y));d+=t*e.x,h+=t*e.y,o=s}Ju(this.layoutVertexArray,d,h,0,0,1,1,0),n.vertexLength++,t.push(a.x,a.y),c&&Yu(this.layoutVertexExtArray,l.projectTilePoint(d,h,i),l.upVector(i,d,h))}}const o=vu(t,r);for(let i=0;i<o.length;i+=3)this.indexArray.emplaceBack(e+o[i],e+o[i+2],e+o[i+1]),n.primitiveLength++}for(const r of g){u&&r.length&&u.startRing(r[0]);let t,o,s,a=r.length>4&&od(r[r.length-2],r[0],r[1]),h=m?nd(r[r.length-2],r[0],r[1],m):0;o=r[1].sub(r[0])._perp()._unit();let p=!0;for(let f=1,g=0;f<r.length;f++){let v=r[f-1],b=r[f];const x=r[f===r.length-1?1:f+1];if(u&&d&&u.currentPolyCount.top++,rd(b,v,y)){m&&(o=x.sub(b)._perp()._unit(),p=!p);continue}u&&u.append(b,v);const _=b.sub(v)._perp(),w=_.x/(Math.abs(_.x)+Math.abs(_.y)),k=_.y>0?1:0,E=v.dist(b);if(g+E>32768&&(g=0),m){s=x.sub(b)._perp()._unit();let e=id(v,b,x,td(o,s),m);isNaN(e)&&(e=0);const t=b.sub(v)._unit();v=v.add(t.mult(h))._round(),b=b.add(t.mult(-e))._round(),h=e,o=s}const S=n.vertexLength,T=r.length>4&&od(v,b,x);let C=sd(g,a,p);if(Ju(this.layoutVertexArray,v.x,v.y,w,k,0,0,C),Ju(this.layoutVertexArray,v.x,v.y,w,k,0,1,C),g+=E,C=sd(g,T,!p),a=T,Ju(this.layoutVertexArray,b.x,b.y,w,k,0,0,C),Ju(this.layoutVertexArray,b.x,b.y,w,k,0,1,C),n.vertexLength+=4,this.indexArray.emplaceBack(S+0,S+1,S+2),this.indexArray.emplaceBack(S+1,S+3,S+2),n.primitiveLength+=2,m){const i=e+(1===f?r.length-2:f-2),o=1===f?e:i+1;if(this.indexArray.emplaceBack(S+1,i,S+3),this.indexArray.emplaceBack(i,o,S+3),n.primitiveLength+=2,void 0===t&&(t=S),!rd(x,r[f],y)){const e=f===r.length-1?t:n.vertexLength;this.indexArray.emplaceBack(S+2,S+3,e),this.indexArray.emplaceBack(S+3,e+1,e),this.indexArray.emplaceBack(S+3,o,e+1),n.primitiveLength+=3}p=!p}if(c){const e=this.layoutVertexExtArray,t=l.projectTilePoint(v.x,v.y,i),n=l.projectTilePoint(b.x,b.y,i),r=l.upVector(i,v.x,v.y),o=l.upVector(i,b.x,b.y);Yu(e,t,r),Yu(e,t,r),Yu(e,n,o),Yu(e,n,o)}}d&&(e+=r.length-1)}}if(u&&u.polyCount.length>0){if(u.borders){u.vertexArrayOffset=this.centroidVertexArray.length;const e=u.borders,t=this.featuresOnBorder.push(u)-1;for(let n=0;n<4;n++)e[n][0]!==Number.MAX_VALUE&&this.borders[n].push(t)}this.encodeCentroid(u.borders?void 0:u.centroid(),u)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,o,i)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort(((t,n)=>this.featuresOnBorder[t].borders[e][0]-this.featuresOnBorder[n].borders[e][0]))}encodeCentroid(e,t,n=!0){let i,r;if(e)if(0!==e.y){const n=t.span()._mult(this.tileToMeter);i=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(n.x/10)),r=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(n.y/10))}else i=Math.ceil(7*(e.x+450)),r=0;else i=0,r=+n;let o=n?this.centroidVertexArray.length:t.vertexArrayOffset;for(const s of t.polyCount){n&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*s.edges+s.top);for(let e=0;e<s.top;e++)this.centroidVertexArray.emplace(o++,i,r);for(let e=0;e<2*s.edges;e++)this.centroidVertexArray.emplace(o++,0,r),this.centroidVertexArray.emplace(o++,i,r)}}}function td(e,t){const n=e.add(t)._unit();return e.x*n.x+e.y*n.y}function nd(e,t,n,i){const r=t.sub(e)._perp()._unit(),o=n.sub(t)._perp()._unit();return id(e,t,n,td(r,o),i)}function id(e,t,n,i,r){const o=Math.sqrt(1-i*i);return Math.min(e.dist(t)/3,t.dist(n)/3,r*o/i)}function rd(e,t,n){return e.x<n[0].x&&t.x<n[0].x||e.x>n[1].x&&t.x>n[1].x||e.y<n[0].y&&t.y<n[0].y||e.y>n[1].y&&t.y>n[1].y}function od(e,t,n){if(e.x<0||e.x>=aa||t.x<0||t.x>=aa||n.x<0||n.x>=aa)return!1;const i=n.sub(t),r=i.perp(),o=e.sub(t);return(i.x*o.x+i.y*o.y)/Math.sqrt((i.x*i.x+i.y*i.y)*(o.x*o.x+o.y*o.y))>-.866&&r.x*o.x+r.y*o.y<0}function sd(e,t,n){const i=t?2|e:-3&e;return n?1|i:-2&i}function ad(){const e=Math.PI/32,t=Math.tan(e),n=Fl;return n*Math.sqrt(1+2*t*t)-n}function ld(e,t,n){const i=1<<n.z,r=Hl(n.x/i),o=Hl((n.x+1)/i),s=Zl(n.y/i),a=Zl((n.y+1)/i);return function(e,t,n,i,r=0,o){const s=[];if(!e.length||!n||!i)return s;const a=(e,t)=>{for(const n of e)s.push({polygon:n,bounds:t})},l=Math.ceil(Math.log2(n)),c=Math.ceil(Math.log2(i)),u=l-c,d=[];for(let f=0;f<Math.abs(u);f++)d.push(u>0?0:1);for(let f=0;f<Math.min(l,c);f++)d.push(0),d.push(1);let h=e;if(h=Zu(h,t[0].y-r,t[1].y+r,1),h=Zu(h,t[0].x-r,t[1].x+r,0),!h.length)return s;const p=[];for(d.length?p.push({polygons:h,bounds:t,depth:0}):a(h,t);p.length;){const e=p.pop(),t=e.depth,n=d[t],i=e.bounds[0],s=e.bounds[1],l=0===n?i.x:i.y,c=0===n?s.x:s.y,u=o?o(n,l,c):.5*(l+c),h=Zu(e.polygons,l-r,u+r,n),f=Zu(e.polygons,u-r,c+r,n);if(h.length){const e=[i,new v(0===n?u:s.x,1===n?u:s.y)];d.length>t+1?p.push({polygons:h,bounds:e,depth:t+1}):a(h,e)}if(f.length){const e=[new v(0===n?u:i.x,1===n?u:i.y),s];d.length>t+1?p.push({polygons:f,bounds:e,depth:t+1}):a(f,e)}}return s}(e,t,Math.ceil((o-r)/11.25),Math.ceil((s-a)/11.25),1,((e,t,r)=>{if(0===e)return.5*(t+r);{const e=Zl((n.y+t/aa)/i);return(Gl(.5*(Zl((n.y+r/aa)/i)+e))*i-n.y)*aa}}))}Xr(ed,"FillExtrusionBucket",{omit:["layers","features"]}),Xr(Qu,"PartMetadata");const cd=new Ro({"fill-extrusion-edge-radius":new Po(et["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var ud={paint:new Ro({"fill-extrusion-opacity":new Po(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Oo(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Po(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Po(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Oo(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Oo(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Oo(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Po(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Po(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Po(et["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Po(et["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:cd};function dd(e,t,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[e*i-2*Math.PI*6378137/2,t*i-2*Math.PI*6378137/2]}class hd{constructor(e,t,n){this.z=e,this.x=t,this.y=n,this.key=md(0,e,e,t,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t){const n=function(e,t,n){var i=dd(256*e,256*(t=Math.pow(2,n)-t-1),n),r=dd(256*(e+1),256*(t+1),n);return i[0]+","+i[1]+","+r[0]+","+r[1]}(this.x,this.y,this.z),i=function(e,t,n){let i,r="";for(let o=e;o>0;o--)i=1<<o-1,r+=(t&i?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",n)}toString(){return`${this.z}/${this.x}/${this.y}`}}class pd{constructor(e,t){this.wrap=e,this.canonical=t,this.key=md(e,t.z,t.z,t.x,t.y)}}class fd{constructor(e,t,n,i,r){this.overscaledZ=e,this.wrap=t,this.canonical=new hd(n,+i,+r),this.key=0===t&&e===n?this.canonical.key:md(t,e,n,i,r)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const t=this.canonical.z-e;return e>this.canonical.z?new fd(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fd(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t=!0){if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return md(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);{const n=this.canonical.z-e;return md(this.wrap*+t,e,e,this.canonical.x>>n,this.canonical.y>>n)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new fd(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new fd(t,this.wrap,t,n,i),new fd(t,this.wrap,t,n+1,i),new fd(t,this.wrap,t,n,i+1),new fd(t,this.wrap,t,n+1,i+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new fd(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new fd(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new pd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function md(e,t,n,i,r){const o=1<<Math.min(n,22);let s=o*(r%o)+i%o;return e&&n<22&&(s+=o*o*((e<0?-2*e-1:2*e)%(1<<2*(22-n)))),16*(32*s+n)+(t-n)}Xr(hd,"CanonicalTileID"),Xr(fd,"OverscaledTileID",{omit:["projMatrix"]});class gd extends v{constructor(e,t,n){super(e,t),this.z=n}}function yd(e,t){return e.x*t.x+e.y*t.y}function vd(e,t){if(1===e.length){let n=0;const i=t[n++];let r;for(;!r||i.equals(r);)if(r=t[n++],!r)return 1/0;for(;n<t.length;n++){const o=t[n],s=e[0],a=r.sub(i),l=o.sub(i),c=s.sub(i),u=yd(a,a),d=yd(a,l),h=yd(l,l),p=yd(c,a),f=yd(c,l),m=u*h-d*d,g=(h*p-d*f)/m,y=(u*f-d*p)/m,v=i.z*(1-g-y)+r.z*g+o.z*y;if(isFinite(v))return v}return 1/0}{let e=1/0;for(const n of t)e=Math.min(e,n.z);return e}}function bd(e,t,n,i,r,o,s,a){const l=s*r.getElevationAt(e,t,!0,!0),c=0!==o[0],u=c?0===o[1]?s*(o[0]/7-450):s*function(e,t,n){const i=Math.floor(t[0]/8),r=Math.floor(t[1]/8),o=10*(t[0]-8*i),s=10*(t[1]-8*r),a=e.getElevationAt(i,r,!0,!0),l=e.getMeterToDEM(n),c=Math.floor(.5*(o*l-1)),u=Math.floor(.5*(s*l-1)),d=e.tileCoordToPixel(i,r),h=2*c+1,p=2*u+1,f=function(e,t,n,i,r){return[e.getElevationAtPixel(t,n,!0),e.getElevationAtPixel(t+r,n,!0),e.getElevationAtPixel(t,n+r,!0),e.getElevationAtPixel(t+i,n+r,!0)]}(e,d.x-c,d.y-u,h,p),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),v=Math.min(.25,.5*l*(m+g)/h),b=Math.min(.25,.5*l*y/p);return a+Math.max(v*o,b*s)}(r,o,a):l;return{base:l+(0===n)?-1:n,top:c?Math.max(u+i,l+n+2):l+i}}const xd=Fo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:_d}=xd,wd=Fo([{name:"a_packed",components:4,type:"Float32"}]),{members:kd}=wd,Ed=Hu.types,Sd=Math.cos(Math.PI/180*37.5);class Td{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new qo,this.layoutVertexArray2=new Go,this.indexArray=new is,this.programConfigurations=new Ks(e.layers,e.zoom),this.segments=new sa,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,n,i){this.hasPattern=Su("line",this.layers,t);const r=this.layers[0].layout.get("line-sort-key"),o=[];for(const{feature:c,id:u,index:d,sourceLayerIndex:h}of e){const e=this.layers[0]._featureFilter.needGeometry,t=ac(c,e);if(!this.layers[0]._featureFilter.filter(new wo(this.zoom),t,n))continue;const s=r?r.evaluate(t,{},n):void 0,a={id:u,properties:c.properties,type:c.type,sourceLayerIndex:h,index:d,geometry:e?t.geometry:sc(c,n,i),patterns:{},sortKey:s};o.push(a)}r&&o.sort(((e,t)=>e.sortKey-t.sortKey));const{lineAtlas:s,featureIndex:a}=t,l=this.addConstantDashes(s);for(const c of o){const{geometry:i,index:r,sourceLayerIndex:o}=c;if(l&&this.addFeatureDashes(c,s),this.hasPattern){const e=Tu("line",this.layers,c,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(c,i,r,n,s.positions,t.availableImages);a.insert(e[r].feature,i,r,o,this.index)}}addConstantDashes(e){let t=!1;for(const n of this.layers){const i=n.paint.get("line-dasharray").value,r=n.layout.get("line-cap").value;if("constant"!==i.kind||"constant"!==r.kind)t=!0;else{const t=r.value,n=i.value;if(!n)continue;e.addDash(n,t)}}return t}addFeatureDashes(e,t){const n=this.zoom;for(const i of this.layers){const r=i.paint.get("line-dasharray").value,o=i.layout.get("line-cap").value;if("constant"===r.kind&&"constant"===o.kind)continue;let s,a;if("constant"===r.kind){if(s=r.value,!s)continue}else s=r.evaluate({zoom:n},e);a="constant"===o.kind?o.value:o.evaluate({zoom:n},e),t.addDash(s,a),e.patterns[i.id]=t.getKey(s,a)}}update(e,t,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n,i)}addFeatures(e,t,n,i,r){for(const o of this.patternFeatures)this.addFeature(o,o.geometry,o.index,t,n,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,kd)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_d),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,n,i,r,o){const s=this.layers[0].layout,a=s.get("line-join").evaluate(e,{}),l=s.get("line-cap").evaluate(e,{}),c=s.get("line-miter-limit"),u=s.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const d of t)this.addLine(d,e,a,l,c,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,r,o,i)}addLine(e,t,n,i,r,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const s="Polygon"===Ed[t.type];let a=e.length;for(;a>=2&&e[a-1].equals(e[a-2]);)a--;let l=0;for(;l<a-1&&e[l].equals(e[l+1]);)l++;if(a<(s?3:2))return;"bevel"===n&&(r=1.05);const c=this.overscaling<=16?15*aa/(512*this.overscaling):0,u=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray);let d,h,p,f,m;this.e1=this.e2=-1,s&&(d=e[a-2],m=e[l].sub(d)._unit()._perp());for(let g=l;g<a;g++){if(p=g===a-1?s?e[l+1]:void 0:e[g+1],p&&e[g].equals(p))continue;m&&(f=m),d&&(h=d),d=e[g],m=p?p.sub(d)._unit()._perp():f,f=f||m;let t=f.add(m);0===t.x&&0===t.y||t._unit();const y=f.x*m.x+f.y*m.y,v=t.x*m.x+t.y*m.y,b=0!==v?1/v:1/0,x=2*Math.sqrt(2-2*v),_=v<Sd&&h&&p,w=f.x*m.y-f.y*m.x>0;if(_&&g>l){const e=d.dist(h);if(e>2*c){const t=d.sub(d.sub(h)._mult(c/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,f,0,0,u),h=t}}const k=h&&p;let E=k?n:s?"butt":i;if(k&&"round"===E&&(b<o?E="miter":b<=2&&(E="fakeround")),"miter"===E&&b>r&&(E="bevel"),"bevel"===E&&(b>2&&(E="flipbevel"),b<r&&(E="miter")),h&&this.updateDistance(h,d),"miter"===E)t._mult(b),this.addCurrentVertex(d,t,0,0,u);else if("flipbevel"===E){if(b>100)t=m.mult(-1);else{const e=b*f.add(m).mag()/f.sub(m).mag();t._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(d,t,0,0,u),this.addCurrentVertex(d,t.mult(-1),0,0,u)}else if("bevel"===E||"fakeround"===E){const e=-Math.sqrt(b*b-1),t=w?e:0,n=w?0:e;if(h&&this.addCurrentVertex(d,f,t,n,u),"fakeround"===E){const e=Math.round(180*x/Math.PI/20);for(let t=1;t<e;t++){let n=t/e;if(.5!==n){const e=n-.5;n+=n*e*(n-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*e*e+(.848013+y*(.215638*y-1.06021)))}const i=m.sub(f)._mult(n)._add(f)._unit()._mult(w?-1:1);this.addHalfVertex(d,i.x,i.y,!1,w,0,u)}}p&&this.addCurrentVertex(d,m,-t,-n,u)}else if("butt"===E)this.addCurrentVertex(d,t,0,0,u);else if("square"===E){const e=h?1:-1;h||this.addCurrentVertex(d,t,e,e,u),this.addCurrentVertex(d,t,0,0,u),h&&this.addCurrentVertex(d,t,e,e,u)}else"round"===E&&(h&&(this.addCurrentVertex(d,f,0,0,u),this.addCurrentVertex(d,f,1,1,u,!0)),p&&(this.addCurrentVertex(d,m,-1,-1,u,!0),this.addCurrentVertex(d,m,0,0,u)));if(_&&g<a-1){const e=d.dist(p);if(e>2*c){const t=d.add(p.sub(d)._mult(c/e)._round());this.updateDistance(d,t),this.addCurrentVertex(t,m,0,0,u),d=t}}}}addCurrentVertex(e,t,n,i,r,o=!1){const s=t.y*i-t.x,a=-t.y-t.x*i;this.addHalfVertex(e,t.x+t.y*n,t.y-t.x*n,o,!1,n,r),this.addHalfVertex(e,s,a,o,!0,-i,r)}addHalfVertex({x:e,y:t},n,i,r,o,s,a){this.layoutVertexArray.emplaceBack((e<<1)+(r?1:0),(t<<1)+(o?1:0),Math.round(63*n)+128,Math.round(63*i)+128,1+(0===s?0:s<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const l=a.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),a.primitiveLength++),o?this.e2=l:this.e1=l}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}Xr(Td,"LineBucket",{omit:["layers","patternFeatures"]});const Cd=new Ro({"line-cap":new Oo(et.layout_line["line-cap"]),"line-join":new Oo(et.layout_line["line-join"]),"line-miter-limit":new Po(et.layout_line["line-miter-limit"]),"line-round-limit":new Po(et.layout_line["line-round-limit"]),"line-sort-key":new Oo(et.layout_line["line-sort-key"])});var Md={paint:new Ro({"line-opacity":new Oo(et.paint_line["line-opacity"]),"line-color":new Oo(et.paint_line["line-color"]),"line-translate":new Po(et.paint_line["line-translate"]),"line-translate-anchor":new Po(et.paint_line["line-translate-anchor"]),"line-width":new Oo(et.paint_line["line-width"]),"line-gap-width":new Oo(et.paint_line["line-gap-width"]),"line-offset":new Oo(et.paint_line["line-offset"]),"line-blur":new Oo(et.paint_line["line-blur"]),"line-dasharray":new Oo(et.paint_line["line-dasharray"]),"line-pattern":new Oo(et.paint_line["line-pattern"]),"line-gradient":new Do(et.paint_line["line-gradient"]),"line-trim-offset":new Po(et.paint_line["line-trim-offset"])}),layout:Cd};const Id=new class extends Oo{possiblyEvaluate(e,t){return t=new wo(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,n,i){return t=O({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,n,i)}}(Md.paint.properties["line-width"].specification);function Ad(e,t){return t>0?t+2*e:e}Id.useIntegerZoom=!0;const Pd=Fo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Od=Fo([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Dd=Fo([{name:"a_projected_pos",components:4,type:"Float32"}],4);Fo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Rd=Fo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),zd=Fo([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Fo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ld=Fo([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Bd=Fo([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Fo([{name:"triangle",components:3,type:"Uint16"}]),Fo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Fo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Fo([{type:"Float32",name:"offsetX"}]),Fo([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Nd=24;const Fd=128;function $d(e,t){const{expression:n}=t;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new wo(e+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:i}=n;let r=0;for(;r<t.length&&t[r]<=e;)r++;r=Math.max(0,r-1);let o=r;for(;o<t.length&&t[o]<e+1;)o++;o=Math.min(t.length-1,o);const s=t[r],a=t[o];return"composite"===n.kind?{kind:"composite",minZoom:s,maxZoom:a,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:a,minSize:n.evaluate(new wo(s)),maxSize:n.evaluate(new wo(a)),interpolationType:i}}}function jd(e,{uSize:t,uSizeT:n},{lowerSize:i,upperSize:r}){return"source"===e.kind?i/Fd:"composite"===e.kind?On(i/Fd,r/Fd,n):t}function Vd(e,t){let n=0,i=0;if("constant"===e.kind)i=e.layoutSize;else if("source"!==e.kind){const{interpolationType:r,minZoom:o,maxZoom:s}=e,a=r?C(ei.interpolationFactor(r,t,o,s),0,1):0;"camera"===e.kind?i=On(e.minSize,e.maxSize,a):n=a}return{uSizeT:n,uSize:i}}var Ud=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Fd,evaluateSizeForFeature:jd,evaluateSizeForZoom:Vd,getSizeData:$d});function qd(e,t,n){return e.sections.forEach((e=>{e.text=function(e,t,n){const i=t.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?e=e.toLocaleUpperCase():"lowercase"===i&&(e=e.toLocaleLowerCase()),_o.applyArabicShaping&&(e=_o.applyArabicShaping(e)),e}(e.text,t,n)})),e}const Gd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function Wd(e){return"︶"===e||"﹈"===e||"︸"===e||"﹄"===e||"﹂"===e||"︾"===e||"︼"===e||"︺"===e||"︘"===e||"﹀"===e||"︐"===e||"︓"===e||"︔"===e||"｀"===e||"￣"===e||"︑"===e||"︒"===e}function Hd(e){return"︵"===e||"﹇"===e||"︷"===e||"﹃"===e||"﹁"===e||"︽"===e||"︻"===e||"︹"===e||"︗"===e||"︿"===e}var Zd=Jd,Xd=function(e,t,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?r-1:0,h=n?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=i;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=c}return(p?-1:1)*s*Math.pow(2,o-i)},Kd=function(e,t,n,i,r,o){var s,a,l,c=8*o-r-1,u=(1<<c)-1,d=u>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*l-1)*Math.pow(2,r),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,r),s=0));r>=8;e[n+p]=255&a,p+=f,a/=256,r-=8);for(s=s<<r|a,c+=r;c>0;e[n+p]=255&s,p+=f,s/=256,c-=8);e[n+p-f]|=128*m};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Jd(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Jd.Varint=0,Jd.Fixed64=1,Jd.Bytes=2,Jd.Fixed32=5;var Yd=4294967296,Qd=1/Yd,eh="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function th(e){return e.type===Jd.Bytes?e.readVarint()+e.pos:e.pos+1}function nh(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function ih(e,t,n){var i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=e;r--)n.buf[r+i]=n.buf[r]}function rh(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function oh(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function sh(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function ah(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function lh(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function ch(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function uh(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function dh(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function hh(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function ph(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function fh(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function mh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Jd.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,e(r,t,this),this.pos===o&&this.skip(i)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=ph(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=mh(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=ph(this.buf,this.pos)+ph(this.buf,this.pos+4)*Yd;return this.pos+=8,e},readSFixed64:function(){var e=ph(this.buf,this.pos)+mh(this.buf,this.pos+4)*Yd;return this.pos+=8,e},readFloat:function(){var e=Xd(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Xd(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,i=this.buf;return t=127&(n=i[this.pos++]),n<128?t:(t|=(127&(n=i[this.pos++]))<<7,n<128?t:(t|=(127&(n=i[this.pos++]))<<14,n<128?t:(t|=(127&(n=i[this.pos++]))<<21,n<128?t:function(e,t,n){var i,r,o=n.buf;if(i=(112&(r=o[n.pos++]))>>4,r<128)return nh(e,i,t);if(i|=(127&(r=o[n.pos++]))<<3,r<128)return nh(e,i,t);if(i|=(127&(r=o[n.pos++]))<<10,r<128)return nh(e,i,t);if(i|=(127&(r=o[n.pos++]))<<17,r<128)return nh(e,i,t);if(i|=(127&(r=o[n.pos++]))<<24,r<128)return nh(e,i,t);if(i|=(1&(r=o[n.pos++]))<<31,r<128)return nh(e,i,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=i[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&eh?function(e,t,n){return eh.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){for(var i="",r=t;r<n;){var o,s,a,l=e[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(o=e[r+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(s=e[r+2],128==(192&(o=e[r+1]))&&128==(192&s)&&((c=(15&l)<<12|(63&o)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(s=e[r+2],a=e[r+3],128==(192&(o=e[r+1]))&&128==(192&s)&&128==(192&a)&&((c=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=u}return i}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Jd.Bytes)return e.push(this.readVarint(t));var n=th(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Jd.Bytes)return e.push(this.readSVarint());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Jd.Bytes)return e.push(this.readBoolean());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Jd.Bytes)return e.push(this.readFloat());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Jd.Bytes)return e.push(this.readDouble());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Jd.Bytes)return e.push(this.readFixed32());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Jd.Bytes)return e.push(this.readSFixed32());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Jd.Bytes)return e.push(this.readFixed64());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Jd.Bytes)return e.push(this.readSFixed64());var t=th(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Jd.Varint)for(;this.buf[this.pos++]>127;);else if(t===Jd.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Jd.Fixed32)this.pos+=4;else{if(t!==Jd.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),fh(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),fh(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),fh(this.buf,-1&e,this.pos),fh(this.buf,Math.floor(e*Qd),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),fh(this.buf,-1&e,this.pos),fh(this.buf,Math.floor(e*Qd),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,i;if(e>=0?(n=e%4294967296|0,i=e/4294967296|0):(i=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,i=i+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,n.buf[n.pos]=127&(e>>>=7)}(n,0,t),function(e,t){var n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(i,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var i,r,o=0;o<t.length;o++){if((i=t.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):r=i;continue}if(i<56320){e[n++]=239,e[n++]=191,e[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(e[n++]=239,e[n++]=191,e[n++]=189,r=null);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(i<65536?e[n++]=i>>12|224:(e[n++]=i>>18|240,e[n++]=i>>12&63|128),e[n++]=i>>6&63|128),e[n++]=63&i|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&ih(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),Kd(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Kd(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var i=this.pos-n;i>=128&&ih(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(e,t,n){this.writeTag(e,Jd.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,rh,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,oh,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,lh,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,sh,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,ah,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,ch,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,uh,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,dh,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,hh,t)},writeBytesField:function(e,t){this.writeTag(e,Jd.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Jd.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Jd.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Jd.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Jd.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Jd.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Jd.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Jd.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Jd.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Jd.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var gh=h(Zd);const yh=3;function vh(e,t,n){t.glyphs=[],1===e&&n.readMessage(bh,t)}function bh(e,t,n){if(3===e){const{id:e,bitmap:i,width:r,height:o,left:s,top:a,advance:l}=n.readMessage(xh,{});t.glyphs.push({id:e,bitmap:new Nc({width:r+2*yh,height:o+2*yh},i),metrics:{width:r,height:o,left:s,top:a,advance:l}})}else 4===e?t.ascender=n.readSVarint():5===e&&(t.descender=n.readSVarint())}function xh(e,t,n){1===e?t.id=n.readVarint():2===e?t.bitmap=n.readBytes():3===e?t.width=n.readVarint():4===e?t.height=n.readVarint():5===e?t.left=n.readSVarint():6===e?t.top=n.readSVarint():7===e&&(t.advance=n.readVarint())}const _h=yh;function wh(e){let t=0,n=0;for(const s of e)t+=s.w*s.h,n=Math.max(n,s.w);e.sort(((e,t)=>t.h-e.h));const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let r=0,o=0;for(const s of e)for(let e=i.length-1;e>=0;e--){const t=i[e];if(!(s.w>t.w||s.h>t.h)){if(s.x=t.x,s.y=t.y,o=Math.max(o,s.y+s.h),r=Math.max(r,s.x+s.w),s.w===t.w&&s.h===t.h){const t=i.pop();e<i.length&&(i[e]=t)}else s.h===t.h?(t.x+=s.w,t.w-=s.w):s.w===t.w?(t.y+=s.h,t.h-=s.h):(i.push({x:t.x+s.w,y:t.y,w:t.w-s.w,h:s.h}),t.y+=s.h,t.h-=s.h);break}}return{w:r,h:o,fill:t/(r*o)||0}}const kh=1;class Eh{constructor(e,{pixelRatio:t,version:n,stretchX:i,stretchY:r,content:o}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=i,this.stretchY=r,this.content=o,this.version=n}get tl(){return[this.paddedRect.x+kh,this.paddedRect.y+kh]}get br(){return[this.paddedRect.x+this.paddedRect.w-kh,this.paddedRect.y+this.paddedRect.h-kh]}get displaySize(){return[(this.paddedRect.w-2*kh)/this.pixelRatio,(this.paddedRect.h-2*kh)/this.pixelRatio]}}class Sh{constructor(e,t){const n={},i={};this.haveRenderCallbacks=[];const r=[];this.addImages(e,n,r),this.addImages(t,i,r);const{w:o,h:s}=wh(r),a=new Fc({width:o||1,height:s||1});for(const l in e){const t=e[l],i=n[l].paddedRect;Fc.copy(t.data,a,{x:0,y:0},{x:i.x+kh,y:i.y+kh},t.data)}for(const l in t){const e=t[l],n=i[l].paddedRect,r=n.x+kh,o=n.y+kh,s=e.data.width,c=e.data.height;Fc.copy(e.data,a,{x:0,y:0},{x:r,y:o},e.data),Fc.copy(e.data,a,{x:0,y:c-1},{x:r,y:o-1},{width:s,height:1}),Fc.copy(e.data,a,{x:0,y:0},{x:r,y:o+c},{width:s,height:1}),Fc.copy(e.data,a,{x:s-1,y:0},{x:r-1,y:o},{width:1,height:c}),Fc.copy(e.data,a,{x:0,y:0},{x:r+s,y:o},{width:1,height:c})}this.image=a,this.iconPositions=n,this.patternPositions=i}addImages(e,t,n){for(const i in e){const r=e[i],o={x:0,y:0,w:r.data.width+2*kh,h:r.data.height+2*kh};n.push(o),t[i]=new Eh(o,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(e,t){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((t=>e.hasImage(t))),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),t),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),t)}patchUpdatedImage(e,t,n){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[i,r]=e.tl;n.update(t.data,void 0,{x:i,y:r})}}Xr(Eh,"ImagePosition"),Xr(Sh,"ImageAtlas");const Th={horizontal:1,vertical:2,horizontalOnly:3},Ch=-17;class Mh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const n=new Mh;return n.scale=e||1,n.fontStack=t,n}static forImage(e){const t=new Mh;return t.imageName=e,t}}class Ih{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const n=new Ih;for(let i=0;i<e.sections.length;i++){const r=e.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,t)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(e,t){let n="";for(let i=0;i<e.length;i++){const r=e.charCodeAt(i+1)||null,o=e.charCodeAt(i-1)||null;n+=!t&&(r&&oo(r)&&!Gd[e[i+1]]||o&&oo(o)&&!Gd[e[i-1]])||!Gd[e[i]]?e[i]:Gd[e[i]]}return n}(this.text,e)}trim(){let e=0;for(let n=0;n<this.text.length&&Ph[this.text.charCodeAt(n)];n++)e++;let t=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&Ph[this.text.charCodeAt(n)];n--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const n=new Ih;return n.text=this.text.substring(e,t),n.sectionIndex=this.sectionIndex.slice(e,t),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(Mh.forText(e.scale,e.fontStack||t));const n=this.sections.length-1;for(let i=0;i<e.text.length;++i)this.sectionIndex.push(n)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void q("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Mh.forImage(t)),this.sectionIndex.push(this.sections.length-1)):q("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ah(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f){const m=Ih.fromFeature(e,r);d===Th.vertical&&m.verticalizePunctuation(h);let g=[];const y=function(e,t,n,i,r,o){if(!e)return[];const s=[],a=function(e,t,n,i,r,o){let s=0;for(let a=0;a<e.length();a++){const n=e.getSection(a);s+=Dh(e.getCharCode(a),n,i,r,t,o)}return s/Math.max(1,Math.ceil(s/n))}(e,t,n,i,r,o),l=e.text.indexOf("​")>=0;let c=0;for(let d=0;d<e.length();d++){const n=e.getSection(d),h=e.getCharCode(d);if(Ph[h]||(c+=Dh(h,n,i,r,t,o)),d<e.length()-1){const t=!((u=h)<11904||!(eo["Bopomofo Extended"](u)||eo.Bopomofo(u)||eo["CJK Compatibility Forms"](u)||eo["CJK Compatibility Ideographs"](u)||eo["CJK Compatibility"](u)||eo["CJK Radicals Supplement"](u)||eo["CJK Strokes"](u)||eo["CJK Symbols and Punctuation"](u)||eo["CJK Unified Ideographs Extension A"](u)||eo["CJK Unified Ideographs"](u)||eo["Enclosed CJK Letters and Months"](u)||eo["Halfwidth and Fullwidth Forms"](u)||eo.Hiragana(u)||eo["Ideographic Description Characters"](u)||eo["Kangxi Radicals"](u)||eo["Katakana Phonetic Extensions"](u)||eo.Katakana(u)||eo["Vertical Forms"](u)||eo["Yi Radicals"](u)||eo["Yi Syllables"](u)));(Oh[h]||t||n.imageName)&&s.push(Lh(d+1,c,a,s,zh(h,e.getCharCode(d+1),t&&l),!1))}}var u;return Bh(Lh(e.length(),c,a,s,0,!0))}(m,c,o,t,i,p),{processBidirectionalText:v,processStyledBidirectionalText:b}=_o;if(v&&1===m.sections.length){const e=v(m.toString(),y);for(const t of e){const e=new Ih;e.text=t,e.sections=m.sections;for(let n=0;n<t.length;n++)e.sectionIndex.push(0);g.push(e)}}else if(b){const e=b(m.text,m.sectionIndex,y);for(const t of e){const e=new Ih;e.text=t[0],e.sectionIndex=t[1],e.sections=m.sections,g.push(e)}}else g=function(e,t){const n=[],i=e.text;let r=0;for(const o of t)n.push(e.substring(r,o)),r=o;return r<i.length&&n.push(e.substring(r,i.length)),n}(m,y);const x=[],_={positionedLines:x,text:m.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:d,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,n,i,r,o,s,a,l,c,u,d){let h=0,p=0,f=0;const m="right"===a?1:"left"===a?0:.5;let g=!1;for(const w of r){const e=w.getSections();for(const n of e){if(n.imageName)continue;const e=t[n.fontStack];if(e&&(g=void 0!==e.ascender&&void 0!==e.descender,!g))break}if(!g)break}let y=0;for(const w of r){w.trim();const r=w.getMaxScale(),s=(r-1)*Nd,a={positionedGlyphs:[],lineOffset:0};e.positionedLines[y]=a;const b=a.positionedGlyphs;let x=0;if(!w.length()){p+=o,++y;continue}let _=0,k=0;for(let o=0;o<w.length();o++){const s=w.getSection(o),a=w.getSectionIndex(o),f=w.getCharCode(o);let m=s.scale,y=null,E=null,S=null,T=Nd,C=0;const M=!(l===Th.horizontal||!u&&!ro(f)||u&&(Ph[f]||(v=f,eo.Arabic(v)||eo["Arabic Supplement"](v)||eo["Arabic Extended-A"](v)||eo["Arabic Presentation Forms-A"](v)||eo["Arabic Presentation Forms-B"](v))));if(s.imageName){const t=i[s.imageName];if(!t)continue;S=s.imageName,e.iconsInText=e.iconsInText||!0,E=t.paddedRect;const n=t.displaySize;m=m*Nd/d,y={width:n[0],height:n[1],left:kh,top:-_h,advance:M?n[1]:n[0],localGlyph:!1},C=g?-y.height*m:Ch+r*Nd-n[1]*m,T=y.advance;const o=(M?n[0]:n[1])*m-Nd*r;o>0&&o>x&&(x=o)}else{const e=n[s.fontStack];if(!e)continue;e[f]&&(E=e[f]);const i=t[s.fontStack];if(!i)continue;const o=i.glyphs[f];if(!o)continue;if(y=o.metrics,T=8203!==f?Nd:0,g){const e=void 0!==i.ascender?Math.abs(i.ascender):0,t=void 0!==i.descender?Math.abs(i.descender):0,n=(e+t)*m;_<n&&(_=n,k=(e-t)/2*m),C=-e*m}else C=Ch+(r-m)*Nd}M?(e.verticalizable=!0,b.push({glyph:f,imageName:S,x:h,y:p+C,vertical:M,scale:m,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:E}),h+=T*m+c):(b.push({glyph:f,imageName:S,x:h,y:p+C,vertical:M,scale:m,localGlyph:y.localGlyph,fontStack:s.fontStack,sectionIndex:a,metrics:y,rect:E}),h+=y.advance*m+c)}0!==b.length&&(f=Math.max(h-c,f),g?Fh(b,m,x,k,o*r/2):Fh(b,m,x,0,o/2)),h=0;const E=o*r+x;a.lineOffset=Math.max(x,s),p+=E,++y}var v;const b=p,{horizontalAlign:x,verticalAlign:_}=Nh(s);(function(e,t,n,i,r,o){const s=(t-n)*r,a=-o*i;for(const l of e)for(const e of l.positionedGlyphs)e.x+=s,e.y+=a})(e.positionedLines,m,x,_,f,b),e.top+=-_*b,e.bottom=e.top+b,e.left+=-x*f,e.right=e.left+f,e.hasBaseline=g}(_,t,n,i,g,s,a,l,d,c,h,f),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(x)&&_}const Ph={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Oh={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Dh(e,t,n,i,r,o){if(t.imageName){const e=i[t.imageName];return e?e.displaySize[0]*t.scale*Nd/o+r:0}{const i=n[t.fontStack],o=i&&i.glyphs[e];return o?o.metrics.advance*t.scale+r:0}}function Rh(e,t,n,i){const r=Math.pow(e-t,2);return i?e<t?r/2:2*r:r+Math.abs(n)*n}function zh(e,t,n){let i=0;return 10===e&&(i-=1e4),n&&(i+=150),40!==e&&65288!==e||(i+=50),41!==t&&65289!==t||(i+=50),i}function Lh(e,t,n,i,r,o){let s=null,a=Rh(t,n,r,o);for(const l of i){const e=Rh(t-l.x,n,r,o)+l.badness;e<=a&&(s=l,a=e)}return{index:e,x:t,priorBreak:s,badness:a}}function Bh(e){return e?Bh(e.priorBreak).concat(e.index):[]}function Nh(e){let t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Fh(e,t,n,i,r){if(!(t||n||i||r))return;const o=e.length-1,s=e[o],a=(s.x+s.metrics.advance*s.scale)*t;for(let l=0;l<=o;l++)e[l].x-=a,e[l].y+=n+i+r}function $h(e,t,n){const{horizontalAlign:i,verticalAlign:r}=Nh(n),o=t[0]-e.displaySize[0]*i,s=t[1]-e.displaySize[1]*r;return{image:e,top:s,bottom:s+e.displaySize[1],left:o,right:o+e.displaySize[0]}}function jh(e,t,n,i,r,o){const s=e.image;let a;if(s.content){const e=s.content,t=s.pixelRatio||1;a=[e[0]/t,e[1]/t,s.displaySize[0]-e[2]/t,s.displaySize[1]-e[3]/t]}const l=t.left*o,c=t.right*o;let u,d,h,p;"width"===n||"both"===n?(p=r[0]+l-i[3],d=r[0]+c+i[1]):(p=r[0]+(l+c-s.displaySize[0])/2,d=p+s.displaySize[0]);const f=t.top*o,m=t.bottom*o;return"height"===n||"both"===n?(u=r[1]+f-i[0],h=r[1]+m+i[2]):(u=r[1]+(f+m-s.displaySize[1])/2,h=u+s.displaySize[1]),{image:s,top:u,right:d,bottom:h,left:p,collisionPadding:a}}class Vh extends v{constructor(e,t,n,i,r){super(e,t),this.angle=i,this.z=n,void 0!==r&&(this.segment=r)}clone(){return new Vh(this.x,this.y,this.z,this.angle,this.segment)}}function Uh(e,t,n,i,r){if(void 0===t.segment)return!0;let o=t,s=t.segment+1,a=0;for(;a>-n/2;){if(s--,s<0)return!1;a-=e[s].dist(o),o=e[s]}a+=e[s].dist(e[s+1]),s++;const l=[];let c=0;for(;a<n/2;){const t=e[s],n=e[s+1];if(!n)return!1;let o=e[s-1].angleTo(t)-t.angleTo(n);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:a,angleDelta:o}),c+=o;a-l[0].distance>i;)c-=l.shift().angleDelta;if(c>r)return!1;s++,a+=t.dist(n)}return!0}function qh(e){let t=0;for(let n=0;n<e.length-1;n++)t+=e[n].dist(e[n+1]);return t}function Gh(e,t,n){return e?.6*t*n:0}function Wh(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Hh(e,t,n,i,r,o){const s=Gh(n,r,o),a=Wh(n,i)*o;let l=0;const c=qh(e)/2;for(let u=0;u<e.length-1;u++){const n=e[u],i=e[u+1],r=n.dist(i);if(l+r>c){const o=(c-l)/r,d=On(n.x,i.x,o),h=On(n.y,i.y,o),p=new Vh(d,h,0,i.angleTo(n),u);return!s||Uh(e,p,a,s,t)?p:void 0}l+=r}}function Zh(e,t,n,i,r,o,s,a,l){const c=Gh(i,o,s),u=Wh(i,r),d=u*s,h=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-d<t/4&&(t=d+t/4),Xh(e,h?t/2*a%t:(u/2+2*o)*s*a%t,t,c,n,d,h,!1,l)}function Xh(e,t,n,i,r,o,s,a,l){const c=o/2,u=qh(e);let d=0,h=t-n,p=[];for(let f=0;f<e.length-1;f++){const t=e[f],s=e[f+1],a=t.dist(s),m=s.angleTo(t);for(;h+n<d+a;){h+=n;const g=(h-d)/a,y=On(t.x,s.x,g),v=On(t.y,s.y,g);if(y>=0&&y<l&&v>=0&&v<l&&h-c>=0&&h+c<=u){const t=new Vh(y,v,0,m,f);t._round(),i&&!Uh(e,t,o,i,r)||p.push(t)}}d+=a}return a||p.length||s||(p=Xh(e,d/2,n,i,r,o,s,!0,l)),p}function Kh(e,t,n,i,r){const o=[];for(let s=0;s<e.length;s++){const a=e[s];let l;for(let e=0;e<a.length-1;e++){let s=a[e],c=a[e+1];s.x<t&&c.x<t||(s.x<t?s=new v(t,s.y+(t-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x<t&&(c=new v(t,s.y+(t-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y<n&&c.y<n||(s.y<n?s=new v(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round():c.y<n&&(c=new v(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round()),s.x>=i&&c.x>=i||(s.x>=i?s=new v(i,s.y+(i-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x>=i&&(c=new v(i,s.y+(i-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y>=r&&c.y>=r||(s.y>=r?s=new v(s.x+(r-s.y)/(c.y-s.y)*(c.x-s.x),r)._round():c.y>=r&&(c=new v(s.x+(r-s.y)/(c.y-s.y)*(c.x-s.x),r)._round()),l&&s.equals(l[l.length-1])||(l=[s],o.push(l)),l.push(c)))))}}return o}Xr(Vh,"Anchor");const Jh=1e20;function Yh(e,t,n,i,r,o,s,a,l){for(let c=t;c<t+i;c++)Qh(e,n*o+c,o,r,s,a,l);for(let c=n;c<n+r;c++)Qh(e,c*o+t,1,i,s,a,l)}function Qh(e,t,n,i,r,o,s){o[0]=0,s[0]=-Jh,s[1]=Jh,r[0]=e[t];for(let a=1,l=0,c=0;a<i;a++){r[a]=e[t+a*n];const i=a*a;do{const e=o[l];c=(r[a]-r[e]+i-e*e)/(a-e)/2}while(c<=s[l]&&--l>-1);l++,o[l]=a,s[l]=c,s[l+1]=Jh}for(let a=0,l=0;a<i;a++){for(;s[l+1]<a;)l++;const i=o[l],c=a-i;e[t+a*n]=r[i]+c*c}}const ep=2,tp={none:0,ideographs:1,all:2};class np{constructor(e,t,n){this.requestManager=e,this.localGlyphMode=t,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,t){const n=[];for(const i in e)for(const t of e[i])n.push({stack:i,id:t});A(n,(({stack:e,id:t},n)=>{let i=this.entries[e];i||(i=this.entries[e]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let r=i.glyphs[t];if(void 0!==r)return void n(null,{stack:e,id:t,glyph:r});if(r=this._tinySDF(i,e,t),r)return i.glyphs[t]=r,void n(null,{stack:e,id:t,glyph:r});const o=Math.floor(t/256);if(256*o>65535)return void n(new Error("glyphs > 65535 not supported"));if(i.ranges[o])return void n(null,{stack:e,id:t,glyph:r});let s=i.requests[o];s||(s=i.requests[o]=[],np.loadGlyphRange(e,o,this.url,this.requestManager,((e,t)=>{if(t){i.ascender=t.ascender,i.descender=t.descender;for(const e in t.glyphs)this._doesCharSupportLocalGlyph(+e)||(i.glyphs[+e]=t.glyphs[+e]);i.ranges[o]=!0}for(const n of s)n(e,t);delete i.requests[o]}))),s.push(((i,r)=>{i?n(i):r&&n(null,{stack:e,id:t,glyph:r.glyphs[t]||null})}))}),((e,n)=>{if(e)t(e);else if(n){const e={};for(const{stack:t,id:i,glyph:r}of n)void 0===e[t]&&(e[t]={}),void 0===e[t].glyphs&&(e[t].glyphs={}),e[t].glyphs[i]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics},e[t].ascender=this.entries[t].ascender,e[t].descender=this.entries[t].descender;t(null,e)}}))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==tp.none&&(this.localGlyphMode===tp.all?!!this.localFontFamily:!!this.localFontFamily&&(eo["CJK Unified Ideographs"](e)||eo["Hangul Syllables"](e)||eo.Hiragana(e)||eo.Katakana(e)||eo["CJK Symbols and Punctuation"](e)))}_tinySDF(e,t,n){const i=this.localFontFamily;if(!i||!this._doesCharSupportLocalGlyph(n))return;let r=e.tinySDF;if(!r){let n="400";/bold/i.test(t)?n="900":/medium/i.test(t)?n="500":/light/i.test(t)&&(n="200"),r=e.tinySDF=new np.TinySDF({fontFamily:i,fontWeight:n,fontSize:24*ep,buffer:3*ep,radius:8*ep}),r.fontWeight=n}if(this.localGlyphs[r.fontWeight][n])return this.localGlyphs[r.fontWeight][n];const o=String.fromCharCode(n),{data:s,width:a,height:l,glyphWidth:c,glyphHeight:u,glyphLeft:d,glyphTop:h,glyphAdvance:p}=r.draw(o);return this.localGlyphs[r.fontWeight][n]={id:n,bitmap:new Nc({width:a,height:l},s),metrics:{width:c/ep,height:u/ep,left:d/ep,top:h/ep-27,advance:p/ep,localGlyph:!0}}}}np.loadGlyphRange=function(e,t,n,i,r){const o=256*t,s=o+255,a=i.transformRequest(i.normalizeGlyphsURL(n).replace("{fontstack}",e).replace("{range}",`${o}-${s}`),le.Glyphs);he(a,((e,t)=>{if(e)r(e);else if(t){const e={},n=function(e){return new gh(e).readFields(vh,{})}(t);for(const t of n.glyphs)e[t.id]=t;r(null,{glyphs:e,ascender:n.ascender,descender:n.descender})}}))},np.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=t,this.cutoff=i,this.radius=n;const a=this.size=e+4*t,l=this._createCanvas(a),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${o} ${e}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:o}=this.ctx.measureText(e),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-r))),l=Math.min(this.size-this.buffer,s+Math.ceil(i)),c=a+2*this.buffer,u=l+2*this.buffer,d=Math.max(c*u,0),h=new Uint8ClampedArray(d),p={data:h,width:c,height:u,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:t};if(0===a||0===l)return p;const{ctx:f,buffer:m,gridInner:g,gridOuter:y}=this;f.clearRect(m,m,a,l),f.fillText(e,m,m+s);const v=f.getImageData(m,m,a,l);y.fill(Jh,0,d),g.fill(0,0,d);for(let b=0;b<l;b++)for(let e=0;e<a;e++){const t=v.data[4*(b*a+e)+3]/255;if(0===t)continue;const n=(b+m)*c+e+m;if(1===t)y[n]=0,g[n]=Jh;else{const e=.5-t;y[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}Yh(y,0,0,c,u,c,this.f,this.v,this.z),Yh(g,m,m,a,l,c,this.f,this.v,this.z);for(let b=0;b<d;b++){const e=Math.sqrt(y[b])-Math.sqrt(g[b]);h[b]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};const ip=kh;function rp(e,t,n,i){const r=[],o=e.image,s=o.pixelRatio,a=o.paddedRect.w-2*ip,l=o.paddedRect.h-2*ip,c=e.right-e.left,u=e.bottom-e.top,d=o.stretchX||[[0,a]],h=o.stretchY||[[0,l]],p=(e,t)=>e+t[1]-t[0],f=d.reduce(p,0),m=h.reduce(p,0),g=a-f,y=l-m;let b=0,x=f,_=0,w=m,k=0,E=g,S=0,T=y;if(o.content&&i){const e=o.content;b=op(d,0,e[0]),_=op(h,0,e[1]),x=op(d,e[0],e[2]),w=op(h,e[1],e[3]),k=e[0]-b,S=e[1]-_,E=e[2]-e[0]-x,T=e[3]-e[1]-w}const C=(i,r,a,l)=>{const d=ap(i.stretch-b,x,c,e.left),h=lp(i.fixed-k,E,i.stretch,f),p=ap(r.stretch-_,w,u,e.top),g=lp(r.fixed-S,T,r.stretch,m),y=ap(a.stretch-b,x,c,e.left),C=lp(a.fixed-k,E,a.stretch,f),M=ap(l.stretch-_,w,u,e.top),I=lp(l.fixed-S,T,l.stretch,m),A=new v(d,p),P=new v(y,p),O=new v(y,M),D=new v(d,M),R=new v(h/s,g/s),z=new v(C/s,I/s),L=t*Math.PI/180;if(L){const e=Math.sin(L),t=Math.cos(L),n=[t,-e,e,t];A._matMult(n),P._matMult(n),D._matMult(n),O._matMult(n)}const B=i.stretch+i.fixed,N=r.stretch+r.fixed;return{tl:A,tr:P,bl:D,br:O,tex:{x:o.paddedRect.x+ip+B,y:o.paddedRect.y+ip+N,w:a.stretch+a.fixed-B,h:l.stretch+l.fixed-N},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:z,minFontScaleX:E/s/c,minFontScaleY:T/s/u,isSDF:n}};if(i&&(o.stretchX||o.stretchY)){const e=sp(d,g,f),t=sp(h,y,m);for(let n=0;n<e.length-1;n++){const i=e[n],o=e[n+1];for(let e=0;e<t.length-1;e++)r.push(C(i,t[e],o,t[e+1]))}}else r.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:a+1},{fixed:0,stretch:l+1}));return r}function op(e,t,n){let i=0;for(const r of e)i+=Math.max(t,Math.min(n,r[1]))-Math.max(t,Math.min(n,r[0]));return i}function sp(e,t,n){const i=[{fixed:-ip,stretch:0}];for(const[r,o]of e){const e=i[i.length-1];i.push({fixed:r-e.stretch,stretch:e.stretch}),i.push({fixed:r-e.stretch,stretch:e.stretch+(o-r)})}return i.push({fixed:t+ip,stretch:n}),i}function ap(e,t,n,i){return e/t*n+i}function lp(e,t,n,i){return e-t*n/i}function cp(e,t,n,i){const r=t+e.positionedLines[i].lineOffset;return 0===i?n+r/2:n+(r+(t+e.positionedLines[i-1].lineOffset))/2}class up{constructor(e=[],t=dp){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,i=t[e];for(;e>0;){const r=e-1>>1,o=t[r];if(n(i,o)>=0)break;t[e]=o,e=r}t[e]=i}_down(e){const{data:t,compare:n}=this,i=this.length>>1,r=t[e];for(;e<i;){let i=1+(e<<1),o=t[i];const s=i+1;if(s<this.length&&n(t[s],o)<0&&(i=s,o=t[s]),n(o,r)>=0)break;t[e]=o,e=i}t[e]=r}}function dp(e,t){return e<t?-1:e>t?1:0}function hp(e,t=1,n=!1){let i=1/0,r=1/0,o=-1/0,s=-1/0;const a=e[0];for(let p=0;p<a.length;p++){const e=a[p];(!p||e.x<i)&&(i=e.x),(!p||e.y<r)&&(r=e.y),(!p||e.x>o)&&(o=e.x),(!p||e.y>s)&&(s=e.y)}const l=Math.min(o-i,s-r);let c=l/2;const u=new up([],pp);if(0===l)return new v(i,r);for(let p=i;p<o;p+=l)for(let t=r;t<s;t+=l)u.push(new fp(p+c,t+c,c,e));let d=function(e){let t=0,n=0,i=0;const r=e[0];for(let o=0,s=r.length,a=s-1;o<s;a=o++){const e=r[o],s=r[a],l=e.x*s.y-s.x*e.y;n+=(e.x+s.x)*l,i+=(e.y+s.y)*l,t+=3*l}return new fp(n/t,i/t,0,e)}(e),h=u.length;for(;u.length;){const i=u.pop();(i.d>d.d||!d.d)&&(d=i,n&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,h)),i.max-d.d<=t||(c=i.h/2,u.push(new fp(i.p.x-c,i.p.y-c,c,e)),u.push(new fp(i.p.x+c,i.p.y-c,c,e)),u.push(new fp(i.p.x-c,i.p.y+c,c,e)),u.push(new fp(i.p.x+c,i.p.y+c,c,e)),h+=4)}return n&&(console.log(`num probes: ${h}`),console.log(`best distance: ${d.d}`)),d.p}function pp(e,t){return t.max-e.max}class fp{constructor(e,t,n,i){this.p=new v(e,t),this.h=n,this.d=function(e,t){let n=!1,i=1/0;for(let r=0;r<t.length;r++){const o=t[r];for(let t=0,r=o.length,s=r-1;t<r;s=t++){const r=o[t],a=o[s];r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(n=!n),i=Math.min(i,vc(e,r,a))}}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}}const mp=7,gp=Number.POSITIVE_INFINITY,yp=Math.sqrt(2);function vp(e,[t,n]){let i=0,r=0;if(n===gp){t<0&&(t=0);const n=t/yp;switch(e){case"top-right":case"top-left":r=n-mp;break;case"bottom-right":case"bottom-left":r=-n+mp;break;case"bottom":r=-t+mp;break;case"top":r=t-mp}switch(e){case"top-right":case"bottom-right":i=-n;break;case"top-left":case"bottom-left":i=n;break;case"left":i=t;break;case"right":i=-t}}else{switch(t=Math.abs(t),n=Math.abs(n),e){case"top-right":case"top-left":case"top":r=n-mp;break;case"bottom-right":case"bottom-left":case"bottom":r=-n+mp}switch(e){case"top-right":case"bottom-right":case"right":i=-t;break;case"top-left":case"bottom-left":case"left":i=t}}return[i,r]}function bp(e,t,n,i,r,o,s,a,l,c){e.createArrays(),e.tilePixelRatio=aa/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const u=e.layers[0].layout,d=e.layers[0]._unevaluatedLayout._values,h={};if("composite"===e.textSizeData.kind){const{minZoom:t,maxZoom:n}=e.textSizeData;h.compositeTextSizes=[d["text-size"].possiblyEvaluate(new wo(t),a),d["text-size"].possiblyEvaluate(new wo(n),a)]}if("composite"===e.iconSizeData.kind){const{minZoom:t,maxZoom:n}=e.iconSizeData;h.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new wo(t),a),d["icon-size"].possiblyEvaluate(new wo(n),a)]}h.layoutTextSize=d["text-size"].possiblyEvaluate(new wo(l+1),a),h.layoutIconSize=d["icon-size"].possiblyEvaluate(new wo(l+1),a),h.textMaxSize=d["text-size"].possiblyEvaluate(new wo(18),a);const p="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),f=u.get("text-size");for(const m of e.features){const o=u.get("text-font").evaluate(m,{},a).join(","),l=f.evaluate(m,{},a),d=h.layoutTextSize.evaluate(m,{},a),g=(h.layoutIconSize.evaluate(m,{},a),{horizontal:{},vertical:void 0}),y=m.text;let v,b=[0,0];if(y){const i=y.toString(),s=u.get("text-letter-spacing").evaluate(m,{},a)*Nd,c=u.get("text-line-height").evaluate(m,{},a)*Nd,h=no(i)?s:0,f=u.get("text-anchor").evaluate(m,{},a),v=u.get("text-variable-anchor");if(!v){const e=u.get("text-radial-offset").evaluate(m,{},a);b=e?vp(f,[e*Nd,gp]):u.get("text-offset").evaluate(m,{},a).map((e=>e*Nd))}let x=p?"center":u.get("text-justify").evaluate(m,{},a);const _="point"===u.get("symbol-placement"),w=_?u.get("text-max-width").evaluate(m,{},a)*Nd:1/0,k=s=>{e.allowVerticalPlacement&&to(i)&&(g.vertical=Ah(y,t,n,r,o,w,c,f,s,h,b,Th.vertical,!0,d,l))};if(!p&&v){const e="auto"===x?v.map((e=>xp(e))):[x];let i=!1;for(let s=0;s<e.length;s++){const a=e[s];if(!g.horizontal[a])if(i)g.horizontal[a]=g.horizontal[0];else{const e=Ah(y,t,n,r,o,w,c,"center",a,h,b,Th.horizontal,!1,d,l);e&&(g.horizontal[a]=e,i=1===e.positionedLines.length)}}k("left")}else{if("auto"===x&&(x=xp(f)),_||u.get("text-writing-mode").indexOf("horizontal")>=0||!to(i)){const e=Ah(y,t,n,r,o,w,c,f,x,h,b,Th.horizontal,!1,d,l);e&&(g.horizontal[x]=e)}k(_?"left":x)}}let x=!1;if(m.icon&&m.icon.name){const t=i[m.icon.name];t&&(v=$h(r[m.icon.name],u.get("icon-offset").evaluate(m,{},a),u.get("icon-anchor").evaluate(m,{},a)),x=t.sdf,void 0===e.sdfIcons?e.sdfIcons=t.sdf:e.sdfIcons!==t.sdf&&q("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.pixelRatio||0!==u.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const _=Sp(g.horizontal)||g.vertical;e.iconsInText||(e.iconsInText=!!_&&_.iconsInText),(_||v)&&_p(e,m,g,v,i,h,d,0,b,x,s,a,c)}o&&e.generateCollisionDebugBuffers(l,e.collisionBoxArray)}function xp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _p(e,t,n,i,r,o,s,a,l,c,u,d,h){let p=o.textMaxSize.evaluate(t,{},d);void 0===p&&(p=s);const f=e.layers[0].layout,m=f.get("icon-offset").evaluate(t,{},d),g=Sp(n.horizontal)||n.vertical,y="globe"===h.name,v=Nd,b=s/v,x=e.tilePixelRatio*p/v,w=(A=e.overscaling,e.zoom>18&&A>2&&(A>>=1),Math.max(aa/(512*A),1)*f.get("symbol-spacing")),k=f.get("text-padding")*e.tilePixelRatio,E=f.get("icon-padding")*e.tilePixelRatio,S=_(f.get("text-max-angle")),T="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),C="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),M=f.get("symbol-placement"),I=w/2;var A;const P=f.get("icon-text-fit");let O;i&&"none"!==P&&(e.allowVerticalPlacement&&n.vertical&&(O=jh(i,n.vertical,P,f.get("icon-text-fit-padding"),m,b)),g&&(i=jh(i,g,P,f.get("icon-text-fit-padding"),m,b)));const D=(s,a,p)=>{if(a.x<0||a.x>=aa||a.y<0||a.y>=aa)return;let f=null;if(y){const{x:e,y:t,z:n}=h.projectTilePoint(a.x,a.y,p);f={anchor:new Vh(e,t,n,0,void 0),up:h.upVector(p,a.x,a.y)}}!function(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b,x,_,w,k,E){const S=e.addToLineVertexArray(t,i);let T,C,M,I,A,P,O,D=0,R=0,z=0,L=0,B=-1,N=-1;const F={};let $=Ps("");const j=n?n.anchor:t;let V=0,U=0;if(void 0===l._unevaluatedLayout.getValue("text-radial-offset")?[V,U]=l.layout.get("text-offset").evaluate(x,{},E).map((e=>e*Nd)):(V=l.layout.get("text-radial-offset").evaluate(x,{},E)*Nd,U=gp),e.allowVerticalPlacement&&r.vertical){const e=r.vertical;if(f)P=Cp(e),a&&(O=Cp(a));else{const n=l.layout.get("text-rotate").evaluate(x,{},E)+90;M=Tp(c,j,t,u,d,h,e,p,n,m),a&&(I=Tp(c,j,t,u,d,h,a,y,n))}}if(o){const i=l.layout.get("icon-rotate").evaluate(x,{},E),r="none"!==l.layout.get("icon-text-fit"),s=rp(o,i,w,r),p=a?rp(a,i,w,r):void 0;C=Tp(c,j,t,u,d,h,o,y,i),D=4*s.length;const f=e.iconSizeData;let m=null;"source"===f.kind?(m=[Fd*l.layout.get("icon-size").evaluate(x,{},E)],m[0]>kp&&q(`${e.layerIds[0]}: Value for "icon-size" is >= ${wp}. Reduce your "icon-size".`)):"composite"===f.kind&&(m=[Fd*_.compositeIconSizes[0].evaluate(x,{},E),Fd*_.compositeIconSizes[1].evaluate(x,{},E)],(m[0]>kp||m[1]>kp)&&q(`${e.layerIds[0]}: Value for "icon-size" is >= ${wp}. Reduce your "icon-size".`)),e.addSymbols(e.icon,s,m,b,v,x,!1,n,t,S.lineStartIndex,S.lineLength,-1,k,E),B=e.icon.placedSymbolArray.length-1,p&&(R=4*p.length,e.addSymbols(e.icon,p,m,b,v,x,Th.vertical,n,t,S.lineStartIndex,S.lineLength,-1,k,E),N=e.icon.placedSymbolArray.length-1)}for(const q in r.horizontal){const i=r.horizontal[q];T||($=Ps(i.text),f?A=Cp(i):T=Tp(c,j,t,u,d,h,i,p,l.layout.get("text-rotate").evaluate(x,{},E),m));const o=1===i.positionedLines.length;if(z+=Ep(e,n,t,i,s,l,f,x,m,S,r.vertical?Th.horizontal:Th.horizontalOnly,o?Object.keys(r.horizontal):[q],F,B,_,k,E),o)break}r.vertical&&(L+=Ep(e,n,t,r.vertical,s,l,f,x,m,S,Th.vertical,["vertical"],F,N,_,k,E));let G=-1;const W=(e,t)=>e?Math.max(e,t):t;G=W(A,G),G=W(P,G),G=W(O,G);const H=G>-1?1:0;e.glyphOffsetArray.length>=af.MAX_GLYPHS&&q("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey),e.symbolInstances.emplaceBack(j.x,j.y,j.z,t.x,t.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical>=0?F.vertical:-1,B,N,$,void 0!==T?T:e.collisionBoxArray.length,void 0!==T?T+1:e.collisionBoxArray.length,void 0!==M?M:e.collisionBoxArray.length,void 0!==M?M+1:e.collisionBoxArray.length,void 0!==C?C:e.collisionBoxArray.length,void 0!==C?C+1:e.collisionBoxArray.length,I||e.collisionBoxArray.length,I?I+1:e.collisionBoxArray.length,u,z,L,D,R,H,0,V,U,G)}(e,a,f,s,n,i,r,O,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,k,T,l,0,E,C,m,t,o,c,u,d)};if("line"===M)for(const _ of Kh(t.geometry,0,0,aa,aa)){const t=Zh(_,w,S,n.vertical||g,i,v,x,e.overscaling,aa);for(const n of t)g&&Mp(e,g.text,I,n)||D(_,n,d)}else if("line-center"===M){for(const _ of t.geometry)if(_.length>1){const e=Hh(_,S,n.vertical||g,i,v,x);e&&D(_,e,d)}}else if("Polygon"===t.type)for(const _ of ku(t.geometry,0)){const e=hp(_,16);D(_[0],new Vh(e.x,e.y,0,0,void 0),d)}else if("LineString"===t.type)for(const _ of t.geometry)D(_,new Vh(_[0].x,_[0].y,0,0,void 0),d);else if("Point"===t.type)for(const _ of t.geometry)for(const e of _)D([e],new Vh(e.x,e.y,0,0,void 0),d)}const wp=255,kp=wp*Fd;function Ep(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g){const y=function(e,t,n,i,r,o,s,a){const l=[];if(0===t.positionedLines.length)return l;const c=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=function(e){const t=e[0],n=e[1],i=t*n;return i>0?[t,-n]:i<0?[-t,n]:0===t?[n,t]:[n,-t]}(n);let d=Math.abs(t.top-t.bottom);for(const m of t.positionedLines)d-=m.lineOffset;const h=t.positionedLines.length,p=d/h;let f=t.top-n[1];for(let m=0;m<h;++m){const e=t.positionedLines[m];f=cp(t,p,f,m);for(const i of e.positionedGlyphs){if(!i.rect)continue;const e=i.rect||{};let o=_h+1,d=!0,h=1,p=0;if(i.imageName){const e=s[i.imageName];if(!e)continue;if(e.sdf){q("SDF images are not supported in formatted text and will be ignored.");continue}d=!1,h=e.pixelRatio,o=kh/h}const m=(r||a)&&i.vertical,g=i.metrics.advance*i.scale/2,y=i.metrics,b=i.rect;if(null===b)continue;a&&t.verticalizable&&(p=i.imageName?g-i.metrics.width*i.scale/2:0);const x=r?[i.x+g,i.y]:[0,0];let _=[0,0],w=[0,0],k=!1;r||(m?(w=[i.x+g+u[0],i.y+u[1]-p],k=!0):_=[i.x+g+n[0],i.y+n[1]-p]);const E=b.w*i.scale/(h*(i.localGlyph?ep:1)),S=b.h*i.scale/(h*(i.localGlyph?ep:1));let T,C,M,I;if(m){const e=i.y-f,t=new v(-g,g-e),n=-Math.PI/2,r=new v(...w);T=new v(-g+_[0],_[1]),T._rotateAround(n,t)._add(r),T.x+=-e+g,T.y-=(y.left-o)*i.scale;const s=i.imageName?y.advance*i.scale:Nd*i.scale,a=String.fromCharCode(i.glyph);Wd(a)?T.x+=(1-o)*i.scale:Hd(a)?T.x+=s-y.height*i.scale+(-o-1)*i.scale:T.x+=i.imageName||y.width+2*o===b.w&&y.height+2*o===b.h?(s-S)/2:(s-(y.height+2*o)*i.scale)/2,C=new v(T.x,T.y-E),M=new v(T.x+S,T.y),I=new v(T.x+S,T.y-E)}else{const e=(y.left-o)*i.scale-g+_[0],t=(-y.top-o)*i.scale+_[1],n=e+E,r=t+S;T=new v(e,t),C=new v(n,t),M=new v(e,r),I=new v(n,r)}if(c){let e;e=r?new v(0,0):k?new v(u[0],u[1]):new v(n[0],n[1]),T._rotateAround(c,e),C._rotateAround(c,e),M._rotateAround(c,e),I._rotateAround(c,e)}const A=new v(0,0),P=new v(0,0);l.push({tl:T,tr:C,bl:M,br:I,tex:e,writingMode:t.writingMode,glyphOffset:x,sectionIndex:i.sectionIndex,isSDF:d,pixelOffsetTL:A,pixelOffsetBR:P,minFontScaleX:0,minFontScaleY:0})}}return l}(0,i,l,o,s,a,r,e.allowVerticalPlacement),b=e.textSizeData;let x=null;"source"===b.kind?(x=[Fd*o.layout.get("text-size").evaluate(a,{},g)],x[0]>kp&&q(`${e.layerIds[0]}: Value for "text-size" is >= ${wp}. Reduce your "text-size".`)):"composite"===b.kind&&(x=[Fd*f.compositeTextSizes[0].evaluate(a,{},g),Fd*f.compositeTextSizes[1].evaluate(a,{},g)],(x[0]>kp||x[1]>kp)&&q(`${e.layerIds[0]}: Value for "text-size" is >= ${wp}. Reduce your "text-size".`)),e.addSymbols(e.text,y,x,l,s,a,u,t,n,c.lineStartIndex,c.lineLength,p,m,g);for(const v of d)h[v]=e.text.placedSymbolArray.length-1;return 4*y.length}function Sp(e){for(const t in e)return e[t];return null}function Tp(e,t,n,i,r,o,s,a,l,c){let u=s.top,d=s.bottom,h=s.left,p=s.right;const f=s.collisionPadding;if(f&&(h-=f[0],u-=f[1],p+=f[2],d+=f[3]),l){const e=new v(h,u),t=new v(p,u),n=new v(h,d),i=new v(p,d),r=_(l);let o=new v(0,0);c&&(o=new v(c[0],c[1])),e._rotateAround(r,o),t._rotateAround(r,o),n._rotateAround(r,o),i._rotateAround(r,o),h=Math.min(e.x,t.x,n.x,i.x),p=Math.max(e.x,t.x,n.x,i.x),u=Math.min(e.y,t.y,n.y,i.y),d=Math.max(e.y,t.y,n.y,i.y)}return e.emplaceBack(t.x,t.y,t.z,n.x,n.y,h,u,p,d,a,i,r,o),e.length-1}function Cp(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function Mp(e,t,n,i){const r=e.compareText;if(t in r){const e=r[t];for(let t=e.length-1;t>=0;t--)if(i.dist(e[t])<n)return!0}else r[t]=[];return r[t].push(i),!1}function Ip(e,t){const n=e.fovAboveCenter,i=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,r=(e._camera.position[2]*e.worldSize-i)/Math.cos(e._pitch),o=Math.sin(n)*r/Math.sin(Math.max(Math.PI/2-e._pitch-n,.01)),s=Math.sin(e._pitch)*o+r;return Math.min(1.01*s,r*(1/e._horizonShift))}function Ap(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const n=Math.pow(2,-e.z),i=e.x*n,r=(e.x+1)*n,o=e.y*n,s=(e.y+1)*n,a=Hl(i),l=Hl(r),c=Zl(o),u=Zl(s),d=t.project(a,c),h=t.project(l,c),p=t.project(l,u),f=t.project(a,u);let m=Math.min(d.x,h.x,p.x,f.x),g=Math.min(d.y,h.y,p.y,f.y),y=Math.max(d.x,h.x,p.x,f.x),v=Math.max(d.y,h.y,p.y,f.y);const b=n/16;function x(e,n,i,r,o,s){const a=(i+o)/2,l=(r+s)/2,c=t.project(Hl(a),Zl(l)),u=Math.max(0,m-c.x,g-c.y,c.x-y,c.y-v);m=Math.min(m,c.x),y=Math.max(y,c.x),g=Math.min(g,c.y),v=Math.max(v,c.y),u>b&&(x(e,c,i,r,a,l),x(c,n,a,l,o,s))}x(d,h,i,o,r,o),x(h,p,r,o,r,s),x(p,f,r,s,i,s),x(f,d,i,s,i,o),m-=b,g-=b,y+=b,v+=b;const _=1/Math.max(y-m,v-g);return{scale:_,x:m*_,y:g*_,x2:y*_,y2:v*_,projection:t}}const Pp=pa(new Float32Array(16));class Op{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,t){return{x:0,y:0,z:0}}unproject(e,t){return new Vl(0,0)}projectTilePoint(e,t,n){return{x:e,y:t,z:0}}locationPoint(e,t,n=!0){return e._coordinatePoint(e.locationCoordinate(t),n)}pixelsPerMeter(e,t){return Wl(1,e)*t}pixelSpaceConversion(e,t,n){return 1}farthestPixelDistance(e){return Ip(e,e.pixelsPerMeter)}pointCoordinate(e,t,n,i){const r=e.horizonLineFromTop(!1),o=new v(t,Math.max(r,n));return e.rayIntersectionCoordinate(e.pointRayIntersection(o,i))}pointCoordinate3D(e,t,n){const i=new v(t,n);if(e.elevation)return e.elevation.pointCoordinate(i);{const t=this.pointCoordinate(e,i.x,i.y,0);return[t.x,t.y,t.z]}}isPointAboveHorizon(e,t){if(e.elevation)return!this.pointCoordinate3D(e,t.x,t.y);const n=e.horizonLineFromTop();return t.y<n}createInversionMatrix(e,t){return Pp}createTileMatrix(e,t,n){let i,r,o;const s=n.canonical,a=pa(new Float64Array(16));if(this.isReprojectedInTileSpace){const l=Ap(s,this);i=1,r=l.x+n.wrap*l.scale,o=l.y,ya(a,a,[i/l.scale,i/l.scale,e.pixelsPerMeter/t])}else i=t/e.zoomScale(s.z),r=(s.x+Math.pow(2,s.z)*n.wrap)*i,o=s.y*i;return ga(a,a,[r,o,0]),ya(a,a,[i/aa,i/aa,1]),a}upVector(e,t,n){return[0,0,1]}upVectorScale(e,t,n){return{metersToTile:1}}}class Dp extends Op{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[t,n]=this.parallels=e.parallels||[29.5,45.5],i=Math.sin(_(t));this.n=(i+Math.sin(_(n)))/2,this.c=1+i*(2*this.n-i),this.r0=Math.sqrt(this.c)/this.n}project(e,t){const{n:n,c:i,r0:r}=this,o=_(e-this.center[0]),s=_(t),a=Math.sqrt(i-2*n*Math.sin(s))/n;return{x:a*Math.sin(o*n),y:a*Math.cos(o*n)-r,z:0}}unproject(e,t){const{n:n,c:i,r0:r}=this,o=r+t;let s=Math.atan2(e,Math.abs(o))*Math.sign(o);o*n<0&&(s-=Math.PI*Math.sign(e)*Math.sign(o));const a=_(this.center[0])*n;s=I(s,-Math.PI-a,Math.PI-a);const l=C(w(s/n)+this.center[0],-180,180),c=Math.asin(C((i-(e*e+o*o)*n*n)/(2*n),-1,1)),u=C(w(c),-Kl,Kl);return new Vl(l,u)}}const Rp=1.340264,zp=-.081106,Lp=893e-6,Bp=.003796,Np=Math.sqrt(3)/2;class Fp extends Op{project(e,t){t=t/180*Math.PI,e=e/180*Math.PI;const n=Math.asin(Np*Math.sin(t)),i=n*n,r=i*i*i;return{x:.5*(e*Math.cos(n)/(Np*(Rp+3*zp*i+r*(7*Lp+9*Bp*i)))/Math.PI+.5),y:1-.5*(n*(Rp+zp*i+r*(Lp+Bp*i))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let n=t=(2*(1-t)-1)*Math.PI,i=n*n,r=i*i*i;for(let c,u,d,h=0;h<12&&(u=n*(Rp+zp*i+r*(Lp+Bp*i))-t,d=Rp+3*zp*i+r*(7*Lp+9*Bp*i),c=u/d,n=C(n-c,-Math.PI/3,Math.PI/3),i=n*n,r=i*i*i,!(Math.abs(c)<1e-12));++h);const o=Np*e*(Rp+3*zp*i+r*(7*Lp+9*Bp*i))/Math.cos(n),s=Math.asin(Math.sin(n)/Np),a=C(180*o/Math.PI,-180,180),l=C(180*s/Math.PI,-Kl,Kl);return new Vl(a,l)}}class $p extends Op{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}unproject(e,t){const n=360*(e-.5),i=C(360*(.5-t),-Kl,Kl);return new Vl(n,i)}}const jp=Math.PI/2;function Vp(e){return Math.tan((jp+e)/2)}class Up extends Op{constructor(e){super(e),this.center=e.center||[0,30];const[t,n]=this.parallels=e.parallels||[30,30];let i=_(t),r=_(n);this.southernCenter=i+r<0,this.southernCenter&&(i=-i,r=-r);const o=Math.cos(i),s=Vp(i);this.n=i===r?Math.sin(i):Math.log(o/Math.cos(r))/Math.log(Vp(r)/s),this.f=o*Math.pow(Vp(i),this.n)/this.n}project(e,t){t=_(t),this.southernCenter&&(t=-t),e=_(e-this.center[0]);const n=1e-6,{n:i,f:r}=this;r>0?t<-jp+n&&(t=-jp+n):t>jp-n&&(t=jp-n);const o=r/Math.pow(Vp(t),i);let s=o*Math.sin(i*e),a=r-o*Math.cos(i*e);return s=.5*(s/Math.PI+.5),a=.5*(a/Math.PI+.5),{x:s,y:this.southernCenter?a:1-a,z:0}}unproject(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;const{n:n,f:i}=this,r=i-t,o=Math.sign(r),s=Math.sign(n)*Math.sqrt(e*e+r*r);let a=Math.atan2(e,Math.abs(r))*o;r*n<0&&(a-=Math.PI*Math.sign(e)*o);const l=C(w(a/n)+this.center[0],-180,180),c=C(w(2*Math.atan(Math.pow(i/s,1/n))-jp),-Kl,Kl);return new Vl(l,this.southernCenter?-c:c)}}class qp extends Op{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,t){return{x:ql(e),y:Gl(t),z:0}}unproject(e,t){const n=Hl(e),i=Zl(t);return new Vl(n,i)}}const Gp=_(Kl);class Wp extends Op{project(e,t){const n=(t=_(t))*t,i=n*n;return{x:.5*((e=_(e))*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let n=t=(2*(1-t)-1)*Math.PI,i=25,r=0,o=n*n;do{o=n*n;const e=o*o;r=(n*(1.007226+o*(.015085+e*(.028874*o-.044475-.005916*e)))-t)/(1.007226+o*(.045255+e*(.259866*o-.311325-.005916*11*e))),n=C(n-r,-Gp,Gp)}while(Math.abs(r)>1e-6&&--i>0);o=n*n;const s=C(w(e/(.8707+o*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979))),-180,180),a=w(n);return new Vl(s,a)}}const Hp=_(Kl);class Zp extends Op{project(e,t){t=_(t),e=_(e);const n=Math.cos(t),i=2/Math.PI,r=Math.acos(n*Math.cos(e/2)),o=Math.sin(r)/r,s=.5*(e*i+2*n*Math.sin(e/2)/o)||0,a=.5*(t+Math.sin(t)/o)||0;return{x:.5*(s/Math.PI+.5),y:1-.5*(a/Math.PI+1),z:0}}unproject(e,t){let n=e=(2*e-.5)*Math.PI,i=t=(2*(1-t)-1)*Math.PI,r=25;const o=1e-6;let s=0,a=0;do{const r=Math.cos(i),o=Math.sin(i),l=2*o*r,c=o*o,u=r*r,d=Math.cos(n/2),h=Math.sin(n/2),p=2*d*h,f=h*h,m=1-u*d*d,g=m?1/m:0,y=m?Math.acos(r*d)*Math.sqrt(1/m):0,v=.5*(2*y*r*h+2*n/Math.PI)-e,b=.5*(y*o+i)-t,x=.5*g*(u*f+y*r*d*c)+1/Math.PI,_=g*(p*l/4-y*o*h),w=.125*g*(l*h-y*o*u*p),k=.5*g*(c*d+y*f*r)+.5,E=_*w-k*x;s=(b*_-v*k)/E,a=(v*w-b*x)/E,n=C(n-s,-Math.PI,Math.PI),i=C(i-a,-Hp,Hp)}while((Math.abs(s)>o||Math.abs(a)>o)&&--r>0);return new Vl(w(n),w(i))}}class Xp extends Op{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(_(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){const{scale:n,cosPhi:i}=this;return{x:_(e)*i*n+.5,y:-Math.sin(_(t))/i*n+.5,z:0}}unproject(e,t){const{scale:n,cosPhi:i}=this,r=-(t-.5)/n,o=C(w((e-.5)/n)/i,-180,180),s=Math.asin(C(r*i,-1,1)),a=C(w(s),-Kl,Kl);return new Vl(o,a)}}class Kp extends qp{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,t,n){const i=Cl(e,t,n);return Ba(i,i,Al(vl(n))),{x:i[0],y:i[1],z:i[2]}}locationPoint(e,t){const n=Tl(t.lat,t.lng),i=Ra([],n),r=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude;Da(n,n,i,Wl(1,0)*aa*r);const o=pa(new Float64Array(16));return ma(o,e.pixelMatrix,e.globeMatrix),Ba(n,n,o),new v(n[0],n[1])}pixelsPerMeter(e,t){return Wl(1,0)*t}pixelSpaceConversion(e,t,n){const i=Wl(1,e)*t,r=On(Wl(1,45)*t,i,n);return this.pixelsPerMeter(e,t)/r}createTileMatrix(e,t,n){const i=Pl(vl(n.canonical));return ma(new Float64Array(16),e.globeMatrix,i)}createInversionMatrix(e,t){const{center:n}=e,i=Al(vl(t));return ba(i,i,_(n.lng)),va(i,i,_(n.lat)),ya(i,i,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(i)}pointCoordinate(e,t,n,i){return ml(e,t,n,!0)||new Yl(0,0)}pointCoordinate3D(e,t,n){const i=this.pointCoordinate(e,t,n,0);return[i.x,i.y,i.z]}isPointAboveHorizon(e,t){return!ml(e,t.x,t.y,!1)}farthestPixelDistance(e){const t=function(e,t){const n=e.cameraToCenterDistance,i=e._centerAltitude*t,r=e._camera,o=e._camera.forward(),s=Ca([],Oa([],o,-n),[0,0,i]),a=e.worldSize/(2*Math.PI),l=[0,0,-a],c=e.width/e.height,u=Math.tan(e.fovAboveCenter),d=Oa([],r.up(),u),h=Oa([],r.right(),u*c),p=Ra([],Ca([],Ca([],o,d),h)),f=[];let m;if(new tl(s,p).closestPointOnSphere(l,a,f)){const t=Ca([],f,l),n=$a([],t,s);m=Math.cos(e.fovAboveCenter)*Sa(n)}else{const e=$a([],s,l),t=$a([],l,s);Ra(t,t);const n=Sa(e)-a;m=Math.sqrt(n*(n+2*a));const i=Math.acos(m/(a+n))-Math.acos(za(o,t));m*=Math.cos(i)}return 1.01*m}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),n=Dl(e.zoom);if(n>0){const i=Ip(e,Wl(1,e.center.lat)*e.worldSize),r=e.worldSize/(2*Math.PI),o=Math.max(e.width,e.height)/e.worldSize*Math.PI;return On(t,i+r*(1-Math.cos(o)),Math.pow(n,10))}return t}upVector(e,t,n){return Cl(t,n,e,1)}upVectorScale(e){return{metersToTile:fl(Ml(vl(e)))}}}function Jp(e){const t=e.parallels,n=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new qp(e);case"equirectangular":return new $p(e);case"naturalEarth":return new Wp(e);case"equalEarth":return new Fp(e);case"winkelTripel":return new Zp(e);case"albers":return n?new Xp(e):new Dp(e);case"lambertConformalConic":return n?new Xp(e):new Up(e);case"globe":return new Kp(e)}throw new Error(`Invalid projection name: ${e.name}`)}const Yp=Hu.types,Qp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ef(e,t,n,i,r,o,s,a,l,c,u,d,h){const p=a?Math.min(kp,Math.round(a[0])):0,f=a?Math.min(kp,Math.round(a[1])):0;e.emplaceBack(t,n,Math.round(32*i),Math.round(32*r),o,s,(p<<1)+(l?1:0),f,16*c,16*u,256*d,256*h)}function tf(e,t,n,i,r,o,s){e.emplaceBack(t,n,i,r,o,s)}function nf(e,t,n,i,r){e.emplaceBack(t,n,i,r),e.emplaceBack(t,n,i,r),e.emplaceBack(t,n,i,r),e.emplaceBack(t,n,i,r)}function rf(e){for(const t of e.sections)if(lo(t.text))return!0;return!1}class of{constructor(e){this.layoutVertexArray=new Xo,this.indexArray=new is,this.programConfigurations=e,this.segments=new sa,this.dynamicLayoutVertexArray=new Go,this.opacityVertexArray=new Jo,this.placedSymbolArray=new ms,this.globeExtVertexArray=new Ko}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Pd.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Dd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Qp,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Od.members,!0)),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Xr(of,"SymbolBuffers");class sf{constructor(e,t,n){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new n,this.segments=new sa,this.collisionVertexArray=new ts,this.collisionVertexArrayExt=new ns}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Rd.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,zd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Xr(sf,"CollisionBuffers");class af{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=pa([]),this.placementViewportMatrix=pa([]);const t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$d(this.zoom,t["text-size"]),this.iconSizeData=$d(this.zoom,t["icon-size"]);const n=this.layers[0].layout,i=n.get("symbol-sort-key"),r=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map((e=>Th[e])),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new of(new Ks(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new of(new Ks(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new vs,this.lineVertexArray=new bs,this.symbolInstances=new ys}calculateGlyphDependencies(e,t,n,i,r){for(let o=0;o<e.length;o++)if(t[e.charCodeAt(o)]=!0,i&&r){const n=Gd[e.charAt(o)];n&&(t[n.charCodeAt(0)]=!0)}}populate(e,t,n,i){const r=this.layers[0],o=r.layout,s="globe"===this.projection.name,a=o.get("text-font"),l=o.get("text-field"),c=o.get("icon-image"),u=("constant"!==l.value.kind||l.value.value instanceof Rt&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),d="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,h=o.get("symbol-sort-key");if(this.features=[],!u&&!d)return;const p=t.iconDependencies,f=t.glyphDependencies,m=t.availableImages,g=new wo(this.zoom);for(const{feature:y,id:v,index:b,sourceLayerIndex:x}of e){const e=r._featureFilter.needGeometry,t=ac(y,e);if(!r._featureFilter.filter(g,t,n))continue;if(e||(t.geometry=sc(y,n,i)),s&&1!==y.type&&n.z<=5){const e=t.geometry,i=.98078528056,r=(e,t)=>za(Cl(e.x,e.y,n,1),Cl(t.x,t.y,n,1))<i;for(let t=0;t<e.length;t++)e[t]=nc(e[t],r)}let l,c;if(u){const e=r.getValueAndResolveTokens("text-field",t,n,m),i=Rt.factory(e);rf(i)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===bo()||this.hasRTLText&&_o.isParsed())&&(l=qd(i,r,t))}if(d){const e=r.getValueAndResolveTokens("icon-image",t,n,m);c=e instanceof zt?e:zt.fromString(e)}if(!l&&!c)continue;const _=this.sortFeaturesByKey?h.evaluate(t,{},n):void 0;if(this.features.push({id:v,text:l,icon:c,index:b,sourceLayerIndex:x,geometry:t.geometry,properties:y.properties,type:Yp[y.type],sortKey:_}),c&&(p[c.name]=!0),l){const e=a.evaluate(t,{},n).join(","),i="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Th.vertical)>=0;for(const t of l.sections)if(t.image)p[t.image.name]=!0;else{const n=to(l.toString()),r=t.fontStack||e,o=f[r]=f[r]||{};this.calculateGlyphDependencies(t.text,o,i,this.allowVerticalPlacement,n)}}}"line"===o.get("symbol-placement")&&(this.features=function(e){const t={},n={},i=[];let r=0;function o(t){i.push(e[t]),r++}function s(e,t,r){const o=n[e];return delete n[e],n[t]=o,i[o].geometry[0].pop(),i[o].geometry[0]=i[o].geometry[0].concat(r[0]),o}function a(e,n,r){const o=t[n];return delete t[n],t[e]=o,i[o].geometry[0].shift(),i[o].geometry[0]=r[0].concat(i[o].geometry[0]),o}function l(e,t,n){const i=n?t[0][t[0].length-1]:t[0][0];return`${e}:${i.x}:${i.y}`}for(let c=0;c<e.length;c++){const u=e[c],d=u.geometry,h=u.text?u.text.toString():null;if(!h){o(c);continue}const p=l(h,d),f=l(h,d,!0);if(p in n&&f in t&&n[p]!==t[f]){const e=a(p,f,d),r=s(p,f,i[e].geometry);delete t[p],delete n[f],n[l(h,i[r].geometry,!0)]=r,i[e].geometry=null}else p in n?s(p,f,d):f in t?a(p,f,d):(o(c),t[p]=r-1,n[f]=r-1)}return i.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,n,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,n,i),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,n,i))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Jp(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const n=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:i,y:r}of t)this.lineVertexArray.emplaceBack(i,r);return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,t,n,i,r,o,s,a,l,c,u,d,h,p){const f=e.indexArray,m=e.layoutVertexArray,g=e.globeExtVertexArray,y=e.segments.prepareSegment(4*t.length,m,f,this.canOverlap?o.sortKey:void 0),v=this.glyphOffsetArray.length,b=y.vertexLength,x=this.allowVerticalPlacement&&s===Th.vertical?Math.PI/2:0,_=o.text&&o.text.sections;for(let k=0;k<t.length;k++){const{tl:i,tr:r,bl:s,br:c,tex:u,pixelOffsetTL:d,pixelOffsetBR:v,minFontScaleX:b,minFontScaleY:w,glyphOffset:E,isSDF:S,sectionIndex:T}=t[k],C=y.vertexLength,M=E[1];if(ef(m,l.x,l.y,i.x,M+i.y,u.x,u.y,n,S,d.x,d.y,b,w),ef(m,l.x,l.y,r.x,M+r.y,u.x+u.w,u.y,n,S,v.x,d.y,b,w),ef(m,l.x,l.y,s.x,M+s.y,u.x,u.y+u.h,n,S,d.x,v.y,b,w),ef(m,l.x,l.y,c.x,M+c.y,u.x+u.w,u.y+u.h,n,S,v.x,v.y,b,w),a){const{x:t,y:n,z:i}=a.anchor,[r,o,s]=a.up;tf(g,t,n,i,r,o,s),tf(g,t,n,i,r,o,s),tf(g,t,n,i,r,o,s),tf(g,t,n,i,r,o,s),nf(e.dynamicLayoutVertexArray,t,n,i,x)}else nf(e.dynamicLayoutVertexArray,l.x,l.y,l.z,x);f.emplaceBack(C,C+1,C+2),f.emplaceBack(C+1,C+2,C+3),y.vertexLength+=4,y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(E[0]),k!==t.length-1&&T===t[k+1].sectionIndex||e.programConfigurations.populatePaintArrays(m.length,o,o.index,{},h,p,_&&_[T])}const w=a?a.anchor:l;e.placedSymbolArray.emplaceBack(w.x,w.y,w.z,l.x,l.y,v,this.glyphOffsetArray.length-v,b,c,u,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,d,0)}_commitLayoutVertex(e,t,n,i,r,o,s){e.emplaceBack(t,n,i,r,o,Math.round(s.x),Math.round(s.y))}_addCollisionDebugVertices(e,t,n,i,r,o,s){const a=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),l=a.vertexLength,c=s.tileAnchorX,u=s.tileAnchorY;for(let h=0;h<4;h++)n.collisionVertexArray.emplaceBack(0,0,0,0);n.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),n.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),n.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(n.layoutVertexArray,i,r,o,c,u,new v(e.x1,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,r,o,c,u,new v(e.x2,e.y1)),this._commitLayoutVertex(n.layoutVertexArray,i,r,o,c,u,new v(e.x2,e.y2)),this._commitLayoutVertex(n.layoutVertexArray,i,r,o,c,u,new v(e.x1,e.y2)),a.vertexLength+=4;const d=n.indexArray;d.emplaceBack(l,l+1),d.emplaceBack(l+1,l+2),d.emplaceBack(l+2,l+3),d.emplaceBack(l+3,l),a.primitiveLength+=4}_addTextDebugCollisionBoxes(e,t,n,i,r,o){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceTextSize(e,o,t,s);this._addCollisionDebugVertices(i,r,this.textCollisionBox,i.projectedAnchorX,i.projectedAnchorY,i.projectedAnchorZ,o)}}_addIconDebugCollisionBoxes(e,t,n,i,r,o){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceIconSize(e,t,o.placedIconSymbolIndex);this._addCollisionDebugVertices(i,r,this.iconCollisionBox,i.projectedAnchorX,i.projectedAnchorY,i.projectedAnchorZ,o)}}generateCollisionDebugBuffers(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new sf(Qo,Ld.members,cs),this.iconCollisionBox=new sf(Qo,Ld.members,cs);const n=Vd(this.iconSizeData,e),i=Vd(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(i,e,t,o.textBoxStartIndex,o.textBoxEndIndex,o),this._addTextDebugCollisionBoxes(i,e,t,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._addIconDebugCollisionBoxes(n,e,t,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._addIconDebugCollisionBoxes(n,e,t,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}}getSymbolInstanceTextSize(e,t,n,i){const r=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:i),o=jd(this.textSizeData,e,r)/Nd;return this.tilePixelRatio*o}getSymbolInstanceIconSize(e,t,n){const i=this.icon.placedSymbolArray.get(n),r=jd(this.iconSizeData,e,i);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(e,t,n){e.emplaceBack(t,-n,-n),e.emplaceBack(t,n,-n),e.emplaceBack(t,n,n),e.emplaceBack(t,-n,n)}_updateTextDebugCollisionBoxes(e,t,n,i,r,o){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceTextSize(e,o,t,s);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,r,i.padding)}}_updateIconDebugCollisionBoxes(e,t,n,i,r,o){for(let s=i;s<r;s++){const i=n.get(s),r=this.getSymbolInstanceIconSize(e,t,o);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,r,i.padding)}}updateCollisionDebugBuffers(e,t){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const n=Vd(this.iconSizeData,e),i=Vd(this.textSizeData,e);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(i,e,t,o.textBoxStartIndex,o.textBoxEndIndex,o),this._updateTextDebugCollisionBoxes(i,e,t,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._updateIconDebugCollisionBoxes(n,e,t,o.iconBoxStartIndex,o.iconBoxEndIndex,o.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(n,e,t,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,t,n,i,r,o,s,a,l){const c={};if(t<n){const{x1:n,y1:i,x2:r,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h,featureIndex:p}=e.get(t);c.textBox={x1:n,y1:i,x2:r,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h},c.textFeatureIndex=p}if(i<r){const{x1:t,y1:n,x2:r,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h,featureIndex:p}=e.get(i);c.verticalTextBox={x1:t,y1:n,x2:r,y2:o,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h},c.verticalTextFeatureIndex=p}if(o<s){const{x1:t,y1:n,x2:i,y2:r,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h,featureIndex:p}=e.get(o);c.iconBox={x1:t,y1:n,x2:i,y2:r,padding:s,projectedAnchorX:a,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h},c.iconFeatureIndex=p}if(a<l){const{x1:t,y1:n,x2:i,y2:r,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h,featureIndex:p}=e.get(a);c.verticalIconBox={x1:t,y1:n,x2:i,y2:r,padding:o,projectedAnchorX:s,projectedAnchorY:l,projectedAnchorZ:u,tileAnchorX:d,tileAnchorY:h},c.verticalIconFeatureIndex=p}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const n=e.placedSymbolArray.get(t),i=n.vertexStartIndex+4*n.numGlyphs;for(let r=n.vertexStartIndex;r<i;r+=4)e.indexArray.emplaceBack(r,r+1,r+2),e.indexArray.emplaceBack(r+1,r+2,r+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),n=Math.cos(e),i=[],r=[],o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);const e=this.symbolInstances.get(s);i.push(0|Math.round(t*e.tileAnchorX+n*e.tileAnchorY)),r.push(e.featureIndex)}return o.sort(((e,t)=>i[e]-i[t]||r[t]-r[e])),o}addToSortKeyRanges(e,t){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===t?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex);const{rightJustifiedTextSymbolIndex:n,centerJustifiedTextSymbolIndex:i,leftJustifiedTextSymbolIndex:r,verticalPlacedTextSymbolIndex:o,placedIconSymbolIndex:s,verticalPlacedIconSymbolIndex:a}=t;n>=0&&this.addIndicesForPlacedSymbol(this.text,n),i>=0&&i!==n&&this.addIndicesForPlacedSymbol(this.text,i),r>=0&&r!==i&&r!==n&&this.addIndicesForPlacedSymbol(this.text,r),o>=0&&this.addIndicesForPlacedSymbol(this.text,o),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Xr(af,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),af.MAX_GLYPHS=65535,af.addDynamicAttributes=nf;const lf=new Ro({"symbol-placement":new Po(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Po(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Po(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Oo(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Po(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Po(et.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Po(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Po(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Po(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Oo(et.layout_symbol["icon-size"]),"icon-text-fit":new Po(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Po(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Oo(et.layout_symbol["icon-image"]),"icon-rotate":new Oo(et.layout_symbol["icon-rotate"]),"icon-padding":new Po(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Po(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Oo(et.layout_symbol["icon-offset"]),"icon-anchor":new Oo(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Po(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Po(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Po(et.layout_symbol["text-rotation-alignment"]),"text-field":new Oo(et.layout_symbol["text-field"]),"text-font":new Oo(et.layout_symbol["text-font"]),"text-size":new Oo(et.layout_symbol["text-size"]),"text-max-width":new Oo(et.layout_symbol["text-max-width"]),"text-line-height":new Oo(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Oo(et.layout_symbol["text-letter-spacing"]),"text-justify":new Oo(et.layout_symbol["text-justify"]),"text-radial-offset":new Oo(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Po(et.layout_symbol["text-variable-anchor"]),"text-anchor":new Oo(et.layout_symbol["text-anchor"]),"text-max-angle":new Po(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Po(et.layout_symbol["text-writing-mode"]),"text-rotate":new Oo(et.layout_symbol["text-rotate"]),"text-padding":new Po(et.layout_symbol["text-padding"]),"text-keep-upright":new Po(et.layout_symbol["text-keep-upright"]),"text-transform":new Oo(et.layout_symbol["text-transform"]),"text-offset":new Oo(et.layout_symbol["text-offset"]),"text-allow-overlap":new Po(et.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Po(et.layout_symbol["text-ignore-placement"]),"text-optional":new Po(et.layout_symbol["text-optional"])});var cf={paint:new Ro({"icon-opacity":new Oo(et.paint_symbol["icon-opacity"]),"icon-color":new Oo(et.paint_symbol["icon-color"]),"icon-halo-color":new Oo(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Oo(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Oo(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Po(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Po(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Oo(et.paint_symbol["text-opacity"]),"text-color":new Oo(et.paint_symbol["text-color"],{runtimeType:ht,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Oo(et.paint_symbol["text-halo-color"]),"text-halo-width":new Oo(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Oo(et.paint_symbol["text-halo-blur"]),"text-translate":new Po(et.paint_symbol["text-translate"]),"text-translate-anchor":new Po(et.paint_symbol["text-translate-anchor"])}),layout:lf};class uf{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:lt,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Xr(uf,"FormatSectionOverride",{omit:["defaultValue"]});class df extends ia{constructor(e){super(e,cf)}recalculate(e,t){super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const n=this.layout.get("text-writing-mode");if(n){const e=[];for(const t of n)e.indexOf(t)<0&&e.push(t);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,t,n,i){const r=this.layout.get(e).evaluate(t,{},n,i),o=this._unevaluatedLayout._values[e];return o.isDataDriven()||Xi(o.value)||!r?r:function(e,t){return t.replace(/{([^{}]+)}/g,((t,n)=>n in e?String(e[n]):""))}(t.properties,r)}createBucket(e){return new af(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of cf.paint.overridableProperties){if(!df.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),n=new uf(t),i=new Zi(n,t.property.specification);let r=null;r="constant"===t.value.kind||"source"===t.value.kind?new Ji("source",i):new Yi("composite",i,t.value.zoomStops,t.value._interpolationType),this.paint._values[e]=new Io(t.property,r,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven())&&df.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const n=e.get("text-field"),i=cf.paint.properties[t];let r=!1;const o=e=>{for(const t of e)if(i.overrides&&i.overrides.hasOverride(t))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof Rt)o(n.value.value.sections);else if("source"===n.value.kind){const e=t=>{r||(t instanceof jt&&Nt(t.value)===gt?o(t.value.sections):t instanceof Wt?o(t.sections):t.eachChild(e))},t=n.value;t._styleExpression&&e(t._styleExpression.expression)}return r}getProgramConfiguration(e){return new Xs(this,e)}}var hf={paint:new Ro({"background-color":new Po(et.paint_background["background-color"]),"background-pattern":new Po(et.paint_background["background-pattern"]),"background-opacity":new Po(et.paint_background["background-opacity"])})},pf={paint:new Ro({"raster-opacity":new Po(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Po(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Po(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Po(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Po(et.paint_raster["raster-saturation"]),"raster-contrast":new Po(et.paint_raster["raster-contrast"]),"raster-resampling":new Po(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Po(et.paint_raster["raster-fade-duration"])})};class ff extends ia{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var mf={paint:new Ro({"sky-type":new Po(et.paint_sky["sky-type"]),"sky-atmosphere-sun":new Po(et.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Po(et.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Po(et.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Po(et.paint_sky["sky-gradient-radius"]),"sky-gradient":new Do(et.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Po(et.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Po(et.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Po(et.paint_sky["sky-opacity"])})};function gf(e,t,n){const i=[0,0,1],r=Ha([]);return Xa(r,r,n?-_(e)+Math.PI:_(e)),Za(r,r,-_(t)),Na(i,i,r),Ra(i,i)}const yf={circle:class extends ia{constructor(e){super(e,Mc)}createBucket(e){return new uc(e)}queryRadius(e){const t=e;return kc("circle-radius",this,t)+kc("circle-stroke-width",this,t)+Ec(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,n,i,r,o,s,a){const l=Tc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n);return Ic(e,i,o,s,a,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),l,c)}getProgramIds(){return["circle"]}getProgramConfiguration(e){return new Xs(this,e)}},heatmap:class extends ia{createBucket(e){return new Rc(e)}constructor(e){super(e,$c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return kc("heatmap-radius",this,e)}queryIntersectsFeature(e,t,n,i,r,o,s,a){const l=this.paint.get("heatmap-radius").evaluate(t,n);return Ic(e,i,o,s,a,!0,!0,new v(0,0),l)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(e){return new Xs(this,e)}},hillshade:class extends ia{constructor(e){super(e,Vc)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ia{constructor(e){super(e,Iu)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),n=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(e){return new Xs(this,e)}recalculate(e,t){super.recalculate(e,t);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Cu(e)}queryRadius(){return Ec(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,n,i,r,o){return!e.queryGeometry.isAboveHorizon&&pc(Sc(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),i)}isTileClipped(){return!0}},"fill-extrusion":class extends ia{constructor(e){super(e,ud)}createBucket(e){return new ed(e)}queryRadius(){return Ec(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(e){return new Xs(this,e)}queryIntersectsFeature(e,t,n,i,r,o,s,a,l){const c=Tc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),u=this.paint.get("fill-extrusion-height").evaluate(t,n),d=this.paint.get("fill-extrusion-base").evaluate(t,n),h=[0,0],p=a&&o.elevation,f=o.elevation?o.elevation.exaggeration():1,m=e.tile.getBucket(this);if(p&&m instanceof ed){const e=m.centroidVertexArray,t=l+1;t<e.length&&(h[0]=e.geta_centroid_pos0(t),h[1]=e.geta_centroid_pos1(t))}if(0===h[0]&&1===h[1])return!1;"globe"===o.projection.name&&(i=ld([i],[new v(0,0),new v(aa,aa)],e.tileID.canonical).map((e=>e.polygon)).flat());const g=p?a:null,[y,b]=function(e,t,n,i,r,o,s,a,l,c,u){return"globe"===e.projection.name?function(e,t,n,i,r,o,s,a,l,c,u){const d=[],h=[],p=e.projection.upVectorScale(u,e.center.lat,e.worldSize).metersToTile,f=[0,0,0,1],m=[0,0,0,1],g=(e,t,n,i)=>{e[0]=t,e[1]=n,e[2]=i,e[3]=1},y=ad();n>0&&(n+=y),i+=y;for(const v of t){const t=[],y=[];for(const d of v){const h=d.x+r.x,v=d.y+r.y,b=e.projection.projectTilePoint(h,v,u),x=e.projection.upVector(u,d.x,d.y);let _=n,w=i;if(s){const e=bd(h,v,n,i,s,a,l,c);_+=e.base,w+=e.top}0!==n?g(f,b.x+x[0]*p*_,b.y+x[1]*p*_,b.z+x[2]*p*_):g(f,b.x,b.y,b.z),g(m,b.x+x[0]*p*w,b.y+x[1]*p*w,b.z+x[2]*p*w),Ba(f,f,o),Ba(m,m,o),t.push(new gd(f[0],f[1],f[2])),y.push(new gd(m[0],m[1],m[2]))}d.push(t),h.push(y)}return[d,h]}(e,t,n,i,r,o,s,a,l,c,u):s?function(e,t,n,i,r,o,s,a,l){const c=[],u=[],d=[0,0,0,1];for(const h of e){const e=[],p=[];for(const c of h){const u=c.x+i.x,h=c.y+i.y,f=bd(u,h,t,n,o,s,a,l);d[0]=u,d[1]=h,d[2]=f.base,d[3]=1,Ga(d,d,r),d[3]=Math.max(d[3],1e-5);const m=new gd(d[0]/d[3],d[1]/d[3],d[2]/d[3]);d[0]=u,d[1]=h,d[2]=f.top,d[3]=1,Ga(d,d,r),d[3]=Math.max(d[3],1e-5);const g=new gd(d[0]/d[3],d[1]/d[3],d[2]/d[3]);e.push(m),p.push(g)}c.push(e),u.push(p)}return[c,u]}(t,n,i,r,o,s,a,l,c):function(e,t,n,i,r){const o=[],s=[],a=r[8]*t,l=r[9]*t,c=r[10]*t,u=r[11]*t,d=r[8]*n,h=r[9]*n,p=r[10]*n,f=r[11]*n;for(const m of e){const e=[],t=[];for(const n of m){const o=n.x+i.x,s=n.y+i.y,m=r[0]*o+r[4]*s+r[12],g=r[1]*o+r[5]*s+r[13],y=r[2]*o+r[6]*s+r[14],v=r[3]*o+r[7]*s+r[15],b=m+a,x=g+l,_=y+c,w=Math.max(v+u,1e-5),k=m+d,E=g+h,S=y+p,T=Math.max(v+f,1e-5);e.push(new gd(b/w,x/w,_/w)),t.push(new gd(k/T,E/T,S/T))}o.push(e),s.push(t)}return[o,s]}(t,n,i,r,o)}(o,i,d,u,c,s,g,h,f,o.center.lat,e.tileID.canonical),x=e.queryGeometry;return function(e,t,n){let i=1/0;pc(n,t)&&(i=vd(n,t[0]));for(let r=0;r<t.length;r++){const o=t[r],s=e[r];for(let e=0;e<o.length-1;e++){const t=o[e],r=[t,o[e+1],s[e+1],s[e],t];dc(n,r)&&(i=Math.min(i,vd(n,r)))}}return i!==1/0&&i}(y,b,x.isPointQuery()?x.screenBounds:x.screenGeometry)}},line:class extends ia{constructor(e){super(e,Md),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Pn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Id.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Td(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(e){return new Xs(this,e)}queryRadius(e){const t=e,n=Ad(kc("line-width",this,t),kc("line-gap-width",this,t)),i=kc("line-offset",this,t);return n/2+Math.abs(i)+Ec(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,n,i,r,o){if(e.queryGeometry.isAboveHorizon)return!1;const s=Sc(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),a=e.pixelToTileUnitsFactor/2*Ad(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),l=this.paint.get("line-offset").evaluate(t,n);return l&&(i=function(e,t){const n=[],i=new v(0,0);for(let r=0;r<e.length;r++){const o=e[r],s=[];for(let e=0;e<o.length;e++){const n=o[e],r=o[e+1],a=0===e?i:n.sub(o[e-1])._unit()._perp(),l=e===o.length-1?i:r.sub(n)._unit()._perp(),c=a._add(l)._unit();c._mult(1/(c.x*l.x+c.y*l.y)),s.push(c._mult(t)._add(n))}n.push(s)}return n}(i,l*e.pixelToTileUnitsFactor)),function(e,t,n){for(let i=0;i<t.length;i++){const r=t[i];if(e.length>=3)for(let t=0;t<r.length;t++)if(xc(e,r[t]))return!0;if(fc(e,r,n))return!0}return!1}(s,i,a)}isTileClipped(){return!0}},symbol:df,background:class extends ia{constructor(e){super(e,hf)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ia{constructor(e){super(e,pf)}getProgramIds(){return["raster"]}},sky:class extends ia{constructor(e){super(e,mf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=jc({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const n=this.paint.get("sky-atmosphere-sun"),i=!n,r=e.style.light,o=r.properties.get("position");return i&&"viewport"===r.properties.get("anchor")&&q("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),i?gf(o.azimuthal,90-o.polar,t):gf(n[0],90-n[1],t)}const n=this.paint.get("sky-gradient-center");return gf(n[0],90-n[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}}};class vf{constructor(e,t,n,i){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(t,i)}update(e,n,i){const{width:r,height:o}=e,{context:s}=this,{gl:a}=s,{HTMLImageElement:l,HTMLCanvasElement:c,HTMLVideoElement:u,ImageData:d,ImageBitmap:h}=t;if(a.bindTexture(a.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!n||!1!==n.premultiply)),i||this.size&&this.size[0]===r&&this.size[1]===o){const{x:t,y:n}=i||{x:0,y:0};e instanceof l||e instanceof c||e instanceof u||e instanceof d||h&&e instanceof h?a.texSubImage2D(a.TEXTURE_2D,0,t,n,a.RGBA,a.UNSIGNED_BYTE,e):a.texSubImage2D(a.TEXTURE_2D,0,t,n,r,o,a.RGBA,a.UNSIGNED_BYTE,e.data)}else this.size=[r,o],e instanceof l||e instanceof c||e instanceof u||e instanceof d||h&&e instanceof h?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,e):a.texImage2D(a.TEXTURE_2D,0,this.format,r,o,0,this.format,a.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&a.generateMipmap(a.TEXTURE_2D)}bind(e,t){const{context:n}=this,{gl:i}=n;i.bindTexture(i.TEXTURE_2D,this.texture),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.useMipmap?e===i.NEAREST?i.NEAREST_MIPMAP_NEAREST:i.LINEAR_MIPMAP_NEAREST:e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class bf{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class xf{constructor(){this.tasks={},this.taskQueue=[],N(["process"],this),this.invoker=new bf(this.process),this.nextId=0}add(e,t){const n=this.nextId++,i=function({type:e,isSymbolTile:t,zoom:n}){return n=n||0,"message"===e?0:"maybePrepare"!==e||t?"parseTile"!==e||t?"parseTile"===e&&t?300-n:"maybePrepare"===e&&t?400-n:500:200-n:100-n}(t);if(0===i){H();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[n]={fn:e,metadata:t,priority:i,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:()=>{delete this.tasks[n]}}}process(){H();try{if(this.taskQueue=this.taskQueue.filter((e=>!!this.tasks[e])),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const t=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!t)return;t.fn()}finally{}}pick(){let e=null,t=1/0;for(let i=0;i<this.taskQueue.length;i++){const n=this.tasks[this.taskQueue[i]];n.priority<t&&(t=n.priority,e=i)}if(null===e)return null;const n=this.taskQueue[e];return this.taskQueue.splice(e,1),n}remove(){this.invoker.remove()}}class _f{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const n=e[t];this._stringToNumber[n]=t,this._numberToString[t]=n}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const wf=["tile","layer","source","sourceLayer","state"];class kf{constructor(e,t,n,i,r){this.type="Feature",this._vectorTileFeature=e,this._z=t,this._x=n,this._y=i,this.properties=e.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const t of wf)void 0!==this[t]&&(e[t]=this[t]);return e}}const Ef=32,Sf=33,Tf=new Uint16Array(8184);for(let km=0;km<2046;km++){let e=km+2,t=0,n=0,i=0,r=0,o=0,s=0;for(1&e?i=r=o=Ef:t=n=s=Ef;(e>>=1)>1;){const a=t+i>>1,l=n+r>>1;1&e?(i=t,r=n,t=o,n=s):(t=i,n=r,i=o,r=s),o=a,s=l}const a=4*km;Tf[a+0]=t,Tf[a+1]=n,Tf[a+2]=i,Tf[a+3]=r}const Cf=new Uint16Array(2178),Mf=new Uint8Array(1089),If=new Uint16Array(1089);function Af(e){return 0===e?-.03125:32===e?.03125:0}var Pf=Fo([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Of={type:2,extent:aa,loadGeometry:()=>[[new v(0,0),new v(aa+1,0),new v(aa+1,aa+1),new v(0,aa+1),new v(0,0)]]};class Df{constructor(e,t,n,i,r){this.tileID=e,this.uid=R(),this.uses=0,this.tileSize=t,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=r,this.expiredRequestCount=0,this.state="loading",i&&i.transform&&(this.projection=i.transform.projection)}registerFadeDuration(e){const t=e+this.timeAdded;t<Ze.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Ap(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,t,n){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const n={};if(!t)return n;for(const i of e){const e=i.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){i.layers=e,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)n[t.id]=i}}return n}(e.buckets,t.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const t=this.buckets[e];if(t instanceof af){if(this.hasSymbolBuckets=!0,!n)break;t.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const t=this.buckets[e];if(t instanceof af&&t.hasRTLText){this.hasRTLText=!0,_o.isLoading()||_o.isLoaded()||"deferred"!==bo()||xo();break}}this.queryPadding=0;for(const e in this.buckets){const n=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(e).queryRadius(n))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new ps}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const n in this.buckets){const t=this.buckets[n];t.uploadPending()&&t.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new vf(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new vf(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new vf(e,this.lineAtlas.image,t.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,n,i,r,o,s,a){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:i,pixelPosMatrix:s,transform:o,params:r,tileTransform:this.tileTransform},e,t,n):{}}querySourceFeatures(e,t){const n=this.latestFeatureIndex;if(!n||!n.rawTileData)return;const i=n.loadVTLayers(),r=t?t.sourceLayer:"",o=i._geojsonTileLayer||i[r];if(!o)return;const s=dr(t&&t.filter),{z:a,x:l,y:c}=this.tileID.canonical,u={z:a,x:l,y:c};for(let d=0;d<o.length;d++){const t=o.feature(d);if(s.needGeometry){const e=ac(t,!0);if(!s.filter(new wo(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new wo(this.tileID.overscaledZ),t))continue;const i=n.getId(t,r),h=new kf(t,a,l,c,i);h.tile=u,e.push(h)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const t=this.expirationTime;if(e.cacheControl){const t=Z(e.cacheControl);t["max-age"]&&(this.expirationTime=Date.now()+1e3*t["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let n=!1;if(this.expirationTime>e)n=!1;else if(t)if(this.expirationTime<t)n=!0;else{const i=this.expirationTime-t;i?this.expirationTime=e+Math.max(i,3e4):n=!0}else n=!0;n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!t)return;const n=this.latestFeatureIndex.loadVTLayers(),i=t.style.listImages();for(const r in this.buckets){if(!t.style.hasLayer(r))continue;const o=this.buckets[r],s=o.layers[0].sourceLayer||"_geojsonTileLayer",a=n[s],l=e[s];if(!a||!l||0===Object.keys(l).length)continue;if(o.update(l,a,i,this.imageAtlas&&this.imageAtlas.patternPositions||{}),o instanceof Td||o instanceof Cu){const e=t.style._getSourceCache(o.layers[0].source);t._terrain&&t._terrain.enabled&&e&&o.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(e.id,this.tileID)}const c=t&&t.style&&t.style.getLayer(r);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(o)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ze.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ze.now()+e}setTexture(e,t){const n=t.context,i=n.gl;this.texture=this.texture||t.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new vf(n,e,i.RGBA,{useMipmap:!0}),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE))}setDependencies(e,t){const n={};for(const i of t)n[i]=!0;this.dependencies[e]=n}hasDependency(e,t){for(const n of e){const e=this.dependencies[n];if(e)for(const n of t)if(e[n])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,t){if(!t||"mercator"===t.name||this._tileDebugBuffer)return;const n=sc(Of,this.tileID.canonical,this.tileTransform)[0],i=new jo,r=new us;for(let o=0;o<n.length;o++){const{x:e,y:t}=n[o];i.emplaceBack(e,t),r.emplaceBack(o)}r.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(r),this._tileDebugBuffer=e.createVertexBuffer(i,el.members),this._tileDebugSegments=sa.simpleSegment(0,0,i.length,r.length)}_makeTileBoundsBuffers(e,t){if(this._tileBoundsBuffer||!t||"mercator"===t.name)return;const n=sc(Of,this.tileID.canonical,this.tileTransform)[0];let i,r;if(this.isRaster){const e=function(e,t){const n=Ap(e,t),i=Math.pow(2,e.z);for(let c=0;c<Sf;c++)for(let r=0;r<Sf;r++){const o=Hl((e.x+(r+Af(r))/Ef)/i),s=Zl((e.y+(c+Af(c))/Ef)/i),a=t.project(o,s),l=c*Sf+r;Cf[2*l+0]=Math.round((a.x*n.scale-n.x)*aa),Cf[2*l+1]=Math.round((a.y*n.scale-n.y)*aa)}Mf.fill(0),If.fill(0);for(let c=2045;c>=0;c--){const e=4*c,t=Tf[e+0],n=Tf[e+1],i=Tf[e+2],r=Tf[e+3],o=t+i>>1,s=n+r>>1,a=o+s-n,l=s+t-o,u=n*Sf+t,d=r*Sf+i,h=s*Sf+o,p=Math.hypot((Cf[2*u+0]+Cf[2*d+0])/2-Cf[2*h+0],(Cf[2*u+1]+Cf[2*d+1])/2-Cf[2*h+1])>=16;Mf[h]=Mf[h]||(p?1:0),c<1022&&(Mf[h]=Mf[h]||Mf[(n+l>>1)*Sf+(t+a>>1)]||Mf[(r+l>>1)*Sf+(i+a>>1)])}const r=new Uo,o=new is;let s=0;function a(e,t){const n=t*Sf+e;return 0===If[n]&&(r.emplaceBack(Cf[2*n+0],Cf[2*n+1],e*aa/Ef,t*aa/Ef),If[n]=++s),If[n]-1}function l(e,t,n,i,r,s){const c=e+n>>1,u=t+i>>1;if(Math.abs(e-r)+Math.abs(t-s)>1&&Mf[u*Sf+c])l(r,s,e,t,c,u),l(n,i,r,s,c,u);else{const l=a(e,t),c=a(n,i),u=a(r,s);o.emplaceBack(l,c,u)}}return l(0,0,Ef,Ef,Ef,0),l(Ef,Ef,0,0,0,Ef),{vertices:r,indices:o}}(this.tileID.canonical,t);i=e.vertices,r=e.indices}else{i=new Uo,r=new is;for(const{x:t,y:r}of n)i.emplaceBack(t,r,0,0);const e=vu(i.int16,void 0,4);for(let t=0;t<e.length;t+=3)r.emplaceBack(e[t],e[t+1],e[t+2])}this._tileBoundsBuffer=e.createVertexBuffer(i,Pf.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(r),this._tileBoundsSegments=sa.simpleSegment(0,0,i.length,r.length)}_makeGlobeTileDebugBuffers(e,t){const n=t.projection;if(!n||"globe"!==n.name||t.freezeTileCoverage)return;const i=this.tileID.canonical,r=Al(xl(i,t)),o=Dl(t.zoom);let s;o>0&&(s=fa(new Float64Array(16),t.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,i,t,r,s,o),this._makeGlobeTileDebugTextBuffer(e,i,t,r,s,o)}_globePoint(e,t,n,i,r,o,s){let a=Cl(e,t,n);if(o){const r=1<<n.z,l=ql(i.center.lng),c=Gl(i.center.lat),u=(n.x+.5)/r-l;let d=0;u>.5?d=-1:u<-.5&&(d=1);let h=(e/aa+n.x)/r+d,p=(t/aa+n.y)/r;h=(h-l)*i._pixelsPerMercatorPixel+l,p=(p-c)*i._pixelsPerMercatorPixel+c;const f=[h*i.worldSize,p*i.worldSize,0];Ba(f,f,o),a=bl(a,f,s)}return Ba(a,a,r)}_makeGlobeTileDebugBorderBuffer(e,t,n,i,r,o){const s=new jo,a=new us,l=new Vo,c=(e,c,u,d,h)=>{const p=(u-e)/(h-1),f=(d-c)/(h-1),m=s.length;for(let g=0;g<h;g++){const u=e+g*p,d=c+g*f;s.emplaceBack(u,d);const h=this._globePoint(u,d,t,n,i,r,o);l.emplaceBack(h[0],h[1],h[2]),a.emplaceBack(m+g)}},u=aa;c(0,0,u,0,16),c(u,0,u,u,16),c(u,u,0,u,16),c(0,u,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(a),this._tileDebugBuffer=e.createVertexBuffer(s,el.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(l,Qa.members),this._tileDebugSegments=sa.simpleSegment(0,0,s.length,a.length)}_makeGlobeTileDebugTextBuffer(e,t,n,i,r,o){const s=aa/4,a=new jo,l=new is,c=new Vo,u=25;l.reserve(32),a.reserve(u),c.reserve(u);const d=(e,t)=>u*e+t;for(let h=0;h<u;h++){const e=h*s;for(let l=0;l<u;l++){const u=l*s;a.emplaceBack(u,e);const d=this._globePoint(u,e,t,n,i,r,o);c.emplaceBack(d[0],d[1],d[2])}}for(let h=0;h<4;h++)for(let e=0;e<4;e++){const t=d(h,e),n=d(h,e+1),i=d(h+1,e),r=d(h+1,e+1);l.emplaceBack(t,n,i),l.emplaceBack(i,n,r)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(l),this._tileDebugTextBuffer=e.createVertexBuffer(a,el.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(c,Qa.members),this._tileDebugTextSegments=sa.simpleSegment(0,0,u,32)}}class Rf{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,t,n){const i=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},O(this.stateChanges[e][i],n),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==i&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][i]){this.deletedStates[e][i]={};for(const t in this.state[e][i])n[t]||(this.deletedStates[e][i][t]=null)}else for(const r in n)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][r]&&delete this.deletedStates[e][i][r]}removeFeatureState(e,t,n){if(null===this.deletedStates[e])return;const i=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&void 0!==t)null!==this.deletedStates[e][i]&&(this.deletedStates[e][i]=this.deletedStates[e][i]||{},this.deletedStates[e][i][n]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][i])for(n in this.deletedStates[e][i]={},this.stateChanges[e][i])this.deletedStates[e][i][n]=null;else this.deletedStates[e][i]=null;else this.deletedStates[e]=null}getState(e,t){const n=String(t),i=O({},(this.state[e]||{})[n],(this.stateChanges[e]||{})[n]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const n=this.deletedStates[e][t];if(null===n)return{};for(const e in n)delete i[e]}return i}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,t){const n={};for(const i in this.stateChanges){this.state[i]=this.state[i]||{};const e={};for(const t in this.stateChanges[i])this.state[i][t]||(this.state[i][t]={}),O(this.state[i][t],this.stateChanges[i][t]),e[t]=this.state[i][t];n[i]=e}for(const i in this.deletedStates){this.state[i]=this.state[i]||{};const e={};if(null===this.deletedStates[i])for(const t in this.state[i])e[t]={},this.state[i][t]={};else for(const t in this.deletedStates[i]){if(null===this.deletedStates[i][t])this.state[i][t]={};else if(this.state[i][t])for(const e of Object.keys(this.deletedStates[i][t]))delete this.state[i][t][e];e[t]=this.state[i][t]}n[i]=n[i]||{},O(n[i],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(n).length)for(const i in e)e[i].setFeatureState(n,t)}}class zf{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,t){const n=this.toIdx(e,t);return{min:this.minimums[n],max:this.maximums[n]}}isLeaf(e,t){return this.leaves[this.toIdx(e,t)]}toIdx(e,t){return t*this.size+e}}function Lf(e,t,n,i){let r=0,o=Number.MAX_VALUE;for(let s=0;s<3;s++)if(Math.abs(i[s])<1e-15){if(n[s]<e[s]||n[s]>t[s])return null}else{const a=1/i[s];let l=(e[s]-n[s])*a,c=(t[s]-n[s])*a;if(l>c){const e=l;l=c,c=e}if(l>r&&(r=l),c<o&&(o=c),r>o)return null}return r}function Bf(e,t,n,i,r,o,s,a,l,c,u){const d=i-e,h=r-t,p=o-n,f=s-e,m=a-t,g=l-n,y=u[1]*g-u[2]*m,v=u[2]*f-u[0]*g,b=u[0]*m-u[1]*f,x=d*y+h*v+p*b;if(Math.abs(x)<1e-15)return null;const _=1/x,w=c[0]-e,k=c[1]-t,E=c[2]-n,S=(w*y+k*v+E*b)*_;if(S<0||S>1)return null;const T=k*p-E*h,C=E*d-w*p,M=w*h-k*d,I=(u[0]*T+u[1]*C+u[2]*M)*_;return I<0||S+I>1?null:(f*T+m*C+g*M)*_}function Nf(e,t,n){return(e-t)/(n-t)}function Ff(e,t,n,i,r,o,s,a,l){const c=1<<n,u=o-i,d=s-r,h=(e+1)/c*u+i,p=(t+0)/c*d+r,f=(t+1)/c*d+r;a[0]=(e+0)/c*u+i,a[1]=p,l[0]=h,l[1]=f}class $f{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const t=function(e){const t=Math.ceil(Math.log2(e.dim/8)),n=[];let i=Math.ceil(Math.pow(2,t));const r=1/i,o=(e,t,n,i,r)=>{const o=i?1:0,s=(e+1)*n-o,a=t*n,l=(t+1)*n-o;r[0]=e*n,r[1]=a,r[2]=s,r[3]=l};let s=new zf(i);const a=[];for(let l=0;l<i*i;l++){o(l%i,Math.floor(l/i),r,!1,a);const t=Vf(a[0],a[1],e),n=Vf(a[2],a[1],e),c=Vf(a[2],a[3],e),u=Vf(a[0],a[3],e);s.minimums.push(Math.min(t,n,c,u)),s.maximums.push(Math.max(t,n,c,u)),s.leaves.push(1)}for(n.push(s),i/=2;i>=1;i/=2){const e=n[n.length-1];s=new zf(i);for(let t=0;t<i*i;t++){o(t%i,Math.floor(t/i),2,!0,a);const n=e.getElevation(a[0],a[1]),r=e.getElevation(a[2],a[1]),l=e.getElevation(a[2],a[3]),c=e.getElevation(a[0],a[3]),u=e.isLeaf(a[0],a[1]),d=e.isLeaf(a[2],a[1]),h=e.isLeaf(a[2],a[3]),p=e.isLeaf(a[0],a[3]),f=Math.min(n.min,r.min,l.min,c.min),m=Math.max(n.max,r.max,l.max,c.max),g=u&&d&&h&&p;s.maximums.push(m),s.minimums.push(f),s.leaves.push(m-f<=5&&g?1:0)}n.push(s)}return n}(this.dem),n=t.length-1,i=t[n];this._addNode(i.minimums[0],i.maximums[0],i.leaves[0]),this._construct(t,0,0,n,0)}raycastRoot(e,t,n,i,r,o,s=1){return Lf([e,t,-100],[n,i,this.maximums[0]*s],r,o)}raycast(e,t,n,i,r,o,s=1){if(!this.nodeCount)return null;const a=this.raycastRoot(e,t,n,i,r,o,s);if(null==a)return null;const l=[],c=[],u=[],d=[],h=[{idx:0,t:a,nodex:0,nodey:0,depth:0}];for(;h.length>0;){const{idx:a,t:p,nodex:f,nodey:m,depth:g}=h.pop();if(this.leaves[a]){Ff(f,m,g,e,t,n,i,u,d);const a=1<<g,l=(f+0)/a,c=(f+1)/a,h=(m+0)/a,y=(m+1)/a,v=Vf(l,h,this.dem)*s,b=Vf(c,h,this.dem)*s,x=Vf(c,y,this.dem)*s,_=Vf(l,y,this.dem)*s,w=Bf(u[0],u[1],v,d[0],u[1],b,d[0],d[1],x,r,o),k=Bf(d[0],d[1],x,u[0],d[1],_,u[0],u[1],v,r,o),E=Math.min(null!==w?w:Number.MAX_VALUE,null!==k?k:Number.MAX_VALUE);if(E!==Number.MAX_VALUE)return E;{const e=Da([],r,o,p);if(jf(v,b,_,x,Nf(e[0],u[0],d[0]),Nf(e[1],u[1],d[1]))>=e[2])return p}continue}let y=0;for(let h=0;h<this._siblingOffset.length;h++){Ff((f<<1)+this._siblingOffset[h][0],(m<<1)+this._siblingOffset[h][1],g+1,e,t,n,i,u,d),u[2]=-100,d[2]=this.maximums[this.childOffsets[a]+h]*s;const p=Lf(u,d,r,o);if(null!=p){const e=p;l[h]=e;let t=!1;for(let n=0;n<y&&!t;n++)e>=l[c[n]]&&(c.splice(n,0,h),t=!0);t||(c[y]=h),y++}}for(let e=0;e<y;e++){const t=c[e];h.push({idx:this.childOffsets[a]+t,t:l[t],nodex:(f<<1)+this._siblingOffset[t][0],nodey:(m<<1)+this._siblingOffset[t][1],depth:g+1})}}return null}_addNode(e,t,n){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(n),this.childOffsets.push(0),this.nodeCount++}_construct(e,t,n,i,r){if(1===e[i].isLeaf(t,n))return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const o=i-1,s=e[o];let a=0,l=0;for(let c=0;c<this._siblingOffset.length;c++){const e=2*t+this._siblingOffset[c][0],i=2*n+this._siblingOffset[c][1],r=s.getElevation(e,i),o=s.isLeaf(e,i),u=this._addNode(r.min,r.max,o);o&&(a|=1<<c),l||(l=u)}for(let c=0;c<this._siblingOffset.length;c++)a&1<<c||this._construct(e,2*t+this._siblingOffset[c][0],2*n+this._siblingOffset[c][1],o,l+c)}}function jf(e,t,n,i,r,o){return On(On(e,n,o),On(t,i,o),r)}function Vf(e,t,n){const i=n.dim,r=C(e*i-.5,0,i-1),o=C(t*i-.5,0,i-1),s=Math.floor(r),a=Math.floor(o),l=Math.min(s+1,i-1),c=Math.min(a+1,i-1);return jf(n.get(s,a),n.get(l,a),n.get(s,c),n.get(l,c),r-s,o-a)}const Uf={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function qf(e,t,n){return(256*e*256+256*t+n)/10-1e4}function Gf(e,t,n){return 256*e+t+n/256-32768}class Wf{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,t,n,i=!1,r=!1){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return q(`"${n}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=t.height;const o=this.dim=t.height-2,s=new Uint32Array(t.data.buffer);if(this.pixels=new Uint8Array(t.data.buffer),this.encoding=n||"mapbox",this.borderReady=i,!i){for(let e=0;e<o;e++)s[this._idx(-1,e)]=s[this._idx(0,e)],s[this._idx(o,e)]=s[this._idx(o-1,e)],s[this._idx(e,-1)]=s[this._idx(e,0)],s[this._idx(e,o)]=s[this._idx(e,o-1)];s[this._idx(-1,-1)]=s[this._idx(0,0)],s[this._idx(o,-1)]=s[this._idx(o-1,0)],s[this._idx(-1,o)]=s[this._idx(0,o-1)],s[this._idx(o,o)]=s[this._idx(o-1,o-1)],r&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new $f(this)}get(e,t,n=!1){n&&(e=C(e,-1,this.dim),t=C(t,-1,this.dim));const i=4*this._idx(e,t);return("terrarium"===this.encoding?Gf:qf)(this.pixels[i],this.pixels[i+1],this.pixels[i+2])}static getUnpackVector(e){return Uf[e]}get unpackVector(){return Uf[this.encoding]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}static pack(e,t){const n=[0,0,0,0],i=Wf.getUnpackVector(t);let r=Math.floor((e+i[3])/i[2]);return n[2]=r%256,r=Math.floor(r/256),n[1]=r%256,r=Math.floor(r/256),n[0]=r,n}getPixels(){return new Fc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,t,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let i=t*this.dim,r=t*this.dim+this.dim,o=n*this.dim,s=n*this.dim+this.dim;switch(t){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:o=s-1;break;case 1:s=o+1}const a=-t*this.dim,l=-n*this.dim;for(let c=o;c<s;c++)for(let t=i;t<r;t++){const n=4*this._idx(t,c),i=4*this._idx(t+a,c+l);this.pixels[n+0]=e.pixels[i+0],this.pixels[n+1]=e.pixels[i+1],this.pixels[n+2]=e.pixels[i+2],this.pixels[n+3]=e.pixels[i+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Xr(Wf,"DEMData"),Xr($f,"DemMinMaxQuadTree",{omit:["dem"]});class Hf{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,n){const i=e.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const r={value:t,timeout:void 0};if(void 0!==n&&(r.timeout=setTimeout((()=>{this.remove(e,r)}),n)),this.data[i].push(r),this.order.push(i),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const n=e.wrapped().key,i=void 0===t?0:this.data[n].indexOf(t),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const n in this.data)for(const i of this.data[n])e(i.value)||t.push(i);for(const n of t)this.remove(n.value.tileID,n)}}class Zf{constructor(e,t,n){this.func=e,this.mask=t,this.range=n}}Zf.ReadOnly=!1,Zf.ReadWrite=!0,Zf.disabled=new Zf(519,Zf.ReadOnly,[0,1]);const Xf=7680;class Kf{constructor(e,t,n,i,r,o){this.test=e,this.ref=t,this.mask=n,this.fail=i,this.depthFail=r,this.pass=o}}Kf.disabled=new Kf({func:519,mask:0},0,0,Xf,Xf,Xf);class Jf{constructor(e,t,n){this.blendFunction=e,this.blendColor=t,this.mask=n}}Jf.Replace=[1,0],Jf.disabled=new Jf(Jf.Replace,Pt.transparent,[!1,!1,!1,!1]),Jf.unblended=new Jf(Jf.Replace,Pt.transparent,[!0,!0,!0,!0]),Jf.alphaBlended=new Jf([1,771],Pt.transparent,[!0,!0,!0,!0]);const Yf=1029,Qf=2305;class em{constructor(e,t,n){this.enable=e,this.mode=t,this.frontFace=n}}em.disabled=new em(!1,Yf,Qf),em.backCCW=new em(!0,Yf,Qf),em.backCW=new em(!0,Yf,2304),em.frontCW=new em(!0,1028,2304),em.frontCCW=new em(!0,1028,Qf);class tm extends Qe{constructor(e,t,n){super(),this.id=e,this._onlySymbols=n,t.on("data",(e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),t.on("error",(()=>{this._sourceErrored=!0})),this._source=t,this._tiles={},this._cache=new Hf(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Rf,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,t){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,(()=>{}))}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,(()=>{}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const n=this._tiles[t];n.upload(e),n.prepare(this.map.style.imageManager)}}getIds(){return P(this._tiles).map((e=>e.tileID)).sort(nm).map((e=>e.key))}getRenderableIds(e){const t=[];for(const n in this._tiles)this._isIdRenderable(+n,e)&&t.push(this._tiles[n]);return e?t.sort(((e,t)=>{const n=e.tileID,i=t.tileID,r=new v(n.canonical.x,n.canonical.y)._rotate(this.transform.angle),o=new v(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return n.overscaledZ-i.overscaledZ||o.y-r.y||o.x-r.x})).map((e=>e.tileID.key)):t.map((e=>e.tileID)).sort(nm).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,t){const n=this._tiles[e];n&&("loading"!==n.state&&(n.state=t),this._loadTile(n,this._tileLoaded.bind(this,n,e,t)))}_tileLoaded(e,t,n,i){if(i)if(e.state="errored",404!==i.status)this._source.fire(new Ye(i,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const e=this.map.painter.terrain;this.update(this.transform,e.getScaledDemTileSize(),!0),e.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Ze.now(),"expired"===n&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Je("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const t=this.getRenderableIds();for(let i=0;i<t.length;i++){const r=t[i];if(e.neighboringTiles&&e.neighboringTiles[r]){const t=this.getTileByID(r);n(e,t),n(t,e)}}function n(e,t){if(!e.dem||e.dem.borderReady)return;e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;let n=t.tileID.canonical.x-e.tileID.canonical.x;const i=t.tileID.canonical.y-e.tileID.canonical.y,r=Math.pow(2,e.tileID.canonical.z),o=t.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,n,i),e.neighboringTiles&&e.neighboringTiles[o]&&(e.neighboringTiles[o].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,n,i){for(const r in this._tiles){let o=this._tiles[r];if(i[r]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>n)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>t+1;){const e=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[e.key],o&&o.hasData()&&(s=e)}let a=s;for(;a.overscaledZ>t;)if(a=a.scaledTo(a.overscaledZ-1),e[a.key]){i[s.key]=s;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=t?n:null}for(let n=e.overscaledZ-1;n>=t;n--){const t=e.scaledTo(n),i=this._getLoadedTile(t);if(i)return i}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,t){t=t||this._source.tileSize;const n=Math.ceil(e.width/t)+1,i=Math.ceil(e.height/t)+1,r=Math.floor(n*i*5),o="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,r):r,s="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const n in this._tiles){const i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),e[i.tileID.key]=i}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(e,t,n){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!n)return;let i;this.updateCacheSize(e,t),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new fd(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(i=e.coveringTiles({tileSize:t||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(i=i.filter((e=>this._source.hasTile(e))))):i=[];const r=this._updateRetainedTiles(i);if(im(this._source.type)&&0!==i.length){const e={},t={},n=Object.keys(r);for(const i of n){const n=r[i],o=this._tiles[i];if(!o||o.fadeEndTime&&o.fadeEndTime<=Ze.now())continue;const s=this.findLoadedParent(n,Math.max(n.overscaledZ-tm.maxOverzooming,this._source.minzoom));s&&(this._addTile(s.tileID),e[s.tileID.key]=s.tileID),t[i]=n}const o=i[i.length-1].overscaledZ;for(const i in this._tiles){const e=this._tiles[i];if(r[i]||!e.hasData())continue;let n=e.tileID;for(;n.overscaledZ>o;){n=n.scaledTo(n.overscaledZ-1);const o=this._tiles[n.key];if(o&&o.hasData()&&t[n.key]){r[i]=e.tileID;break}}}for(const i in e)r[i]||(this._coveredTiles[i]=!0,r[i]=e[i])}for(const s in r)this._tiles[s].clearFadeHold();const o=function(e,t){const n=[];for(const i in e)i in t||n.push(i);return n}(this._tiles,r);for(const s of o){const e=this._tiles[s];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+s)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const t={};if(0===e.length)return t;const n={},i=e.reduce(((e,t)=>Math.min(e,t.overscaledZ)),1/0),r=e[0].overscaledZ,o=Math.max(r-tm.maxOverzooming,this._source.minzoom),s=Math.max(r+tm.maxUnderzooming,this._source.minzoom),a={};for(const l of e){const e=this._addTile(l);t[l.key]=l,e.hasData()||i<this._source.maxzoom&&(a[l.key]=l)}this._retainLoadedChildren(a,i,s,t);for(const l of e){let e=this._tiles[l.key];if(e.hasData())continue;if(l.canonical.z>=this._source.maxzoom){const e=l.children(this._source.maxzoom)[0],n=this.getTile(e);if(n&&n.hasData()){t[e.key]=e;continue}}else{const e=l.children(this._source.maxzoom);if(t[e[0].key]&&t[e[1].key]&&t[e[2].key]&&t[e[3].key])continue}let i=e.wasRequested();for(let r=l.overscaledZ-1;r>=o;--r){const o=l.scaledTo(r);if(n[o.key])break;if(n[o.key]=!0,e=this.getTile(o),!e&&i&&(e=this._addTile(o)),e&&(t[o.key]=o,i=e.wasRequested(),e.hasData()))break}}return t}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let n,i=this._tiles[e].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}t.push(i.key);const e=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(e),n)break;i=e}for(const e of t)this._loadedParentTiles[e]=n}}_addTile(e){let t=this._tiles[e.key];if(t)return t;t=this._cache.getAndRemove(e),t&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));const n=Boolean(t);if(!n){const n=this.map?this.map.painter:null;t=new Df(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,n,this._isRaster),this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))}return t?(t.uses++,this._tiles[e.key]=t,n||this._source.fire(new Je("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t):null}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),n))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,t,n){const i=[],r=this.transform;if(!r)return i;const o="globe"===r.projection.name,s=ql(r.center.lng);for(const a in this._tiles){const l=this._tiles[a];if(n&&l.clearQueryDebugViz(),l.holdingForFade())continue;let c;if(o){const e=l.tileID.canonical;if(0===e.z){const t=[Math.abs(C(s,...rm(e,-1))-s),Math.abs(C(s,...rm(e,1))-s)];c=[0,2*t.indexOf(Math.min(...t))-1]}else{const t=[Math.abs(C(s,...rm(e,-1))-s),Math.abs(C(s,...rm(e,0))-s),Math.abs(C(s,...rm(e,1))-s)];c=[t.indexOf(Math.min(...t))-1]}}else c=[0];for(const n of c){const o=e.containsTile(l,r,t,n);o&&i.push(o)}}return i}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map((e=>this._tiles[e].tileID));for(const n of t)n.projMatrix=this.transform.calculateProjMatrix(n.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(im(this._source.type))for(const e in this._tiles){const t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=Ze.now())return!0}return!1}setFeatureState(e,t,n){this._state.updateState(e=e||"_geojsonTileLayer",t,n)}removeFeatureState(e,t,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,n)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,n){const i=this._tiles[e];i&&i.setDependencies(t,n)}reloadTilesForDependencies(e,t){for(const n in this._tiles)this._tiles[n].hasDependency(e,t)&&this._reloadTile(+n,"reloading");this._cache.filter((n=>!n.hasDependency(e,t)))}_preloadTiles(e,t){if(!this._sourceLoaded){const n=()=>{this._sourceLoaded&&(this._source.off("data",n),this._preloadTiles(e,t))};return void this._source.on("data",n)}const n=new Map,i=Array.isArray(e)?e:[e],r=this.map.painter.terrain,o=this.usedForTerrain&&r?r.getScaledDemTileSize():this._source.tileSize;for(const s of i){const e=s.coveringTiles({tileSize:o,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const t of e)n.set(t.key,t);this.usedForTerrain&&s.updateElevation(!1)}A(Array.from(n.values()),((e,t)=>{const n=new Df(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(n,(e=>{"raster-dem"===this._source.type&&n.dem&&this._backfillDEM(n),t(e,n)}))}),t)}}function nm(e,t){const n=Math.abs(2*e.wrap)-+(e.wrap<0),i=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||i-n||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function im(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function rm(e,t){const n=1<<e.z;return[e.x/n+t,(e.x+1)/n+t]}tm.maxOverzooming=10,tm.maxUnderzooming=3;class om{constructor(e,t,n){this._demTile=e,this._dem=this._demTile.dem,this._scale=t,this._offset=n}static create(e,t,n){const i=n||e.findDEMTileFor(t);if(!i||!i.dem)return;const r=i.dem,o=i.tileID,s=1<<t.canonical.z-o.canonical.z;return new om(i,i.tileSize/aa/s,[(t.canonical.x/s-o.canonical.x)*r.dim,(t.canonical.y/s-o.canonical.y)*r.dim])}tileCoordToPixel(e,t){const n=t*this._scale+this._offset[1],i=Math.floor(e*this._scale+this._offset[0]),r=Math.floor(n);return new v(i,r)}getElevationAt(e,t,n,i){const r=e*this._scale+this._offset[0],o=t*this._scale+this._offset[1],s=Math.floor(r),a=Math.floor(o),l=this._dem;return i=!!i,n?On(On(l.get(s,a,i),l.get(s,a+1,i),o-a),On(l.get(s+1,a,i),l.get(s+1,a+1,i),o-a),r-s):l.get(s,a,i)}getElevationAtPixel(e,t,n){return this._dem.get(e,t,!!n)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Wl(1,e)*this._dem.stride}}class sm{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Hr(aa,16,0),this.featureIndexArray=new _s,this.promoteId=t}insert(e,t,n,i,r,o=0){const s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r,o);const a=this.grid;for(let l=0;l<t.length;l++){const e=t[l],n=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const i=e[t];n[0]=Math.min(n[0],i.x),n[1]=Math.min(n[1],i.y),n[2]=Math.max(n[2],i.x),n[3]=Math.max(n[3],i.y)}n[0]<aa&&n[1]<aa&&n[2]>=0&&n[3]>=0&&a.insert(s,n[0],n[1],n[2],n[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Wu(new gh(this.rawTileData)).layers,this.sourceLayerCoder=new _f(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,t,n,i){this.loadVTLayers();const r=e.params||{},o=dr(r.filter),s=e.tileResult,a=e.transform,l=s.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,((e,t,n,i)=>_c(s.bufferedTilespaceGeometry,e,t,n,i)));c.sort(lm);let u=null;a.elevation&&c.length>0&&(u=om.create(a.elevation,this.tileID));const d={};let h;for(let p=0;p<c.length;p++){const a=c[p];if(a===h)continue;h=a;const l=this.featureIndexArray.get(a);let f=null;this.loadMatchingFeature(d,l,o,r.layers,r.availableImages,t,n,i,((t,n,i,r=0)=>(f||(f=sc(t,this.tileID.canonical,e.tileTransform)),n.queryIntersectsFeature(s,t,i,f,this.z,e.transform,e.pixelPosMatrix,u,r))))}return d}loadMatchingFeature(e,t,n,i,r,o,s,a,l){const{featureIndex:c,bucketIndex:u,sourceLayerIndex:d,layoutVertexArrayOffset:h}=t,p=this.bucketLayerIDs[u];if(i&&!function(e,t){for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return!0;return!1}(i,p))return;const f=this.sourceLayerCoder.decode(d),m=this.vtLayers[f].feature(c);if(n.needGeometry){const e=ac(m,!0);if(!n.filter(new wo(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!n.filter(new wo(this.tileID.overscaledZ),m))return;const g=this.getId(m,f);for(let y=0;y<p.length;y++){const t=p[y];if(i&&i.indexOf(t)<0)continue;const n=o[t];if(!n)continue;let u={};void 0!==g&&a&&(u=a.getState(n.sourceLayer||"_geojsonTileLayer",g));const d=O({},s[t]);d.paint=am(d.paint,n.paint,m,u,r),d.layout=am(d.layout,n.layout,m,u,r);const f=!l||l(m,n,u,h);if(!f)continue;const v=new kf(m,this.z,this.x,this.y,g);v.layer=d;let b=e[t];void 0===b&&(b=e[t]=[]),b.push({featureIndex:c,feature:v,intersectionZ:f})}}lookupSymbolFeatures(e,t,n,i,r,o,s,a){const l={};this.loadVTLayers();const c=dr(r);for(const u of e)this.loadMatchingFeature(l,{bucketIndex:n,sourceLayerIndex:i,featureIndex:u,layoutVertexArrayOffset:0},c,o,s,a,t);return l}loadFeature(e){const{featureIndex:t,sourceLayerIndex:n}=e;this.loadVTLayers();const i=this.sourceLayerCoder.decode(n),r=this.vtFeatures[i];if(r[t])return r[t];const o=this.vtLayers[i].feature(t);return r[t]=o,o}hasLayer(e){for(const t of this.bucketLayerIDs)for(const n of t)if(e===n)return!0;return!1}getId(e,t){let n=e.id;if(this.promoteId){const i="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];null!=i&&(n=e.properties[i]),"boolean"==typeof n&&(n=Number(n))}return n}}function am(e,t,n,i,r){return $(e,((e,o)=>{const s=t instanceof Ao?t.get(o):null;return s&&s.evaluate?s.evaluate(n,i,r):s}))}function lm(e,t){return t-e}Xr(sm,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class cm{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.image=new Nc({width:e,height:t}),this.positions={},this.uploaded=!1}getDash(e,t){const n=this.getKey(e,t);return this.positions[n]}trim(){const e=this.width,t=this.height=L(this.nextRow);this.image.resize({width:e,height:t})}getKey(e,t){return e.join(",")+t}getDashRanges(e,t,n){const i=[];let r=e.length%2==1?-e[e.length-1]*n:0,o=e[0]*n,s=!0;i.push({left:r,right:o,isDash:s,zeroLength:0===e[0]});let a=e[0];for(let l=1;l<e.length;l++){s=!s;const t=e[l];r=a*n,a+=t,o=a*n,i.push({left:r,right:o,isDash:s,zeroLength:0===t})}return i}addRoundDash(e,t,n){const i=t/2;for(let r=-n;r<=n;r++){const t=this.width*(this.nextRow+n+r);let o=0,s=e[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=e[++o]);const l=Math.abs(a-s.left),c=Math.abs(a-s.right),u=Math.min(l,c);let d;const h=r/n*(i+1);if(s.isDash){const e=i-Math.abs(h);d=Math.sqrt(u*u+e*e)}else d=i-Math.sqrt(u*u+h*h);this.image.data[t+a]=Math.max(0,Math.min(255,d+128))}}}addRegularDash(e,t){for(let a=e.length-1;a>=0;--a){const t=e[a],n=e[a+1];t.zeroLength?e.splice(a,1):n&&n.isDash===t.isDash&&(n.left=t.left,e.splice(a,1))}const n=e[0],i=e[e.length-1];n.isDash===i.isDash&&(n.left=i.left-this.width,i.right=n.right+this.width);const r=this.width*this.nextRow;let o=0,s=e[o];for(let a=0;a<this.width;a++){a/s.right>1&&(s=e[++o]);const n=Math.abs(a-s.left),i=Math.abs(a-s.right),l=Math.min(n,i);this.image.data[r+a]=Math.max(0,Math.min(255,(s.isDash?l:-l)+t+128))}}addDash(e,t){const n=this.getKey(e,t);if(this.positions[n])return this.positions[n];const i="round"===t,r=i?7:0,o=2*r+1;if(this.nextRow+o>this.height)return q("LineAtlas out of space"),null;0===e.length&&e.push(1);let s=0;for(let c=0;c<e.length;c++)e[c]<0&&(q("Negative value is found in line dasharray, replacing values with 0"),e[c]=0),s+=e[c];if(0!==s){const n=this.width/s,o=this.getDashRanges(e,this.width,n);i?this.addRoundDash(o,n,r):this.addRegularDash(o,"square"===t?.5*n:0)}const a=this.nextRow+r;this.nextRow+=o;const l={tl:[a,r],br:[s,0]};return this.positions[n]=l,l}}Xr(cm,"LineAtlas");const um=1*ep;class dm{constructor(e){const t={},n=[];for(const s in e){const i=e[s],r=t[s]={};for(const e in i.glyphs){const t=i.glyphs[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const o=t.metrics.localGlyph?um:1,s={x:0,y:0,w:t.bitmap.width+2*o,h:t.bitmap.height+2*o};n.push(s),r[e]=s}}const{w:i,h:r}=wh(n),o=new Nc({width:i||1,height:r||1});for(const s in e){const n=e[s];for(const e in n.glyphs){const i=n.glyphs[+e];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const r=t[s][e],a=i.metrics.localGlyph?um:1;Nc.copy(i.bitmap,o,{x:0,y:0},{x:r.x+a,y:r.y+a},i.bitmap)}}this.image=o,this.positions=t}}Xr(dm,"GlyphAtlas");class hm{constructor(e){this.tileID=new fd(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Ap(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,t,n,i,r){this.status="parsing",this.data=e,this.collisionBoxArray=new ps;const o=new _f(Object.keys(e.layers).sort()),s=new sm(this.tileID,this.promoteId);s.bucketLayerIDs=[];const a={},l=new cm(256,256),c={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:n},u=t.familiesBySource[this.source];for(const x in u){const t=e.layers[x];if(!t)continue;let i=!1,r=!1;for(const e of u[x])"symbol"===e[0].type?i=!0:r=!0;if(!0===this.isSymbolTile&&!i)continue;if(!1===this.isSymbolTile&&!r)continue;1===t.version&&q(`Vector tile source "${this.source}" layer "${x}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const l=o.encode(x),d=[];for(let e=0;e<t.length;e++){const n=t.feature(e),i=s.getId(n,x);d.push({feature:n,id:i,index:e,sourceLayerIndex:l})}for(const e of u[x]){const t=e[0];void 0!==this.isSymbolTile&&"symbol"===t.type!==this.isSymbolTile||t.minzoom&&this.zoom<Math.floor(t.minzoom)||t.maxzoom&&this.zoom>=t.maxzoom||"none"!==t.visibility&&(pm(e,this.zoom,n),(a[t.id]=t.createBucket({index:s.bucketLayerIDs.length,layers:e,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:l,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:n})).populate(d,c,this.tileID.canonical,this.tileTransform),s.bucketLayerIDs.push(e.map((e=>e.id))))}}let d,h,p,f;l.trim();const m={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},g=()=>{if(d)return r(d);if(h&&p&&f){const e=new dm(h),t=new Sh(p,f);for(const i in a){const r=a[i];r instanceof af?(pm(r.layers,this.zoom,n),bp(r,h,e.positions,p,t.iconPositions,this.showCollisionBoxes,n,this.tileID.canonical,this.tileZoom,this.projection)):r.hasPattern&&(r instanceof Td||r instanceof Cu||r instanceof ed)&&(pm(r.layers,this.zoom,n),r.addFeatures(c,this.tileID.canonical,t.patternPositions,n,this.tileTransform))}this.status="done",r(null,{buckets:P(a).filter((e=>!e.isEmpty())),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:l,imageAtlas:t,glyphMap:this.returnDependencies?h:null,iconMap:this.returnDependencies?p:null,glyphPositions:this.returnDependencies?e.positions:null})}},y=$(c.glyphDependencies,(e=>Object.keys(e).map(Number)));Object.keys(y).length?i.send("getGlyphs",{uid:this.uid,stacks:y},((e,t)=>{d||(d=e,h=t,g())}),void 0,!1,m):h={};const v=Object.keys(c.iconDependencies);v.length?i.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"icons"},((e,t)=>{d||(d=e,p=t,g())}),void 0,!1,m):p={};const b=Object.keys(c.patternDependencies);b.length?i.send("getImages",{icons:b,source:this.source,tileID:this.tileID,type:"patterns"},((e,t)=>{d||(d=e,f=t,g())}),void 0,!1,m):f={},g()}}function pm(e,t,n){const i=new wo(t);for(const r of e)r.recalculate(i,n)}class fm{constructor(e){this.entries={},this.scheduler=e}request(e,t,n,i){const r=this.entries[e]=this.entries[e]||{callbacks:[]};if(r.result){const[e,n]=r.result;return this.scheduler?this.scheduler.add((()=>{i(e,n)}),t):i(e,n),()=>{}}return r.callbacks.push(i),r.cancel||(r.cancel=n(((n,i)=>{r.result=[n,i];for(const e of r.callbacks)this.scheduler?this.scheduler.add((()=>{e(n,i)}),t):e(n,i);setTimeout((()=>delete this.entries[e]),3e3)}))),()=>{r.result||(r.callbacks=r.callbacks.filter((e=>e!==i)),r.callbacks.length||(r.cancel(),delete this.entries[e]))}}}function mm(e,t,n){const i=JSON.stringify(e.request);return e.data&&(this.deduped.entries[i]={result:[null,e.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},(t=>{const i=he(e.request,((e,i,r,o)=>{e?t(e):i&&t(null,{vectorTile:n?void 0:new Wu(new gh(i)),rawData:i,cacheControl:r,expires:o})}));return()=>{i.cancel(),t()}}),t)}const gm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ym{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(1!==i)throw new Error(`Got v${i} data when expected v1.`);const r=gm[15&n];if(!r)throw new Error("Unrecognized array type.");const[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new ym(s,o,r,e)}constructor(e,t=64,n=Float64Array,i){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=gm.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-s%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+o+s+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+s+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return vm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:o,nodeSize:s}=this,a=[0,r.length-1,0],l=[];for(;a.length;){const c=a.pop()||0,u=a.pop()||0,d=a.pop()||0;if(u-d<=s){for(let s=d;s<=u;s++){const a=o[2*s],c=o[2*s+1];a>=e&&a<=n&&c>=t&&c<=i&&l.push(r[s])}continue}const h=d+u>>1,p=o[2*h],f=o[2*h+1];p>=e&&p<=n&&f>=t&&f<=i&&l.push(r[h]),(0===c?e<=p:t<=f)&&(a.push(d),a.push(h-1),a.push(1-c)),(0===c?n>=p:i>=f)&&(a.push(h+1),a.push(u),a.push(1-c))}return l}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:o}=this,s=[0,i.length-1,0],a=[],l=n*n;for(;s.length;){const c=s.pop()||0,u=s.pop()||0,d=s.pop()||0;if(u-d<=o){for(let n=d;n<=u;n++)wm(r[2*n],r[2*n+1],e,t)<=l&&a.push(i[n]);continue}const h=d+u>>1,p=r[2*h],f=r[2*h+1];wm(p,f,e,t)<=l&&a.push(i[h]),(0===c?e-n<=p:t-n<=f)&&(s.push(d),s.push(h-1),s.push(1-c)),(0===c?e+n>=p:t+n>=f)&&(s.push(h+1),s.push(u),s.push(1-c))}return a}}function vm(e,t,n,i,r,o){if(r-i<=n)return;const s=i+r>>1;bm(e,t,s,i,r,o),vm(e,t,n,i,s-1,1-o),vm(e,t,n,s+1,r,1-o)}function bm(e,t,n,i,r,o){for(;r>i;){if(r-i>600){const s=r-i+1,a=n-i+1,l=Math.log(s),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(s-c)/s)*(a-s/2<0?-1:1);bm(e,t,n,Math.max(i,Math.floor(n-a*c/s+u)),Math.min(r,Math.floor(n+(s-a)*c/s+u)),o)}const s=t[2*n+o];let a=i,l=r;for(xm(e,t,i,n),t[2*r+o]>s&&xm(e,t,i,r);a<l;){for(xm(e,t,a,l),a++,l--;t[2*a+o]<s;)a++;for(;t[2*l+o]>s;)l--}t[2*i+o]===s?xm(e,t,i,l):(l++,xm(e,t,l,r)),l<=n&&(i=l+1),n<=l&&(r=l-1)}}function xm(e,t,n,i){_m(e,n,i),_m(t,2*n,2*i),_m(t,2*n+1,2*i+1)}function _m(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function wm(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}e.ARRAY_TYPE=ua,e.AUTH_ERR_MSG=ve,e.Aabb=rl,e.Actor=class{constructor(e,n,i){this.target=e,this.parent=n,this.mapId=i,this.callbacks={},this.cancelCallbacks={},N(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=H()?e:t,this.scheduler=new xf}send(e,t,n,i,r=!1,o){const s=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=o,this.callbacks[s]=n);const a=K(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:e,hasCallback:!!n,targetMapId:i,mustQueue:r,sourceMapId:this.mapId,data:Yr(t,a)},a),{cancel:()=>{n&&delete this.callbacks[s],this.target.postMessage({id:s,type:"<cancel>",targetMapId:i,sourceMapId:this.mapId})}}}receive(e){const t=e.data,n=t.id;if(n&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){const e=this.cancelCallbacks[n];delete this.cancelCallbacks[n],e&&e.cancel()}else if(t.mustQueue||H()){const e=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add((()=>this.processTask(n,t)),e&&e.metadata||{type:"message"})}else this.processTask(n,t)}processTask(e,t){if("<response>"===t.type){const n=this.callbacks[e];delete this.callbacks[e],n&&(t.error?n(Qr(t.error)):n(null,Qr(t.data)))}else{const n=K(this.globalScope)?void 0:[],i=t.hasCallback?(t,i)=>{delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?Yr(t):null,data:Yr(i,n)},n)}:e=>{},r=Qr(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,r,i);else if(this.parent.getWorkerSource){const e=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,e[0],r.source)[e[1]](r,i)}else i(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},e.CanonicalTileID=hd,e.Color=Pt,e.ColorMode=Jf,e.CullFaceMode=em,e.DEMData=Wf,e.DataConstantProperty=Po,e.DedupedRequest=fm,e.DepthMode=Zf,e.EXTENT=aa,e.Elevation=class{isDataAvailableAtPoint(e){const t=this._source();if(this.isUsingMockSource()||!t||e.y<0||e.y>1)return!1;const n=t.getSource().maxzoom,i=1<<n,r=Math.floor(e.x),o=Math.floor((e.x-r)*i),s=Math.floor(e.y*i),a=this.findDEMTileFor(new fd(n,r,n,o,s));return!(!a||!a.dem)}getAtPointOrZero(e,t=0){return this.getAtPoint(e,t)||0}getAtPoint(e,t,n=!0){if(this.isUsingMockSource())return null;null==t&&(t=null);const i=this._source();if(!i)return t;if(e.y<0||e.y>1)return t;const r=i.getSource().maxzoom,o=1<<r,s=Math.floor(e.x),a=e.x-s,l=new fd(r,s,r,Math.floor(a*o),Math.floor(e.y*o)),c=this.findDEMTileFor(l);if(!c||!c.dem)return t;const u=c.dem,d=1<<c.tileID.canonical.z,h=(a*d-c.tileID.canonical.x)*u.dim,p=(e.y*d-c.tileID.canonical.y)*u.dim,f=Math.floor(h),m=Math.floor(p);return(n?this.exaggeration():1)*On(On(u.get(f,m),u.get(f,m+1),p-m),On(u.get(f+1,m),u.get(f+1,m+1),p-m),h-f)}getAtTileOffset(e,t,n){const i=1<<e.canonical.z;return this.getAtPointOrZero(new Yl(e.wrap+(e.canonical.x+t/aa)/i,(e.canonical.y+n/aa)/i))}getAtTileOffsetFunc(e,t,n,i){return r=>{const o=this.getAtTileOffset(e,r.x,r.y),s=i.upVector(e.canonical,r.x,r.y);return Oa(s,s,o*i.upVectorScale(e.canonical,t,n).metersToTile),s}}getForTilePoints(e,t,n,i){if(this.isUsingMockSource())return!1;const r=om.create(this,e,i);return!!r&&(t.forEach((e=>{e[2]=this.exaggeration()*r.getElevationAt(e[0],e[1],n)})),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(e);if(!t||!t.dem)return null;const n=t.dem.tree,i=t.tileID,r=1<<e.canonical.z-i.canonical.z;let o=e.canonical.x/r-i.canonical.x,s=e.canonical.y/r-i.canonical.y,a=0;for(let l=0;l<e.canonical.z-i.canonical.z&&!n.leaves[a];l++){o*=2,s*=2;const e=2*Math.floor(s)+Math.floor(o);a=n.childOffsets[a]+e,o%=1,s%=1}return{min:this.exaggeration()*n.minimums[a],max:this.exaggeration()*n.maximums[a]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,t,n){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},e.ErrorEvent=Ye,e.EvaluationParameters=wo,e.Event=Je,e.Evented=Qe,e.FillExtrusionBucket=ed,e.Frustum=il,e.FrustumCorners=nl,e.GLOBE_RADIUS=al,e.GLOBE_SCALE_MATCH_LATITUDE=45,e.GLOBE_ZOOM_THRESHOLD_MAX=sl,e.GLOBE_ZOOM_THRESHOLD_MIN=ol,e.GlobeSharedBuffers=class{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const e of this._wireframeSegments)e.destroy()}}_fillGridMeshWithLods(e,t){const n=new jo,i=new is,r=[],o=e+1+2,s=t[0]+1,a=t[0]+1+(1+t.length),l=(e,t,n)=>{let i=e===o-1?e-2:0===e?e:e-1;return i+=n?24575:0,[i,t]};for(let c=0;c<o;++c)n.emplaceBack(...l(c,0,!0));for(let c=0;c<s;++c)for(let e=0;e<o;++e)n.emplaceBack(...l(e,c,(0===e||e===o-1)&&!0));for(let c=0;c<t.length;++c){const e=t[c];for(let t=0;t<o;++t)n.emplaceBack(...l(t,e,!0))}for(let c=0;c<t.length;++c){const e=i.length,s=t[c]+1+2,l=new is;for(let n=0;n<s-1;n++){const e=n===s-2,r=e?o*(a-t.length+c-n):o;for(let t=0;t<o-1;t++){const s=n*o+t;0===n||e||0===t||t===o-2?(l.emplaceBack(s+1,s,s+r),l.emplaceBack(s+r,s+r+1,s+1)):(i.emplaceBack(s+1,s,s+r),i.emplaceBack(s+r,s+r+1,s+1))}}const u=sa.simpleSegment(0,e,n.length,i.length-e);for(let t=0;t<l.uint16.length;t+=3)i.emplaceBack(l.uint16[t],l.uint16[t+1],l.uint16[t+2]);const d=sa.simpleSegment(0,e,n.length,i.length-e);r.push({withoutSkirts:u,withSkirts:d})}return{vertices:n,indices:i,segments:r}}_createGrid(e){const t=this._fillGridMeshWithLods(cl,ul);this._gridSegments=t.segments,this._gridBuffer=e.createVertexBuffer(t.vertices,el.members),this._gridIndexBuffer=e.createIndexBuffer(t.indices,!0)}_createPoles(e){const t=new is;for(let r=0;r<=cl;r++)t.emplaceBack(0,r+1,r+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);const n=new as,i=new as;this._poleSegments=[];for(let r=0,o=0;r<ol;r++){const e=360/(1<<r);n.emplaceBack(0,-al,0,.5,0),i.emplaceBack(0,-al,0,.5,1);for(let t=0;t<=cl;t++){const r=t/cl,o=On(0,e,r),[s,a,l]=Sl(Bl,Nl,o,al);n.emplaceBack(s,a,l,r,0),i.emplaceBack(s,a,l,r,1)}this._poleSegments.push(sa.simpleSegment(o,0,66,64)),o+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(n,Ya,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(i,Ya,!1)}getGridBuffers(e,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}getWirefameBuffers(e,t){if(!this._wireframeSegments){const t=new cs,n=cl,i=n+1+2,r=1;this._wireframeSegments=[];for(let e=0,o=0;e<ul.length;e++){const s=ul[e];for(let e=r;e<s+r;e++)for(let o=r;o<n+r;o++){const n=e*i+o;t.emplaceBack(n,n+1),t.emplaceBack(n,n+i),t.emplaceBack(n,n+i+1)}const a=s*n*3;this._wireframeSegments.push(sa.simpleSegment(0,o,(s+1)*i,a)),o+=a}this._wireframeIndexBuffer=e.createIndexBuffer(t)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},e.GlyphManager=np,e.ImagePosition=Eh,e.KDBush=ym,e.LivePerformanceUtils=$e,e.LngLat=Vl,e.LngLatBounds=la,e.LocalGlyphMode=tp,e.MAX_MERCATOR_LATITUDE=Kl,e.MercatorCoordinate=Yl,e.ONE_EM=Nd,e.OverscaledTileID=fd,e.PerformanceMarkers=Fe,e.Point=v,e.Properties=Ro,e.RGBAImage=Fc,e.Ray=tl,e.RequestManager=class{constructor(e,t,n){this._transformRequestFn=e,this._customAccessToken=t,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const e=function(){let e="";for(let t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",d,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeStyleURL(e,t){if(!be(e))return e;const n=Se(e);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||t)}normalizeGlyphsURL(e,t){if(!be(e))return e;const n=Se(e);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||t)}normalizeSourceURL(e,t,n,i){if(!be(e))return e;const r=Se(e);return r.path=`/v4/${r.authority}.json`,r.params.push("secure"),n&&r.params.push(`language=${n}`),i&&r.params.push(`worldview=${i}`),this._makeAPIURL(r,this._customAccessToken||t)}normalizeSpriteURL(e,t,n,i){const r=Se(e);return be(e)?(r.path=`/styles/v1${r.path}/sprite${t}${n}`,this._makeAPIURL(r,this._customAccessToken||i)):(r.path+=`${t}${n}`,Te(r))}normalizeTileURL(e,t,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!be(e))return e;const i=Se(e);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||n&&"raster"!==i.authority&&512===n?"@2x":""}${o.supported?".webp":"$1"}`),"raster"===i.authority?i.path=`/${r.RASTER_URL_PREFIX}${i.path}`:(i.path=i.path.replace(/^.+\/v4\//,"/"),i.path=`/${r.TILE_URL_VERSION}${i.path}`);const s=this._customAccessToken||function(e){for(const t of e){const e=t.match(/^access_token=(.*)$/);if(e)return e[1]}return null}(i.params)||r.ACCESS_TOKEN;return r.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&i.params.push(`sku=${this._skuToken}`),this._makeAPIURL(i,s)}canonicalizeTileURL(e,t){const n=Se(e);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return e;let i="mapbox://";n.path.match(/^\/raster\/v1\//)?i+=`raster/${n.path.replace(`/${r.RASTER_URL_PREFIX}/`,"")}`:i+=`tiles/${n.path.replace(`/${r.TILE_URL_VERSION}/`,"")}`;let o=n.params;return t&&(o=o.filter((e=>!e.match(/^access_token=/)))),o.length&&(i+=`?${o.join("&")}`),i}canonicalizeTileset(e,t){const n=!!t&&be(t),i=[];for(const r of e.tiles||[])xe(r)?i.push(this.canonicalizeTileURL(r,n)):i.push(r);return i}_makeAPIURL(e,t){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",i=Se(r.API_URL);if(e.protocol=i.protocol,e.authority=i.authority,"http"===e.protocol){const t=e.params.indexOf("secure");t>=0&&e.params.splice(t,1)}if("/"!==i.path&&(e.path=`${i.path}${e.path}`),!r.REQUIRE_ACCESS_TOKEN)return Te(e);if(t=t||r.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if("s"===t[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return e.params=e.params.filter((e=>-1===e.indexOf("access_token"))),e.params.push(`access_token=${t||""}`),Te(e)}},e.ResourceType=le,e.SegmentVector=sa,e.SourceCache=tm,e.StencilMode=Kf,e.StructArrayLayout1ui2=us,e.StructArrayLayout2f1f2i16=es,e.StructArrayLayout2i4=jo,e.StructArrayLayout2ui4=cs,e.StructArrayLayout3f12=ns,e.StructArrayLayout3ui6=is,e.StructArrayLayout4i8=Uo,e.StructArrayLayout5f20=as,e.Texture=vf,e.Tile=Df,e.Transitionable=So,e.Uniform1f=Bs,e.Uniform1i=class extends Ls{constructor(e){super(e),this.current=0}set(e,t,n){this.fetchUniformLocation(e,t)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},e.Uniform2f=class extends Ls{constructor(e){super(e),this.current=[0,0]}set(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},e.Uniform3f=class extends Ls{constructor(e){super(e),this.current=[0,0,0]}set(e,t,n){this.fetchUniformLocation(e,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},e.Uniform4f=Ns,e.UniformColor=Fs,e.UniformMatrix2f=class extends Ls{constructor(e){super(e),this.current=Vs}set(e,t,n){if(this.fetchUniformLocation(e,t))for(let i=0;i<4;i++)if(n[i]!==this.current[i]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},e.UniformMatrix3f=class extends Ls{constructor(e){super(e),this.current=js}set(e,t,n){if(this.fetchUniformLocation(e,t))for(let i=0;i<9;i++)if(n[i]!==this.current[i]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},e.UniformMatrix4f=class extends Ls{constructor(e){super(e),this.current=$s}set(e,t,n){if(this.fetchUniformLocation(e,t)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},e.UnwrappedTileID=pd,e.ValidationError=nr,e.VectorTileFeature=Hu,e.VectorTileWorkerSource=class extends Qe{constructor(e,t,n,i,r){super(),this.actor=e,this.layerIndex=t,this.availableImages=n,this.loadVectorData=r||mm,this.loading={},this.loaded={},this.deduped=new fm(e.scheduler),this.isSpriteLoaded=i,this.scheduler=e.scheduler}loadTile(e,t){const n=e.uid,i=e&&e.request,r=i&&i.collectResourceTiming,o=this.loading[n]=new hm(e);o.abort=this.loadVectorData(e,((s,a)=>{const l=!this.loading[n];if(delete this.loading[n],l||s||!a)return o.status="done",l||(this.loaded[n]=o),t(s);const c=a.rawData,u={};a.expires&&(u.expires=a.expires),a.cacheControl&&(u.cacheControl=a.cacheControl),o.vectorTile=a.vectorTile||new Wu(new gh(c));const d=()=>{o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,((e,n)=>{if(e||!n)return t(e);const o={};if(r){const e=Ue(i);e.length>0&&(o.resourceTiming=JSON.parse(JSON.stringify(e)))}t(null,O({rawTileData:c.slice(0)},n,u,o))}))};this.isSpriteLoaded?d():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(d,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):d()})),this.loaded=this.loaded||{},this.loaded[n]=o}))}reloadTile(e,t){const n=this.loaded,i=e.uid,r=this;if(n&&n[i]){const o=n[i];o.showCollisionBoxes=e.showCollisionBoxes,o.enableTerrain=!!e.enableTerrain,o.projection=e.projection,o.tileTransform=Ap(e.tileID.canonical,e.projection);const s=(e,n)=>{const i=o.reloadCallback;i&&(delete o.reloadCallback,o.parse(o.vectorTile,r.layerIndex,this.availableImages,r.actor,i)),t(e,n)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}abortTile(e,t){const n=e.uid,i=this.loading[n];i&&(i.abort&&i.abort(),delete this.loading[n]),t()}removeTile(e,t){const n=this.loaded,i=e.uid;n&&n[i]&&delete n[i],t()}},e.WritingMode=Th,e.ZoomDependentExpression=Yi,e.add=Ca,e.addDynamicAttributes=nf,e.adjoint=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e[0]=s*u-a*c,e[1]=r*c-i*u,e[2]=i*a-r*s,e[3]=a*l-o*u,e[4]=n*u-r*l,e[5]=r*o-n*a,e[6]=o*c-s*l,e[7]=i*l-n*c,e[8]=n*s-i*o,e},e.asyncAll=A,e.bezier=S,e.bindAll=N,e.boundsAttributes=Pf,e.bufferConvexPolygon=function(e,t){const n=[];for(let i=0;i<e.length;i++){const r=I(i-1,-1,e.length-1),o=I(i+1,-1,e.length-1),s=e[i],a=e[o],l=e[r].sub(s).unit(),c=a.sub(s).unit(),u=c.angleWithSep(l.x,l.y),d=l.add(c).unit().mult(-1*t/Math.sin(u/2));n.push(s.add(d))}return n},e.cacheEntryPossiblyAdded=function(e){ae++,ae>ie&&(e.getActor().send("enforceCacheSizeLimit",ne),ae=0)},e.calculateGlobeLabelMatrix=function(e,t){const{x:n,y:i}=e.point,r=Ol(n,i,e.worldSize/e._pixelsPerMercatorPixel,0,0);return ma(r,r,Pl(vl(t)))},e.calculateGlobeMatrix=function(e){const{x:t,y:n}=e.point,{lng:i,lat:r}=e._center;return Ol(t,n,e.worldSize,i,r)},e.calculateGlobeMercatorMatrix=function(e){const t=e.pixelsPerMeter,n=t/Wl(1,e.center.lat),i=pa(new Float64Array(16));return ga(i,i,[e.point.x,e.point.y,0]),ya(i,i,[n,n,t]),Float32Array.from(i)},e.circumferenceAtLatitude=Ul,e.clamp=C,e.clearTileCache=function(e){if(!re())return;const n=t.caches.delete(Q);e&&n.catch(e).then((()=>e()))},e.clipLine=Kh,e.clone=function(e){var t=new ua(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=V,e.collisionCircleLayout=Bd,e.config=r,e.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.create=function(){var e=new ua(16);return ua!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=da,e.createExpression=Ki,e.createLayout=Fo,e.createStyleLayer=function(e){return"custom"===e.type?new ff(e):new yf[e.type](e)},e.cross=La,e.degToRad=_,e.distance=function(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])},e.div=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},e.dot=za,e.earthRadius=Fl,e.ease=T,e.easeCubicInOut=E,e.ecefToLatLng=function([e,t,n]){const i=Math.hypot(e,t,n),r=Math.atan2(e,n),o=.5*Math.PI-Math.acos(-t/i);return new Vl(w(r),w(o))},e.emitValidationErrors=Ur,e.endsWith=F,e.enforceCacheSizeLimit=function(e){oe(),ee&&ee.then((t=>{t.keys().then((n=>{for(let i=0;i<n.length-e;i++)t.delete(n[i])}))}))},e.evaluateSizeForFeature=jd,e.evaluateSizeForZoom=Vd,e.evaluateVariableOffset=vp,e.evented=vo,e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exactEquals$1=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.exported=Ze,e.exported$1=o,e.extend=O,e.extend$1=tt,e.fillExtrusionHeightLift=ad,e.filterObject=j,e.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.fromQuat=function(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n+n,a=i+i,l=r+r,c=n*s,u=i*s,d=i*a,h=r*s,p=r*a,f=r*l,m=o*s,g=o*a,y=o*l;return e[0]=1-d-f,e[1]=u+y,e[2]=h-g,e[3]=0,e[4]=u-y,e[5]=1-c-f,e[6]=p+m,e[7]=0,e[8]=h+g,e[9]=p-m,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.fromRotation=function(e,t){var n=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=n,e[2]=0,e[3]=-n,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=xa,e.furthestTileCorner=function(e){const t=Math.round((e+45+360)%360/90)%4;return k[t]},e.getAABBPointSquareDist=function(e,t,n){let i=0;for(let r=0;r<2;++r){const o=n?n[r]:0;e[r]>o&&(i+=(e[r]-o)*(e[r]-o)),t[r]<o&&(i+=(o-t[r])*(o-t[r]))}return i},e.getAnchorAlignment=Nh,e.getAnchorJustification=xp,e.getBounds=function(e){let t=1/0,n=1/0,i=-1/0,r=-1/0;for(const o of e)t=Math.min(t,o.x),n=Math.min(n,o.y),i=Math.max(i,o.x),r=Math.max(r,o.y);return{min:new v(t,n),max:new v(i,r)}},e.getColumn=Y,e.getDefaultExportFromCjs=h,e.getGridMatrix=function(e,t,n,i){const r=t.getNorth(),o=t.getSouth(),s=t.getWest(),a=t.getEast(),l=1<<e.z,c=a-s,u=r-o,d=c/cl,h=-u/ul[n],p=[0,d,0,h,0,0,r,s,0];if(e.z>0){const e=180/i;ha(p,p,[e/c+1,0,0,0,e/u+1,0,-.5*e/d,.5*e/h,1])}return p[2]=l,p[5]=e.x,p[8]=e.y,p},e.getImage=ye,e.getJSON=function(e,t){return de(O(e,{type:"json"}),t)},e.getLatitudinalLod=function(e){const t=Kl-5;e=C(e,-t,t)/t*90;const n=Math.pow(Math.abs(Math.sin(_(e))),3);return Math.round(n*(ul.length-1))},e.getMapSessionAPI=Be,e.getPerformanceMeasurement=Ue,e.getProjection=Jp,e.getRTLTextPluginStatus=bo,e.getReferrer=ue,e.getTilePoint=function(e,{x:t,y:n},i=0){return new v(((t-i)*e.scale-e.x)*aa,(n*e.scale-e.y)*aa)},e.getTileVec3=function(e,t,n=0){return Ta(((t.x-n)*e.scale-e.x)*aa,(t.y*e.scale-e.y)*aa,Xl(t.z,t.y))},e.getVideo=function(e,n){const i=t.document.createElement("video");i.muted=!0,i.onloadstart=function(){n(null,i)};for(let r=0;r<e.length;r++){const n=t.document.createElement("source");pe(e[r])||(i.crossOrigin="Anonymous"),n.src=e[r],i.appendChild(n)}return{cancel:()=>{}}},e.globeCenterToScreenPoint=function(e){const t=[0,0,0],n=pa(new Float64Array(16));return ma(n,e.pixelMatrix,e.globeMatrix),Ba(t,t,n),new v(t[0],t[1])},e.globeDenormalizeECEF=Pl,e.globeECEFOrigin=function(e,t){const n=[0,0,0];return Ba(n,n,Al(vl(t.canonical))),Ba(n,n,e),n},e.globeMetersToEcef=fl,e.globeNormalizeECEF=Al,e.globePixelsToTileUnits=function(e,t){return aa/(512*Math.pow(2,e))*Ml(vl(t))},e.globePoleMatrixForTile=function(e,t,n){const i=pa(new Float64Array(16)),r=(t/(1<<e)-.5)*Math.PI*2;return ba(i,n.globeMatrix,r),Float32Array.from(i)},e.globeTileBounds=vl,e.globeTiltAtLngLat=Rl,e.globeToMercatorTransition=Dl,e.globeUseCustomAntiAliasing=function(e,t,n){const i=Dl(n.zoom),r=e.style.map._antialias,o=!!t.extStandardDerivatives,s=t.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===i&&!r&&!s&&o},e.identity=pa,e.identity$1=Ha,e.invert=fa,e.isFullscreen=function(){return!!t.document.fullscreenElement||!!t.document.webkitFullscreenElement},e.isLngLatBehindGlobe=zl,e.isMapAuthenticated=function(e){return Ne.has(e)},e.isMapboxURL=be,e.isSafariWithAntialiasingBug=function(e){const t=e.navigator?e.navigator.userAgent:null;return!!K(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.latFromMercatorY=Zl,e.latLngToECEF=Tl,e.len=Va,e.length=Sa,e.length$1=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},e.lngFromMercatorX=Hl,e.loadVectorTile=mm,e.makeRequest=de,e.mapValue=function(e,t,n,i,r){return C((e-t)/(n-t)*(r-i)+i,i,r)},e.mercatorScale=Jl,e.mercatorXfromLng=ql,e.mercatorYfromLat=Gl,e.mercatorZfromAltitude=Wl,e.mul=wa,e.mul$1=ja,e.multiply=ma,e.multiply$1=ha,e.multiply$2=Ia,e.nextPowerOfTwo=L,e.normalize=Ra,e.normalize$1=Ka,e.normalize$2=qa,e.number=On,e.ortho=function(e,t,n,i,r,o,s){var a=1/(t-n),l=1/(i-r),c=1/(o-s);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*a,e[13]=(r+i)*l,e[14]=(s+o)*c,e[15]=1,e},e.pbf=Zd,e.perspective=function(e,t,n,i,r){var o,s=1/Math.tan(t/2);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0?(e[10]=(r+i)*(o=1/(i-r)),e[14]=2*r*i*o):(e[10]=-1,e[14]=-2*i),e},e.pick=function(e,t){const n={};for(let i=0;i<t.length;i++){const r=t[i];r in e&&(n[r]=e[r])}return n},e.plugin=_o,e.pointGeometry=g,e.polesInViewport=function(e){const t=pa(new Float64Array(16));ma(t,e.pixelMatrix,e.globeMatrix);const n=[0,dl,0],i=[0,hl,0];return Ba(n,n,t),Ba(i,i,t),[n[0]>0&&n[0]<=e.width&&n[1]>0&&n[1]<=e.height&&!zl(e,new Vl(e.center.lat,90)),i[0]>0&&i[0]<=e.width&&i[1]>0&&i[1]<=e.height&&!zl(e,new Vl(e.center.lat,-90))]},e.polygonContainsPoint=xc,e.polygonIntersectsBox=_c,e.polygonIntersectsPolygon=dc,e.polygonizeBounds=function(e,t,n=0,i=!0){const r=new v(n,n),o=e.sub(r),s=t.add(r),a=[o,new v(s.x,o.y),s,new v(o.x,s.y)];return i&&a.push(o.clone()),a},e.posAttributes=el,e.postMapLoadEvent=De,e.postPerformanceEvent=ze,e.postTurnstileEvent=Pe,e.potpack=wh,e.prevPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.radToDeg=w,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.registerForPluginStateChange=function(e){return e({pluginStatus:fo,pluginURL:mo}),vo.on("pluginStateChange",e),e},e.removeAuthState=function(e){Ne.delete(e)},e.renderColorRamp=jc,e.resample=ec,e.rotateX=va,e.rotateX$1=Za,e.rotateY=ba,e.rotateY$1=Xa,e.rotateZ=function(e,t,n){var i=Math.sin(n),r=Math.cos(n),o=t[0],s=t[1],a=t[2],l=t[3],c=t[4],u=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*r+c*i,e[1]=s*r+u*i,e[2]=a*r+d*i,e[3]=l*r+h*i,e[4]=c*r-o*i,e[5]=u*r-s*i,e[6]=d*r-a*i,e[7]=h*r-l*i,e},e.rotateZ$1=function(e,t,n){n*=.5;var i=t[0],r=t[1],o=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);return e[0]=i*l+r*a,e[1]=r*l-i*a,e[2]=o*l+s*a,e[3]=s*l-o*a,e},e.scale=ya,e.scale$1=Ua,e.scale$2=Oa,e.scaleAndAdd=Da,e.set=function(e,t,n,i){return e[0]=t,e[1]=n,e[2]=i,e},e.setCacheLimits=function(e,t){ne=e,ie=t},e.setColumn=function(e,t,n){e[4*t+0]=n[0],e[4*t+1]=n[1],e[4*t+2]=n[2],e[4*t+3]=n[3]},e.setRTLTextPlugin=function(e,t,n=!1){if(fo===co||fo===uo||fo===ho)throw new Error("setRTLTextPlugin cannot be called multiple times.");mo=Ze.resolveURL(e),fo=co,po=t,yo(),n||xo()},e.smoothstep=M,e.spec=et,e.squaredLength=function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i},e.storeAuthState=function(e,t){t?Ne.add(e):Ne.delete(e)},e.sub=$a,e.subtract=Ma,e.symbolSize=Ud,e.tileAABB=function(e,t,n,i,r,o,s,a,l){if("globe"===l.name)return wl(e,t,new hd(n,i,r));const c=Ap({z:n,x:i,y:r},l);return new rl([(o+c.x/c.scale)*t,t*(c.y/c.scale),s],[(o+c.x2/c.scale)*t,t*(c.y2/c.scale),a])},e.tileCornersToBounds=kl,e.tileTransform=Ap,e.transformMat3=function(e,t,n){var i=t[0],r=t[1],o=t[2];return e[0]=i*n[0]+r*n[3]+o*n[6],e[1]=i*n[1]+r*n[4]+o*n[7],e[2]=i*n[2]+r*n[5]+o*n[8],e},e.transformMat4=Ba,e.transformMat4$1=Ga,e.transformQuat=Na,e.transitionTileAABBinECEF=xl,e.translate=ga,e.transpose=function(e,t){if(e===t){var n=t[1],i=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},e.triggerPluginCompletionEvent=go,e.uniqueId=R,e.updateGlobeVertexNormal=function(e,t,n,i,r){const o=5*t+2;e.float32[o+0]=n,e.float32[o+1]=i,e.float32[o+2]=r},e.validateCustomStyleLayer=function(e){const t=[],n=e.id;return void 0===n&&t.push({message:`layers.${n}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${n}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},e.validateFilter=e=>Vr(kr(e)),e.validateFog=e=>Vr(zr(e)),e.validateLayer=e=>Vr(Mr(e)),e.validateLight=e=>Vr(Dr(e)),e.validateSource=e=>Vr(Pr(e)),e.validateStyle=Fr,e.validateTerrain=e=>Vr(Rr(e)),e.values=P,e.vectorTile=Ru,e.version=n,e.warnOnce=q,e.window=t,e.wrap=I})),i(["./shared"],(function(e){function t(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){let n="[";for(const i of e)n+=`${t(i)},`;return`${n}]`}let n="{";for(const i of Object.keys(e).sort())n+=`${i}:${t(e[i])},`;return`${n}}`}function n(n){let i="";for(const r of e.refProperties)i+=`/${t(n[r])}`;return i}class i{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,i){for(const n of t)this._layerConfigs[n.id]=n,(this._layers[n.id]=e.createStyleLayer(n)).compileFilter(),this.keyCache[n.id]&&delete this.keyCache[n.id];for(const e of i)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const r=function(e,t){const i={};for(let o=0;o<e.length;o++){const r=t&&t[e[o].id]||n(e[o]);t&&(t[e[o].id]=r);let s=i[r];s||(s=i[r]=[]),s.push(e[o])}const r=[];for(const n in i)r.push(i[n]);return r}(e.values(this._layerConfigs),this.keyCache);for(const e of r){const t=e.map((e=>this._layers[e.id])),n=t[0];if("none"===n.visibility)continue;const i=n.source||"";let r=this.familiesBySource[i];r||(r=this.familiesBySource[i]={});const o=n.sourceLayer||"_geojsonTileLayer";let s=r[o];s||(s=r[o]=[]),s.push(t)}}}class r{loadTile(t,n){const{uid:i,encoding:r,rawImageData:o,padding:s,buildQuadTree:a}=t,l=e.window.ImageBitmap&&o instanceof e.window.ImageBitmap?this.getImageData(o,s):o;n(null,new e.DEMData(i,l,r,s<1,a))}getImageData(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const n=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),n}}function o(e,t){if(0!==e.length){s(e[0],t);for(var n=1;n<e.length;n++)s(e[n],!t)}}function s(e,t){for(var n=0,i=0,r=0,o=e.length,s=o-1;r<o;s=r++){var a=(e[r][0]-e[s][0])*(e[s][1]+e[r][1]),l=n+a;i+=Math.abs(n)>=Math.abs(a)?n-l+a:a-l+n,n=l}n+i>=0!=!!t&&e.reverse()}var a=e.getDefaultExportFromCjs((function e(t,n){var i,r=t&&t.type;if("FeatureCollection"===r)for(i=0;i<t.features.length;i++)e(t.features[i],n);else if("GeometryCollection"===r)for(i=0;i<t.geometries.length;i++)e(t.geometries[i],n);else if("Feature"===r)e(t.geometry,n);else if("Polygon"===r)o(t.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<t.coordinates.length;i++)o(t.coordinates[i],n);return t}));const l=e.VectorTileFeature.prototype.toGeoJSON;var c={exports:{}},u=e.pointGeometry,d=e.vectorTile.VectorTileFeature,h=p;function p(e,t){this.options=t||{},this.features=e,this.length=e.length}function f(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}p.prototype.feature=function(e){return new f(this.features[e],this.options.extent)},f.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var n=e[t],i=[],r=0;r<n.length;r++)i.push(new u(n[r][0],n[r][1]));this.geometry.push(i)}return this.geometry},f.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,n=-1/0,i=1/0,r=-1/0,o=0;o<e.length;o++)for(var s=e[o],a=0;a<s.length;a++){var l=s[a];t=Math.min(t,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[t,i,n,r]},f.prototype.toGeoJSON=d.prototype.toGeoJSON;var m=e.pbf,g=h;function y(e){var t=new m;return function(e,t){for(var n in e.layers)t.writeMessage(3,v,e.layers[n])}(e,t),t.finish()}function v(e,t){var n;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<e.length;n++)i.feature=e.feature(n),t.writeMessage(2,b,i);var r=i.keys;for(n=0;n<r.length;n++)t.writeStringField(3,r[n]);var o=i.values;for(n=0;n<o.length;n++)t.writeMessage(4,E,o[n])}function b(e,t){var n=e.feature;void 0!==n.id&&t.writeVarintField(1,n.id),t.writeMessage(2,x,e),t.writeVarintField(3,n.type),t.writeMessage(4,k,n)}function x(e,t){var n=e.feature,i=e.keys,r=e.values,o=e.keycache,s=e.valuecache;for(var a in n.properties){var l=n.properties[a],c=o[a];if(null!==l){void 0===c&&(i.push(a),o[a]=c=i.length-1),t.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var d=u+":"+l,h=s[d];void 0===h&&(r.push(l),s[d]=h=r.length-1),t.writeVarint(h)}}}function _(e,t){return(t<<3)+(7&e)}function w(e){return e<<1^e>>31}function k(e,t){for(var n=e.loadGeometry(),i=e.type,r=0,o=0,s=n.length,a=0;a<s;a++){var l=n[a],c=1;1===i&&(c=l.length),t.writeVarint(_(1,c));for(var u=3===i?l.length-1:l.length,d=0;d<u;d++){1===d&&1!==i&&t.writeVarint(_(2,u-1));var h=l[d].x-r,p=l[d].y-o;t.writeVarint(w(h)),t.writeVarint(w(p)),r+=h,o+=p}3===i&&t.writeVarint(_(7,1))}}function E(e,t){var n=typeof e;"string"===n?t.writeStringField(1,e):"boolean"===n?t.writeBooleanField(7,e):"number"===n&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}c.exports=y,c.exports.fromVectorTileJs=y,c.exports.fromGeojsonVt=function(e,t){t=t||{};var n={};for(var i in e)n[i]=new g(e[i].features,t),n[i].name=i,n[i].version=t.version,n[i].extent=t.extent;return y({layers:n})},c.exports.GeoJSONWrapper=g;var S=e.getDefaultExportFromCjs(c.exports);const T={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},C=Math.fround||(M=new Float32Array(1),e=>(M[0]=+e,M[0]));var M;const I=3,A=5,P=6;class O{constructor(e){this.options=Object.assign(Object.create(T),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:i}=this.options;t&&console.time("total time");const r=`prepare ${e.length} points`;t&&console.time(r),this.points=e;const o=[];for(let a=0;a<e.length;a++){const t=e[a];if(!t.geometry)continue;const[n,i]=t.geometry.coordinates,r=C(z(n)),s=C(L(i));o.push(r,s,1/0,a,-1,1),this.options.reduce&&o.push(0)}let s=this.trees[i+1]=this._createTree(o);t&&console.timeEnd(r);for(let a=i;a>=n;a--){const e=+Date.now();s=this.trees[a]=this._createTree(this._cluster(s,a)),t&&console.log("z%d: %d clusters in %dms",a,s.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,e[1]));let r=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,r=180;else if(n>r){const e=this.getClusters([n,i,180,o],t),s=this.getClusters([-180,i,r,o],t);return e.concat(s)}const s=this.trees[this._limitZoom(t)],a=s.range(z(n),L(o),z(r),L(i)),l=s.data,c=[];for(const u of a){const e=this.stride*u;c.push(l[e+A]>1?D(l,e,this.clusterProps):this.points[l[e+I]])}return c}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);const o=r.data;if(t*this.stride>=o.length)throw new Error(i);const s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),a=r.within(o[t*this.stride],o[t*this.stride+1],s),l=[];for(const c of a){const t=c*this.stride;o[t+4]===e&&l.push(o[t+A]>1?D(o,t,this.clusterProps):this.points[o[t+I]])}if(0===l.length)throw new Error(i);return l}getLeaves(e,t,n){const i=[];return this._appendLeaves(i,e,t=t||10,n=n||0,0),i}getTile(e,t,n){const i=this.trees[this._limitZoom(e)],r=Math.pow(2,e),{extent:o,radius:s}=this.options,a=s/o,l=(n-a)/r,c=(n+1+a)/r,u={features:[]};return this._addTileFeatures(i.range((t-a)/r,l,(t+1+a)/r,c),i.data,t,n,r,u),0===t&&this._addTileFeatures(i.range(1-a/r,l,1,c),i.data,r,n,r,u),t===r-1&&this._addTileFeatures(i.range(0,l,a/r,c),i.data,-1,n,r,u),u.features.length?u:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,i,r){const o=this.getChildren(t);for(const s of o){const t=s.properties;if(t&&t.cluster?r+t.point_count<=i?r+=t.point_count:r=this._appendLeaves(e,t.cluster_id,n,i,r):r<i?r++:e.push(s),e.length===n)break}return r}_createTree(t){const n=new e.KDBush(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)n.add(t[e],t[e+1]);return n.finish(),n.data=t,n}_addTileFeatures(e,t,n,i,r,o){for(const s of e){const e=s*this.stride,a=t[e+A]>1;let l,c,u;if(a)l=R(t,e,this.clusterProps),c=t[e],u=t[e+1];else{const n=this.points[t[e+I]];l=n.properties;const[i,r]=n.geometry.coordinates;c=z(i),u=L(r)}const d={type:1,geometry:[[Math.round(this.options.extent*(c*r-n)),Math.round(this.options.extent*(u*r-i))]],tags:l};let h;h=a||this.options.generateId?t[e+I]:this.points[t[e+I]].id,void 0!==h&&(d.id=h),o.features.push(d)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:i,reduce:r,minPoints:o}=this.options,s=n/(i*Math.pow(2,t)),a=e.data,l=[],c=this.stride;for(let u=0;u<a.length;u+=c){if(a[u+2]<=t)continue;a[u+2]=t;const n=a[u],i=a[u+1],d=e.within(a[u],a[u+1],s),h=a[u+A];let p=h;for(const e of d){const n=e*c;a[n+2]>t&&(p+=a[n+A])}if(p>h&&p>=o){let e,o=n*h,s=i*h,f=-1;const m=((u/c|0)<<5)+(t+1)+this.points.length;for(const n of d){const i=n*c;if(a[i+2]<=t)continue;a[i+2]=t;const l=a[i+A];o+=a[i]*l,s+=a[i+1]*l,a[i+4]=m,r&&(e||(e=this._map(a,u,!0),f=this.clusterProps.length,this.clusterProps.push(e)),r(e,this._map(a,i)))}a[u+4]=m,l.push(o/p,s/p,1/0,m,-1,p),r&&l.push(f)}else{for(let e=0;e<c;e++)l.push(a[u+e]);if(p>1)for(const e of d){const n=e*c;if(!(a[n+2]<=t)){a[n+2]=t;for(let e=0;e<c;e++)l.push(a[n+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+A]>1){const i=this.clusterProps[e[t+P]];return n?Object.assign({},i):i}const i=this.points[e[t+I]].properties,r=this.options.map(i);return n&&r===i?Object.assign({},r):r}}function D(e,t,n){return{type:"Feature",id:e[t+I],properties:R(e,t,n),geometry:{type:"Point",coordinates:[(i=e[t],360*(i-.5)),B(e[t+1])]}};var i}function R(e,t,n){const i=e[t+A],r=i>=1e4?`${Math.round(i/1e3)}k`:i>=1e3?Math.round(i/100)/10+"k":i,o=e[t+P],s=-1===o?{}:Object.assign({},n[o]);return Object.assign(s,{cluster:!0,cluster_id:e[t+I],point_count:i,point_count_abbreviated:r})}function z(e){return e/360+.5}function L(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function B(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function N(e,t,n,i){for(var r,o=i,s=n-t>>1,a=n-t,l=e[t],c=e[t+1],u=e[n],d=e[n+1],h=t+3;h<n;h+=3){var p=F(e[h],e[h+1],l,c,u,d);if(p>o)r=h,o=p;else if(p===o){var f=Math.abs(h-s);f<a&&(r=h,a=f)}}o>i&&(r-t>3&&N(e,t,r,i),e[r+2]=o,n-r>3&&N(e,r,n,i))}function F(e,t,n,i,r,o){var s=r-n,a=o-i;if(0!==s||0!==a){var l=((e-n)*s+(t-i)*a)/(s*s+a*a);l>1?(n=r,i=o):l>0&&(n+=s*l,i+=a*l)}return(s=e-n)*s+(a=t-i)*a}function $(e,t,n,i){var r={id:void 0===e?null:e,type:t,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,n=e.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)j(e,t);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<t.length;i++)j(e,t[i]);else if("MultiPolygon"===n)for(i=0;i<t.length;i++)for(var r=0;r<t[i].length;r++)j(e,t[i][r])}(r),r}function j(e,t){for(var n=0;n<t.length;n+=3)e.minX=Math.min(e.minX,t[n]),e.minY=Math.min(e.minY,t[n+1]),e.maxX=Math.max(e.maxX,t[n]),e.maxY=Math.max(e.maxY,t[n+1])}function V(e,t,n,i){if(t.geometry){var r=t.geometry.coordinates,o=t.geometry.type,s=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),a=[],l=t.id;if(n.promoteId?l=t.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===o)U(r,a);else if("MultiPoint"===o)for(var c=0;c<r.length;c++)U(r[c],a);else if("LineString"===o)q(r,a,s,!1);else if("MultiLineString"===o){if(n.lineMetrics){for(c=0;c<r.length;c++)q(r[c],a=[],s,!1),e.push($(l,"LineString",a,t.properties));return}G(r,a,s,!1)}else if("Polygon"===o)G(r,a,s,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<t.geometry.geometries.length;c++)V(e,{id:l,geometry:t.geometry.geometries[c],properties:t.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];G(r[c],u,s,!0),a.push(u)}}e.push($(l,o,a,t.properties))}}function U(e,t){t.push(W(e[0])),t.push(H(e[1])),t.push(0)}function q(e,t,n,i){for(var r,o,s=0,a=0;a<e.length;a++){var l=W(e[a][0]),c=H(e[a][1]);t.push(l),t.push(c),t.push(0),a>0&&(s+=i?(r*c-l*o)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-o,2))),r=l,o=c}var u=t.length-3;t[2]=1,N(t,0,u,n),t[u+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function G(e,t,n,i){for(var r=0;r<e.length;r++){var o=[];q(e[r],o,n,i),t.push(o)}}function W(e){return e/360+.5}function H(e){var t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function Z(e,t,n,i,r,o,s,a){if(i/=t,o>=(n/=t)&&s<i)return e;if(s<n||o>=i)return null;for(var l=[],c=0;c<e.length;c++){var u=e[c],d=u.geometry,h=u.type,p=0===r?u.minX:u.minY,f=0===r?u.maxX:u.maxY;if(p>=n&&f<i)l.push(u);else if(!(f<n||p>=i)){var m=[];if("Point"===h||"MultiPoint"===h)X(d,m,n,i,r);else if("LineString"===h)K(d,m,n,i,r,!1,a.lineMetrics);else if("MultiLineString"===h)Y(d,m,n,i,r,!1);else if("Polygon"===h)Y(d,m,n,i,r,!0);else if("MultiPolygon"===h)for(var g=0;g<d.length;g++){var y=[];Y(d[g],y,n,i,r,!0),y.length&&m.push(y)}if(m.length){if(a.lineMetrics&&"LineString"===h){for(g=0;g<m.length;g++)l.push($(u.id,h,m[g],u.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===m.length?(h="LineString",m=m[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===m.length?"Point":"MultiPoint"),l.push($(u.id,h,m,u.tags))}}}return l.length?l:null}function X(e,t,n,i,r){for(var o=0;o<e.length;o+=3){var s=e[o+r];s>=n&&s<=i&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function K(e,t,n,i,r,o,s){for(var a,l,c=J(e),u=0===r?ee:te,d=e.start,h=0;h<e.length-3;h+=3){var p=e[h],f=e[h+1],m=e[h+2],g=e[h+3],y=e[h+4],v=0===r?p:f,b=0===r?g:y,x=!1;s&&(a=Math.sqrt(Math.pow(p-g,2)+Math.pow(f-y,2))),v<n?b>n&&(l=u(c,p,f,g,y,n),s&&(c.start=d+a*l)):v>i?b<i&&(l=u(c,p,f,g,y,i),s&&(c.start=d+a*l)):Q(c,p,f,m),b<n&&v>=n&&(l=u(c,p,f,g,y,n),x=!0),b>i&&v<=i&&(l=u(c,p,f,g,y,i),x=!0),!o&&x&&(s&&(c.end=d+a*l),t.push(c),c=J(e)),s&&(d+=a)}var _=e.length-3;p=e[_],f=e[_+1],m=e[_+2],(v=0===r?p:f)>=n&&v<=i&&Q(c,p,f,m),_=c.length-3,o&&_>=3&&(c[_]!==c[0]||c[_+1]!==c[1])&&Q(c,c[0],c[1],c[2]),c.length&&t.push(c)}function J(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function Y(e,t,n,i,r,o){for(var s=0;s<e.length;s++)K(e[s],t,n,i,r,o,!1)}function Q(e,t,n,i){e.push(t),e.push(n),e.push(i)}function ee(e,t,n,i,r,o){var s=(o-t)/(i-t);return e.push(o),e.push(n+(r-n)*s),e.push(1),s}function te(e,t,n,i,r,o){var s=(o-n)/(r-n);return e.push(t+(i-t)*s),e.push(o),e.push(1),s}function ne(e,t){for(var n=[],i=0;i<e.length;i++){var r,o=e[i],s=o.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)r=ie(o.geometry,t);else if("MultiLineString"===s||"Polygon"===s){r=[];for(var a=0;a<o.geometry.length;a++)r.push(ie(o.geometry[a],t))}else if("MultiPolygon"===s)for(r=[],a=0;a<o.geometry.length;a++){for(var l=[],c=0;c<o.geometry[a].length;c++)l.push(ie(o.geometry[a][c],t));r.push(l)}n.push($(o.id,s,r,o.tags))}return n}function ie(e,t){var n=[];n.size=e.size,void 0!==e.start&&(n.start=e.start,n.end=e.end);for(var i=0;i<e.length;i+=3)n.push(e[i]+t,e[i+1],e[i+2]);return n}function re(e,t){if(e.transformed)return e;var n,i,r,o=1<<e.z,s=e.x,a=e.y;for(n=0;n<e.features.length;n++){var l=e.features[n],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(i=0;i<c.length;i+=2)l.geometry.push(oe(c[i],c[i+1],t,o,s,a));else for(i=0;i<c.length;i++){var d=[];for(r=0;r<c[i].length;r+=2)d.push(oe(c[i][r],c[i][r+1],t,o,s,a));l.geometry.push(d)}}return e.transformed=!0,e}function oe(e,t,n,i,r,o){return[Math.round(n*(e*i-r)),Math.round(n*(t*i-o))]}function se(e,t,n,i,r){for(var o=t===r.maxZoom?0:r.tolerance/((1<<t)*r.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<e.length;a++){s.numFeatures++,ae(s,e[a],o,r);var l=e[a].minX,c=e[a].minY,u=e[a].maxX,d=e[a].maxY;l<s.minX&&(s.minX=l),c<s.minY&&(s.minY=c),u>s.maxX&&(s.maxX=u),d>s.maxY&&(s.maxY=d)}return s}function ae(e,t,n,i){var r=t.geometry,o=t.type,s=[];if("Point"===o||"MultiPoint"===o)for(var a=0;a<r.length;a+=3)s.push(r[a]),s.push(r[a+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)le(s,r,e,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(a=0;a<r.length;a++)le(s,r[a],e,n,"Polygon"===o,0===a);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var c=r[l];for(a=0;a<c.length;a++)le(s,c[a],e,n,!0,0===a)}if(s.length){var u=t.tags||null;if("LineString"===o&&i.lineMetrics){for(var d in u={},t.tags)u[d]=t.tags[d];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var h={geometry:s,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:u};null!==t.id&&(h.id=t.id),e.features.push(h)}}function le(e,t,n,i,r,o){var s=i*i;if(i>0&&t.size<(r?s:i))n.numPoints+=t.length/3;else{for(var a=[],l=0;l<t.length;l+=3)(0===i||t[l+2]>s)&&(n.numSimplified++,a.push(t[l]),a.push(t[l+1])),n.numPoints++;r&&function(e,t){for(var n=0,i=0,r=e.length,o=r-2;i<r;o=i,i+=2)n+=(e[i]-e[o])*(e[i+1]+e[o+1]);if(n>0===t)for(i=0,r=e.length;i<r/2;i+=2){var s=e[i],a=e[i+1];e[i]=e[r-2-i],e[i+1]=e[r-1-i],e[r-2-i]=s,e[r-1-i]=a}}(a,o),e.push(a)}}function ce(e,t){var n=(t=this.options=function(e,t){for(var n in t)e[n]=t[n];return e}(Object.create(this.options),t)).debug;if(n&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(e,t){var n=[];if("FeatureCollection"===e.type)for(var i=0;i<e.features.length;i++)V(n,e.features[i],t,i);else V(n,"Feature"===e.type?e:{geometry:e},t);return n}(e,t);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=function(e,t){var n=t.buffer/t.extent,i=e,r=Z(e,1,-1-n,n,0,-1,2,t),o=Z(e,1,1-n,2+n,0,-1,2,t);return(r||o)&&(i=Z(e,1,-n,1+n,0,-1,2,t)||[],r&&(i=ne(r,1).concat(i)),o&&(i=i.concat(ne(o,-1)))),i}(i,t),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ue(e,t,n){return 32*((1<<e)*n+t)+e}function de(t,n){const i=t.tileID.canonical;if(!this._geoJSONIndex)return n(null,null);const r=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!r)return n(null,null);const o=new class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t}feature(t){return new class{constructor(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const n of this._feature.geometry)t.push([new e.Point(n[0],n[1])]);return t}{const t=[];for(const n of this._feature.geometry){const i=[];for(const t of n)i.push(new e.Point(t[0],t[1]));t.push(i)}return t}}toGeoJSON(e,t,n){return l.call(this,e,t,n)}}(this._features[t])}}(r.features);let s=S(o);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),n(null,{vectorTile:o,rawData:s.buffer})}ce.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ce.prototype.splitTile=function(e,t,n,i,r,o,s){for(var a=[e,t,n,i],l=this.options,c=l.debug;a.length;){i=a.pop(),n=a.pop(),t=a.pop(),e=a.pop();var u=1<<t,d=ue(t,n,i),h=this.tiles[d];if(!h&&(c>1&&console.time("creation"),h=this.tiles[d]=se(e,t,n,i,l),this.tileCoords.push({z:t,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,n,i,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=e,r){if(t===l.maxZoom||t===r)continue;var f=1<<r-t;if(n!==Math.floor(o/f)||i!==Math.floor(s/f))continue}else if(t===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==e.length){c>1&&console.time("clipping");var m,g,y,v,b,x,_=.5*l.buffer/l.extent,w=.5-_,k=.5+_,E=1+_;m=g=y=v=null,b=Z(e,u,n-_,n+k,0,h.minX,h.maxX,l),x=Z(e,u,n+w,n+E,0,h.minX,h.maxX,l),e=null,b&&(m=Z(b,u,i-_,i+k,1,h.minY,h.maxY,l),g=Z(b,u,i+w,i+E,1,h.minY,h.maxY,l),b=null),x&&(y=Z(x,u,i-_,i+k,1,h.minY,h.maxY,l),v=Z(x,u,i+w,i+E,1,h.minY,h.maxY,l),x=null),c>1&&console.timeEnd("clipping"),a.push(m||[],t+1,2*n,2*i),a.push(g||[],t+1,2*n,2*i+1),a.push(y||[],t+1,2*n+1,2*i),a.push(v||[],t+1,2*n+1,2*i+1)}}},ce.prototype.getTile=function(e,t,n){var i=this.options,r=i.extent,o=i.debug;if(e<0||e>24)return null;var s=1<<e,a=ue(e,t=(t%s+s)%s,n);if(this.tiles[a])return re(this.tiles[a],r);o>1&&console.log("drilling down to z%d-%d-%d",e,t,n);for(var l,c=e,u=t,d=n;!l&&c>0;)c--,u=Math.floor(u/2),d=Math.floor(d/2),l=this.tiles[ue(c,u,d)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,u,d),o>1&&console.time("drilling down"),this.splitTile(l.source,c,u,d,e,t,n),o>1&&console.timeEnd("drilling down"),this.tiles[a]?re(this.tiles[a],r):null):null};class he extends e.VectorTileWorkerSource{constructor(e,t,n,i,r){super(e,t,n,i,de),r&&(this.loadGeoJSON=r)}loadData(t,n){const i=t&&t.request,r=i&&i.collectResourceTiming;this.loadGeoJSON(t,((o,s)=>{if(o||!s)return n(o);if("object"!=typeof s)return n(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));{a(s,!0);try{if(t.filter){const n=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const i=s.features.filter((e=>n.value.evaluate({zoom:0},e)));s={type:"FeatureCollection",features:i}}this._geoJSONIndex=t.cluster?new O(function({superclusterOptions:t,clusterProperties:n}){if(!n||!t)return t;const i={},r={},o={accumulated:null,zoom:0},s={properties:null},a=Object.keys(n);for(const l of a){const[t,o]=n[l],s=e.createExpression(o),a=e.createExpression("string"==typeof t?[t,["accumulated"],["get",l]]:t);i[l]=s.value,r[l]=a.value}return t.map=e=>{s.properties=e;const t={};for(const n of a)t[n]=i[n].evaluate(o,s);return t},t.reduce=(e,t)=>{s.properties=t;for(const n of a)o.accumulated=e[n],e[n]=r[n].evaluate(o,s)},t}(t)).load(s.features):function(e,t){return new ce(e,t)}(s,t.geojsonVtOptions)}catch(o){return n(o)}this.loaded={};const l={};if(r){const n=e.getPerformanceMeasurement(i);n&&(l.resourceTiming={},l.resourceTiming[t.source]=JSON.parse(JSON.stringify(n)))}n(null,l)}}))}reloadTile(e,t){const n=this.loaded;return n&&n[e.uid]?super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,n){if(t.request)e.getJSON(t.request,n);else{if("string"!=typeof t.data)return n(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));try{return n(null,JSON.parse(t.data))}catch(e){return n(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class pe{constructor(t){this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.getProjection({name:"mercator"}),this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:he},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}clearCaches(e,t,n){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],n()}checkIfReady(e,t,n){n()}setReferrer(e,t){this.referrer=t}spriteLoaded(t,n){this.isSpriteLoaded[t]=n;for(const i in this.workerSources[t]){const r=this.workerSources[t][i];for(const t in r)r[t]instanceof e.VectorTileWorkerSource&&(r[t].isSpriteLoaded=n,r[t].fire(new e.Event("isSpriteLoaded")))}}setImages(e,t,n){this.availableImages[e]=t;for(const i in this.workerSources[e]){const n=this.workerSources[e][i];for(const e in n)n[e].availableImages=t}n()}enableTerrain(e,t,n){this.terrain=t,n()}setProjection(t,n){this.projections[t]=e.getProjection(n)}setLayers(e,t,n){this.getLayerIndex(e).replace(t),n()}updateLayers(e,t,n){this.getLayerIndex(e).update(t.layers,t.removedIds),n()}loadTile(t,n,i){const r=this.enableTerrain?e.extend({enableTerrain:this.terrain},n):n;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,n.type,n.source).loadTile(r,i)}loadDEMTile(t,n,i){const r=this.enableTerrain?e.extend({buildQuadTree:this.terrain},n):n;this.getDEMWorkerSource(t,n.source).loadTile(r,i)}reloadTile(t,n,i){const r=this.enableTerrain?e.extend({enableTerrain:this.terrain},n):n;r.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,n.type,n.source).reloadTile(r,i)}abortTile(e,t,n){this.getWorkerSource(e,t.type,t.source).abortTile(t,n)}removeTile(e,t,n){this.getWorkerSource(e,t.type,t.source).removeTile(t,n)}removeSource(e,t,n){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const i=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==i.removeSource?i.removeSource(t,n):n()}loadWorkerSource(e,t,n){try{this.self.importScripts(t.url),n()}catch(e){n(e.toString())}}syncRTLPluginState(t,n,i){try{e.plugin.setState(n);const t=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=t){this.self.importScripts(t);const n=e.plugin.isParsed();i(n?void 0:new Error(`RTL Text Plugin failed to import scripts from ${t}`),n)}}catch(e){i(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new i),t}getWorkerSource(e,t,n){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][n]){const i={send:(t,n,i,r,o,s)=>{this.actor.send(t,n,i,e,o,s)},scheduler:this.actor.scheduler};this.workerSources[e][t][n]=new this.workerSourceTypes[t](i,this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])}return this.workerSources[e][t][n]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new r),this.demWorkerSources[e][t]}enforceCacheSizeLimit(t,n){e.enforceCacheSizeLimit(n)}getWorkerPerformanceMetrics(e,t,n){n(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new pe(self)),pe})),i(["./shared"],(function(e){function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const i in e)if(!t(e[i],n[i]))return!1;return!0}return e===n}var n=i;function i(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,n=new Blob([""],{type:"text/javascript"}),i=URL.createObjectURL(n);try{t=new Worker(i),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(i),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var n=t.getImageData(0,0,1,1);return n&&n.width===e.width}()?(void 0===r[t=e&&e.failIfMajorPerformanceCaveat]&&(r[t]=function(e){var t,n=function(e){var t=document.createElement("canvas"),n=Object.create(i.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=e,t.getContext("webgl",n)||t.getContext("experimental-webgl",n)}(e);if(!n)return!1;try{t=n.createShader(n.VERTEX_SHADER)}catch(e){return!1}return!(!t||n.isContextLost())&&(n.shaderSource(t,"void main() {}"),n.compileShader(t),!0===n.getShaderParameter(t,n.COMPILE_STATUS))}(t)),r[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var r={};function o(t,n,i){const r=e.window.document.createElement(t);return void 0!==n&&(r.className=n),i&&i.appendChild(r),r}function s(t,n,i){const r=e.window.document.createElementNS("http://www.w3.org/2000/svg",t);for(const e of Object.keys(n))r.setAttributeNS(null,e,n[e]);return i&&i.appendChild(r),r}i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const a=e.window.document&&e.window.document.documentElement.style,l=a&&void 0!==a.userSelect?"userSelect":"WebkitUserSelect";let c;function u(){a&&l&&(c=a[l],a[l]="none")}function d(){a&&l&&(a[l]=c)}function h(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",h,!0)}function p(){e.window.addEventListener("click",h,!0),e.window.setTimeout((()=>{e.window.removeEventListener("click",h,!0)}),0)}function f(e,t){const n=e.getBoundingClientRect();return y(e,n,t)}function m(e,t){const n=e.getBoundingClientRect(),i=[];for(let r=0;r<t.length;r++)i.push(y(e,n,t[r]));return i}function g(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function y(t,n,i){const r=t.offsetWidth===n.width?1:t.offsetWidth/n.width;return new e.Point((i.clientX-n.left)*r,(i.clientY-n.top)*r)}function v(e,t){var n=t[0],i=t[1],r=t[2],o=t[3],s=n*o-r*i;return s?(e[0]=o*(s=1/s),e[1]=-i*s,e[2]=-r*s,e[3]=n*s,e):null}function b(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class x extends e.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,callback:t}of this.requestors)this._notify(e,t);this.requestors=[]}}hasImage(e){return!!this.getImage(e)}getImage(e){return this.images[e]}addImage(e,t){this._validate(e,t)&&(this.images[e]=t)}_validate(t,n){let i=!0;return this._validateStretch(n.stretchX,n.data&&n.data.width)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),i=!1),this._validateStretch(n.stretchY,n.data&&n.data.height)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),i=!1),this._validateContent(n.content,n)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),i=!1),i}_validateStretch(e,t){if(!e)return!0;let n=0;for(const i of e){if(i[0]<n||i[1]<i[0]||t<i[1])return!1;n=i[1]}return!0}_validateContent(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e,t){let n=!0;if(!this.isLoaded())for(const i of e)this.images[i]||(n=!1);this.isLoaded()||n?this._notify(e,t):this.requestors.push({ids:e,callback:t})}_notify(t,n){const i={};for(const r of t){this.images[r]||this.fire(new e.Event("styleimagemissing",{id:r}));const t=this.images[r];t?i[r]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.warnOnce(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}n(null,i)}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(t){const n=this.patterns[t],i=this.getImage(t);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{const n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new e.ImagePosition(n,i);this.patterns[t]={bin:n,position:r}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const n=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,n.RGBA),this.atlasTexture&&this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:n,h:i}=e.potpack(t),r=this.atlasImage;r.resize({width:n||1,height:i||1});for(const o in this.patterns){const{bin:t}=this.patterns[o],n=t.x+1,i=t.y+1,s=this.images[o].data,a=s.width,l=s.height;e.RGBAImage.copy(s,r,{x:0,y:0},{x:n,y:i},{width:a,height:l}),e.RGBAImage.copy(s,r,{x:0,y:l-1},{x:n,y:i-1},{width:a,height:1}),e.RGBAImage.copy(s,r,{x:0,y:0},{x:n,y:i+l},{width:a,height:1}),e.RGBAImage.copy(s,r,{x:a-1,y:0},{x:n-1,y:i},{width:1,height:l}),e.RGBAImage.copy(s,r,{x:0,y:0},{x:n+a,y:i},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const t of e){if(this.callbackDispatchedThisFrame[t])continue;this.callbackDispatchedThisFrame[t]=!0;const e=this.images[t];b(e)&&this.updateImage(t,e)}}}const _=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new class{constructor(){this.specification=e.spec.light.position}possiblyEvaluate(t,n){return function([t,n,i]){const r=e.degToRad(n+90),o=e.degToRad(i);return{x:t*Math.cos(r)*Math.sin(o),y:t*Math.sin(r)*Math.sin(o),z:t*Math.cos(o),azimuthal:n,polar:i}}(t.expression.evaluate(n))}interpolate(t,n,i){return{x:e.number(t.x,n.x,i),y:e.number(t.y,n.y,i),z:e.number(t.z,n.z,i),azimuthal:e.number(t.azimuthal,n.azimuthal,i),polar:e.number(t.polar,n.polar,i)}}},color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)});class w extends e.Evented{constructor(t){super(),this._transitionable=new e.Transitionable(_),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,n={}){if(!this._validate(e.validateLight,t,n))for(const i in t){const n=t[i];e.endsWith(i,"-transition")?this._transitionable.setTransition(i.slice(0,-11),n):this._transitionable.setValue(i,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,n,i){return(!i||!1!==i.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}const k=new e.Properties({source:new e.DataConstantProperty(e.spec.terrain.source),exaggeration:new e.DataConstantProperty(e.spec.terrain.exaggeration)});let E=class extends e.Evented{constructor(t,n){super(),this._transitionable=new e.Transitionable(k),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(t){for(const n in t){const i=t[n];e.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),i):this._transitionable.setValue(n,i)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}};function S(t,n,i,r){const o=e.smoothstep(45,65,i),[s,a]=T(t,r),l=e.length(n);let c=1-Math.min(1,Math.exp((l-s)/(a-s)*-6));return c*=c*c,c=Math.min(1,1.00747*c),c*o*t.alpha}function T(e,t){const n=.5/Math.tan(.5*t);return[e.range[0]+n,e.range[1]+n]}const C=new e.Properties({range:new e.DataConstantProperty(e.spec.fog.range),color:new e.DataConstantProperty(e.spec.fog.color),"high-color":new e.DataConstantProperty(e.spec.fog["high-color"]),"space-color":new e.DataConstantProperty(e.spec.fog["space-color"]),"horizon-blend":new e.DataConstantProperty(e.spec.fog["horizon-blend"]),"star-intensity":new e.DataConstantProperty(e.spec.fog["star-intensity"])});class M extends e.Evented{constructor(t,n){super(),this._transitionable=new e.Transitionable(C),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=n}get state(){const t=this._transform,n="globe"===t.projection.name,i=e.globeToMercatorTransition(t.zoom),r=this.properties.get("range"),o=[.5,3];return{range:n?[e.number(o[0],r[0],i),e.number(o[1],r[1],i)]:r,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,n={}){if(!this._validate(e.validateFog,t,n)){for(const n of Object.keys(e.spec.fog))t&&void 0===t[n]&&(t[n]=e.spec.fog[n].default);for(const n in t){const i=t[n];e.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),i):this._transitionable.setValue(n,i)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const n=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.smoothstep(45,65,t))*n.a}getOpacityAtLatLng(t,n){return this._transform.projection.supportsFog?function(t,n,i){const r=e.MercatorCoordinate.fromLngLat(n),o=i.elevation?i.elevation.getAtPointOrZero(r):0,s=[r.x,r.y,o];return e.transformMat4(s,s,i.mercatorFogMatrix),S(t,s,i.pitch,i._fov)}(this.state,t,n):0}getFovAdjustedRange(e){return this._transform.projection.supportsFog?T(this.state,e):[0,1]}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,n,i){return(!i||!1!==i.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}class I{constructor(t,n){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=e.uniqueId();const i=this.workerPool.acquire(this.id);for(let e=0;e<i.length;e++){const t=new I.Actor(i[e],n,this.id);t.name=`Worker ${e}`,this.actors.push(t)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(t,n,i){e.asyncAll(this.actors,((e,i)=>{e.send(t,n,i)}),i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((e=>{e.remove()})),this.actors=[],this.workerPool.release(this.id)}}function A(t,n,i){return n*(e.EXTENT/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}I.Actor=e.Actor;class P{constructor(e,t,n,i){this.screenBounds=e,this.cameraPoint=t,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,i)}static createFromScreenPoints(t,n){let i,r;if(t instanceof e.Point||"number"==typeof t[0]){const o=e.Point.convert(t);i=[o],r=n.isPointAboveHorizon(o)}else{const o=e.Point.convert(t[0]),s=e.Point.convert(t[1]);i=[o,s],r=e.polygonizeBounds(o,s).every((e=>n.isPointAboveHorizon(e)))}return new P(i,n.getCameraPoint(),r,n)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return e.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(n,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>n.x&&this.cameraPoint.x<i.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?r[2]=this.cameraPoint:this.cameraPoint.x<=n.x&&(r[3]=this.cameraPoint)),e.bufferConvexPolygon(r,t)}bufferedCameraGeometryGlobe(t){const n=this.screenBounds[0],i=1===this.screenBounds.length?this.screenBounds[0].add(new e.Point(1,1)):this.screenBounds[1],r=e.polygonizeBounds(n,i,t),o=this.cameraPoint.clone();switch(3*((o.y>n.y)+(o.y>i.y))+((o.x>n.x)+(o.x>i.x))){case 0:r[0]=o,r[4]=o.clone();break;case 1:r.splice(1,0,o);break;case 2:r[1]=o;break;case 3:r.splice(4,0,o);break;case 5:r.splice(2,0,o);break;case 6:r[3]=o;break;case 7:r.splice(3,0,o);break;case 8:r[2]=o}return r}containsTile(t,n,i,r=0){const o=t.queryPadding/n._pixelsPerMercatorPixel+1,s=i?this._bufferedCameraMercator(o,n):this._bufferedScreenMercator(o,n);let a=t.tileID.wrap+(s.unwrapped?r:0);const l=s.polygon.map((n=>e.getTilePoint(t.tileTransform,n,a)));if(!e.polygonIntersectsBox(l,0,0,e.EXTENT,e.EXTENT))return;a=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?r:0);const c=this.screenGeometryMercator.polygon.map((n=>e.getTileVec3(t.tileTransform,n,a))),u=c.map((t=>new e.Point(t[0],t[1]))),d=n.getFreeCameraOptions().position||new e.MercatorCoordinate(0,0,0),h=e.getTileVec3(t.tileTransform,d,a),p=c.map((t=>{const n=e.sub(t,t,h);return e.normalize(n,n),new e.Ray(h,n)})),f=A(t,1,n.zoom)*n._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:u,tilespaceRays:p,bufferedTilespaceGeometry:l,bufferedTilespaceBounds:(m=e.getBounds(l),m.min.x=e.clamp(m.min.x,0,e.EXTENT),m.min.y=e.clamp(m.min.y,0,e.EXTENT),m.max.x=e.clamp(m.max.x,0,e.EXTENT),m.max.y=e.clamp(m.max.y,0,e.EXTENT),m),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:f};var m}_bufferedScreenMercator(e,t){const n=R(e);if(this._screenRaycastCache[n])return this._screenRaycastCache[n];{let i;return i="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._screenRaycastCache[n]=i,i}}_bufferedCameraMercator(e,t){const n=R(e);if(this._cameraRaycastCache[n])return this._cameraRaycastCache[n];{let i;return i="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._cameraRaycastCache[n]=i,i}}_projectAndResample(t,n){const i=function(t,n){const i=e.multiply([],n.pixelMatrix,n.globeMatrix),r=[0,-e.GLOBE_RADIUS,0,1],o=[0,e.GLOBE_RADIUS,0,1],s=[0,0,0,1];e.transformMat4$1(r,r,i),e.transformMat4$1(o,o,i),e.transformMat4$1(s,s,i);const a=new e.Point(r[0]/r[3],r[1]/r[3]),l=new e.Point(o[0]/o[3],o[1]/o[3]),c=e.polygonContainsPoint(t,a)&&r[3]<s[3],u=e.polygonContainsPoint(t,l)&&o[3]<s[3];if(!c&&!u)return null;const d=function(e,t,n){for(let i=1;i<e.length;i++){const r=D(t.pointCoordinate3D(e[i-1]).x),o=D(t.pointCoordinate3D(e[i]).x);if(n<0){if(r<o)return{idx:i,t:-r/(o-1-r)}}else if(o<r)return{idx:i,t:(1-r)/(o+1-r)}}return null}(t,n,c?-1:1);if(!d)return null;const{idx:h,t:p}=d;let f=h>1?O(t.slice(0,h),n):[],m=h<t.length?O(t.slice(h),n):[];f=f.map((t=>new e.Point(D(t.x),t.y))),m=m.map((t=>new e.Point(D(t.x),t.y)));const g=[...f];0===g.length&&g.push(m[m.length-1]);const y=e.number(g[g.length-1].y,(0===m.length?f[0]:m[0]).y,p);let v;return v=c?[new e.Point(0,y),new e.Point(0,0),new e.Point(1,0),new e.Point(1,y)]:[new e.Point(1,y),new e.Point(1,1),new e.Point(0,1),new e.Point(0,y)],g.push(...v),0===m.length?g.push(f[0]):g.push(...m),{polygon:g.map((t=>new e.MercatorCoordinate(t.x,t.y))),unwrapped:!1}}(t,n);if(i)return i;const r=function(t,n){let i=!1,r=-1/0,o=0;for(let e=0;e<t.length-1;e++)t[e].x>r&&(r=t[e].x,o=e);for(let e=0;e<t.length-1;e++){const n=(o+e)%(t.length-1),r=t[n],s=t[n+1];Math.abs(r.x-s.x)>.5&&(r.x<s.x?(r.x+=1,0===n&&(t[t.length-1].x+=1)):(s.x+=1,n+1===t.length-1&&(t[0].x+=1)),i=!0)}const s=e.mercatorXfromLng(n.center.lng);return i&&s<Math.abs(s-1)&&t.forEach((e=>{e.x-=1})),{polygon:t,unwrapped:i}}(O(t,n).map((t=>new e.Point(D(t.x),t.y))),n);return{polygon:r.polygon.map((t=>new e.MercatorCoordinate(t.x,t.y))),unwrapped:r.unwrapped}}}function O(t,n){return e.resample(t,(e=>{const t=n.pointCoordinate3D(e);e.x=t.x,e.y=t.y}),1/256)}function D(e){return e<0?1+e%1:e%1}function R(e){return 100*e|0}function z(t,n,i,r,o){const s=function(i,r){if(i)return o(i);if(r){t.url&&r.tiles&&t.tiles&&delete t.tiles;const i=e.pick(e.extend(r,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);r.vector_layers&&(i.vectorLayers=r.vector_layers,i.vectorLayerIds=i.vectorLayers.map((e=>e.id))),i.tiles=n.canonicalizeTileset(i,t.url),o(null,i)}};return t.url?e.getJSON(n.transformRequest(n.normalizeSourceURL(t.url,null,i,r),e.ResourceType.Source),s):e.exported.frame((()=>s(null,t)))}class L{constructor(t,n,i){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=n||0,this.maxzoom=i||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const n=Math.pow(2,t.z),i=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*n),r=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*n),o=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*n),s=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*n);return t.x>=i&&t.x<o&&t.y>=r&&t.y<s}}class B{constructor(e,t,n){this.context=e;const i=e.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const N={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class F{constructor(e,t,n,i){this.length=t.length,this.attributes=n,this.itemSize=t.bytesPerElement,this.dynamicDraw=i,this.context=e;const r=e.gl;this.buffer=r.createBuffer(),e.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let n=0;n<this.attributes.length;n++){const i=t.attributes[this.attributes[n].name];void 0!==i&&e.enableVertexAttribArray(i)}}setVertexAttribPointers(e,t,n){for(let i=0;i<this.attributes.length;i++){const r=this.attributes[i],o=t.attributes[r.name];void 0!==o&&e.vertexAttribPointer(o,r.components,e[N[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ${constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class j extends ${getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class V extends ${getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class U extends ${getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class q extends ${getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class G extends ${getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class W extends ${getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class H extends ${getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Z extends ${getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class X extends ${getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class K extends ${getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class J extends ${getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class Y extends ${getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Q extends ${getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class ee extends ${getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class te extends ${getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ne extends ${getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class ie extends ${getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class re extends ${getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class oe extends ${getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let se,ae=class extends ${getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class le extends ${getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ce extends ${getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ue extends ${getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class de extends ${getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class he extends ${getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class pe extends ${getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class fe extends ${getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class me extends ${constructor(e){super(e),this.vao=e.extVertexArrayObject}getDefault(){return null}set(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class ge extends ${getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class ye extends ${getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ve extends ${getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class be extends ${constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class xe extends be{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class _e extends be{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class we extends _e{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ke{constructor(e,t,n,i){this.context=e,this.width=t,this.height=n;const r=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new xe(e,r),i&&(this.depthAttachment=new _e(e,r))}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class Ee{constructor(e,t=!1){if(this.gl=e,this.isWebGL2=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),t){const t=e;this.extVertexArrayObject={createVertexArrayOES:t.createVertexArray.bind(e),deleteVertexArrayOES:t.deleteVertexArray.bind(e),bindVertexArrayOES:t.bindVertexArray.bind(e)}}this.clearColor=new j(this),this.clearDepth=new V(this),this.clearStencil=new U(this),this.colorMask=new q(this),this.depthMask=new G(this),this.stencilMask=new W(this),this.stencilFunc=new H(this),this.stencilOp=new Z(this),this.stencilTest=new X(this),this.depthRange=new K(this),this.depthTest=new J(this),this.depthFunc=new Y(this),this.blend=new Q(this),this.blendFunc=new ee(this),this.blendColor=new te(this),this.blendEquation=new ne(this),this.cullFace=new ie(this),this.cullFaceSide=new re(this),this.frontFace=new oe(this),this.program=new ae(this),this.activeTexture=new le(this),this.viewport=new ce(this),this.bindFramebuffer=new ue(this),this.bindRenderbuffer=new de(this),this.bindTexture=new he(this),this.bindVertexBuffer=new pe(this),this.bindElementBuffer=new fe(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new me(this),this.pixelStoreUnpack=new ge(this),this.pixelStoreUnpackPremultiplyAlpha=new ye(this),this.pixelStoreUnpackFlipY=new ve(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),t||(this.extTextureHalfFloat=e.getExtension("OES_texture_half_float")),(t||this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t||e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new B(this,e,t)}createVertexBuffer(e,t,n){return new F(this,e,t,n)}createRenderbuffer(e,t,n){const i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,e,t,n),this.bindRenderbuffer.set(null),r}createFramebuffer(e,t,n){return new ke(this,e,t,n)}clear({color:e,depth:t,stencil:n}){const i=this.gl;let r=0;e&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(r|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),void 0!==n&&(r|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),i.clear(r)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(n){t(n.blendFunction,e.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Se extends e.Evented{constructor(t,n,i,r){if(super(),this.id=t,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(n,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new e.DedupedRequest}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=z(this._options,this.map._requestManager,n,i,((r,o)=>{this._tileJSONRequest=null,this._loaded=!0,r?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),i&&2!==i.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new e.ErrorEvent(r))):o&&(e.extend(this,o),o.bounds&&(this.tileBounds=new L(o.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(o.tiles,this.map._requestManager._customAccessToken),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}loadTile(t,n){const i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(i,e.ResourceType.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=n:t.request=t.actor.send("reloadTile",r,o.bind(this));else if(t.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",r,o.bind(this),void 0,!0);else{const n=e.loadVectorTile.call({deduped:this._deduped},r,((e,n)=>{e||!n?o.call(this,e):(r.data={cacheControl:n.cacheControl,expires:n.expires,rawData:n.rawData.slice(0)},t.actor&&t.actor.send("loadTile",r,o.bind(this),void 0,!0))}),!0);t.request={cancel:n}}function o(i,r){return delete t.request,t.aborted?n(null):i&&404!==i.status?n(i):(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id})}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Te extends e.Evented{constructor(t,n,i,r){super(),this.id=t,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},n),e.extend(this,e.pick(n,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=z(this._options,this.map._requestManager,null,null,((n,i)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new e.ErrorEvent(n)):i&&(e.extend(this,i),i.bounds&&(this.tileBounds=new L(i.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(i.tiles),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(n)}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,n){const i=e.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(r,e.ResourceType.Tile),((i,r,o,s)=>(delete t.request,t.aborted?(t.state="unloaded",n(null)):i?(t.state="errored",n(i)):r?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s}),t.setTexture(r,this.map.painter),t.state="loaded",e.cacheEntryPossiblyAdded(this.dispatcher),void n(null)):n(null))))}static loadTileData(e,t,n){e.setTexture(t,n)}static unloadTileData(e,t){e.texture&&t.saveTileTexture(e.texture)}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t()}unloadTile(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Ce(t,n,i,r,o,s,a,l){const c=[t,i,o,n,r,s,1,1,1],u=[a,l,1],d=e.adjoint([],c),[h,p,f]=e.transformMat3(u,u,e.transpose(d,d));return e.multiply$1(c,[h,0,0,0,p,0,0,0,f],c)}class Me extends e.Evented{constructor(e,t,n,i){super(),this.id=e,this.dispatcher=n,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=t,this._dirty=!1}load(t,n){this._loaded=n||!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),((n,i)=>{if(this._imageRequest=null,this._loaded=!0,n)this.fire(new e.ErrorEvent(n));else if(i){const{HTMLImageElement:n}=e.window;this.image=i instanceof n?e.exported.getImageData(i):i,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const n=t.map(e.MercatorCoordinate.fromLngLat);return this.tileID=function(t){let n=1/0,i=1/0,r=-1/0,o=-1/0;for(const e of t)n=Math.min(n,e.x),i=Math.min(i,e.y),r=Math.max(r,e.x),o=Math.max(o,e.y);const s=Math.max(r-n,o-i),a=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),l=Math.pow(2,a);return new e.CanonicalTileID(a,Math.floor((n+r)/2*l),Math.floor((i+o)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture)}if(this._boundsArray)return;const n=e.tileTransform(this.tileID,this.map.transform.projection),[i,r,o,s]=this.coordinates.map((t=>{const i=n.projection.project(t[0],t[1]);return e.getTilePoint(n,i)._round()}));this.perspectiveTransform=function(t,n,i,r,o,s,a,l,c,u){const d=Ce(0,0,t,0,0,n,t,n),h=Ce(i,r,o,s,a,l,c,u);return e.multiply$1(h,e.adjoint(d,d),h),[h[6]/h[8]*t/e.EXTENT,h[7]/h[8]*n/e.EXTENT]}(this.width,this.height,i.x,i.y,r.x,r.y,s.x,s.y,o.x,o.y);const a=this._boundsArray=new e.StructArrayLayout4i8;a.emplaceBack(i.x,i.y,0,0),a.emplaceBack(r.x,r.y,e.EXTENT,0),a.emplaceBack(s.x,s.y,0,e.EXTENT),a.emplaceBack(o.x,o.y,e.EXTENT,e.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(a,e.boundsAttributes.members),this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,n=t.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new e.Texture(t,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(t)}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ie={vector:Se,raster:Te,"raster-dem":class extends Te{constructor(t,n,i,r){super(t,n,i,r),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(t,n){const i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(e,i){e&&(t.state="errored",n(e)),i&&(t.dem=i,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",n(null))}t.request=e.getImage(this.map._requestManager.transformRequest(i,e.ResourceType.Tile),function(i,o,s,a){if(delete t.request,t.aborted)t.state="unloaded",n(null);else if(i)t.state="errored",n(i);else if(o){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:s,expires:a});const n=e.window.ImageBitmap&&o instanceof e.window.ImageBitmap&&(null==se&&(se=e.window.OffscreenCanvas&&new e.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof e.window.createImageBitmap),se),i=1-(o.width-e.prevPowerOfTwo(o.width))/2;i<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const l=n?o:e.exported.getImageData(o,i),c={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:i};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",c,r.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(t){const n=t.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,o=0===n.x?t.wrap-1:t.wrap,s=(n.x+1+i)%i,a=n.x+1===i?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,o,n.z,r,n.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,n.z,s,n.y).key]={backfilled:!1},n.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,o,n.z,r,n.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,n.z,s,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new e.OverscaledTileID(t.overscaledZ,o,n.z,r,n.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,a,n.z,s,n.y+1).key]={backfilled:!1}),l}unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded"}},geojson:class extends e.Evented{constructor(t,n,i,r){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=i.getActor(),this.setEventedParent(r),this._data=n.data,this._options=e.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const o=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:e.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*o,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}getClusterLeaves(e,t,n,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:n},i),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new e.Event("dataloading",{dataType:"source"})),this._loaded=!1;const t=e.extend({},this.workerOptions),n=this._data;"string"==typeof n?(t.request=this.map._requestManager.transformRequest(e.exported.resolveURL(n),e.ResourceType.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,t,((t,n)=>{if(this._loaded=!0,this._pendingLoad=null,t)this.fire(new e.ErrorEvent(t));else{const t={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[this.id]&&(t.resourceTiming=n.resourceTiming[this.id]),this.fire(new e.Event("data",t)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(t,n){const i=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(i,{type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((e,r)=>(delete t.request,t.unloadVectorData(),t.aborted?n(null):e?n(e):(t.loadVectorData(r,this.map.painter,"reloadTile"===i),n(null)))),void 0,"loadTile"===i)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return e.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Me{constructor(e,t,n,i){super(e,t,n,i),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const n of t.urls)this.urls.push(this.map._requestManager.transformRequest(n,e.ResourceType.Source).url);e.getVideo(this.urls,((t,n)=>{this._loaded=!0,t?this.fire(new e.ErrorEvent(t)):n&&(this.video=n,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,n=t.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Me,canvas:class extends Me{constructor(t,n,i,r){super(t,n,i,r),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends e.Evented{constructor(t,n,i,r){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=i,this._implementation=n,this.setEventedParent(r),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new e.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new e.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new L(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),e.extend(this,e.pick(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return e.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this._map=t,this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:n,z:i}=e.canonical;return this._implementation.hasTile({x:t,y:n,z:i})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,n){const{x:i,y:r,z:o}=t.tileID.canonical,s=new e.window.AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:i,y:r,z:o},{signal:s.signal})).then(function(i){return delete t.request,t.aborted?(t.state="unloaded",n(null)):void 0===i?(t.state="errored",n(null)):null===i?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",n(null)):function(t){return t instanceof e.window.ImageData||t instanceof e.window.HTMLCanvasElement||t instanceof e.window.ImageBitmap||t instanceof e.window.HTMLImageElement}(i)?(this.loadTileData(t,i),t.state="loaded",void n(null)):(t.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch((e=>{20!==e.code&&(t.state="errored",n(e))})),t.request.cancel=()=>s.abort()}loadTileData(e,t){Te.loadTileData(e,t,this._map.painter)}unloadTileData(e){Te.unloadTileData(e,this._map.painter)}unloadTile(e,t){if(this.unloadTileData(e),this._implementation.unloadTile){const{x:t,y:n,z:i}=e.tileID.canonical;this._implementation.unloadTile({x:t,y:n,z:i})}t()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ae=function(t,n,i,r){const o=new Ie[n.type](t,n,i,r);if(o.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${o.id}`);return e.bindAll(["load","abort","unload","serialize","prepare"],o),o};function Pe(t,n){const i=e.identity([]);return e.scale(i,i,[.5*t.width,.5*-t.height,1]),e.translate(i,i,[1,-1,0]),e.multiply(i,i,t.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(i)}function Oe(e,t,n,i,r,o,s,a=!1){const l=e.tilesIn(i,s,a);l.sort(Re);const c=[];for(const d of l)c.push({wrappedTileID:d.tile.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(t,n,e._state,d,r,o,Pe(e.transform,d.tile.tileID),a)});const u=function(e){const t={},n={};for(const i of e){const e=i.queryResults,r=i.wrappedTileID,o=n[r]=n[r]||{};for(const n in e){const i=e[n],r=o[n]=o[n]||{},s=t[n]=t[n]||[];for(const e of i)r[e.featureIndex]||(r[e.featureIndex]=!0,s.push(e))}}return t}(c);for(const d in u)u[d].forEach((t=>{const n=t.feature,i=n.layer;i&&"background"!==i.type&&"sky"!==i.type&&(n.source=i.source,i["source-layer"]&&(n.sourceLayer=i["source-layer"]),n.state=void 0!==n.id?e.getFeatureState(i["source-layer"],n.id):{})}));return u}function De(e,t){const n=e.getRenderableIds().map((t=>e.getTileByID(t))),i=[],r={};for(let o=0;o<n.length;o++){const e=n[o],s=e.tileID.canonical.key;r[s]||(r[s]=!0,e.querySourceFeatures(i,t))}return i}function Re(e,t){const n=e.tileID,i=t.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function ze(){return null!=po.workerClass?new po.workerClass:new e.window.Worker(po.workerUrl)}const Le="mapboxgl_preloaded_worker_pool";class Be{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Be.workerCount;)this.workers.push(new ze);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Le]}numActive(){return Object.keys(this.active).length}}let Ne;function Fe(){return Ne||(Ne=new Be),Ne}function $e(t,n){const i={};for(const e in t)"ref"!==e&&(i[e]=t[e]);return e.refProperties.forEach((e=>{e in n&&(i[e]=n[e])})),i}function je(e){e=e.slice();const t=Object.create(null);for(let n=0;n<e.length;n++)t[e[n].id]=e[n];for(let n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=$e(e[n],t[e[n].ref]));return e}Be.workerCount=2;const Ve={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ue(e,t,n){n.push({command:Ve.addSource,args:[e,t[e]]})}function qe(e,t,n){t.push({command:Ve.removeSource,args:[e]}),n[e]=!0}function Ge(e,t,n,i){qe(e,n,i),Ue(e,t,n)}function We(e,n,i){let r;for(r in e[i])if(e[i].hasOwnProperty(r)&&"data"!==r&&!t(e[i][r],n[i][r]))return!1;for(r in n[i])if(n[i].hasOwnProperty(r)&&"data"!==r&&!t(e[i][r],n[i][r]))return!1;return!0}function He(e,n,i,r,o,s){let a;for(a in n=n||{},e=e||{})e.hasOwnProperty(a)&&(t(e[a],n[a])||i.push({command:s,args:[r,a,n[a],o]}));for(a in n)n.hasOwnProperty(a)&&!e.hasOwnProperty(a)&&(t(e[a],n[a])||i.push({command:s,args:[r,a,n[a],o]}))}function Ze(e){return e.id}function Xe(e,t){return e[t.id]=t,e}class Ke{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);let n=1,i=this._distances[n];const r=t*this.paddedLength+this.padding;for(;i<r&&n<this._distances.length;)i=this._distances[++n];const o=n-1,s=this._distances[o],a=i-s,l=a>0?(r-s)/a:0;return this.points[o].mult(1-l).add(this.points[n].mult(l))}}class Je{constructor(e,t,n){const i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(t/n);for(let o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,n,i,r){this._forEachCell(t,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}insertCircle(e,t,n,i){this._forEachCell(t-i,n-i,t+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(n),this.circles.push(i)}_insertBoxCell(e,t,n,i,r,o){this.boxCells[r].push(o)}_insertCircleCell(e,t,n,i,r,o){this.circleCells[r].push(o)}_query(e,t,n,i,r,o){if(n<0||e>this.width||i<0||t>this.height)return!r&&[];const s=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=i){if(r)return!0;for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],n=this.circles[3*e+1],i=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-i,y1:n-i,x2:t+i,y2:n+i})}return o?s.filter(o):s}return this._forEachCell(e,t,n,i,this._queryCell,s,{hitTest:r,seenUids:{box:{},circle:{}}},o),r?s.length>0:s}_queryCircle(e,t,n,i,r){const o=e-n,s=e+n,a=t-n,l=t+n;if(s<0||o>this.width||l<0||a>this.height)return!i&&[];const c=[];return this._forEachCell(o,a,s,l,this._queryCellCircle,c,{hitTest:i,circle:{x:e,y:t,radius:n},seenUids:{box:{},circle:{}}},r),i?c.length>0:c}query(e,t,n,i,r){return this._query(e,t,n,i,!1,r)}hitTest(e,t,n,i,r){return this._query(e,t,n,i,!0,r)}hitTestCircle(e,t,n,i){return this._queryCircle(e,t,n,!0,i)}_queryCell(e,t,n,i,r,o,s,a){const l=s.seenUids,c=this.boxCells[r];if(null!==c){const r=this.bboxes;for(const u of c)if(!l.box[u]){l.box[u]=!0;const c=4*u;if(e<=r[c+2]&&t<=r[c+3]&&n>=r[c+0]&&i>=r[c+1]&&(!a||a(this.boxKeys[u]))){if(s.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[u],x1:r[c],y1:r[c+1],x2:r[c+2],y2:r[c+3]})}}}const u=this.circleCells[r];if(null!==u){const r=this.circles;for(const c of u)if(!l.circle[c]){l.circle[c]=!0;const u=3*c;if(this._circleAndRectCollide(r[u],r[u+1],r[u+2],e,t,n,i)&&(!a||a(this.circleKeys[c]))){if(s.hitTest)return o.push(!0),!0;{const e=r[u],t=r[u+1],n=r[u+2];o.push({key:this.circleKeys[c],x1:e-n,y1:t-n,x2:e+n,y2:t+n})}}}}}_queryCellCircle(e,t,n,i,r,o,s,a){const l=s.circle,c=s.seenUids,u=this.boxCells[r];if(null!==u){const e=this.bboxes;for(const t of u)if(!c.box[t]){c.box[t]=!0;const n=4*t;if(this._circleAndRectCollide(l.x,l.y,l.radius,e[n+0],e[n+1],e[n+2],e[n+3])&&(!a||a(this.boxKeys[t])))return o.push(!0),!0}}const d=this.circleCells[r];if(null!==d){const e=this.circles;for(const t of d)if(!c.circle[t]){c.circle[t]=!0;const n=3*t;if(this._circlesCollide(e[n],e[n+1],e[n+2],l.x,l.y,l.radius)&&(!a||a(this.circleKeys[t])))return o.push(!0),!0}}}_forEachCell(e,t,n,i,r,o,s,a){const l=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),u=this._convertToXCellCoord(n),d=this._convertToYCellCoord(i);for(let h=l;h<=u;h++)for(let l=c;l<=d;l++)if(r.call(this,e,t,n,i,this.xCellCount*l+h,o,s,a))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,n,i,r,o){const s=i-e,a=r-t,l=n+o;return l*l>s*s+a*a}_circleAndRectCollide(e,t,n,i,r,o,s){const a=(o-i)/2,l=Math.abs(e-(i+a));if(l>a+n)return!1;const c=(s-r)/2,u=Math.abs(t-(r+c));if(u>c+n)return!1;if(l<=a||u<=c)return!0;const d=l-a,h=u-c;return d*d+h*h<=n*n}}const Ye={unknown:0,flipRequired:1,flipNotRequired:2},Qe=Math.tan(85*Math.PI/180);function et(t,n,i,r,o,s,a){const l=e.create();if(i)if("globe"===s.name){const t=e.calculateGlobeLabelMatrix(o,n);e.multiply(l,l,t)}else{const t=v([],a);l[0]=t[0],l[1]=t[1],l[4]=t[2],l[5]=t[3],r||e.rotateZ(l,l,o.angle)}else e.multiply(l,o.labelPlaneMatrix,t);return l}function tt(e,t,n,i,r,o,s){const a=et(e,t,n,i,r,o,s);return"globe"===o.name&&n||(a[2]=a[6]=a[10]=a[14]=0),a}function nt(t,n,i,r,o,s,a){if(i){if("globe"===s.name){const l=et(t,n,i,r,o,s,a);return e.invert(l,l),e.multiply(l,t,l),l}{const n=e.clone(t),i=e.identity([]);return i[0]=a[0],i[1]=a[1],i[4]=a[2],i[5]=a[3],e.multiply(n,n,i),r||e.rotateZ(n,n,-o.angle),n}}return o.glCoordMatrix}function it(t,n,i,r){const o=[t,n,i,1];i?e.transformMat4$1(o,o,r):ft(o,o,r);const s=o[3];return o[0]/=s,o[1]/=s,o[2]/=s,o}function rt(e,t){return Math.min(.5+e/t*.5,1.5)}function ot(e,t){const n=e[0]/e[3],i=e[1]/e[3];return n>=-t[0]&&n<=t[0]&&i>=-t[1]&&i<=t[1]}function st(t,n,i,r,o,s,a,l,c,u){const d=i.transform,h=r?t.textSizeData:t.iconSizeData,p=e.evaluateSizeForZoom(h,i.transform.zoom),f="globe"===d.projection.name,m=[256/i.width*2+1,256/i.height*2+1],g=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;g.clear();let y=null;f&&(y=r?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const v=t.lineVertexArray,b=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,x=i.transform.width/i.transform.height;let _,w=!1;for(let k=0;k<b.length;k++){const r=b.get(k),{numGlyphs:f,writingMode:E}=r;if(E!==e.WritingMode.vertical||w||_===e.WritingMode.horizontal||(w=!0),_=E,(r.hidden||E===e.WritingMode.vertical)&&!w){pt(f,g);continue}w=!1;const S=new e.Point(r.tileAnchorX,r.tileAnchorY);let{x:T,y:C,z:M}=d.projection.projectTilePoint(S.x,S.y,u.canonical);if(c){const[e,t,n]=c(S);T+=e,C+=t,M+=n}const I=[T,C,M,1];if(e.transformMat4$1(I,I,n),!ot(I,m)){pt(f,g);continue}const A=rt(i.transform.cameraToCenterDistance,I[3]),P=e.evaluateSizeForFeature(h,p,r),O=a?P/A:P*A,D=it(T,C,M,o);if(D[3]<=0){pt(f,g);continue}let R={};const z=a?null:c,L=ct(r,O,!1,l,n,o,s,t.glyphOffsetArray,v,g,y,D,S,R,x,z,d.projection,u,a);w=L.useVertical,z&&L.needsFlipping&&(R={}),(L.notEnoughRoom||w||L.needsFlipping&&ct(r,O,!0,l,n,o,s,t.glyphOffsetArray,v,g,y,D,S,R,x,z,d.projection,u,a).notEnoughRoom)&&pt(f,g)}r?(t.text.dynamicLayoutVertexBuffer.updateData(g),y&&t.text.globeExtVertexBuffer.updateData(y)):(t.icon.dynamicLayoutVertexBuffer.updateData(g),y&&t.icon.globeExtVertexBuffer.updateData(y))}function at(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m){const{lineStartIndex:g,glyphStartIndex:y,segment:v}=a,b=y+a.numGlyphs,x=g+a.lineLength,_=t.getoffsetX(y),w=t.getoffsetX(b-1),k=ht(e*_,n,i,r,o,s,v,g,x,l,c,u,d,h,!0,p,f,m);if(!k)return null;const E=ht(e*w,n,i,r,o,s,v,g,x,l,c,u,d,h,!0,p,f,m);return E?{first:k,last:E}:null}function lt(t,n,i,r){return t===e.WritingMode.horizontal&&Math.abs(r)>Math.abs(i)?{useVertical:!0}:t===e.WritingMode.vertical?r>0?{needsFlipping:!0}:null:n!==Ye.unknown&&function(e,t){return 0===e||Math.abs(t/e)>Qe}(i,r)?n===Ye.flipRequired?{needsFlipping:!0}:null:i<0?{needsFlipping:!0}:null}function ct(t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v,b){const x=n/24,_=t.lineOffsetX*x,w=t.lineOffsetY*x,{lineStartIndex:k,glyphStartIndex:E,numGlyphs:S,segment:T,writingMode:C,flipState:M}=t,I=k+t.lineLength,A=t=>{if(d){const[n,i,r]=t.up,o=u.length;e.updateGlobeVertexNormal(d,o+0,n,i,r),e.updateGlobeVertexNormal(d,o+1,n,i,r),e.updateGlobeVertexNormal(d,o+2,n,i,r),e.updateGlobeVertexNormal(d,o+3,n,i,r)}const[n,i,r]=t.point;e.addDynamicAttributes(u,n,i,r,t.angle)};if(S>1){const e=at(x,l,_,w,i,h,p,t,c,s,f,g,!1,y,v,b);if(!e)return{notEnoughRoom:!0};if(r&&!i){let[n,i,r]=e.first.point,[o,s,l]=e.last.point;[n,i]=it(n,i,r,a),[o,s]=it(o,s,l,a);const c=lt(C,M,(o-n)*m,s-i);if(t.flipState=c&&c.needsFlipping?Ye.flipRequired:Ye.flipNotRequired,c)return c}A(e.first);for(let t=E+1;t<E+S-1;t++){const e=ht(x*l.getoffsetX(t),_,w,i,h,p,T,k,I,c,s,f,g,!1,!1,y,v,b);if(!e)return u.length-=4*(t-E),{notEnoughRoom:!0};A(e)}A(e.last)}else{if(r&&!i){const n=it(p.x,p.y,0,o),i=k+T+1,r=new e.Point(c.getx(i),c.gety(i)),s=it(r.x,r.y,0,o),a=s[3]>0?s:dt(p,r,n,1,o,void 0,y,v.canonical),l=lt(C,M,(a[0]-n[0])*m,a[1]-n[1]);if(t.flipState=l&&l.needsFlipping?Ye.flipRequired:Ye.flipNotRequired,l)return l}const n=ht(x*l.getoffsetX(E),_,w,i,h,p,T,k,I,c,s,f,g,!1,!1,y,v,b);if(!n)return{notEnoughRoom:!0};A(n)}return{}}function ut(e,t,n,i,r){const{x:o,y:s,z:a}=i.projectTilePoint(e.x,e.y,t);if(!r)return it(o,s,a,n);const[l,c,u]=r(e);return it(o+l,s+c,a+u,n)}function dt(t,n,i,r,o,s,a,l){const c=ut(t.sub(n)._unit()._add(t),l,o,a,s);return e.sub(c,i,c),e.normalize(c,c),e.scaleAndAdd(c,i,c,r)}function ht(t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y,v){const b=r?t-n:t+n;let x=b>0?1:-1,_=0;r&&(x*=-1,_=Math.PI),x<0&&(_+=Math.PI);let w=l+a+(x>0?0:1)|0,k=o,E=o,S=0,T=0;const C=Math.abs(b),M=[],I=[];let A=s,P=A;const O=()=>dt(P,A,E,C-S+1,d,p,g,y.canonical);for(;S+T<=C;){if(w+=x,w<l||w>=c)return null;if(E=k,P=A,M.push(E),f&&I.push(P),A=new e.Point(u.getx(w),u.gety(w)),k=h[w],!k){const e=ut(A,y.canonical,d,g,p);k=e[3]>0?h[w]=e:O()}S+=T,T=e.distance(E,k)}m&&p&&(h[w]&&(k=O(),T=e.distance(E,k)),h[w]=k);const D=(C-S)/T,R=A.sub(P)._mult(D)._add(P),z=e.sub([],k,E),L=e.scaleAndAdd([],E,z,D);let B=[0,0,1],N=z[0],F=z[1];if(v&&(B=g.upVector(y.canonical,R.x,R.y),0!==B[0]||0!==B[1]||1!==B[2])){const t=[B[2],0,-B[0]],n=e.cross([],B,t);e.normalize(t,t),e.normalize(n,n),N=e.dot(z,t),F=e.dot(z,n)}if(i){const t=e.cross([],B,z);e.normalize(t,t),e.scaleAndAdd(L,L,t,i*x)}const $=_+Math.atan2(F,N);return M.push(L),f&&I.push(R),{point:L,angle:$,path:M,tilePath:I,up:B}}function pt(e,t){const n=t.length,i=n+4*e;t.resize(i),t.float32.fill(-1/0,4*n,4*i)}function ft(e,t,n){const i=t[0],r=t[1];return e[0]=n[0]*i+n[4]*r+n[12],e[1]=n[1]*i+n[5]*r+n[13],e[3]=n[3]*i+n[7]*r+n[15],e}const mt=100;class gt{constructor(e,t,n=new Je(e.width+200,e.height+200,25),i=new Je(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=i,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+mt,this.screenBottomBoundary=e.height+mt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=t}placeCollisionBox(e,t,n,i,r,o,s,a){let l=n.projectedAnchorX,c=n.projectedAnchorY,u=n.projectedAnchorZ;const d=n.elevation,h=n.tileID,p=e.getProjection();if(d&&h){const[e,t,i]=p.upVector(h.canonical,n.tileAnchorX,n.tileAnchorY),r=p.upVectorScale(h.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;l+=e*d*r,c+=t*d*r,u+=i*d*r}const f=this.projectAndGetPerspectiveRatio(s,l,c,u,n.tileID,"globe"===p.name||!!d||this.transform.pitch>0,p),m=o*f.perspectiveRatio,g=(n.x1*t+i.x-n.padding)*m+f.point.x,y=(n.y1*t+i.y-n.padding)*m+f.point.y,v=(n.x2*t+i.x+n.padding)*m+f.point.x,b=(n.y2*t+i.y+n.padding)*m+f.point.y,x=f.perspectiveRatio<=.55||f.occluded;return!this.isInsideGrid(g,y,v,b)||!r&&this.grid.hitTest(g,y,v,b,a)||x?{box:[],offscreen:!1,occluded:f.occluded}:{box:[g,y,v,b],offscreen:this.isOffscreen(g,y,v,b),occluded:!1}}placeCollisionCircles(t,n,i,r,o,s,a,l,c,u,d,h,p,f,m){const g=[],y=this.transform.elevation,v=t.getProjection(),b=y?y.getAtTileOffsetFunc(m,this.transform.center.lat,this.transform.worldSize,v):null,x=new e.Point(i.tileAnchorX,i.tileAnchorY);let{x:_,y:w,z:k}=v.projectTilePoint(x.x,x.y,m.canonical);if(b){const[e,t,n]=b(x);_+=e,w+=t,k+=n}const E="globe"===v.name,S=this.projectAndGetPerspectiveRatio(a,_,w,k,m,E||!!y||this.transform.pitch>0,v),{perspectiveRatio:T}=S,C=(d?s/T:s*T)/e.ONE_EM,M=it(_,w,k,l),I=S.signedDistanceFromCamera>0?at(C,o,i.lineOffsetX*C,i.lineOffsetY*C,!1,M,x,i,r,l,{},y&&!d?b:null,d&&!!y,v,m,d):null;let A=!1,P=!1,O=!0;if(I&&!S.occluded){const t=.5*p*T+f,i=new e.Point(-100,-100),r=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),o=new Ke,{first:s,last:a}=I,l=s.path.length;let d=[];for(let e=l-1;e>=1;e--)d.push(s.path[e]);for(let e=1;e<a.path.length;e++)d.push(a.path[e]);const m=2.5*t;c&&(d=d.map((([e,t,n],i)=>(b&&!E&&(n=b(i<l-1?s.tilePath[l-1-i]:a.tilePath[i-l+2])[2]),it(e,t,n,c)))),d.some((e=>e[3]<=0))&&(d=[]));let y=[];if(d.length>0){let t=1/0,n=-1/0,o=1/0,s=-1/0;for(const e of d)t=Math.min(t,e[0]),o=Math.min(o,e[1]),n=Math.max(n,e[0]),s=Math.max(s,e[1]);n>=i.x&&t<=r.x&&s>=i.y&&o<=r.y&&(y=[d.map((t=>new e.Point(t[0],t[1])))],(t<i.x||n>r.x||o<i.y||s>r.y)&&(y=e.clipLine(y,i.x,i.y,r.x,r.y)))}for(const e of y){o.reset(e,.25*t);let i=0;i=o.length<=.5*t?1:Math.ceil(o.paddedLength/m)+1;for(let e=0;e<i;e++){const r=e/Math.max(i-1,1),s=o.lerp(r),a=s.x+mt,l=s.y+mt;g.push(a,l,t,0);const c=a-t,d=l-t,p=a+t,f=l+t;if(O=O&&this.isOffscreen(c,d,p,f),P=P||this.isInsideGrid(c,d,p,f),!n&&this.grid.hitTestCircle(a,l,t,h)&&(A=!0,!u))return{circles:[],offscreen:!1,collisionDetected:A,occluded:!1}}}}return{circles:!u&&A||!P?[]:g,offscreen:O,collisionDetected:A,occluded:S.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let i=1/0,r=1/0,o=-1/0,s=-1/0;for(const u of t){const t=new e.Point(u.x+mt,u.y+mt);i=Math.min(i,t.x),r=Math.min(r,t.y),o=Math.max(o,t.x),s=Math.max(s,t.y),n.push(t)}const a=this.grid.query(i,r,o,s).concat(this.ignoredGrid.query(i,r,o,s)),l={},c={};for(const u of a){const t=u.key;if(void 0===l[t.bucketInstanceId]&&(l[t.bucketInstanceId]={}),l[t.bucketInstanceId][t.featureIndex])continue;const i=[new e.Point(u.x1,u.y1),new e.Point(u.x2,u.y1),new e.Point(u.x2,u.y2),new e.Point(u.x1,u.y2)];e.polygonIntersectsPolygon(n,i)&&(l[t.bucketInstanceId][t.featureIndex]=!0,void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]=[]),c[t.bucketInstanceId].push(t.featureIndex))}return c}insertCollisionBox(e,t,n,i,r){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:n,featureIndex:i,collisionGroupID:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,n,i,r){const o=t?this.ignoredGrid:this.grid,s={bucketInstanceId:n,featureIndex:i,collisionGroupID:r};for(let a=0;a<e.length;a+=4)o.insertCircle(s,e[a],e[a+1],e[a+2])}projectAndGetPerspectiveRatio(t,n,i,r,o,s,a){const l=[n,i,r,1];let c=!1;if(r||this.transform.pitch>0){if(e.transformMat4$1(l,l,t),this.fogState&&o&&"globe"!==a.name){const t=function(t,n,i,r,o,s){const a=s.calculateFogTileMatrix(o),l=[n,i,r];return e.transformMat4(l,l,a),S(t,l,s.pitch,s._fov)}(this.fogState,n,i,r,o.toUnwrapped(),this.transform);c=t>.9}}else ft(l,l,t);const u=l[3];return{point:new e.Point((l[0]/u+1)/2*this.transform.width+mt,(-l[1]/u+1)/2*this.transform.height+mt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(a)/u*.5,1.5),signedDistanceFromCamera:u,occluded:s&&l[2]>u||c}}isOffscreen(e,t,n,i){return n<mt||e>=this.screenRightBoundary||i<mt||t>this.screenBottomBoundary}isInsideGrid(e,t,n,i){return n>=0&&e<this.gridRightBoundary&&i>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}function yt(t,n,i){const r=n.createTileMatrix(t,t.worldSize,i.toUnwrapped());return e.multiply(new Float32Array(16),t.projMatrix,r)}function vt(e,t,n){if(t.projection.name===n.projection.name)return e.projMatrix;const i=n.clone();return i.setProjection(t.projection),yt(i,t.getProjection(),e)}function bt(e,t,n){return t.name===n.projection.name?e.projMatrix:yt(n,t,e)}class xt{constructor(e,t,n,i){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):i&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class _t{constructor(e,t,n,i,r,o=!1){this.text=new xt(e?e.text:null,t,n,r),this.icon=new xt(e?e.icon:null,t,i,r),this.clipped=o}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class wt{constructor(e,t,n,i=!1){this.text=e,this.icon=t,this.skipFade=n,this.clipped=i}}class kt{constructor(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]}}class Et{constructor(e,t,n,i,r){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}}class St{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function Tt(t,n,i,r,o){const{horizontalAlign:s,verticalAlign:a}=e.getAnchorAlignment(t),l=-(s-.5)*n,c=-(a-.5)*i,u=e.evaluateVariableOffset(t,r);return new e.Point(l+u[0]*o,c+u[1]*o)}function Ct(t,n,i,r,o){const s=new e.Point(t,n);return i&&s._rotate(r?o:-o),s}class Mt{constructor(e,t,n,i,r){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new gt(this.transform,r),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new St(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,n,i,r){const o=i.getBucket(n),s=i.latestFeatureIndex;if(!o||!s||n.id!==o.layerIds[0])return;const a=o.layers[0].layout,l=i.collisionBoxArray,c=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),u=i.tileSize/e.EXTENT,d=i.tileID.toUnwrapped();this.transform.setProjection(o.projection);const h=(p=i.tileID,f=o.getProjection(),m=this.transform,f.name===this.projection?m.calculateProjMatrix(p.toUnwrapped()):yt(m,f,p));var p,f,m;const g="map"===a.get("text-pitch-alignment"),y="map"===a.get("text-rotation-alignment");n.compileFilter();const v=n.dynamicFilter(),b=n.dynamicFilterNeedsFeature(),x=this.transform.calculatePixelsToTileUnitsMatrix(i),_=tt(h,i.tileID.canonical,g,y,this.transform,o.getProjection(),x);let w=null;if(g){const t=nt(h,i.tileID.canonical,g,y,this.transform,o.getProjection(),x);w=e.multiply([],this.transform.labelPlaneMatrix,t)}let k=null;v&&i.latestFeatureIndex&&(k={unwrappedTileID:d,dynamicFilter:v,dynamicFilterNeedsFeature:b,featureIndex:i.latestFeatureIndex}),this.retainedQueryData[o.bucketInstanceId]=new Et(o.bucketInstanceId,s,o.sourceLayerIndex,o.index,i.tileID);const E={bucket:o,layout:a,posMatrix:h,textLabelPlaneMatrix:_,labelToScreenMatrix:w,clippingData:k,scale:c,textPixelRatio:u,holdingForFade:i.holdingForFade(),collisionBoxArray:l,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:e.evaluateSizeForZoom(o.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(r)for(const e of o.sortKeyRanges){const{sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r}=e;t.push({sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r,parameters:E})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:E})}attemptAnchorPlacement(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y){const{textOffset0:v,textOffset1:b,crossTileID:x}=d,_=[v,b],w=Tt(e,n,i,_,r),k=this.collisionIndex.placeCollisionBox(p,r,t,Ct(w.x,w.y,o,s,this.transform.angle),u,a,l,c.predicate);if(m){const e=p.getSymbolInstanceIconSize(y,this.transform.zoom,d.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(p,e,m,Ct(w.x,w.y,o,s,this.transform.angle),u,a,l,c.predicate).box.length)return}if(k.box.length>0){let t;return this.prevPlacement&&this.prevPlacement.variableOffsets[x]&&this.prevPlacement.placements[x]&&this.prevPlacement.placements[x].text&&(t=this.prevPlacement.variableOffsets[x].anchor),this.variableOffsets[x]={textOffset:_,width:n,height:i,anchor:e,textScale:r,prevAnchor:t},this.markUsedJustification(p,e,d,f),p.allowVerticalPlacement&&(this.markUsedOrientation(p,f,d),this.placedOrientations[x]=f),{shift:w,placedGlyphBoxes:k}}}placeLayerBucketPart(t,n,i,r){const{bucket:o,layout:s,posMatrix:a,textLabelPlaneMatrix:l,labelToScreenMatrix:c,clippingData:u,textPixelRatio:d,holdingForFade:h,collisionBoxArray:p,partiallyEvaluatedTextSize:f,partiallyEvaluatedIconSize:m,collisionGroup:g}=t.parameters,y=s.get("text-optional"),v=s.get("icon-optional"),b=s.get("text-allow-overlap"),x=s.get("icon-allow-overlap"),_="map"===s.get("text-rotation-alignment"),w="map"===s.get("text-pitch-alignment"),k="none"!==s.get("icon-text-fit"),E="viewport-y"===s.get("symbol-z-order");this.transform.setProjection(o.projection);let S=b&&(x||!o.hasIconData()||v),T=x&&(b||!o.hasTextData()||y);!o.collisionArrays&&p&&o.deserializeCollisionBoxes(p),i&&r&&o.updateCollisionDebugBuffers(this.transform.zoom,p);const C=(t,r,p)=>{const{crossTileID:E,numVerticalGlyphVertices:C}=t;if(u){const i={zoom:this.transform.zoom,pitch:this.transform.pitch};let r=null;if(u.dynamicFilterNeedsFeature){const e=this.retainedQueryData[o.bucketInstanceId];r=u.featureIndex.loadFeature({featureIndex:t.featureIndex,bucketIndex:e.bucketIndex,sourceLayerIndex:e.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,u.dynamicFilter)(i,r,this.retainedQueryData[o.bucketInstanceId].tileID.canonical,new e.Point(t.tileAnchorX,t.tileAnchorY),this.transform.calculateDistanceTileData(u.unwrappedTileID)))return this.placements[E]=new wt(!1,!1,!1,!0),void n.add(E)}if(n.has(E))return;if(h)return void(this.placements[E]=new wt(!1,!1,!1));let M=!1,I=!1,A=!0,P=!1,O=!1,D=null,R={box:null,offscreen:null,occluded:null},z={box:null,offscreen:null,occluded:null},L=null,B=null,N=null,F=0,$=0,j=0;p.textFeatureIndex?F=p.textFeatureIndex:t.useRuntimeCollisionCircles&&(F=t.featureIndex),p.verticalTextFeatureIndex&&($=p.verticalTextFeatureIndex);const V=e=>{e.tileID=this.retainedQueryData[o.bucketInstanceId].tileID;const t=this.transform.elevation;(t||e.elevation)&&(e.elevation=t?t.getAtTileOffset(e.tileID,e.tileAnchorX,e.tileAnchorY):0)},U=p.textBox;if(U){V(U);const n=n=>{let i=e.WritingMode.horizontal;if(o.allowVerticalPlacement&&!n&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[E];e&&(this.placedOrientations[E]=e,i=e,this.markUsedOrientation(o,i,t))}return i},i=(t,n)=>{if(o.allowVerticalPlacement&&C>0&&p.verticalTextBox){for(const i of o.writingModes)if(i===e.WritingMode.vertical?(R=n(),z=R):R=t(),R&&R.box&&R.box.length)break}else R=t()};if(s.get("text-variable-anchor")){let l=s.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E]){const e=this.prevPlacement.variableOffsets[E];l.indexOf(e.anchor)>0&&(l=l.filter((t=>t!==e.anchor)),l.unshift(e.anchor))}const c=(e,n,i)=>{const s=o.getSymbolInstanceTextSize(f,t,this.transform.zoom,r),c=(e.x2-e.x1)*s+2*e.padding,u=(e.y2-e.y1)*s+2*e.padding,h=k&&!x?n:null;h&&V(h);let p={box:[],offscreen:!1,occluded:!1};const y=b?2*l.length:l.length;for(let v=0;v<y;++v){const n=this.attemptAnchorPlacement(l[v%l.length],e,c,u,s,_,w,d,a,g,v>=l.length,t,r,o,i,h,f,m);if(n&&(p=n.placedGlyphBoxes,p&&p.box&&p.box.length)){M=!0,D=n.shift;break}}return p};i((()=>c(U,p.iconBox,e.WritingMode.horizontal)),(()=>{const t=p.verticalTextBox;return t&&V(t),o.allowVerticalPlacement&&!(R&&R.box&&R.box.length)&&C>0&&t?c(t,p.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),R&&(M=R.box,A=R.offscreen,P=R.occluded);const u=n(!(!R||!R.box));if(!M&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[E];e&&(this.variableOffsets[E]=e,this.markUsedJustification(o,e.anchor,t,u))}}else{const s=(n,i)=>{const s=o.getSymbolInstanceTextSize(f,t,this.transform.zoom,r),l=this.collisionIndex.placeCollisionBox(o,s,n,new e.Point(0,0),b,d,a,g.predicate);return l&&l.box&&l.box.length&&(this.markUsedOrientation(o,i,t),this.placedOrientations[E]=i),l};i((()=>s(U,e.WritingMode.horizontal)),(()=>{const t=p.verticalTextBox;return o.allowVerticalPlacement&&C>0&&t?(V(t),s(t,e.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),n(!!(R&&R.box&&R.box.length))}}if(L=R,M=L&&L.box&&L.box.length>0,A=L&&L.offscreen,P=L&&L.occluded,t.useRuntimeCollisionCircles){const n=o.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),r=e.evaluateSizeForFeature(o.textSizeData,f,n),u=s.get("text-padding");B=this.collisionIndex.placeCollisionCircles(o,b,n,o.lineVertexArray,o.glyphOffsetArray,r,a,l,c,i,w,g.predicate,t.collisionCircleDiameter*r/e.ONE_EM,u,this.retainedQueryData[o.bucketInstanceId].tileID),M=b||B.circles.length>0&&!B.collisionDetected,A=A&&B.offscreen,P=B.occluded}if(p.iconFeatureIndex&&(j=p.iconFeatureIndex),p.iconBox){const n=n=>{V(n);const i=k&&D?Ct(D.x,D.y,_,w,this.transform.angle):new e.Point(0,0),r=o.getSymbolInstanceIconSize(m,this.transform.zoom,t.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(o,r,n,i,x,d,a,g.predicate)};z&&z.box&&z.box.length&&p.verticalIconBox?(N=n(p.verticalIconBox),I=N.box.length>0):(N=n(p.iconBox),I=N.box.length>0),A=A&&N.offscreen,O=N.occluded}const q=y||0===t.numHorizontalGlyphVertices&&0===C,G=v||0===t.numIconVertices;if(q||G?G?q||(I=I&&M):M=I&&M:I=M=I&&M,M&&L&&L.box&&this.collisionIndex.insertCollisionBox(L.box,s.get("text-ignore-placement"),o.bucketInstanceId,z&&z.box&&$?$:F,g.ID),I&&N&&this.collisionIndex.insertCollisionBox(N.box,s.get("icon-ignore-placement"),o.bucketInstanceId,j,g.ID),B&&(M&&this.collisionIndex.insertCollisionCircles(B.circles,s.get("text-ignore-placement"),o.bucketInstanceId,F,g.ID),i)){const e=o.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new kt);for(let n=0;n<B.circles.length;n+=4)t.circles.push(B.circles[n+0]),t.circles.push(B.circles[n+1]),t.circles.push(B.circles[n+2]),t.circles.push(B.collisionDetected?1:0)}const W="globe"!==o.projection.name;S=S&&(W||!P),T=T&&(W||!O),this.placements[E]=new wt(M||S,I||T,A||o.justReloaded),n.add(E)};if(E){const e=o.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const n=e[t];C(o.symbolInstances.get(n),n,o.collisionArrays[n])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)C(o.symbolInstances.get(e),e,o.collisionArrays[e]);if(i&&o.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[o.bucketInstanceId];e.invert(t.invProjMatrix,a),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}o.justReloaded=!1}markUsedJustification(t,n,i,r){const{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:a,verticalPlacedTextSymbolIndex:l,crossTileID:c}=i,u=e.getAnchorJustification(n),d=r===e.WritingMode.vertical?l:"left"===u?o:"center"===u?s:"right"===u?a:-1;o>=0&&(t.text.placedSymbolArray.get(o).crossTileID=d>=0&&o!==d?0:c),s>=0&&(t.text.placedSymbolArray.get(s).crossTileID=d>=0&&s!==d?0:c),a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=d>=0&&a!==d?0:c),l>=0&&(t.text.placedSymbolArray.get(l).crossTileID=d>=0&&l!==d?0:c)}markUsedOrientation(t,n,i){const r=n===e.WritingMode.horizontal||n===e.WritingMode.horizontalOnly?n:0,o=n===e.WritingMode.vertical?n:0,{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:l,verticalPlacedTextSymbolIndex:c}=i,u=t.text.placedSymbolArray;s>=0&&(u.get(s).placedOrientation=r),a>=0&&(u.get(a).placedOrientation=r),l>=0&&(u.get(l).placedOrientation=r),c>=0&&(u.get(c).placedOrientation=o)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let n=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const i=t?t.symbolFadeChange(e):1,r=t?t.opacities:{},o=t?t.variableOffsets:{},s=t?t.placedOrientations:{};for(const a in this.placements){const e=this.placements[a],t=r[a];t?(this.opacities[a]=new _t(t,i,e.text,e.icon,null,e.clipped),n=n||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[a]=new _t(null,i,e.text,e.icon,e.skipFade,e.clipped),n=n||e.text||e.icon)}for(const a in r){const e=r[a];if(!this.opacities[a]){const t=new _t(e,i,!1,!1);t.isHidden()||(this.opacities[a]=t,n=n||e.text.placed||e.icon.placed)}}for(const a in o)this.variableOffsets[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.variableOffsets[a]=o[a]);for(const a in s)this.placedOrientations[a]||!this.opacities[a]||this.opacities[a].isHidden()||(this.placedOrientations[a]=s[a]);n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const n=new Set;for(const i of t){const t=i.getBucket(e);t&&i.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,n,i.collisionBoxArray)}}updateBucketOpacities(t,n,i){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const r=t.layers[0].layout,o=!!t.layers[0].dynamicFilter(),s=new _t(null,0,!1,!1,!0),a=r.get("text-allow-overlap"),l=r.get("icon-allow-overlap"),c=r.get("text-variable-anchor"),u="map"===r.get("text-rotation-alignment"),d="map"===r.get("text-pitch-alignment"),h="none"!==r.get("icon-text-fit"),p=new _t(null,0,a&&(l||!t.hasIconData()||r.get("icon-optional")),l&&(a||!t.hasTextData()||r.get("text-optional")),!0);!t.collisionArrays&&i&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(i);const f=(e,t,n)=>{for(let i=0;i<t/4;i++)e.opacityVertexArray.emplaceBack(n)};let m=0;for(let g=0;g<t.symbolInstances.length;g++){const i=t.symbolInstances.get(g),{numHorizontalGlyphVertices:r,numVerticalGlyphVertices:a,crossTileID:l,numIconVertices:y}=i,v=n.has(l);let b=this.opacities[l];v?b=s:b||(b=p,this.opacities[l]=b),n.add(l);const x=r>0||a>0,_=y>0,w=this.placedOrientations[l],k=w===e.WritingMode.vertical,E=w===e.WritingMode.horizontal||w===e.WritingMode.horizontalOnly;if(!x&&!_||b.isHidden()||m++,x){const e=Bt(b.text);f(t.text,r,k?Nt:e),f(t.text,a,E?Nt:e);const n=b.text.isHidden(),{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:c,verticalPlacedTextSymbolIndex:u}=i,d=t.text.placedSymbolArray,h=n||k?1:0;o>=0&&(d.get(o).hidden=h),s>=0&&(d.get(s).hidden=h),c>=0&&(d.get(c).hidden=h),u>=0&&(d.get(u).hidden=n||E?1:0);const p=this.variableOffsets[l];p&&this.markUsedJustification(t,p.anchor,i,w);const m=this.placedOrientations[l];m&&(this.markUsedJustification(t,"left",i,m),this.markUsedOrientation(t,m,i))}if(_){const e=Bt(b.icon),{placedIconSymbolIndex:n,verticalPlacedIconSymbolIndex:r}=i,o=t.icon.placedSymbolArray,s=b.icon.isHidden()?1:0;n>=0&&(f(t.icon,y,k?Nt:e),o.get(n).hidden=s),r>=0&&(f(t.icon,i.numVerticalIconVertices,E?Nt:e),o.get(r).hidden=s)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const n=t.collisionArrays[g];if(n){let i=new e.Point(0,0),r=!0;if(n.textBox||n.verticalTextBox){if(c){const e=this.variableOffsets[l];e?(i=Tt(e.anchor,e.width,e.height,e.textOffset,e.textScale),u&&i._rotate(d?this.transform.angle:-this.transform.angle)):r=!1}o&&(r=!b.clipped),n.textBox&&It(t.textCollisionBox.collisionVertexArray,b.text.placed,!r||k,i.x,i.y),n.verticalTextBox&&It(t.textCollisionBox.collisionVertexArray,b.text.placed,!r||E,i.x,i.y)}const s=r&&Boolean(!E&&n.verticalIconBox);n.iconBox&&It(t.iconCollisionBox.collisionVertexArray,b.icon.placed,s,h?i.x:0,h?i.y:0),n.verticalIconBox&&It(t.iconCollisionBox.collisionVertexArray,b.icon.placed,!s,h?i.x:0,h?i.y:0)}}}if(t.fullyClipped=0===m,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const n=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*n>e}setStale(){this.stale=!0}}function It(e,t,n,i,r){e.emplaceBack(t?1:0,n?1:0,i||0,r||0),e.emplaceBack(t?1:0,n?1:0,i||0,r||0),e.emplaceBack(t?1:0,n?1:0,i||0,r||0),e.emplaceBack(t?1:0,n?1:0,i||0,r||0)}const At=Math.pow(2,25),Pt=Math.pow(2,24),Ot=Math.pow(2,17),Dt=Math.pow(2,16),Rt=Math.pow(2,9),zt=Math.pow(2,8),Lt=Math.pow(2,1);function Bt(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,n=Math.floor(127*e.opacity);return n*At+t*Pt+n*Ot+t*Dt+n*Rt+t*zt+n*Lt+t}const Nt=0;class Ft{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,t,n,i,r){const o=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(o,i,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<o.length;){const e=o[this._currentPartIndex];if(t.placeLayerBucketPart(e,this._seenCrossTileIDs,n,0===e.symbolInstanceStart),this._currentPartIndex++,r())return!0}return!1}}class $t{constructor(e,t,n,i,r,o,s,a){this.placement=new Mt(e,r,o,s,a),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(t,n,i){const r=e.exported.now(),o=()=>{const t=e.exported.now()-r;return!this._forceFullPlacement&&t>2};for(;this._currentPlacementIndex>=0;){const e=n[t[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===e.type&&(!e.minzoom||e.minzoom<=r)&&(!e.maxzoom||e.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new Ft(e)),this._inProgressLayer.continuePlacement(i[e.source],this.placement,this._showCollisionBoxes,e,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const jt=512/e.EXTENT/2;class Vt{constructor(t,n,i){this.tileID=t,this.bucketInstanceId=i,this.index=new e.KDBush(n.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const r=t.canonical.x*e.EXTENT,o=t.canonical.y*e.EXTENT;for(let e=0;e<n.length;e++){const{key:t,crossTileID:i,tileAnchorX:s,tileAnchorY:a}=n.get(e),l=Math.floor((r+s)*jt),c=Math.floor((o+a)*jt);this.index.add(l,c),this.keys.push(t),this.crossTileIDs.push(i)}this.index.finish()}findMatches(t,n,i){const r=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),o=jt/Math.pow(2,n.canonical.z-this.tileID.canonical.z),s=n.canonical.x*e.EXTENT,a=n.canonical.y*e.EXTENT;for(let e=0;e<t.length;e++){const n=t.get(e);if(n.crossTileID)continue;const{key:l,tileAnchorX:c,tileAnchorY:u}=n,d=Math.floor((s+c)*o),h=Math.floor((a+u)*o),p=this.index.range(d-r,h-r,d+r,h+r);for(const e of p){const t=this.crossTileIDs[e];if(this.keys[e]===l&&!i.has(t)){i.add(t),n.crossTileID=t;break}}}}}class Ut{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const n in this.indexes){const e=this.indexes[n],i={};for(const n in e){const r=e[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),i[r.tileID.key]=r}this.indexes[n]=i}this.lng=e}addBucket(e,t,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let r=0;r<t.symbolInstances.length;r++)t.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const i=this.usedCrossTileIDs[e.overscaledZ];for(const r in this.indexes){const n=this.indexes[r];if(Number(r)>e.overscaledZ)for(const r in n){const o=n[r];o.tileID.isChildOf(e)&&o.findMatches(t.symbolInstances,e,i)}else{const o=n[e.scaledTo(Number(r)).key];o&&o.findMatches(t.symbolInstances,e,i)}}for(let r=0;r<t.symbolInstances.length;r++){const e=t.symbolInstances.get(r);e.crossTileID||(e.crossTileID=n.generate(),i.add(e.crossTileID))}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Vt(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const n of t.crossTileIDs)this.usedCrossTileIDs[e].delete(n)}removeStaleBuckets(e){let t=!1;for(const n in this.indexes){const i=this.indexes[n];for(const r in i)e[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],t=!0)}return t}}class Gt{constructor(){this.layerIndexes={},this.crossTileIDs=new Ut,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,n,i){let r=this.layerIndexes[e.id];void 0===r&&(r=this.layerIndexes[e.id]=new qt);let o=!1;const s={};"globe"!==i.name&&r.handleWrapJump(n);for(const a of t){const t=a.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(a.tileID,t,this.crossTileIDs)&&(o=!0),s[t.bucketInstanceId]=!0)}return r.removeStaleBuckets(s)&&(o=!0),o}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const n in this.layerIndexes)t[n]||delete this.layerIndexes[n]}}const Wt=(t,n)=>e.emitValidationErrors(t,n&&n.filter((e=>"source.canvas"!==e.identifier))),Ht=e.pick(Ve,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Zt=e.pick(Ve,["setCenter","setZoom","setBearing","setPitch"]),Xt={version:8,layers:[],sources:{}},Kt={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Jt extends e.Evented{constructor(t,n={}){super(),this.map=t,this.dispatcher=new I(Fe(),this),this.imageManager=new x,this.imageManager.setEventedParent(this),this.glyphManager=new e.GlyphManager(t._requestManager,n.localFontFamily?e.LocalGlyphMode.all:n.localIdeographFontFamily?e.LocalGlyphMode.ideographs:e.LocalGlyphMode.none,n.localFontFamily||n.localIdeographFontFamily),this.crossTileSymbolIndex=new Gt,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());const i=this;this._rtlTextPluginCallback=Jt.registerForPluginStateChange((t=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,n)=>{if(e.triggerPluginCompletionEvent(t),n&&n.every((e=>e)))for(const e in i._sourceCaches){const t=i._sourceCaches[e],n=t.getSource().type;"vector"!==n&&"geojson"!==n||t.reload()}}))})),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.getSource(e.sourceId);if(t&&t.vectorLayerIds)for(const n in this._layers){const e=this._layers[n];e.source===t.id&&this._validateLayer(e)}}))}loadURL(t,n={}){this.fire(new e.Event("dataloading",{dataType:"style"}));const i="boolean"==typeof n.validate?n.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,n.accessToken);const r=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(r,((t,n)=>{this._request=null,t?this.fire(new e.ErrorEvent(t)):n&&this._load(n,i)}))}loadJSON(t,n={}){this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame((()=>{this._request=null,this._load(t,!1!==n.validate)}))}loadEmpty(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Xt,!1)}_updateLayerCount(e,t){const n=t?1:-1;e.is3D()&&(this._num3DLayers+=n),"circle"===e.type&&(this._numCircleLayers+=n),"symbol"===e.type&&(this._numSymbolLayers+=n)}_load(t,n){if(n&&Wt(this,e.validateStyle(t)))return;this._loaded=!0,this.stylesheet=e.clone$1(t),this._updateMapProjection();for(const e in t.sources)this.addSource(e,t.sources[e],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const i=je(this.stylesheet.layers);this._order=i.map((e=>e.id)),this._layers={},this._serializedLayers={};for(const r of i){const t=e.createStyleLayer(r);t.setEventedParent(this,{layer:{id:t.id}}),this._layers[t.id]=t,this._serializedLayers[t.id]=t.serialize(),this._updateLayerCount(t,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(t){this._spriteRequest=function(t,n,i){let r,o,s;const a=e.exported.devicePixelRatio>1?"@2x":"";let l=e.getJSON(n.transformRequest(n.normalizeSpriteURL(t,a,".json"),e.ResourceType.SpriteJSON),((e,t)=>{l=null,s||(s=e,r=t,u())})),c=e.getImage(n.transformRequest(n.normalizeSpriteURL(t,a,".png"),e.ResourceType.SpriteImage),((e,t)=>{c=null,s||(s=e,o=t,u())}));function u(){if(s)i(s);else if(r&&o){const t=e.exported.getImageData(o),n={};for(const i in r){const{width:o,height:s,x:a,y:l,sdf:c,pixelRatio:u,stretchX:d,stretchY:h,content:p}=r[i],f=new e.RGBAImage({width:o,height:s});e.RGBAImage.copy(t,f,{x:a,y:l},{x:0,y:0},{width:o,height:s}),n[i]={data:f,pixelRatio:u,sdf:c,stretchX:d,stretchY:h,content:p}}i(null,n)}}return{cancel(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,((t,n)=>{if(this._spriteRequest=null,t)this.fire(new e.ErrorEvent(t));else if(n)for(const e in n)this.imageManager.addImage(e,n[e]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new e.Event("data",{dataType:"style"}))}))}_validateLayer(t){const n=this.getSource(t.source);if(!n)return;const i=t.sourceLayer;i&&("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(i))&&this.fire(new e.ErrorEvent(new Error(`Source layer "${i}" does not exist on source "${n.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(e){const t=[];for(const n of e){const e=this._layers[n];"custom"!==e.type&&t.push(e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(e){return!!this.terrain&&("function"==typeof e.isLayerDraped?e.isLayerDraped():Kt[e.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const n=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(e.length||n.length)&&this._updateWorkerLayers(e,n);for(const t in this._updatedSources){const e=this._updatedSources[t];"reload"===e?this._reloadSource(t):"clear"===e&&this._clearSource(t)}this._updateTilesForChangedImages();for(const i in this._updatedPaintProps)this._layers[i].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const i={};for(const e in this._sourceCaches){const t=this._sourceCaches[e];i[e]=t.used,t.used=!1}for(const e of this._order){const n=this._layers[e];if(n.recalculate(t,this._availableImages),!n.isHidden(t.zoom)){const e=this._getLayerSourceCache(n);e&&(e.used=!0)}const i=this.map.painter;if(i){const e=n.getProgramIds();if(!e)continue;const r=n.getProgramConfiguration(t.zoom);for(const t of e)i.useProgram(t,r)}}for(const r in i){const t=this._sourceCaches[r];i[r]!==t.used&&t.getSource().fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:t.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),n&&this.fire(new e.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),Wt(this,e.validateStyle(n)))return!1;(n=e.clone$1(n)).layers=je(n.layers);const i=function(e,n){if(!e)return[{command:Ve.setStyle,args:[n]}];let i=[];try{if(!t(e.version,n.version))return[{command:Ve.setStyle,args:[n]}];t(e.center,n.center)||i.push({command:Ve.setCenter,args:[n.center]}),t(e.zoom,n.zoom)||i.push({command:Ve.setZoom,args:[n.zoom]}),t(e.bearing,n.bearing)||i.push({command:Ve.setBearing,args:[n.bearing]}),t(e.pitch,n.pitch)||i.push({command:Ve.setPitch,args:[n.pitch]}),t(e.sprite,n.sprite)||i.push({command:Ve.setSprite,args:[n.sprite]}),t(e.glyphs,n.glyphs)||i.push({command:Ve.setGlyphs,args:[n.glyphs]}),t(e.transition,n.transition)||i.push({command:Ve.setTransition,args:[n.transition]}),t(e.light,n.light)||i.push({command:Ve.setLight,args:[n.light]}),t(e.fog,n.fog)||i.push({command:Ve.setFog,args:[n.fog]}),t(e.projection,n.projection)||i.push({command:Ve.setProjection,args:[n.projection]});const r={},o=[];!function(e,n,i,r){let o;for(o in n=n||{},e=e||{})e.hasOwnProperty(o)&&(n.hasOwnProperty(o)||qe(o,i,r));for(o in n){if(!n.hasOwnProperty(o))continue;const s=n[o];e.hasOwnProperty(o)?t(e[o],s)||("geojson"===e[o].type&&"geojson"===s.type&&We(e,n,o)?i.push({command:Ve.setGeoJSONSourceData,args:[o,s.data]}):Ge(o,n,i,r)):Ue(o,n,i)}}(e.sources,n.sources,o,r);const s=[];e.layers&&e.layers.forEach((e=>{e.source&&r[e.source]?i.push({command:Ve.removeLayer,args:[e.id]}):s.push(e)}));let a=e.terrain;a&&r[a.source]&&(i.push({command:Ve.setTerrain,args:[void 0]}),a=void 0),i=i.concat(o),t(a,n.terrain)||i.push({command:Ve.setTerrain,args:[n.terrain]}),function(e,n,i){n=n||[];const r=(e=e||[]).map(Ze),o=n.map(Ze),s=e.reduce(Xe,{}),a=n.reduce(Xe,{}),l=r.slice(),c=Object.create(null);let u,d,h,p,f,m,g;for(u=0,d=0;u<r.length;u++)h=r[u],a.hasOwnProperty(h)?d++:(i.push({command:Ve.removeLayer,args:[h]}),l.splice(l.indexOf(h,d),1));for(u=0,d=0;u<o.length;u++)h=o[o.length-1-u],l[l.length-1-u]!==h&&(s.hasOwnProperty(h)?(i.push({command:Ve.removeLayer,args:[h]}),l.splice(l.lastIndexOf(h,l.length-d),1)):d++,m=l[l.length-u],i.push({command:Ve.addLayer,args:[a[h],m]}),l.splice(l.length-u,0,h),c[h]=!0);for(u=0;u<o.length;u++)if(h=o[u],p=s[h],f=a[h],!c[h]&&!t(p,f))if(t(p.source,f.source)&&t(p["source-layer"],f["source-layer"])&&t(p.type,f.type)){for(g in He(p.layout,f.layout,i,h,null,Ve.setLayoutProperty),He(p.paint,f.paint,i,h,null,Ve.setPaintProperty),t(p.filter,f.filter)||i.push({command:Ve.setFilter,args:[h,f.filter]}),t(p.minzoom,f.minzoom)&&t(p.maxzoom,f.maxzoom)||i.push({command:Ve.setLayerZoomRange,args:[h,f.minzoom,f.maxzoom]}),p)p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?He(p[g],f[g],i,h,g.slice(6),Ve.setPaintProperty):t(p[g],f[g])||i.push({command:Ve.setLayerProperty,args:[h,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!p.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?He(p[g],f[g],i,h,g.slice(6),Ve.setPaintProperty):t(p[g],f[g])||i.push({command:Ve.setLayerProperty,args:[h,g,f[g]]}))}else i.push({command:Ve.removeLayer,args:[h]}),m=l[l.lastIndexOf(h)+1],i.push({command:Ve.addLayer,args:[f,m]})}(s,n.layers,i)}catch(e){console.warn("Unable to compute style diff:",e),i=[{command:Ve.setStyle,args:[n]}]}return i}(this.serialize(),n).filter((e=>!(e.command in Zt)));if(0===i.length)return!1;const r=i.filter((e=>!(e.command in Ht)));if(r.length>0)throw new Error(`Unimplemented: ${r.map((e=>e.command)).join(", ")}.`);return i.forEach((e=>{"setTransition"!==e.command&&"setProjection"!==e.command&&this[e.command].apply(this,e.args)})),this.stylesheet=n,this._updateMapProjection(),!0}addImage(t,n){return this.getImage(t)?this.fire(new e.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,n),this._afterImageUpdated(t),this)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,n,i={}){if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(e.validateSource,`sources.${t}`,n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const r=Ae(t,n,this.dispatcher,this);r.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:r.serialize(),sourceId:t})));const o=n=>{const i=(n?"symbol:":"other:")+t,o=this._sourceCaches[i]=new e.SourceCache(i,r,n);(n?this._symbolSourceCaches:this._otherSourceCaches)[t]=o,o.style=this,o.onAdd(this.map)};o(!1),"vector"!==n.type&&"geojson"!==n.type||o(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const n=this.getSource(t);if(!n)throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${r}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new e.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const i=this._getSourceCaches(t);for(const r of i)delete this._sourceCaches[r.id],delete this._updatedSources[r.id],r.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r.getSource().id})),r.setEventedParent(null),r.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],n.setEventedParent(null),n.onRemove&&n.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(e,t){this._checkLoaded(),this.getSource(e).setData(t),this._changed=!0}getSource(e){const t=this._getSourceCache(e);return t&&t.getSource()}_getSources(){const e=[];for(const t in this._otherSourceCaches){const n=this._getSourceCache(t);n&&e.push(n.getSource())}return e}addLayer(t,n,i={}){this._checkLoaded();const r=t.id;if(this.getLayer(r))return void this.fire(new e.ErrorEvent(new Error(`Layer with id "${r}" already exists on this map`)));let o;if("custom"===t.type){if(Wt(this,e.validateCustomStyleLayer(t)))return;o=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(r,t.source),t=e.clone$1(t),t=e.extend(t,{source:r})),this._validate(e.validateLayer,`layers.${r}`,t,{arrayIndex:-1},i))return;o=e.createStyleLayer(t),this._validateLayer(o),o.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[o.id]=o.serialize(),this._updateLayerCount(o,!0)}const s=n?this._order.indexOf(n):this._order.length;if(n&&-1===s)return void this.fire(new e.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`)));this._order.splice(s,0,r),this._layerOrderChanged=!0,this._layers[r]=o;const a=this._getLayerSourceCache(o);if(this._removedLayers[r]&&o.source&&a&&"custom"!==o.type){const e=this._removedLayers[r];delete this._removedLayers[r],e.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",a.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,n){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===n)return;const i=this._order.indexOf(t);this._order.splice(i,1);const r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new e.ErrorEvent(new Error(`Layer with id "${n}" does not exist on this map.`))):(this._order.splice(r,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const n=this._layers[t];if(!n)return void this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));n.setEventedParent(null),this._updateLayerCount(n,!1);const i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=n,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],n.onRemove&&n.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(e){return this._layers[e]}hasLayer(e){return e in this._layers}hasLayerType(e){for(const t in this._layers)if(this._layers[t].type===e)return!0;return!1}setLayerZoomRange(t,n,i){this._checkLoaded();const r=this.getLayer(t);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(n,i,r={}){this._checkLoaded();const o=this.getLayer(n);if(o){if(!t(o.filter,i))return null==i?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(e.validateFilter,`layers.${o.id}.filter`,i,{layerType:o.type},r)||(o.filter=e.clone$1(i),this._updateLayer(o)))}else this.fire(new e.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const n=this.getLayer(t);return n&&e.clone$1(n.filter)}setLayoutProperty(n,i,r,o={}){this._checkLoaded();const s=this.getLayer(n);s?t(s.getLayoutProperty(i),r)||(s.setLayoutProperty(i,r,o),this._updateLayer(s)):this.fire(new e.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,n){const i=this.getLayer(t);if(i)return i.getLayoutProperty(n);this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(n,i,r,o={}){this._checkLoaded();const s=this.getLayer(n);s?t(s.getPaintProperty(i),r)||(s.setPaintProperty(i,r,o)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new e.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(e,t){const n=this.getLayer(e);return n&&n.getPaintProperty(t)}setFeatureState(t,n){this._checkLoaded();const i=t.source,r=t.sourceLayer,o=this.getSource(i);if(!o)return void this.fire(new e.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)));const s=o.type;if("geojson"===s&&r)return void this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===s&&!r)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));const a=this._getSourceCaches(i);for(const e of a)e.setFeatureState(r,t.id,n)}removeFeatureState(t,n){this._checkLoaded();const i=t.source,r=this.getSource(i);if(!r)return void this.fire(new e.ErrorEvent(new Error(`The source '${i}' does not exist in the map's style.`)));const o=r.type,s="vector"===o?t.sourceLayer:void 0;if("vector"===o&&!s)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(n&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const a=this._getSourceCaches(i);for(const e of a)e.removeFeatureState(s,t.id,n)}getFeatureState(t){this._checkLoaded();const n=t.source,i=t.sourceLayer,r=this.getSource(n);if(r){if("vector"!==r.type||i)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(n)[0].getFeatureState(i,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const e in this._sourceCaches){const n=this._sourceCaches[e].getSource();t[n.id]||(t[n.id]=n.serialize())}return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0;const t=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&t&&"raster"!==t.getSource().type&&(this._updatedSources[e.source]="reload",t.pause()),this._changed=!0,e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,n={},i=[];for(let o=this._order.length-1;o>=0;o--){const r=this._order[o];if(t(r)){n[r]=o;for(const t of e){const e=t[r];if(e)for(const t of e)i.push(t)}}}i.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const r=[];for(let o=this._order.length-1;o>=0;o--){const s=this._order[o];if(t(s))for(let e=i.length-1;e>=0;e--){const t=i[e].feature;if(n[t.layer.id]<o)break;r.push(t),i.pop()}else for(const t of e){const e=t[s];if(e)for(const t of e)r.push(t.feature)}}return r}queryRenderedFeatures(t,n,i){n&&n.filter&&this._validate(e.validateFilter,"queryRenderedFeatures.filter",n.filter,null,n);const r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const t of n.layers){const n=this._layers[t];if(!n)return this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];r[n.source]=!0}}const o=[];n.availableImages=this._availableImages;const s=n&&n.layers?n.layers.some((e=>{const t=this.getLayer(e);return t&&t.is3D()})):this.has3DLayers(),a=P.createFromScreenPoints(t,i);for(const e in this._sourceCaches){const t=this._sourceCaches[e].getSource().id;n.layers&&!r[t]||o.push(Oe(this._sourceCaches[e],this._layers,this._serializedLayers,a,n,i,s,!!this.map._showQueryGeometry))}return this.placement&&o.push(function(e,t,n,i,r,o,s){const a={},l=o.queryRenderedSymbols(i),c=[];for(const u of Object.keys(l).map(Number))c.push(s[u]);c.sort(Re);for(const u of c){const n=u.featureIndex.lookupSymbolFeatures(l[u.bucketInstanceId],t,u.bucketIndex,u.sourceLayerIndex,r.filter,r.layers,r.availableImages,e);for(const e in n){const t=a[e]=a[e]||[],i=n[e];i.sort(((e,t)=>{const n=u.featureSortOrder;if(n){const i=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-i}return t.featureIndex-e.featureIndex}));for(const e of i)t.push(e)}}for(const u in a)a[u].forEach((t=>{const i=t.feature,r=n(e[u]);if(!r)return;const o=r.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=o}));return a}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),a.screenGeometry,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(t,n){n&&n.filter&&this._validate(e.validateFilter,"querySourceFeatures.filter",n.filter,null,n);const i=this._getSourceCaches(t);let r=[];for(const e of i)r=r.concat(De(e,n));return r}addSourceType(e,t,n){return Jt.getSourceType(e)?n(new Error(`A source type called "${e}" already exists.`)):(Jt.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},n):n(null,null))}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const i=this.light.getLight();let r=!1;for(const s in e)if(!t(e[s],i[s])){r=!0;break}if(!r)return;const o=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(e,n),this.light.updateTransitions(o)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n,i=1){if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let r=n;if(1===i){if("object"==typeof r.source){const t="terrain-dem-src";this.addSource(t,r.source),r=e.clone$1(r),r=e.extend(r,{source:t})}if(this._validate(e.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&i!==this.terrain.drapeRenderMode){if(!r)return;this._createTerrain(r,i)}else{const n=this.terrain,i=n.get();for(const t of Object.keys(e.spec.terrain))!r.hasOwnProperty(t)&&e.spec.terrain[t].default&&(r[t]=e.spec.terrain[t].default);for(const e in r)if(!t(r[e],i[e])){n.set(r),this.stylesheet.terrain=r;const e=this._setTransitionParameters({duration:0});n.updateTransitions(e);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const t=this.fog=new M(e,this.map.transform);this.stylesheet.fog=e;const n=this._setTransitionParameters({duration:0});t.updateTransitions(n)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const e of this.map._markers)e._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const n=this.fog,i=n.get();0===Object.keys(e).length&&n.set(e);for(const r in e)if(!t(e[r],i[r])){n.set(e),this.stylesheet.fog=e;const t=this._setTransitionParameters({duration:0});n.updateTransitions(t);break}}else this._createFog(e);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:e.exported.now(),transition:e.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const e=this._order.filter((e=>this.isLayerDraped(this._layers[e]))),t=this._order.filter((e=>!this.isLayerDraped(this._layers[e])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...t)}_createTerrain(e,t){const n=this.terrain=new E(e,t);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const i=this._setTransitionParameters({duration:0});n.updateTransitions(i)}_force3DLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}_validate(t,n,i,r,o={}){return(!o||!1!==o.validate)&&Wt(this,t.call(e.validateStyle,e.extend({key:n,style:this.serialize(),value:i,styleSpec:e.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles(),this._sourceCaches[e].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(e){const t=this._getSourceCaches(e);for(const n of t)n.clearTiles()}_reloadSource(e){const t=this._getSourceCaches(e);for(const n of t)n.resume(),n.reload()}_reloadSources(){for(const e of this._getSources())e.reload&&e.reload()}_updateSources(e){for(const t in this._sourceCaches)this._sourceCaches[t].update(e)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const t=this._sourceCaches[e];t.resume(),t.reload()}}_updatePlacement(t,n,i,r,o=!1){let s=!1,a=!1;const l={};for(const e of this._order){const n=this._layers[e];if("symbol"!==n.type)continue;if(!l[n.source]){const e=this._getLayerSourceCache(n);if(!e)continue;l[n.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const i=this.crossTileSymbolIndex.addLayer(n,l[n.source],t.center.lng,t.projection);s=s||i}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),o=o||this._layerOrderChanged||0===i,this._layerOrderChanged&&this.fire(new e.Event("neworder")),(o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new $t(t,this._order,o,n,i,r,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),a=!0),s&&this.pauseablePlacement.placement.setStale()),a||s)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,l[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,t,n){this.imageManager.getImages(t.icons,n),this._updateTilesForChangedImages();const i=e=>{e&&e.setDependencies(t.tileID.key,t.type,t.icons)};i(this._otherSourceCaches[t.source]),i(this._symbolSourceCaches[t.source])}getGlyphs(e,t,n){this.glyphManager.getGlyphs(t.stacks,n)}getResource(t,n,i){return e.makeRequest(n,i)}_getSourceCache(e){return this._otherSourceCaches[e]}_getLayerSourceCache(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}_getSourceCaches(e){const t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}_isSourceCacheLoaded(t){const n=this._getSourceCaches(t);return 0===n.length?(this.fire(new e.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):n.every((e=>e.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Jt.getSourceType=function(e){return Ie[e]},Jt.setSourceType=function(e,t){Ie[e]=t},Jt.registerForPluginStateChange=e.registerForPluginStateChange;var Yt="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Qt="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",en="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",tn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",nn="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let rn={},on={};const sn=[];dn(Yt,sn),dn(en,sn),dn(tn,sn),dn(nn,sn),rn=hn("",en),on=hn(nn,tn);const an=hn("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ln=Yt,cn="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var un={background:hn("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:hn("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:hn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:hn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:hn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:hn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:hn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:hn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:hn("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:hn("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:hn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:hn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:hn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:hn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:hn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:hn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:hn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:hn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:hn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qt),skyboxGradient:hn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Qt),skyboxCapture:hn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:hn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:hn("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function dn(e,t){const n=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let i of n)if(i=i.trim(),"#"===i[0]&&i.includes("if")&&!i.includes("endif")){i=i.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const e=i.split(" ");for(const n of e)t.includes(n)||t.push(n)}}function hn(e,t){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),r={},o=[...sn];return dn(e,o),dn(t,o),{fragmentSource:e=e.replace(n,((e,t,n,i,o)=>(r[o]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${o}\nvarying ${n} ${i} ${o};\n#else\nuniform ${n} ${i} u_${o};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${o}\n    ${n} ${i} ${o} = u_${o};\n#endif\n`))),vertexSource:t=t.replace(n,((e,t,n,i,o)=>{const s="float"===i?"vec2":"vec4",a=o.match(/color/)?"color":s;return r[o]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${o}\nuniform lowp float u_${o}_t;\nattribute ${n} ${s} a_${o};\nvarying ${n} ${i} ${o};\n#else\nuniform ${n} ${i} u_${o};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${o}\n    ${o} = a_${o};\n#else\n    ${n} ${i} ${o} = u_${o};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${o}\n    ${o} = unpack_mix_${a}(a_${o}, u_${o}_t);\n#else\n    ${n} ${i} ${o} = u_${o};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${o}\nuniform lowp float u_${o}_t;\nattribute ${n} ${s} a_${o};\n#else\nuniform ${n} ${i} u_${o};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${o}\n    ${n} ${i} ${o} = a_${o};\n#else\n    ${n} ${i} ${o} = u_${o};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${o}\n    ${n} ${i} ${o} = unpack_mix_${a}(a_${o}, u_${o}_t);\n#else\n    ${n} ${i} ${o} = u_${o};\n#endif\n`})),staticAttributes:i,usedDefines:o}}class pn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,t,n,i,r,o,s){this.context=e;let a=this.boundPaintVertexBuffers.length!==i.length;for(let c=0;!a&&c<i.length;c++)this.boundPaintVertexBuffers[c]!==i[c]&&(a=!0);let l=this.boundDynamicVertexBuffers.length!==s.length;for(let c=0;!l&&c<s.length;c++)this.boundDynamicVertexBuffers[c]!==s[c]&&(l=!0);if(!e.extVertexArrayObject||!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==n||a||l||this.boundIndexBuffer!==r||this.boundVertexOffset!==o)this.freshBind(t,n,i,r,o,s);else{e.bindVertexArrayOES.set(this.vao);for(const e of s)e&&e.bind();r&&r.dynamicDraw&&r.bind()}}freshBind(e,t,n,i,r,o){let s;const a=e.numAttributes,l=this.context,c=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffers=o;else{s=l.currentNumAttributes||0;for(let e=a;e<s;e++)c.disableVertexAttribArray(e)}t.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,r);for(const u of n)u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,r);for(const u of o)u&&(u.enableAttributes(c,e),u.bind(),u.setVertexAttribPointers(c,e,r));i&&i.bind(),l.currentNumAttributes=a}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function fn(t,n){const i=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new e.MercatorCoordinate(0,r/i).toLngLat().lat,new e.MercatorCoordinate(0,(r+1)/i).toLngLat().lat]}function mn(t,n,i,r,o,s,a){const l=t.context,c=l.gl,u=i.fbo;if(!u)return;t.prepareDrawTile();const d=t.useProgram("hillshade");l.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,u.colorAttachment.get());const h=((e,t,n,i)=>{const r=n.paint.get("hillshade-shadow-color"),o=n.paint.get("hillshade-highlight-color"),s=n.paint.get("hillshade-accent-color");let a=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(a-=e.transform.angle);const l=!e.options.moving;return{u_matrix:i||e.transform.calculateProjMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:fn(0,t.tileID),u_light:[n.paint.get("hillshade-exaggeration"),a],u_shadow:r,u_highlight:o,u_accent:s}})(t,i,r,t.terrain?n.projMatrix:null);t.prepareDrawProgram(l,d,n.toUnwrapped());const{tileBoundsBuffer:p,tileBoundsIndexBuffer:f,tileBoundsSegments:m}=t.getTileBoundsBuffers(i);d.draw(l,c.TRIANGLES,o,s,a,e.CullFaceMode.disabled,h,r.id,p,f,m)}function gn(t,n,i){if(!n.needsDEMTextureUpload)return;const r=t.context,o=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||t.getTileTexture(i.stride);const s=i.getPixels();n.demTexture?n.demTexture.update(s,{premultiply:!1}):n.demTexture=new e.Texture(r,s,o.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function yn(t,n,i,r,o,s){const a=t.context,l=a.gl;if(!n.dem)return;const c=n.dem;if(a.activeTexture.set(l.TEXTURE1),gn(t,n,c),!n.demTexture)return;n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const u=c.dim;a.activeTexture.set(l.TEXTURE0);let d=n.fbo;if(!d){const t=new e.Texture(a,{width:u,height:u,data:null},l.RGBA);t.bind(l.LINEAR,l.CLAMP_TO_EDGE),d=n.fbo=a.createFramebuffer(u,u,!0),d.colorAttachment.set(t.texture)}a.bindFramebuffer.set(d.framebuffer),a.viewport.set([0,0,u,u]);const{tileBoundsBuffer:h,tileBoundsIndexBuffer:p,tileBoundsSegments:f}=t.getMercatorTileBoundsBuffers();t.useProgram("hillshadePrepare").draw(a,l.TRIANGLES,r,o,s,e.CullFaceMode.disabled,((t,n)=>{const i=n.stride,r=e.create();return e.ortho(r,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(r,r,[0,-e.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_unpack:n.unpackVector}})(n.tileID,c),i.id,h,p,f),n.needsHillshadePrepare=!1}const vn=t=>({u_matrix:new e.UniformMatrix4f(t),u_image0:new e.Uniform1i(t),u_skirt_height:new e.Uniform1f(t)}),bn=(e,t)=>({u_matrix:e,u_image0:0,u_skirt_height:t}),xn=(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(i),u_merc_matrix:n,u_zoom_transition:r,u_merc_center:o,u_image0:0,u_frustum_tl:s,u_frustum_tr:a,u_frustum_br:l,u_frustum_bl:c,u_globe_pos:u,u_globe_radius:d,u_viewport:h,u_grid_matrix:f?Float32Array.from(f):new Float32Array(9),u_skirt_height:p});function _n(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const wn=new class{constructor(){this.operations={}}newMorphing(e,t,n,i,r){if(e in this.operations){const t=this.operations[e];t.to.tileID.key!==n.tileID.key&&(t.queued=n)}else this.operations[e]={startTime:i,phase:0,duration:r,from:t,to:n,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const n=this.operations[t];for(n.phase=(e-n.startTime)/n.duration;n.phase>=1||!this._validOp(n);)if(!this._nextOp(n,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},kn={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function En(e){return 6*Math.pow(1.5,22-e)}function Sn(e,t){const n=1<<e.z;return!t&&(0===e.x||e.x===n-1)||0===e.y||e.y===n-1}const Tn=e=>({u_matrix:e});function Cn(t,n,i,r,o){if(o>0){const s=e.exported.now(),a=(s-t.timeAdded)/o,l=n?(s-n.timeAdded)/o:-1,c=i.getSource(),u=r.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),d=!n||Math.abs(n.tileID.overscaledZ-u)>Math.abs(t.tileID.overscaledZ-u),h=d&&t.refreshedUponExpiration?1:e.clamp(d?a:1-l,0,1);return t.refreshedUponExpiration&&a>=1&&(t.refreshedUponExpiration=!1),n?{opacity:1,mix:1-h}:{opacity:h,mix:0}}return{opacity:1,mix:0}}class Mn extends e.SourceCache{constructor(e){const t={type:"raster-dem",maxzoom:e.transform.maxZoom},n=new I(Fe(),null),i=Ae("mock-dem",t,n,e.style);super("mock-dem",i,!1),i.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,t){e.state="loaded",t(null)}}class In extends e.SourceCache{constructor(e){const t=Ae("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new I(Fe(),null),e.style);super("proxy",t,!1),t.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,n,i){if(t.freezeTileCoverage)return;this.transform=t;const r=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((n,i)=>{if(n[i.key]="",!this._tiles[i.key]){const n=new e.Tile(i,this._source.tileSize*i.overscaleFactor(),t.tileZoom);n.state="loaded",this._tiles[i.key]=n}return n}),{});for(const e in this._tiles)e in r||(this.freeFBO(e),this._tiles[e].unloadVectorData(),delete this._tiles[e])}freeFBO(e){const t=this.proxyCachedFBO[e];if(void 0!==t){const n=Object.values(t);this.renderCachePool.push(...n),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach((e=>e.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class An extends e.OverscaledTileID{constructor(e,t,n){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=t,this.projMatrix=n}}class Pn extends e.Elevation{constructor(t,n){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[i,r,o]=function(t){const n=new e.StructArrayLayout2i4,i=new e.StructArrayLayout3ui6,r=131;n.reserve(17161),i.reserve(33800);const o=e.EXTENT/128,s=e.EXTENT+o/2,a=s+o;for(let c=-o;c<a;c+=o)for(let t=-o;t<a;t+=o){const i=t<0||t>s||c<0||c>s?24575:0,r=e.clamp(Math.round(t),0,e.EXTENT),o=e.clamp(Math.round(c),0,e.EXTENT);n.emplaceBack(r+i,o)}const l=(e,t)=>{const n=t*r+e;i.emplaceBack(n+1,n,n+r),i.emplaceBack(n+r,n+r+1,n+1)};for(let e=1;e<129;e++)for(let t=1;t<129;t++)l(t,e);return[0,129].forEach((e=>{for(let t=0;t<130;t++)l(t,e),l(e,t)})),[n,i,32768]}(),s=t.context;this.gridBuffer=s.createVertexBuffer(i,e.posAttributes.members),this.gridIndexBuffer=s.createIndexBuffer(r),this.gridSegments=e.SegmentVector.simpleSegment(0,0,i.length,r.length),this.gridNoSkirtSegments=e.SegmentVector.simpleSegment(0,0,i.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new In(n.map),this.orthoMatrix=e.create(),e.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,e.EXTENT,0,e.EXTENT,0,1);const a=s.gl;this._overlapStencilMode=new e.StencilMode({func:a.GEQUAL,mask:255},0,255,a.KEEP,a.KEEP,a.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=n,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Mn(n.map)}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(t,n,i){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const r=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const o=()=>{this.sourceCache.used&&e.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const t=this.getScaledDemTileSize();this.sourceCache.update(n,t,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),n.updateElevation(!0,i),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(n),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&e.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((e=>e.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const n=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=0===i._centerAltitude&&-1===this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(i.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.proxyCoords=n.getIds().map((e=>{const t=n.getTileByID(e).tileID;return t.projMatrix=i.calculateProjMatrix(t.toUnwrapped()),t}));!function(t,n){const i=n.transform.pointCoordinate(n.transform.getCameraPoint()),r=new e.Point(i.x,i.y);t.sort(((t,n)=>{if(n.overscaledZ-t.overscaledZ)return n.overscaledZ-t.overscaledZ;const i=new e.Point(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),o=new e.Point(n.canonical.x+(1<<n.canonical.z)*n.wrap,n.canonical.y),s=r.mult(1<<t.canonical.z);return s.x-=.5,s.y-=.5,s.distSqr(i)-s.distSqr(o)}))}(r,this.painter),this._previousZoom=i.zoom;const o=this.proxyToSource||{};this.proxyToSource={},r.forEach((e=>{this.proxyToSource[e.key]={}})),this.terrainTileForTile={};const s=this._style._sourceCaches;for(const e in s){const n=s[e];if(!n.used)continue;if(n!==this.sourceCache&&this.resetTileLookupCache(n.id),this._setupProxiedCoordsForOrtho(n,t[e],o),n.usedForTerrain)continue;const i=t[e];n.getSource().reparseOverscaled&&this._assignTerrainTiles(i)}this.proxiedCoords[n.id]=r.map((e=>new An(e,e.key,this.orthoMatrix))),this._assignTerrainTiles(r),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1,this._updateTimestamp=e.exported.now();const a={};this._visibleDemTiles=[];for(const e of this.proxyCoords){const t=this.terrainTileForTile[e.key];if(!t)continue;const n=t.tileID.key;n in a||(this._visibleDemTiles.push(t),a[n]=n)}}_assignTerrainTiles(e){this._initializing||e.forEach((e=>{if(this.terrainTileForTile[e.key])return;const t=this._findTileCoveringTileID(e,this.sourceCache);t&&(this.terrainTileForTile[e.key]=t)}))}_prepareDEMTextures(){const e=this.painter.context,t=e.gl;for(const n in this.terrainTileForTile){const i=this.terrainTileForTile[n],r=i.dem;!r||i.demTexture&&!i.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),gn(this.painter,i,r))}}_prepareDemTileUniforms(e,t,n,i){if(!t||null==t.demTexture)return!1;const r=e.tileID.canonical,o=Math.pow(2,t.tileID.canonical.z-r.z),s=i||"";return n[`u_dem_tl${s}`]=[r.x*o%1,r.y*o%1],n[`u_dem_scale${s}`]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,n=t.gl;if(!this._emptyDepthBufferTexture){const i=new e.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new e.Texture(t,i,n.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let e=0;const t=this._visibleDemTiles.reduce(((t,n)=>{if(!n.dem)return t;const i=n.dem.tree.minimums[0];return i>0&&e++,t+i}),0);return e?t/e:0}_updateEmptyDEMTexture(){const t=this.painter.context,n=t.gl;t.activeTexture.set(n.TEXTURE2);const i=this._getLoadedAreaMinimum(),r=new e.RGBAImage({width:1,height:1},new Uint8Array(e.DEMData.pack(i,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(r,{premultiply:!1}):o=this._emptyDEMTexture=new e.Texture(t,r,n.RGBA,{premultiply:!1}),o}setupElevationDraw(t,n,i){const r=this.painter.context,o=r.gl,s=(a=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:e.DEMData.getUnpackVector(a),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var a;s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();let l=null,c=null,u=1;if(i&&i.morphing&&this._useVertexMorphing){const e=i.morphing.srcDemTile,n=i.morphing.dstDemTile;u=i.morphing.phase,e&&n&&(this._prepareDemTileUniforms(t,e,s,"_prev")&&(c=e),this._prepareDemTileUniforms(t,n,s)&&(l=n))}if(c&&l?(r.activeTexture.set(o.TEXTURE2),l.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),r.activeTexture.set(o.TEXTURE4),c.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_dem_lerp=u):(l=this.terrainTileForTile[t.tileID.key],r.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(t,l,s)?l.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE)),r.activeTexture.set(o.TEXTURE3),i&&i.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),this._depthFBO&&(s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),s.u_depth_size_inv=[1,1]),i&&i.useMeterToDem&&l){const t=(1<<l.tileID.canonical.z)*e.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=t}if(i&&i.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),n.setTerrainUniformValues(r,s),"globe"===this.painter.transform.projection.name){const e=this.globeUniformValues(this.painter.transform,t.tileID.canonical,i&&i.useDenormalizedUpVectorScale);n.setGlobeUniformValues(r,e)}}globeUniformValues(t,n,i){const r=t.projection;return{u_tile_tl_up:r.upVector(n,0,0),u_tile_tr_up:r.upVector(n,e.EXTENT,0),u_tile_br_up:r.upVector(n,e.EXTENT,e.EXTENT),u_tile_bl_up:r.upVector(n,0,e.EXTENT),u_tile_up_scale:i?e.globeMetersToEcef(1):r.upVectorScale(n,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const n=this.painter,i=this.painter.context;0!==t.length&&(i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),n.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,n,i,r,o){if("globe"===t.transform.projection.name)!function(t,n,i,r,o){const s=t.context,a=s.gl;let l,c;const u=t.options.showTerrainWireframe?2:0,d=t.transform,h=e.globeUseCustomAntiAliasing(t,s,d),p=(e,n)=>{if(c===e)return;const i=[kn[e],"PROJECTION_GLOBE_VIEW"];h&&i.push("CUSTOM_ANTIALIASING"),n&&i.push(kn[u]),l=t.useProgram("globeRaster",null,i),c=e},f=t.colorModeForRenderPass(),m=new e.DepthMode(a.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);wn.update(o);const g=e.calculateGlobeMercatorMatrix(d),y=[e.mercatorXfromLng(d.center.lng),e.mercatorYfromLat(d.center.lat)],v=u?[!1,!0]:[!1],b=t.globeSharedBuffers,x=[d.width*e.exported.devicePixelRatio,d.height*e.exported.devicePixelRatio],_=Float32Array.from(d.globeMatrix),w={useDenormalizedUpVectorScale:!0};if(v.forEach((u=>{const d=t.transform,h=En(d.zoom)*n.exaggeration();c=-1;const v=u?a.LINES:a.TRIANGLES;for(const c of r){const r=i.getTile(c),k=e.StencilMode.disabled,E=n.prevTerrainTileForTile[c.key],S=n.terrainTileForTile[c.key];_n(E,S)&&wn.newMorphing(c.key,E,S,o,250),s.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);const T=wn.getMorphValuesForProxy(c.key),C=T?1:0;T&&e.extend$1(w,{morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:e.easeCubicInOut(T.phase)}});const M=e.tileCornersToBounds(c.canonical),I=e.getLatitudinalLod(M.getCenter().lat),A=e.getGridMatrix(c.canonical,M,I,d.worldSize/d._pixelsPerMercatorPixel),P=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),O=xn(d.projMatrix,_,g,P,e.globeToMercatorTransition(d.zoom),y,d.frustumCorners.TL,d.frustumCorners.TR,d.frustumCorners.BR,d.frustumCorners.BL,d.globeCenterInViewSpace,d.globeRadius,x,h,A);if(p(C,u),n.setupElevationDraw(r,l,w),t.prepareDrawProgram(s,l,c.toUnwrapped()),b){const[n,i,r]=u?b.getWirefameBuffers(t.context,I):b.getGridBuffers(I,0!==h);l.draw(s,v,m,k,f,e.CullFaceMode.backCCW,O,"globe_raster",n,i,r)}}})),b){const o=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];h&&o.push("CUSTOM_ANTIALIASING"),l=t.useProgram("globeRaster",null,o);for(const c of r){const{x:r,y:o,z:u}=c.canonical,h=0===o,p=o===(1<<u)-1,[g,v,_,k]=b.getPoleBuffers(u);if(k&&(h||p)){const o=i.getTile(c);s.activeTexture.set(a.TEXTURE0),o.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE);let b=e.globePoleMatrixForTile(u,r,d);const E=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),S=(t,n)=>t.draw(s,a.TRIANGLES,m,e.StencilMode.disabled,f,e.CullFaceMode.disabled,xn(d.projMatrix,b,b,E,0,y,d.frustumCorners.TL,d.frustumCorners.TR,d.frustumCorners.BR,d.frustumCorners.BL,d.globeCenterInViewSpace,d.globeRadius,x,0),"globe_pole_raster",n,_,k);n.setupElevationDraw(o,l,w),t.prepareDrawProgram(s,l,c.toUnwrapped()),h&&S(l,g),p&&(b=e.scale(e.create(),b,[1,-1,1]),S(l,v))}}}}(t,n,i,r,o);else{const s=t.context,a=s.gl;let l,c;const u=t.options.showTerrainWireframe?2:0,d=(e,n)=>{if(c===e)return;const i=[kn[e]];n&&i.push(kn[u]),l=t.useProgram("terrainRaster",null,i),c=e},h=t.colorModeForRenderPass(),p=new e.DepthMode(a.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);wn.update(o);const f=t.transform,m=En(f.zoom)*n.exaggeration();(u?[!1,!0]:[!1]).forEach((u=>{c=-1;const g=u?a.LINES:a.TRIANGLES,[y,v]=u?n.getWirefameBuffer():[n.gridIndexBuffer,n.gridSegments];for(const c of r){const r=i.getTile(c),b=e.StencilMode.disabled,x=n.prevTerrainTileForTile[c.key],_=n.terrainTileForTile[c.key];_n(x,_)&&wn.newMorphing(c.key,x,_,o,250),s.activeTexture.set(a.TEXTURE0),r.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const w=wn.getMorphValuesForProxy(c.key),k=w?1:0;let E;w&&(E={morphing:{srcDemTile:w.from,dstDemTile:w.to,phase:e.easeCubicInOut(w.phase)}});const S=bn(c.projMatrix,Sn(c.canonical,f.renderWorldCopies)?m/10:m);d(k,u),n.setupElevationDraw(r,l,E),t.prepareDrawProgram(s,l,c.toUnwrapped()),l.draw(s,g,p,b,h,e.CullFaceMode.backCCW,S,"terrain_raster",n.gridBuffer,y,v)}}))}}(n,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,n.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const n=this.painter,i=this.painter.context,r=this.proxySourceCache,o=this.proxiedCoords[r.id],s=this._drapedRenderBatches.shift(),a=[],l=n.style.order;let c=0;for(const u of o){const o=r.getTileByID(u.proxyTileKey),d=r.proxyCachedFBO[u.key]?r.proxyCachedFBO[u.key][t]:void 0,h=void 0!==d?r.renderCache[d]:this.pool[c++],p=void 0!==d;if(o.texture=h.tex,p&&!h.dirty){a.push(o.tileID);continue}let f;i.bindFramebuffer.set(h.fb.framebuffer),this.renderedToTile=!1,h.dirty&&(i.clear({color:e.Color.transparent,stencil:0}),h.dirty=!1);for(let e=s.start;e<=s.end;++e){const t=n.style._layers[l[e]];if(t.isHidden(n.transform.zoom))continue;const r=n.style._getLayerSourceCache(t),o=r?this.proxyToSource[u.key][r.id]:[u];if(!o)continue;const s=o;i.viewport.set([0,0,h.fb.width,h.fb.height]),f!==(r?r.id:null)&&(this._setupStencil(h,o,t,r),f=r?r.id:null),n.renderLayer(n,r,t,s)}this.renderedToTile?(h.dirty=!0,a.push(o.tileID)):p||--c,5===c&&(c=0,this.renderToBackBuffer(a))}return this.renderToBackBuffer(a),this.renderingToTexture=!1,i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),s.end+1}postRender(){}renderCacheEfficiency(e){const t=e.order.length;if(0===t)return{efficiency:100};let n,i=0,r=0,o=!1;for(let s=0;s<t;++s){const t=e._layers[e.order[s]];this._style.isLayerDraped(t)?(o&&++i,++r):o||(o=!0,n=t.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-i/r),firstUndrapedLayer:n}}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter((e=>e.dem)).forEach((t=>{e=Math.min(e,t.dem.tree.minimums[0])})),0===e?e:(e-30)*this._exaggeration}raycast(e,t,n){if(!this._visibleDemTiles)return null;const i=this._visibleDemTiles.filter((e=>e.dem)).map((i=>{const r=i.tileID,o=1<<r.overscaledZ,{x:s,y:a}=r.canonical,l=s/o,c=(s+1)/o,u=a/o,d=(a+1)/o;return{minx:l,miny:u,maxx:c,maxy:d,t:i.dem.tree.raycastRoot(l,u,c,d,e,t,n),tile:i}}));i.sort(((e,t)=>(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE)));for(const r of i){if(null==r.t)return null;const i=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,e,t,n);if(null!=i)return i}return null}_createFBO(){const t=this.painter.context,n=t.gl,i=this.drapeBufferSize;t.activeTexture.set(n.TEXTURE0);const r=new e.Texture(t,{width:i[0],height:i[1],data:null},n.RGBA);r.bind(n.LINEAR,n.CLAMP_TO_EDGE);const o=t.createFramebuffer(i[0],i[1],!1);return o.colorAttachment.set(r.texture),o.depthAttachment=new we(t,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,i[0],i[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&n.texParameterf(n.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:o,tex:r,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e].hasTransition())return!0;return this._style.order.some((e=>{const t=this._style._layers[e],n=t.isHidden(this.painter.transform.zoom);return"custom"===t.type?!n&&t.shouldRedrape():!n&&t.hasTransition()}))}_clearLineLayersFromRenderCache(){let t=!1;for(const e of this._style._getSources())if(e instanceof Se){t=!0;break}if(!t)return;const n={};for(let i=0;i<this._style.order.length;++i){const t=this._style._layers[this._style.order[i]],r=this._style._getLayerSourceCache(t);if(r&&!n[r.id]&&!t.isHidden(this.painter.transform.zoom)&&"line"===t.type&&t.widthExpression()instanceof e.ZoomDependentExpression){n[r.id]=!0;for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][r.id];if(t)for(const e of t)this._clearRenderCacheForTile(r.id,e)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n]._source instanceof Te){e=!0;break}if(!e)return;const t={};for(let n=0;n<this._style.order.length;++n){const e=this._style._layers[this._style.order[n]],i=this._style._getLayerSourceCache(e);if(!i||t[i.id])continue;if(e.isHidden(this.painter.transform.zoom)||"raster"!==e.type)continue;const r=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][i.id];if(e)for(const t of e){const e=Cn(i.getTile(t),i.findLoadedParent(t,0),i,this.painter.transform,r);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(i.id,t)}}}}_setupDrapedRenderBatches(){const e=this._style.order,t=e.length;if(0===t)return;const n=[];let i,r=0,o=this._style._layers[e[r]];for(;!this._style.isLayerDraped(o)&&o.isHidden(this.painter.transform.zoom)&&++r<t;)o=this._style._layers[e[r]];for(;r<t;++r){const t=this._style._layers[e[r]];t.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(t)?void 0===i&&(i=r):void 0!==i&&(n.push({start:i,end:r-1}),i=void 0))}void 0!==i&&n.push({start:i,end:r-1}),this._drapedRenderBatches=n}_setupRenderCache(e){const t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){const e=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(let n=0;n<e.length;++n){const i=Object.values(e[n]);t.renderCachePool.push(...i)}}return}this._clearRasterLayersFromRenderCache();const n=this.proxyCoords,i=this._tilesDirty;for(let o=n.length-1;o>=0;o--){const r=n[o];if(t.getTileByID(r.key),void 0!==t.proxyCachedFBO[r.key]){const n=e[r.key],o=this.proxyToSource[r.key];let s=0;for(const e in o){const t=o[e],r=n[e];if(!r||r.length!==t.length||t.some(((t,n)=>t!==r[n]||i[e]&&i[e].hasOwnProperty(t.key)))){s=-1;break}++s}for(const e in t.proxyCachedFBO[r.key])t.renderCache[t.proxyCachedFBO[r.key][e]].dirty=s<0||s!==Object.values(n).length}}const r=[...this._drapedRenderBatches];r.sort(((e,t)=>t.end-t.start-(e.end-e.start)));for(const o of r)for(const e of n){if(t.proxyCachedFBO[e.key])continue;let n=t.renderCachePool.pop();void 0===n&&t.renderCache.length<50&&(n=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==n&&(t.proxyCachedFBO[e.key]={},t.proxyCachedFBO[e.key][o.start]=n,t.renderCache[n].dirty=!0)}this._tilesDirty={}}_setupStencil(e,t,n,i){if(!i||!this._sourceTilesOverlap[i.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const r=this.painter.context,o=r.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let s;if(n.isTileClipped())s=t.length,this._overlapStencilMode.test={func:o.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);s=1,this._overlapStencilMode.test={func:o.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+s>255&&(r.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=s,this._overlapStencilMode.ref=this._stencilRef,n.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):e.StencilMode.disabled}_renderTileClippingMasks(t,n){const i=this.painter,r=this.painter.context,o=r.gl;i._tileClippingMaskIDs={},r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);const s=i.useProgram("clippingMask");for(const a of t){const t=i._tileClippingMaskIDs[a.key]=--n;s.draw(r,o.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:o.ALWAYS,mask:0},t,255,o.KEEP,o.KEEP,o.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Tn(a.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(t){const n=this.painter.transform;if(t.x<0||t.x>n.width||t.y<0||t.y>n.height)return null;const i=[t.x,t.y,1,1];e.transformMat4$1(i,i,n.pixelMatrixInverse),e.scale$1(i,i,1/i[3]),i[0]/=n.worldSize,i[1]/=n.worldSize;const r=n._camera.position,o=e.mercatorZfromAltitude(1,n.center.lat),s=[r[0],r[1],r[2]/o,0],a=e.subtract([],i.slice(0,3),s);e.normalize(a,a);const l=this.raycast(s,a,this._exaggeration);return null!==l&&l?(e.scaleAndAdd(s,s,a,l),s[3]=s[2],s[2]*=o,s):null}drawDepth(){const t=this.painter,n=t.context,i=this.proxySourceCache,r=Math.ceil(t.width),o=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===o||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const t=n.gl,i=n.createFramebuffer(r,o,!0);n.activeTexture.set(t.TEXTURE0);const s=new e.Texture(n,{width:r,height:o,data:null},t.RGBA);s.bind(t.NEAREST,t.CLAMP_TO_EDGE),i.colorAttachment.set(s.texture);const a=n.createRenderbuffer(n.gl.DEPTH_COMPONENT16,r,o);i.depthAttachment.set(a),this._depthFBO=i,this._depthTexture=s}n.bindFramebuffer.set(this._depthFBO.framebuffer),n.viewport.set([0,0,r,o]),function(t,n,i,r){if("globe"===t.transform.projection.name)return;const o=t.context,s=o.gl;o.clear({depth:1});const a=t.useProgram("terrainDepth"),l=new e.DepthMode(s.LESS,e.DepthMode.ReadWrite,t.depthRangeFor3D);for(const c of r){const t=i.getTile(c),r=bn(c.projMatrix,0);n.setupElevationDraw(t,a),a.draw(o,s.TRIANGLES,l,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.backCCW,r,"terrain_depth",n.gridBuffer,n.gridIndexBuffer,n.gridNoSkirtSegments)}}(t,this,i,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,t,n){if(e.getSource()instanceof Me)return this._setupProxiedCoordsForImageSource(e,t,n);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const i=this.proxiedCoords[e.id]=[],r=this.proxyCoords;for(let s=0;s<r.length;s++){const t=r[s],o=this._findTileCoveringTileID(t,e);if(o){const r=this._createProxiedId(t,o,n[t.key]&&n[t.key][e.id]);i.push(r),this.proxyToSource[t.key][e.id]=[r]}}let o=!1;for(let s=0;s<t.length;s++){const r=e.getTile(t[s]);if(!r||!r.hasData())continue;const a=this._findTileCoveringTileID(r.tileID,this.proxySourceCache);if(a&&a.tileID.canonical.z!==r.tileID.canonical.z){const t=this.proxyToSource[a.tileID.key][e.id],s=this._createProxiedId(a.tileID,r,n[a.tileID.key]&&n[a.tileID.key][e.id]);t?t.splice(t.length-1,0,s):this.proxyToSource[a.tileID.key][e.id]=[s],i.push(s),o=!0}}this._sourceTilesOverlap[e.id]=o}_setupProxiedCoordsForImageSource(t,n,i){if(!t.getSource().loaded())return;const r=this.proxiedCoords[t.id]=[],o=this.proxyCoords,s=t.getSource(),a=new e.Point(s.tileID.x,s.tileID.y)._div(1<<s.tileID.z),l=s.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce(((e,t)=>(e.min.x=Math.min(e.min.x,t.x-a.x),e.min.y=Math.min(e.min.y,t.y-a.y),e.max.x=Math.max(e.max.x,t.x-a.x),e.max.y=Math.max(e.max.y,t.y-a.y),e)),{min:new e.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),c=(t,n)=>{const i=t.wrap+t.canonical.x/(1<<t.canonical.z),r=t.canonical.y/(1<<t.canonical.z),o=e.EXTENT/(1<<t.canonical.z),s=n.wrap+n.canonical.x/(1<<n.canonical.z),a=n.canonical.y/(1<<n.canonical.z);return i+o<s+l.min.x||i>s+l.max.x||r+o<a+l.min.y||r>a+l.max.y};for(let e=0;e<o.length;e++){const s=o[e];for(let e=0;e<n.length;e++){const o=t.getTile(n[e]);if(!o||!o.hasData())continue;if(c(s,o.tileID))continue;const a=this._createProxiedId(s,o,i[s.key]&&i[s.key][t.id]),l=this.proxyToSource[s.key][t.id];l?l.push(a):this.proxyToSource[s.key][t.id]=[a],r.push(a)}}}_createProxiedId(t,n,i){let r=this.orthoMatrix;if(i){const e=i.find((e=>e.key===n.tileID.key));if(e)return e}if(n.tileID.key!==t.key){const i=t.canonical.z-n.tileID.canonical.z;let o,s,a;r=e.create();const l=n.tileID.wrap-t.wrap<<t.overscaledZ;i>0?(o=e.EXTENT>>i,s=o*((n.tileID.canonical.x<<i)-t.canonical.x+l),a=o*((n.tileID.canonical.y<<i)-t.canonical.y)):(o=e.EXTENT<<-i,s=e.EXTENT*(n.tileID.canonical.x-(t.canonical.x+l<<-i)),a=e.EXTENT*(n.tileID.canonical.y-(t.canonical.y<<-i))),e.ortho(r,0,o,0,o,0,1),e.translate(r,r,[s,a,0])}return new An(n.tileID,t.key,r)}_findTileCoveringTileID(t,n){let i=n.getTile(t);if(i&&i.hasData())return i;const r=this._findCoveringTileCache[n.id],o=r[t.key];if(i=o?n.getTileByID(o):null,i&&i.hasData()||null===o)return i;let s=i?i.tileID:t,a=s.overscaledZ;const l=n.getSource().minzoom,c=[];if(!o){const r=n.getSource().maxzoom;if(t.canonical.z>=r){const i=t.canonical.z-r;n.getSource().reparseOverscaled?(a=Math.max(t.canonical.z+2,n.transform.tileZoom),s=new e.OverscaledTileID(a,t.wrap,r,t.canonical.x>>i,t.canonical.y>>i)):0!==i&&(a=r,s=new e.OverscaledTileID(a,t.wrap,r,t.canonical.x>>i,t.canonical.y>>i))}s.key!==t.key&&(c.push(s.key),i=n.getTile(s))}const u=e=>{c.forEach((t=>{r[t]=e})),c.length=0};for(a-=1;a>=l&&(!i||!i.hasData());a--){i&&u(i.tileID.key);const e=s.calculateScaledKey(a);if(i=n.getTileByID(e),i&&i.hasData())break;const t=r[e];if(null===t)break;void 0===t?c.push(e):i=n.getTileByID(t)}return u(i?i.tileID.key:null),i&&i.hasData()?i:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,t){let n=this._tilesDirty[e];n||(n=this._tilesDirty[e]={}),n[t.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(t){let n=0;const i=new e.StructArrayLayout2ui4,r=131;for(let e=1;e<129;e++){for(let t=1;t<129;t++)n=e*r+t,i.emplaceBack(n,n+1),i.emplaceBack(n,n+r),i.emplaceBack(n+1,n+r),128===e&&i.emplaceBack(n+r,n+r+1);i.emplaceBack(n+1,n+1+r)}return i}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=e.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class On{static cacheKey(e,t,n,i){let r=`${t}${i?i.cacheKey:""}`;for(const o of n)e.usedDefines.includes(o)&&(r+=`/${o}`);return r}constructor(t,n,i,r,o,s){const a=t.gl;this.program=a.createProgram();const l=function(e){const t=[];for(let n=0;n<e.length;n++){if(null===e[n])continue;const i=e[n].split(" ");t.push(i.pop())}return t}(i.staticAttributes),c=r?r.getBinderAttributes():[],u=l.concat(c);let d=r?r.defines():[];d=d.concat(s.map((e=>`#define ${e}`)));const h=t.isWebGL2?"#version 300 es\n":"",p=h+d.concat(t.extStandardDerivatives&&0===h.length?"#extension GL_OES_standard_derivatives : enable\n".concat(cn):cn,cn,ln,an.fragmentSource,on.fragmentSource,i.fragmentSource).join("\n"),f=h+d.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ln,an.vertexSource,on.vertexSource,rn.vertexSource,i.vertexSource).join("\n"),m=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost())return void(this.failedToCreate=!0);a.shaderSource(m,p),a.compileShader(m),a.attachShader(this.program,m);const g=a.createShader(a.VERTEX_SHADER);if(a.isContextLost())this.failedToCreate=!0;else{a.shaderSource(g,f),a.compileShader(g),a.attachShader(this.program,g),this.attributes={},this.numAttributes=u.length;for(let e=0;e<this.numAttributes;e++)u[e]&&(a.bindAttribLocation(this.program,e,u[e]),this.attributes[u[e]]=e);a.linkProgram(this.program),a.deleteShader(g),a.deleteShader(m),this.fixedUniforms=o(t),this.binderUniforms=r?r.getUniforms(t):[],s.includes("TERRAIN")&&(this.terrainUniforms=(t=>({u_dem:new e.Uniform1i(t),u_dem_prev:new e.Uniform1i(t),u_dem_unpack:new e.Uniform4f(t),u_dem_tl:new e.Uniform2f(t),u_dem_scale:new e.Uniform1f(t),u_dem_tl_prev:new e.Uniform2f(t),u_dem_scale_prev:new e.Uniform1f(t),u_dem_size:new e.Uniform1f(t),u_dem_lerp:new e.Uniform1f(t),u_exaggeration:new e.Uniform1f(t),u_depth:new e.Uniform1i(t),u_depth_size_inv:new e.Uniform2f(t),u_meter_to_dem:new e.Uniform1f(t),u_label_plane_matrix_inv:new e.UniformMatrix4f(t)}))(t)),s.includes("GLOBE")&&(this.globeUniforms=(t=>({u_tile_tl_up:new e.Uniform3f(t),u_tile_tr_up:new e.Uniform3f(t),u_tile_br_up:new e.Uniform3f(t),u_tile_bl_up:new e.Uniform3f(t),u_tile_up_scale:new e.Uniform1f(t)}))(t)),s.includes("FOG")&&(this.fogUniforms=(t=>({u_fog_matrix:new e.UniformMatrix4f(t),u_fog_range:new e.Uniform2f(t),u_fog_color:new e.Uniform4f(t),u_fog_horizon_blend:new e.Uniform1f(t),u_fog_temporal_offset:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_globe_transition:new e.Uniform1f(t),u_is_globe:new e.Uniform1i(t),u_viewport:new e.Uniform2f(t)}))(t))}}setTerrainUniformValues(e,t){if(!this.terrainUniforms)return;const n=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e]&&n[e].set(this.program,e,t[e])}}setGlobeUniformValues(e,t){if(!this.globeUniforms)return;const n=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e]&&n[e].set(this.program,e,t[e])}}setFogUniformValues(e,t){if(!this.fogUniforms)return;const n=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)n[e].set(this.program,e,t[e])}}draw(e,t,n,i,r,o,s,a,l,c,u,d,h,p,f){const m=e.gl;if(this.failedToCreate)return;e.program.set(this.program),e.setDepthMode(n),e.setStencilMode(i),e.setColorMode(r),e.setCullFace(o);for(const y of Object.keys(this.fixedUniforms))this.fixedUniforms[y].set(this.program,y,s[y]);p&&p.setUniforms(this.program,e,this.binderUniforms,d,{zoom:h});const g={[m.LINES]:2,[m.TRIANGLES]:3,[m.LINE_STRIP]:1}[t];for(const y of u.get()){const n=y.vaos||(y.vaos={});(n[a]||(n[a]=new pn)).bind(e,this,l,p?p.getPaintVertexBuffers():[],c,y.vertexOffset,f||[]),m.drawElements(t,y.primitiveLength*g,m.UNSIGNED_SHORT,y.primitiveOffset*g*2)}}}function Dn(e,t){const n=Math.pow(2,t.tileID.overscaledZ),i=t.tileSize*Math.pow(2,e.transform.tileZoom)/n,r=i*(t.tileID.canonical.x+t.tileID.wrap*n),o=i*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/A(t,1,e.transform.tileZoom),u_pixel_coord_upper:[r>>16,o>>16],u_pixel_coord_lower:[65535&r,65535&o]}}const Rn=e.create(),zn=(t,n,i,r,o,s,a,l,c,u,d)=>{const h=n.style.light,p=h.properties.get("position"),f=[p.x,p.y,p.z],m=e.create$1();"viewport"===h.properties.get("anchor")&&(e.fromRotation(m,-n.transform.angle),e.transformMat3(f,f,m));const g=h.properties.get("color"),y=n.transform,v={u_matrix:t,u_lightpos:f,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+i,u_opacity:r,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Rn,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:o,u_edge_radius:s};return"globe"===y.projection.name&&(v.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],v.u_zoom_transition=c,v.u_inv_rot_matrix=d,v.u_merc_center=u,v.u_up_dir=y.projection.upVector(new e.CanonicalTileID(0,0,0),u[0]*e.EXTENT,u[1]*e.EXTENT),v.u_height_lift=l),v},Ln=(t,n,i,r,o,s,a,l,c,u,d,h)=>{const p=zn(t,n,i,r,o,s,a,c,u,d,h),f={u_height_factor:-Math.pow(2,a.overscaledZ)/l.tileSize/8};return e.extend(p,Dn(n,l),f)},Bn=e=>({u_matrix:e}),Nn=(t,n,i)=>e.extend(Bn(t),Dn(n,i)),Fn=(e,t)=>({u_matrix:e,u_world:t}),$n=(t,n,i,r)=>e.extend(Nn(t,n,i),{u_world:r}),jn=e.create(),Vn=(t,n,i,r,o,s)=>{const a=t.transform,l="globe"===a.projection.name;let c;if("map"===s.paint.get("circle-pitch-alignment"))if(l){const t=e.globePixelsToTileUnits(a.zoom,n.canonical)*a._pixelsPerMercatorPixel;c=Float32Array.from([t,0,0,t])}else c=a.calculatePixelsToTileUnitsMatrix(i);else c=new Float32Array([a.pixelsToGLUnits[0],0,0,a.pixelsToGLUnits[1]]);const u={u_camera_to_center_distance:a.cameraToCenterDistance,u_matrix:t.translatePosMatrix(n.projMatrix,i,s.paint.get("circle-translate"),s.paint.get("circle-translate-anchor")),u_device_pixel_ratio:e.exported.devicePixelRatio,u_extrude_scale:c,u_inv_rot_matrix:jn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(l){u.u_inv_rot_matrix=r,u.u_merc_center=o,u.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],u.u_zoom_transition=e.globeToMercatorTransition(a.zoom);const t=o[0]*e.EXTENT,i=o[1]*e.EXTENT;u.u_up_dir=a.projection.upVector(new e.CanonicalTileID(0,0,0),t,i)}return u},Un=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},qn=(t,n,i,r)=>{const o=e.EXTENT/i.tileSize;return{u_matrix:t,u_camera_to_center_distance:n.getCameraToCenterDistance(r),u_extrude_scale:[n.pixelsToGLUnits[0]/o,n.pixelsToGLUnits[1]/o]}},Gn=(e,t,n=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:n}),Wn=e.create(),Hn=(t,n,i,r,o,s,a)=>{const l=t.transform,c="globe"===l.projection.name,u=c?e.globePixelsToTileUnits(l.zoom,n.canonical)*l._pixelsPerMercatorPixel:A(i,1,s),d={u_matrix:n.projMatrix,u_extrude_scale:u,u_intensity:a,u_inv_rot_matrix:Wn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){d.u_inv_rot_matrix=r,d.u_merc_center=o,d.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],d.u_zoom_transition=e.globeToMercatorTransition(l.zoom);const t=o[0]*e.EXTENT,i=o[1]*e.EXTENT;d.u_up_dir=l.projection.upVector(new e.CanonicalTileID(0,0,0),t,i)}return d},Zn=(e,t,n,i,r,o,s)=>{const a=e.transform,l=a.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:Jn(e,t,n,i),u_pixels_to_tile_units:l,u_device_pixel_ratio:o,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:r,u_texsize:Yn(n)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Kn(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:s}},Xn=(e,t,n,i,r)=>{const o=e.transform;return{u_matrix:Jn(e,t,n,i),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:o.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:r,u_image:0,u_tile_units_to_pixels:Kn(t,o),u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Kn(e,t){return 1/A(e,1,t.tileZoom)}function Jn(e,t,n,i){return e.translatePosMatrix(i||t.tileID.projMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}function Yn(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const Qn=(e,t,n,i,r,o)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:n,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(s=r.paint.get("raster-contrast"),s>0?1/(1-s):1+s),u_spin_weights:ei(r.paint.get("raster-hue-rotate")),u_perspective_transform:o};var s,a};function ei(e){e*=Math.PI/180;const t=Math.sin(e),n=Math.cos(e);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}const ti=e.create(),ni=(t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g)=>{const y=o.transform,v={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:y.cameraToCenterDistance,u_rotate_symbol:+i,u_aspect_ratio:y.width/y.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:a,u_coord_matrix:l,u_is_text:+c,u_pitch_with_map:+r,u_texsize:u,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ti,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ti,u_up_vector:[0,-1,0]};return"globe"===g.name&&(v.u_tile_id=[d.canonical.x,d.canonical.y,1<<d.canonical.z],v.u_zoom_transition=h,v.u_inv_rot_matrix=f,v.u_merc_center=p,v.u_camera_forward=y._camera.forward(),v.u_ecef_origin=e.globeECEFOrigin(y.globeMatrix,d.toUnwrapped()),v.u_tile_matrix=Float32Array.from(y.globeMatrix),v.u_up_vector=m),v},ii=(t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y)=>e.extend(ni(t,n,i,r,o,s,a,l,c,u,h,p,f,m,g,y),{u_gamma_scale:r?o.transform.cameraToCenterDistance*Math.cos(o.terrain?0:o.transform._pitch):1,u_device_pixel_ratio:e.exported.devicePixelRatio,u_is_halo:+d}),ri=(t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g)=>e.extend(ii(t,n,i,r,o,s,a,l,!0,c,!0,d,h,p,f,m,g),{u_texsize_icon:u,u_texture_icon:1}),oi=(e,t,n)=>({u_matrix:e,u_opacity:t,u_color:n}),si=(t,n,i,r,o)=>e.extend(function(e,t,n){const i=t.imageManager.getPattern(e.toString()),{width:r,height:o}=t.imageManager.getPixelSize(),s=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,t.transform.tileZoom)/s,l=a*(n.tileID.canonical.x+n.tileID.wrap*s),c=a*n.tileID.canonical.y;return{u_image:0,u_pattern_tl:i.tl,u_pattern_br:i.br,u_texsize:[r,o],u_pattern_size:i.displaySize,u_tile_units_to_pixels:1/A(n,1,t.transform.tileZoom),u_pixel_coord_upper:[l>>16,c>>16],u_pixel_coord_lower:[65535&l,65535&c]}}(r,i,o),{u_matrix:t,u_opacity:n}),ai={fillExtrusion:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t)}),fillExtrusionPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_height_factor:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t)}),fill:t=>({u_matrix:new e.UniformMatrix4f(t)}),fillPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),fillOutline:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t)}),fillOutlinePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),circle:t=>({u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),collisionBox:t=>({u_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.Uniform2f(t)}),collisionCircle:t=>({u_matrix:new e.UniformMatrix4f(t),u_inv_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_viewport_size:new e.Uniform2f(t)}),debug:t=>({u_color:new e.UniformColor(t),u_matrix:new e.UniformMatrix4f(t),u_overlay:new e.Uniform1i(t),u_overlay_scale:new e.Uniform1f(t)}),clippingMask:t=>({u_matrix:new e.UniformMatrix4f(t)}),heatmap:t=>({u_extrude_scale:new e.Uniform1f(t),u_intensity:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),heatmapTexture:t=>({u_image:new e.Uniform1i(t),u_color_ramp:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t)}),hillshade:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_latrange:new e.Uniform2f(t),u_light:new e.Uniform2f(t),u_shadow:new e.UniformColor(t),u_highlight:new e.UniformColor(t),u_accent:new e.UniformColor(t)}),hillshadePrepare:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_dimension:new e.Uniform2f(t),u_zoom:new e.Uniform1f(t),u_unpack:new e.Uniform4f(t)}),line:t=>({u_matrix:new e.UniformMatrix4f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_units_to_pixels:new e.Uniform2f(t),u_dash_image:new e.Uniform1i(t),u_gradient_image:new e.Uniform1i(t),u_image_height:new e.Uniform1f(t),u_texsize:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t),u_trim_offset:new e.Uniform2f(t)}),linePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_texsize:new e.Uniform2f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_units_to_pixels:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t)}),raster:t=>({u_matrix:new e.UniformMatrix4f(t),u_tl_parent:new e.Uniform2f(t),u_scale_parent:new e.Uniform1f(t),u_fade_t:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_image0:new e.Uniform1i(t),u_image1:new e.Uniform1i(t),u_brightness_low:new e.Uniform1f(t),u_brightness_high:new e.Uniform1f(t),u_saturation_factor:new e.Uniform1f(t),u_contrast_factor:new e.Uniform1f(t),u_spin_weights:new e.Uniform3f(t),u_perspective_transform:new e.Uniform2f(t)}),symbolIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_texture:new e.Uniform1i(t)}),symbolSDF:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_is_halo:new e.Uniform1i(t)}),symbolTextAndIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texsize_icon:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_texture_icon:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_is_halo:new e.Uniform1i(t)}),background:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_color:new e.UniformColor(t)}),backgroundPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_pattern_tl:new e.Uniform2f(t),u_pattern_br:new e.Uniform2f(t),u_texsize:new e.Uniform2f(t),u_pattern_size:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),terrainRaster:vn,terrainDepth:vn,skybox:t=>({u_matrix:new e.UniformMatrix4f(t),u_sun_direction:new e.Uniform3f(t),u_cubemap:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxGradient:t=>({u_matrix:new e.UniformMatrix4f(t),u_color_ramp:new e.Uniform1i(t),u_center_direction:new e.Uniform3f(t),u_radius:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxCapture:t=>({u_matrix_3f:new e.UniformMatrix3f(t),u_sun_direction:new e.Uniform3f(t),u_sun_intensity:new e.Uniform1f(t),u_color_tint_r:new e.Uniform4f(t),u_color_tint_m:new e.Uniform4f(t),u_luminance:new e.Uniform1f(t)}),globeRaster:t=>({u_proj_matrix:new e.UniformMatrix4f(t),u_globe_matrix:new e.UniformMatrix4f(t),u_normalize_matrix:new e.UniformMatrix4f(t),u_merc_matrix:new e.UniformMatrix4f(t),u_zoom_transition:new e.Uniform1f(t),u_merc_center:new e.Uniform2f(t),u_image0:new e.Uniform1i(t),u_grid_matrix:new e.UniformMatrix3f(t),u_skirt_height:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_viewport:new e.Uniform2f(t)}),globeAtmosphere:t=>({u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_horizon:new e.Uniform1f(t),u_transition:new e.Uniform1f(t),u_fadeout_range:new e.Uniform1f(t),u_color:new e.Uniform4f(t),u_high_color:new e.Uniform4f(t),u_space_color:new e.Uniform4f(t),u_star_intensity:new e.Uniform1f(t),u_star_density:new e.Uniform1f(t),u_star_size:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t),u_horizon_angle:new e.Uniform1f(t),u_rotation_matrix:new e.UniformMatrix4f(t)})};let li;function ci(t,n,i,r,o,s,a){const l=t.context,c=l.gl,u=t.transform,d=t.useProgram("collisionBox"),h=[];let p=0,f=0;for(let _=0;_<r.length;_++){const m=r[_],g=n.getTile(m),y=g.getBucket(i);if(!y)continue;const v=vt(m,y,u);let b=v;0===o[0]&&0===o[1]||(b=t.translatePosMatrix(v,g,o,s));const x=a?y.textCollisionBox:y.iconCollisionBox,w=y.collisionCircleArray;if(w.length>0){const t=e.create(),n=b;e.mul(t,y.placementInvProjMatrix,u.glCoordMatrix),e.mul(t,t,y.placementViewportMatrix),h.push({circleArray:w,circleOffset:f,transform:n,invTransform:t,projection:y.getProjection()}),p+=w.length/4,f=p}x&&(t.terrain&&t.terrain.setupElevationDraw(g,d),d.draw(l,c.LINES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,qn(b,u,g,y.getProjection()),i.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,null,u.zoom,null,[x.collisionVertexBuffer,x.collisionVertexBufferExt]))}if(!a||!h.length)return;const m=t.useProgram("collisionCircle"),g=new e.StructArrayLayout2f1f2i16;g.resize(4*p),g._trim();let y=0;for(const e of h)for(let t=0;t<e.circleArray.length/4;t++){const n=4*t,i=e.circleArray[n+0],r=e.circleArray[n+1],o=e.circleArray[n+2],s=e.circleArray[n+3];g.emplace(y++,i,r,o,s,0),g.emplace(y++,i,r,o,s,1),g.emplace(y++,i,r,o,s,2),g.emplace(y++,i,r,o,s,3)}(!li||li.length<2*p)&&(li=function(t){const n=2*t,i=new e.StructArrayLayout3ui6;i.resize(n),i._trim();for(let e=0;e<n;e++){const t=6*e;i.uint16[t+0]=4*e+0,i.uint16[t+1]=4*e+1,i.uint16[t+2]=4*e+2,i.uint16[t+3]=4*e+2,i.uint16[t+4]=4*e+3,i.uint16[t+5]=4*e+0}return i}(p));const v=l.createIndexBuffer(li,!0),b=l.createVertexBuffer(g,e.collisionCircleLayout.members,!0);for(const _ of h){const n={u_matrix:_.transform,u_inv_matrix:_.invTransform,u_camera_to_center_distance:(x=u).getCameraToCenterDistance(_.projection),u_viewport_size:[x.width,x.height]};m.draw(l,c.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,n,i.id,b,v,e.SegmentVector.simpleSegment(0,2*_.circleOffset,_.circleArray.length,_.circleArray.length/2),null,u.zoom)}var x;b.destroy(),v.destroy()}const ui=e.create();function di({width:t,height:n,anchor:i,textOffset:r,textScale:o},s){const{horizontalAlign:a,verticalAlign:l}=e.getAnchorAlignment(i),c=-(a-.5)*t,u=-(l-.5)*n,d=e.evaluateVariableOffset(i,r);return new e.Point((c/o+d[0])*s,(u/o+d[1])*s)}function hi(t,n,i,r,o,s,a,l,c,u,d){const h=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,f=t.icon.dynamicLayoutVertexArray,m={},g=t.getProjection(),y=bt(l,g,s),v=s.elevation,b=g.upVectorScale(l.canonical,s.center.lat,s.worldSize).metersToTile;p.clear();for(let x=0;x<h.length;x++){const f=h.get(x),{tileAnchorX:_,tileAnchorY:w,numGlyphs:k}=f,E=f.hidden||!f.crossTileID||t.allowVerticalPlacement&&!f.placedOrientation?null:r[f.crossTileID];if(E){let r=0,h=0,x=0;if(v){const e=v?v.getAtTileOffset(l,_,w):0,[t,n,i]=g.upVector(l.canonical,_,w);r=e*t*b,h=e*n*b,x=e*i*b}let[S,T,C,M]=it(f.projectedAnchorX+r,f.projectedAnchorY+h,f.projectedAnchorZ+x,i?y:a);const I=rt(s.getCameraToCenterDistance(g),M);let A=o.evaluateSizeForFeature(t.textSizeData,u,f)*I/e.ONE_EM;i&&(A*=t.tilePixelRatio/c);const P=di(E,A);i?(({x:S,y:T,z:C}=g.projectTilePoint(_+P.x,w+P.y,l.canonical)),[S,T,C]=it(S+r,T+h,C+x,a)):(n&&P._rotate(-s.angle),S+=P.x,T+=P.y,C=0);const O=t.allowVerticalPlacement&&f.placedOrientation===e.WritingMode.vertical?Math.PI/2:0;for(let t=0;t<k;t++)e.addDynamicAttributes(p,S,T,C,O);d&&f.associatedIconIndex>=0&&(m[f.associatedIconIndex]={x:S,y:T,z:C,angle:O})}else pt(k,p)}if(d){f.clear();const n=t.icon.placedSymbolArray;for(let t=0;t<n.length;t++){const i=n.get(t),{numGlyphs:r}=i,o=m[t];if(i.hidden||!o)pt(r,f);else{const{x:t,y:n,z:i,angle:s}=o;for(let o=0;o<r;o++)e.addDynamicAttributes(f,t,n,i,s)}}t.icon.dynamicLayoutVertexBuffer.updateData(f)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function pi(e,t,n){return n.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function fi(t,n,i,r,o,s,a,l,c,u,d,h){const p=t.context,f=p.gl,m=t.transform,g="map"===l,y="map"===c,v=g&&"point"!==i.layout.get("symbol-placement"),b=g&&!y&&!v,x=void 0!==i.layout.get("symbol-sort-key").constantOr(1);let _=!1;const w=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),k=[e.mercatorXfromLng(m.center.lng),e.mercatorYfromLat(m.center.lat)],E=i.layout.get("text-variable-anchor"),S="globe"===m.projection.name,T=[],C=[0,-1,0];let M=C;!S&&!m.mercatorFromTransition||g||(M=function(t){const n=t._camera.getWorldToCamera(t.worldSize,1),i=e.multiply([],n,t.globeMatrix);e.invert(i,i);const r=[0,0,0],o=[0,1,0,0];return e.transformMat4$1(o,o,i),r[0]=o[0],r[1]=o[1],r[2]=o[2],e.normalize(r,r),r}(m));for(const I of r){const r=n.getTile(I),l=r.getBucket(i);if(!l)continue;if("mercator"===l.projection.name&&S)continue;const c=o?l.text:l.icon;if(!c||l.fullyClipped||!c.segments.get().length)continue;const d=c.programConfigurations.get(i.id),h=o||l.sdfIcons,p=o?l.textSizeData:l.iconSizeData,w=y||0!==m.pitch,A=e.evaluateSizeForZoom(p,m.zoom);let P,O,D,R,z=[0,0],L=null;if(o)O=r.glyphAtlasTexture,D=f.LINEAR,P=r.glyphAtlasTexture.size,l.iconsInText&&(z=r.imageAtlasTexture.size,L=r.imageAtlasTexture,R=w||t.options.rotating||t.options.zooming||"composite"===p.kind||"camera"===p.kind?f.LINEAR:f.NEAREST);else{const e=1!==i.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;O=r.imageAtlasTexture,D=h||t.options.rotating||t.options.zooming||e||w?f.LINEAR:f.NEAREST,P=r.imageAtlasTexture.size}const B="globe"===l.projection.name,N=B?M:C,F=B?e.globeToMercatorTransition(m.zoom):0,$=bt(I,l.getProjection(),m),j=m.calculatePixelsToTileUnitsMatrix(r),V=et($,r.tileID.canonical,y,g,m,l.getProjection(),j),U=t.terrain&&y&&v?e.invert(e.create(),V):ui,q=nt($,r.tileID.canonical,y,g,m,l.getProjection(),j),G=E&&l.hasTextData(),W="none"!==i.layout.get("icon-text-fit")&&G&&l.hasIconData();if(v){const e=m.elevation,n=e?e.getAtTileOffsetFunc(I,m.center.lat,m.worldSize,l.getProjection()):null,i=tt($,r.tileID.canonical,y,g,m,l.getProjection(),j);st(l,$,t,o,i,q,y,u,n,I)}const H=v||o&&E||W,Z=t.translatePosMatrix($,r,s,a),X=H?ui:V,K=t.translatePosMatrix(q,r,s,a,!0),J=l.getProjection().createInversionMatrix(m,I.canonical),Y=[];t.terrainRenderModeElevated()&&y&&Y.push("PITCH_WITH_MAP_TERRAIN"),B&&Y.push("PROJECTION_GLOBE_VIEW"),H&&Y.push("PROJECTED_POS_ON_VIEWPORT");const Q=h&&0!==i.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);let ee;ee=h?l.iconsInText?ri(p.kind,A,b,y,t,Z,X,K,P,z,I,F,k,J,N,l.getProjection()):ii(p.kind,A,b,y,t,Z,X,K,o,P,!0,I,F,k,J,N,l.getProjection()):ni(p.kind,A,b,y,t,Z,X,K,o,P,I,F,k,J,N,l.getProjection());const te={program:t.useProgram(pi(h,o,l),d,Y),buffers:c,uniformValues:ee,atlasTexture:O,atlasTextureIcon:L,atlasInterpolation:D,atlasInterpolationIcon:R,isSDF:h,hasHalo:Q,tile:r,labelPlaneMatrixInv:U};if(x&&l.canOverlap){_=!0;const t=c.segments.get();for(const n of t)T.push({segments:new e.SegmentVector([n]),sortKey:n.sortKey,state:te})}else T.push({segments:c.segments,sortKey:0,state:te})}_&&T.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of T){const n=e.state;if(t.terrain&&t.terrain.setupElevationDraw(n.tile,n.program,{useDepthForOcclusion:!S,labelPlaneMatrixInv:n.labelPlaneMatrixInv}),p.activeTexture.set(f.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,f.CLAMP_TO_EDGE),n.atlasTextureIcon&&(p.activeTexture.set(f.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,mi(n.buffers,e.segments,i,t,n.program,w,d,h,r)),r.u_is_halo=0}mi(n.buffers,e.segments,i,t,n.program,w,d,h,n.uniformValues)}}function mi(t,n,i,r,o,s,a,l,c){const u=r.context,d=[t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.globeExtVertexBuffer];o.draw(u,u.gl.TRIANGLES,s,a,l,e.CullFaceMode.disabled,c,i.id,t.layoutVertexBuffer,t.indexBuffer,n,i.paint,r.transform.zoom,t.programConfigurations.get(i.id),d)}function gi(t,n,i,r,o,s,a){const l=t.context.gl,c=i.paint.get("fill-pattern"),u=c&&c.constantOr(1);let d,h,p,f,m;a?(h=u&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=l.LINES):(h=u?"fillPattern":"fill",d=l.TRIANGLES);for(const g of r){const r=n.getTile(g);if(u&&!r.patternsLoaded())continue;const y=r.getBucket(i);if(!y)continue;t.prepareDrawTile();const v=y.programConfigurations.get(i.id),b=t.useProgram(h,v);u&&(t.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers());const x=c.constantOr(null);if(x&&r.imageAtlas){const e=r.imageAtlas.patternPositions[x.toString()];e&&v.setConstantPatternPositions(e)}const _=t.translatePosMatrix(g.projMatrix,r,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(a){f=y.indexBuffer2,m=y.segments2;const e=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];p="fillOutlinePattern"===h&&u?$n(_,t,r,e):Fn(_,e)}else f=y.indexBuffer,m=y.segments,p=u?Nn(_,t,r):Bn(_);t.prepareDrawProgram(t.context,b,g.toUnwrapped()),b.draw(t.context,d,o,t.stencilModeForClipping(g),s,e.CullFaceMode.disabled,p,i.id,y.layoutVertexBuffer,f,m,i.paint,t.transform.zoom,v)}}function yi(t,n,i,r,o,s,a){const l=t.context,c=l.gl,u=t.transform,d=i.paint.get("fill-extrusion-pattern"),h=d.constantOr(1),p=i.paint.get("fill-extrusion-opacity"),f=[i.paint.get("fill-extrusion-ambient-occlusion-intensity"),i.paint.get("fill-extrusion-ambient-occlusion-radius")],m=i.layout.get("fill-extrusion-edge-radius"),g=m>0&&!i.paint.get("fill-extrusion-rounded-roof"),y=g?0:m,v="globe"===u.projection.name?e.fillExtrusionHeightLift():0,b="globe"===u.projection.name,x=b?e.globeToMercatorTransition(u.zoom):0,_=[e.mercatorXfromLng(u.center.lng),e.mercatorYfromLat(u.center.lat)],w=[];b&&w.push("PROJECTION_GLOBE_VIEW"),f[0]>0&&w.push("FAUX_AO"),g&&w.push("ZERO_ROOF_RADIUS");for(const k of r){const r=n.getTile(k),m=r.getBucket(i);if(!m||m.projection.name!==u.projection.name)continue;const g=m.programConfigurations.get(i.id),E=t.useProgram(h?"fillExtrusionPattern":"fillExtrusion",g,w);if(t.terrain){const e=t.terrain;if(t.style.terrainSetForDrapingOnly())e.setupElevationDraw(r,E,{useMeterToDem:!0});else{if(!m.enableTerrain)continue;if(e.setupElevationDraw(r,E,{useMeterToDem:!0}),vi(l,n,k,m,i,e),!m.centroidVertexBuffer){const e=E.attributes.a_centroid_pos;void 0!==e&&c.vertexAttrib2f(e,0,0)}}}h&&(t.context.activeTexture.set(c.TEXTURE0),r.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),g.updatePaintBuffers());const S=d.constantOr(null);if(S&&r.imageAtlas){const e=r.imageAtlas.patternPositions[S.toString()];e&&g.setConstantPatternPositions(e)}const T=t.translatePosMatrix(k.projMatrix,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),C=u.projection.createInversionMatrix(u,k.canonical),M=i.paint.get("fill-extrusion-vertical-gradient"),I=h?Ln(T,t,M,p,f,y,k,r,v,x,_,C):zn(T,t,M,p,f,y,k,v,x,_,C);t.prepareDrawProgram(l,E,k.toUnwrapped());const A=[];t.terrain&&A.push(m.centroidVertexBuffer),b&&A.push(m.layoutVertexExtBuffer),E.draw(l,l.gl.TRIANGLES,o,s,a,e.CullFaceMode.backCCW,I,i.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,i.paint,t.transform.zoom,g,A)}}function vi(t,n,i,r,o,s){const a=[t=>{let n=t.canonical.x-1,i=t.wrap;return n<0&&(n=(1<<t.canonical.z)-1,i--),new e.OverscaledTileID(t.overscaledZ,i,t.canonical.z,n,t.canonical.y)},t=>{let n=t.canonical.x+1,i=t.wrap;return n===1<<t.canonical.z&&(n=0,i++),new e.OverscaledTileID(t.overscaledZ,i,t.canonical.z,n,t.canonical.y)},t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1),t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)],l=e=>{const t=n.getSource().minzoom,i=e=>{const t=n.getTileByID(e);if(t&&t.hasData())return t.getBucket(o)},r=[0,-1,1];for(const n of r){if(e.overscaledZ+n<t)continue;const r=i(e.calculateScaledKey(e.overscaledZ+n));if(r)return r}},c=[0,0,0],u=(t,n)=>(c[0]=Math.min(t.min.y,n.min.y),c[1]=Math.max(t.max.y,n.max.y),c[2]=e.EXTENT-n.min.x>t.max.x?n.min.x-e.EXTENT:t.max.x,c),d=(t,n)=>(c[0]=Math.min(t.min.x,n.min.x),c[1]=Math.max(t.max.x,n.max.x),c[2]=e.EXTENT-n.min.y>t.max.y?n.min.y-e.EXTENT:t.max.y,c),h=[(e,t)=>u(e,t),(e,t)=>u(t,e),(e,t)=>d(e,t),(e,t)=>d(t,e)],p=new e.Point(0,0);let f,m,g;const y=(t,n,r,o,a)=>{const l=[[o?r:t,o?t:r,0],[o?r:n,o?n:r,0]],c=a<0?e.EXTENT+a:a,u=[o?c:(t+n)/2,o?(t+n)/2:c,0];return 0===r&&a<0||0!==r&&a>0?s.getForTilePoints(g,[u],!0,m):l.push(u),s.getForTilePoints(i,l,!0,f),Math.max(l[0][2],l[1][2],u[2])/s.exaggeration()};for(let v=0;v<4;v++){const t=(v<2?1:5)-v,n=r.borders[v];if(0===n.length)continue;const o=g=a[v](i),c=l(o);if(!(c&&c instanceof e.FillExtrusionBucket&&c.enableTerrain))continue;if(r.borderDoneWithNeighborZ[v]===c.canonical.z&&c.borderDoneWithNeighborZ[t]===r.canonical.z)continue;if(m=s.findDEMTileFor(o),!m||!m.dem)continue;if(!f){const e=s.findDEMTileFor(i);if(!e||!e.dem)return;f=e}const u=c.borders[t];let d=0;const b=c.borderDoneWithNeighborZ[t]!==r.canonical.z;if(r.canonical.z===c.canonical.z){for(let i=0;i<n.length;i++){const o=r.featuresOnBorder[n[i]],s=o.borders[v];let a;for(;d<u.length&&(a=c.featuresOnBorder[u[d]],!(a.borders[t][1]>s[0]+3));)b&&c.encodeCentroid(void 0,a,!1),d++;if(a&&d<u.length){const n=d;let i=0;for(;!(a.borders[t][0]>s[1]-3)&&(i++,++d!==u.length);)a=c.featuresOnBorder[u[d]];if(a=c.featuresOnBorder[u[n]],o.intersectsCount()>1||a.intersectsCount()>1||1!==i){1!==i&&(d=n),r.encodeCentroid(void 0,o,!1),b&&c.encodeCentroid(void 0,a,!1);continue}const l=h[v](o,a),f=v%2?e.EXTENT-1:0;p.x=y(l[0],Math.min(e.EXTENT-1,l[1]),f,v<2,l[2]),p.y=0,r.encodeCentroid(p,o,!1),b&&c.encodeCentroid(p,a,!1)}else r.encodeCentroid(void 0,o,!1)}r.borderDoneWithNeighborZ[v]=c.canonical.z,r.needsCentroidUpdate=!0,b&&(c.borderDoneWithNeighborZ[t]=r.canonical.z,c.needsCentroidUpdate=!0)}else{for(const e of n)r.encodeCentroid(void 0,r.featuresOnBorder[e],!1);if(b){for(const e of u)c.encodeCentroid(void 0,c.featuresOnBorder[e],!1);c.borderDoneWithNeighborZ[t]=r.canonical.z,c.needsCentroidUpdate=!0}r.borderDoneWithNeighborZ[v]=c.canonical.z,r.needsCentroidUpdate=!0}}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(t)}const bi=new e.Color(1,0,0,1),xi=new e.Color(0,1,0,1),_i=new e.Color(0,0,1,1),wi=new e.Color(1,0,1,1),ki=new e.Color(0,1,1,1);function Ei(t,n,i){const r=t.context,o=t.transform,s=r.gl,a="globe"===o.projection.name,l=a?["PROJECTION_GLOBE_VIEW"]:null;let c=i.projMatrix;if(a&&e.globeToMercatorTransition(o.zoom)>0){const t=e.transitionTileAABBinECEF(i.canonical,o),n=e.globeDenormalizeECEF(t);c=e.multiply(new Float32Array(16),o.globeMatrix,n),e.multiply(c,o.projMatrix,c)}const u=t.useProgram("debug",null,l),d=n.getTileByID(i.key);t.terrain&&t.terrain.setupElevationDraw(d,u);const h=e.DepthMode.disabled,p=e.StencilMode.disabled,f=t.colorModeForRenderPass(),m="$debug";r.activeTexture.set(s.TEXTURE0),t.emptyTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),a?d._makeGlobeTileDebugBuffers(t.context,o):d._makeDebugTileBoundsBuffers(t.context,o.projection);const g=d._tileDebugBuffer||t.debugBuffer,y=d._tileDebugIndexBuffer||t.debugIndexBuffer,v=d._tileDebugSegments||t.debugSegments;u.draw(r,s.LINE_STRIP,h,p,f,e.CullFaceMode.disabled,Gn(c,e.Color.red),m,g,y,v,null,null,null,[d._globeTileDebugBorderBuffer]);const b=d.latestRawTileData,x=Math.floor((b&&b.byteLength||0)/1024),_=n.getTile(i).tileSize,w=512/Math.min(_,512)*(i.overscaledZ/o.zoom)*.5;let k=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(k+=` => ${i.overscaledZ}`),k+=` ${x}kb`,function(e,t){e.initDebugOverlayCanvas();const n=e.debugOverlayCanvas,i=e.context.gl,r=e.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(t,5,5),r.strokeText(t,5,5),e.debugOverlayTexture.update(n),e.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(t,k);const E=d._tileDebugTextBuffer||t.debugBuffer,S=d._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,T=d._tileDebugTextSegments||t.debugSegments;u.draw(r,s.TRIANGLES,h,p,e.ColorMode.alphaBlended,e.CullFaceMode.disabled,Gn(c,e.Color.transparent,w),m,E,S,T,null,null,null,[d._globeTileDebugTextBuffer])}function Si(e,t,n,i){Ci(e,0,t+n/2,e.transform.width,n,i)}function Ti(e,t,n,i){Ci(e,t-n/2,0,n,e.transform.height,i)}function Ci(t,n,i,r,o,s){const a=t.context,l=a.gl;l.enable(l.SCISSOR_TEST),l.scissor(n*e.exported.devicePixelRatio,i*e.exported.devicePixelRatio,r*e.exported.devicePixelRatio,o*e.exported.devicePixelRatio),a.clear({color:s}),l.disable(l.SCISSOR_TEST)}const Mi=e.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ii}=Mi;function Ai(e,t,n,i){e.emplaceBack(t,n,i)}class Pi{constructor(t){this.vertexArray=new e.StructArrayLayout3f12,this.indices=new e.StructArrayLayout3ui6,Ai(this.vertexArray,-1,-1,1),Ai(this.vertexArray,1,-1,1),Ai(this.vertexArray,-1,1,1),Ai(this.vertexArray,1,1,1),Ai(this.vertexArray,-1,-1,-1),Ai(this.vertexArray,1,-1,-1),Ai(this.vertexArray,-1,1,-1),Ai(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Ii),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=e.SegmentVector.simpleSegment(0,0,36,12)}}function Oi(t,n,i,r,o,s){const a=t.gl,l=n.paint.get("sky-atmosphere-color"),c=n.paint.get("sky-atmosphere-halo-color"),u=n.paint.get("sky-atmosphere-sun-intensity"),d=((e,t,n,i,r)=>({u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:n,u_color_tint_r:[i.r,i.g,i.b,i.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(e.fromMat4(e.create$1(),r),o,u,l,c);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+s,n.skyboxTexture,0),i.draw(t,a.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.frontCW,d,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Di=e.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ri{constructor(t){const n=new e.StructArrayLayout5f20;n.emplaceBack(-1,1,1,0,0),n.emplaceBack(1,1,1,1,0),n.emplaceBack(1,-1,1,1,1),n.emplaceBack(-1,-1,1,0,1);const i=new e.StructArrayLayout3ui6;i.emplaceBack(0,1,2),i.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(n,Di.members),this.indexBuffer=t.createIndexBuffer(i),this.segments=e.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const zi={symbol:function(t,n,i,r,o){if("translucent"!==t.renderPass)return;const s=e.StencilMode.disabled,a=t.colorModeForRenderPass();i.layout.get("text-variable-anchor")&&function(t,n,i,r,o,s,a){const l=n.transform,c="map"===o,u="map"===s;for(const d of t){const t=r.getTile(d),n=t.getBucket(i);if(!n||!n.text||!n.text.segments.get().length)continue;const o=e.evaluateSizeForZoom(n.textSizeData,l.zoom),s=bt(d,n.getProjection(),l),h=l.calculatePixelsToTileUnitsMatrix(t),p=et(s,t.tileID.canonical,u,c,l,n.getProjection(),h),f="none"!==i.layout.get("icon-text-fit")&&n.hasIconData();if(o){const i=Math.pow(2,l.zoom-t.tileID.overscaledZ);hi(n,c,u,a,e.symbolSize,l,p,d,i,o,f)}}}(r,t,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),o),0!==i.paint.get("icon-opacity").constantOr(1)&&fi(t,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),s,a),0!==i.paint.get("text-opacity").constantOr(1)&&fi(t,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),s,a),n.map.showCollisionBoxes&&(ci(t,n,i,r,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),!0),ci(t,n,i,r,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),!1))},circle:function(t,n,i,r){if("translucent"!==t.renderPass)return;const o=i.paint.get("circle-opacity"),s=i.paint.get("circle-stroke-width"),a=i.paint.get("circle-stroke-opacity"),l=void 0!==i.layout.get("circle-sort-key").constantOr(1);if(0===o.constantOr(1)&&(0===s.constantOr(1)||0===a.constantOr(1)))return;const c=t.context,u=c.gl,d=t.transform,h=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),p=e.StencilMode.disabled,f=t.colorModeForRenderPass(),m="globe"===d.projection.name,g=[e.mercatorXfromLng(d.center.lng),e.mercatorYfromLat(d.center.lat)],y=[];for(let b=0;b<r.length;b++){const o=r[b],s=n.getTile(o),a=s.getBucket(i);if(!a||a.projection.name!==d.projection.name)continue;const c=a.programConfigurations.get(i.id),u=Un(i);m&&u.push("PROJECTION_GLOBE_VIEW");const h=t.useProgram("circle",c,u),p=a.layoutVertexBuffer,f=a.globeExtVertexBuffer,v=a.indexBuffer,x=d.projection.createInversionMatrix(d,o.canonical),_={programConfiguration:c,program:h,layoutVertexBuffer:p,globeExtVertexBuffer:f,indexBuffer:v,uniformValues:Vn(t,o,s,x,g,i),tile:s};if(l){const t=a.segments.get();for(const n of t)y.push({segments:new e.SegmentVector([n]),sortKey:n.sortKey,state:_})}else y.push({segments:a.segments,sortKey:0,state:_})}l&&y.sort(((e,t)=>e.sortKey-t.sortKey));const v={useDepthForOcclusion:!m};for(const b of y){const{programConfiguration:n,program:r,layoutVertexBuffer:o,globeExtVertexBuffer:s,indexBuffer:a,uniformValues:l,tile:m}=b.state,g=b.segments;t.terrain&&t.terrain.setupElevationDraw(m,r,v),t.prepareDrawProgram(c,r,m.tileID.toUnwrapped()),r.draw(c,u.TRIANGLES,h,p,f,e.CullFaceMode.disabled,l,i.id,o,a,g,i.paint,d.zoom,n,[s])}},heatmap:function(t,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const o=t.context,s=o.gl,a=e.StencilMode.disabled,l=new e.ColorMode([s.ONE,s.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,n,i){const r=e.gl,o=t.width*i,s=t.height*i;e.activeTexture.set(r.TEXTURE1),e.viewport.set([0,0,o,s]);let a=n.heatmapFbo;if(!a||a&&(a.width!==o||a.height!==s)){a&&a.destroy();const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),a=n.heatmapFbo=e.createFramebuffer(o,s,!1),function(e,t,n,i,r,o){const s=e.gl;s.texImage2D(s.TEXTURE_2D,0,e.isWebGL2&&e.extRenderToTextureHalfFloat?s.RGBA16F:s.RGBA,r,o,0,s.RGBA,e.extRenderToTextureHalfFloat?e.isWebGL2?s.HALF_FLOAT:e.extTextureHalfFloat.HALF_FLOAT_OES:s.UNSIGNED_BYTE,null),i.colorAttachment.set(n)}(e,0,t,a,o,s)}else r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer)}(o,t,i,"globe"===t.transform.projection.name?.5:.25),o.clear({color:e.Color.transparent});const c=t.transform,u="globe"===c.projection.name,d=u?["PROJECTION_GLOBE_VIEW"]:null,h=u?e.CullFaceMode.frontCCW:e.CullFaceMode.disabled,p=[e.mercatorXfromLng(c.center.lng),e.mercatorYfromLat(c.center.lat)];for(let f=0;f<r.length;f++){const m=r[f];if(n.hasRenderableParent(m))continue;const g=n.getTile(m),y=g.getBucket(i);if(!y||y.projection.name!==c.projection.name)continue;const v=y.programConfigurations.get(i.id),b=t.useProgram("heatmap",v,d),{zoom:x}=t.transform;t.terrain&&t.terrain.setupElevationDraw(g,b),t.prepareDrawProgram(o,b,m.toUnwrapped());const _=c.projection.createInversionMatrix(c,m.canonical);b.draw(o,s.TRIANGLES,e.DepthMode.disabled,a,l,h,Hn(t,m,g,_,p,x,i.paint.get("heatmap-intensity")),i.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,i.paint,t.transform.zoom,v,u?[y.globeExtVertexBuffer]:null)}o.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,n){const i=t.context,r=i.gl,o=n.heatmapFbo;if(!o)return;i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);let s=n.colorRampTexture;s||(s=n.colorRampTexture=new e.Texture(i,n.colorRamp,r.RGBA)),s.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,r.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,((e,t,n,i)=>({u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}))(0,n),n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,n.paint,t.transform.zoom)}(t,i))},line:function(t,n,i,r){if("translucent"!==t.renderPass)return;const o=i.paint.get("line-opacity"),s=i.paint.get("line-width");if(0===o.constantOr(1)||0===s.constantOr(1))return;const a=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),c=t.terrain&&t.terrain.renderingToTexture?1:e.exported.devicePixelRatio,u=i.paint.get("line-dasharray"),d=u.constantOr(1),h=i.layout.get("line-cap"),p=i.paint.get("line-pattern"),f=p.constantOr(1),m=i.paint.get("line-gradient"),g=f?"linePattern":"line",y=t.context,v=y.gl,b=(e=>{const t=[];Yn(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const n=e.paint.get("line-trim-offset");0===n[0]&&0===n[1]||t.push("RENDER_LINE_TRIM_OFFSET");const i=e.paint.get("line-pattern").constantOr(1),r=1!==e.paint.get("line-opacity").constantOr(1);return!i&&r&&t.push("RENDER_LINE_ALPHA_DISCARD"),t})(i);let x=b.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(x=!1);for(const _ of r){const r=n.getTile(_);if(f&&!r.patternsLoaded())continue;const o=r.getBucket(i);if(!o)continue;t.prepareDrawTile();const s=o.programConfigurations.get(i.id),w=t.useProgram(g,s,b),k=p.constantOr(null);if(k&&r.imageAtlas){const e=r.imageAtlas.patternPositions[k.toString()];e&&s.setConstantPatternPositions(e)}const E=u.constantOr(null),S=h.constantOr(null);if(!f&&E&&S&&r.lineAtlas){const e=r.lineAtlas.getDash(E,S);e&&s.setConstantPatternPositions(e)}let[T,C]=i.paint.get("line-trim-offset");if("round"===S||"square"===S){const e=1;T!==C&&(0===T&&(T-=e),1===C&&(C+=e))}const M=t.terrain?_.projMatrix:null,I=f?Xn(t,r,i,M,c):Zn(t,r,i,M,o.lineClipsArray.length,c,[T,C]);if(m){const r=o.gradients[i.id];let s=r.texture;if(i.gradientVersion!==r.version){let a=256;if(i.stepInterpolant){const i=n.getSource().maxzoom,r=_.canonical.z===i?Math.ceil(1<<t.transform.maxZoom-_.canonical.z):1;a=e.clamp(e.nextPowerOfTwo(o.maxLineLength/e.EXTENT*1024*r),256,y.maxTextureSize)}r.gradient=e.renderColorRamp({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:a,image:r.gradient||void 0,clips:o.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new e.Texture(y,r.gradient,v.RGBA),r.version=i.gradientVersion,s=r.texture}y.activeTexture.set(v.TEXTURE1),s.bind(i.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}d&&(y.activeTexture.set(v.TEXTURE0),r.lineAtlasTexture.bind(v.LINEAR,v.REPEAT),s.updatePaintBuffers()),f&&(y.activeTexture.set(v.TEXTURE0),r.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),s.updatePaintBuffers()),t.prepareDrawProgram(y,w,_.toUnwrapped());const A=n=>{w.draw(y,v.TRIANGLES,a,n,l,e.CullFaceMode.disabled,I,i.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,i.paint,t.transform.zoom,s,[o.layoutVertexBuffer2])};if(x){const n=t.stencilModeForClipping(_).ref;0===n&&t.terrain&&y.clear({stencil:0});const i={func:v.EQUAL,mask:255};I.u_alpha_discard_threshold=.8,A(new e.StencilMode(i,n,255,v.KEEP,v.KEEP,v.INVERT)),I.u_alpha_discard_threshold=0,A(new e.StencilMode(i,n,255,v.KEEP,v.KEEP,v.KEEP))}else A(t.stencilModeForClipping(_))}x&&(t.resetStencilClippingMasks(),t.terrain&&y.clear({stencil:0}))},fill:function(t,n,i,r){const o=i.paint.get("fill-color"),s=i.paint.get("fill-opacity");if(0===s.constantOr(1))return;const a=t.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(e.Color.transparent).a&&1===s.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const o=t.depthModeForSublayer(1,"opaque"===t.renderPass?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly);gi(t,n,i,r,o,a,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){const o=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,e.DepthMode.ReadOnly);gi(t,n,i,r,o,a,!0)}},"fill-extrusion":function(t,n,i,r){const o=i.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===t.renderPass){const s=new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);if(1!==o||i.paint.get("fill-extrusion-pattern").constantOr(1))yi(t,n,i,r,s,e.StencilMode.disabled,e.ColorMode.disabled),yi(t,n,i,r,s,t.stencilModeFor3D(),t.colorModeForRenderPass()),t.resetStencilClippingMasks();else{const o=t.colorModeForRenderPass();yi(t,n,i,r,s,e.StencilMode.disabled,o)}}},hillshade:function(t,n,i,r){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const o=t.context,s=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),a=t.colorModeForRenderPass(),l=t.terrain&&t.terrain.renderingToTexture,[c,u]="translucent"!==t.renderPass||l?[{},r]:t.stencilConfigForOverlap(r);for(const d of u){const r=n.getTile(d);if(r.needsHillshadePrepare&&"offscreen"===t.renderPass)yn(t,r,i,s,e.StencilMode.disabled,a);else if("translucent"===t.renderPass){const e=l&&t.terrain?t.terrain.stencilModeForRTTOverlap(d):c[d.overscaledZ];mn(t,d,r,i,s,e,a)}}o.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()},raster:function(t,n,i,r,o,s){if("translucent"!==t.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!r.length)return;const a=t.context,l=a.gl,c=n.getSource(),u=t.useProgram("raster"),d=t.colorModeForRenderPass(),h=t.terrain&&t.terrain.renderingToTexture,[p,f]=c instanceof Me||h?[{},r]:t.stencilConfigForOverlap(r),m=f[f.length-1].overscaledZ,g=!t.options.moving;for(const y of f){const r=h?e.DepthMode.disabled:t.depthModeForSublayer(y.overscaledZ-m,1===i.paint.get("raster-opacity")?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly,l.LESS),o=y.toUnwrapped(),f=n.getTile(y);if(h&&(!f||!f.hasData()))continue;const v=h?y.projMatrix:t.transform.calculateProjMatrix(o,g),b=t.terrain&&h?t.terrain.stencilModeForRTTOverlap(y):p[y.overscaledZ],x=s?0:i.paint.get("raster-fade-duration");f.registerFadeDuration(x);const _=n.findLoadedParent(y,0),w=Cn(f,_,n,t.transform,x);let k,E;t.terrain&&t.terrain.prepareDrawTile();const S="nearest"===i.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;a.activeTexture.set(l.TEXTURE0),f.texture.bind(S,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),_?(_.texture.bind(S,l.CLAMP_TO_EDGE),k=Math.pow(2,_.tileID.overscaledZ-f.tileID.overscaledZ),E=[f.tileID.canonical.x*k%1,f.tileID.canonical.y*k%1]):f.texture.bind(S,l.CLAMP_TO_EDGE),f.texture.useMipmap&&a.extTextureFilterAnisotropic&&t.transform.pitch>20&&l.texParameterf(l.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax);const T=Qn(v,E||[0,0],k||1,w,i,c instanceof Me?c.perspectiveTransform:[0,0]);if(t.prepareDrawProgram(a,u,o),c instanceof Me)c.boundsBuffer&&c.boundsSegments&&u.draw(a,l.TRIANGLES,r,e.StencilMode.disabled,d,e.CullFaceMode.disabled,T,i.id,c.boundsBuffer,t.quadTriangleIndexBuffer,c.boundsSegments);else{const{tileBoundsBuffer:n,tileBoundsIndexBuffer:o,tileBoundsSegments:s}=t.getTileBoundsBuffers(f);u.draw(a,l.TRIANGLES,r,b,d,e.CullFaceMode.disabled,T,i.id,n,o,s)}}t.resetStencilClippingMasks()},background:function(t,n,i,r){const o=i.paint.get("background-color"),s=i.paint.get("background-opacity");if(0===s)return;const a=t.context,l=a.gl,c=t.transform,u=c.tileSize,d=i.paint.get("background-pattern");if(t.isPatternMissing(d))return;const h=!d&&1===o.a&&1===s&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==h)return;const p=e.StencilMode.disabled,f=t.depthModeForSublayer(0,"opaque"===h?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly),m=t.colorModeForRenderPass(),g=t.useProgram(d?"backgroundPattern":"background");let y,v=r;v||(y=t.getBackgroundTiles(),v=Object.values(y).map((e=>e.tileID))),d&&(a.activeTexture.set(l.TEXTURE0),t.imageManager.bind(t.context));for(const b of v){const h=b.toUnwrapped(),v=r?b.projMatrix:t.transform.calculateProjMatrix(h);t.prepareDrawTile();const x=n?n.getTile(b):y?y[b.key]:new e.Tile(b,u,c.zoom,t),_=d?si(v,s,t,d,{tileID:b,tileSize:u}):oi(v,s,o);t.prepareDrawProgram(a,g,h);const{tileBoundsBuffer:w,tileBoundsIndexBuffer:k,tileBoundsSegments:E}=t.getTileBoundsBuffers(x);g.draw(a,l.TRIANGLES,f,p,m,e.CullFaceMode.disabled,_,i.id,w,k,E)}},sky:function(t,n,i){const r=t.transform,o="mercator"===r.projection.name||"globe"===r.projection.name?1:e.smoothstep(7,8,r.zoom),s=i.paint.get("sky-opacity")*o;if(0===s)return;const a=t.context,l=i.paint.get("sky-type"),c=new e.DepthMode(a.gl.LEQUAL,e.DepthMode.ReadOnly,[0,1]),u=t.frameCounter/1e3%1;"atmosphere"===l?"offscreen"===t.renderPass?i.needsSkyboxCapture(t)&&(function(t,n,i,r){const o=t.context,s=o.gl;let a=n.skyboxFbo;if(!a){a=n.skyboxFbo=o.createFramebuffer(32,32,!1),n.skyboxGeometry=new Pi(o),n.skyboxTexture=o.gl.createTexture(),s.bindTexture(s.TEXTURE_CUBE_MAP,n.skyboxTexture),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR);for(let e=0;e<6;++e)s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,s.RGBA,32,32,0,s.RGBA,s.UNSIGNED_BYTE,null)}o.bindFramebuffer.set(a.framebuffer),o.viewport.set([0,0,32,32]);const l=n.getCenter(t,!0),c=t.useProgram("skyboxCapture"),u=new Float64Array(16);e.identity(u),e.rotateY(u,u,.5*-Math.PI),Oi(o,n,c,u,l,0),e.identity(u),e.rotateY(u,u,.5*Math.PI),Oi(o,n,c,u,l,1),e.identity(u),e.rotateX(u,u,.5*-Math.PI),Oi(o,n,c,u,l,2),e.identity(u),e.rotateX(u,u,.5*Math.PI),Oi(o,n,c,u,l,3),e.identity(u),Oi(o,n,c,u,l,4),e.identity(u),e.rotateY(u,u,Math.PI),Oi(o,n,c,u,l,5),o.viewport.set([0,0,t.width,t.height])}(t,i),i.markSkyboxValid(t)):"sky"===t.renderPass&&function(t,n,i,r,o){const s=t.context,a=s.gl,l=t.transform,c=t.useProgram("skybox");s.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,n.skyboxTexture);const u=((e,t,n,i,r)=>({u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:i,u_temporal_offset:r}))(l.skyboxMatrix,n.getCenter(t,!1),0,r,o);t.prepareDrawProgram(s,c),c.draw(s,a.TRIANGLES,i,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,u,"skybox",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(t,i,c,s,u):"gradient"===l&&"sky"===t.renderPass&&function(t,n,i,r,o){const s=t.context,a=s.gl,l=t.transform,c=t.useProgram("skyboxGradient");n.skyboxGeometry||(n.skyboxGeometry=new Pi(s)),s.activeTexture.set(a.TEXTURE0);let u=n.colorRampTexture;u||(u=n.colorRampTexture=new e.Texture(s,n.colorRamp,a.RGBA)),u.bind(a.LINEAR,a.CLAMP_TO_EDGE);const d=((t,n,i,r,o)=>({u_matrix:t,u_color_ramp:0,u_center_direction:n,u_radius:e.degToRad(i),u_opacity:r,u_temporal_offset:o}))(l.skyboxMatrix,n.getCenter(t,!1),n.paint.get("sky-gradient-radius"),r,o);t.prepareDrawProgram(s,c),c.draw(s,a.TRIANGLES,i,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,d,"skyboxGradient",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}(t,i,c,s,u)},debug:function(e,t,n){for(let i=0;i<n.length;i++)Ei(e,t,n[i])},custom:function(t,n,i,r){const o=t.context,s=i.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||"offscreen"===t.renderPass)&&i.isLayerDraped()){if("offscreen"===t.renderPass){const n=s.prerender;if(n){if(t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),"globe"===t.transform.projection.name){const i=t.transform.pointMerc;n.call(s,o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[i.x,i.y],t.transform.pixelsPerMeterRatio)}else n.call(s,o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState()}}else if("translucent"===t.renderPass){if(t.terrain&&t.terrain.renderingToTexture){const n=s.renderToTile;if(n){const i=r[0].canonical,a=new e.MercatorCoordinate(i.x+r[0].wrap*(1<<i.z),i.y,i.z);o.setDepthMode(e.DepthMode.disabled),o.setStencilMode(e.StencilMode.disabled),o.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),n.call(s,o.gl,a),o.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),o.setStencilMode(e.StencilMode.disabled);const n="3d"===s.renderingMode?new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,e.DepthMode.ReadOnly);if(o.setDepthMode(n),"globe"===t.transform.projection.name){const n=t.transform.pointMerc;s.render(o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[n.x,n.y],t.transform.pixelsPerMeterRatio)}else s.render(o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState(),o.bindFramebuffer.set(null)}}else e.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Li{constructor(t,n,i=!1){this.context=new Ee(t,i),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=e.SourceCache.maxUnderzooming+e.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(e,t){const n=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(n||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Pn(this,e));const i=this._terrain;this.transform.elevation=n?i:null,i.update(e,this.transform,t)}_updateFog(e){const t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[n,i]=t.getFovAdjustedRange(this.transform._fov);if(n>i)return void(this.transform.fogCullDistSq=null);const r=n+.78*(i-n);this.transform.fogCullDistSq=r*r}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,n){if(this.width=t*e.exported.devicePixelRatio,this.height=n*e.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style.order)this.style._layers[e].resize()}setup(){const t=this.context,n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(n,e.posAttributes.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);const i=new e.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(e.EXTENT,0),i.emplaceBack(0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(i,e.posAttributes.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);const r=new e.StructArrayLayout2i4;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(-1,1),r.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(r,e.posAttributes.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);const o=new e.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(e.EXTENT,0,e.EXTENT,0),o.emplaceBack(0,e.EXTENT,0,e.EXTENT),o.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(o,e.boundsAttributes.members),this.mercatorBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);const s=new e.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s);const a=new e.StructArrayLayout1ui2;for(const e of[0,1,3,2,0])a.emplaceBack(e);this.debugIndexBuffer=t.createIndexBuffer(a),this.emptyTexture=new e.Texture(t,new e.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=e.create();const l=this.context.gl;this.stencilClearMode=new e.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(e.window.performance.now()),this.atmosphereBuffer=new Ri(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,n=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,n.TRIANGLES,e.DepthMode.disabled,this.stencilClearMode,e.ColorMode.disabled,e.CullFaceMode.disabled,Tn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,n,i){if(!n||this.currentStencilSource===n.id||!t.isTileClipped()||!i||0===i.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let e=!1;for(const t of i)if(void 0===this._tileClippingMaskIDs[t.key]){e=!0;break}if(!e)return}this.currentStencilSource=n.id;const r=this.context,o=r.gl;this.nextStencilID+i.length>256&&this.clearStencil(),r.setColorMode(e.ColorMode.disabled),r.setDepthMode(e.DepthMode.disabled);const s=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of i){const t=n.getTile(a),i=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,{tileBoundsBuffer:l,tileBoundsIndexBuffer:c,tileBoundsSegments:u}=this.getTileBoundsBuffers(t);s.draw(r,o.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:o.ALWAYS,mask:0},i,255,o.KEEP,o.KEEP,o.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Tn(a.projMatrix),"$clipping",l,c,u)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,n=this.context.gl;return new e.StencilMode({func:n.NOTEQUAL,mask:255},t,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const n=this.context.gl;return new e.StencilMode({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,n.KEEP,n.KEEP,n.REPLACE)}stencilConfigForOverlap(t){const n=this.context.gl,i=t.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),r=i[i.length-1].overscaledZ,o=i[0].overscaledZ-r+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();const t={};for(let i=0;i<o;i++)t[i+r]=new e.StencilMode({func:n.GEQUAL,mask:255},i+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=o,[t,i]}return[{[r]:e.StencilMode.disabled},i]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new e.ColorMode([t.CONSTANT_COLOR,t.ONE],new e.Color(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?e.ColorMode.unblended:e.ColorMode.alphaBlended}depthModeForSublayer(t,n,i){if(!this.opaquePassEnabledForLayer())return e.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new e.DepthMode(i||this.context.gl.LEQUAL,n,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,n){this.style=t,this.options=n,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();const i=this.style.order,r=this.style._sourceCaches;for(const e in r){const t=r[e];t.used&&t.prepare(this.context)}const o={},s={},a={};for(const e in r){const t=r[e];o[e]=t.getVisibleCoordinates(),s[e]=o[e].slice().reverse(),a[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<i.length;e++)if(this.style._layers[i[e]].is3D()){this.opaquePassCutoff=e;break}if(this.terrain&&(this.terrain.updateTileBinding(a),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.GlobeSharedBuffers(this.context)),!e.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const e of i){const n=this.style._layers[e],i=t._getLayerSourceCache(n);if(!n.hasOffscreenPass()||n.isHidden(this.transform.zoom))continue;const r=i?s[i.id]:void 0;("custom"===n.type||n.isSky()||r&&r.length)&&this.renderLayer(this,i,n,r)}this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon];const l=this.terrain;if(l&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&l.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:n.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[i[this.currentLayer]],n=t._getLayerSourceCache(e);if(e.isSky())continue;const r=n?s[n.id]:void 0;this._renderTileClippingMasks(e,n,r),this.renderLayer(this,n,e,r)}if(this.style.fog&&this.transform.projection.supportsFog&&function(t,n){const i=t.context,r=i.gl,o=t.transform,s=new e.DepthMode(r.LEQUAL,e.DepthMode.ReadOnly,[0,1]),a=t.useProgram("globeAtmosphere",null,"globe"===o.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),l=e.globeToMercatorTransition(o.zoom),c=n.properties.get("color").toArray01(),u=n.properties.get("high-color").toArray01(),d=n.properties.get("space-color").toArray01PremultipliedAlpha(),h=e.identity$1([]);e.rotateY$1(h,h,-e.degToRad(o._center.lng)),e.rotateX$1(h,h,e.degToRad(o._center.lat)),e.rotateZ$1(h,h,o.angle),e.rotateX$1(h,h,-o._pitch);const p=e.fromQuat(new Float32Array(16),h),f=e.mapValue(n.properties.get("star-intensity"),0,1,0,.25),m=5e-4,g=e.mapValue(n.properties.get("horizon-blend"),0,1,m,.25),y=e.globeUseCustomAntiAliasing(t,i,o)&&g===m?o.worldSize/(2*Math.PI*1.025)-1:o.globeRadius,v=t.frameCounter/1e3%1,b=e.length(o.globeCenterInViewSpace),x=Math.sqrt(Math.pow(b,2)-Math.pow(y,2)),_=Math.acos(x/b),w=((t,n,i,r,o,s,a,l,c,u,d,h,p,f)=>({u_frustum_tl:t,u_frustum_tr:n,u_frustum_br:i,u_frustum_bl:r,u_horizon:o,u_transition:s,u_fadeout_range:a,u_color:l,u_high_color:c,u_space_color:u,u_star_intensity:d,u_star_size:5*e.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:h,u_horizon_angle:p,u_rotation_matrix:f}))(o.frustumCorners.TL,o.frustumCorners.TR,o.frustumCorners.BR,o.frustumCorners.BL,o.frustumCorners.horizon,l,g,c,u,d,f,v,_,p);t.prepareDrawProgram(i,a);const k=t.atmosphereBuffer;k&&a.draw(i,r.TRIANGLES,s,e.StencilMode.disabled,e.ColorMode.alphaBlended,e.CullFaceMode.backCW,w,"skybox",k.vertexBuffer,k.indexBuffer,k.segments)}(this,this.style.fog),this.renderPass="sky",(e.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){const e=this.style._layers[i[this.currentLayer]],n=t._getLayerSourceCache(e);e.isSky()&&this.renderLayer(this,n,e,n?s[n.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;){const e=this.style._layers[i[this.currentLayer]],n=t._getLayerSourceCache(e);if(e.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(e)){if(e.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=n?("symbol"===e.type?a:s)[n.id]:void 0;this._renderTileClippingMasks(e,n,n?o[n.id]:void 0),this.renderLayer(this,n,e,r),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let n=null;e.values(this.style._layers).forEach((e=>{const i=t._getLayerSourceCache(e);i&&!e.isHidden(this.transform.zoom)&&(!n||n.getSource().maxzoom<i.getSource().maxzoom)&&(n=i)})),n&&this.options.showTileBoundaries&&zi.debug(this,n,n.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;Si(e,e.transform.height-(t.top||0),3,bi),Si(e,t.bottom||0,3,xi),Ti(e,t.left||0,3,_i),Ti(e,e.transform.width-(t.right||0),3,wi);const n=e.transform.centerPoint;!function(e,t,n,i){Ci(e,t-1,n-10,2,20,i),Ci(e,t-10,n-1,20,2,i)}(e,n.x,e.transform.height-n.y,ki)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(e.window.performance.now()),this.saveCanvasCopy())}renderLayer(e,t,n,i){n.isHidden(this.transform.zoom)||("background"===n.type||"sky"===n.type||"custom"===n.type||i&&i.length)&&(this.id=n.id,this.gpuTimingStart(n),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(n.type)||e.terrain&&"custom"===n.type)&&zi[n.type](e,t,n,i,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;let n=this.gpuTimers[e.id];n||(n=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),n.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,n.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,t=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(t),e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const t={};for(const n in e){const i=e[n],r=this.context.extTimerQuery,o=r.getQueryObjectEXT(i.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(i.query),t[n]=o}return t}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const t=this.context.extTimerQuery;let n=0;for(const i of e)n+=t.getQueryObjectEXT(i,t.QUERY_RESULT_EXT)/1e6,t.deleteQueryEXT(i);return n}translatePosMatrix(t,n,i,r,o){if(!i[0]&&!i[1])return t;const s=o?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(s){const e=Math.sin(s),t=Math.cos(s);i=[i[0]*t-i[1]*e,i[0]*e+i[1]*t]}const a=[o?i[0]:A(n,i[0],this.transform.zoom),o?i[1]:A(n,i[1],this.transform.zoom),0],l=new Float32Array(16);return e.translate(l,t,a),l}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){return null===e||void 0!==e&&!this.imageManager.getPattern(e.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const e=this.terrain&&this.terrain.renderingToTexture,t=this.terrain&&0===this.terrain.exaggeration(),n=this.style&&this.style.fog,i=[];return this.terrainRenderModeElevated()&&i.push("TERRAIN"),"globe"===this.transform.projection.name&&i.push("GLOBE"),t&&i.push("ZERO_EXAGGERATION"),n&&!e&&0!==n.getOpacity(this.transform.pitch)&&i.push("FOG"),e&&i.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&i.push("OVERDRAW_INSPECTOR"),i}useProgram(e,t,n){this.cache=this.cache||{};const i=n||[],r=this.currentGlobalDefines().concat(i),o=On.cacheKey(un[e],e,r,t);return this.cache[o]||(this.cache[o]=new On(this.context,e,un[e],t,ai[e],r)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,n,i){if(this.terrain&&this.terrain.renderingToTexture)return;const r=this.style.fog;if(r){const o=r.getOpacity(this.transform.pitch),s=((t,n,i,r,o,s,a,l,c,u,d)=>{const h=t.transform,p=n.properties.get("color").toArray01();p[3]=r;const f=t.frameCounter/1e3%1;return{u_fog_matrix:i?h.calculateFogTileMatrix(i):t.identityMat,u_fog_range:n.getFovAdjustedRange(h._fov),u_fog_color:p,u_fog_horizon_blend:n.properties.get("horizon-blend"),u_fog_temporal_offset:f,u_frustum_tl:o,u_frustum_tr:s,u_frustum_br:a,u_frustum_bl:l,u_globe_pos:c,u_globe_radius:u,u_viewport:d,u_globe_transition:e.globeToMercatorTransition(h.zoom),u_is_globe:+("globe"===h.projection.name)}})(this,r,i,o,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.exported.devicePixelRatio,this.transform.height*e.exported.devicePixelRatio]);n.setFogUniformValues(t,s)}}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,n=this._backgroundTiles={},i=this.transform.coveringTiles({tileSize:512});for(const r of i)n[r.key]=t[r.key]||new e.Tile(r,512,this.transform.tileZoom,this);return n}clearBackgroundTiles(){this._backgroundTiles={}}}class Bi{constructor(e=0,t=0,n=0,i=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=n,this.right=i}interpolate(t,n,i){return null!=n.top&&null!=t.top&&(this.top=e.number(t.top,n.top,i)),null!=n.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,n.bottom,i)),null!=n.left&&null!=t.left&&(this.left=e.number(t.left,n.left,i)),null!=n.right&&null!=t.right&&(this.right=e.number(t.right,n.right,i)),this}getCenter(t,n){const i=e.clamp((this.left+t-this.right)/2,0,t),r=e.clamp((this.top+n-this.bottom)/2,0,n);return new e.Point(i,r)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Bi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ni(t,n){const i=e.getColumn(t,3);e.fromQuat(t,n),e.setColumn(t,3,i)}function Fi(t,n){const i=e.identity$1([]);return e.rotateZ$1(i,i,-n),e.rotateX$1(i,i,-t),i}function $i(t,n){const i=[t[0],t[1],0],r=[n[0],n[1],0];if(e.length(i)>=1e-15){const t=e.normalize([],i);e.scale$2(r,t,e.dot(r,t)),n[0]=r[0],n[1]=r[1]}const o=e.cross([],n,t);if(e.len(o)<1e-15)return null;const s=Math.atan2(-o[1],o[0]);return Fi(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),s)}class ji{constructor(e,t){this.position=e,this.orientation=t}get position(){return this._position}set position(t){if(t){const n=t instanceof e.MercatorCoordinate?t:new e.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(n.x=e.wrap(n.x,0,1)),this._position=n}else this._position=null}lookAtPoint(t,n){if(this.orientation=null,!this.position)return;const i=this.position,r=this._elevation?this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)):0,o=e.MercatorCoordinate.fromLngLat(t,r),s=[o.x-i.x,o.y-i.y,o.z-i.z];n||(n=[0,0,1]),n[2]=Math.abs(n[2]),this.orientation=$i(s,n)}setPitchBearing(t,n){this.orientation=Fi(e.degToRad(t),e.degToRad(-n))}}class Vi{constructor(t,n){this._transform=e.identity([]),this.orientation=n,this.position=t}get mercatorPosition(){const t=this.position;return new e.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=e.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var n;t&&e.setColumn(this._transform,3,[(n=t)[0],n[1],n[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||e.identity$1([]),t&&Ni(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,t){this._orientation=Fi(e,t),Ni(this._transform,this._orientation)}forward(){const t=e.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=e.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=e.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,n){const i=new Float64Array(16);return e.invert(i,this.getWorldToCamera(t,n)),i}getWorldToCameraPosition(t,n,i){const r=this.position;e.scale$2(r,r,-t);const o=new Float64Array(16);return e.fromScaling(o,[i,i,i]),e.translate(o,o,r),o[10]*=n,o}getWorldToCamera(t,n){const i=new Float64Array(16),r=new Float64Array(4),o=this.position;return e.conjugate(r,this._orientation),e.scale$2(o,o,-t),e.fromQuat(i,r),e.translate(i,i,o),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=n,i[9]*=n,i[10]*=n,i[11]*=n,i}getCameraToClipPerspective(t,n,i,r){const o=new Float64Array(16);return e.perspective(o,t,n,i,r),o}getDistanceToElevation(t,n=!1){const i=0===t?0:e.mercatorZfromAltitude(t,n?e.latFromMercatorY(this.position[1]):this.position[1]),r=this.forward();return(i-this.position[2])/r[2]}clone(){return new Vi([...this.position],[...this.orientation])}}function Ui(t,n){const i=Gi(t.projection,t.zoom,t.width,t.height),r=function(t,n,i,r,o){const s=new e.LngLat(i.lng-180*Wi,i.lat),a=new e.LngLat(i.lng+180*Wi,i.lat),l=t.project(s.lng,s.lat),c=t.project(a.lng,a.lat),u=-Math.atan2(c.y-l.y,c.x-l.x),d=e.MercatorCoordinate.fromLngLat(i);d.y=e.clamp(d.y,-1+Wi,1-Wi);const h=d.toLngLat(),p=t.project(h.lng,h.lat),f=e.MercatorCoordinate.fromLngLat(h);f.x+=Wi;const m=f.toLngLat(),g=t.project(m.lng,m.lat),y=Zi(g.x-p.x,g.y-p.y,u),v=e.MercatorCoordinate.fromLngLat(h);v.y+=Wi;const b=v.toLngLat(),x=t.project(b.lng,b.lat),_=Zi(x.x-p.x,x.y-p.y,u),w=Math.abs(y.x)/Math.abs(_.y),k=e.identity([]);e.rotateZ(k,k,-u*(1-(o?0:r)));const E=e.identity([]);return e.scale(E,E,[1,1-(1-w)*r,1]),E[4]=-_.x/_.y*r,e.rotateZ(E,E,u),e.multiply(E,k,E),E}(t.projection,0,t.center,i,n),o=qi(t);return e.scale(r,r,[o,o,1]),r}function qi(t){const n=t.projection,i=Gi(t.projection,t.zoom,t.width,t.height),r=Hi(n,t.center),o=Hi(n,e.LngLat.convert(n.center));return Math.pow(2,r*i+(1-i)*o)}function Gi(t,n,i,r,o=1/0){const s=t.range;if(!s)return 0;const a=Math.min(o,Math.max(i,r)),l=Math.log(a/1024)/Math.LN2;return e.smoothstep(s[0]+l,s[1]+l,n)}const Wi=1/4e4;function Hi(t,n){const i=e.clamp(n.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),r=new e.LngLat(n.lng-180*Wi,i),o=new e.LngLat(n.lng+180*Wi,i),s=t.project(r.lng,i),a=t.project(o.lng,i),l=e.MercatorCoordinate.fromLngLat(r),c=e.MercatorCoordinate.fromLngLat(o),u=a.x-s.x,d=a.y-s.y,h=c.x-l.x,p=c.y-l.y,f=Math.sqrt((h*h+p*p)/(u*u+d*d));return Math.log(f)/Math.LN2}function Zi(e,t,n){const i=Math.cos(n),r=Math.sin(n);return{x:e*i-t*r,y:e*r+t*i}}class Xi{constructor(t,n,i,r,o,s,a){this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setProjection(s),this.setMaxBounds(a),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Bi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Vi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const e=new Xi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(e,t=!1){const n=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||n)&&this._updateCameraOnTerrain(),(e||n)&&this._constrainCamera(t),this._calcMatrices()}getProjection(){return e.pick(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const i=this.projection?this.getProjection():void 0;this.projection=e.getProjection(this.projectionOptions);const r=!t(i,this.getProjection());return r&&this._calcMatrices(),this.mercatorFromTransition=!1,r}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=e.getProjection({name:"mercator"});const n=t!==this.projection.name;return n&&this._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return e.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.Point(this.width,this.height)}get bearing(){return e.wrap(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const n=-t*Math.PI/180;var i;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(i=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i),function(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=Math.sin(n),l=Math.cos(n);e[0]=i*l+o*a,e[1]=r*l+s*a,e[2]=i*-a+o*l,e[3]=r*-a+s*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const n=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=e.degToRad(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,n=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],i=this.horizonLineFromTop();let r=0,o=0;for(let s=0;s<n.length;s++){const a=new e.Point(n[s][0]*this.width,i+n[s][1]*(this.height-i)),l=t.pointCoordinate(a);if(!l)continue;const c=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*c,o+=c}return 0===o?NaN:r/o}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),n=this.pixelsPerMeter/this.worldSize*t,i=this._mercatorZfromZoom(e),r=this._mercatorZfromZoom(this._maxZoom),o=Math.max(i-n,r);this._setZoom(this._zoomFromMercatorZ(o))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(t){const n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let i;i=t.z<this._camera.position[2]?[n.x,n.y,n.z]:[t.x,t.y,t.z];const r=e.length(e.sub([],this._camera.position,i));return e.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height)return;if(!t.position&&!t.orientation)return;this._updateCameraState();let n=!1;if(t.orientation&&!e.exactEquals(t.orientation,this._camera.orientation)&&(n=this._setCameraOrientation(t.orientation)),t.position){const i=[t.position.x,t.position.y,t.position.z];e.exactEquals$1(i,this._camera.position)||(this._setCameraPosition(i),n=!0)}n&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,n=new ji;return n.position=new e.MercatorCoordinate(t[0],t[1],t[2]),n.orientation=this._camera.orientation,n._elevation=this.elevation,n._renderWorldCopies=this.renderWorldCopies,n}_setCameraOrientation(t){if(!e.length$1(t))return!1;e.normalize$1(t,t);const n=e.transformQuat([],[0,0,-1],t),i=e.transformQuat([],[0,-1,0],t);if(i[2]<0)return!1;const r=$i(n,i);return!!r&&(this._camera.orientation=r,!0)}_setCameraPosition(t){const n=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;t[2]=e.clamp(t[2],r/i,r/n),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const n=[new e.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const i=this.pointCoordinate(new e.Point(0,0)),r=this.pointCoordinate(new e.Point(this.width,0)),o=this.pointCoordinate(new e.Point(this.width,this.height)),s=this.pointCoordinate(new e.Point(0,this.height)),a=Math.floor(Math.min(i.x,r.x,o.x,s.x)),l=Math.floor(Math.max(i.x,r.x,o.x,s.x)),c=1;for(let u=a-c;u<=l+c;u++)0!==u&&n.push(new e.UnwrappedTileID(u,t))}return n}coveringTiles(t){let n=this.coveringZoomLevel(t);const i=n,r=this.elevation&&!t.isTerrainDEM,o="mercator"===this.projection.name;if(void 0!==t.minzoom&&n<t.minzoom)return[];void 0!==t.maxzoom&&n>t.maxzoom&&(n=t.maxzoom);const s=this.locationCoordinate(this.center),a=this.center.lat,l=1<<n,c=[l*s.x,l*s.y,0],u="globe"===this.projection.name,d=!u,h=e.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,d),p=u?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),f=l*e.mercatorZfromAltitude(1,this.center.lat),m=this._camera.position[2]/e.mercatorZfromAltitude(1,this.center.lat),g=[l*p.x,l*p.y,m*(d?1:f)],y=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),v=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?n:0,b=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,x=t.isTerrainDEM?-b:this._elevation?this._elevation.getMinElevationBelowMSL():0,_=this.projection.isReprojectedInTileSpace?qi(this):1,w=t=>{const n=1/4e4,i=new e.MercatorCoordinate(t.x+n,t.y,t.z),r=new e.MercatorCoordinate(t.x,t.y+n,t.z),o=t.toLngLat(),s=i.toLngLat(),a=r.toLngLat(),l=this.locationCoordinate(o),c=this.locationCoordinate(s),u=this.locationCoordinate(a),d=Math.hypot(c.x-l.x,c.y-l.y),h=Math.hypot(u.x-l.x,u.y-l.y);return Math.sqrt(d*h)*_/n},k=t=>{const n=b,i=x;return{aabb:e.tileAABB(this,l,0,0,0,t,i,n,this.projection),zoom:0,x:0,y:0,minZ:i,maxZ:n,wrap:t,fullyVisible:!1}},E=[];let S=[];const T=n,C=t.reparseOverscaled?i:n,M=e=>e*e,I=M((m-this._centerAltitude)*f),A=e=>{if(!this._elevation||!e.tileID||!o)return;const t=this._elevation.getMinMaxForTile(e.tileID),n=e.aabb;t?(n.min[2]=t.min,n.max[2]=t.max,n.center[2]=(n.min[2]+n.max[2])/2):(e.shouldSplit=P(e),e.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=this._centerAltitude))},P=t=>{if(t.zoom<v)return!0;if(t.zoom===T)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const n=t.aabb.distanceX(g),o=t.aabb.distanceY(g);let s=I,l=1;if(u){s=M(t.aabb.distanceZ(g));const n=Math.pow(2,t.zoom),i=e.latFromMercatorY((t.y+1)/n),r=e.latFromMercatorY(t.y/n),o=Math.min(Math.max(a,i),r),c=e.circumferenceAtLatitude(o)/e.circumferenceAtLatitude(a);if(l=o===a?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,c/this._mercatorScaleRatio),this.zoom<=e.GLOBE_ZOOM_THRESHOLD_MIN&&t.zoom===T-1&&c>=.9)return!0}else if(r&&(s=M(t.aabb.distanceZ(g)*f)),this.projection.isReprojectedInTileSpace&&i<=5){const n=Math.pow(2,t.zoom),i=w(new e.MercatorCoordinate((t.x+.5)/n,(t.y+.5)/n));l=i>.85?1:i}const c=n*n+o*o+s,d=M((1<<T-t.zoom)*y*l*((e,t)=>{if(t*M(.707)<e)return 1;const n=Math.sqrt(t/e);return n/(1.4144271570014144+(Math.pow(1.1,n-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(s,I),c));return c<d};if(this.renderWorldCopies)for(let e=1;e<=3;e++)E.push(k(-e)),E.push(k(e));for(E.push(k(0));E.length>0;){const i=E.pop(),s=i.x,a=i.y;let d=i.fullyVisible;if(!d){const e=i.aabb.intersects(h);if(0===e)continue;d=2===e}if(i.zoom!==T&&P(i))for(let t=0;t<4;t++){const n=(s<<1)+t%2,c=(a<<1)+(t>>1),h={aabb:o?i.aabb.quadrant(t):e.tileAABB(this,l,i.zoom+1,n,c,i.wrap,i.minZ,i.maxZ,this.projection),zoom:i.zoom+1,x:n,y:c,wrap:i.wrap,fullyVisible:d,tileID:void 0,shouldSplit:void 0,minZ:i.minZ,maxZ:i.maxZ};r&&!u&&(h.tileID=new e.OverscaledTileID(i.zoom+1===T?C:i.zoom+1,i.wrap,i.zoom+1,n,c),A(h)),E.push(h)}else{const r=i.zoom===T?C:i.zoom;if(t.minzoom&&t.minzoom>r)continue;const o=c[0]-(.5+s+(i.wrap<<i.zoom))*(1<<n-i.zoom),l=c[1]-.5-a,u=i.tileID?i.tileID:new e.OverscaledTileID(r,i.wrap,i.zoom,s,a);S.push({tileID:u,distanceSq:o*o+l*l})}}if(this.fogCullDistSq){const n=this.fogCullDistSq,i=this.horizonLineFromTop();S=S.filter((r=>{const o=[0,0,0,1],s=[e.EXTENT,e.EXTENT,0,1],a=this.calculateFogTileMatrix(r.tileID.toUnwrapped());e.transformMat4$1(o,o,a),e.transformMat4$1(s,s,a);const l=e.getAABBPointSquareDist(o,s);if(0===l)return!0;let c=!1;const u=this._elevation;if(u&&l>n&&0!==i){const n=this.calculateProjMatrix(r.tileID.toUnwrapped());let o;t.isTerrainDEM||(o=u.getMinMaxForTile(r.tileID)),o||(o={min:x,max:b});const s=e.furthestTileCorner(this.rotation),a=[s[0]*e.EXTENT,s[1]*e.EXTENT,o.max];e.transformMat4(a,a,n),c=(1-a[1])*this.height*.5<i}return l<n||c}))}return S.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const n=e.clamp(t.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),i=this.projection.project(t.lng,n);return new e.Point(i.x*this.worldSize,i.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/e.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,n){let i,r;const o=this.centerPoint;if("globe"===this.projection.name){const e=this.worldSize;i=(n.x-o.x)/e,r=(n.y-o.y)/e}else{const e=this.pointCoordinate(n),t=this.pointCoordinate(o);i=e.x-t.x,r=e.y-t.y}const s=this.locationCoordinate(t);this.setLocation(new e.MercatorCoordinate(s.x-i,s.y-r))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(t,n){const i=n?e.mercatorZfromAltitude(n,t.lat):void 0,r=this.projection.project(t.lng,t.lat);return new e.MercatorCoordinate(r.x,r.y,i)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(t,n){const i=null!=n?n:this._centerAltitude,r=[t.x,t.y,0,1],o=[t.x,t.y,1,1];e.transformMat4$1(r,r,this.pixelMatrixInverse),e.transformMat4$1(o,o,this.pixelMatrixInverse);const s=o[3];e.scale$1(r,r,1/r[3]),e.scale$1(o,o,1/s);const a=r[2],l=o[2];return{p0:r,p1:o,t:a===l?0:(i-a)/(l-a)}}screenPointToMercatorRay(t){const n=[t.x,t.y,0,1],i=[t.x,t.y,1,1];return e.transformMat4$1(n,n,this.pixelMatrixInverse),e.transformMat4$1(i,i,this.pixelMatrixInverse),e.scale$1(n,n,1/n[3]),e.scale$1(i,i,1/i[3]),n[2]=e.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,i[2]=e.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,e.scale$1(n,n,1/this.worldSize),e.scale$1(i,i,1/this.worldSize),new e.Ray([n[0],n[1],n[2]],e.normalize([],e.sub([],i,n)))}rayIntersectionCoordinate(t){const{p0:n,p1:i,t:r}=t,o=e.mercatorZfromAltitude(n[2],this._center.lat),s=e.mercatorZfromAltitude(i[2],this._center.lat);return new e.MercatorCoordinate(e.number(n[0],i[0],r)/this.worldSize,e.number(n[1],i[1],r)/this.worldSize,e.number(o,s,r))}pointCoordinate(e,t=this._centerAltitude){return this.projection.pointCoordinate(this,e.x,e.y,t)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let n=this.projection.pointCoordinate3D(this,t.x,t.y);if(n)return new e.MercatorCoordinate(n[0],n[1],n[2]);let i=0,r=this.horizonLineFromTop();if(t.y>r)return this.pointCoordinate(t);const o=.02*r,s=t.clone();for(let a=0;a<10&&r-i>o;a++){s.y=e.number(i,r,.66);const t=this.projection.pointCoordinate3D(this,s.x,s.y);t?(r=s.y,n=t):i=s.y}return n?new e.MercatorCoordinate(n[0],n[1],n[2]):this.pointCoordinate(t)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(t);const n=this.pointCoordinate(t);return n.y>=0&&n.y<=1}_coordinatePoint(t,n){const i=n&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,r=[t.x*this.worldSize,t.y*this.worldSize,i+t.toAltitude(),1];return e.transformMat4$1(r,r,this.pixelMatrix),r[3]>0?new e.Point(r[0]/r[3],r[1]/r[3]):new e.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:n}=this._edgeInsets,i=this.height-this._edgeInsets.bottom,r=this.width-this._edgeInsets.right,o=this.pointLocation3D(new e.Point(n,t)),s=this.pointLocation3D(new e.Point(r,t)),a=this.pointLocation3D(new e.Point(r,i)),l=this.pointLocation3D(new e.Point(n,i));let c=Math.min(o.lng,s.lng,a.lng,l.lng),u=Math.max(o.lng,s.lng,a.lng,l.lng),d=Math.min(o.lat,s.lat,a.lat,l.lat),h=Math.max(o.lat,s.lat,a.lat,l.lat);const p=Math.pow(2,-this.zoom)/16*270,f="globe"===this.projection.name?1:4,m=(t,n,i,r,o)=>{const s=(t+i)/2,a=(n+r)/2,l=new e.Point(s,a),{lng:g,lat:y}=this.pointLocation3D(l),v=Math.max(0,c-g,d-y,g-u,y-h);c=Math.min(c,g),u=Math.max(u,g),d=Math.min(d,y),h=Math.max(h,y),(o<f||v>p)&&(m(t,n,s,a,o+1),m(s,a,i,r,o+1))};if(m(n,t,r,t,1),m(r,t,r,i,1),m(r,i,n,i,1),m(n,i,n,t,1),"globe"===this.projection.name){const[t,n]=e.polesInViewport(this);t?(h=90,u=180,c=-180):n&&(d=-90,u=180,c=-180)}return new e.LngLatBounds(new e.LngLat(c,d),new e.LngLat(u,h))}_getBoundsRectangular(t,n){const{top:i,left:r}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,s=this.width-this._edgeInsets.right,a=new e.Point(r,i),l=new e.Point(s,i),c=new e.Point(s,o),u=new e.Point(r,o);let d=this.pointCoordinate(a,t),h=this.pointCoordinate(l,t);const p=this.pointCoordinate(c,n),f=this.pointCoordinate(u,n),m=(e,t)=>(t.y-e.y)/(t.x-e.x);return d.y>1&&h.y>=0?d=new e.MercatorCoordinate((1-f.y)/m(f,d)+f.x,1):d.y<0&&h.y<=1&&(d=new e.MercatorCoordinate(-f.y/m(f,d)+f.x,0)),h.y>1&&d.y>=0?h=new e.MercatorCoordinate((1-p.y)/m(p,h)+p.x,1):h.y<0&&d.y<=1&&(h=new e.MercatorCoordinate(-p.y/m(p,h)+p.x,0)),(new e.LngLatBounds).extend(this.coordinateLocation(d)).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(p))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const t=e.visibleDemTiles.reduce(((e,t)=>{if(t.dem){const n=t.dem.tree;e.min=Math.min(e.min,n.minimums[0]),e.max=Math.max(e.max,n.maximums[0])}return e}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(t.min*e.exaggeration(),t.max*e.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(e=!0){const t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,n=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,n):n}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-e.MAX_MERCATOR_LATITUDE,this.maxLat=e.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=e.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=e.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=e.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,t){return this.projection.createTileMatrix(this,t,e)}calculateDistanceTileData(t){const n=t.key,i=this._distanceTileDataCache;if(i[n])return i[n];const r=t.canonical,o=1/this.height,s=this.cameraWorldSize,a=s/this.zoomScale(r.z),l=(r.x+Math.pow(2,r.z)*t.wrap)*a,c=r.y*a,u=this.point;u.x*=s/this.worldSize,u.y*=s/this.worldSize;const d=this.angle,h=Math.sin(-d),p=-Math.cos(-d);return i[n]={bearing:[h,p],center:[(u.x-l)*o,(u.y-c)*o],scale:a/e.EXTENT*o},i[n]}calculateFogTileMatrix(t){const n=t.key,i=this._fogTileMatrixCache;if(i[n])return i[n];const r=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return e.multiply(r,this.worldToFogMatrix,r),i[n]=new Float32Array(r),i[n]}calculateProjMatrix(t,n=!1){const i=t.key,r=n?this._alignedProjMatrixCache:this._projMatrixCache;if(r[i])return r[i];const o=this.calculatePosMatrix(t,this.worldSize);return e.multiply(o,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:n?this.alignedProjMatrix:this.projMatrix,o),r[i]=new Float32Array(o),r[i]}calculatePixelsToTileUnitsMatrix(t){const n=t.tileID.key,i=this._pixelsToTileUnitsCache;if(i[n])return i[n];const r=function(t,n){const{scale:i}=t.tileTransform,r=i*e.EXTENT/(t.tileSize*Math.pow(2,n.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return o=new Float32Array(4),l=(s=n.inverseAdjustmentMatrix)[1],c=s[2],u=s[3],h=(a=[r,r])[1],o[0]=s[0]*(d=a[0]),o[1]=l*d,o[2]=c*h,o[3]=u*h,o;var o,s,a,l,c,u,d,h}(t,this);return i[n]=r,i[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,n=e.fromScaling([],[t,t,t]);return e.multiply(n,n,this.globeMatrix),n}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const n=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(n),r=this._camera.forward(),o=e.mercatorZfromAltitude(1,this._center.lat);i[2]/=o,r[2]/=o,e.normalize(r,r);const s=t.raycast(i,r,t.exaggeration());if(s){const t=e.scaleAndAdd([],i,r,s),n=new e.MercatorCoordinate(t[0],t[1],e.mercatorZfromAltitude(t[2],e.latFromMercatorY(t[1]))),a=(n.z+e.length([n.x-i[0],n.y-i[1],n.z-i[2]*o]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(a),this._centerAltitude=n.toAltitude(),this._center=this.coordinateLocation(n),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const n=this._elevation,i=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,r=this._computeCameraPosition(i),o=n.getAtPointOrZero(new e.MercatorCoordinate(...r)),s=this.pixelsPerMeter/this.worldSize*o,a=this._minimumHeightOverTerrain(),l=r[2]-s;if(l<=a)if(l<0||t){const t=this.locationCoordinate(this._center,this._centerAltitude),n=[r[0],r[1],t.z-r[2]],i=e.length(n);n[2]-=(a-l)/this._pixelsPerMercatorPixel;const o=e.length(n);if(0===o)return;e.scale$2(n,n,i/o*this._pixelsPerMercatorPixel),this._camera.position=[r[0],r[1],t.z*this._pixelsPerMercatorPixel-n[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const n=this.center;return n.lat=e.clamp(n.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(n.lng=e.clamp(n.lng,this.minLng,this.maxLng)),this.center=n,void(this._constraining=!1)}const n=this._unmodified,{x:i,y:r}=this.point;let o=0,s=i,a=r;const l=this.width/2,c=this.height/2,u=this.worldMinY*this.scale,d=this.worldMaxY*this.scale;if(r-c<u&&(a=u+c),r+c>d&&(a=d-c),d-u<this.height&&(o=Math.max(o,this.height/(d-u)),a=(d+u)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const e=this.worldMinX*this.scale,t=this.worldMaxX*this.scale,n=this.worldSize/2-(e+t)/2;s=(i+n+this.worldSize)%this.worldSize-n,s-l<e&&(s=e+l),s+l>t&&(s=t-l),t-e<this.width&&(o=Math.max(o,this.width/(t-e)),s=(t+e)/2)}s===i&&a===r||(this.center=this.unproject(new e.Point(s,a))),o&&(this.zoom+=this.scaleZoom(o)),this._constrainCamera(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,n=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=e.mercatorZfromAltitude(1,this.center.lat)/e.mercatorZfromAltitude(1,e.GLOBE_SCALE_MATCH_LATITUDE));const i=Gi(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,i),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const r="meters"===this.projection.zAxisUnit?n:1,o=this._camera.getWorldToCamera(this.worldSize,r),s=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);s[8]=2*-t.x/this.width,s[9]=2*t.y/this.height;let a=e.mul([],s,o);if(this.projection.isReprojectedInTileSpace){const t=this.locationCoordinate(this.center),n=e.identity([]);e.translate(n,n,[t.x*this.worldSize,t.y*this.worldSize,0]),e.multiply(n,n,Ui(this)),e.translate(n,n,[-t.x*this.worldSize,-t.y*this.worldSize,0]),e.multiply(a,a,n),this.inverseAdjustmentMatrix=function(e){const t=Ui(e,!0);return v([],[t[0],t[1],t[4],t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=e.scale([],a,[this.worldSize,this.worldSize,this.worldSize/r,1]),this.projMatrix=a,this.invProjMatrix=e.invert(new Float64Array(16),this.projMatrix);const l=e.invert([],s);this.frustumCorners=e.FrustumCorners.fromInvProjectionMatrix(l,this.horizonLineFromTop(),this.height);const c=new Float32Array(16);e.identity(c),e.scale(c,c,[1,-1,1]),e.rotateX(c,c,this._pitch),e.rotateZ(c,c,this.angle);const u=e.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),d=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;u[8]=2*-t.x/this.width,u[9]=2*(t.y+d)/this.height,this.skyboxMatrix=e.multiply(c,u,c);const h=this.point,p=h.x,f=h.y,m=this.width%2/2,g=this.height%2/2,y=Math.cos(this.angle),b=Math.sin(this.angle),x=p-Math.round(p)+y*m+b*g,_=f-Math.round(f)+y*g+b*m,w=new Float64Array(a);if(e.translate(w,w,[x>.5?x-1:x,_>.5?_-1:_,0]),this.alignedProjMatrix=w,a=e.create(),e.scale(a,a,[this.width/2,-this.height/2,1]),e.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=e.create(),e.scale(a,a,[1,-1,1]),e.translate(a,a,[-1,-1,0]),e.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},a=e.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=a,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.calculateGlobeMatrix(this);const t=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.transformMat4(t,t,o),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=a;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,n=this.cameraPixelsPerMeter,i=this._camera.position,r=1/this.height/this._pixelsPerMercatorPixel,o=[t,t,n];e.scale$2(o,o,r),e.scale$2(i,i,-1),e.multiply$2(i,i,o);const s=e.create();e.translate(s,s,i),e.scale(s,s,o),this.mercatorFogMatrix=s,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,n,r)}_computeCameraPosition(e){const t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,n=this._camera.forward(),i=this.point,r=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[i.x/this.worldSize-n[0]*r,i.y/this.worldSize-n[1]*r,e/this.worldSize*this._centerAltitude-n[2]*r]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const n=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=this._camera.position[2],r=t[2];let o=1;this.projection.wrap&&(this.center=this.center.wrap()),r>0&&(o=Math.min((n-i)/r,1)),this._camera.position=e.scaleAndAdd([],this._camera.position,t,o),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,n=this._camera.forward(),{pitch:i,bearing:r}=this._camera.getPitchBearing(),o=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.degToRad(this._maxPitch)),a=Math.max((t[2]-o)/Math.cos(i),s),l=this._zoomFromMercatorZ(a);e.scaleAndAdd(t,t,n,a),this._pitch=e.clamp(i,e.degToRad(this.minPitch),e.degToRad(this.maxPitch)),this.angle=e.wrap(r,-Math.PI,Math.PI),this._setZoom(e.clamp(l,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(t){let n=0,i=e.GLOBE_ZOOM_THRESHOLD_MAX,r=0,o=1/0;for(;i-n>1e-6&&i>n;){const e=n+.5*(i-n),s=this.tileSize*Math.pow(2,e),a=this.getCameraToCenterDistance(this.projection,e,s),l=this.scaleZoom(a/(t*this.tileSize)),c=Math.abs(e-l);c<o&&(o=c,r=e),e<l?n=e:i=e}return r}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,n){const i=Math.min(t.x,n.x),r=Math.max(t.x,n.x),o=Math.min(t.y,n.y),s=Math.max(t.y,n.y);if(o<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const a=[new e.Point(i,o),new e.Point(r,s),new e.Point(i,s),new e.Point(r,o)],l=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const e of a){const t=this.pointRayIntersection(e);if(t.t<0)return!0;const n=this.rayIntersectionCoordinate(t);if(n.x<l||n.y<0||n.x>c||n.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+e.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.Point(0,0),new e.Point(this.width,this.height))}zoomDeltaToMovement(t,n){const i=e.length(e.sub([],this._camera.position,t)),r=this._zoomFromMercatorZ(i)+n;return i-this._mercatorZfromZoom(r)}getCameraPoint(){if("globe"===this.projection.name){const t=function([t,n,i],r){const o=[t,n,i,1];e.transformMat4$1(o,o,r);const s=o[3]=Math.max(o[3],1e-6);return o[0]/=s,o[1]/=s,o[2]/=s,o}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.Point(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,t))}}getCameraToCenterDistance(e,t=this.zoom,n=this.worldSize){const i=Gi(e,t,this.width,this.height,1024),r=e.pixelSpaceConversion(this.center.lat,n,i);return.5/Math.tan(.5*this._fov)*this.height*r}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&e.multiply(t,t,this.globeMatrix),t}}function Ki(e,t){let n=!1,i=null;const r=()=>{i=null,n&&(e(),i=setTimeout(r,t),n=!1)};return()=>(n=!0,i||r(),i)}class Ji{constructor(t){this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ki(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),e.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const n=Yi(t);if(this._hashName){const t=this._hashName;let i=!1;const r=e.window.location.hash.slice(1).split("&").map((e=>{const r=e.split("=")[0];return r===t?(i=!0,`${r}=${n}`):e})).filter((e=>e));return i||r.push(`${t}=${n}`),`#${r.join("&")}`}return`#${n}`}_getCurrentHash(){const t=e.window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((e=>e.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const t=this._getCurrentHash();if(t.length>=3&&!t.some((e=>isNaN(e)))){const n=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:n,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());e.window.history.replaceState(e.window.history.state,null,t)}}function Yi(e,t){const n=e.getCenter(),i=Math.round(100*e.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,r),s=Math.round(n.lng*o)/o,a=Math.round(n.lat*o)/o,l=e.getBearing(),c=e.getPitch();let u=t?`/${s}/${a}/${i}`:`${i}/${a}/${s}`;return(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+=`/${Math.round(c)}`),u}const Qi={linearity:.3,easing:e.bezier(0,0,.3,1)},er=e.extend({deceleration:2500,maxSpeed:1400},Qi),tr=e.extend({deceleration:20,maxSpeed:1400},Qi),nr=e.extend({deceleration:1e3,maxSpeed:360},Qi),ir=e.extend({deceleration:1e3,maxSpeed:90},Qi);class rr{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,n=e.exported.now();for(;t.length>0&&n-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion())return;if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)n.zoom+=e.zoomDelta||0,n.bearing+=e.bearingDelta||0,n.pitch+=e.pitchDelta||0,e.panDelta&&n.pan._add(e.panDelta),e.around&&(n.around=e.around),e.pinchAround&&(n.pinchAround=e.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(n.pan.mag()){const o=sr(n.pan.mag(),i,e.extend({},er,t||{}));r.offset=n.pan.mult(o.amount/n.pan.mag()),r.center=this._map.transform.center,or(r,o)}if(n.zoom){const e=sr(n.zoom,i,tr);r.zoom=this._map.transform.zoom+e.amount,or(r,e)}if(n.bearing){const t=sr(n.bearing,i,nr);r.bearing=this._map.transform.bearing+e.clamp(t.amount,-179,179),or(r,t)}if(n.pitch){const e=sr(n.pitch,i,ir);r.pitch=this._map.transform.pitch+e.amount,or(r,e)}if(r.zoom||r.bearing){const e=void 0===n.pinchAround?n.around:n.pinchAround;r.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),r.noMoveStart=!0,r}}function or(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function sr(t,n,i){const{maxSpeed:r,linearity:o,deceleration:s}=i,a=e.clamp(t*o/(n/1e3),-r,r),l=Math.abs(a)/(s*o);return{easing:i.easing,duration:1e3*l,amount:a*(l/2)}}class ar extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,i,r={}){const o=f(n.getCanvasContainer(),i),s=n.unproject(o);super(t,e.extend({point:o,lngLat:s,originalEvent:i},r)),this._defaultPrevented=!1,this.target=n}}class lr extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,i){const r="touchend"===t?i.changedTouches:i.touches,o=m(n.getCanvasContainer(),r),s=o.map((e=>n.unproject(e))),a=o.reduce(((e,t,n,i)=>e.add(t.div(i.length))),new e.Point(0,0));super(t,{points:o,point:a,lngLats:s,lngLat:n.unproject(a),originalEvent:i}),this._defaultPrevented=!1}}class cr extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,n){super(e,{originalEvent:n}),this._defaultPrevented=!1}}class ur{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new cr(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new ar(e.type,this._map,e))}mouseup(e){this._map.fire(new ar(e.type,this._map,e))}preclick(t){const n=e.extend({},t);n.type="preclick",this._map.fire(new ar(n.type,this._map,n))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new ar(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new ar(e.type,this._map,e))}mouseover(e){this._map.fire(new ar(e.type,this._map,e))}mouseout(e){this._map.fire(new ar(e.type,this._map,e))}touchstart(e){return this._firePreventable(new lr(e.type,this._map,e))}touchmove(e){this._map.fire(new lr(e.type,this._map,e))}touchend(e){this._map.fire(new lr(e.type,this._map,e))}touchcancel(e){this._map.fire(new lr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dr{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new ar(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ar("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new ar(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class hr{constructor(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(u(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const n=t,i=this._startPos,r=this._lastPos;if(!i||!r||r.equals(n)||!this._box&&n.dist(i)<this._clickTolerance)return;this._lastPos=n,this._box||(this._box=o("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const s=Math.min(i.x,n.x),a=Math.max(i.x,n.x),l=Math.min(i.y,n.y),c=Math.max(i.y,n.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${s}px,${l}px)`,this._box.style.width=a-s+"px",this._box.style.height=c-l+"px")}))}mouseupWindow(t,n){if(!this._active)return;const i=this._startPos,r=n;if(i&&0===t.button){if(this.reset(),p(),i.x!==r.x||i.y!==r.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(i,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),d(),delete this._startPos,delete this._lastPos}_fireEvent(t,n){return this._map.fire(new e.Event(t,{originalEvent:n}))}}function pr(e,t){const n={};for(let i=0;i<e.length;i++)n[e[i].identifier]=t[i];return n}class fr{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){const n=new e.Point(0,0);for(const e of t)n._add(e);return n.div(t.length)}(n),this.touches=pr(i,n)))}touchmove(e,t,n){if(this.aborted||!this.centroid)return;const i=pr(n,t);for(const r in this.touches){const e=i[r];(!e||e.dist(this.touches[r])>30)&&(this.aborted=!0)}}touchend(e,t,n){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class mr{constructor(e){this.singleTap=new fr(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,t,n){this.singleTap.touchstart(e,t,n)}touchmove(e,t,n){this.singleTap.touchmove(e,t,n)}touchend(e,t,n){const i=this.singleTap.touchend(e,t,n);if(i){const t=e.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(i)<30;if(t&&n||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class gr{constructor(){this._zoomIn=new mr({numTouches:1,numTaps:2}),this._zoomOut=new mr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,n){this._zoomIn.touchstart(e,t,n),this._zoomOut.touchstart(e,t,n)}touchmove(e,t,n){this._zoomIn.touchmove(e,t,n),this._zoomOut.touchmove(e,t,n)}touchend(e,t,n){const i=this._zoomIn.touchend(e,t,n),r=this._zoomOut.touchend(e,t,n);return i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(i)},{originalEvent:e})}):r?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(r)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const yr={0:1,2:2};class vr{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,t){return!1}_move(e,t){return{}}mousedown(e,t){if(this._lastPoint)return;const n=g(e);this._correctButton(e,n)&&(this._lastPoint=t,this._eventButton=n)}mousemoveWindow(e,t){const n=this._lastPoint;if(n)if(e.preventDefault(),null!=this._eventButton&&function(e,t){const n=yr[t];return void 0===e.buttons||(e.buttons&n)!==n}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(n)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(n,t)}mouseupWindow(e){this._lastPoint&&g(e)===this._eventButton&&(this._moved&&p(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class br extends vr{mousedown(e,t){super.mousedown(e,t),this._lastPoint&&(this._active=!0)}_correctButton(e,t){return 0===t&&!e.ctrlKey}_move(e,t){return{around:t,panDelta:t.sub(e)}}}class xr extends vr{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const n=.8*(t.x-e.x);if(n)return this._active=!0,{bearingDelta:n}}contextmenu(e){e.preventDefault()}}class _r extends vr{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const n=-.5*(t.y-e.y);if(n)return this._active=!0,{pitchDelta:n}}contextmenu(e){e.preventDefault()}}class wr{constructor(t,n){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset(),e.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)}touchstart(e,t,n){return this._calculateTransform(e,t,n)}touchmove(t,n,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===i.length&&!e.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,n,i)}}touchend(e,t,n){this._calculateTransform(e,t,n),this._active&&n.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,n,i){i.length>0&&(this._active=!0);const r=pr(i,n),o=new e.Point(0,0),s=new e.Point(0,0);let a=0;for(const e in r){const t=r[e],n=this._touches[e];n&&(o._add(t),s._add(t.sub(n)),a++,r[e]=t)}if(this._touches=r,a<this._minTouches||!s.mag())return;const l=s.div(a);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(a),panDelta:l}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=o("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class kr{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,t,n){return{}}touchstart(e,t,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,n){const i=this._firstTwoTouches;if(!i)return;e.preventDefault();const[r,o]=i,s=Er(n,t,r),a=Er(n,t,o);if(!s||!a)return;const l=this._aroundCenter?null:s.add(a).div(2);return this._move([s,a],l,e)}touchend(e,t,n){if(!this._firstTwoTouches)return;const[i,r]=this._firstTwoTouches,o=Er(n,t,i),s=Er(n,t,r);o&&s||(this._active&&p(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Er(e,t,n){for(let i=0;i<e.length;i++)if(e[i].identifier===n)return t[i]}function Sr(e,t){return Math.log(e/t)/Math.LN2}class Tr extends kr{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const n=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Sr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sr(this._distance,n),pinchAround:t}}}function Cr(e,t){return 180*e.angleWith(t)/Math.PI}class Mr extends kr{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const n=this._vector;if(this._vector=e[0].sub(e[1]),n&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Cr(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,n=this._startVector;if(!n)return!1;const i=Cr(e,n);return Math.abs(i)<t}}function Ir(e){return Math.abs(e.y)>Math.abs(e.x)}class Ar extends kr{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,Ir(e[0].sub(e[1]))&&(this._valid=!1)}_move(t,n,i){const r=this._lastPoints;if(!r)return;const o=t[0].sub(r[0]),s=t[1].sub(r[1]);return this._map._cooperativeGestures&&!e.isFullscreen()&&i.touches.length<3||(this._valid=this.gestureBeginsVertically(o,s,i.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(o.y+s.y)/2*-.5})}gestureBeginsVertically(e,t,n){if(void 0!==this._valid)return this._valid;const i=e.mag()>=2,r=t.mag()>=2;if(!i&&!r)return;if(!i||!r)return null==this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const o=e.y>0==t.y>0;return Ir(e)&&Ir(t)&&o}}const Pr={panStep:100,bearingStep:15,pitchStep:10};class Or{constructor(){const e=Pr;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,n=0,i=0,r=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),r=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),r=1);break;case 38:e.shiftKey?i=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?i=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:s=>{const a=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:Dr,zoom:t?Math.round(a)+t*(e.shiftKey?2:1):a,bearing:s.getBearing()+n*this._bearingStep,pitch:s.getPitch()+i*this._pitchStep,offset:[-r*this._panStep,-o*this._panStep],center:s.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Dr(e){return e*(2-e)}const Rr=4.000244140625;class zr{constructor(t,n){this._map=t,this._el=t.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||e.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let n=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const i=e.exported.now(),r=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,0!==n&&n%Rr==0?this._type="wheel":0!==n&&Math.abs(n)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(r*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),t.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=t,this._delta-=n,this._active||this._start(t)),t.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const t=f(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const n=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Rr?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==i&&(i=1/i);const r=n(),o=Math.pow(2,r),s="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(s*i))),"wheel"===this._type&&(this._startZoom=r,this._easing=this._smoothOutEasing(200)),this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:n(),r=this._startZoom,o=this._easing;let s,a=!1;if("wheel"===this._type&&r&&o){const t=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),n=o(t);s=e.number(r,i,n),t<1?this._frameId||(this._frameId=!0):a=!0}else s=i,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:s-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let n=e.ease;if(this._prevEase){const t=this._prevEase,i=(e.exported.now()-t.start)/t.duration,r=t.easing(i+.01)-t.easing(i),o=.27/Math.sqrt(r*r+1e-4)*.01,s=Math.sqrt(.0729-o*o);n=e.bezier(o,s,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:n},n}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=o("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(e.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class Lr{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Br{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,t){return e.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:n.getZoom()+(e.shiftKey?-1:1),around:n.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nr{constructor(){this._tap=new mr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,t,n){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?n.length>0&&(this._swipePoint=t[0],this._swipeTouch=n[0].identifier):this._tap.touchstart(e,t,n))}touchmove(e,t,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=t[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,e.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(e,t,n)}touchend(e,t,n){this._tapTime?this._swipePoint&&0===n.length&&this.reset():this._tap.touchend(e,t,n)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fr{constructor(e,t,n){this._el=e,this._mousePan=t,this._touchPan=n}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class $r{constructor(e,t,n){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class jr{constructor(e,t,n,i){this._el=e,this._touchZoom=t,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Vr=e=>e.zoom||e.drag||e.pitch||e.rotate;class Ur extends e.Event{}class qr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,n){const i=e.sub([],n,t);this.radius=e.length(i[2]<0?e.div([],i,this.constants):[i[0],i[1],0])}projectRay(t){e.div(t,t,this.constants),e.normalize(t,t),e.mul$1(t,t,this.constants);const n=e.scale$2([],t,this.radius);if(n[2]>0){const t=e.scale$2([],[0,0,1],e.dot(n,[0,0,1])),i=e.scale$2([],e.normalize([],[n[0],n[1],0]),this.radius),r=e.add([],n,e.scale$2([],e.sub([],e.add([],i,t),n),2));n[0]=r[0],n[1]=r[1]}return n}}function Gr(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class Wr{constructor(t,n){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new rr(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new qr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),e.bindAll(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[e.window,"blur",void 0]];for(const[r,o,s]of this._listeners)r.addEventListener(o,r===e.window.document?this.handleWindowEvent:this.handleEvent,s)}destroy(){for(const[t,n,i]of this._listeners)t.removeEventListener(n,t===e.window.document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(e){const t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new ur(t,e));const i=t.boxZoom=new hr(t,e);this._add("boxZoom",i);const r=new gr,o=new Br;t.doubleClickZoom=new Lr(o,r),this._add("tapZoom",r),this._add("clickZoom",o);const s=new Nr;this._add("tapDragZoom",s);const a=t.touchPitch=new Ar(t);this._add("touchPitch",a);const l=new xr(e),c=new _r(e);t.dragRotate=new $r(e,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const u=new br(e),d=new wr(t,e);t.dragPan=new Fr(n,u,d),this._add("mousePan",u),this._add("touchPan",d,["touchZoom","touchRotate"]);const h=new Mr,p=new Tr;t.touchZoomRotate=new jr(n,p,h,s),this._add("touchRotate",h,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]),this._add("blockableMapEvent",new dr(t));const f=t.scrollZoom=new zr(t,this);this._add("scrollZoom",f,["mousePan"]);const m=t.keyboard=new Or;this._add("keyboard",m);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[g]&&t[g].enable(e[g])}_add(e,t,n){this._handlers.push({handlerName:e,handler:t,allowed:n}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Vr(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,t,n){for(const i in e)if(i!==n&&(!t||t.indexOf(i)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,`${e.type}Window`)}_getMapTouches(e){const t=[];for(const n of e)this._el.contains(n.target)&&t.push(n);return t}handleEvent(e,t){this._updatingCamera=!0;const n="renderFrame"===e.type,i=n?void 0:e,r={needsRenderFrame:!1},o={},s={},a=e.touches?this._getMapTouches(e.touches):void 0,l=a?m(this._el,a):n?void 0:f(this._el,e);for(const{handlerName:d,handler:h,allowed:p}of this._handlers){if(!h.isEnabled())continue;let n;this._blockedByActive(s,p,d)?h.reset():h[t||e.type]&&(n=h[t||e.type](e,l,a),this.mergeHandlerResult(r,o,n,d,i),n&&n.needsRenderFrame&&this._triggerRenderFrame()),(n||h.isActive())&&(s[d]=h)}const c={};for(const d in this._previousActiveHandlers)s[d]||(c[d]=i);this._previousActiveHandlers=s,(Object.keys(c).length||Gr(r))&&(this._changes.push([r,o,c]),this._triggerRenderFrame()),(Object.keys(s).length||Gr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=r;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))}mergeHandlerResult(t,n,i,r,o){if(!i)return;e.extend(t,i);const s={handlerName:r,originalEvent:i.originalEvent||o};void 0!==i.zoomDelta&&(n.zoom=s),void 0!==i.panDelta&&(n.drag=s),void 0!==i.pitchDelta&&(n.pitch=s),void 0!==i.bearingDelta&&(n.rotate=s)}_applyChanges(){const t={},n={},i={};for(const[r,o,s]of this._changes)r.panDelta&&(t.panDelta=(t.panDelta||new e.Point(0,0))._add(r.panDelta)),r.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(t.around=r.around),void 0!==r.aroundCoord&&(t.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(t.pinchAround=r.pinchAround),r.noInertia&&(t.noInertia=r.noInertia),e.extend(n,o),e.extend(i,s);this._updateMapTransform(t,n,i),this._changes=[]}_updateMapTransform(t,n,i){const r=this._map,o=r.transform,s=e=>[e.x,e.y,e.z];if((e=>{const t=this._eventsInProgress.drag;return t&&!this._handlersById[t.handlerName].isActive()})()&&!Gr(t)){const e=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",e!==o.zoom&&this._map._update(!0)}if(o._isCameraConstrained&&r._stop(!0),!Gr(t))return void this._fireEvents(n,i,!0);let{panDelta:a,zoomDelta:l,bearingDelta:c,pitchDelta:u,around:d,aroundCoord:h,pinchAround:p}=t;o._isCameraConstrained&&(l>0&&(l=0),o._isCameraConstrained=!1),void 0!==p&&(d=p),(l||(e=>n[e]&&!this._eventsInProgress[e])("drag"))&&d&&(this._dragOrigin=s(o.pointCoordinate3D(d)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",r._stop(!0),d=d||r.transform.centerPoint,c&&(o.bearing+=c),u&&(o.pitch+=u),o._updateCameraState();const f=[0,0,0];if(a)if("mercator"===o.projection.name){const e=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(d).dir),t=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(d.sub(a)).dir);f[0]=t[0]-e[0],f[1]=t[1]-e[1]}else{const t=o.pointCoordinate(d);if("globe"===o.projection.name){a=a.rotate(-o.angle);const n=o._pixelsPerMercatorPixel/o.worldSize;f[0]=-a.x*e.mercatorScale(e.latFromMercatorY(t.y))*n,f[1]=-a.y*e.mercatorScale(o.center.lat)*n}else{const e=o.pointCoordinate(d.sub(a));t&&e&&(f[0]=e.x-t.x,f[1]=e.y-t.y)}}const m=o.zoom,g=[0,0,0];if(l){const t=s(h||o.pointCoordinate3D(d)),n={dir:e.normalize([],e.sub([],t,o._camera.position))};if(n.dir[2]<0){const i=o.zoomDeltaToMovement(t,l);e.scale$2(g,n.dir,i)}}const y=e.add(f,f,g);o._translateCameraConstrained(y),l&&Math.abs(o.zoom-m)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(n,i,!0)}_fireEvents(t,n,i){const r=Vr(this._eventsInProgress),o=Vr(t),s={};for(const e in t){const{originalEvent:n}=t[e];this._eventsInProgress[e]||(s[`${e}start`]=n),this._eventsInProgress[e]=t[e]}!r&&o&&this._fireEvent("movestart",o.originalEvent);for(const e in s)this._fireEvent(e,s[e]);o&&this._fireEvent("move",o.originalEvent);for(const e in t){const{originalEvent:n}=t[e];this._fireEvent(e,n)}const a={};let l;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:i}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],l=n[t]||i,a[`${e}end`]=l)}for(const e in a)this._fireEvent(e,a[e]);const c=Vr(this._eventsInProgress);if(i&&(r||o)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;t?(n(t.bearing||this._map.getBearing())&&(t.bearing=0),this._map.easeTo(t,{originalEvent:l})):(this._map.fire(new e.Event("moveend",{originalEvent:l})),n(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,n){this._map.fire(new e.Event(t,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{this._frameId=void 0,this.handleEvent(new Ur("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Hr="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Zr extends e.Evented{constructor(t,n){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=n.bearingSnap,this._respectPrefersReducedMotion=!1!==n.respectPrefersReducedMotion,e.bindAll(["_renderFrameCallback"],this)}getCenter(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,n,i){return t=e.Point.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},n),i)}panTo(t,n,i){return this.easeTo(e.extend({center:t},n),i)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,n,i){return this.easeTo(e.extend({zoom:t},n),i)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,n,i){return this.easeTo(e.extend({bearing:t},n),i)}resetNorth(t,n){return this.rotateTo(0,e.extend({duration:1e3},t),n),this}resetNorthPitch(t,n){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),n),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(t,n){t=e.LngLatBounds.convert(t);const i=n&&n.bearing||0,r=n&&n.pitch||0,o=t.getNorthWest(),s=t.getSouthEast();return this._cameraForBounds(this.transform,o,s,i,r,n)}_extendCameraOptions(t){const n={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=e.extend({padding:n,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const e=t.padding;t.padding={top:e,bottom:e,right:e,left:e}}return t.padding=e.extend(n,t.padding),t}_minimumAABBFrustumDistance(e,t){const n=t.max[0]-t.min[0],i=t.max[1]-t.min[1];return n/i>e.aspect?n/(2*Math.tan(.5*e.fovX)*e.aspect):i/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(t,n,i,r,o,s){const a=t.clone(),l=this._extendCameraOptions(s);a.bearing=r,a.pitch=o;const c=e.LngLat.convert(n),u=e.LngLat.convert(i),d=.5*(c.lat+u.lat),h=.5*(c.lng+u.lng),p=e.latLngToECEF(d,h),f=e.normalize([],p),m=e.normalize([],e.cross([],f,[0,1,0])),g=e.cross([],m,f),y=[m[0],m[1],m[2],0,g[0],g[1],g[2],0,f[0],f[1],f[2],0,0,0,0,1],v=[p,e.latLngToECEF(c.lat,c.lng),e.latLngToECEF(u.lat,c.lng),e.latLngToECEF(u.lat,u.lng),e.latLngToECEF(c.lat,u.lng),e.latLngToECEF(d,c.lng),e.latLngToECEF(d,u.lng),e.latLngToECEF(c.lat,h),e.latLngToECEF(u.lat,h)];let b=e.Aabb.fromPoints(v.map((t=>[e.dot(m,t),e.dot(g,t),e.dot(f,t)])));const x=e.transformMat4([],b.center,y);0===e.squaredLength(x)&&e.set(x,0,0,1),e.normalize(x,x),e.scale$2(x,x,e.GLOBE_RADIUS),a.center=e.ecefToLatLng(x);const _=a.getWorldToCameraMatrix(),w=e.invert(new Float64Array(16),_);b=e.Aabb.applyTransform(b,e.multiply([],_,y)),e.transformMat4(x,x,_);const k=.5*(b.max[2]-b.min[2]),E=this._minimumAABBFrustumDistance(a,b),S=e.scale$2([],[0,0,1],k),T=e.add(S,x,S),C=E+(0===a.pitch?0:e.distance(x,T)),M=a.globeCenterInViewSpace,I=e.sub([],x,[M[0],M[1],M[2]]);e.normalize(I,I),e.scale$2(I,I,C);const A=e.add([],x,I);e.transformMat4(A,A,w);const P=e.earthRadius/e.GLOBE_RADIUS,O=e.length(A),D=e.mercatorZfromAltitude(Math.max(O*P-e.earthRadius,Number.EPSILON),0),R=Math.min(a.zoomFromMercatorZAdjusted(D),l.maxZoom);return R>.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"mercator"}),a.zoom=R,this._cameraForBounds(a,n,i,r,o,s)):{center:a.center,zoom:R,bearing:r,pitch:o}}queryTerrainElevation(t,n){const i=this.transform.elevation;return i?(n=e.extend({},{exaggerated:!0},n),i.getAtPoint(e.MercatorCoordinate.fromLngLat(t),null,n.exaggerated)):null}_cameraForBounds(t,n,i,r,o,s){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,n,i,r,o,s);const a=t.clone(),l=this._extendCameraOptions(s),c=a.padding;a.bearing=r,a.pitch=o;const u=e.LngLat.convert(n),d=e.LngLat.convert(i),h=new e.LngLat(u.lng,d.lat),p=new e.LngLat(d.lng,u.lat),f=a.project(u),m=a.project(d),g=this.queryTerrainElevation(u),y=this.queryTerrainElevation(d),v=this.queryTerrainElevation(h),b=this.queryTerrainElevation(p),x=[[f.x,f.y,Math.min(g||0,y||0,v||0,b||0)],[m.x,m.y,Math.max(g||0,y||0,v||0,b||0)]];let _=e.Aabb.fromPoints(x);const w=a.getWorldToCameraMatrix(),k=e.invert(new Float64Array(16),w);_=e.Aabb.applyTransform(_,w);const E=e.sub([],_.max,_.min),S=c.left||0,T=c.right||0,C=c.bottom||0,M=c.top||0,{left:I,right:A,top:P,bottom:O}=l.padding,D=.5*(S+T),R=.5*(M+C),z=Math.min(a.scaleZoom(a.scale*Math.min((a.width-(S+T+I+A))/E[0],(a.height-(C+M+O+P))/E[1])),l.maxZoom),L=a.scale/a.zoomScale(z);_=new e.Aabb([_.min[0]-(I+D)*L,_.min[1]-(O+R)*L,_.min[2]],[_.max[0]+(A+D)*L,_.max[1]+(P+R)*L,_.max[2]]);const B=.5*E[2],N=this._minimumAABBFrustumDistance(a,_),F=[0,0,1,0];e.transformMat4$1(F,F,w),e.normalize$2(F,F);const $=e.scale$2([],F,N+B),j=e.add([],_.center,$),V=("number"==typeof l.offset.x&&"number"==typeof l.offset.y?new e.Point(l.offset.x,l.offset.y):e.Point.convert(l.offset)).rotate(-e.degToRad(r));_.center[0]-=V.x*L,_.center[1]+=V.y*L,e.transformMat4(_.center,_.center,k),e.transformMat4(j,j,k);const U=[_.center[0],_.center[1],j[2]*a.pixelsPerMeter];e.scale$2(U,U,1/a.worldSize);const q=e.lngFromMercatorX(U[0]),G=e.latFromMercatorY(U[1]),W=Math.min(a._zoomFromMercatorZ(U[2]),l.maxZoom),H=new e.LngLat(q,G);return a.mercatorFromTransition&&W<.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(a.setProjection({name:"globe"}),a.zoom=W,this._cameraForBounds(a,n,i,r,o,s)):{center:H,zoom:W,bearing:r,pitch:o}}fitBounds(e,t,n){const i=this.cameraForBounds(e,t);return this._fitInternal(i,t,n)}fitScreenCoordinates(t,n,i,r,o){const s=e.Point.convert(t),a=e.Point.convert(n),l=new e.Point(Math.min(s.x,a.x),Math.min(s.y,a.y)),c=new e.Point(Math.max(s.x,a.x),Math.max(s.y,a.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(s,a))return this;const u=this.transform.pointLocation3D(l),d=this.transform.pointLocation3D(c),h=this.transform.pointLocation3D(new e.Point(l.x,c.y)),p=this.transform.pointLocation3D(new e.Point(c.x,l.y)),f=[Math.min(u.lng,d.lng,h.lng,p.lng),Math.min(u.lat,d.lat,h.lat,p.lat)],m=[Math.max(u.lng,d.lng,h.lng,p.lng),Math.max(u.lat,d.lat,h.lat,p.lat)],g=r&&r.pitch?r.pitch:this.getPitch(),y=this._cameraForBounds(this.transform,f,m,i,g,r);return this._fitInternal(y,r,o)}_fitInternal(t,n,i){return t?(delete(n=e.extend(t,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}jumpTo(t,n){this.stop();const i=t.preloadOnly?this.transform.clone():this.transform;let r=!1,o=!1,s=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(r=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=e.LngLat.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(o=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(s=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),t.preloadOnly?(this._preloadTiles(i),this):(this.fire(new e.Event("movestart",n)).fire(new e.Event("move",n)),r&&this.fire(new e.Event("zoomstart",n)).fire(new e.Event("zoom",n)).fire(new e.Event("zoomend",n)),o&&this.fire(new e.Event("rotatestart",n)).fire(new e.Event("rotate",n)).fire(new e.Event("rotateend",n)),s&&this.fire(new e.Event("pitchstart",n)).fire(new e.Event("pitch",n)).fire(new e.Event("pitchend",n)),this.fire(new e.Event("moveend",n)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||e.warnOnce(Hr),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,n){const i=this.transform;if(!i.projection.supportsFreeCamera)return e.warnOnce(Hr),this;this.stop();const r=i.zoom,o=i.pitch,s=i.bearing;i.setFreeCameraOptions(t);const a=r!==i.zoom,l=o!==i.pitch,c=s!==i.bearing;return this.fire(new e.Event("movestart",n)).fire(new e.Event("move",n)),a&&this.fire(new e.Event("zoomstart",n)).fire(new e.Event("zoom",n)).fire(new e.Event("zoomend",n)),c&&this.fire(new e.Event("rotatestart",n)).fire(new e.Event("rotate",n)).fire(new e.Event("rotateend",n)),l&&this.fire(new e.Event("pitchstart",n)).fire(new e.Event("pitch",n)).fire(new e.Event("pitchend",n)),this.fire(new e.Event("moveend",n)),this}easeTo(t,n){this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);const i=this.transform,r=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in t?+t.zoom:r,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,u="pitch"in t?+t.pitch:s,d="padding"in t?t.padding:i.padding,h=e.Point.convert(t.offset);let p,f,m;if("globe"===i.projection.name){const n=e.MercatorCoordinate.fromLngLat(i.center),r=h.rotate(-i.angle);n.x+=r.x/i.worldSize,n.y+=r.y/i.worldSize;const o=n.toLngLat(),s=e.LngLat.convert(t.center||o);this._normalizeCenter(s),p=i.centerPoint.add(r),f=new e.Point(n.x,n.y).mult(i.worldSize),m=new e.Point(e.mercatorXfromLng(s.lng),e.mercatorYfromLat(s.lat)).mult(i.worldSize).sub(f)}else{p=i.centerPoint.add(h);const n=i.pointLocation(p),r=e.LngLat.convert(t.center||n);this._normalizeCenter(r),f=i.project(n),m=i.project(r).sub(f)}const g=i.zoomScale(l-r);let y,v;t.around&&(y=e.LngLat.convert(t.around),v=i.locationPoint(y));const b=this._zooming||l!==r,x=this._rotating||o!==c,_=this._pitching||u!==s,w=!i.isPaddingEqual(d),k=i=>k=>{if(b&&(i.zoom=e.number(r,l,k)),x&&(i.bearing=e.number(o,c,k)),_&&(i.pitch=e.number(s,u,k)),w&&(i.interpolatePadding(a,d,k),p=i.centerPoint.add(h)),y)i.setLocationAtPoint(y,v);else{const e=i.zoomScale(i.zoom-r),t=l>r?Math.min(2,g):Math.max(.5,g),n=Math.pow(t,1-k),o=i.unproject(f.add(m.mult(k*n)).mult(e));i.setLocationAtPoint(i.renderWorldCopies?o.wrap():o,p)}return t.preloadOnly||this._fireMoveEvents(n),i};if(t.preloadOnly){const e=this._emulate(k,t.duration,i);return this._preloadTiles(e),this}const E={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=b,this._rotating=x,this._pitching=_,this._padding=w,this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,E),this._ease(k(i),(e=>{i.recenterOnTerrain(),this._afterEase(n,e)}),t),this}_prepareEase(t,n,i={}){this._moving=!0,this.transform.cameraElevationReference="sea",n||i.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!i.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new e.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}_afterEase(t,n){if(this._easeId&&n&&this._easeId===n)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const i=this._zooming,r=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new e.Event("zoomend",t)),r&&this.fire(new e.Event("rotateend",t)),o&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}flyTo(t,n){if(this._prefersReducedMotion(t)){const i=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);const i=this.transform,r=this.getZoom(),o=this.getBearing(),s=this.getPitch(),a=this.getPadding(),l="zoom"in t?e.clamp(+t.zoom,i.minZoom,i.maxZoom):r,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,u="pitch"in t?+t.pitch:s,d="padding"in t?t.padding:i.padding,h=i.zoomScale(l-r),p=e.Point.convert(t.offset);let f=i.centerPoint.add(p);const m=i.pointLocation(f),g=e.LngLat.convert(t.center||m);this._normalizeCenter(g);const y=i.project(m),v=i.project(g).sub(y);let b=t.curve;const x=Math.max(i.width,i.height),_=x/h,w=v.mag();if("minZoom"in t){const n=e.clamp(Math.min(t.minZoom,r,l),i.minZoom,i.maxZoom),o=x/i.zoomScale(n-r);b=Math.sqrt(o/w*2)}const k=b*b;function E(e){const t=(_*_-x*x+(e?-1:1)*k*k*w*w)/(2*(e?_:x)*k*w);return Math.log(Math.sqrt(t*t+1)-t)}function S(e){return(Math.exp(e)-Math.exp(-e))/2}function T(e){return(Math.exp(e)+Math.exp(-e))/2}const C=E(0);let M=function(e){return T(C)/T(C+b*e)},I=function(e){return x*((T(C)*(S(t=C+b*e)/T(t))-S(C))/k)/w;var t},A=(E(1)-C)/b;if(Math.abs(w)<1e-6||!isFinite(A)){if(Math.abs(x-_)<1e-6)return this.easeTo(t,n);const e=_<x?-1:1;A=Math.abs(Math.log(_/x))/b,I=function(){return 0},M=function(t){return Math.exp(e*b*t)}}t.duration="duration"in t?+t.duration:1e3*A/("screenSpeed"in t?+t.screenSpeed/b:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const P=o!==c,O=u!==s,D=!i.isPaddingEqual(d),R=i=>h=>{const m=h*A,b=1/M(m);i.zoom=1===h?l:r+i.scaleZoom(b),P&&(i.bearing=e.number(o,c,h)),O&&(i.pitch=e.number(s,u,h)),D&&(i.interpolatePadding(a,d,h),f=i.centerPoint.add(p));const x=1===h?g:i.unproject(y.add(v.mult(I(m))).mult(b));return i.setLocationAtPoint(i.renderWorldCopies?x.wrap():x,f),i._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(n),i};if(t.preloadOnly){const e=this._emulate(R,t.duration,i);return this._preloadTiles(e),this}return this._zooming=!0,this._rotating=P,this._pitching=O,this._padding=D,this._prepareEase(n,!1),this._ease(R(i),(()=>this._afterEase(n)),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const e=this._onEaseEnd;this._onEaseEnd=void 0,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,n,i){!1===i.animate||0===i.duration?(t(1),n()):(this._easeStart=e.exported.now(),this._easeOptions=i,this._onEaseFrame=t,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1),n=this._onEaseFrame;n&&n(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,n){t=e.wrap(t,-180,180);const i=Math.abs(t-n);return Math.abs(t-360-n)<i&&(t-=360),Math.abs(t+360-n)<i&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(!t.renderWorldCopies||t.maxBounds)return;const n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&e.exported.prefersReducedMotion&&!(t&&t.essential)}_emulate(e,t,n){const i=Math.ceil(15*t/1e3),r=[],o=e(n.clone());for(let s=0;s<=i;s++){const e=o(s/i);r.push(e.clone())}return r}}class Xr{constructor(t={}){this.options=t,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const t=this.options&&this.options.compact;return this._map=e,this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=o("button","mapboxgl-ctrl-attrib-button",this._container),o("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const n=this._map._getUIString(`AttributionControl.${t}`);e.setAttribute("aria-label",n),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",n)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const n=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){const i=n.reduce(((e,t,i)=>(t.value&&(e+=`${t.key}=${t.value}${i<n.length-1?"&":""}`),e)),"?");t.href=`${e.config.FEEDBACK_URL}/${i}#${Yi(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style._sourceCaches;for(const i in t){const n=t[i];if(n.used){const t=n.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,n)=>{for(let i=n+1;i<e.length;i++)if(e[i].indexOf(t)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const n=e.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,e.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Kr{constructor(){e.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=o("div","mapboxgl-ctrl");const t=o("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(const t in e){const n=e[t].getSource();if(n.hasOwnProperty("mapbox_logo")&&!n.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}class Jr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,n=t?this._queue.concat(t):this._queue;for(const i of n)if(i.id===e)return void(i.cancelled=!0)}run(e=0){const t=this._currentlyRunning=this._queue;this._queue=[];for(const n of t)if(!n.cancelled&&(n.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Yr(t,n,i){if(t=new e.LngLat(t.lng,t.lat),n){const r=new e.LngLat(t.lng-360,t.lat),o=new e.LngLat(t.lng+360,t.lat),s=360*Math.ceil(Math.abs(t.lng-i.center.lng)/360),a=i.locationPoint(t).distSqr(n),l=n.x<0||n.y<0||n.x>i.width||n.y>i.height;i.locationPoint(r).distSqr(n)<a&&(l||Math.abs(r.lng-i.center.lng)<s)?t=r:i.locationPoint(o).distSqr(n)<a&&(l||Math.abs(o.lng-i.center.lng)<s)&&(t=o)}for(;Math.abs(t.lng-i.center.lng)>180;){const e=i.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=i.width&&e.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t}const Qr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class eo extends e.Evented{constructor(t,n){if(super(),(t instanceof e.window.HTMLElement||n)&&(t=e.extend({element:t},n)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=e.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=o("div");const n=41,i=27,r=s("svg",{display:"block",height:n*this._scale+"px",width:i*this._scale+"px",viewBox:`0 0 ${i} ${n}`},this._element),a=s("radialGradient",{id:"shadowGradient"},s("defs",{},r));s("stop",{offset:"10%","stop-opacity":.4},a),s("stop",{offset:"100%","stop-opacity":.05},a),s("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},r),s("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},r),s("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},r),s("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},r),this._offset=e.Point.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()}));const i=this._element.classList;for(const e in Qr)i.remove(`mapboxgl-marker-anchor-${e}`);i.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,n=13.5,i=Math.sqrt(Math.pow(n,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[i,-1*(t-n+i)],"bottom-right":[-i,-1*(t-n+i)],left:[n,-1*(t-n)],right:[-n,-1*(t-n)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const t=e.code,n=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==n&&13!==n||this.togglePopup()}_onMapClick(e){const t=e.originalEvent.target,n=this._element;this._popup&&(t===n||n.contains(t))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,t=this._pos;if(!e||!t)return!1;const n=e.unproject(t),i=e.getFreeCameraOptions();if(!i.position)return!1;const r=i.position.toLngLat();return r.distanceTo(n)<.9*r.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const n=this._pos;if(!n||n.x<0||n.x>t.transform.width||n.y<0||n.y>t.transform.height)return void this._clearFadeTimer();const i=t.unproject(n);let r;t._showingGlobe()&&e.isLngLatBehindGlobe(t.transform,this._lngLat)?r=0:(r=1-t._queryFogOpacity(i),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(r*=this._occludedOpacity)),this._element.style.opacity=`${r}`,this._element.style.pointerEvents=r>0?"auto":"none",this._popup&&this._popup._setOpacity(r),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const t=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${e.x}px,${e.y}px)\n            ${Qr[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${t.x}px,${t.y}px)\n        `}_calculateXYTransform(){const t=this._pos,n=this._map,i=this.getPitchAlignment();if(!n||!t||"map"!==i)return"";if(!n._showingGlobe()){const e=n.getPitch();return e?`rotateX(${e}deg)`:""}const r=e.radToDeg(e.globeTiltAtLngLat(n.transform,this._lngLat)),o=t.sub(e.globeCenterToScreenPoint(n.transform)),s=Math.abs(o.x)+Math.abs(o.y);if(0===s)return"";const a=r/s;return`rotateX(${-o.y*a}deg) rotateY(${o.x*a}deg)`}_calculateZTransform(){const t=this._pos,n=this._map;if(!n||!t)return"";let i=0;const r=this.getRotationAlignment();if("map"===r)if(n._showingGlobe()){const t=n.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),r=n.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(t);i=e.radToDeg(Math.atan2(r.y,r.x))-90}else i=-n.getBearing();else if("horizon"===r){const r=e.smoothstep(4,6,n.getZoom()),o=e.globeCenterToScreenPoint(n.transform);o.y+=r*n.transform.height;const s=t.sub(o),a=e.radToDeg(Math.atan2(s.y,s.x));i=(a>90?a-270:a+90)*(1-r)}return i+=this._rotation,i?`rotateZ(${i}deg)`:""}_update(t){e.window.cancelAnimationFrame(this._updateFrameId);const n=this._map;n&&(n.transform.renderWorldCopies&&(this._lngLat=Yr(this._lngLat,this._pos,n.transform)),this._pos=n.project(this._lngLat),!0===t?this._updateFrameId=e.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),n._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(n._showingGlobe()||n.getTerrain()||n.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(t){return this._offset=e.Point.convert(t),this._update(),this}_onMove(t){const n=this._map;if(!n)return;const i=this._pointerdownPos,r=this._positionDelta;if(i&&r){if(!this._isDragging){const e=this._clickTolerance||n._clickTolerance;if(t.point.dist(i)<e)return;this._isDragging=!0}this._pos=t.point.sub(r),this._lngLat=n.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}_addDragHandler(e){const t=this._map,n=this._pos;t&&n&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(n),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const to={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},no=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function io(t=new e.Point(0,0),n="bottom"){if("number"==typeof t){const i=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(n){case"top":return new e.Point(0,t);case"top-left":return new e.Point(i,i);case"top-right":return new e.Point(-i,i);case"bottom":return new e.Point(0,-t);case"bottom-left":return new e.Point(i,-i);case"bottom-right":return new e.Point(-i,-i);case"left":return new e.Point(t,0);case"right":return new e.Point(-t,0)}return new e.Point(0,0)}return t instanceof e.Point||Array.isArray(t)?e.Point.convert(t):e.Point.convert(t[n]||[0,0])}class ro{constructor(e){this.jumpTo(e)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const n=e.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-n)+this._end*n}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,t,n){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+n}}const oo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},so={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},ao={showCompass:!0,showZoom:!0,visualizePitch:!1};class lo{constructor(t,n,i=!1){this._clickTolerance=10,this.element=n,this.mouseRotate=new xr({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,i&&(this.mousePitch=new _r({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener("mousedown",this.mousedown),n.addEventListener("touchstart",this.touchstart,{passive:!1}),n.addEventListener("touchmove",this.touchmove),n.addEventListener("touchend",this.touchend),n.addEventListener("touchcancel",this.reset)}down(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),u()}move(e,t){const n=this.map,i=this.mouseRotate.mousemoveWindow(e,t),r=i&&i.bearingDelta;if(r&&n.setBearing(n.getBearing()+r),this.mousePitch){const i=this.mousePitch.mousemoveWindow(e,t),r=i&&i.pitchDelta;r&&n.setPitch(n.getPitch()+r)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){d(),e.window.removeEventListener("mousemove",this.mousemove),e.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),f(this.element,t)),e.window.addEventListener("mousemove",this.mousemove),e.window.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,f(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=m(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){1!==e.targetTouches.length?this.reset():(this._lastPos=m(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const co={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},uo={maxWidth:100,unit:"metric"},ho={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},po={version:e.version,supported:n,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:class extends Zr{constructor(t){if(e.LivePerformanceUtils.mark(e.PerformanceMarkers.create),null!=(t=e.extend({},so,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.isSafariWithAntialiasingBug(e.window)&&(t.antialias=!1,e.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Xi(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._useWebGL2=t.useWebGL2,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._optimizeForTerrain=t.optimizeForTerrain,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new Jr,this._domRenderTaskQueue=new Jr,this._controls=[],this._markers=[],this._popups=[],this._mapId=e.uniqueId(),this._locale=e.extend({},oo,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ro(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof e.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&e.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1),e.window.addEventListener("orientationchange",this._onWindowResize,!1),e.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Wr(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),this._hash=t.hash&&new Ji("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),t.attributionControl&&this.addControl(new Xr({customAttribution:t.customAttribution})),this._logoControl=new Kr,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.Event(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new e.Event(`${t.dataType}dataloading`,t))}))}_getMapId(){return this._mapId}addControl(t,n){if(void 0===n&&(n=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=t.onAdd(this);this._controls.push(t);const r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(t);return n>-1&&this._controls.splice(n,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)),this.fire(new e.Event("resize",t)),n&&this.fire(new e.Event("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return"auto"===t?e.window.navigator.language:Array.isArray(t)?0===t.length?void 0:t.map((t=>"auto"===t?e.window.navigator.language:t)):t}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style._reloadSources();for(const n of this._controls)n._setLanguage&&n._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const t=this.transform,n=t.projection.name;let i;"globe"===n&&t.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?(t.setMercatorFromTransition(),i=!0):"mercator"===n&&t.zoom<e.GLOBE_ZOOM_THRESHOLD_MAX&&(t.setProjection({name:"globe"}),i=!0),i&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(t){let n;if(n="globe"===t.name&&this.transform.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),n){this.painter.clearBackgroundTiles();for(const e in this.style._sourceCaches)this.style._sourceCaches[e].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(t){return this.transform.locationPoint3D(e.LngLat.convert(t))}unproject(t){return this.transform.pointLocation3D(e.Point.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,n){if("mouseenter"===e||"mouseover"===e){let i=!1;const r=r=>{const o=t.filter((e=>this.getLayer(e))),s=o.length?this.queryRenderedFeatures(r.point,{layers:o}):[];s.length?i||(i=!0,n.call(this,new ar(e,this,r.originalEvent,{features:s}))):i=!1},o=()=>{i=!1};return{layers:new Set(t),listener:n,delegates:{mousemove:r,mouseout:o}}}if("mouseleave"===e||"mouseout"===e){let i=!1;const r=r=>{const o=t.filter((e=>this.getLayer(e)));(o.length?this.queryRenderedFeatures(r.point,{layers:o}):[]).length?i=!0:i&&(i=!1,n.call(this,new ar(e,this,r.originalEvent)))},o=t=>{i&&(i=!1,n.call(this,new ar(e,this,t.originalEvent)))};return{layers:new Set(t),listener:n,delegates:{mousemove:r,mouseout:o}}}{const i=e=>{const i=t.filter((e=>this.getLayer(e))),r=i.length?this.queryRenderedFeatures(e.point,{layers:i}):[];r.length&&(e.features=r,n.call(this,e),delete e.features)};return{layers:new Set(t),listener:n,delegates:{[e]:i}}}}on(e,t,n){if(void 0===n)return super.on(e,t);Array.isArray(t)||(t=[t]);const i=this._createDelegatedListener(e,t,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(i);for(const r in i.delegates)this.on(r,i.delegates[r]);return this}once(e,t,n){if(void 0===n)return super.once(e,t);Array.isArray(t)||(t=[t]);const i=this._createDelegatedListener(e,t,n);for(const r in i.delegates)this.once(r,i.delegates[r]);return this}off(e,t,n){if(void 0===n)return super.off(e,t);t=new Set(Array.isArray(t)?t:[t]);const i=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0},r=this._delegatedListeners?this._delegatedListeners[e]:void 0;return r&&(e=>{for(let r=0;r<e.length;r++){const o=e[r];if(o.listener===n&&i(o.layers,t)){for(const e in o.delegates)this.off(e,o.delegates[e]);return e.splice(r,1),this}}})(r),this}queryRenderedFeatures(t,n){return this.style?(void 0!==n||void 0===t||t instanceof e.Point||Array.isArray(t)||(n=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}isPointOnSurface(t){const{name:n}=this.transform.projection;return"globe"!==n&&"mercator"!==n&&e.warnOnce(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(e.Point.convert(t))}setStyle(t,n){return!1!==(n=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(t,n))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new Jt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Jt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,n){if("string"==typeof t){const i=this._requestManager.normalizeStyleURL(t),r=this._requestManager.transformRequest(i,e.ResourceType.Style);e.getJSON(r,((t,i)=>{t?this.fire(new e.ErrorEvent(t)):i&&this._updateDiff(i,n)}))}else"object"==typeof t&&this._updateDiff(t,n)}_updateDiff(t,n){try{this.style.setState(t)&&this._update(!0)}catch(i){e.warnOnce(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(t,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(e.warnOnce("There is no style added to the map."),!1)}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){return!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){const e=this.style&&this.style._sourceCaches;for(const t in e){const n=e[t]._tiles;for(const e in n){const t=n[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}addSourceType(e,t,n){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,n)}removeSource(e){return this.style.removeSource(e),this._updateTerrain(),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(t,n,{pixelRatio:i=1,sdf:r=!1,stretchX:o,stretchY:s,content:a}={}){if(this._lazyInitEmptyStyle(),n instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&n instanceof e.window.ImageBitmap){const{width:l,height:c,data:u}=e.exported.getImageData(n);this.style.addImage(t,{data:new e.RGBAImage({width:l,height:c},u),pixelRatio:i,stretchX:o,stretchY:s,content:a,sdf:r,version:0})}else if(void 0===n.width||void 0===n.height)this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:l,height:c}=n,u=n;this.style.addImage(t,{data:new e.RGBAImage({width:l,height:c},new Uint8Array(u.data)),pixelRatio:i,stretchX:o,stretchY:s,content:a,sdf:r,version:0,userImage:u}),u.onAdd&&u.onAdd(this,t)}}updateImage(t,n){const i=this.style.getImage(t);if(!i)return void this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=n instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&n instanceof e.window.ImageBitmap?e.exported.getImageData(n):n,{width:o,height:s}=r;void 0!==o&&void 0!==s?o===i.data.width&&s===i.data.height?(i.data.replace(r.data,!(n instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&n instanceof e.window.ImageBitmap)),this.style.updateImage(t,i)):this.fire(new e.ErrorEvent(new Error(`The width and height of the updated image (${o}, ${s})\n                must be that same as the previous version of the image\n                (${i.data.width}, ${i.data.height})`))):this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(t,n){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),((t,i)=>{n(t,i instanceof e.window.HTMLImageElement?e.exported.getImageData(i):i)}))}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}setLayerZoomRange(e,t,n){return this.style.setLayerZoomRange(e,t,n),this._update(!0)}setFilter(e,t,n={}){return this.style.setFilter(e,t,n),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,n,i={}){return this.style.setPaintProperty(e,t,n,i),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,n,i={}){return this.style.setLayoutProperty(e,t,n,i),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t),this.transform):0}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let i,r,o,s=this._container;for(;s&&(!r||!o);){const t=e.window.getComputedStyle(s).transform;t&&"none"!==t&&(i=t.match(/matrix.*\((.+)\)/)[1].split(", "),i[0]&&"0"!==i[0]&&"1"!==i[0]&&(r=i[0]),i[3]&&"0"!==i[3]&&"1"!==i[3]&&(o=i[3])),s=s.parentElement}this._containerWidth=r?Math.abs(t/r):t,this._containerHeight=o?Math.abs(n/o):n}_detectMissingCSS(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=o("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=o("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=o("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const n=this._controlContainer=o("div","mapboxgl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{i[e]=o("div",`mapboxgl-ctrl-${e}`,n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,n){const i=e.exported.devicePixelRatio||1;this._canvas.width=i*Math.ceil(t),this._canvas.height=i*Math.ceil(n),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${n}px`}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const t=e.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._useWebGL2&&this._canvas.getContext("webgl2",t),r=i||this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);r?(this._useWebGL2&&!i&&e.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),e.storeAuthState(r,!0),this.painter=new Li(r,this.transform,!!i),this.on("data",(e=>{"source"===e.dataType&&this.painter.setTileLoadedFlag(!0)})),e.exported$1.testSupport(r)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(t){let n;const i=this.painter.context.extTimerQuery,r=e.exported.now();if(this.listens("gpu-timing-frame")&&(n=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],e.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],e.window.performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const o=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,n=this.transform.pitch,i=e.exported.now(),r=new e.EvaluationParameters(t,{now:i,fadeDuration:o,pitch:n,transition:this.style.getTransition()});this.style.update(r)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let s=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),s=this._updateAverageElevation(r),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):s=this._updateAverageElevation(r),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const t=e.exported.now()-r;i.endQueryEXT(i.TIME_ELAPSED_EXT,n),setTimeout((()=>{const o=i.getQueryObjectEXT(n,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(n),this.fire(new e.Event("gpu-timing-frame",{cpuTime:t,gpuTime:o})),e.window.performance.mark("frame-gpu",{startTime:r,detail:{gpuTime:o}})}),50)}if(this.listens("gpu-timing-layer")){const t=this.painter.collectGpuTimers();setTimeout((()=>{const n=this.painter.queryGpuTimers(t);this.fire(new e.Event("gpu-timing-layer",{layerTimes:n}))}),50)}if(this.listens("gpu-timing-deferred-render")){const t=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const n=this.painter.queryGpuTimeDeferredRender(t);this.fire(new e.Event("gpu-timing-deferred-render",{gpuTime:n}))}),50)}const a=this._sourcesDirty||this._styleDirty||this._placementDirty||s;if(a||this._repaint)this.triggerRepaint();else{const t=!this.isMoving()&&this.loaded();if(t&&(s=this._updateAverageElevation(r,!0)),s)this.triggerRepaint();else if(this._triggerFrame(!1),t&&(this.fire(new e.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const t=this._calculateSpeedIndex();this.fire(new e.Event("speedindexcompleted",{speedIndex:t})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||a||(this._fullyLoaded=!0,e.LivePerformanceUtils.mark(e.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&e.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e,t=!1){const n=e=>(this.transform.averageElevation=e,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);if((t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const t=this.transform.averageElevation;let i=this.transform.sampleAverageElevation(),r=!1;this.transform.elevation&&(r=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(i)?i=0:this._averageElevationLastSampledAt=e;const o=Math.abs(t-i);if(o>1){if(this._isInitialLoad||r)return this._averageElevation.jumpTo(i),n(i);this._averageElevation.easeTo(i,e,300)}else if(o>1e-4)return this._averageElevation.jumpTo(i),n(i)}return!!this._averageElevation.isEasing(e)&&n(this._averageElevation.getValue(e))}_authenticate(){e.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(t=>{if(t&&(t.message===e.AUTH_ERR_MSG||401===t.status)){const t=this.painter.context.gl;e.storeAuthState(t,!1),this._logoControl instanceof Kr&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new e.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),e.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const n=this.painter.context.gl,i=n.createFramebuffer();function r(e){n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);const t=new Uint8Array(n.drawingBufferWidth*n.drawingBufferHeight*4);return n.readPixels(0,0,n.drawingBufferWidth,n.drawingBufferHeight,n.RGBA,n.UNSIGNED_BYTE,t),t}return n.bindFramebuffer(n.FRAMEBUFFER,i),this._canvasPixelComparison(r(e),t.canvasCopies.map(r),t.timeStamps)}_canvasPixelComparison(e,t,n){let i=n[1]-n[0];const r=e.length/4;for(let o=0;o<t.length;o++){const s=t[o];let a=0;for(let t=0;t<s.length;t+=4)s[t]===e[t]&&s[t+1]===e[t+1]&&s[t+2]===e[t+2]&&s[t+3]===e[t+3]&&(a+=1);i+=(n[o+2]-n[o+1])*(1-a/r)}return i}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1),e.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),e.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new e.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.exported.frame((e=>{const t=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,t&&this._render(e)})))}_preloadTiles(t){const n=this.style?Object.values(this.style._sourceCaches):[];return e.asyncAll(n,((e,n)=>e._preloadTiles(t,n)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===e.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}_setCacheLimits(t,n){e.setCacheLimits(t,n)}get version(){return e.version}},NavigationControl:class{constructor(t){this.options=e.extend({},ao,t),this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(e=>{this._map&&this._map.zoomIn({},{originalEvent:e})})),o("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(e=>{this._map&&this._map.zoomOut({},{originalEvent:e})})),o("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(e=>{const t=this._map;t&&(this.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))})),this._compassIcon=o("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),n=t===e.getMaxZoom(),i=t===e.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5)}) rotateX(${e.transform.pitch}deg) rotateZ(${e.transform.angle*(180/Math.PI)}deg)`:`rotate(${e.transform.angle*(180/Math.PI)}deg)`;e._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=t)}))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lo(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const n=o("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}_setButtonTitle(e,t){if(!this._map)return;const n=this._map._getUIString(`NavigationControl.${t}`);e.setAttribute("aria-label",n),e.firstElementChild&&e.firstElementChild.setAttribute("title",n)}},GeolocateControl:class extends e.Evented{constructor(t){super(),this.options=e.extend({geolocation:e.window.navigator.geolocation},co,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ki(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){const n=(e=!!this.options.geolocation)=>{this._supportsGeolocation=e,t(e)};void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((e=>n("denied"!==e.state))).catch((()=>n())):n()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),n=e.coords;return!!t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}_updateCamera(t){const n=new e.LngLat(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,r=this._map.getBearing(),o=e.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(i),o,{geolocateSource:!0})}_updateMarker(t){if(t){const n=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,n=e.mercatorZfromAltitude(1,t._center.lat)*t.worldSize,i=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${i}px`,this._circleElement.style.height=`${i}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=o("button","mapboxgl-ctrl-geolocate",this._container),o("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o("div","mapboxgl-user-location"),this._dotElement.appendChild(o("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(o("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new eo({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=o("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new eo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new e.Event("trackuserlocationend")))}))}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{e.window.addEventListener("ondeviceorientationabsolute"in e.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==e.window.DeviceMotionEvent&&"function"==typeof e.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((e=>{"granted"===e&&t()})).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),e.window.removeEventListener("deviceorientation",this._onDeviceOrientation),e.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Xr,ScaleControl:class{constructor(t){this.options=e.extend({},uo,t),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(e){return!1}}(),e.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,n=t._containerHeight/2,i=t._containerWidth/2-e/2,r=t.unproject([i,n]),o=t.unproject([i+e,n]),s=r.distanceTo(o);if("imperial"===this.options.unit){const t=3.2808*s;t>5280?this._setScale(e,t/5280,"mile"):this._setScale(e,t,"foot")}else"nautical"===this.options.unit?this._setScale(e,s/1852,"nautical-mile"):s>=1e3?this._setScale(e,s/1e3,"kilometer"):this._setScale(e,s,"meter")}_setScale(e,t,n){this._map._requestDomTask((()=>{const i=function(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let n=e/t;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(n),t*n}(t),r=i/t;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==n?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:n}).format(i):`${i}&nbsp;${ho[n]}`,this._container.style.width=e*r+"px"}))}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in e.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=o("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!e.window.document.fullscreenEnabled&&!e.window.document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=o("button","mapboxgl-ctrl-fullscreen",this._controlContainer);o("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(e.window.document.fullscreenElement||e.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends e.Evented{constructor(t){super(),this.options=e.extend(Object.create(to),t),e.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new e.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(e.window.document.createTextNode(t))}setHTML(t){const n=e.window.document.createDocumentFragment(),i=e.window.document.createElement("body");let r;for(i.innerHTML=t;r=i.firstChild,r;)n.appendChild(r);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=o("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const e=this._closeButton=o("button","mapboxgl-popup-close-button",t);e.type="button",e.setAttribute("aria-label","Close popup"),e.setAttribute("aria-hidden","true"),e.innerHTML="&#215;",e.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,n=this._container,i=this._pos;if(!t||!n||!i)return"bottom";const r=n.offsetWidth,o=n.offsetHeight,s=i.x<r/2,a=i.x>t.transform.width-r/2;if(i.y+e<o)return s?"top-left":a?"top-right":"top";if(i.y>t.transform.height-o){if(s)return"bottom-left";if(a)return"bottom-right"}return s?"left":a?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(t){const n=this._map,i=this._content;if(!n||!this._lngLat&&!this._trackPointer||!i)return;let r=this._container;if(r||(r=this._container=o("div","mapboxgl-popup",n.getContainer()),this._tip=o("div","mapboxgl-popup-tip",r),r.appendChild(i)),this.options.maxWidth&&r.style.maxWidth!==this.options.maxWidth&&(r.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Yr(this._lngLat,this._pos,n.transform)),!this._trackPointer||t){const e=this._pos=this._trackPointer&&t?t:n.project(this._lngLat),i=io(this.options.offset),r=this._anchor=this._getAnchor(i.y),o=io(this.options.offset,r),s=e.add(o).round();n._requestDomTask((()=>{this._container&&r&&(this._container.style.transform=`${Qr[r]} translate(${s.x}px,${s.y}px)`)}))}if(!this._marker&&n._showingGlobe()){const t=e.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(t)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(no);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity=`${e}`),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:eo,Style:Jt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,FreeCameraOptions:ji,Evented:e.Evented,config:e.config,prewarm:function(){Fe().acquire(Le)},clearPrewarmedResources:function(){const e=Ne;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Le),Ne=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return Be.workerCount},set workerCount(e){Be.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){e.clearTileCache(t)},workerUrl:"",workerClass:null,setNow:e.exported.setNow,restoreNow:e.exported.restoreNow};return po}));var r=n;return r}()}(_k);const wk=r(_k.exports);function kk(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ek(e){return!!e&&!!e[uE]}function Sk(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===dE}(e)||Array.isArray(e)||!!e[cE]||!!(null===(t=e.constructor)||void 0===t?void 0:t[cE])||Pk(e)||Ok(e))}function Tk(e,t,n){void 0===n&&(n=!1),0===Ck(e)?(n?Object.keys:hE)(e).forEach((function(i){n&&"symbol"==typeof i||t(i,e[i],e)})):e.forEach((function(n,i){return t(i,n,e)}))}function Ck(e){var t=e[uE];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Pk(e)?2:Ok(e)?3:0}function Mk(e,t){return 2===Ck(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ik(e,t,n){var i=Ck(e);2===i?e.set(t,n):3===i?e.add(n):e[t]=n}function Ak(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Pk(e){return oE&&e instanceof Map}function Ok(e){return sE&&e instanceof Set}function Dk(e){return e.o||e.t}function Rk(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=pE(e);delete t[uE];for(var n=hE(t),i=0;i<n.length;i++){var r=n[i],o=t[r];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[r]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[r]})}return Object.create(Object.getPrototypeOf(e),t)}function zk(e,t){return void 0===t&&(t=!1),Bk(e)||Ek(e)||!Sk(e)||(Ck(e)>1&&(e.set=e.add=e.clear=e.delete=Lk),Object.freeze(e),t&&Tk(e,(function(e,t){return zk(t,!0)}),!0)),e}function Lk(){kk(2)}function Bk(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Nk(e){var t=fE[e];return t||kk(18,e),t}function Fk(){return iE}function $k(e,t){t&&(Nk("Patches"),e.u=[],e.s=[],e.v=t)}function jk(e){Vk(e),e.p.forEach(qk),e.p=null}function Vk(e){e===iE&&(iE=e.l)}function Uk(e){return iE={p:[],l:iE,h:e,m:!0,_:0}}function qk(e){var t=e[uE];0===t.i||1===t.i?t.j():t.g=!0}function Gk(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.O||Nk("ES5").S(t,e,i),i?(n[uE].P&&(jk(t),kk(4)),Sk(e)&&(e=Wk(t,e),t.l||Zk(t,e)),t.u&&Nk("Patches").M(n[uE].t,e,t.u,t.s)):e=Wk(t,n,[]),jk(t),t.u&&t.v(t.u,t.s),e!==lE?e:void 0}function Wk(e,t,n){if(Bk(t))return t;var i=t[uE];if(!i)return Tk(t,(function(r,o){return Hk(e,i,t,r,o,n)}),!0),t;if(i.A!==e)return t;if(!i.P)return Zk(e,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var r=4===i.i||5===i.i?i.o=Rk(i.k):i.o,o=r,s=!1;3===i.i&&(o=new Set(r),r.clear(),s=!0),Tk(o,(function(t,o){return Hk(e,i,r,t,o,n,s)})),Zk(e,r,!1),n&&e.u&&Nk("Patches").N(i,n,e.u,e.s)}return i.o}function Hk(e,t,n,i,r,o,s){if(Ek(r)){var a=Wk(e,r,o&&t&&3!==t.i&&!Mk(t.R,i)?o.concat(i):void 0);if(Ik(n,i,a),!Ek(a))return;e.m=!1}else s&&n.add(r);if(Sk(r)&&!Bk(r)){if(!e.h.D&&e._<1)return;Wk(e,r),t&&t.A.l||Zk(e,r)}}function Zk(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&zk(t,n)}function Xk(e,t){var n=e[uE];return(n?Dk(n):e)[t]}function Kk(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=Object.getPrototypeOf(n)}}function Jk(e){e.P||(e.P=!0,e.l&&Jk(e.l))}function Yk(e){e.o||(e.o=Rk(e.t))}function Qk(e,t,n){var i=Pk(t)?Nk("MapSet").F(t,n):Ok(t)?Nk("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),i={i:n?1:0,A:t?t.A:Fk(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},r=i,o=mE;n&&(r=[i],o=gE);var s=Proxy.revocable(r,o),a=s.revoke,l=s.proxy;return i.k=l,i.j=a,l}(t,n):Nk("ES5").J(t,n);return(n?n.A:Fk()).p.push(i),i}function eE(e){return Ek(e)||kk(22,e),function e(t){if(!Sk(t))return t;var n,i=t[uE],r=Ck(t);if(i){if(!i.P&&(i.i<4||!Nk("ES5").K(i)))return i.t;i.I=!0,n=tE(t,r),i.I=!1}else n=tE(t,r);return Tk(n,(function(t,r){i&&function(e,t){return 2===Ck(e)?e.get(t):e[t]}(i.t,t)===r||Ik(n,t,e(r))})),3===r?new Set(n):n}(e)}function tE(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Rk(e)}var nE,iE,rE="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),oE="undefined"!=typeof Map,sE="undefined"!=typeof Set,aE="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,lE=rE?Symbol.for("immer-nothing"):((nE={})["immer-nothing"]=!0,nE),cE=rE?Symbol.for("immer-draftable"):"__$immer_draftable",uE=rE?Symbol.for("immer-state"):"__$immer_state",dE=""+Object.prototype.constructor,hE="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,pE=Object.getOwnPropertyDescriptors||function(e){var t={};return hE(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},fE={},mE={get:function(e,t){if(t===uE)return e;var n=Dk(e);if(!Mk(n,t))return function(e,t,n){var i,r=Kk(t,n);return r?"value"in r?r.value:null===(i=r.get)||void 0===i?void 0:i.call(e.k):void 0}(e,n,t);var i=n[t];return e.I||!Sk(i)?i:i===Xk(e.t,t)?(Yk(e),e.o[t]=Qk(e.A.h,i,e)):i},has:function(e,t){return t in Dk(e)},ownKeys:function(e){return Reflect.ownKeys(Dk(e))},set:function(e,t,n){var i=Kk(Dk(e),t);if(null==i?void 0:i.set)return i.set.call(e.k,n),!0;if(!e.P){var r=Xk(Dk(e),t),o=null==r?void 0:r[uE];if(o&&o.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(Ak(n,r)&&(void 0!==n||Mk(e.t,t)))return!0;Yk(e),Jk(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==Xk(e.t,t)||t in e.t?(e.R[t]=!1,Yk(e),Jk(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Dk(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty:function(){kk(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){kk(12)}},gE={};Tk(mE,(function(e,t){gE[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),gE.deleteProperty=function(e,t){return gE.set.call(this,e,t,void 0)},gE.set=function(e,t,n){return mE.set.call(this,e[0],t,n,e[0])};var yE=function(){function e(e){var t=this;this.O=aE,this.D=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var r=n;n=e;var o=t;return function(e){var t=this;void 0===e&&(e=r);for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return o.produce(e,(function(e){var i;return(i=n).call.apply(i,[t,e].concat(s))}))}}var s;if("function"!=typeof n&&kk(6),void 0!==i&&"function"!=typeof i&&kk(7),Sk(e)){var a=Uk(t),l=Qk(t,e,void 0),c=!0;try{s=n(l),c=!1}finally{c?jk(a):Vk(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return $k(a,i),Gk(e,a)}),(function(e){throw jk(a),e})):($k(a,i),Gk(s,a))}if(!e||"object"!=typeof e){if(void 0===(s=n(e))&&(s=e),s===lE&&(s=void 0),t.D&&zk(s,!0),i){var u=[],d=[];Nk("Patches").M(e,s,u,d),i(u,d)}return s}kk(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(r))}))};var i,r,o=t.produce(e,n,(function(e,t){i=e,r=t}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return[e,i,r]})):[o,i,r]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Sk(e)||kk(8),Ek(e)&&(e=eE(e));var t=Uk(this),n=Qk(this,e,void 0);return n[uE].C=!0,Vk(t),n},t.finishDraft=function(e,t){var n=(e&&e[uE]).A;return $k(n,t),Gk(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!aE&&kk(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));var r=Nk("Patches").$;return Ek(e)?r(e,t):this.produce(e,(function(e){return r(e,t)}))},e}(),vE=new yE,bE=vE.produce;function xE(e){return xE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xE(e)}function _E(e){var t=function(e,t){if("object"!==xE(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==xE(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===xE(t)?t:String(t)}function wE(e,t,n){return(t=_E(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function EE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kE(Object(n),!0).forEach((function(t){wE(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function SE(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}vE.produceWithPatches.bind(vE),vE.setAutoFreeze.bind(vE),vE.setUseProxies.bind(vE),vE.applyPatches.bind(vE),vE.createDraft.bind(vE),vE.finishDraft.bind(vE);var TE="function"==typeof Symbol&&Symbol.observable||"@@observable",CE=function(){return Math.random().toString(36).substring(7).split("").join(".")},ME={INIT:"@@redux/INIT"+CE(),REPLACE:"@@redux/REPLACE"+CE(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+CE()}};function IE(e,t,n){var i;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(SE(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(SE(1));return n(IE)(e,t)}if("function"!=typeof e)throw new Error(SE(2));var r=e,o=t,s=[],a=s,l=!1;function c(){a===s&&(a=s.slice())}function u(){if(l)throw new Error(SE(3));return o}function d(e){if("function"!=typeof e)throw new Error(SE(4));if(l)throw new Error(SE(5));var t=!0;return c(),a.push(e),function(){if(t){if(l)throw new Error(SE(6));t=!1,c();var n=a.indexOf(e);a.splice(n,1),s=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(SE(7));if(void 0===e.type)throw new Error(SE(8));if(l)throw new Error(SE(9));try{l=!0,o=r(o,e)}finally{l=!1}for(var t=s=a,n=0;n<t.length;n++)(0,t[n])();return e}return h({type:ME.INIT}),(i={dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(SE(10));r=e,h({type:ME.REPLACE})}})[TE]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(SE(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[TE]=function(){return this},e},i}function AE(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var r=t[i];"function"==typeof e[r]&&(n[r]=e[r])}var o,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:ME.INIT}))throw new Error(SE(12));if(void 0===n(void 0,{type:ME.PROBE_UNKNOWN_ACTION()}))throw new Error(SE(13))}))}(n)}catch(wT){o=wT}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var i=!1,r={},a=0;a<s.length;a++){var l=s[a],c=n[l],u=e[l],d=c(u,t);if(void 0===d)throw t&&t.type,new Error(SE(14));r[l]=d,i=i||d!==u}return(i=i||s.length!==Object.keys(e).length)?r:e}}function PE(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function OE(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),i=function(){throw new Error(SE(15))},r={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},o=t.map((function(e){return e(r)}));return i=PE.apply(void 0,o)(n.dispatch),EE(EE({},n),{},{dispatch:i})}}}var DE="NOT_FOUND",RE=function(e,t){return e===t};function zE(e,t){var n,i,r="object"==typeof t?t:{equalityCheck:t},o=r.equalityCheck,s=void 0===o?RE:o,a=r.maxSize,l=void 0===a?1:a,c=r.resultEqualityCheck,u=function(e){return function(t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var i=t.length,r=0;r<i;r++)if(!e(t[r],n[r]))return!1;return!0}}(s),d=1===l?(n=u,{get:function(e){return i&&n(i.key,e)?i.value:DE},put:function(e,t){i={key:e,value:t}},getEntries:function(){return i?[i]:[]},clear:function(){i=void 0}}):function(e,t){var n=[];function i(e){var i=n.findIndex((function(n){return t(e,n.key)}));if(i>-1){var r=n[i];return i>0&&(n.splice(i,1),n.unshift(r)),r.value}return DE}return{get:i,put:function(t,r){i(t)===DE&&(n.unshift({key:t,value:r}),n.length>e&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(l,u);function h(){var t=d.get(arguments);if(t===DE){if(t=e.apply(null,arguments),c){var n=d.getEntries().find((function(e){return c(e.value,t)}));n&&(t=n.value)}d.put(arguments,t)}return t}return h.clearCache=function(){return d.clear()},h}function LE(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];var o,s=0,a={memoizeOptions:void 0},l=i.pop();if("object"==typeof l&&(a=l,l=i.pop()),"function"!=typeof l)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof l+"]");var c=a.memoizeOptions,u=void 0===c?n:c,d=Array.isArray(u)?u:[u],h=function(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return t}(i),p=e.apply(void 0,[function(){return s++,l.apply(null,arguments)}].concat(d)),f=e((function(){for(var e=[],t=h.length,n=0;n<t;n++)e.push(h[n].apply(null,arguments));return o=p.apply(null,e)}));return Object.assign(f,{resultFunc:l,memoizedResultFunc:p,dependencies:h,lastResult:function(){return o},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),f}}var BE=LE(zE);function NE(e){return function(t){var n=t.dispatch,i=t.getState;return function(t){return function(r){return"function"==typeof r?r(n,i,e):t(r)}}}}var FE=NE();FE.withExtraArgument=NE;const $E=FE;var jE=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),VE=globalThis&&globalThis.__generator||function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(wT){o=[6,wT],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},UE=globalThis&&globalThis.__spreadArray||function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},qE=Object.defineProperty,GE=Object.defineProperties,WE=Object.getOwnPropertyDescriptors,HE=Object.getOwnPropertySymbols,ZE=Object.prototype.hasOwnProperty,XE=Object.prototype.propertyIsEnumerable,KE=function(e,t,n){return t in e?qE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},JE=function(e,t){for(var n in t||(t={}))ZE.call(t,n)&&KE(e,n,t[n]);if(HE)for(var i=0,r=HE(t);i<r.length;i++)n=r[i],XE.call(t,n)&&KE(e,n,t[n]);return e},YE=function(e,t){return GE(e,WE(t))},QE="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?PE:PE.apply(null,arguments)},eS=function(e){function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=e.apply(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return jE(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,UE([void 0],e[0].concat(this)))):new(t.bind.apply(t,UE([void 0],e.concat(this))))},t}(Array),tS=function(e){function t(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=e.apply(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return jE(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,UE([void 0],e[0].concat(this)))):new(t.bind.apply(t,UE([void 0],e.concat(this))))},t}(Array);function nS(e){return Sk(e)?bE(e,(function(){})):e}function iS(){return function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t;e.immutableCheck,e.serializableCheck;var i=new eS;return n&&(function(e){return"boolean"==typeof e}(n)?i.push($E):i.push($E.withExtraArgument(n.extraArgument))),i}(e)}}function rS(e,t){function n(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(t){var r=t.apply(void 0,n);if(!r)throw new Error("prepareAction did not return an object");return JE(JE({type:e,payload:r.payload},"meta"in r&&{meta:r.meta}),"error"in r&&{error:r.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function oS(e){var t,n={},i=[],r={addCase:function(e,t){var i="string"==typeof e?e:e.type;if(i in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[i]=t,r},addMatcher:function(e,t){return i.push({matcher:e,reducer:t}),r},addDefaultCase:function(e){return t=e,r}};return e(r),[n,i,t]}function sS(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var n,i="function"==typeof e.initialState?e.initialState:nS(e.initialState),r=e.reducers||{},o=Object.keys(r),s={},a={},l={};function c(){var t="function"==typeof e.extraReducers?oS(e.extraReducers):[e.extraReducers],n=t[0],r=void 0===n?{}:n,o=t[1],s=void 0===o?[]:o,l=t[2],c=void 0===l?void 0:l,u=JE(JE({},r),a);return function(e,t,n,i){void 0===n&&(n=[]);var r,o="function"==typeof t?oS(t):[t,n,i],s=o[0],a=o[1],l=o[2];if(function(e){return"function"==typeof e}(e))r=function(){return nS(e())};else{var c=nS(e);r=function(){return c}}function u(e,t){void 0===e&&(e=r());var n=UE([s[t.type]],a.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===n.filter((function(e){return!!e})).length&&(n=[l]),n.reduce((function(e,n){if(n){var i;if(Ek(e))return void 0===(i=n(e,t))?e:i;if(Sk(e))return bE(e,(function(e){return n(e,t)}));if(void 0===(i=n(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return i}return e}),e)}return u.getInitialState=r,u}(i,(function(e){for(var t in u)e.addCase(t,u[t]);for(var n=0,i=s;n<i.length;n++){var r=i[n];e.addMatcher(r.matcher,r.reducer)}c&&e.addDefaultCase(c)}))}return o.forEach((function(e){var n,i,o=r[e],c=function(e,t){return e+"/"+t}(t,e);"reducer"in o?(n=o.reducer,i=o.prepare):n=o,s[e]=n,a[c]=n,l[e]=i?rS(c,i):rS(c)})),{name:t,reducer:function(e,t){return n||(n=c()),n(e,t)},actions:l,caseReducers:s,getInitialState:function(){return n||(n=c()),n.getInitialState()}}}var aS=["name","message","stack","code"],lS=function(e,t){this.payload=e,this.meta=t},cS=function(e,t){this.payload=e,this.meta=t},uS=function(e){if("object"==typeof e&&null!==e){for(var t={},n=0,i=aS;n<i.length;n++){var r=i[n];"string"==typeof e[r]&&(t[r]=e[r])}return t}return{message:String(e)}};function dS(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}!function(){function e(e,t,n){var i=rS(e+"/fulfilled",(function(e,t,n,i){return{payload:e,meta:YE(JE({},i||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}})),r=rS(e+"/pending",(function(e,t,n){return{payload:void 0,meta:YE(JE({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}})),o=rS(e+"/rejected",(function(e,t,i,r,o){return{payload:r,error:(n&&n.serializeError||uS)(e||"Rejected"),meta:YE(JE({},o||{}),{arg:i,requestId:t,rejectedWithValue:!!r,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),s="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(a,l,c){var u,d=(null==n?void 0:n.idGenerator)?n.idGenerator(e):function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),h=new s;function p(e){u=e,h.abort()}var f=function(){return s=this,f=null,m=function(){var s,f,m,g,y,v;return VE(this,(function(b){switch(b.label){case 0:return b.trys.push([0,4,,5]),g=null==(s=null==n?void 0:n.condition)?void 0:s.call(n,e,{getState:l,extra:c}),null===(x=g)||"object"!=typeof x||"function"!=typeof x.then?[3,2]:[4,g];case 1:g=b.sent(),b.label=2;case 2:if(!1===g||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return y=new Promise((function(e,t){return h.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:u||"Aborted"})}))})),a(r(d,e,null==(f=null==n?void 0:n.getPendingMeta)?void 0:f.call(n,{requestId:d,arg:e},{getState:l,extra:c}))),[4,Promise.race([y,Promise.resolve(t(e,{dispatch:a,getState:l,extra:c,requestId:d,signal:h.signal,abort:p,rejectWithValue:function(e,t){return new lS(e,t)},fulfillWithValue:function(e,t){return new cS(e,t)}})).then((function(t){if(t instanceof lS)throw t;return t instanceof cS?i(t.payload,d,e,t.meta):i(t,d,e)}))])];case 3:return m=b.sent(),[3,5];case 4:return v=b.sent(),m=v instanceof lS?o(null,d,e,v.payload,v.meta):o(v,d,e),[3,5];case 5:return n&&!n.dispatchConditionRejection&&o.match(m)&&m.meta.condition||a(m),[2,m]}var x}))},new Promise((function(e,t){var n=function(e){try{r(m.next(e))}catch(wT){t(wT)}},i=function(e){try{r(m.throw(e))}catch(wT){t(wT)}},r=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(n,i)};r((m=m.apply(s,f)).next())}));var s,f,m}();return Object.assign(f,{abort:p,requestId:d,arg:e,unwrap:function(){return f.then(dS)}})}}),{pending:r,rejected:o,fulfilled:i,typePrefix:e})}e.withTypes=function(){return e}}();var hS="listenerMiddleware";rS(hS+"/add"),rS(hS+"/removeAll"),rS(hS+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:"undefined"!=typeof global?global:globalThis),function(){function e(e,t){var n=r[e];return n?n.enumerable=t:r[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[uE];return mE.get(t,e)},set:function(t){var n=this[uE];mE.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var r=e[t][uE];if(!r.P)switch(r.i){case 5:i(r)&&Jk(r);break;case 4:n(r)&&Jk(r)}}}function n(e){for(var t=e.t,n=e.k,i=hE(n),r=i.length-1;r>=0;r--){var o=i[r];if(o!==uE){var s=t[o];if(void 0===s&&!Mk(t,o))return!0;var a=n[o],l=a&&a[uE];if(l?l.t!==s:!Ak(a,s))return!0}}var c=!!t[uE];return i.length!==hE(t).length+(c?0:1)}function i(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var i=0;i<t.length;i++)if(!t.hasOwnProperty(i))return!0;return!1}var r={};!function(e,t){fE[e]||(fE[e]=t)}("ES5",{J:function(t,n){var i=Array.isArray(t),r=function(t,n){if(t){for(var i=Array(n.length),r=0;r<n.length;r++)Object.defineProperty(i,""+r,e(r,!0));return i}var o=pE(n);delete o[uE];for(var s=hE(o),a=0;a<s.length;a++){var l=s[a];o[l]=e(l,t||!!o[l].enumerable)}return Object.create(Object.getPrototypeOf(n),o)}(i,t),o={i:i?5:4,A:n?n.A:Fk(),P:!1,I:!1,R:{},l:n,t:t,k:r,o:null,g:!1,C:!1};return Object.defineProperty(r,uE,{value:o,writable:!0}),r},S:function(e,n,r){r?Ek(n)&&n[uE].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[uE];if(n){var r=n.t,o=n.k,s=n.R,a=n.i;if(4===a)Tk(o,(function(t){t!==uE&&(void 0!==r[t]||Mk(r,t)?s[t]||e(o[t]):(s[t]=!0,Jk(n)))})),Tk(r,(function(e){void 0!==o[e]||Mk(o,e)||(s[e]=!1,Jk(n))}));else if(5===a){if(i(n)&&(Jk(n),s.length=!0),o.length<r.length)for(var l=o.length;l<r.length;l++)s[l]=!1;else for(var c=r.length;c<o.length;c++)s[c]=!0;for(var u=Math.min(o.length,r.length),d=0;d<u;d++)o.hasOwnProperty(d)||(s[d]=!0),void 0===s[d]&&e(o[d])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):i(e)}})}();const pS=sS({name:"membership",initialState:{memberships:{}},reducers:{addMemberships:(e,t)=>{t.payload.forEach((t=>{e.memberships[t.id]={...e.memberships[t.id],...t}}))}},extraReducers:e=>{e.addCase(_S,((e,t)=>{t.payload.forEach((t=>{var n;(null!==(n=t.memberships)&&void 0!==n?n:[]).forEach((t=>{e.memberships[t.id]={...e.memberships[t.id],...t}}))}))}))}}),{addMemberships:fS}=pS.actions,mS=pS.reducer,gS=e=>e.membership.memberships;BE(((e,t)=>gS(e)),((e,t)=>t),((e,t)=>e[t]));const yS=BE(((e,t)=>gS(e)),((e,t)=>t),((e,t)=>Object.values(e).filter((e=>e.userId===t)))),vS=BE(((e,t)=>gS(e)),((e,t)=>t),((e,t)=>Object.values(e).filter((e=>e.channelId===t)))),bS=BE(((e,t,n)=>gS(e)),((e,t,n)=>t),((e,t,n)=>n),((e,t,n)=>Object.values(e).find((e=>e.channelId===t&&e.userId===n)))),xS=sS({name:"channel",initialState:{channels:{},channelId:null},reducers:{addChannels:(e,t)=>{t.payload.forEach((t=>{e.channels[t.id]={...e.channels[t.id],...t}}))},setFocusChannelId:(e,t)=>{e.channelId=t.payload},toggleFocusChannelId:(e,t)=>{e.channelId===t.payload?e.channelId=null:e.channelId=t.payload}},extraReducers:e=>{e.addCase(fS,((e,t)=>{t.payload.forEach((t=>{var n;null!==(n=t.channel)&&void 0!==n&&n.id&&(e.channels[t.channel.id]={...e.channels[t.channel.id],...t.channel})}))}))}}),{addChannels:_S,setFocusChannelId:wS,toggleFocusChannelId:kS}=xS.actions,ES=xS.reducer,SS=e=>e.channel.channels;BE(((e,t)=>SS(e)),((e,t)=>t),((e,t)=>e[t]));const TS=e=>e.channel.channelId?e.channel.channels[e.channel.channelId]:null,CS=sS({name:"post",initialState:{posts:{}},reducers:{addPosts:(e,t)=>{t.payload.forEach((t=>{e.posts[t.id]={...e.posts[t.id],...t}}))}}}),{addPosts:MS}=CS.actions,IS=CS.reducer,AS=e=>e.post.posts;BE(((e,t)=>AS(e)),((e,t)=>t),((e,t)=>e[t])),BE(((e,t)=>AS(e)),((e,t)=>t),((e,t)=>Object.values(e).filter((e=>e.userId===t))));const PS=BE(((e,t)=>AS(e)),((e,t)=>t),((e,t)=>Object.values(e).filter((e=>e.channelId===t))));BE(((e,t,n)=>AS(e)),((e,t,n)=>t),((e,t,n)=>n),((e,t,n)=>Object.values(e).find((e=>e.channelId===t&&e.userId===n))));const OS=sS({name:"user",initialState:{users:{},userId:null},reducers:{addUsers:(e,t)=>{t.payload.forEach((t=>{e.users[t.id]={...e.users[t.id],...t}}))},setAppUserId:(e,t)=>{e.userId=t.payload}},extraReducers:e=>{e.addCase(fS,((e,t)=>{t.payload.forEach((t=>{var n;null!==(n=t.user)&&void 0!==n&&n.id&&(e.users[t.user.id]={...e.users[t.user.id],...t.user})}))})).addCase(_S,((e,t)=>{t.payload.forEach((t=>{var n;(null!==(n=t.memberships)&&void 0!==n?n:[]).forEach((t=>{var n;null!==(n=t.user)&&void 0!==n&&n.id&&(e.users[t.user.id]={...e.users[t.user.id],...t.user})}))}))})).addCase(MS,((e,t)=>{t.payload.forEach((t=>{var n;null!==(n=t.user)&&void 0!==n&&n.id&&(e.users[t.user.id]={...e.users[t.user.id],...t.user})}))}))}}),{addUsers:DS,setAppUserId:RS}=OS.actions,zS=OS.reducer,LS=e=>e.user.users;BE(((e,t)=>LS(e)),((e,t)=>t),((e,t)=>e[t]));const BS=e=>e.user.userId?e.user.users[e.user.userId]:null;var NS={exports:{}},FS={},$S=V,jS="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},VS=$S.useState,US=$S.useEffect,qS=$S.useLayoutEffect,GS=$S.useDebugValue;function WS(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!jS(e,n)}catch(kT){return!0}}var HS="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),i=VS({inst:{value:n,getSnapshot:t}}),r=i[0].inst,o=i[1];return qS((function(){r.value=n,r.getSnapshot=t,WS(r)&&o({inst:r})}),[e,n,t]),US((function(){return WS(r)&&o({inst:r}),e((function(){WS(r)&&o({inst:r})}))}),[e]),GS(n),n};FS.useSyncExternalStore=void 0!==$S.useSyncExternalStore?$S.useSyncExternalStore:HS,NS.exports=FS;var ZS=NS.exports,XS={exports:{}},KS={},JS=V,YS=ZS,QS="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},eT=YS.useSyncExternalStore,tT=JS.useRef,nT=JS.useEffect,iT=JS.useMemo,rT=JS.useDebugValue;KS.useSyncExternalStoreWithSelector=function(e,t,n,i,r){var o=tT(null);if(null===o.current){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=iT((function(){function e(e){if(!l){if(l=!0,o=e,e=i(e),void 0!==r&&s.hasValue){var t=s.value;if(r(t,e))return a=t}return a=e}if(t=a,QS(o,e))return t;var n=i(e);return void 0!==r&&r(t,n)?t:(o=e,a=n)}var o,a,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,i,r]);var a=eT(e,o[0],o[1]);return nT((function(){s.hasValue=!0,s.value=a}),[a]),rT(a),a},XS.exports=KS;var oT=XS.exports;let sT=function(e){e()};const aT=()=>sT,lT=Symbol.for(`react-redux-context-${V.version}`),cT=globalThis,uT=new Proxy({},new Proxy({},{get(e,t){const n=function(){let e=cT[lT];return e||(e=V.createContext(null),cT[lT]=e),e}();return(e,...i)=>Reflect[t](n,...i)}}));function dT(e=uT){return function(){return V.useContext(e)}}const hT=dT();let pT=()=>{throw new Error("uSES not initialized!")};const fT=(e,t)=>e===t;function mT(e=uT){const t=e===uT?hT:dT(e);return function(e,n={}){const{equalityFn:i=fT,stabilityCheck:r,noopCheck:o}="function"==typeof n?{equalityFn:n}:n,{store:s,subscription:a,getServerState:l,stabilityCheck:c,noopCheck:u}=t();V.useRef(!0);const d=V.useCallback({[e.name]:t=>e(t)}[e.name],[e,c,r]),h=pT(a.addNestedSub,s.getState,l||s.getState,d,i);return V.useDebugValue(h),h}}const gT=mT();var yT,vT={},bT=Symbol.for("react.element"),xT=Symbol.for("react.portal"),_T=Symbol.for("react.fragment"),wT=Symbol.for("react.strict_mode"),kT=Symbol.for("react.profiler"),ET=Symbol.for("react.provider"),ST=Symbol.for("react.context"),TT=Symbol.for("react.server_context"),CT=Symbol.for("react.forward_ref"),MT=Symbol.for("react.suspense"),IT=Symbol.for("react.suspense_list"),AT=Symbol.for("react.memo"),PT=Symbol.for("react.lazy"),OT=Symbol.for("react.offscreen");
/**
             * @license React
             * react-is.production.min.js
             *
             * Copyright (c) Facebook, Inc. and its affiliates.
             *
             * This source code is licensed under the MIT license found in the
             * LICENSE file in the root directory of this source tree.
             */function DT(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case bT:switch(e=e.type){case _T:case kT:case wT:case MT:case IT:return e;default:switch(e=e&&e.$$typeof){case TT:case ST:case CT:case PT:case AT:case ET:return e;default:return t}}case xT:return t}}}yT=Symbol.for("react.module.reference"),vT.ContextConsumer=ST,vT.ContextProvider=ET,vT.Element=bT,vT.ForwardRef=CT,vT.Fragment=_T,vT.Lazy=PT,vT.Memo=AT,vT.Portal=xT,vT.Profiler=kT,vT.StrictMode=wT,vT.Suspense=MT,vT.SuspenseList=IT,vT.isAsyncMode=function(){return!1},vT.isConcurrentMode=function(){return!1},vT.isContextConsumer=function(e){return DT(e)===ST},vT.isContextProvider=function(e){return DT(e)===ET},vT.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===bT},vT.isForwardRef=function(e){return DT(e)===CT},vT.isFragment=function(e){return DT(e)===_T},vT.isLazy=function(e){return DT(e)===PT},vT.isMemo=function(e){return DT(e)===AT},vT.isPortal=function(e){return DT(e)===xT},vT.isProfiler=function(e){return DT(e)===kT},vT.isStrictMode=function(e){return DT(e)===wT},vT.isSuspense=function(e){return DT(e)===MT},vT.isSuspenseList=function(e){return DT(e)===IT},vT.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===_T||e===kT||e===wT||e===MT||e===IT||e===OT||"object"==typeof e&&null!==e&&(e.$$typeof===PT||e.$$typeof===AT||e.$$typeof===ET||e.$$typeof===ST||e.$$typeof===CT||e.$$typeof===yT||void 0!==e.getModuleId)},vT.typeOf=DT;const RT={notify(){},get:()=>[]};function zT(e,t){let n,i=RT;function r(){s.onStateChange&&s.onStateChange()}function o(){n||(n=t?t.addNestedSub(r):e.subscribe(r),i=function(){const e=aT();let t=null,n=null;return{clear(){t=null,n=null},notify(){e((()=>{let e=t;for(;e;)e.callback(),e=e.next}))},get(){let e=[],n=t;for(;n;)e.push(n),n=n.next;return e},subscribe(e){let i=!0,r=n={callback:e,next:null,prev:n};return r.prev?r.prev.next=r:t=r,function(){i&&null!==t&&(i=!1,r.next?r.next.prev=r.prev:n=r.prev,r.prev?r.prev.next=r.next:t=r.next)}}}}())}const s={addNestedSub:function(e){return o(),i.subscribe(e)},notifyNestedSubs:function(){i.notify()},handleChangeWrapper:r,isSubscribed:function(){return Boolean(n)},trySubscribe:o,tryUnsubscribe:function(){n&&(n(),n=void 0,i.clear(),i=RT)},getListeners:()=>i};return s}const LT="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?V.useLayoutEffect:V.useEffect;function BT({store:e,context:t,children:n,serverState:i,stabilityCheck:r="once",noopCheck:o="once"}){const s=V.useMemo((()=>{const t=zT(e);return{store:e,subscription:t,getServerState:i?()=>i:void 0,stabilityCheck:r,noopCheck:o}}),[e,i,r,o]),a=V.useMemo((()=>e.getState()),[e]);LT((()=>{const{subscription:t}=s;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),a!==e.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}}),[s,a]);const l=t||uT;return U.createElement(l.Provider,{value:s},n)}function NT(e=uT){const t=e===uT?hT:dT(e);return function(){const{store:e}=t();return e}}const FT=NT();function $T(e=uT){const t=e===uT?FT:NT(e);return function(){return t().dispatch}}const jT=$T();var VT;(e=>{pT=e})(oT.useSyncExternalStoreWithSelector),VT=ld.unstable_batchedUpdates,sT=VT;const UT=sS({name:"auth",initialState:{interval:null,isInitialized:!1},reducers:{setRefreshInterval:(e,t)=>{e.interval=t.payload},setIsInitialized:(e,t)=>{e.isInitialized=t.payload}}}),{setRefreshInterval:qT,setIsInitialized:GT}=UT.actions,WT=UT.reducer,HT=e=>e.auth.interval,ZT=e=>e.auth.isInitialized,XT=sS({name:"deal",initialState:{dealId:null,deals:{}},reducers:{addDeals:(e,t)=>{t.payload.forEach((t=>{e.deals[t.id]={...e.deals[t.id],...t}}))}}}),{addDeals:KT}=XT.actions,JT=XT.reducer,YT=e=>e.deal.deals,QT=BE(((e,t)=>YT(e)),((e,t)=>t),((e,t)=>e[t])),eC=function(e){var t,n=iS(),i=e||{},r=i.reducer,o=void 0===r?void 0:r,s=i.middleware,a=void 0===s?n():s,l=i.devTools,c=void 0===l||l,u=i.preloadedState,d=void 0===u?void 0:u,h=i.enhancers,p=void 0===h?void 0:h;if("function"==typeof o)t=o;else{if(!function(e){if("object"!=typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}(o))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=AE(o)}var f=a;"function"==typeof f&&(f=f(n));var m=OE.apply(void 0,f),g=PE;c&&(g=QE(JE({trace:!1},"object"==typeof c&&c)));var y=new tS(m),v=y;return Array.isArray(p)?v=UE([m],p):"function"==typeof p&&(v=p(y)),IE(t,d,g.apply(void 0,v))}({reducer:{auth:WT,channel:ES,deal:JT,membership:mS,post:IS,user:zS}}),tC=jT,nC=gT;var iC="Invariant Violation",rC=Object.setPrototypeOf,oC=void 0===rC?function(e,t){return e.__proto__=t,e}:rC,sC=function(e){function t(n){void 0===n&&(n=iC);var i=e.call(this,"number"==typeof n?iC+": "+n+" (see https://github.com/apollographql/invariant-packages)":n)||this;return i.framesToPop=1,i.name=iC,oC(i,t.prototype),i}return ny(t,e),t}(Error);function aC(e,t){if(!e)throw new sC(t)}var lC=["debug","log","warn","error","silent"],cC=lC.indexOf("log");function uC(e){return function(){if(lC.indexOf(e)>=cC)return(console[e]||console.log).apply(console,arguments)}}function dC(e){try{return e()}catch(sP){}}!function(e){e.debug=uC("debug"),e.log=uC("log"),e.warn=uC("warn"),e.error=uC("error")}(aC||(aC={}));const hC=dC((function(){return globalThis}))||dC((function(){return window}))||dC((function(){return self}))||dC((function(){return global}))||dC((function(){return dC.constructor("return this")()}));var pC="__",fC=[pC,pC].join("DEV");const mC=function(){try{return Boolean(__DEV__)}catch(sP){return Object.defineProperty(hC,fC,{value:"production"!==dC((function(){return"production"})),enumerable:!1,configurable:!0,writable:!0}),hC[fC]}}();function gC(e){try{return e()}catch(Fk){}}var yC=gC((function(){return globalThis}))||gC((function(){return window}))||gC((function(){return self}))||gC((function(){return global}))||gC((function(){return gC.constructor("return this")()})),vC=!1;function bC(){vC&&(delete yC.process,vC=!1)}function xC(e,t){if(!Boolean(e))throw new Error(t)}function _C(e,t){if(!Boolean(e))throw new Error(null!=t?t:"Unexpected invariant triggered.")}!yC||gC((function(){return"production"}))||gC((function(){return process}))||(Object.defineProperty(yC,"process",{value:{env:{NODE_ENV:"production"}},configurable:!0,enumerable:!1,writable:!0}),vC=!0);const wC=/\r\n|[\n\r]/g;function kC(e,t){let n=0,i=1;for(const r of e.body.matchAll(wC)){if("number"==typeof r.index||_C(!1),r.index>=t)break;n=r.index+r[0].length,i+=1}return{line:i,column:t+1-n}}function EC(e,t){const n=e.locationOffset.column-1,i="".padStart(n)+e.body,r=t.line-1,o=e.locationOffset.line-1,s=t.line+o,a=1===t.line?n:0,l=t.column+a,c=`${e.name}:${s}:${l}\n`,u=i.split(/\r\n|[\n\r]/g),d=u[r];if(d.length>120){const e=Math.floor(l/80),t=l%80,n=[];for(let i=0;i<d.length;i+=80)n.push(d.slice(i,i+80));return c+SC([[`${s} |`,n[0]],...n.slice(1,e+1).map((e=>["|",e])),["|","^".padStart(t)],["|",n[e+1]]])}return c+SC([[s-1+" |",u[r-1]],[`${s} |`,d],["|","^".padStart(l)],[`${s+1} |`,u[r+1]]])}function SC(e){const t=e.filter((([e,t])=>void 0!==t)),n=Math.max(...t.map((([e])=>e.length)));return t.map((([e,t])=>e.padStart(n)+(t?" "+t:""))).join("\n")}class TC extends Error{constructor(e,...t){var n,i,r;const{nodes:o,source:s,positions:a,path:l,originalError:c,extensions:u}=function(e){const t=e[0];return null==t||"kind"in t||"length"in t?{nodes:t,source:e[1],positions:e[2],path:e[3],originalError:e[4],extensions:e[5]}:t}(t);super(e),this.name="GraphQLError",this.path=null!=l?l:void 0,this.originalError=null!=c?c:void 0,this.nodes=CC(Array.isArray(o)?o:o?[o]:void 0);const d=CC(null===(n=this.nodes)||void 0===n?void 0:n.map((e=>e.loc)).filter((e=>null!=e)));this.source=null!=s?s:null==d||null===(i=d[0])||void 0===i?void 0:i.source,this.positions=null!=a?a:null==d?void 0:d.map((e=>e.start)),this.locations=a&&s?a.map((e=>kC(s,e))):null==d?void 0:d.map((e=>kC(e.source,e.start)));const h="object"==typeof(p=null==c?void 0:c.extensions)&&null!==p?null==c?void 0:c.extensions:void 0;var p;this.extensions=null!==(r=null!=u?u:h)&&void 0!==r?r:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=c&&c.stack?Object.defineProperty(this,"stack",{value:c.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,TC):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const n of this.nodes)n.loc&&(e+="\n\n"+EC((t=n.loc).source,kC(t.source,t.start)));else if(this.source&&this.locations)for(const n of this.locations)e+="\n\n"+EC(this.source,n);var t;return e}toJSON(){const e={message:this.message};return null!=this.locations&&(e.locations=this.locations),null!=this.path&&(e.path=this.path),null!=this.extensions&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function CC(e){return void 0===e||0===e.length?void 0:e}function MC(e,t,n){return new TC(`Syntax Error: ${n}`,{source:e,positions:[t]})}class IC{constructor(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class AC{constructor(e,t,n,i,r,o){this.kind=e,this.start=t,this.end=n,this.line=i,this.column=r,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const PC={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},OC=new Set(Object.keys(PC));function DC(e){const t=null==e?void 0:e.kind;return"string"==typeof t&&OC.has(t)}var RC,zC,LC,BC;function NC(e){return 9===e||32===e}function FC(e){return e>=48&&e<=57}function $C(e){return e>=97&&e<=122||e>=65&&e<=90}function jC(e){return $C(e)||95===e}function VC(e){return $C(e)||FC(e)||95===e}function UC(e){var t;let n=Number.MAX_SAFE_INTEGER,i=null,r=-1;for(let s=0;s<e.length;++s){var o;const t=e[s],a=qC(t);a!==t.length&&(i=null!==(o=i)&&void 0!==o?o:s,r=s,0!==s&&a<n&&(n=a))}return e.map(((e,t)=>0===t?e:e.slice(n))).slice(null!==(t=i)&&void 0!==t?t:0,r+1)}function qC(e){let t=0;for(;t<e.length&&NC(e.charCodeAt(t));)++t;return t}!function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(RC||(RC={})),function(e){e.QUERY="QUERY",e.MUTATION="MUTATION",e.SUBSCRIPTION="SUBSCRIPTION",e.FIELD="FIELD",e.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",e.FRAGMENT_SPREAD="FRAGMENT_SPREAD",e.INLINE_FRAGMENT="INLINE_FRAGMENT",e.VARIABLE_DEFINITION="VARIABLE_DEFINITION",e.SCHEMA="SCHEMA",e.SCALAR="SCALAR",e.OBJECT="OBJECT",e.FIELD_DEFINITION="FIELD_DEFINITION",e.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",e.INTERFACE="INTERFACE",e.UNION="UNION",e.ENUM="ENUM",e.ENUM_VALUE="ENUM_VALUE",e.INPUT_OBJECT="INPUT_OBJECT",e.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"}(zC||(zC={})),function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(LC||(LC={})),function(e){e.SOF="<SOF>",e.EOF="<EOF>",e.BANG="!",e.DOLLAR="$",e.AMP="&",e.PAREN_L="(",e.PAREN_R=")",e.SPREAD="...",e.COLON=":",e.EQUALS="=",e.AT="@",e.BRACKET_L="[",e.BRACKET_R="]",e.BRACE_L="{",e.PIPE="|",e.BRACE_R="}",e.NAME="Name",e.INT="Int",e.FLOAT="Float",e.STRING="String",e.BLOCK_STRING="BlockString",e.COMMENT="Comment"}(BC||(BC={}));class GC{constructor(e){const t=new AC(BC.SOF,0,0,0,0);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==BC.EOF)do{if(e.next)e=e.next;else{const t=YC(this,e.end);e.next=t,t.prev=e,e=t}}while(e.kind===BC.COMMENT);return e}}function WC(e){return e>=0&&e<=55295||e>=57344&&e<=1114111}function HC(e,t){return ZC(e.charCodeAt(t))&&XC(e.charCodeAt(t+1))}function ZC(e){return e>=55296&&e<=56319}function XC(e){return e>=56320&&e<=57343}function KC(e,t){const n=e.source.body.codePointAt(t);if(void 0===n)return BC.EOF;if(n>=32&&n<=126){const e=String.fromCodePoint(n);return'"'===e?"'\"'":`"${e}"`}return"U+"+n.toString(16).toUpperCase().padStart(4,"0")}function JC(e,t,n,i,r){const o=e.line,s=1+n-e.lineStart;return new AC(t,n,i,o,s,r)}function YC(e,t){const n=e.source.body,i=n.length;let r=t;for(;r<i;){const t=n.charCodeAt(r);switch(t){case 65279:case 9:case 32:case 44:++r;continue;case 10:++r,++e.line,e.lineStart=r;continue;case 13:10===n.charCodeAt(r+1)?r+=2:++r,++e.line,e.lineStart=r;continue;case 35:return QC(e,r);case 33:return JC(e,BC.BANG,r,r+1);case 36:return JC(e,BC.DOLLAR,r,r+1);case 38:return JC(e,BC.AMP,r,r+1);case 40:return JC(e,BC.PAREN_L,r,r+1);case 41:return JC(e,BC.PAREN_R,r,r+1);case 46:if(46===n.charCodeAt(r+1)&&46===n.charCodeAt(r+2))return JC(e,BC.SPREAD,r,r+3);break;case 58:return JC(e,BC.COLON,r,r+1);case 61:return JC(e,BC.EQUALS,r,r+1);case 64:return JC(e,BC.AT,r,r+1);case 91:return JC(e,BC.BRACKET_L,r,r+1);case 93:return JC(e,BC.BRACKET_R,r,r+1);case 123:return JC(e,BC.BRACE_L,r,r+1);case 124:return JC(e,BC.PIPE,r,r+1);case 125:return JC(e,BC.BRACE_R,r,r+1);case 34:return 34===n.charCodeAt(r+1)&&34===n.charCodeAt(r+2)?lM(e,r):nM(e,r)}if(FC(t)||45===t)return eM(e,r,t);if(jC(t))return cM(e,r);throw MC(e.source,r,39===t?"Unexpected single quote character ('), did you mean to use a double quote (\")?":WC(t)||HC(n,r)?`Unexpected character: ${KC(e,r)}.`:`Invalid character: ${KC(e,r)}.`)}return JC(e,BC.EOF,i,i)}function QC(e,t){const n=e.source.body,i=n.length;let r=t+1;for(;r<i;){const e=n.charCodeAt(r);if(10===e||13===e)break;if(WC(e))++r;else{if(!HC(n,r))break;r+=2}}return JC(e,BC.COMMENT,t,r,n.slice(t+1,r))}function eM(e,t,n){const i=e.source.body;let r=t,o=n,s=!1;if(45===o&&(o=i.charCodeAt(++r)),48===o){if(o=i.charCodeAt(++r),FC(o))throw MC(e.source,r,`Invalid number, unexpected digit after 0: ${KC(e,r)}.`)}else r=tM(e,r,o),o=i.charCodeAt(r);if(46===o&&(s=!0,o=i.charCodeAt(++r),r=tM(e,r,o),o=i.charCodeAt(r)),69!==o&&101!==o||(s=!0,o=i.charCodeAt(++r),43!==o&&45!==o||(o=i.charCodeAt(++r)),r=tM(e,r,o),o=i.charCodeAt(r)),46===o||jC(o))throw MC(e.source,r,`Invalid number, expected digit but got: ${KC(e,r)}.`);return JC(e,s?BC.FLOAT:BC.INT,t,r,i.slice(t,r))}function tM(e,t,n){if(!FC(n))throw MC(e.source,t,`Invalid number, expected digit but got: ${KC(e,t)}.`);const i=e.source.body;let r=t+1;for(;FC(i.charCodeAt(r));)++r;return r}function nM(e,t){const n=e.source.body,i=n.length;let r=t+1,o=r,s="";for(;r<i;){const i=n.charCodeAt(r);if(34===i)return s+=n.slice(o,r),JC(e,BC.STRING,t,r+1,s);if(92!==i){if(10===i||13===i)break;if(WC(i))++r;else{if(!HC(n,r))throw MC(e.source,r,`Invalid character within String: ${KC(e,r)}.`);r+=2}}else{s+=n.slice(o,r);const t=117===n.charCodeAt(r+1)?123===n.charCodeAt(r+2)?iM(e,r):rM(e,r):aM(e,r);s+=t.value,r+=t.size,o=r}}throw MC(e.source,r,"Unterminated string.")}function iM(e,t){const n=e.source.body;let i=0,r=3;for(;r<12;){const e=n.charCodeAt(t+r++);if(125===e){if(r<5||!WC(i))break;return{value:String.fromCodePoint(i),size:r}}if(i=i<<4|sM(e),i<0)break}throw MC(e.source,t,`Invalid Unicode escape sequence: "${n.slice(t,t+r)}".`)}function rM(e,t){const n=e.source.body,i=oM(n,t+2);if(WC(i))return{value:String.fromCodePoint(i),size:6};if(ZC(i)&&92===n.charCodeAt(t+6)&&117===n.charCodeAt(t+7)){const e=oM(n,t+8);if(XC(e))return{value:String.fromCodePoint(i,e),size:12}}throw MC(e.source,t,`Invalid Unicode escape sequence: "${n.slice(t,t+6)}".`)}function oM(e,t){return sM(e.charCodeAt(t))<<12|sM(e.charCodeAt(t+1))<<8|sM(e.charCodeAt(t+2))<<4|sM(e.charCodeAt(t+3))}function sM(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function aM(e,t){const n=e.source.body;switch(n.charCodeAt(t+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:"\n",size:2};case 114:return{value:"\r",size:2};case 116:return{value:"\t",size:2}}throw MC(e.source,t,`Invalid character escape sequence: "${n.slice(t,t+2)}".`)}function lM(e,t){const n=e.source.body,i=n.length;let r=e.lineStart,o=t+3,s=o,a="";const l=[];for(;o<i;){const i=n.charCodeAt(o);if(34===i&&34===n.charCodeAt(o+1)&&34===n.charCodeAt(o+2)){a+=n.slice(s,o),l.push(a);const i=JC(e,BC.BLOCK_STRING,t,o+3,UC(l).join("\n"));return e.line+=l.length-1,e.lineStart=r,i}if(92!==i||34!==n.charCodeAt(o+1)||34!==n.charCodeAt(o+2)||34!==n.charCodeAt(o+3))if(10!==i&&13!==i)if(WC(i))++o;else{if(!HC(n,o))throw MC(e.source,o,`Invalid character within String: ${KC(e,o)}.`);o+=2}else a+=n.slice(s,o),l.push(a),13===i&&10===n.charCodeAt(o+1)?o+=2:++o,a="",s=o,r=o;else a+=n.slice(s,o),s=o+1,o+=4}throw MC(e.source,o,"Unterminated string.")}function cM(e,t){const n=e.source.body,i=n.length;let r=t+1;for(;r<i&&VC(n.charCodeAt(r));)++r;return JC(e,BC.NAME,t,r,n.slice(t,r))}const uM=10,dM=2;function hM(e){return pM(e,[])}function pM(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){if(null===e)return"null";if(t.includes(e))return"[Circular]";const n=[...t,e];if(function(e){return"function"==typeof e.toJSON}(e)){const t=e.toJSON();if(t!==e)return"string"==typeof t?t:pM(t,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>dM)return"[Array]";const n=Math.min(uM,e.length),i=e.length-n,r=[];for(let o=0;o<n;++o)r.push(pM(e[o],t));return 1===i?r.push("... 1 more item"):i>1&&r.push(`... ${i} more items`),"["+r.join(", ")+"]"}(e,n);return function(e,t){const n=Object.entries(e);if(0===n.length)return"{}";if(t.length>dM)return"["+function(e){const t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){const t=e.constructor.name;if("string"==typeof t&&""!==t)return t}return t}(e)+"]";const i=n.map((([e,n])=>e+": "+pM(n,t)));return"{ "+i.join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}class fM{constructor(e,t="GraphQL request",n={line:1,column:1}){"string"==typeof e||xC(!1,`Body must be a string. Received: ${hM(e)}.`),this.body=e,this.name=t,this.locationOffset=n,this.locationOffset.line>0||xC(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||xC(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}class mM{constructor(e,t={}){const n=function(e){return e instanceof fM}(e)?e:new fM(e);this._lexer=new GC(n),this._options=t,this._tokenCounter=0}parseName(){const e=this.expectToken(BC.NAME);return this.node(e,{kind:LC.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:LC.DOCUMENT,definitions:this.many(BC.SOF,this.parseDefinition,BC.EOF)})}parseDefinition(){if(this.peek(BC.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),t=e?this._lexer.lookahead():this._lexer.token;if(t.kind===BC.NAME){switch(t.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw MC(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(t.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(t)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(BC.BRACE_L))return this.node(e,{kind:LC.OPERATION_DEFINITION,operation:RC.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const t=this.parseOperationType();let n;return this.peek(BC.NAME)&&(n=this.parseName()),this.node(e,{kind:LC.OPERATION_DEFINITION,operation:t,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(BC.NAME);switch(e.value){case"query":return RC.QUERY;case"mutation":return RC.MUTATION;case"subscription":return RC.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(BC.PAREN_L,this.parseVariableDefinition,BC.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:LC.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(BC.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(BC.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(BC.DOLLAR),this.node(e,{kind:LC.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:LC.SELECTION_SET,selections:this.many(BC.BRACE_L,this.parseSelection,BC.BRACE_R)})}parseSelection(){return this.peek(BC.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,t=this.parseName();let n,i;return this.expectOptionalToken(BC.COLON)?(n=t,i=this.parseName()):i=t,this.node(e,{kind:LC.FIELD,alias:n,name:i,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(BC.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(BC.PAREN_L,t,BC.PAREN_R)}parseArgument(e=!1){const t=this._lexer.token,n=this.parseName();return this.expectToken(BC.COLON),this.node(t,{kind:LC.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(BC.SPREAD);const t=this.expectOptionalKeyword("on");return!t&&this.peek(BC.NAME)?this.node(e,{kind:LC.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:LC.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),!0===this._options.allowLegacyFragmentVariables?this.node(e,{kind:LC.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:LC.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()}parseValueLiteral(e){const t=this._lexer.token;switch(t.kind){case BC.BRACKET_L:return this.parseList(e);case BC.BRACE_L:return this.parseObject(e);case BC.INT:return this.advanceLexer(),this.node(t,{kind:LC.INT,value:t.value});case BC.FLOAT:return this.advanceLexer(),this.node(t,{kind:LC.FLOAT,value:t.value});case BC.STRING:case BC.BLOCK_STRING:return this.parseStringLiteral();case BC.NAME:switch(this.advanceLexer(),t.value){case"true":return this.node(t,{kind:LC.BOOLEAN,value:!0});case"false":return this.node(t,{kind:LC.BOOLEAN,value:!1});case"null":return this.node(t,{kind:LC.NULL});default:return this.node(t,{kind:LC.ENUM,value:t.value})}case BC.DOLLAR:if(e){if(this.expectToken(BC.DOLLAR),this._lexer.token.kind===BC.NAME){const e=this._lexer.token.value;throw MC(this._lexer.source,t.start,`Unexpected variable "$${e}" in constant value.`)}throw this.unexpected(t)}return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:LC.STRING,value:e.value,block:e.kind===BC.BLOCK_STRING})}parseList(e){return this.node(this._lexer.token,{kind:LC.LIST,values:this.any(BC.BRACKET_L,(()=>this.parseValueLiteral(e)),BC.BRACKET_R)})}parseObject(e){return this.node(this._lexer.token,{kind:LC.OBJECT,fields:this.any(BC.BRACE_L,(()=>this.parseObjectField(e)),BC.BRACE_R)})}parseObjectField(e){const t=this._lexer.token,n=this.parseName();return this.expectToken(BC.COLON),this.node(t,{kind:LC.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const t=[];for(;this.peek(BC.AT);)t.push(this.parseDirective(e));return t}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const t=this._lexer.token;return this.expectToken(BC.AT),this.node(t,{kind:LC.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let t;if(this.expectOptionalToken(BC.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(BC.BRACKET_R),t=this.node(e,{kind:LC.LIST_TYPE,type:n})}else t=this.parseNamedType();return this.expectOptionalToken(BC.BANG)?this.node(e,{kind:LC.NON_NULL_TYPE,type:t}):t}parseNamedType(){return this.node(this._lexer.token,{kind:LC.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(BC.STRING)||this.peek(BC.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),i=this.many(BC.BRACE_L,this.parseOperationTypeDefinition,BC.BRACE_R);return this.node(e,{kind:LC.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:i})}parseOperationTypeDefinition(){const e=this._lexer.token,t=this.parseOperationType();this.expectToken(BC.COLON);const n=this.parseNamedType();return this.node(e,{kind:LC.OPERATION_TYPE_DEFINITION,operation:t,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),i=this.parseConstDirectives();return this.node(e,{kind:LC.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:i})}parseObjectTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),i=this.parseImplementsInterfaces(),r=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:LC.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:i,directives:r,fields:o})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(BC.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(BC.BRACE_L,this.parseFieldDefinition,BC.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),i=this.parseArgumentDefs();this.expectToken(BC.COLON);const r=this.parseTypeReference(),o=this.parseConstDirectives();return this.node(e,{kind:LC.FIELD_DEFINITION,description:t,name:n,arguments:i,type:r,directives:o})}parseArgumentDefs(){return this.optionalMany(BC.PAREN_L,this.parseInputValueDef,BC.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(BC.COLON);const i=this.parseTypeReference();let r;this.expectOptionalToken(BC.EQUALS)&&(r=this.parseConstValueLiteral());const o=this.parseConstDirectives();return this.node(e,{kind:LC.INPUT_VALUE_DEFINITION,description:t,name:n,type:i,defaultValue:r,directives:o})}parseInterfaceTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),i=this.parseImplementsInterfaces(),r=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:LC.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:i,directives:r,fields:o})}parseUnionTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),i=this.parseConstDirectives(),r=this.parseUnionMemberTypes();return this.node(e,{kind:LC.UNION_TYPE_DEFINITION,description:t,name:n,directives:i,types:r})}parseUnionMemberTypes(){return this.expectOptionalToken(BC.EQUALS)?this.delimitedMany(BC.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),i=this.parseConstDirectives(),r=this.parseEnumValuesDefinition();return this.node(e,{kind:LC.ENUM_TYPE_DEFINITION,description:t,name:n,directives:i,values:r})}parseEnumValuesDefinition(){return this.optionalMany(BC.BRACE_L,this.parseEnumValueDefinition,BC.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseEnumValueName(),i=this.parseConstDirectives();return this.node(e,{kind:LC.ENUM_VALUE_DEFINITION,description:t,name:n,directives:i})}parseEnumValueName(){if("true"===this._lexer.token.value||"false"===this._lexer.token.value||"null"===this._lexer.token.value)throw MC(this._lexer.source,this._lexer.token.start,`${gM(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),i=this.parseConstDirectives(),r=this.parseInputFieldsDefinition();return this.node(e,{kind:LC.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:i,fields:r})}parseInputFieldsDefinition(){return this.optionalMany(BC.BRACE_L,this.parseInputValueDef,BC.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===BC.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const t=this.parseConstDirectives(),n=this.optionalMany(BC.BRACE_L,this.parseOperationTypeDefinition,BC.BRACE_R);if(0===t.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:LC.SCHEMA_EXTENSION,directives:t,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const t=this.parseName(),n=this.parseConstDirectives();if(0===n.length)throw this.unexpected();return this.node(e,{kind:LC.SCALAR_TYPE_EXTENSION,name:t,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const t=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),r=this.parseFieldsDefinition();if(0===n.length&&0===i.length&&0===r.length)throw this.unexpected();return this.node(e,{kind:LC.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:i,fields:r})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const t=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),r=this.parseFieldsDefinition();if(0===n.length&&0===i.length&&0===r.length)throw this.unexpected();return this.node(e,{kind:LC.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:i,fields:r})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const t=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();if(0===n.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:LC.UNION_TYPE_EXTENSION,name:t,directives:n,types:i})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const t=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();if(0===n.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:LC.ENUM_TYPE_EXTENSION,name:t,directives:n,values:i})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const t=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();if(0===n.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:LC.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:i})}parseDirectiveDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(BC.AT);const n=this.parseName(),i=this.parseArgumentDefs(),r=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const o=this.parseDirectiveLocations();return this.node(e,{kind:LC.DIRECTIVE_DEFINITION,description:t,name:n,arguments:i,repeatable:r,locations:o})}parseDirectiveLocations(){return this.delimitedMany(BC.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,t=this.parseName();if(Object.prototype.hasOwnProperty.call(zC,t.value))return t;throw this.unexpected(e)}node(e,t){return!0!==this._options.noLocation&&(t.loc=new IC(e,this._lexer.lastToken,this._lexer.source)),t}peek(e){return this._lexer.token.kind===e}expectToken(e){const t=this._lexer.token;if(t.kind===e)return this.advanceLexer(),t;throw MC(this._lexer.source,t.start,`Expected ${yM(e)}, found ${gM(t)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e&&(this.advanceLexer(),!0)}expectKeyword(e){const t=this._lexer.token;if(t.kind!==BC.NAME||t.value!==e)throw MC(this._lexer.source,t.start,`Expected "${e}", found ${gM(t)}.`);this.advanceLexer()}expectOptionalKeyword(e){const t=this._lexer.token;return t.kind===BC.NAME&&t.value===e&&(this.advanceLexer(),!0)}unexpected(e){const t=null!=e?e:this._lexer.token;return MC(this._lexer.source,t.start,`Unexpected ${gM(t)}.`)}any(e,t,n){this.expectToken(e);const i=[];for(;!this.expectOptionalToken(n);)i.push(t.call(this));return i}optionalMany(e,t,n){if(this.expectOptionalToken(e)){const e=[];do{e.push(t.call(this))}while(!this.expectOptionalToken(n));return e}return[]}many(e,t,n){this.expectToken(e);const i=[];do{i.push(t.call(this))}while(!this.expectOptionalToken(n));return i}delimitedMany(e,t){this.expectOptionalToken(e);const n=[];do{n.push(t.call(this))}while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,t=this._lexer.advance();if(void 0!==e&&t.kind!==BC.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw MC(this._lexer.source,t.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function gM(e){const t=e.value;return yM(e.kind)+(null!=t?` "${t}"`:"")}function yM(e){return function(e){return e===BC.BANG||e===BC.DOLLAR||e===BC.AMP||e===BC.PAREN_L||e===BC.PAREN_R||e===BC.SPREAD||e===BC.COLON||e===BC.EQUALS||e===BC.AT||e===BC.BRACKET_L||e===BC.BRACKET_R||e===BC.BRACE_L||e===BC.PIPE||e===BC.BRACE_R}(e)?`"${e}"`:e}const vM=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function bM(e){return xM[e.charCodeAt(0)]}const xM=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],_M=Object.freeze({});function wM(e,t,n=PC){const i=new Map;for(const y of Object.values(LC))i.set(y,kM(t,y));let r,o,s,a=Array.isArray(e),l=[e],c=-1,u=[],d=e;const h=[],p=[];do{c++;const e=c===l.length,y=e&&0!==u.length;if(e){if(o=0===p.length?void 0:h[h.length-1],d=s,s=p.pop(),y)if(a){d=d.slice();let e=0;for(const[t,n]of u){const i=t-e;null===n?(d.splice(i,1),e++):d[i]=n}}else{d=Object.defineProperties({},Object.getOwnPropertyDescriptors(d));for(const[e,t]of u)d[e]=t}c=r.index,l=r.keys,u=r.edits,a=r.inArray,r=r.prev}else if(s){if(o=a?c:l[c],d=s[o],null==d)continue;h.push(o)}let v;if(!Array.isArray(d)){var f,m;DC(d)||xC(!1,`Invalid AST Node: ${hM(d)}.`);const n=e?null===(f=i.get(d.kind))||void 0===f?void 0:f.leave:null===(m=i.get(d.kind))||void 0===m?void 0:m.enter;if(v=null==n?void 0:n.call(t,d,o,s,h,p),v===_M)break;if(!1===v){if(!e){h.pop();continue}}else if(void 0!==v&&(u.push([o,v]),!e)){if(!DC(v)){h.pop();continue}d=v}}var g;void 0===v&&y&&u.push([o,d]),e?h.pop():(r={inArray:a,index:c,keys:l,edits:u,prev:r},a=Array.isArray(d),l=a?d:null!==(g=n[d.kind])&&void 0!==g?g:[],c=-1,u=[],s&&p.push(s),s=d)}while(void 0!==r);return 0!==u.length?u[u.length-1][1]:e}function kM(e,t){const n=e[t];return"object"==typeof n?n:"function"==typeof n?{enter:n,leave:void 0}:{enter:e.enter,leave:e.leave}}function EM(e){return wM(e,SM)}const SM={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>TM(e.definitions,"\n\n")},OperationDefinition:{leave(e){const t=MM("(",TM(e.variableDefinitions,", "),")"),n=TM([e.operation,TM([e.name,t]),TM(e.directives," ")]," ");return("query"===n?"":n+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:n,directives:i})=>e+": "+t+MM(" = ",n)+MM(" ",TM(i," "))},SelectionSet:{leave:({selections:e})=>CM(e)},Field:{leave({alias:e,name:t,arguments:n,directives:i,selectionSet:r}){const o=MM("",e,": ")+t;let s=o+MM("(",TM(n,", "),")");return s.length>80&&(s=o+MM("(\n",IM(TM(n,"\n")),"\n)")),TM([s,TM(i," "),r]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+MM(" ",TM(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:n})=>TM(["...",MM("on ",e),TM(t," "),n]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:n,directives:i,selectionSet:r})=>`fragment ${e}${MM("(",TM(n,", "),")")} on ${t} ${MM("",TM(i," ")," ")}`+r},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>t?function(e,t){const n=e.replace(/"""/g,'\\"""'),i=n.split(/\r\n|[\n\r]/g),r=1===i.length,o=i.length>1&&i.slice(1).every((e=>0===e.length||NC(e.charCodeAt(0)))),s=n.endsWith('\\"""'),a=e.endsWith('"')&&!s,l=e.endsWith("\\"),c=a||l,u=!(null!=t&&t.minimize)&&(!r||e.length>70||c||o||s);let d="";const h=r&&NC(e.charCodeAt(0));return(u&&!h||o)&&(d+="\n"),d+=n,(u||c)&&(d+="\n"),'"""'+d+'"""'}(e):`"${e.replace(vM,bM)}"`},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+TM(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+TM(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+MM("(",TM(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:t,operationTypes:n})=>MM("",e,"\n")+TM(["schema",TM(t," "),CM(n)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({description:e,name:t,directives:n})=>MM("",e,"\n")+TM(["scalar",t,TM(n," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:i,fields:r})=>MM("",e,"\n")+TM(["type",t,MM("implements ",TM(n," & ")),TM(i," "),CM(r)]," ")},FieldDefinition:{leave:({description:e,name:t,arguments:n,type:i,directives:r})=>MM("",e,"\n")+t+(AM(n)?MM("(\n",IM(TM(n,"\n")),"\n)"):MM("(",TM(n,", "),")"))+": "+i+MM(" ",TM(r," "))},InputValueDefinition:{leave:({description:e,name:t,type:n,defaultValue:i,directives:r})=>MM("",e,"\n")+TM([t+": "+n,MM("= ",i),TM(r," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:t,interfaces:n,directives:i,fields:r})=>MM("",e,"\n")+TM(["interface",t,MM("implements ",TM(n," & ")),TM(i," "),CM(r)]," ")},UnionTypeDefinition:{leave:({description:e,name:t,directives:n,types:i})=>MM("",e,"\n")+TM(["union",t,TM(n," "),MM("= ",TM(i," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:t,directives:n,values:i})=>MM("",e,"\n")+TM(["enum",t,TM(n," "),CM(i)]," ")},EnumValueDefinition:{leave:({description:e,name:t,directives:n})=>MM("",e,"\n")+TM([t,TM(n," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:t,directives:n,fields:i})=>MM("",e,"\n")+TM(["input",t,TM(n," "),CM(i)]," ")},DirectiveDefinition:{leave:({description:e,name:t,arguments:n,repeatable:i,locations:r})=>MM("",e,"\n")+"directive @"+t+(AM(n)?MM("(\n",IM(TM(n,"\n")),"\n)"):MM("(",TM(n,", "),")"))+(i?" repeatable":"")+" on "+TM(r," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>TM(["extend schema",TM(e," "),CM(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>TM(["extend scalar",e,TM(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:i})=>TM(["extend type",e,MM("implements ",TM(t," & ")),TM(n," "),CM(i)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:n,fields:i})=>TM(["extend interface",e,MM("implements ",TM(t," & ")),TM(n," "),CM(i)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:n})=>TM(["extend union",e,TM(t," "),MM("= ",TM(n," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:n})=>TM(["extend enum",e,TM(t," "),CM(n)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:n})=>TM(["extend input",e,TM(t," "),CM(n)]," ")}};function TM(e,t=""){var n;return null!==(n=null==e?void 0:e.filter((e=>e)).join(t))&&void 0!==n?n:""}function CM(e){return MM("{\n",IM(TM(e,"\n")),"\n}")}function MM(e,t,n=""){return null!=t&&""!==t?e+t+n:""}function IM(e){return MM("  ",e.replace(/\n/g,"\n  "))}function AM(e){var t;return null!==(t=null==e?void 0:e.some((e=>e.includes("\n"))))&&void 0!==t&&t}function PM(e){return e.kind===LC.FIELD||e.kind===LC.FRAGMENT_SPREAD||e.kind===LC.INLINE_FRAGMENT}function OM(e,t){var n=e.directives;return!n||!n.length||function(e){var t=[];return e&&e.length&&e.forEach((function(e){if(function(e){var t=e.name.value;return"skip"===t||"include"===t}(e)){var n=e.arguments,i=e.name.value;__DEV__?aC(n&&1===n.length,"Incorrect number of arguments for the @".concat(i," directive.")):aC(n&&1===n.length,41);var r=n[0];__DEV__?aC(r.name&&"if"===r.name.value,"Invalid argument for the @".concat(i," directive.")):aC(r.name&&"if"===r.name.value,42);var o=r.value;__DEV__?aC(o&&("Variable"===o.kind||"BooleanValue"===o.kind),"Argument for the @".concat(i," directive must be a variable or a boolean value.")):aC(o&&("Variable"===o.kind||"BooleanValue"===o.kind),43),t.push({directive:e,ifArgument:r})}})),t}(n).every((function(e){var n=e.directive,i=e.ifArgument,r=!1;return"Variable"===i.value.kind?(r=t&&t[i.value.name.value],__DEV__?aC(void 0!==r,"Invalid variable referenced in @".concat(n.name.value," directive.")):aC(void 0!==r,40)):r=i.value.value,"skip"===n.name.value?!r:r}))}function DM(e,t,n){var i=new Set(e),r=i.size;return wM(t,{Directive:function(e){if(i.delete(e.name.value)&&(!n||!i.size))return _M}}),n?!i.size:i.size<r}function RM(e){return e&&DM(["client","export"],e,!0)}function zM(e,t){var n=t,i=[];return e.definitions.forEach((function(e){if("OperationDefinition"===e.kind)throw __DEV__?new sC("Found a ".concat(e.operation," operation").concat(e.name?" named '".concat(e.name.value,"'"):"",". ")+"No operations are allowed when using a fragment as a query. Only fragments are allowed."):new sC(44);"FragmentDefinition"===e.kind&&i.push(e)})),void 0===n&&(__DEV__?aC(1===i.length,"Found ".concat(i.length," fragments. `fragmentName` must be provided when there is not exactly 1 fragment.")):aC(1===i.length,45),n=i[0].name.value),iy(iy({},e),{definitions:ay([{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:n}}]}}],e.definitions,!0)})}function LM(e){void 0===e&&(e=[]);var t={};return e.forEach((function(e){t[e.name.value]=e})),t}function BM(e,t){switch(e.kind){case"InlineFragment":return e;case"FragmentSpread":var n=e.name.value;if("function"==typeof t)return t(n);var i=t&&t[n];return __DEV__?aC(i,"No fragment named ".concat(n)):aC(i,46),i||null;default:return null}}function NM(e){return null!==e&&"object"==typeof e}function FM(e){return{__ref:String(e)}}function $M(e){return Boolean(e&&"object"==typeof e&&"string"==typeof e.__ref)}function jM(e,t,n,i){if(function(e){return"IntValue"===e.kind}(n)||function(e){return"FloatValue"===e.kind}(n))e[t.value]=Number(n.value);else if(function(e){return"BooleanValue"===e.kind}(n)||function(e){return"StringValue"===e.kind}(n))e[t.value]=n.value;else if(function(e){return"ObjectValue"===e.kind}(n)){var r={};n.fields.map((function(e){return jM(r,e.name,e.value,i)})),e[t.value]=r}else if(function(e){return"Variable"===e.kind}(n)){var o=(i||{})[n.name.value];e[t.value]=o}else if(function(e){return"ListValue"===e.kind}(n))e[t.value]=n.values.map((function(e){var n={};return jM(n,t,e,i),n[t.value]}));else if(function(e){return"EnumValue"===e.kind}(n))e[t.value]=n.value;else{if(!function(e){return"NullValue"===e.kind}(n))throw __DEV__?new sC('The inline argument "'.concat(t.value,'" of kind "').concat(n.kind,'"')+"is not supported. Use variables instead of inline arguments to overcome this limitation."):new sC(55);e[t.value]=null}}bC(),__DEV__?aC("boolean"==typeof mC,mC):aC("boolean"==typeof mC,39);var VM=["connection","include","skip","client","rest","export"],UM=Object.assign((function(e,t,n){if(t&&n&&n.connection&&n.connection.key){if(n.connection.filter&&n.connection.filter.length>0){var i=n.connection.filter?n.connection.filter:[];i.sort();var r={};return i.forEach((function(e){r[e]=t[e]})),"".concat(n.connection.key,"(").concat(qM(r),")")}return n.connection.key}var o=e;if(t){var s=qM(t);o+="(".concat(s,")")}return n&&Object.keys(n).forEach((function(e){-1===VM.indexOf(e)&&(n[e]&&Object.keys(n[e]).length?o+="@".concat(e,"(").concat(qM(n[e]),")"):o+="@".concat(e))})),o}),{setStringify:function(e){var t=qM;return qM=e,t}}),qM=function(e){return JSON.stringify(e,GM)};function GM(e,t){return NM(t)&&!Array.isArray(t)&&(t=Object.keys(t).sort().reduce((function(e,n){return e[n]=t[n],e}),{})),t}function WM(e,t){if(e.arguments&&e.arguments.length){var n={};return e.arguments.forEach((function(e){var i=e.name,r=e.value;return jM(n,i,r,t)})),n}return null}function HM(e){return e.alias?e.alias.value:e.name.value}function ZM(e,t,n){for(var i,r=0,o=t.selections;r<o.length;r++)if(XM(l=o[r])){if("__typename"===l.name.value)return e[HM(l)]}else i?i.push(l):i=[l];if("string"==typeof e.__typename)return e.__typename;if(i)for(var s=0,a=i;s<a.length;s++){var l,c=ZM(e,BM(l=a[s],n).selectionSet,n);if("string"==typeof c)return c}}function XM(e){return"Field"===e.kind}function KM(e){__DEV__?aC(e&&"Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'):aC(e&&"Document"===e.kind,47);var t=e.definitions.filter((function(e){return"FragmentDefinition"!==e.kind})).map((function(e){if("OperationDefinition"!==e.kind)throw __DEV__?new sC('Schema type definitions not allowed in queries. Found: "'.concat(e.kind,'"')):new sC(48);return e}));return __DEV__?aC(t.length<=1,"Ambiguous GraphQL document: contains ".concat(t.length," operations")):aC(t.length<=1,49),e}function JM(e){return KM(e),e.definitions.filter((function(e){return"OperationDefinition"===e.kind}))[0]}function YM(e){return e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&!!e.name})).map((function(e){return e.name.value}))[0]||null}function QM(e){return e.definitions.filter((function(e){return"FragmentDefinition"===e.kind}))}function eI(e){var t=JM(e);return __DEV__?aC(t&&"query"===t.operation,"Must contain a query definition."):aC(t&&"query"===t.operation,50),t}function tI(e){var t;KM(e);for(var n=0,i=e.definitions;n<i.length;n++){var r=i[n];if("OperationDefinition"===r.kind){var o=r.operation;if("query"===o||"mutation"===o||"subscription"===o)return r}"FragmentDefinition"!==r.kind||t||(t=r)}if(t)return t;throw __DEV__?new sC("Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment."):new sC(54)}function nI(e){var t=Object.create(null),n=e&&e.variableDefinitions;return n&&n.length&&n.forEach((function(e){e.defaultValue&&jM(t,e.variable.name,e.defaultValue)})),t}var iI=Array.isArray;function rI(e){return Array.isArray(e)&&e.length>0}var oI={kind:LC.FIELD,name:{kind:LC.NAME,value:"__typename"}};function sI(e,t){return!e||e.selectionSet.selections.every((function(e){return e.kind===LC.FRAGMENT_SPREAD&&sI(t[e.name.value],t)}))}function aI(e){return sI(JM(e)||function(e){__DEV__?aC("Document"===e.kind,'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'):aC("Document"===e.kind,51),__DEV__?aC(e.definitions.length<=1,"Fragment must have exactly one definition."):aC(e.definitions.length<=1,52);var t=e.definitions[0];return __DEV__?aC("FragmentDefinition"===t.kind,"Must be a fragment definition."):aC("FragmentDefinition"===t.kind,53),t}(e),LM(QM(e)))?null:e}function lI(e){var t=new Map;return function(n){void 0===n&&(n=e);var i=t.get(n);return i||t.set(n,i={variables:new Set,fragmentSpreads:new Set}),i}}function cI(e,t){for(var n=lI(""),i=lI(""),r=function(e){for(var t=0,r=void 0;t<e.length&&(r=e[t]);++t)if(!iI(r)){if(r.kind===LC.OPERATION_DEFINITION)return n(r.name&&r.name.value);if(r.kind===LC.FRAGMENT_DEFINITION)return i(r.name.value)}return __DEV__&&aC.error("Could not find operation or fragment"),null},o=0,s=t.definitions.length-1;s>=0;--s)t.definitions[s].kind===LC.OPERATION_DEFINITION&&++o;var a=function(e){var t=new Set,n=[];return e.forEach((function(e){e.name?t.add(e.name):e.test&&n.push(e.test)})),function(e){return t.has(e.name.value)||n.some((function(t){return t(e)}))}}(e),l=e.some((function(e){return e.remove})),c=function(e){return l&&e&&e.some(a)},u=new Map,d=!1,h={enter:function(e){if(c(e.directives))return d=!0,null}},p=wM(t,{Field:h,InlineFragment:h,VariableDefinition:{enter:function(){return!1}},Variable:{enter:function(e,t,n,i,o){var s=r(o);s&&s.variables.add(e.name.value)}},FragmentSpread:{enter:function(e,t,n,i,o){if(c(e.directives))return d=!0,null;var s=r(o);s&&s.fragmentSpreads.add(e.name.value)}},FragmentDefinition:{enter:function(e,t,n,i){u.set(JSON.stringify(i),e)},leave:function(e,t,n,r){return e===u.get(JSON.stringify(r))?e:o>0&&e.selectionSet.selections.every((function(e){return e.kind===LC.FIELD&&"__typename"===e.name.value}))?(i(e.name.value).removed=!0,d=!0,null):void 0}},Directive:{leave:function(e){if(a(e))return d=!0,null}}});if(!d)return t;var f=function(e){return e.transitiveVars||(e.transitiveVars=new Set(e.variables),e.removed||e.fragmentSpreads.forEach((function(t){f(i(t)).transitiveVars.forEach((function(t){e.transitiveVars.add(t)}))}))),e},m=new Set;p.definitions.forEach((function(e){e.kind===LC.OPERATION_DEFINITION?f(n(e.name&&e.name.value)).fragmentSpreads.forEach((function(e){m.add(e)})):e.kind!==LC.FRAGMENT_DEFINITION||0!==o||i(e.name.value).removed||m.add(e.name.value)})),m.forEach((function(e){f(i(e)).fragmentSpreads.forEach((function(e){m.add(e)}))}));var g={enter:function(e){if(t=e.name.value,!m.has(t)||i(t).removed)return null;var t}};return aI(wM(p,{FragmentSpread:g,FragmentDefinition:g,OperationDefinition:{leave:function(e){if(e.variableDefinitions){var t=f(n(e.name&&e.name.value)).transitiveVars;if(t.size<e.variableDefinitions.length)return iy(iy({},e),{variableDefinitions:e.variableDefinitions.filter((function(e){return t.has(e.variable.name.value)}))})}}}}))}var uI=Object.assign((function(e){return wM(e,{SelectionSet:{enter:function(e,t,n){if(!n||n.kind!==LC.OPERATION_DEFINITION){var i=e.selections;if(i&&!i.some((function(e){return XM(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))}))){var r=n;if(!(XM(r)&&r.directives&&r.directives.some((function(e){return"export"===e.name.value}))))return iy(iy({},e),{selections:ay(ay([],i,!0),[oI],!1)})}}}}})}),{added:function(e){return e===oI}}),dI={test:function(e){var t="connection"===e.name.value;return t&&(e.arguments&&e.arguments.some((function(e){return"key"===e.name.value}))||__DEV__&&aC.warn("Removing an @connection directive even though it does not have a key. You may want to use the key parameter to specify a store key.")),t}};function hI(e){return"query"===tI(e).operation?e:wM(e,{OperationDefinition:{enter:function(e){return iy(iy({},e),{operation:"query"})}}})}var pI=Object.prototype.hasOwnProperty;function fI(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return mI(e)}function mI(e){var t=e[0]||{},n=e.length;if(n>1)for(var i=new yI,r=1;r<n;++r)t=i.merge(t,e[r]);return t}var gI=function(e,t,n){return this.merge(e[n],t[n])},yI=function(){function e(e){void 0===e&&(e=gI),this.reconciler=e,this.isObject=NM,this.pastCopies=new Set}return e.prototype.merge=function(e,t){for(var n=this,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return NM(t)&&NM(e)?(Object.keys(t).forEach((function(r){if(pI.call(e,r)){var o=e[r];if(t[r]!==o){var s=n.reconciler.apply(n,ay([e,t,r],i,!1));s!==o&&((e=n.shallowCopyForMerge(e))[r]=s)}}else(e=n.shallowCopyForMerge(e))[r]=t[r]})),e):t},e.prototype.shallowCopyForMerge=function(e){return NM(e)&&(this.pastCopies.has(e)||(e=Array.isArray(e)?e.slice(0):iy({__proto__:Object.getPrototypeOf(e)},e),this.pastCopies.add(e))),e},e}();function vI(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return bI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bI(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function xI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _I(e,t,n){return t&&xI(e.prototype,t),n&&xI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var wI=function(){return"function"==typeof Symbol},kI=function(e){return wI()&&Boolean(Symbol[e])},EI=function(e){return kI(e)?Symbol[e]:"@@"+e};wI()&&!kI("observable")&&(Symbol.observable=Symbol("observable"));var SI=EI("iterator"),TI=EI("observable"),CI=EI("species");function MI(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function II(e){var t=e.constructor;return void 0!==t&&null===(t=t[CI])&&(t=void 0),void 0!==t?t:FI}function AI(e){return e instanceof FI}function PI(e){PI.log?PI.log(e):setTimeout((function(){throw e}))}function OI(e){Promise.resolve().then((function(){try{e()}catch(wT){PI(wT)}}))}function DI(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var n=MI(t,"unsubscribe");n&&n.call(t)}}catch(wT){PI(wT)}}function RI(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function zI(e,t,n){e._state="running";var i=e._observer;try{var r=MI(i,t);switch(t){case"next":r&&r.call(i,n);break;case"error":if(RI(e),!r)throw n;r.call(i,n);break;case"complete":RI(e),r&&r.call(i)}}catch(wT){PI(wT)}"closed"===e._state?DI(e):"running"===e._state&&(e._state="ready")}function LI(e,t,n){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void OI((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var n=0;n<t.length&&(zI(e,t[n].type,t[n].value),"closed"!==e._state);++n);}}(e)}))):void zI(e,t,n);e._queue.push({type:t,value:n})}}var BI=function(){function e(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";var n=new NI(this);try{this._cleanup=t.call(void 0,n)}catch(wT){n.error(wT)}"initializing"===this._state&&(this._state="ready")}return e.prototype.unsubscribe=function(){"closed"!==this._state&&(RI(this),DI(this))},_I(e,[{key:"closed",get:function(){return"closed"===this._state}}]),e}(),NI=function(){function e(e){this._subscription=e}var t=e.prototype;return t.next=function(e){LI(this._subscription,"next",e)},t.error=function(e){LI(this._subscription,"error",e)},t.complete=function(){LI(this._subscription,"complete")},_I(e,[{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),FI=function(){function e(t){if(!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}var t=e.prototype;return t.subscribe=function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new BI(e,this._subscriber)},t.forEach=function(e){var t=this;return new Promise((function(n,i){if("function"==typeof e)var r=t.subscribe({next:function(t){try{e(t,o)}catch(wT){i(wT),r.unsubscribe()}},error:i,complete:n});else i(new TypeError(e+" is not a function"));function o(){r.unsubscribe(),n()}}))},t.map=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(II(this))((function(n){return t.subscribe({next:function(t){try{t=e(t)}catch(wT){return n.error(wT)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))},t.filter=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(II(this))((function(n){return t.subscribe({next:function(t){try{if(!e(t))return}catch(wT){return n.error(wT)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))},t.reduce=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=II(this),i=arguments.length>1,r=!1,o=arguments[1];return new n((function(n){return t.subscribe({next:function(t){var s=!r;if(r=!0,!s||i)try{o=e(o,t)}catch(wT){return n.error(wT)}else o=t},error:function(e){n.error(e)},complete:function(){if(!r&&!i)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(o),n.complete()}})}))},t.concat=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=II(this);return new r((function(t){var i,o=0;return function e(s){i=s.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){o===n.length?(i=void 0,t.complete()):e(r.from(n[o++]))}})}(e),function(){i&&(i.unsubscribe(),i=void 0)}}))},t.flatMap=function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=II(this);return new n((function(i){var r=[],o=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(wT){return i.error(wT)}var o=n.from(t).subscribe({next:function(e){i.next(e)},error:function(e){i.error(e)},complete:function(){var e=r.indexOf(o);e>=0&&r.splice(e,1),s()}});r.push(o)},error:function(e){i.error(e)},complete:function(){s()}});function s(){o.closed&&0===r.length&&i.complete()}return function(){r.forEach((function(e){return e.unsubscribe()})),o.unsubscribe()}}))},t[TI]=function(){return this},e.from=function(t){var n="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var i=MI(t,TI);if(i){var r=i.call(t);if(Object(r)!==r)throw new TypeError(r+" is not an object");return AI(r)&&r.constructor===n?r:new n((function(e){return r.subscribe(e)}))}if(kI("iterator")&&(i=MI(t,SI)))return new n((function(e){OI((function(){if(!e.closed){for(var n,r=vI(i.call(t));!(n=r()).done;){var o=n.value;if(e.next(o),e.closed)return}e.complete()}}))}));if(Array.isArray(t))return new n((function(e){OI((function(){if(!e.closed){for(var n=0;n<t.length;++n)if(e.next(t[n]),e.closed)return;e.complete()}}))}));throw new TypeError(t+" is not observable")},e.of=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return new("function"==typeof this?this:e)((function(e){OI((function(){if(!e.closed){for(var t=0;t<n.length;++t)if(e.next(n[t]),e.closed)return;e.complete()}}))}))},_I(e,null,[{key:CI,get:function(){return this}}]),e}();wI()&&Object.defineProperty(FI,Symbol("extensions"),{value:{symbol:TI,hostReportError:PI},configurable:!0}),function(e){var t,n=e.Symbol;if("function"==typeof n)if(n.observable)t=n.observable;else{t="function"==typeof n.for?n.for("https://github.com/benlesh/symbol-observable"):n("https://github.com/benlesh/symbol-observable");try{n.observable=t}catch(i){}}else t="@@observable"}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==t?t:Function("return this")());var $I=FI.prototype,jI="@@observable";$I[jI]||($I[jI]=function(){return this});var VI=Object.prototype.toString;function UI(e){return qI(e)}function qI(e,t){switch(VI.call(e)){case"[object Array]":if((t=t||new Map).has(e))return t.get(e);var n=e.slice(0);return t.set(e,n),n.forEach((function(e,i){n[i]=qI(e,t)})),n;case"[object Object]":if((t=t||new Map).has(e))return t.get(e);var i=Object.create(Object.getPrototypeOf(e));return t.set(e,i),Object.keys(e).forEach((function(n){i[n]=qI(e[n],t)})),i;default:return e}}function GI(e){var t=new Set([e]);return t.forEach((function(e){NM(e)&&function(e){if(__DEV__&&!Object.isFrozen(e))try{Object.freeze(e)}catch(wT){if(wT instanceof TypeError)return null;throw wT}return e}(e)===e&&Object.getOwnPropertyNames(e).forEach((function(n){NM(e[n])&&t.add(e[n])}))})),e}function WI(e){return __DEV__&&GI(e),e}function HI(e,t,n){var i=[];e.forEach((function(e){return e[t]&&i.push(e)})),i.forEach((function(e){return e[t](n)}))}function ZI(e,t,n){return new FI((function(i){var r=i.next,o=i.error,s=i.complete,a=0,l=!1,c={then:function(e){return new Promise((function(t){return t(e())}))}};function u(e,t){return e?function(t){++a;var n=function(){return e(t)};c=c.then(n,n).then((function(e){--a,r&&r.call(i,e),l&&d.complete()}),(function(e){throw--a,e})).catch((function(e){o&&o.call(i,e)}))}:function(e){return t&&t.call(i,e)}}var d={next:u(t,r),error:u(n,o),complete:function(){l=!0,a||s&&s.call(i)}},h=e.subscribe(d);return function(){return h.unsubscribe()}}))}var XI="function"==typeof WeakMap&&"ReactNative"!==dC((function(){return navigator.product})),KI="function"==typeof WeakSet,JI="function"==typeof Symbol&&"function"==typeof Symbol.for,YI=JI&&Symbol.asyncIterator;function QI(e){function t(t){Object.defineProperty(e,t,{value:FI})}return JI&&Symbol.species&&t(Symbol.species),t("@@species"),e}function eA(e){return e&&"function"==typeof e.then}dC((function(){return window.document.createElement})),dC((function(){return navigator.userAgent.indexOf("jsdom")>=0}));var tA=function(e){function t(t){var n=e.call(this,(function(e){return n.addObserver(e),function(){return n.removeObserver(e)}}))||this;return n.observers=new Set,n.promise=new Promise((function(e,t){n.resolve=e,n.reject=t})),n.handlers={next:function(e){null!==n.sub&&(n.latest=["next",e],n.notify("next",e),HI(n.observers,"next",e))},error:function(e){var t=n.sub;null!==t&&(t&&setTimeout((function(){return t.unsubscribe()})),n.sub=null,n.latest=["error",e],n.reject(e),n.notify("error",e),HI(n.observers,"error",e))},complete:function(){var e=n,t=e.sub,i=e.sources;if(null!==t){var r=(void 0===i?[]:i).shift();r?eA(r)?r.then((function(e){return n.sub=e.subscribe(n.handlers)})):n.sub=r.subscribe(n.handlers):(t&&setTimeout((function(){return t.unsubscribe()})),n.sub=null,n.latest&&"next"===n.latest[0]?n.resolve(n.latest[1]):n.resolve(),n.notify("complete"),HI(n.observers,"complete"))}}},n.nextResultListeners=new Set,n.cancel=function(e){n.reject(e),n.sources=[],n.handlers.complete()},n.promise.catch((function(e){})),"function"==typeof t&&(t=[new FI(t)]),eA(t)?t.then((function(e){return n.start(e)}),n.handlers.error):n.start(t),n}return ny(t,e),t.prototype.start=function(e){void 0===this.sub&&(this.sources=Array.from(e),this.handlers.complete())},t.prototype.deliverLastMessage=function(e){if(this.latest){var t=this.latest[0],n=e[t];n&&n.call(e,this.latest[1]),null===this.sub&&"next"===t&&e.complete&&e.complete()}},t.prototype.addObserver=function(e){this.observers.has(e)||(this.deliverLastMessage(e),this.observers.add(e))},t.prototype.removeObserver=function(e){this.observers.delete(e)&&this.observers.size<1&&this.handlers.complete()},t.prototype.notify=function(e,t){var n=this.nextResultListeners;n.size&&(this.nextResultListeners=new Set,n.forEach((function(n){return n(e,t)})))},t.prototype.beforeNext=function(e){var t=!1;this.nextResultListeners.add((function(n,i){t||(t=!0,e(n,i))}))},t}(FI);function nA(e){return"incremental"in e}function iA(e){return NM(e)&&"payload"in e}function rA(e,t){var n=e,i=new yI;return nA(t)&&rI(t.incremental)&&t.incremental.forEach((function(e){for(var t=e.data,r=e.path,o=r.length-1;o>=0;--o){var s=r[o],a=isNaN(+s)?{}:[];a[s]=t,t=a}n=i.merge(n,t)})),n}function oA(e){return rI(sA(e))}function sA(e){var t=rI(e.errors)?e.errors.slice(0):[];return nA(e)&&rI(e.incremental)&&e.incremental.forEach((function(e){e.errors&&t.push.apply(t,e.errors)})),t}function aA(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object.create(null);return e.forEach((function(e){e&&Object.keys(e).forEach((function(t){var i=e[t];void 0!==i&&(n[t]=i)}))})),n}QI(tA);var lA=new Map;function cA(e){var t=lA.get(e)||1;return lA.set(e,t+1),"".concat(e,":").concat(t,":").concat(Math.random().toString(36).slice(2))}function uA(e,t){return aA(e,t,t.variables&&{variables:iy(iy({},e&&e.variables),t.variables)})}function dA(e){return new FI((function(t){t.error(e)}))}var hA=function(e,t,n){var i=new Error(n);throw i.name="ServerError",i.response=e,i.statusCode=e.status,i.result=t,i};function pA(e,t){return t?t(e):FI.of()}function fA(e){return"function"==typeof e?new yA(e):e}function mA(e){return e.request.length<=1}var gA=function(e){function t(t,n){var i=e.call(this,t)||this;return i.link=n,i}return ny(t,e),t}(Error),yA=function(){function e(e){e&&(this.request=e)}return e.empty=function(){return new e((function(){return FI.of()}))},e.from=function(t){return 0===t.length?e.empty():t.map(fA).reduce((function(e,t){return e.concat(t)}))},e.split=function(t,n,i){var r=fA(n),o=fA(i||new e(pA));return mA(r)&&mA(o)?new e((function(e){return t(e)?r.request(e)||FI.of():o.request(e)||FI.of()})):new e((function(e,n){return t(e)?r.request(e,n)||FI.of():o.request(e,n)||FI.of()}))},e.execute=function(e,t){return e.request(function(e,t){var n=iy({},e);return Object.defineProperty(t,"setContext",{enumerable:!1,value:function(e){n=iy(iy({},n),"function"==typeof e?e(n):e)}}),Object.defineProperty(t,"getContext",{enumerable:!1,value:function(){return iy({},n)}}),t}(t.context,function(e){var t={variables:e.variables||{},extensions:e.extensions||{},operationName:e.operationName,query:e.query};return t.operationName||(t.operationName="string"!=typeof t.query?YM(t.query)||void 0:""),t}(function(e){for(var t=["query","operationName","variables","extensions","context"],n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];if(t.indexOf(r)<0)throw __DEV__?new sC("illegal argument: ".concat(r)):new sC(27)}return e}(t))))||FI.of()},e.concat=function(t,n){var i=fA(t);if(mA(i))return __DEV__&&aC.warn(new gA("You are calling concat on a terminating link, which will have no effect",i)),i;var r=fA(n);return mA(r)?new e((function(e){return i.request(e,(function(e){return r.request(e)||FI.of()}))||FI.of()})):new e((function(e,t){return i.request(e,(function(e){return r.request(e,t)||FI.of()}))||FI.of()}))},e.prototype.split=function(t,n,i){return this.concat(e.split(t,n,i||new e(pA)))},e.prototype.concat=function(t){return e.concat(this,t)},e.prototype.request=function(e,t){throw __DEV__?new sC("request is not implemented"):new sC(22)},e.prototype.onError=function(e,t){if(t&&t.error)return t.error(e),!1;throw e},e.prototype.setOnError=function(e){return this.onError=e,this},e}(),vA=yA.split,bA=yA.execute;function xA(e){var t=null,n=null,i=!1,r=[],o=[];function s(e){if(!n){if(o.length){var t=o.shift();if(Array.isArray(t)&&t[0])return t[0]({value:e,done:!1})}r.push(e)}}function a(e){n=e,o.slice().forEach((function(t){t[1](e)})),!t||t()}function l(){i=!0,o.slice().forEach((function(e){e[0]({value:void 0,done:!0})})),!t||t()}t=function(){t=null,e.removeListener("data",s),e.removeListener("error",a),e.removeListener("end",l),e.removeListener("finish",l),e.removeListener("close",l)},e.on("data",s),e.on("error",a),e.on("end",l),e.on("finish",l),e.on("close",l);var c={next:function(){return new Promise((function(e,t){return n?t(n):r.length?e({value:r.shift(),done:!1}):i?e({value:void 0,done:!0}):void o.push([e,t])}))}};return YI&&(c[Symbol.asyncIterator]=function(){return this}),c}function _A(e){var t={next:function(){return e.read()}};return YI&&(t[Symbol.asyncIterator]=function(){return this}),t}function wA(e){var t=e;if(e.body&&(t=e.body),function(e){return!(!YI||!e[Symbol.asyncIterator])}(t))return function(e){var t,n=e[Symbol.asyncIterator]();return(t={next:function(){return n.next()}})[Symbol.asyncIterator]=function(){return this},t}(t);if(function(e){return!!e.getReader}(t))return _A(t.getReader());if(function(e){return!!e.stream}(t))return _A(t.stream().getReader());if(function(e){return!!e.arrayBuffer}(t))return function(e){var t=!1,n={next:function(){return t?Promise.resolve({value:void 0,done:!0}):(t=!0,new Promise((function(t,n){e.then((function(e){t({value:e,done:!1})})).catch(n)})))}};return YI&&(n[Symbol.asyncIterator]=function(){return this}),n}(t.arrayBuffer());if(function(e){return!!e.pipe}(t))return xA(t);throw new Error("Unknown body type for responseIterator. Please pass a streamable response.")}var kA=Symbol(),EA=function(e){function t(n){var i,r,o=n.graphQLErrors,s=n.protocolErrors,a=n.clientErrors,l=n.networkError,c=n.errorMessage,u=n.extraInfo,d=e.call(this,c)||this;return d.name="ApolloError",d.graphQLErrors=o||[],d.protocolErrors=s||[],d.clientErrors=a||[],d.networkError=l||null,d.message=c||(r=ay(ay(ay([],(i=d).graphQLErrors,!0),i.clientErrors,!0),i.protocolErrors,!0),i.networkError&&r.push(i.networkError),r.map((function(e){return NM(e)&&e.message||"Error message not found."})).join("\n")),d.extraInfo=u,d.__proto__=t.prototype,d}return ny(t,e),t}(Error),SA=Object.prototype.hasOwnProperty;function TA(e){var t={};return e.split("\n").forEach((function(e){var n=e.indexOf(":");if(n>-1){var i=e.slice(0,n).trim().toLowerCase(),r=e.slice(n+1).trim();t[i]=r}})),t}function CA(e,t){e.status>=300&&hA(e,function(){try{return JSON.parse(t)}catch(e){return t}}(),"Response not successful: Received status code ".concat(e.status));try{return JSON.parse(t)}catch(i){var n=i;throw n.name="ServerParseError",n.response=e,n.statusCode=e.status,n.bodyText=t,n}}function MA(e,t){var n,i;"AbortError"!==e.name&&(e.result&&e.result.errors&&e.result.data&&(null===(n=t.next)||void 0===n||n.call(t,e.result)),null===(i=t.error)||void 0===i||i.call(t,e))}function IA(e,t,n){var i;(i=t,function(e){return e.text().then((function(t){return CA(e,t)})).then((function(t){return e.status>=300&&hA(e,t,"Response not successful: Received status code ".concat(e.status)),Array.isArray(t)||SA.call(t,"data")||SA.call(t,"errors")||hA(e,t,"Server response was missing for query '".concat(Array.isArray(i)?i.map((function(e){return e.operationName})):i.operationName,"'.")),t}))})(e).then((function(e){var t,i;null===(t=n.next)||void 0===t||t.call(n,e),null===(i=n.complete)||void 0===i||i.call(n)})).catch((function(e){return MA(e,n)}))}var AA=function(e,t){var n;try{n=JSON.stringify(e)}catch(wT){var i=__DEV__?new sC("Network request failed. ".concat(t," is not serializable: ").concat(wT.message)):new sC(24);throw i.parseError=wT,i}return n},PA={http:{includeQuery:!0,includeExtensions:!1,preserveHeaderCase:!1},headers:{accept:"*/*","content-type":"application/json"},options:{method:"POST"}},OA=function(e,t){return t(e)};function DA(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={},o={};n.forEach((function(e){r=iy(iy(iy({},r),e.options),{headers:iy(iy({},r.headers),e.headers)}),e.credentials&&(r.credentials=e.credentials),o=iy(iy({},o),e.http)})),r.headers&&(r.headers=function(e,t){if(!t){var n=Object.create(null);return Object.keys(Object(e)).forEach((function(t){n[t.toLowerCase()]=e[t]})),n}var i=Object.create(null);Object.keys(Object(e)).forEach((function(t){i[t.toLowerCase()]={originalName:t,value:e[t]}}));var r=Object.create(null);return Object.keys(i).forEach((function(e){r[i[e].originalName]=i[e].value})),r}(r.headers,o.preserveHeaderCase));var s=e.operationName,a=e.extensions,l=e.variables,c=e.query,u={operationName:s,variables:l};return o.includeExtensions&&(u.extensions=a),o.includeQuery&&(u.query=t(c,EM)),{options:r,body:u}}var RA=dC((function(){return fetch})),zA=function(e){void 0===e&&(e={});var t=e.uri,n=void 0===t?"/graphql":t,i=e.fetch,r=e.print,o=void 0===r?OA:r,s=e.includeExtensions,a=e.preserveHeaderCase,l=e.useGETForQueries,c=e.includeUnusedVariables,u=void 0!==c&&c,d=ry(e,["uri","fetch","print","includeExtensions","preserveHeaderCase","useGETForQueries","includeUnusedVariables"]);__DEV__&&function(e){if(!e&&"undefined"==typeof fetch)throw __DEV__?new sC("\n\"fetch\" has not been found globally and no fetcher has been configured. To fix this, install a fetch package (like https://www.npmjs.com/package/cross-fetch), instantiate the fetcher, and pass it into your HttpLink constructor. For example:\n\nimport fetch from 'cross-fetch';\nimport { ApolloClient, HttpLink } from '@apollo/client';\nconst client = new ApolloClient({\n  link: new HttpLink({ uri: '/graphql', fetch })\n});\n    "):new sC(23)}(i||RA);var h={http:{includeExtensions:s,preserveHeaderCase:a},options:d.fetchOptions,credentials:d.credentials,headers:d.headers};return new yA((function(e){var t=function(e,t){var n=e.getContext().uri;return n||("function"==typeof t?t(e):t||"/graphql")}(e,n),r=e.getContext(),s={};if(r.clientAwareness){var a=r.clientAwareness,c=a.name,d=a.version;c&&(s["apollographql-client-name"]=c),d&&(s["apollographql-client-version"]=d)}var p,f=iy(iy({},s),r.headers),m={http:r.http,options:r.fetchOptions,credentials:r.credentials,headers:f},g=DA(e,o,PA,h,m),y=g.options,v=g.body;if(v.variables&&!u){var b=new Set(Object.keys(v.variables));wM(e.query,{Variable:function(e,t,n){n&&"VariableDefinition"!==n.kind&&b.delete(e.name.value)}}),b.size&&(v.variables=iy({},v.variables),b.forEach((function(e){delete v.variables[e]})))}if(!y.signal){var x=function(){if("undefined"==typeof AbortController)return{controller:!1,signal:!1};var e=new AbortController;return{controller:e,signal:e.signal}}(),_=x.controller,w=x.signal;(p=_)&&(y.signal=w)}var k=function(e){return"OperationDefinition"===e.kind&&"subscription"===e.operation}(tI(e.query)),E=DM(["defer"],e.query);if(l&&!e.query.definitions.some((function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation}))&&(y.method="GET"),E||k){y.headers=y.headers||{};var S="multipart/mixed;";k&&E&&__DEV__&&aC.warn("Multipart-subscriptions do not support @defer"),k?S+="boundary=graphql;subscriptionSpec=1.0,application/json":E&&(S+="deferSpec=20220824,application/json"),y.headers.accept=S}if("GET"===y.method){var T=function(e,t){var n=[],i=function(e,t){n.push("".concat(e,"=").concat(encodeURIComponent(t)))};if("query"in t&&i("query",t.query),t.operationName&&i("operationName",t.operationName),t.variables){var r=void 0;try{r=AA(t.variables,"Variables map")}catch(M){return{parseError:M}}i("variables",r)}if(t.extensions){var o=void 0;try{o=AA(t.extensions,"Extensions map")}catch(M){return{parseError:M}}i("extensions",o)}var s="",a=e,l=e.indexOf("#");-1!==l&&(s=e.substr(l),a=e.substr(0,l));var c=-1===a.indexOf("?")?"?":"&";return{newURI:a+c+n.join("&")+s}}(t,v),C=T.newURI,M=T.parseError;if(M)return dA(M);t=C}else try{y.body=AA(v,"Payload")}catch(M){return dA(M)}return new FI((function(n){return(i||dC((function(){return fetch}))||RA)(t,y).then((function(t){var i;e.setContext({response:t});var r=null===(i=t.headers)||void 0===i?void 0:i.get("content-type");return null!==r&&/^multipart\/mixed/i.test(r)?function(e,t){var n,i,r,o,s;return oy(this,void 0,void 0,(function(){var a,l,c,u,d,h,p,f,m,g,y,v,b,x,_,w,k,E,S,T,C,M,I;return sy(this,(function(A){switch(A.label){case 0:if(void 0===TextDecoder)throw new Error("TextDecoder must be defined in the environment: please import a polyfill.");a=new TextDecoder("utf-8"),l=null===(n=e.headers)||void 0===n?void 0:n.get("content-type"),c="boundary=",u=(null==l?void 0:l.includes(c))?null==l?void 0:l.substring((null==l?void 0:l.indexOf(c))+c.length).replace(/['"]/g,"").replace(/\;(.*)/gm,"").trim():"-",d="\r\n--".concat(u),h="",p=wA(e),f=!0,A.label=1;case 1:return f?[4,p.next()]:[3,3];case 2:for(m=A.sent(),g=m.value,y=m.done,v="string"==typeof g?g:a.decode(g),b=h.length-d.length+1,f=!y,x=(h+=v).indexOf(d,b);x>-1;){if(_=void 0,M=[h.slice(0,x),h.slice(x+d.length)],h=M[1],w=(_=M[0]).indexOf("\r\n\r\n"),k=TA(_.slice(0,w)),(E=k["content-type"])&&-1===E.toLowerCase().indexOf("application/json"))throw new Error("Unsupported patch content type: application/json is required.");if(S=_.slice(w))try{T=CA(e,S),Object.keys(T).length>1||"data"in T||"incremental"in T||"errors"in T||"payload"in T?iA(T)?(C={},"payload"in T&&(C=iy({},T.payload)),"errors"in T&&(C=iy(iy({},C),{extensions:iy(iy({},"extensions"in C?C.extensions:null),(I={},I[kA]=T.errors,I))})),null===(i=t.next)||void 0===i||i.call(t,C)):null===(r=t.next)||void 0===r||r.call(t,T):1===Object.keys(T).length&&"hasNext"in T&&!T.hasNext&&(null===(o=t.complete)||void 0===o||o.call(t))}catch(P){MA(P,t)}x=h.indexOf(d)}return[3,1];case 3:return null===(s=t.complete)||void 0===s||s.call(t),[2]}}))}))}(t,n):IA(t,e,n)})).catch((function(e){return MA(e,n)})),function(){p&&p.abort()}}))}))},LA=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,zA(t).request)||this;return n.options=t,n}return ny(t,e),t}(yA);const{toString:BA,hasOwnProperty:NA}=Object.prototype,FA=Function.prototype.toString,$A=new Map;function jA(e,t){try{return VA(e,t)}finally{$A.clear()}}function VA(e,t){if(e===t)return!0;const n=BA.call(e);if(n!==BA.call(t))return!1;switch(n){case"[object Array]":if(e.length!==t.length)return!1;case"[object Object]":{if(WA(e,t))return!0;const n=UA(e),i=UA(t),r=n.length;if(r!==i.length)return!1;for(let e=0;e<r;++e)if(!NA.call(t,n[e]))return!1;for(let o=0;o<r;++o){const i=n[o];if(!VA(e[i],t[i]))return!1}return!0}case"[object Error]":return e.name===t.name&&e.message===t.message;case"[object Number]":if(e!=e)return t!=t;case"[object Boolean]":case"[object Date]":return+e==+t;case"[object RegExp]":case"[object String]":return e==`${t}`;case"[object Map]":case"[object Set]":{if(e.size!==t.size)return!1;if(WA(e,t))return!0;const i=e.entries(),r="[object Map]"===n;for(;;){const e=i.next();if(e.done)break;const[n,o]=e.value;if(!t.has(n))return!1;if(r&&!VA(o,t.get(n)))return!1}return!0}case"[object Uint16Array]":case"[object Uint8Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object ArrayBuffer]":e=new Uint8Array(e),t=new Uint8Array(t);case"[object DataView]":{let n=e.byteLength;if(n===t.byteLength)for(;n--&&e[n]===t[n];);return-1===n}case"[object AsyncFunction]":case"[object GeneratorFunction]":case"[object AsyncGeneratorFunction]":case"[object Function]":{const n=FA.call(e);return n===FA.call(t)&&!function(e,t){const n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n}(n,GA)}}return!1}function UA(e){return Object.keys(e).filter(qA,e)}function qA(e){return void 0!==this[e]}const GA="{ [native code] }";function WA(e,t){let n=$A.get(e);if(n){if(n.has(t))return!0}else $A.set(e,n=new Set);return n.add(t),!1}var HA=function(){return Object.create(null)},ZA=Array.prototype,XA=ZA.forEach,KA=ZA.slice,JA=function(){function e(e,t){void 0===e&&(e=!0),void 0===t&&(t=HA),this.weakness=e,this.makeData=t}return e.prototype.lookup=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.lookupArray(e)},e.prototype.lookupArray=function(e){var t=this;return XA.call(e,(function(e){return t=t.getChildTrie(e)})),t.data||(t.data=this.makeData(KA.call(e)))},e.prototype.getChildTrie=function(t){var n=this.weakness&&function(e){switch(typeof e){case"object":if(null===e)break;case"function":return!0}return!1}(t)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map),i=n.get(t);return i||n.set(t,i=new e(this.weakness,this.makeData)),i},e}();let YA=null;const QA={};let eP=1;function tP(e){try{return e()}catch(t){}}const nP="@wry/context:Slot",iP=tP((()=>globalThis))||tP((()=>global))||Object.create(null),rP=iP[nP]||Array[nP]||function(e){try{Object.defineProperty(iP,nP,{value:e,enumerable:!1,writable:!1,configurable:!0})}finally{return e}}(class{constructor(){this.id=["slot",eP++,Date.now(),Math.random().toString(36).slice(2)].join(":")}hasValue(){for(let e=YA;e;e=e.parent)if(this.id in e.slots){const t=e.slots[this.id];if(t===QA)break;return e!==YA&&(YA.slots[this.id]=t),!0}return YA&&(YA.slots[this.id]=QA),!1}getValue(){if(this.hasValue())return YA.slots[this.id]}withValue(e,t,n,i){const r={__proto__:null,[this.id]:e},o=YA;YA={parent:o,slots:r};try{return t.apply(i,n)}finally{YA=o}}static bind(e){const t=YA;return function(){const n=YA;try{return YA=t,e.apply(this,arguments)}finally{YA=n}}}static noContext(e,t,n){if(!YA)return e.apply(n,t);{const i=YA;try{return YA=null,e.apply(n,t)}finally{YA=i}}}});function oP(){}var sP,aP=function(){function e(e,t){void 0===e&&(e=1/0),void 0===t&&(t=oP),this.max=e,this.dispose=t,this.map=new Map,this.newest=null,this.oldest=null}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.get=function(e){var t=this.getNode(e);return t&&t.value},e.prototype.getNode=function(e){var t=this.map.get(e);if(t&&t!==this.newest){var n=t.older,i=t.newer;i&&(i.older=n),n&&(n.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t},e.prototype.set=function(e,t){var n=this.getNode(e);return n?n.value=t:(n={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=n),this.newest=n,this.oldest=this.oldest||n,this.map.set(e,n),n.value)},e.prototype.clean=function(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)},e.prototype.delete=function(e){var t=this.map.get(e);return!!t&&(t===this.newest&&(this.newest=t.older),t===this.oldest&&(this.oldest=t.newer),t.newer&&(t.newer.older=t.older),t.older&&(t.older.newer=t.newer),this.map.delete(e),this.dispose(t.value,e),!0)},e}(),lP=new rP,cP=Object.prototype.hasOwnProperty,uP=void 0===(sP=Array.from)?function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t}:sP;function dP(e){var t=e.unsubscribe;"function"==typeof t&&(e.unsubscribe=void 0,t())}var hP=[],pP=100;function fP(e,t){if(!e)throw new Error(t||"assertion failure")}function mP(e){switch(e.length){case 0:throw new Error("unknown value");case 1:return e[0];case 2:throw e[1]}}var gP=function(){function e(t){this.fn=t,this.parents=new Set,this.childValues=new Map,this.dirtyChildren=null,this.dirty=!0,this.recomputing=!1,this.value=[],this.deps=null,++e.count}return e.prototype.peek=function(){if(1===this.value.length&&!bP(this))return yP(this),this.value[0]},e.prototype.recompute=function(e){return fP(!this.recomputing,"already recomputing"),yP(this),bP(this)?function(e,t){return TP(e),lP.withValue(e,vP,[e,t]),function(e,t){if("function"==typeof e.subscribe)try{dP(e),e.unsubscribe=e.subscribe.apply(null,t)}catch(wT){return e.setDirty(),!1}return!0}(e,t)&&function(e){e.dirty=!1,bP(e)||_P(e)}(e),mP(e.value)}(this,e):mP(this.value)},e.prototype.setDirty=function(){this.dirty||(this.dirty=!0,this.value.length=0,xP(this),dP(this))},e.prototype.dispose=function(){var e=this;this.setDirty(),TP(this),wP(this,(function(t,n){t.setDirty(),CP(t,e)}))},e.prototype.forget=function(){this.dispose()},e.prototype.dependOn=function(e){e.add(this),this.deps||(this.deps=hP.pop()||new Set),this.deps.add(e)},e.prototype.forgetDeps=function(){var e=this;this.deps&&(uP(this.deps).forEach((function(t){return t.delete(e)})),this.deps.clear(),hP.push(this.deps),this.deps=null)},e.count=0,e}();function yP(e){var t=lP.getValue();if(t)return e.parents.add(t),t.childValues.has(e)||t.childValues.set(e,[]),bP(e)?kP(t,e):EP(t,e),t}function vP(e,t){e.recomputing=!0,e.value.length=0;try{e.value[0]=e.fn.apply(null,t)}catch(wT){e.value[1]=wT}e.recomputing=!1}function bP(e){return e.dirty||!(!e.dirtyChildren||!e.dirtyChildren.size)}function xP(e){wP(e,kP)}function _P(e){wP(e,EP)}function wP(e,t){var n=e.parents.size;if(n)for(var i=uP(e.parents),r=0;r<n;++r)t(i[r],e)}function kP(e,t){fP(e.childValues.has(t)),fP(bP(t));var n=!bP(e);if(e.dirtyChildren){if(e.dirtyChildren.has(t))return}else e.dirtyChildren=hP.pop()||new Set;e.dirtyChildren.add(t),n&&xP(e)}function EP(e,t){fP(e.childValues.has(t)),fP(!bP(t));var n=e.childValues.get(t);0===n.length?e.childValues.set(t,t.value.slice(0)):function(e,t){var n=e.length;return n>0&&n===t.length&&e[n-1]===t[n-1]}(n,t.value)||e.setDirty(),SP(e,t),bP(e)||_P(e)}function SP(e,t){var n=e.dirtyChildren;n&&(n.delete(t),0===n.size&&(hP.length<pP&&hP.push(n),e.dirtyChildren=null))}function TP(e){e.childValues.size>0&&e.childValues.forEach((function(t,n){CP(e,n)})),e.forgetDeps(),fP(null===e.dirtyChildren)}function CP(e,t){t.parents.delete(e),e.childValues.delete(t),SP(e,t)}var MP={setDirty:!0,dispose:!0,forget:!0};function IP(e){var t=new Map,n=e&&e.subscribe;function i(e){var i=lP.getValue();if(i){var r=t.get(e);r||t.set(e,r=new Set),i.dependOn(r),"function"==typeof n&&(dP(r),r.unsubscribe=n(e))}}return i.dirty=function(e,n){var i=t.get(e);if(i){var r=n&&cP.call(MP,n)?n:"setDirty";uP(i).forEach((function(e){return e[r]()})),t.delete(e),dP(i)}},i}function AP(){var e=new JA("function"==typeof WeakMap);return function(){return e.lookupArray(arguments)}}AP();var PP=new Set;function OP(e,t){void 0===t&&(t=Object.create(null));var n=new aP(t.max||Math.pow(2,16),(function(e){return e.dispose()})),i=t.keyArgs,r=t.makeCacheKey||AP(),o=function(){var o=r.apply(null,i?i.apply(null,arguments):arguments);if(void 0===o)return e.apply(null,arguments);var s=n.get(o);s||(n.set(o,s=new gP(e)),s.subscribe=t.subscribe,s.forget=function(){return n.delete(o)});var a=s.recompute(Array.prototype.slice.call(arguments));return n.set(o,s),PP.add(n),lP.hasValue()||(PP.forEach((function(e){return e.clean()})),PP.clear()),a};function s(e){var t=n.get(e);t&&t.setDirty()}function a(e){var t=n.get(e);if(t)return t.peek()}function l(e){return n.delete(e)}return Object.defineProperty(o,"size",{get:function(){return n.map.size},configurable:!1,enumerable:!1}),o.dirtyKey=s,o.dirty=function(){s(r.apply(null,arguments))},o.peekKey=a,o.peek=function(){return a(r.apply(null,arguments))},o.forgetKey=l,o.forget=function(){return l(r.apply(null,arguments))},o.makeCacheKey=r,o.getKey=i?function(){return r.apply(null,i.apply(null,arguments))}:r,Object.freeze(o)}var DP=function(){function e(){this.getFragmentDoc=OP(zM)}return e.prototype.batch=function(e){var t,n=this,i="string"==typeof e.optimistic?e.optimistic:!1===e.optimistic?null:void 0;return this.performTransaction((function(){return t=e.update(n)}),i),t},e.prototype.recordOptimisticTransaction=function(e,t){this.performTransaction(e,t)},e.prototype.transformDocument=function(e){return e},e.prototype.transformForLink=function(e){return e},e.prototype.identify=function(e){},e.prototype.gc=function(){return[]},e.prototype.modify=function(e){return!1},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!!e.optimistic),this.read(iy(iy({},e),{rootId:e.id||"ROOT_QUERY",optimistic:t}))},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!!e.optimistic),this.read(iy(iy({},e),{query:this.getFragmentDoc(e.fragment,e.fragmentName),rootId:e.id,optimistic:t}))},e.prototype.writeQuery=function(e){var t=e.id,n=e.data,i=ry(e,["id","data"]);return this.write(Object.assign(i,{dataId:t||"ROOT_QUERY",result:n}))},e.prototype.writeFragment=function(e){var t=e.id,n=e.data,i=e.fragment,r=e.fragmentName,o=ry(e,["id","data","fragment","fragmentName"]);return this.write(Object.assign(o,{query:this.getFragmentDoc(i,r),dataId:t,result:n}))},e.prototype.updateQuery=function(e,t){return this.batch({update:function(n){var i=n.readQuery(e),r=t(i);return null==r?i:(n.writeQuery(iy(iy({},e),{data:r})),r)}})},e.prototype.updateFragment=function(e,t){return this.batch({update:function(n){var i=n.readFragment(e),r=t(i);return null==r?i:(n.writeFragment(iy(iy({},e),{data:r})),r)}})},e}(),RP=function(e){function t(n,i,r,o){var s,a=e.call(this,n)||this;if(a.message=n,a.path=i,a.query=r,a.variables=o,Array.isArray(a.path)){a.missing=a.message;for(var l=a.path.length-1;l>=0;--l)a.missing=((s={})[a.path[l]]=a.missing,s)}else a.missing=a.path;return a.__proto__=t.prototype,a}return ny(t,e),t}(Error);const zP=()=>Object.create(null),{forEach:LP,slice:BP}=Array.prototype,{hasOwnProperty:NP}=Object.prototype;class FP{constructor(e=!0,t=zP){this.weakness=e,this.makeData=t}lookup(...e){return this.lookupArray(e)}lookupArray(e){let t=this;return LP.call(e,(e=>t=t.getChildTrie(e))),NP.call(t,"data")?t.data:t.data=this.makeData(BP.call(e))}peek(...e){return this.peekArray(e)}peekArray(e){let t=this;for(let n=0,i=e.length;t&&n<i;++n){const i=this.weakness&&$P(e[n])?t.weak:t.strong;t=i&&i.get(e[n])}return t&&t.data}getChildTrie(e){const t=this.weakness&&$P(e)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map);let n=t.get(e);return n||t.set(e,n=new FP(this.weakness,this.makeData)),n}}function $P(e){switch(typeof e){case"object":if(null===e)break;case"function":return!0}return!1}var jP=Object.prototype.hasOwnProperty;function VP(e){return null==e}function UP(e,t){var n=e.__typename,i=e.id,r=e._id;if("string"==typeof n&&(t&&(t.keyObject=VP(i)?VP(r)?void 0:{_id:r}:{id:i}),VP(i)&&!VP(r)&&(i=r),!VP(i)))return"".concat(n,":").concat("number"==typeof i||"string"==typeof i?i:JSON.stringify(i))}var qP={dataIdFromObject:UP,addTypename:!0,resultCaching:!0,canonizeResults:!1};function GP(e){var t=e.canonizeResults;return void 0===t?qP.canonizeResults:t}var WP=/^[_a-z][_0-9a-z]*/i;function HP(e){var t=e.match(WP);return t?t[0]:e}function ZP(e,t,n){return!!NM(t)&&(iI(t)?t.every((function(t){return ZP(e,t,n)})):e.selections.every((function(e){if(XM(e)&&OM(e,n)){var i=HM(e);return jP.call(t,i)&&(!e.selectionSet||ZP(e.selectionSet,t[i],n))}return!0})))}function XP(e){return NM(e)&&!$M(e)&&!iI(e)}function KP(e,t){var n=LM(QM(e));return{fragmentMap:n,lookupFragment:function(e){var i=n[e];return!i&&t&&(i=t.lookup(e)),i||null}}}var JP=Object.create(null),YP=function(){return JP},QP=Object.create(null),eO=function(){function e(e,t){var n=this;this.policies=e,this.group=t,this.data=Object.create(null),this.rootIds=Object.create(null),this.refs=Object.create(null),this.getFieldValue=function(e,t){return WI($M(e)?n.get(e.__ref,t):e&&e[t])},this.canRead=function(e){return $M(e)?n.has(e.__ref):"object"==typeof e},this.toReference=function(e,t){if("string"==typeof e)return FM(e);if($M(e))return e;var i=n.policies.identify(e)[0];if(i){var r=FM(i);return t&&n.merge(i,e),r}}}return e.prototype.toObject=function(){return iy({},this.data)},e.prototype.has=function(e){return void 0!==this.lookup(e,!0)},e.prototype.get=function(e,t){if(this.group.depend(e,t),jP.call(this.data,e)){var n=this.data[e];if(n&&jP.call(n,t))return n[t]}return"__typename"===t&&jP.call(this.policies.rootTypenamesById,e)?this.policies.rootTypenamesById[e]:this instanceof rO?this.parent.get(e,t):void 0},e.prototype.lookup=function(e,t){return t&&this.group.depend(e,"__exists"),jP.call(this.data,e)?this.data[e]:this instanceof rO?this.parent.lookup(e,t):this.policies.rootTypenamesById[e]?Object.create(null):void 0},e.prototype.merge=function(e,t){var n,i=this;$M(e)&&(e=e.__ref),$M(t)&&(t=t.__ref);var r="string"==typeof e?this.lookup(n=e):e,o="string"==typeof t?this.lookup(n=t):t;if(o){__DEV__?aC("string"==typeof n,"store.merge expects a string ID"):aC("string"==typeof n,1);var s=new yI(sO).merge(r,o);if(this.data[n]=s,s!==r&&(delete this.refs[n],this.group.caching)){var a=Object.create(null);r||(a.__exists=1),Object.keys(o).forEach((function(e){if(!r||r[e]!==s[e]){a[e]=1;var t=HP(e);t===e||i.policies.hasKeyArgs(s.__typename,t)||(a[t]=1),void 0!==s[e]||i instanceof rO||delete s[e]}})),!a.__typename||r&&r.__typename||this.policies.rootTypenamesById[n]!==s.__typename||delete a.__typename,Object.keys(a).forEach((function(e){return i.group.dirty(n,e)}))}}},e.prototype.modify=function(e,t){var n=this,i=this.lookup(e);if(i){var r=Object.create(null),o=!1,s=!0,a={DELETE:JP,INVALIDATE:QP,isReference:$M,toReference:this.toReference,canRead:this.canRead,readField:function(t,i){return n.policies.readField("string"==typeof t?{fieldName:t,from:i||FM(e)}:t,{store:n})}};if(Object.keys(i).forEach((function(l){var c=HP(l),u=i[l];if(void 0!==u){var d="function"==typeof t?t:t[l]||t[c];if(d){var h=d===YP?JP:d(WI(u),iy(iy({},a),{fieldName:c,storeFieldName:l,storage:n.getStorage(e,l)}));h===QP?n.group.dirty(e,l):(h===JP&&(h=void 0),h!==u&&(r[l]=h,o=!0,u=h))}void 0!==u&&(s=!1)}})),o)return this.merge(e,r),s&&(this instanceof rO?this.data[e]=void 0:delete this.data[e],this.group.dirty(e,"__exists")),!0}return!1},e.prototype.delete=function(e,t,n){var i,r=this.lookup(e);if(r){var o=this.getFieldValue(r,"__typename"),s=t&&n?this.policies.getStoreFieldName({typename:o,fieldName:t,args:n}):t;return this.modify(e,s?((i={})[s]=YP,i):YP)}return!1},e.prototype.evict=function(e,t){var n=!1;return e.id&&(jP.call(this.data,e.id)&&(n=this.delete(e.id,e.fieldName,e.args)),this instanceof rO&&this!==t&&(n=this.parent.evict(e,t)||n),(e.fieldName||n)&&this.group.dirty(e.id,e.fieldName||"__exists")),n},e.prototype.clear=function(){this.replace(null)},e.prototype.extract=function(){var e=this,t=this.toObject(),n=[];return this.getRootIdSet().forEach((function(t){jP.call(e.policies.rootTypenamesById,t)||n.push(t)})),n.length&&(t.__META={extraRootIds:n.sort()}),t},e.prototype.replace=function(e){var t=this;if(Object.keys(this.data).forEach((function(n){e&&jP.call(e,n)||t.delete(n)})),e){var n=e.__META,i=ry(e,["__META"]);Object.keys(i).forEach((function(e){t.merge(e,i[e])})),n&&n.extraRootIds.forEach(this.retain,this)}},e.prototype.retain=function(e){return this.rootIds[e]=(this.rootIds[e]||0)+1},e.prototype.release=function(e){if(this.rootIds[e]>0){var t=--this.rootIds[e];return t||delete this.rootIds[e],t}return 0},e.prototype.getRootIdSet=function(e){return void 0===e&&(e=new Set),Object.keys(this.rootIds).forEach(e.add,e),this instanceof rO?this.parent.getRootIdSet(e):Object.keys(this.policies.rootTypenamesById).forEach(e.add,e),e},e.prototype.gc=function(){var e=this,t=this.getRootIdSet(),n=this.toObject();t.forEach((function(i){jP.call(n,i)&&(Object.keys(e.findChildRefIds(i)).forEach(t.add,t),delete n[i])}));var i=Object.keys(n);if(i.length){for(var r=this;r instanceof rO;)r=r.parent;i.forEach((function(e){return r.delete(e)}))}return i},e.prototype.findChildRefIds=function(e){if(!jP.call(this.refs,e)){var t=this.refs[e]=Object.create(null),n=this.data[e];if(!n)return t;var i=new Set([n]);i.forEach((function(e){$M(e)&&(t[e.__ref]=!0),NM(e)&&Object.keys(e).forEach((function(t){var n=e[t];NM(n)&&i.add(n)}))}))}return this.refs[e]},e.prototype.makeCacheKey=function(){return this.group.keyMaker.lookupArray(arguments)},e}(),tO=function(){function e(e,t){void 0===t&&(t=null),this.caching=e,this.parent=t,this.d=null,this.resetCaching()}return e.prototype.resetCaching=function(){this.d=this.caching?IP():null,this.keyMaker=new FP(XI)},e.prototype.depend=function(e,t){if(this.d){this.d(nO(e,t));var n=HP(t);n!==t&&this.d(nO(e,n)),this.parent&&this.parent.depend(e,t)}},e.prototype.dirty=function(e,t){this.d&&this.d.dirty(nO(e,t),"__exists"===t?"forget":"setDirty")},e}();function nO(e,t){return t+"#"+e}function iO(e,t){aO(e)&&e.group.depend(t,"__exists")}!function(e){var t=function(e){function t(t){var n=t.policies,i=t.resultCaching,r=void 0===i||i,o=t.seed,s=e.call(this,n,new tO(r))||this;return s.stump=new oO(s),s.storageTrie=new FP(XI),o&&s.replace(o),s}return ny(t,e),t.prototype.addLayer=function(e,t){return this.stump.addLayer(e,t)},t.prototype.removeLayer=function(){return this},t.prototype.getStorage=function(){return this.storageTrie.lookupArray(arguments)},t}(e);e.Root=t}(eO||(eO={}));var rO=function(e){function t(t,n,i,r){var o=e.call(this,n.policies,r)||this;return o.id=t,o.parent=n,o.replay=i,o.group=r,i(o),o}return ny(t,e),t.prototype.addLayer=function(e,n){return new t(e,this,n,this.group)},t.prototype.removeLayer=function(e){var t=this,n=this.parent.removeLayer(e);return e===this.id?(this.group.caching&&Object.keys(this.data).forEach((function(e){var i=t.data[e],r=n.lookup(e);r?i?i!==r&&Object.keys(i).forEach((function(n){jA(i[n],r[n])||t.group.dirty(e,n)})):(t.group.dirty(e,"__exists"),Object.keys(r).forEach((function(n){t.group.dirty(e,n)}))):t.delete(e)})),n):n===this.parent?this:n.addLayer(this.id,this.replay)},t.prototype.toObject=function(){return iy(iy({},this.parent.toObject()),this.data)},t.prototype.findChildRefIds=function(t){var n=this.parent.findChildRefIds(t);return jP.call(this.data,t)?iy(iy({},n),e.prototype.findChildRefIds.call(this,t)):n},t.prototype.getStorage=function(){for(var e=this.parent;e.parent;)e=e.parent;return e.getStorage.apply(e,arguments)},t}(eO),oO=function(e){function t(t){return e.call(this,"EntityStore.Stump",t,(function(){}),new tO(t.group.caching,t.group))||this}return ny(t,e),t.prototype.removeLayer=function(){return this},t.prototype.merge=function(){return this.parent.merge.apply(this.parent,arguments)},t}(rO);function sO(e,t,n){var i=e[n],r=t[n];return jA(i,r)?i:r}function aO(e){return!!(e instanceof eO&&e.group.caching)}var lO,cO,uO=function(){function e(){this.known=new(KI?WeakSet:Set),this.pool=new FP(XI),this.passes=new WeakMap,this.keysByJSON=new Map,this.empty=this.admit({})}return e.prototype.isKnown=function(e){return NM(e)&&this.known.has(e)},e.prototype.pass=function(e){if(NM(e)){var t=function(e){return NM(e)?iI(e)?e.slice(0):iy({__proto__:Object.getPrototypeOf(e)},e):e}(e);return this.passes.set(t,e),t}return e},e.prototype.admit=function(e){var t=this;if(NM(e)){var n=this.passes.get(e);if(n)return n;switch(Object.getPrototypeOf(e)){case Array.prototype:if(this.known.has(e))return e;var i=e.map(this.admit,this);return(a=this.pool.lookupArray(i)).array||(this.known.add(a.array=i),__DEV__&&Object.freeze(i)),a.array;case null:case Object.prototype:if(this.known.has(e))return e;var r=Object.getPrototypeOf(e),o=[r],s=this.sortedKeys(e);o.push(s.json);var a,l=o.length;if(s.sorted.forEach((function(n){o.push(t.admit(e[n]))})),!(a=this.pool.lookupArray(o)).object){var c=a.object=Object.create(r);this.known.add(c),s.sorted.forEach((function(e,t){c[e]=o[l+t]})),__DEV__&&Object.freeze(c)}return a.object}}return e},e.prototype.sortedKeys=function(e){var t=Object.keys(e),n=this.pool.lookupArray(t);if(!n.keys){t.sort();var i=JSON.stringify(t);(n.keys=this.keysByJSON.get(i))||this.keysByJSON.set(i,n.keys={sorted:t,json:i})}return n.keys},e}(),dO=Object.assign((function(e){if(NM(e)){void 0===lO&&hO();var t=lO.admit(e),n=cO.get(t);return void 0===n&&cO.set(t,n=JSON.stringify(t)),n}return JSON.stringify(e)}),{reset:hO});function hO(){lO=new uO,cO=new(XI?WeakMap:Map)}function pO(e){return[e.selectionSet,e.objectOrReference,e.context,e.context.canonizeResults]}var fO=function(){function e(e){var t=this;this.knownResults=new(XI?WeakMap:Map),this.config=aA(e,{addTypename:!1!==e.addTypename,canonizeResults:GP(e)}),this.canon=e.canon||new uO,this.executeSelectionSet=OP((function(e){var n,i=e.context.canonizeResults,r=pO(e);r[3]=!i;var o=(n=t.executeSelectionSet).peek.apply(n,r);return o?i?iy(iy({},o),{result:t.canon.admit(o.result)}):o:(iO(e.context.store,e.enclosingRef.__ref),t.execSelectionSetImpl(e))}),{max:this.config.resultCacheMaxSize,keyArgs:pO,makeCacheKey:function(e,t,n,i){if(aO(n.store))return n.store.makeCacheKey(e,$M(t)?t.__ref:t,n.varString,i)}}),this.executeSubSelectedArray=OP((function(e){return iO(e.context.store,e.enclosingRef.__ref),t.execSubSelectedArrayImpl(e)}),{max:this.config.resultCacheMaxSize,makeCacheKey:function(e){var t=e.field,n=e.array,i=e.context;if(aO(i.store))return i.store.makeCacheKey(t,n,i.varString)}})}return e.prototype.resetCanon=function(){this.canon=new uO},e.prototype.diffQueryAgainstStore=function(e){var t=e.store,n=e.query,i=e.rootId,r=void 0===i?"ROOT_QUERY":i,o=e.variables,s=e.returnPartialData,a=void 0===s||s,l=e.canonizeResults,c=void 0===l?this.config.canonizeResults:l,u=this.config.cache.policies;o=iy(iy({},nI(eI(n))),o);var d,h=FM(r),p=this.executeSelectionSet({selectionSet:tI(n).selectionSet,objectOrReference:h,enclosingRef:h,context:iy({store:t,query:n,policies:u,variables:o,varString:dO(o),canonizeResults:c},KP(n,this.config.fragments))});if(p.missing&&(d=[new RP(mO(p.missing),p.missing,n,o)],!a))throw d[0];return{result:p.result,complete:!d,missing:d}},e.prototype.isFresh=function(e,t,n,i){if(aO(i.store)&&this.knownResults.get(e)===n){var r=this.executeSelectionSet.peek(n,t,i,this.canon.isKnown(e));if(r&&e===r.result)return!0}return!1},e.prototype.execSelectionSetImpl=function(e){var t=this,n=e.selectionSet,i=e.objectOrReference,r=e.enclosingRef,o=e.context;if($M(i)&&!o.policies.rootTypenamesById[i.__ref]&&!o.store.has(i.__ref))return{result:this.canon.empty,missing:"Dangling reference to missing ".concat(i.__ref," object")};var s,a=o.variables,l=o.policies,c=o.store.getFieldValue(i,"__typename"),u=[],d=new yI;function h(e,t){var n;return e.missing&&(s=d.merge(s,((n={})[t]=e.missing,n))),e.result}this.config.addTypename&&"string"==typeof c&&!l.rootIdsByTypename[c]&&u.push({__typename:c});var p=new Set(n.selections);p.forEach((function(e){var n,f;if(OM(e,a))if(XM(e)){var m=l.readField({fieldName:e.name.value,field:e,variables:o.variables,from:i},o),g=HM(e);void 0===m?uI.added(e)||(s=d.merge(s,((n={})[g]="Can't find field '".concat(e.name.value,"' on ").concat($M(i)?i.__ref+" object":"object "+JSON.stringify(i,null,2)),n))):iI(m)?m=h(t.executeSubSelectedArray({field:e,array:m,enclosingRef:r,context:o}),g):e.selectionSet?null!=m&&(m=h(t.executeSelectionSet({selectionSet:e.selectionSet,objectOrReference:m,enclosingRef:$M(m)?m:r,context:o}),g)):o.canonizeResults&&(m=t.canon.pass(m)),void 0!==m&&u.push(((f={})[g]=m,f))}else{var y=BM(e,o.lookupFragment);if(!y&&e.kind===LC.FRAGMENT_SPREAD)throw __DEV__?new sC("No fragment named ".concat(e.name.value)):new sC(5);y&&l.fragmentMatches(y,c)&&y.selectionSet.selections.forEach(p.add,p)}}));var f={result:mI(u),missing:s},m=o.canonizeResults?this.canon.admit(f):WI(f);return m.result&&this.knownResults.set(m.result,n),m},e.prototype.execSubSelectedArrayImpl=function(e){var t,n=this,i=e.field,r=e.array,o=e.enclosingRef,s=e.context,a=new yI;function l(e,n){var i;return e.missing&&(t=a.merge(t,((i={})[n]=e.missing,i))),e.result}return i.selectionSet&&(r=r.filter(s.store.canRead)),r=r.map((function(e,t){return null===e?null:iI(e)?l(n.executeSubSelectedArray({field:i,array:e,enclosingRef:o,context:s}),t):i.selectionSet?l(n.executeSelectionSet({selectionSet:i.selectionSet,objectOrReference:e,enclosingRef:$M(e)?e:o,context:s}),t):(__DEV__&&function(e,t,n){if(!t.selectionSet){var i=new Set([n]);i.forEach((function(n){NM(n)&&(__DEV__?aC(!$M(n),"Missing selection set for object of type ".concat(function(e,t){return $M(t)?e.get(t.__ref,"__typename"):t&&t.__typename}(e,n)," returned for query field ").concat(t.name.value)):aC(!$M(n),6),Object.values(n).forEach(i.add,i))}))}}(s.store,i,e),e)})),{result:s.canonizeResults?this.canon.admit(r):r,missing:t}},e}();function mO(e){try{JSON.stringify(e,(function(e,t){if("string"==typeof t)throw t;return t}))}catch(t){return t}}var gO=new rP,yO=new WeakMap;function vO(e){var t=yO.get(e);return t||yO.set(e,t={vars:new Set,dep:IP()}),t}function bO(e){vO(e).vars.forEach((function(t){return t.forgetCache(e)}))}function xO(e){var t=new Set,n=new Set,i=function(o){if(arguments.length>0){if(e!==o){e=o,t.forEach((function(e){vO(e).dep.dirty(i),function(e){e.broadcastWatches&&e.broadcastWatches()}(e)}));var s=Array.from(n);n.clear(),s.forEach((function(t){return t(e)}))}}else{var a=gO.getValue();a&&(r(a),vO(a).dep(i))}return e};i.onNextChange=function(e){return n.add(e),function(){n.delete(e)}};var r=i.attachCache=function(e){return t.add(e),vO(e).vars.add(i),i};return i.forgetCache=function(e){return t.delete(e)},i}var _O=Object.create(null);function wO(e){var t=JSON.stringify(e);return _O[t]||(_O[t]=Object.create(null))}function kO(e){var t=wO(e);return t.keyFieldsFn||(t.keyFieldsFn=function(t,n){var i=function(e,t){return n.readField(t,e)},r=n.keyObject=SO(e,(function(e){var r=MO(n.storeObject,e,i);return void 0===r&&t!==n.storeObject&&jP.call(t,e[0])&&(r=MO(t,e,CO)),__DEV__?aC(void 0!==r,"Missing field '".concat(e.join("."),"' while extracting keyFields from ").concat(JSON.stringify(t))):aC(void 0!==r,2),r}));return"".concat(n.typename,":").concat(JSON.stringify(r))})}function EO(e){var t=wO(e);return t.keyArgsFn||(t.keyArgsFn=function(t,n){var i=n.field,r=n.variables,o=n.fieldName,s=SO(e,(function(e){var n=e[0],o=n.charAt(0);if("@"!==o)if("$"!==o){if(t)return MO(t,e)}else{var s=n.slice(1);if(r&&jP.call(r,s)){var a=e.slice(0);return a[0]=s,MO(r,a)}}else if(i&&rI(i.directives)){var l=n.slice(1),c=i.directives.find((function(e){return e.name.value===l})),u=c&&WM(c,r);return u&&MO(u,e.slice(1))}})),a=JSON.stringify(s);return(t||"{}"!==a)&&(o+=":"+a),o})}function SO(e,t){var n=new yI;return TO(e).reduce((function(e,i){var r,o=t(i);if(void 0!==o){for(var s=i.length-1;s>=0;--s)(r={})[i[s]]=o,o=r;e=n.merge(e,o)}return e}),Object.create(null))}function TO(e){var t=wO(e);if(!t.paths){var n=t.paths=[],i=[];e.forEach((function(t,r){iI(t)?(TO(t).forEach((function(e){return n.push(i.concat(e))})),i.length=0):(i.push(t),iI(e[r+1])||(n.push(i.slice(0)),i.length=0))}))}return t.paths}function CO(e,t){return e[t]}function MO(e,t,n){return n=n||CO,IO(t.reduce((function e(t,i){return iI(t)?t.map((function(t){return e(t,i)})):t&&n(t,i)}),e))}function IO(e){return NM(e)?iI(e)?e.map(IO):SO(Object.keys(e).sort(),(function(t){return MO(e,t)})):e}function AO(e){return void 0!==e.args?e.args:e.field?WM(e.field,e.variables):null}UM.setStringify(dO);var PO=function(){},OO=function(e,t){return t.fieldName},DO=function(e,t,n){return(0,n.mergeObjects)(e,t)},RO=function(e,t){return t},zO=function(){function e(e){this.config=e,this.typePolicies=Object.create(null),this.toBeAdded=Object.create(null),this.supertypeMap=new Map,this.fuzzySubtypes=new Map,this.rootIdsByTypename=Object.create(null),this.rootTypenamesById=Object.create(null),this.usingPossibleTypes=!1,this.config=iy({dataIdFromObject:UP},e),this.cache=this.config.cache,this.setRootTypename("Query"),this.setRootTypename("Mutation"),this.setRootTypename("Subscription"),e.possibleTypes&&this.addPossibleTypes(e.possibleTypes),e.typePolicies&&this.addTypePolicies(e.typePolicies)}return e.prototype.identify=function(e,t){var n,i=this,r=t&&(t.typename||(null===(n=t.storeObject)||void 0===n?void 0:n.__typename))||e.__typename;if(r===this.rootTypenamesById.ROOT_QUERY)return["ROOT_QUERY"];for(var o,s=t&&t.storeObject||e,a=iy(iy({},t),{typename:r,storeObject:s,readField:t&&t.readField||function(){var e=BO(arguments,s);return i.readField(e,{store:i.cache.data,variables:e.variables})}}),l=r&&this.getTypePolicy(r),c=l&&l.keyFn||this.config.dataIdFromObject;c;){var u=c(iy(iy({},e),s),a);if(!iI(u)){o=u;break}c=kO(u)}return o=o?String(o):void 0,a.keyObject?[o,a.keyObject]:[o]},e.prototype.addTypePolicies=function(e){var t=this;Object.keys(e).forEach((function(n){var i=e[n],r=i.queryType,o=i.mutationType,s=i.subscriptionType,a=ry(i,["queryType","mutationType","subscriptionType"]);r&&t.setRootTypename("Query",n),o&&t.setRootTypename("Mutation",n),s&&t.setRootTypename("Subscription",n),jP.call(t.toBeAdded,n)?t.toBeAdded[n].push(a):t.toBeAdded[n]=[a]}))},e.prototype.updateTypePolicy=function(e,t){var n=this,i=this.getTypePolicy(e),r=t.keyFields,o=t.fields;function s(e,t){e.merge="function"==typeof t?t:!0===t?DO:!1===t?RO:e.merge}s(i,t.merge),i.keyFn=!1===r?PO:iI(r)?kO(r):"function"==typeof r?r:i.keyFn,o&&Object.keys(o).forEach((function(t){var i=n.getFieldPolicy(e,t,!0),r=o[t];if("function"==typeof r)i.read=r;else{var a=r.keyArgs,l=r.read,c=r.merge;i.keyFn=!1===a?OO:iI(a)?EO(a):"function"==typeof a?a:i.keyFn,"function"==typeof l&&(i.read=l),s(i,c)}i.read&&i.merge&&(i.keyFn=i.keyFn||OO)}))},e.prototype.setRootTypename=function(e,t){void 0===t&&(t=e);var n="ROOT_"+e.toUpperCase(),i=this.rootTypenamesById[n];t!==i&&(__DEV__?aC(!i||i===e,"Cannot change root ".concat(e," __typename more than once")):aC(!i||i===e,3),i&&delete this.rootIdsByTypename[i],this.rootIdsByTypename[t]=n,this.rootTypenamesById[n]=t)},e.prototype.addPossibleTypes=function(e){var t=this;this.usingPossibleTypes=!0,Object.keys(e).forEach((function(n){t.getSupertypeSet(n,!0),e[n].forEach((function(e){t.getSupertypeSet(e,!0).add(n);var i=e.match(WP);i&&i[0]===e||t.fuzzySubtypes.set(e,new RegExp(e))}))}))},e.prototype.getTypePolicy=function(e){var t=this;if(!jP.call(this.typePolicies,e)){var n=this.typePolicies[e]=Object.create(null);n.fields=Object.create(null);var i=this.supertypeMap.get(e);i&&i.size&&i.forEach((function(e){var i=t.getTypePolicy(e),r=i.fields,o=ry(i,["fields"]);Object.assign(n,o),Object.assign(n.fields,r)}))}var r=this.toBeAdded[e];return r&&r.length&&r.splice(0).forEach((function(n){t.updateTypePolicy(e,n)})),this.typePolicies[e]},e.prototype.getFieldPolicy=function(e,t,n){if(e){var i=this.getTypePolicy(e).fields;return i[t]||n&&(i[t]=Object.create(null))}},e.prototype.getSupertypeSet=function(e,t){var n=this.supertypeMap.get(e);return!n&&t&&this.supertypeMap.set(e,n=new Set),n},e.prototype.fragmentMatches=function(e,t,n,i){var r=this;if(!e.typeCondition)return!0;if(!t)return!1;var o=e.typeCondition.name.value;if(t===o)return!0;if(this.usingPossibleTypes&&this.supertypeMap.has(o))for(var s=this.getSupertypeSet(t,!0),a=[s],l=function(e){var t=r.getSupertypeSet(e,!1);t&&t.size&&a.indexOf(t)<0&&a.push(t)},c=!(!n||!this.fuzzySubtypes.size),u=!1,d=0;d<a.length;++d){var h=a[d];if(h.has(o))return s.has(o)||(u&&__DEV__&&aC.warn("Inferring subtype ".concat(t," of supertype ").concat(o)),s.add(o)),!0;h.forEach(l),c&&d===a.length-1&&ZP(e.selectionSet,n,i)&&(c=!1,u=!0,this.fuzzySubtypes.forEach((function(e,n){var i=t.match(e);i&&i[0]===t&&l(n)})))}return!1},e.prototype.hasKeyArgs=function(e,t){var n=this.getFieldPolicy(e,t,!1);return!(!n||!n.keyFn)},e.prototype.getStoreFieldName=function(e){var t,n=e.typename,i=e.fieldName,r=this.getFieldPolicy(n,i,!1),o=r&&r.keyFn;if(o&&n)for(var s={typename:n,fieldName:i,field:e.field||null,variables:e.variables},a=AO(e);o;){var l=o(a,s);if(!iI(l)){t=l||i;break}o=EO(l)}return void 0===t&&(t=e.field?function(e,t){var n=null;e.directives&&(n={},e.directives.forEach((function(e){n[e.name.value]={},e.arguments&&e.arguments.forEach((function(i){var r=i.name,o=i.value;return jM(n[e.name.value],r,o,t)}))})));var i=null;return e.arguments&&e.arguments.length&&(i={},e.arguments.forEach((function(e){var n=e.name,r=e.value;return jM(i,n,r,t)}))),UM(e.name.value,i,n)}(e.field,e.variables):UM(i,AO(e))),!1===t?i:i===HP(t)?t:i+":"+t},e.prototype.readField=function(e,t){var n=e.from;if(n&&(e.field||e.fieldName)){if(void 0===e.typename){var i=t.store.getFieldValue(n,"__typename");i&&(e.typename=i)}var r=this.getStoreFieldName(e),o=HP(r),s=t.store.getFieldValue(n,r),a=this.getFieldPolicy(e.typename,o,!1),l=a&&a.read;if(l){var c=LO(this,n,e,t,t.store.getStorage($M(n)?n.__ref:n,r));return gO.withValue(this.cache,l,[s,c])}return s}},e.prototype.getReadFunction=function(e,t){var n=this.getFieldPolicy(e,t,!1);return n&&n.read},e.prototype.getMergeFunction=function(e,t,n){var i=this.getFieldPolicy(e,t,!1),r=i&&i.merge;return!r&&n&&(r=(i=this.getTypePolicy(n))&&i.merge),r},e.prototype.runMergeFunction=function(e,t,n,i,r){var o=n.field,s=n.typename,a=n.merge;return a===DO?NO(i.store)(e,t):a===RO?t:(i.overwrite&&(e=void 0),a(e,t,LO(this,void 0,{typename:s,fieldName:o.name.value,field:o,variables:i.variables},i,r||Object.create(null))))},e}();function LO(e,t,n,i,r){var o=e.getStoreFieldName(n),s=HP(o),a=n.variables||i.variables,l=i.store,c=l.toReference,u=l.canRead;return{args:AO(n),field:n.field||null,fieldName:s,storeFieldName:o,variables:a,isReference:$M,toReference:c,storage:r,cache:e.cache,canRead:u,readField:function(){return e.readField(BO(arguments,t,a),i)},mergeObjects:NO(i.store)}}function BO(e,t,n){var i,r,o,s=e[0],a=e[1],l=e.length;return"string"==typeof s?i={fieldName:s,from:l>1?a:t}:(i=iy({},s),jP.call(i,"from")||(i.from=t)),__DEV__&&void 0===i.from&&__DEV__&&aC.warn("Undefined 'from' passed to readField with arguments ".concat((r=Array.from(e),o=cA("stringifyForDisplay"),JSON.stringify(r,(function(e,t){return void 0===t?o:t})).split(JSON.stringify(o)).join("<undefined>")))),void 0===i.variables&&(i.variables=n),i}function NO(e){return function(t,n){if(iI(t)||iI(n))throw __DEV__?new sC("Cannot automatically merge arrays"):new sC(4);if(NM(t)&&NM(n)){var i=e.getFieldValue(t,"__typename"),r=e.getFieldValue(n,"__typename");if(i&&r&&i!==r)return n;if($M(t)&&XP(n))return e.merge(t.__ref,n),t;if(XP(t)&&$M(n))return e.merge(t,n.__ref),n;if(XP(t)&&XP(n))return iy(iy({},t),n)}return n}}function FO(e,t,n){var i="".concat(t).concat(n),r=e.flavors.get(i);return r||e.flavors.set(i,r=e.clientOnly===t&&e.deferred===n?e:iy(iy({},e),{clientOnly:t,deferred:n})),r}var $O=function(){function e(e,t,n){this.cache=e,this.reader=t,this.fragments=n}return e.prototype.writeToStore=function(e,t){var n=this,i=t.query,r=t.result,o=t.dataId,s=t.variables,a=t.overwrite,l=JM(i),c=new yI;s=iy(iy({},nI(l)),s);var u=iy(iy({store:e,written:Object.create(null),merge:function(e,t){return c.merge(e,t)},variables:s,varString:dO(s)},KP(i,this.fragments)),{overwrite:!!a,incomingById:new Map,clientOnly:!1,deferred:!1,flavors:new Map}),d=this.processSelectionSet({result:r||Object.create(null),dataId:o,selectionSet:l.selectionSet,mergeTree:{map:new Map},context:u});if(!$M(d))throw __DEV__?new sC("Could not identify object ".concat(JSON.stringify(r))):new sC(7);return u.incomingById.forEach((function(t,i){var r=t.storeObject,o=t.mergeTree,s=t.fieldNodeSet,a=FM(i);if(o&&o.map.size){var l=n.applyMerges(o,a,r,u);if($M(l))return;r=l}if(__DEV__&&!u.overwrite){var c=Object.create(null);s.forEach((function(e){e.selectionSet&&(c[e.name.value]=!0)})),Object.keys(r).forEach((function(e){(function(e){return!0===c[HP(e)]})(e)&&!function(e){var t=o&&o.map.get(e);return Boolean(t&&t.info&&t.info.merge)}(e)&&function(e,t,n,i){var r=function(e){var t=i.getFieldValue(e,n);return"object"==typeof t&&t},o=r(e);if(o){var s=r(t);if(s&&!$M(o)&&!jA(o,s)&&!Object.keys(o).every((function(e){return void 0!==i.getFieldValue(s,e)}))){var a=i.getFieldValue(e,"__typename")||i.getFieldValue(t,"__typename"),l=HP(n),c="".concat(a,".").concat(l);if(!HO.has(c)){HO.add(c);var u=[];iI(o)||iI(s)||[o,s].forEach((function(e){var t=i.getFieldValue(e,"__typename");"string"!=typeof t||u.includes(t)||u.push(t)})),__DEV__&&aC.warn("Cache data may be lost when replacing the ".concat(l," field of a ").concat(a," object.\n\nThis could cause additional (usually avoidable) network requests to fetch data that were otherwise cached.\n\nTo address this problem (which is not a bug in Apollo Client), ").concat(u.length?"either ensure all objects of type "+u.join(" and ")+" have an ID or a custom merge function, or ":"","define a custom merge function for the ").concat(c," field, so InMemoryCache can safely merge these objects:\n\n  existing: ").concat(JSON.stringify(o).slice(0,1e3),"\n  incoming: ").concat(JSON.stringify(s).slice(0,1e3),"\n\nFor more information about these options, please refer to the documentation:\n\n  * Ensuring entity objects have IDs: https://go.apollo.dev/c/generating-unique-identifiers\n  * Defining custom merge functions: https://go.apollo.dev/c/merging-non-normalized-objects\n"))}}}}(a,r,e,u.store)}))}e.merge(i,r)})),e.retain(d.__ref),d},e.prototype.processSelectionSet=function(e){var t=this,n=e.dataId,i=e.result,r=e.selectionSet,o=e.context,s=e.mergeTree,a=this.cache.policies,l=Object.create(null),c=n&&a.rootTypenamesById[n]||ZM(i,r,o.fragmentMap)||n&&o.store.get(n,"__typename");"string"==typeof c&&(l.__typename=c);var u=function(){var e=BO(arguments,l,o.variables);if($M(e.from)){var t=o.incomingById.get(e.from.__ref);if(t){var n=a.readField(iy(iy({},e),{from:t.storeObject}),o);if(void 0!==n)return n}}return a.readField(e,o)},d=new Set;this.flattenFields(r,i,o,c).forEach((function(e,n){var r,o=HM(n),h=i[o];if(d.add(n),void 0!==h){var p=a.getStoreFieldName({typename:c,fieldName:n.name.value,field:n,variables:e.variables}),f=VO(s,p),m=t.processFieldValue(h,n,n.selectionSet?FO(e,!1,!1):e,f),g=void 0;n.selectionSet&&($M(m)||XP(m))&&(g=u("__typename",m));var y=a.getMergeFunction(c,n.name.value,g);y?f.info={field:n,typename:c,merge:y}:GO(s,p),l=e.merge(l,((r={})[p]=m,r))}else!__DEV__||e.clientOnly||e.deferred||uI.added(n)||a.getReadFunction(c,n.name.value)||__DEV__&&aC.error("Missing field '".concat(HM(n),"' while writing result ").concat(JSON.stringify(i,null,2)).substring(0,1e3))}));try{var h=a.identify(i,{typename:c,selectionSet:r,fragmentMap:o.fragmentMap,storeObject:l,readField:u}),p=h[0],f=h[1];n=n||p,f&&(l=o.merge(l,f))}catch(wT){if(!n)throw wT}if("string"==typeof n){var m=FM(n),g=o.written[n]||(o.written[n]=[]);if(g.indexOf(r)>=0)return m;if(g.push(r),this.reader&&this.reader.isFresh(i,m,r,o))return m;var y=o.incomingById.get(n);return y?(y.storeObject=o.merge(y.storeObject,l),y.mergeTree=UO(y.mergeTree,s),d.forEach((function(e){return y.fieldNodeSet.add(e)}))):o.incomingById.set(n,{storeObject:l,mergeTree:qO(s)?void 0:s,fieldNodeSet:d}),m}return l},e.prototype.processFieldValue=function(e,t,n,i){var r=this;return t.selectionSet&&null!==e?iI(e)?e.map((function(e,o){var s=r.processFieldValue(e,t,n,VO(i,o));return GO(i,o),s})):this.processSelectionSet({result:e,selectionSet:t.selectionSet,context:n,mergeTree:i}):__DEV__?UI(e):e},e.prototype.flattenFields=function(e,t,n,i){void 0===i&&(i=ZM(t,e,n.fragmentMap));var r=new Map,o=this.cache.policies,s=new FP(!1);return function e(a,l){var c=s.lookup(a,l.clientOnly,l.deferred);c.visited||(c.visited=!0,a.selections.forEach((function(s){if(OM(s,n.variables)){var a=l.clientOnly,c=l.deferred;if(a&&c||!rI(s.directives)||s.directives.forEach((function(e){var t=e.name.value;if("client"===t&&(a=!0),"defer"===t){var i=WM(e,n.variables);i&&!1===i.if||(c=!0)}})),XM(s)){var u=r.get(s);u&&(a=a&&u.clientOnly,c=c&&u.deferred),r.set(s,FO(n,a,c))}else{var d=BM(s,n.lookupFragment);if(!d&&s.kind===LC.FRAGMENT_SPREAD)throw __DEV__?new sC("No fragment named ".concat(s.name.value)):new sC(8);d&&o.fragmentMatches(d,i,t,n.variables)&&e(d.selectionSet,FO(n,a,c))}}})))}(e,n),r},e.prototype.applyMerges=function(e,t,n,i,r){var o,s=this;if(e.map.size&&!$M(n)){var a,l=iI(n)||!$M(t)&&!XP(t)?void 0:t,c=n;l&&!r&&(r=[$M(l)?l.__ref:l]);var u=function(e,t){return iI(e)?"number"==typeof t?e[t]:void 0:i.store.getFieldValue(e,String(t))};e.map.forEach((function(e,t){var n=u(l,t),o=u(c,t);if(void 0!==o){r&&r.push(t);var d=s.applyMerges(e,n,o,i,r);d!==o&&(a=a||new Map).set(t,d),r&&aC(r.pop()===t)}})),a&&(n=iI(c)?c.slice(0):iy({},c),a.forEach((function(e,t){n[t]=e})))}return e.info?this.cache.policies.runMergeFunction(t,n,e.info,i,r&&(o=i.store).getStorage.apply(o,r)):n},e}(),jO=[];function VO(e,t){var n=e.map;return n.has(t)||n.set(t,jO.pop()||{map:new Map}),n.get(t)}function UO(e,t){if(e===t||!t||qO(t))return e;if(!e||qO(e))return t;var n=e.info&&t.info?iy(iy({},e.info),t.info):e.info||t.info,i=e.map.size&&t.map.size,r={info:n,map:i?new Map:e.map.size?e.map:t.map};if(i){var o=new Set(t.map.keys());e.map.forEach((function(e,n){r.map.set(n,UO(e,t.map.get(n))),o.delete(n)})),o.forEach((function(n){r.map.set(n,UO(t.map.get(n),e.map.get(n)))}))}return r}function qO(e){return!e||!(e.info||e.map.size)}function GO(e,t){var n=e.map,i=n.get(t);i&&qO(i)&&(jO.push(i),n.delete(t))}var WO,HO=new Set,ZO=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return n.watches=new Set,n.typenameDocumentCache=new Map,n.makeVar=xO,n.txCount=0,n.config=function(e){return aA(qP,e)}(t),n.addTypename=!!n.config.addTypename,n.policies=new zO({cache:n,dataIdFromObject:n.config.dataIdFromObject,possibleTypes:n.config.possibleTypes,typePolicies:n.config.typePolicies}),n.init(),n}return ny(t,e),t.prototype.init=function(){var e=this.data=new eO.Root({policies:this.policies,resultCaching:this.config.resultCaching});this.optimisticData=e.stump,this.resetResultCache()},t.prototype.resetResultCache=function(e){var t=this,n=this.storeReader,i=this.config.fragments;this.storeWriter=new $O(this,this.storeReader=new fO({cache:this,addTypename:this.addTypename,resultCacheMaxSize:this.config.resultCacheMaxSize,canonizeResults:GP(this.config),canon:e?void 0:n&&n.canon,fragments:i}),i),this.maybeBroadcastWatch=OP((function(e,n){return t.broadcastWatch(e,n)}),{max:this.config.resultCacheMaxSize,makeCacheKey:function(e){var n=e.optimistic?t.optimisticData:t.data;if(aO(n)){var i=e.optimistic,r=e.id,o=e.variables;return n.makeCacheKey(e.query,e.callback,dO({optimistic:i,id:r,variables:o}))}}}),new Set([this.data.group,this.optimisticData.group]).forEach((function(e){return e.resetCaching()}))},t.prototype.restore=function(e){return this.init(),e&&this.data.replace(e),this},t.prototype.extract=function(e){return void 0===e&&(e=!1),(e?this.optimisticData:this.data).extract()},t.prototype.read=function(e){var t=e.returnPartialData,n=void 0!==t&&t;try{return this.storeReader.diffQueryAgainstStore(iy(iy({},e),{store:e.optimistic?this.optimisticData:this.data,config:this.config,returnPartialData:n})).result||null}catch(wT){if(wT instanceof RP)return null;throw wT}},t.prototype.write=function(e){try{return++this.txCount,this.storeWriter.writeToStore(this.data,e)}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.modify=function(e){if(jP.call(e,"id")&&!e.id)return!1;var t=e.optimistic?this.optimisticData:this.data;try{return++this.txCount,t.modify(e.id||"ROOT_QUERY",e.fields)}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.diff=function(e){return this.storeReader.diffQueryAgainstStore(iy(iy({},e),{store:e.optimistic?this.optimisticData:this.data,rootId:e.id||"ROOT_QUERY",config:this.config}))},t.prototype.watch=function(e){var t=this;return this.watches.size||function(e){vO(e).vars.forEach((function(t){return t.attachCache(e)}))}(this),this.watches.add(e),e.immediate&&this.maybeBroadcastWatch(e),function(){t.watches.delete(e)&&!t.watches.size&&bO(t),t.maybeBroadcastWatch.forget(e)}},t.prototype.gc=function(e){dO.reset();var t=this.optimisticData.gc();return e&&!this.txCount&&(e.resetResultCache?this.resetResultCache(e.resetResultIdentities):e.resetResultIdentities&&this.storeReader.resetCanon()),t},t.prototype.retain=function(e,t){return(t?this.optimisticData:this.data).retain(e)},t.prototype.release=function(e,t){return(t?this.optimisticData:this.data).release(e)},t.prototype.identify=function(e){if($M(e))return e.__ref;try{return this.policies.identify(e)[0]}catch(wT){__DEV__&&aC.warn(wT)}},t.prototype.evict=function(e){if(!e.id){if(jP.call(e,"id"))return!1;e=iy(iy({},e),{id:"ROOT_QUERY"})}try{return++this.txCount,this.optimisticData.evict(e,this.data)}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.reset=function(e){var t=this;return this.init(),dO.reset(),e&&e.discardWatches?(this.watches.forEach((function(e){return t.maybeBroadcastWatch.forget(e)})),this.watches.clear(),bO(this)):this.broadcastWatches(),Promise.resolve()},t.prototype.removeOptimistic=function(e){var t=this.optimisticData.removeLayer(e);t!==this.optimisticData&&(this.optimisticData=t,this.broadcastWatches())},t.prototype.batch=function(e){var t,n=this,i=e.update,r=e.optimistic,o=void 0===r||r,s=e.removeOptimistic,a=e.onWatchUpdated,l=function(e){var r=n,o=r.data,s=r.optimisticData;++n.txCount,e&&(n.data=n.optimisticData=e);try{return t=i(n)}finally{--n.txCount,n.data=o,n.optimisticData=s}},c=new Set;return a&&!this.txCount&&this.broadcastWatches(iy(iy({},e),{onWatchUpdated:function(e){return c.add(e),!1}})),"string"==typeof o?this.optimisticData=this.optimisticData.addLayer(o,l):!1===o?l(this.data):l(),"string"==typeof s&&(this.optimisticData=this.optimisticData.removeLayer(s)),a&&c.size?(this.broadcastWatches(iy(iy({},e),{onWatchUpdated:function(e,t){var n=a.call(this,e,t);return!1!==n&&c.delete(e),n}})),c.size&&c.forEach((function(e){return n.maybeBroadcastWatch.dirty(e)}))):this.broadcastWatches(e),t},t.prototype.performTransaction=function(e,t){return this.batch({update:e,optimistic:t||null!==t})},t.prototype.transformDocument=function(e){if(this.addTypename){var t=this.typenameDocumentCache.get(e);return t||(t=uI(e),this.typenameDocumentCache.set(e,t),this.typenameDocumentCache.set(t,t)),t}return e},t.prototype.transformForLink=function(e){var t=this.config.fragments;return t?t.transform(e):e},t.prototype.broadcastWatches=function(e){var t=this;this.txCount||this.watches.forEach((function(n){return t.maybeBroadcastWatch(n,e)}))},t.prototype.broadcastWatch=function(e,t){var n=e.lastDiff,i=this.diff(e);t&&(e.optimistic&&"string"==typeof t.optimistic&&(i.fromOptimisticTransaction=!0),t.onWatchUpdated&&!1===t.onWatchUpdated.call(this,e,i,n))||n&&jA(n.result,i.result)||e.callback(e.lastDiff=i,n)},t}(DP);function XO(e){return!!e&&e<7}!function(e){e[e.loading=1]="loading",e[e.setVariables=2]="setVariables",e[e.fetchMore=3]="fetchMore",e[e.refetch=4]="refetch",e[e.poll=6]="poll",e[e.ready=7]="ready",e[e.error=8]="error"}(WO||(WO={}));var KO=Object.assign,JO=Object.hasOwnProperty,YO=function(e){function t(t){var n=t.queryManager,i=t.queryInfo,r=t.options,o=e.call(this,(function(e){try{var n=e._subscription._observer;n&&!n.error&&(n.error=eD)}catch(t){}var i=!o.observers.size;o.observers.add(e);var r=o.last;return r&&r.error?e.error&&e.error(r.error):r&&r.result&&e.next&&e.next(r.result),i&&o.reobserve().catch((function(){})),function(){o.observers.delete(e)&&!o.observers.size&&o.tearDownQuery()}}))||this;o.observers=new Set,o.subscriptions=new Set,o.queryInfo=i,o.queryManager=n,o.waitForOwnResult=nD(r.fetchPolicy),o.isTornDown=!1;var s=n.defaultOptions.watchQuery,a=(void 0===s?{}:s).fetchPolicy,l=void 0===a?"cache-first":a,c=r.fetchPolicy,u=void 0===c?l:c,d=r.initialFetchPolicy,h=void 0===d?"standby"===u?l:u:d;o.options=iy(iy({},r),{initialFetchPolicy:h,fetchPolicy:u}),o.queryId=i.queryId||n.generateQueryId();var p=JM(o.query);return o.queryName=p&&p.name&&p.name.value,o}return ny(t,e),Object.defineProperty(t.prototype,"query",{get:function(){return this.queryManager.transform(this.options.query).document},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"variables",{get:function(){return this.options.variables},enumerable:!1,configurable:!0}),t.prototype.result=function(){var e=this;return new Promise((function(t,n){var i={next:function(n){t(n),e.observers.delete(i),e.observers.size||e.queryManager.removeQuery(e.queryId),setTimeout((function(){r.unsubscribe()}),0)},error:n},r=e.subscribe(i)}))},t.prototype.getCurrentResult=function(e){void 0===e&&(e=!0);var t=this.getLastResult(!0),n=this.queryInfo.networkStatus||t&&t.networkStatus||WO.ready,i=iy(iy({},t),{loading:XO(n),networkStatus:n}),r=this.options.fetchPolicy,o=void 0===r?"cache-first":r;if(nD(o)||this.queryManager.transform(this.options.query).hasForcedResolvers);else if(this.waitForOwnResult)this.queryInfo.updateWatch();else{var s=this.queryInfo.getDiff();(s.complete||this.options.returnPartialData)&&(i.data=s.result),jA(i.data,{})&&(i.data=void 0),s.complete?(delete i.partial,!s.complete||i.networkStatus!==WO.loading||"cache-first"!==o&&"cache-only"!==o||(i.networkStatus=WO.ready,i.loading=!1)):i.partial=!0,!__DEV__||s.complete||this.options.partialRefetch||i.loading||i.data||i.error||tD(s.missing)}return e&&this.updateLastResult(i),i},t.prototype.isDifferentFromLastResult=function(e,t){return!this.last||!jA(this.last.result,e)||t&&!jA(this.last.variables,t)},t.prototype.getLast=function(e,t){var n=this.last;if(n&&n[e]&&(!t||jA(n.variables,this.variables)))return n[e]},t.prototype.getLastResult=function(e){return this.getLast("result",e)},t.prototype.getLastError=function(e){return this.getLast("error",e)},t.prototype.resetLastResults=function(){delete this.last,this.isTornDown=!1},t.prototype.resetQueryStoreErrors=function(){this.queryManager.resetErrors(this.queryId)},t.prototype.refetch=function(e){var t,n={pollInterval:0},i=this.options.fetchPolicy;if(n.fetchPolicy="cache-and-network"===i?i:"no-cache"===i?"no-cache":"network-only",__DEV__&&e&&JO.call(e,"variables")){var r=eI(this.query),o=r.variableDefinitions;o&&o.some((function(e){return"variables"===e.variable.name.value}))||__DEV__&&aC.warn("Called refetch(".concat(JSON.stringify(e),") for query ").concat((null===(t=r.name)||void 0===t?void 0:t.value)||JSON.stringify(r),", which does not declare a $variables variable.\nDid you mean to call refetch(variables) instead of refetch({ variables })?"))}return e&&!jA(this.options.variables,e)&&(n.variables=this.options.variables=iy(iy({},this.options.variables),e)),this.queryInfo.resetLastWrite(),this.reobserve(n,WO.refetch)},t.prototype.fetchMore=function(e){var t=this,n=iy(iy({},e.query?e:iy(iy(iy(iy({},this.options),{query:this.query}),e),{variables:iy(iy({},this.options.variables),e.variables)})),{fetchPolicy:"no-cache"}),i=this.queryManager.generateQueryId(),r=this.queryInfo,o=r.networkStatus;r.networkStatus=WO.fetchMore,n.notifyOnNetworkStatusChange&&this.observe();var s=new Set;return this.queryManager.fetchQuery(i,n,WO.fetchMore).then((function(a){return t.queryManager.removeQuery(i),r.networkStatus===WO.fetchMore&&(r.networkStatus=o),t.queryManager.cache.batch({update:function(i){var r=e.updateQuery;r?i.updateQuery({query:t.query,variables:t.variables,returnPartialData:!0,optimistic:!1},(function(e){return r(e,{fetchMoreResult:a.data,variables:n.variables})})):i.writeQuery({query:n.query,variables:n.variables,data:a.data})},onWatchUpdated:function(e){s.add(e.query)}}),a})).finally((function(){s.has(t.query)||QO(t)}))},t.prototype.subscribeToMore=function(e){var t=this,n=this.queryManager.startGraphQLSubscription({query:e.document,variables:e.variables,context:e.context}).subscribe({next:function(n){var i=e.updateQuery;i&&t.updateQuery((function(e,t){var r=t.variables;return i(e,{subscriptionData:n,variables:r})}))},error:function(t){e.onError?e.onError(t):__DEV__&&aC.error("Unhandled GraphQL subscription error",t)}});return this.subscriptions.add(n),function(){t.subscriptions.delete(n)&&n.unsubscribe()}},t.prototype.setOptions=function(e){return this.reobserve(e)},t.prototype.setVariables=function(e){return jA(this.variables,e)?this.observers.size?this.result():Promise.resolve():(this.options.variables=e,this.observers.size?this.reobserve({fetchPolicy:this.options.initialFetchPolicy,variables:e},WO.setVariables):Promise.resolve())},t.prototype.updateQuery=function(e){var t=this.queryManager,n=e(t.cache.diff({query:this.options.query,variables:this.variables,returnPartialData:!0,optimistic:!1}).result,{variables:this.variables});n&&(t.cache.writeQuery({query:this.options.query,data:n,variables:this.variables}),t.broadcastQueries())},t.prototype.startPolling=function(e){this.options.pollInterval=e,this.updatePolling()},t.prototype.stopPolling=function(){this.options.pollInterval=0,this.updatePolling()},t.prototype.applyNextFetchPolicy=function(e,t){if(t.nextFetchPolicy){var n=t.fetchPolicy,i=void 0===n?"cache-first":n,r=t.initialFetchPolicy,o=void 0===r?i:r;"standby"===i||("function"==typeof t.nextFetchPolicy?t.fetchPolicy=t.nextFetchPolicy(i,{reason:e,options:t,observable:this,initialFetchPolicy:o}):t.fetchPolicy="variables-changed"===e?o:t.nextFetchPolicy)}return t.fetchPolicy},t.prototype.fetch=function(e,t){return this.queryManager.setObservableQuery(this),this.queryManager.fetchConcastWithInfo(this.queryId,e,t)},t.prototype.updatePolling=function(){var e=this;if(!this.queryManager.ssrMode){var t=this.pollingInfo,n=this.options.pollInterval;if(n){if(!t||t.interval!==n){__DEV__?aC(n,"Attempted to start a polling query without a polling interval."):aC(n,13),(t||(this.pollingInfo={})).interval=n;var i=function(){e.pollingInfo&&(XO(e.queryInfo.networkStatus)?r():e.reobserve({fetchPolicy:"no-cache"===e.options.initialFetchPolicy?"no-cache":"network-only"},WO.poll).then(r,r))},r=function(){var t=e.pollingInfo;t&&(clearTimeout(t.timeout),t.timeout=setTimeout(i,t.interval))};r()}}else t&&(clearTimeout(t.timeout),delete this.pollingInfo)}},t.prototype.updateLastResult=function(e,t){return void 0===t&&(t=this.variables),this.last=iy(iy({},this.last),{result:this.queryManager.assumeImmutableResults?e:UI(e),variables:t}),rI(e.errors)||delete this.last.error,this.last},t.prototype.reobserveAsConcast=function(e,t){var n=this;this.isTornDown=!1;var i=t===WO.refetch||t===WO.fetchMore||t===WO.poll,r=this.options.variables,o=this.options.fetchPolicy,s=aA(this.options,e||{}),a=i?s:KO(this.options,s);i||(this.updatePolling(),e&&e.variables&&!jA(e.variables,r)&&"standby"!==a.fetchPolicy&&a.fetchPolicy===o&&(this.applyNextFetchPolicy("variables-changed",a),void 0===t&&(t=WO.setVariables))),this.waitForOwnResult&&(this.waitForOwnResult=nD(a.fetchPolicy));var l=function(){n.concast===d&&(n.waitForOwnResult=!1)},c=a.variables&&iy({},a.variables),u=this.fetch(a,t),d=u.concast,h=u.fromLink,p={next:function(e){l(),n.reportResult(e,c)},error:function(e){l(),n.reportError(e,c)}};return!i&&h&&(this.concast&&this.observer&&this.concast.removeObserver(this.observer),this.concast=d,this.observer=p),d.addObserver(p),d},t.prototype.reobserve=function(e,t){return this.reobserveAsConcast(e,t).promise},t.prototype.observe=function(){this.reportResult(this.getCurrentResult(!1),this.variables)},t.prototype.reportResult=function(e,t){var n=this.getLastError();(n||this.isDifferentFromLastResult(e,t))&&((n||!e.partial||this.options.returnPartialData)&&this.updateLastResult(e,t),HI(this.observers,"next",e))},t.prototype.reportError=function(e,t){var n=iy(iy({},this.getLastResult()),{error:e,errors:e.graphQLErrors,networkStatus:WO.error,loading:!1});this.updateLastResult(n,t),HI(this.observers,"error",this.last.error=e)},t.prototype.hasObservers=function(){return this.observers.size>0},t.prototype.tearDownQuery=function(){this.isTornDown||(this.concast&&this.observer&&(this.concast.removeObserver(this.observer),delete this.concast,delete this.observer),this.stopPolling(),this.subscriptions.forEach((function(e){return e.unsubscribe()})),this.subscriptions.clear(),this.queryManager.stopQuery(this.queryId),this.observers.clear(),this.isTornDown=!0)},t}(FI);function QO(e){var t=e.options,n=t.fetchPolicy,i=t.nextFetchPolicy;return"cache-and-network"===n||"network-only"===n?e.reobserve({fetchPolicy:"cache-first",nextFetchPolicy:function(){return this.nextFetchPolicy=i,"function"==typeof i?i.apply(this,arguments):n}}):e.reobserve()}function eD(e){__DEV__&&aC.error("Unhandled error",e.message,e.stack)}function tD(e){__DEV__&&e&&__DEV__&&aC.debug("Missing cache result fields: ".concat(JSON.stringify(e)),e)}function nD(e){return"network-only"===e||"no-cache"===e||"standby"===e}QI(YO);var iD=function(){function e(e){var t=e.cache,n=e.client,i=e.resolvers,r=e.fragmentMatcher;this.selectionsToResolveCache=new WeakMap,this.cache=t,n&&(this.client=n),i&&this.addResolvers(i),r&&this.setFragmentMatcher(r)}return e.prototype.addResolvers=function(e){var t=this;this.resolvers=this.resolvers||{},Array.isArray(e)?e.forEach((function(e){t.resolvers=fI(t.resolvers,e)})):this.resolvers=fI(this.resolvers,e)},e.prototype.setResolvers=function(e){this.resolvers={},this.addResolvers(e)},e.prototype.getResolvers=function(){return this.resolvers||{}},e.prototype.runResolvers=function(e){var t=e.document,n=e.remoteResult,i=e.context,r=e.variables,o=e.onlyRunForcedResolvers,s=void 0!==o&&o;return oy(this,void 0,void 0,(function(){return sy(this,(function(e){return t?[2,this.resolveDocument(t,n.data,i,r,this.fragmentMatcher,s).then((function(e){return iy(iy({},n),{data:e.result})}))]:[2,n]}))}))},e.prototype.setFragmentMatcher=function(e){this.fragmentMatcher=e},e.prototype.getFragmentMatcher=function(){return this.fragmentMatcher},e.prototype.clientQuery=function(e){return DM(["client"],e)&&this.resolvers?e:null},e.prototype.serverQuery=function(e){return function(e){return KM(e),cI([{test:function(e){return"client"===e.name.value},remove:!0}],e)}(e)},e.prototype.prepareContext=function(e){var t=this.cache;return iy(iy({},e),{cache:t,getCacheKey:function(e){return t.identify(e)}})},e.prototype.addExportedVariables=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),oy(this,void 0,void 0,(function(){return sy(this,(function(i){return e?[2,this.resolveDocument(e,this.buildRootValueFromCache(e,t)||{},this.prepareContext(n),t).then((function(e){return iy(iy({},t),e.exportedVariables)}))]:[2,iy({},t)]}))}))},e.prototype.shouldForceResolvers=function(e){var t=!1;return wM(e,{Directive:{enter:function(e){if("client"===e.name.value&&e.arguments&&(t=e.arguments.some((function(e){return"always"===e.name.value&&"BooleanValue"===e.value.kind&&!0===e.value.value}))))return _M}}}),t},e.prototype.buildRootValueFromCache=function(e,t){return this.cache.diff({query:hI(e),variables:t,returnPartialData:!0,optimistic:!1}).result},e.prototype.resolveDocument=function(e,t,n,i,r,o){return void 0===n&&(n={}),void 0===i&&(i={}),void 0===r&&(r=function(){return!0}),void 0===o&&(o=!1),oy(this,void 0,void 0,(function(){var s,a,l,c,u,d,h,p,f,m;return sy(this,(function(g){return s=tI(e),a=QM(e),l=LM(a),c=this.collectSelectionsToResolve(s,l),u=s.operation,d=u?u.charAt(0).toUpperCase()+u.slice(1):"Query",p=(h=this).cache,f=h.client,m={fragmentMap:l,context:iy(iy({},n),{cache:p,client:f}),variables:i,fragmentMatcher:r,defaultOperationType:d,exportedVariables:{},selectionsToResolve:c,onlyRunForcedResolvers:o},[2,this.resolveSelectionSet(s.selectionSet,!1,t,m).then((function(e){return{result:e,exportedVariables:m.exportedVariables}}))]}))}))},e.prototype.resolveSelectionSet=function(e,t,n,i){return oy(this,void 0,void 0,(function(){var r,o,s,a,l,c=this;return sy(this,(function(u){return r=i.fragmentMap,o=i.context,s=i.variables,a=[n],l=function(e){return oy(c,void 0,void 0,(function(){var l,c;return sy(this,(function(u){return(t||i.selectionsToResolve.has(e))&&OM(e,s)?XM(e)?[2,this.resolveField(e,t,n,i).then((function(t){var n;void 0!==t&&a.push(((n={})[HM(e)]=t,n))}))]:(function(e){return"InlineFragment"===e.kind}(e)?l=e:(l=r[e.name.value],__DEV__?aC(l,"No fragment named ".concat(e.name.value)):aC(l,11)),l&&l.typeCondition&&(c=l.typeCondition.name.value,i.fragmentMatcher(n,c,o))?[2,this.resolveSelectionSet(l.selectionSet,t,n,i).then((function(e){a.push(e)}))]:[2]):[2]}))}))},[2,Promise.all(e.selections.map(l)).then((function(){return mI(a)}))]}))}))},e.prototype.resolveField=function(e,t,n,i){return oy(this,void 0,void 0,(function(){var r,o,s,a,l,c,u,d,h,p=this;return sy(this,(function(f){return n?(r=i.variables,o=e.name.value,s=HM(e),a=o!==s,l=n[s]||n[o],c=Promise.resolve(l),i.onlyRunForcedResolvers&&!this.shouldForceResolvers(e)||(u=n.__typename||i.defaultOperationType,(d=this.resolvers&&this.resolvers[u])&&(h=d[a?o:s])&&(c=Promise.resolve(gO.withValue(this.cache,h,[n,WM(e,r),i.context,{field:e,fragmentMap:i.fragmentMap}])))),[2,c.then((function(n){var r,o;if(void 0===n&&(n=l),e.directives&&e.directives.forEach((function(e){"export"===e.name.value&&e.arguments&&e.arguments.forEach((function(e){"as"===e.name.value&&"StringValue"===e.value.kind&&(i.exportedVariables[e.value.value]=n)}))})),!e.selectionSet)return n;if(null==n)return n;var s=null!==(o=null===(r=e.directives)||void 0===r?void 0:r.some((function(e){return"client"===e.name.value})))&&void 0!==o&&o;return Array.isArray(n)?p.resolveSubSelectedArray(e,t||s,n,i):e.selectionSet?p.resolveSelectionSet(e.selectionSet,t||s,n,i):void 0}))]):[2,null]}))}))},e.prototype.resolveSubSelectedArray=function(e,t,n,i){var r=this;return Promise.all(n.map((function(n){return null===n?null:Array.isArray(n)?r.resolveSubSelectedArray(e,t,n,i):e.selectionSet?r.resolveSelectionSet(e.selectionSet,t,n,i):void 0})))},e.prototype.collectSelectionsToResolve=function(e,t){var n=function(e){return!Array.isArray(e)},i=this.selectionsToResolveCache;return function e(r){if(!i.has(r)){var o=new Set;i.set(r,o),wM(r,{Directive:function(e,t,i,r,s){"client"===e.name.value&&s.forEach((function(e){n(e)&&PM(e)&&o.add(e)}))},FragmentSpread:function(i,r,s,a,l){var c=t[i.name.value];__DEV__?aC(c,"No fragment named ".concat(i.name.value)):aC(c,12);var u=e(c);u.size>0&&(l.forEach((function(e){n(e)&&PM(e)&&o.add(e)})),o.add(i),u.forEach((function(e){o.add(e)})))}})}return i.get(r)}(e)},e}(),rD=new(XI?WeakMap:Map);function oD(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){return rD.set(e,(rD.get(e)+1)%1e15),n.apply(this,arguments)})}function sD(e){e.notifyTimeout&&(clearTimeout(e.notifyTimeout),e.notifyTimeout=void 0)}var aD=function(){function e(e,t){void 0===t&&(t=e.generateQueryId()),this.queryId=t,this.listeners=new Set,this.document=null,this.lastRequestId=1,this.subscriptions=new Set,this.stopped=!1,this.dirty=!1,this.observableQuery=null;var n=this.cache=e.cache;rD.has(n)||(rD.set(n,0),oD(n,"evict"),oD(n,"modify"),oD(n,"reset"))}return e.prototype.init=function(e){var t=e.networkStatus||WO.loading;return this.variables&&this.networkStatus!==WO.loading&&!jA(this.variables,e.variables)&&(t=WO.setVariables),jA(e.variables,this.variables)||(this.lastDiff=void 0),Object.assign(this,{document:e.document,variables:e.variables,networkError:null,graphQLErrors:this.graphQLErrors||[],networkStatus:t}),e.observableQuery&&this.setObservableQuery(e.observableQuery),e.lastRequestId&&(this.lastRequestId=e.lastRequestId),this},e.prototype.reset=function(){sD(this),this.dirty=!1},e.prototype.getDiff=function(e){void 0===e&&(e=this.variables);var t=this.getDiffOptions(e);if(this.lastDiff&&jA(t,this.lastDiff.options))return this.lastDiff.diff;this.updateWatch(this.variables=e);var n=this.observableQuery;if(n&&"no-cache"===n.options.fetchPolicy)return{complete:!1};var i=this.cache.diff(t);return this.updateLastDiff(i,t),i},e.prototype.updateLastDiff=function(e,t){this.lastDiff=e?{diff:e,options:t||this.getDiffOptions()}:void 0},e.prototype.getDiffOptions=function(e){var t;return void 0===e&&(e=this.variables),{query:this.document,variables:e,returnPartialData:!0,optimistic:!0,canonizeResults:null===(t=this.observableQuery)||void 0===t?void 0:t.options.canonizeResults}},e.prototype.setDiff=function(e){var t=this,n=this.lastDiff&&this.lastDiff.diff;this.updateLastDiff(e),this.dirty||jA(n&&n.result,e&&e.result)||(this.dirty=!0,this.notifyTimeout||(this.notifyTimeout=setTimeout((function(){return t.notify()}),0)))},e.prototype.setObservableQuery=function(e){var t=this;e!==this.observableQuery&&(this.oqListener&&this.listeners.delete(this.oqListener),this.observableQuery=e,e?(e.queryInfo=this,this.listeners.add(this.oqListener=function(){t.getDiff().fromOptimisticTransaction?e.observe():QO(e)})):delete this.oqListener)},e.prototype.notify=function(){var e=this;sD(this),this.shouldNotify()&&this.listeners.forEach((function(t){return t(e)})),this.dirty=!1},e.prototype.shouldNotify=function(){if(!this.dirty||!this.listeners.size)return!1;if(XO(this.networkStatus)&&this.observableQuery){var e=this.observableQuery.options.fetchPolicy;if("cache-only"!==e&&"cache-and-network"!==e)return!1}return!0},e.prototype.stop=function(){if(!this.stopped){this.stopped=!0,this.reset(),this.cancel(),this.cancel=e.prototype.cancel,this.subscriptions.forEach((function(e){return e.unsubscribe()}));var t=this.observableQuery;t&&t.stopPolling()}},e.prototype.cancel=function(){},e.prototype.updateWatch=function(e){var t=this;void 0===e&&(e=this.variables);var n=this.observableQuery;if(!n||"no-cache"!==n.options.fetchPolicy){var i=iy(iy({},this.getDiffOptions(e)),{watcher:this,callback:function(e){return t.setDiff(e)}});this.lastWatch&&jA(i,this.lastWatch)||(this.cancel(),this.cancel=this.cache.watch(this.lastWatch=i))}},e.prototype.resetLastWrite=function(){this.lastWrite=void 0},e.prototype.shouldWrite=function(e,t){var n=this.lastWrite;return!(n&&n.dmCount===rD.get(this.cache)&&jA(t,n.variables)&&jA(e.data,n.result.data))},e.prototype.markResult=function(e,t,n,i){var r=this,o=new yI,s=rI(e.errors)?e.errors.slice(0):[];if(this.reset(),"incremental"in e&&rI(e.incremental)){var a=rA(this.getDiff().result,e);e.data=a}else if("hasNext"in e&&e.hasNext){var l=this.getDiff();e.data=o.merge(l.result,e.data)}this.graphQLErrors=s,"no-cache"===n.fetchPolicy?this.updateLastDiff({result:e.data,complete:!0},this.getDiffOptions(n.variables)):0!==i&&(lD(e,n.errorPolicy)?this.cache.performTransaction((function(o){if(r.shouldWrite(e,n.variables))o.writeQuery({query:t,data:e.data,variables:n.variables,overwrite:1===i}),r.lastWrite={result:e,variables:n.variables,dmCount:rD.get(r.cache)};else if(r.lastDiff&&r.lastDiff.diff.complete)return void(e.data=r.lastDiff.diff.result);var s=r.getDiffOptions(n.variables),a=o.diff(s);r.stopped||r.updateWatch(n.variables),r.updateLastDiff(a,s),a.complete&&(e.data=a.result)})):this.lastWrite=void 0)},e.prototype.markReady=function(){return this.networkError=null,this.networkStatus=WO.ready},e.prototype.markError=function(e){return this.networkStatus=WO.error,this.lastWrite=void 0,this.reset(),e.graphQLErrors&&(this.graphQLErrors=e.graphQLErrors),e.networkError&&(this.networkError=e.networkError),e},e}();function lD(e,t){void 0===t&&(t="none");var n="ignore"===t||"all"===t,i=!oA(e);return!i&&n&&e.data&&(i=!0),i}var cD=Object.prototype.hasOwnProperty,uD=function(){function e(e){var t=e.cache,n=e.link,i=e.defaultOptions,r=e.queryDeduplication,o=void 0!==r&&r,s=e.onBroadcast,a=e.ssrMode,l=void 0!==a&&a,c=e.clientAwareness,u=void 0===c?{}:c,d=e.localState,h=e.assumeImmutableResults;this.clientAwareness={},this.queries=new Map,this.fetchCancelFns=new Map,this.transformCache=new(XI?WeakMap:Map),this.queryIdCounter=1,this.requestIdCounter=1,this.mutationIdCounter=1,this.inFlightLinkObservables=new Map,this.cache=t,this.link=n,this.defaultOptions=i||Object.create(null),this.queryDeduplication=o,this.clientAwareness=u,this.localState=d||new iD({cache:t}),this.ssrMode=l,this.assumeImmutableResults=!!h,(this.onBroadcast=s)&&(this.mutationStore=Object.create(null))}return e.prototype.stop=function(){var e=this;this.queries.forEach((function(t,n){e.stopQueryNoBroadcast(n)})),this.cancelPendingFetches(__DEV__?new sC("QueryManager stopped while query was in flight"):new sC(14))},e.prototype.cancelPendingFetches=function(e){this.fetchCancelFns.forEach((function(t){return t(e)})),this.fetchCancelFns.clear()},e.prototype.mutate=function(e){var t,n,i=e.mutation,r=e.variables,o=e.optimisticResponse,s=e.updateQueries,a=e.refetchQueries,l=void 0===a?[]:a,c=e.awaitRefetchQueries,u=void 0!==c&&c,d=e.update,h=e.onQueryUpdated,p=e.fetchPolicy,f=void 0===p?(null===(t=this.defaultOptions.mutate)||void 0===t?void 0:t.fetchPolicy)||"network-only":p,m=e.errorPolicy,g=void 0===m?(null===(n=this.defaultOptions.mutate)||void 0===n?void 0:n.errorPolicy)||"none":m,y=e.keepRootFields,v=e.context;return oy(this,void 0,void 0,(function(){var e,t,n,a,c,p;return sy(this,(function(m){switch(m.label){case 0:return __DEV__?aC(i,"mutation option is required. You must specify your GraphQL document in the mutation option."):aC(i,15),__DEV__?aC("network-only"===f||"no-cache"===f,"Mutations support only 'network-only' or 'no-cache' fetchPolicy strings. The default `network-only` behavior automatically writes mutation results to the cache. Passing `no-cache` skips the cache write."):aC("network-only"===f||"no-cache"===f,16),e=this.generateMutationId(),t=this.transform(i),n=t.document,a=t.hasClientExports,i=this.cache.transformForLink(n),r=this.getVariables(i,r),a?[4,this.localState.addExportedVariables(i,r,v)]:[3,2];case 1:r=m.sent(),m.label=2;case 2:return c=this.mutationStore&&(this.mutationStore[e]={mutation:i,variables:r,loading:!0,error:null}),o&&this.markMutationOptimistic(o,{mutationId:e,document:i,variables:r,fetchPolicy:f,errorPolicy:g,context:v,updateQueries:s,update:d,keepRootFields:y}),this.broadcastQueries(),p=this,[2,new Promise((function(t,n){return ZI(p.getObservableFromLink(i,iy(iy({},v),{optimisticResponse:o}),r,!1),(function(t){if(oA(t)&&"none"===g)throw new EA({graphQLErrors:sA(t)});c&&(c.loading=!1,c.error=null);var n=iy({},t);return"function"==typeof l&&(l=l(n)),"ignore"===g&&oA(n)&&delete n.errors,p.markMutationResult({mutationId:e,result:n,document:i,variables:r,fetchPolicy:f,errorPolicy:g,context:v,update:d,updateQueries:s,awaitRefetchQueries:u,refetchQueries:l,removeOptimistic:o?e:void 0,onQueryUpdated:h,keepRootFields:y})})).subscribe({next:function(e){p.broadcastQueries(),"hasNext"in e&&!1!==e.hasNext||t(e)},error:function(t){c&&(c.loading=!1,c.error=t),o&&p.cache.removeOptimistic(e),p.broadcastQueries(),n(t instanceof EA?t:new EA({networkError:t}))}})}))]}}))}))},e.prototype.markMutationResult=function(e,t){var n=this;void 0===t&&(t=this.cache);var i=e.result,r=[],o="no-cache"===e.fetchPolicy;if(!o&&lD(i,e.errorPolicy)){if(nA(i)||r.push({result:i.data,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}),nA(i)&&rI(i.incremental)){var s=t.diff({id:"ROOT_MUTATION",query:this.transform(e.document).asQuery,variables:e.variables,optimistic:!1,returnPartialData:!0}),a=void 0;s.result&&(a=rA(s.result,i)),void 0!==a&&(i.data=a,r.push({result:a,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}))}var l=e.updateQueries;l&&this.queries.forEach((function(e,o){var s=e.observableQuery,a=s&&s.queryName;if(a&&cD.call(l,a)){var c=l[a],u=n.queries.get(o),d=u.document,h=u.variables,p=t.diff({query:d,variables:h,returnPartialData:!0,optimistic:!1}),f=p.result;if(p.complete&&f){var m=c(f,{mutationResult:i,queryName:d&&YM(d)||void 0,queryVariables:h});m&&r.push({result:m,dataId:"ROOT_QUERY",query:d,variables:h})}}}))}if(r.length>0||e.refetchQueries||e.update||e.onQueryUpdated||e.removeOptimistic){var c=[];if(this.refetchQueries({updateCache:function(t){o||r.forEach((function(e){return t.write(e)}));var s,a=e.update,l=!(nA(s=i)||function(e){return"hasNext"in e&&"data"in e}(s))||nA(i)&&!i.hasNext;if(a){if(!o){var c=t.diff({id:"ROOT_MUTATION",query:n.transform(e.document).asQuery,variables:e.variables,optimistic:!1,returnPartialData:!0});c.complete&&("incremental"in(i=iy(iy({},i),{data:c.result}))&&delete i.incremental,"hasNext"in i&&delete i.hasNext)}l&&a(t,i,{context:e.context,variables:e.variables})}o||e.keepRootFields||!l||t.modify({id:"ROOT_MUTATION",fields:function(e,t){var n=t.fieldName,i=t.DELETE;return"__typename"===n?e:i}})},include:e.refetchQueries,optimistic:!1,removeOptimistic:e.removeOptimistic,onQueryUpdated:e.onQueryUpdated||null}).forEach((function(e){return c.push(e)})),e.awaitRefetchQueries||e.onQueryUpdated)return Promise.all(c).then((function(){return i}))}return Promise.resolve(i)},e.prototype.markMutationOptimistic=function(e,t){var n=this,i="function"==typeof e?e(t.variables):e;return this.cache.recordOptimisticTransaction((function(e){try{n.markMutationResult(iy(iy({},t),{result:{data:i}}),e)}catch(r){__DEV__&&aC.error(r)}}),t.mutationId)},e.prototype.fetchQuery=function(e,t,n){return this.fetchQueryObservable(e,t,n).promise},e.prototype.getQueryStore=function(){var e=Object.create(null);return this.queries.forEach((function(t,n){e[n]={variables:t.variables,networkStatus:t.networkStatus,networkError:t.networkError,graphQLErrors:t.graphQLErrors}})),e},e.prototype.resetErrors=function(e){var t=this.queries.get(e);t&&(t.networkError=void 0,t.graphQLErrors=[])},e.prototype.transform=function(e){var t=this.transformCache;if(!t.has(e)){var n=this.cache.transformDocument(e),i=function(e){return cI([dI],KM(e))}(n),r=this.localState.clientQuery(n),o=i&&this.localState.serverQuery(i),s={document:n,hasClientExports:RM(n),hasForcedResolvers:this.localState.shouldForceResolvers(n),clientQuery:r,serverQuery:o,defaultVars:nI(JM(n)),asQuery:iy(iy({},n),{definitions:n.definitions.map((function(e){return"OperationDefinition"===e.kind&&"query"!==e.operation?iy(iy({},e),{operation:"query"}):e}))})},a=function(e){e&&!t.has(e)&&t.set(e,s)};a(e),a(n),a(r),a(o)}return t.get(e)},e.prototype.getVariables=function(e,t){return iy(iy({},this.transform(e).defaultVars),t)},e.prototype.watchQuery=function(e){void 0===(e=iy(iy({},e),{variables:this.getVariables(e.query,e.variables)})).notifyOnNetworkStatusChange&&(e.notifyOnNetworkStatusChange=!1);var t=new aD(this),n=new YO({queryManager:this,queryInfo:t,options:e});return this.queries.set(n.queryId,t),t.init({document:n.query,observableQuery:n,variables:n.variables}),n},e.prototype.query=function(e,t){var n=this;return void 0===t&&(t=this.generateQueryId()),__DEV__?aC(e.query,"query option is required. You must specify your GraphQL document in the query option."):aC(e.query,17),__DEV__?aC("Document"===e.query.kind,'You must wrap the query string in a "gql" tag.'):aC("Document"===e.query.kind,18),__DEV__?aC(!e.returnPartialData,"returnPartialData option only supported on watchQuery."):aC(!e.returnPartialData,19),__DEV__?aC(!e.pollInterval,"pollInterval option only supported on watchQuery."):aC(!e.pollInterval,20),this.fetchQuery(t,e).finally((function(){return n.stopQuery(t)}))},e.prototype.generateQueryId=function(){return String(this.queryIdCounter++)},e.prototype.generateRequestId=function(){return this.requestIdCounter++},e.prototype.generateMutationId=function(){return String(this.mutationIdCounter++)},e.prototype.stopQueryInStore=function(e){this.stopQueryInStoreNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryInStoreNoBroadcast=function(e){var t=this.queries.get(e);t&&t.stop()},e.prototype.clearStore=function(e){return void 0===e&&(e={discardWatches:!0}),this.cancelPendingFetches(__DEV__?new sC("Store reset while query was in flight (not completed in link chain)"):new sC(21)),this.queries.forEach((function(e){e.observableQuery?e.networkStatus=WO.loading:e.stop()})),this.mutationStore&&(this.mutationStore=Object.create(null)),this.cache.reset(e)},e.prototype.getObservableQueries=function(e){var t=this;void 0===e&&(e="active");var n=new Map,i=new Map,r=new Set;return Array.isArray(e)&&e.forEach((function(e){var n;"string"==typeof e?i.set(e,!1):NM(n=e)&&"Document"===n.kind&&Array.isArray(n.definitions)?i.set(t.transform(e).document,!1):NM(e)&&e.query&&r.add(e)})),this.queries.forEach((function(t,r){var o=t.observableQuery,s=t.document;if(o){if("all"===e)return void n.set(r,o);var a=o.queryName;if("standby"===o.options.fetchPolicy||"active"===e&&!o.hasObservers())return;("active"===e||a&&i.has(a)||s&&i.has(s))&&(n.set(r,o),a&&i.set(a,!0),s&&i.set(s,!0))}})),r.size&&r.forEach((function(e){var i=cA("legacyOneTimeQuery"),r=t.getQuery(i).init({document:e.query,variables:e.variables}),o=new YO({queryManager:t,queryInfo:r,options:iy(iy({},e),{fetchPolicy:"network-only"})});aC(o.queryId===i),r.setObservableQuery(o),n.set(i,o)})),__DEV__&&i.size&&i.forEach((function(e,t){e||__DEV__&&aC.warn("Unknown query ".concat("string"==typeof t?"named ":"").concat(JSON.stringify(t,null,2)," requested in refetchQueries options.include array"))})),n},e.prototype.reFetchObservableQueries=function(e){var t=this;void 0===e&&(e=!1);var n=[];return this.getObservableQueries(e?"all":"active").forEach((function(i,r){var o=i.options.fetchPolicy;i.resetLastResults(),(e||"standby"!==o&&"cache-only"!==o)&&n.push(i.refetch()),t.getQuery(r).setDiff(null)})),this.broadcastQueries(),Promise.all(n)},e.prototype.setObservableQuery=function(e){this.getQuery(e.queryId).setObservableQuery(e)},e.prototype.startGraphQLSubscription=function(e){var t=this,n=e.query,i=e.fetchPolicy,r=e.errorPolicy,o=e.variables,s=e.context,a=void 0===s?{}:s;n=this.transform(n).document,o=this.getVariables(n,o);var l=function(e){return t.getObservableFromLink(n,a,e).map((function(o){"no-cache"!==i&&(lD(o,r)&&t.cache.write({query:n,result:o.data,dataId:"ROOT_SUBSCRIPTION",variables:e}),t.broadcastQueries());var s=oA(o),a=function(e){return!!e.extensions&&Array.isArray(e.extensions[kA])}(o);if(s||a){var l={};throw s&&(l.graphQLErrors=o.errors),a&&(l.protocolErrors=o.extensions[kA]),new EA(l)}return o}))};if(this.transform(n).hasClientExports){var c=this.localState.addExportedVariables(n,o,a).then(l);return new FI((function(e){var t=null;return c.then((function(n){return t=n.subscribe(e)}),e.error),function(){return t&&t.unsubscribe()}}))}return l(o)},e.prototype.stopQuery=function(e){this.stopQueryNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryNoBroadcast=function(e){this.stopQueryInStoreNoBroadcast(e),this.removeQuery(e)},e.prototype.removeQuery=function(e){this.fetchCancelFns.delete(e),this.queries.has(e)&&(this.getQuery(e).stop(),this.queries.delete(e))},e.prototype.broadcastQueries=function(){this.onBroadcast&&this.onBroadcast(),this.queries.forEach((function(e){return e.notify()}))},e.prototype.getLocalState=function(){return this.localState},e.prototype.getObservableFromLink=function(e,t,n,i){var r,o,s=this;void 0===i&&(i=null!==(r=null==t?void 0:t.queryDeduplication)&&void 0!==r?r:this.queryDeduplication);var a=this.transform(e).serverQuery;if(a){var l=this.inFlightLinkObservables,c=this.link,u={query:a,variables:n,operationName:YM(a)||void 0,context:this.prepareContext(iy(iy({},t),{forceFetch:!i}))};if(t=u.context,i){var d=l.get(a)||new Map;l.set(a,d);var h=dO(n);if(!(o=d.get(h))){var p=new tA([bA(c,u)]);d.set(h,o=p),p.beforeNext((function(){d.delete(h)&&d.size<1&&l.delete(a)}))}}else o=new tA([bA(c,u)])}else o=new tA([FI.of({data:{}})]),t=this.prepareContext(t);var f=this.transform(e).clientQuery;return f&&(o=ZI(o,(function(e){return s.localState.runResolvers({document:f,remoteResult:e,context:t,variables:n})}))),o},e.prototype.getResultsFromLink=function(e,t,n){var i=e.lastRequestId=this.generateRequestId(),r=this.cache.transformForLink(this.transform(e.document).document);return ZI(this.getObservableFromLink(r,n.context,n.variables),(function(o){var s=sA(o),a=s.length>0;if(i>=e.lastRequestId){if(a&&"none"===n.errorPolicy)throw e.markError(new EA({graphQLErrors:s}));e.markResult(o,r,n,t),e.markReady()}var l={data:o.data,loading:!1,networkStatus:WO.ready};return a&&"ignore"!==n.errorPolicy&&(l.errors=s,l.networkStatus=WO.error),l}),(function(t){var n=t.hasOwnProperty("graphQLErrors")?t:new EA({networkError:t});throw i>=e.lastRequestId&&e.markError(n),n}))},e.prototype.fetchQueryObservable=function(e,t,n){return this.fetchConcastWithInfo(e,t,n).concast},e.prototype.fetchConcastWithInfo=function(e,t,n){var i=this;void 0===n&&(n=WO.loading);var r,o,s=this.transform(t.query).document,a=this.getVariables(s,t.variables),l=this.getQuery(e),c=this.defaultOptions.watchQuery,u=t.fetchPolicy,d=void 0===u?c&&c.fetchPolicy||"cache-first":u,h=t.errorPolicy,p=void 0===h?c&&c.errorPolicy||"none":h,f=t.returnPartialData,m=void 0!==f&&f,g=t.notifyOnNetworkStatusChange,y=void 0!==g&&g,v=t.context,b=void 0===v?{}:v,x=Object.assign({},t,{query:s,variables:a,fetchPolicy:d,errorPolicy:p,returnPartialData:m,notifyOnNetworkStatusChange:y,context:b}),_=function(e){x.variables=e;var r=i.fetchQueryByPolicy(l,x,n);return"standby"!==x.fetchPolicy&&r.sources.length>0&&l.observableQuery&&l.observableQuery.applyNextFetchPolicy("after-fetch",t),r},w=function(){return i.fetchCancelFns.delete(e)};if(this.fetchCancelFns.set(e,(function(e){w(),setTimeout((function(){return r.cancel(e)}))})),this.transform(x.query).hasClientExports)r=new tA(this.localState.addExportedVariables(x.query,x.variables,x.context).then(_).then((function(e){return e.sources}))),o=!0;else{var k=_(x.variables);o=k.fromLink,r=new tA(k.sources)}return r.promise.then(w,w),{concast:r,fromLink:o}},e.prototype.refetchQueries=function(e){var t=this,n=e.updateCache,i=e.include,r=e.optimistic,o=void 0!==r&&r,s=e.removeOptimistic,a=void 0===s?o?cA("refetchQueries"):void 0:s,l=e.onQueryUpdated,c=new Map;i&&this.getObservableQueries(i).forEach((function(e,n){c.set(n,{oq:e,lastDiff:t.getQuery(n).getDiff()})}));var u=new Map;return n&&this.cache.batch({update:n,optimistic:o&&a||!1,removeOptimistic:a,onWatchUpdated:function(e,t,n){var i=e.watcher instanceof aD&&e.watcher.observableQuery;if(i){if(l){c.delete(i.queryId);var r=l(i,t,n);return!0===r&&(r=i.refetch()),!1!==r&&u.set(i,r),r}null!==l&&c.set(i.queryId,{oq:i,lastDiff:n,diff:t})}}}),c.size&&c.forEach((function(e,n){var i,r=e.oq,o=e.lastDiff,s=e.diff;if(l){if(!s){var a=r.queryInfo;a.reset(),s=a.getDiff()}i=l(r,s,o)}l&&!0!==i||(i=r.refetch()),!1!==i&&u.set(r,i),n.indexOf("legacyOneTimeQuery")>=0&&t.stopQueryNoBroadcast(n)})),a&&this.cache.removeOptimistic(a),u},e.prototype.fetchQueryByPolicy=function(e,t,n){var i=this,r=t.query,o=t.variables,s=t.fetchPolicy,a=t.refetchWritePolicy,l=t.errorPolicy,c=t.returnPartialData,u=t.context,d=t.notifyOnNetworkStatusChange,h=e.networkStatus;e.init({document:this.transform(r).document,variables:o,networkStatus:n});var p=function(){return e.getDiff(o)},f=function(t,n){void 0===n&&(n=e.networkStatus||WO.loading);var s=t.result;!__DEV__||c||jA(s,{})||tD(t.missing);var a=function(e){return FI.of(iy({data:e,loading:XO(n),networkStatus:n},t.complete?null:{partial:!0}))};return s&&i.transform(r).hasForcedResolvers?i.localState.runResolvers({document:r,remoteResult:{data:s},context:u,variables:o,onlyRunForcedResolvers:!0}).then((function(e){return a(e.data||void 0)})):"none"===l&&n===WO.refetch&&Array.isArray(t.missing)?a(void 0):a(s)},m="no-cache"===s?0:n===WO.refetch&&"merge"!==a?1:2,g=function(){return i.getResultsFromLink(e,m,{variables:o,context:u,fetchPolicy:s,errorPolicy:l})},y=d&&"number"==typeof h&&h!==n&&XO(n);switch(s){default:case"cache-first":return(v=p()).complete?{fromLink:!1,sources:[f(v,e.markReady())]}:c||y?{fromLink:!0,sources:[f(v),g()]}:{fromLink:!0,sources:[g()]};case"cache-and-network":var v;return(v=p()).complete||c||y?{fromLink:!0,sources:[f(v),g()]}:{fromLink:!0,sources:[g()]};case"cache-only":return{fromLink:!1,sources:[f(p(),e.markReady())]};case"network-only":return y?{fromLink:!0,sources:[f(p()),g()]}:{fromLink:!0,sources:[g()]};case"no-cache":return y?{fromLink:!0,sources:[f(e.getDiff()),g()]}:{fromLink:!0,sources:[g()]};case"standby":return{fromLink:!1,sources:[]}}},e.prototype.getQuery=function(e){return e&&!this.queries.has(e)&&this.queries.set(e,new aD(this,e)),this.queries.get(e)},e.prototype.prepareContext=function(e){void 0===e&&(e={});var t=this.localState.prepareContext(e);return iy(iy({},t),{clientAwareness:this.clientAwareness})},e}(),dD=!1,hD=function(){function e(e){var t=this;this.resetStoreCallbacks=[],this.clearStoreCallbacks=[];var n=e.uri,i=e.credentials,r=e.headers,o=e.cache,s=e.ssrMode,a=void 0!==s&&s,l=e.ssrForceFetchDelay,c=void 0===l?0:l,u=e.connectToDevTools,d=void 0===u?"object"==typeof window&&!window.__APOLLO_CLIENT__&&__DEV__:u,h=e.queryDeduplication,p=void 0===h||h,f=e.defaultOptions,m=e.assumeImmutableResults,g=void 0!==m&&m,y=e.resolvers,v=e.typeDefs,b=e.fragmentMatcher,x=e.name,_=e.version,w=e.link;if(w||(w=n?new LA({uri:n,credentials:i,headers:r}):yA.empty()),!o)throw __DEV__?new sC("To initialize Apollo Client, you must specify a 'cache' property in the options object. \nFor more information, please visit: https://go.apollo.dev/c/docs"):new sC(9);if(this.link=w,this.cache=o,this.disableNetworkFetches=a||c>0,this.queryDeduplication=p,this.defaultOptions=f||Object.create(null),this.typeDefs=v,c&&setTimeout((function(){return t.disableNetworkFetches=!1}),c),this.watchQuery=this.watchQuery.bind(this),this.query=this.query.bind(this),this.mutate=this.mutate.bind(this),this.resetStore=this.resetStore.bind(this),this.reFetchObservableQueries=this.reFetchObservableQueries.bind(this),d&&"object"==typeof window&&(window.__APOLLO_CLIENT__=this),!dD&&d&&__DEV__&&(dD=!0,"undefined"!=typeof window&&window.document&&window.top===window.self&&!window.__APOLLO_DEVTOOLS_GLOBAL_HOOK__)){var k=window.navigator,E=k&&k.userAgent,S=void 0;"string"==typeof E&&(E.indexOf("Chrome/")>-1?S="https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm":E.indexOf("Firefox/")>-1&&(S="https://addons.mozilla.org/en-US/firefox/addon/apollo-developer-tools/")),S&&__DEV__&&aC.log("Download the Apollo DevTools for a better development experience: "+S)}this.version="3.7.17",this.localState=new iD({cache:o,client:this,resolvers:y,fragmentMatcher:b}),this.queryManager=new uD({cache:this.cache,link:this.link,defaultOptions:this.defaultOptions,queryDeduplication:p,ssrMode:a,clientAwareness:{name:x,version:_},localState:this.localState,assumeImmutableResults:g,onBroadcast:d?function(){t.devToolsHookCb&&t.devToolsHookCb({action:{},state:{queries:t.queryManager.getQueryStore(),mutations:t.queryManager.mutationStore||{}},dataWithOptimisticResults:t.cache.extract(!0)})}:void 0})}return e.prototype.stop=function(){this.queryManager.stop()},e.prototype.watchQuery=function(e){return this.defaultOptions.watchQuery&&(e=uA(this.defaultOptions.watchQuery,e)),!this.disableNetworkFetches||"network-only"!==e.fetchPolicy&&"cache-and-network"!==e.fetchPolicy||(e=iy(iy({},e),{fetchPolicy:"cache-first"})),this.queryManager.watchQuery(e)},e.prototype.query=function(e){return this.defaultOptions.query&&(e=uA(this.defaultOptions.query,e)),__DEV__?aC("cache-and-network"!==e.fetchPolicy,"The cache-and-network fetchPolicy does not work with client.query, because client.query can only return a single result. Please use client.watchQuery to receive multiple results from the cache and the network, or consider using a different fetchPolicy, such as cache-first or network-only."):aC("cache-and-network"!==e.fetchPolicy,10),this.disableNetworkFetches&&"network-only"===e.fetchPolicy&&(e=iy(iy({},e),{fetchPolicy:"cache-first"})),this.queryManager.query(e)},e.prototype.mutate=function(e){return this.defaultOptions.mutate&&(e=uA(this.defaultOptions.mutate,e)),this.queryManager.mutate(e)},e.prototype.subscribe=function(e){return this.queryManager.startGraphQLSubscription(e)},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!1),this.cache.readQuery(e,t)},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!1),this.cache.readFragment(e,t)},e.prototype.writeQuery=function(e){var t=this.cache.writeQuery(e);return!1!==e.broadcast&&this.queryManager.broadcastQueries(),t},e.prototype.writeFragment=function(e){var t=this.cache.writeFragment(e);return!1!==e.broadcast&&this.queryManager.broadcastQueries(),t},e.prototype.__actionHookForDevTools=function(e){this.devToolsHookCb=e},e.prototype.__requestRaw=function(e){return bA(this.link,e)},e.prototype.resetStore=function(){var e=this;return Promise.resolve().then((function(){return e.queryManager.clearStore({discardWatches:!1})})).then((function(){return Promise.all(e.resetStoreCallbacks.map((function(e){return e()})))})).then((function(){return e.reFetchObservableQueries()}))},e.prototype.clearStore=function(){var e=this;return Promise.resolve().then((function(){return e.queryManager.clearStore({discardWatches:!0})})).then((function(){return Promise.all(e.clearStoreCallbacks.map((function(e){return e()})))}))},e.prototype.onResetStore=function(e){var t=this;return this.resetStoreCallbacks.push(e),function(){t.resetStoreCallbacks=t.resetStoreCallbacks.filter((function(t){return t!==e}))}},e.prototype.onClearStore=function(e){var t=this;return this.clearStoreCallbacks.push(e),function(){t.clearStoreCallbacks=t.clearStoreCallbacks.filter((function(t){return t!==e}))}},e.prototype.reFetchObservableQueries=function(e){return this.queryManager.reFetchObservableQueries(e)},e.prototype.refetchQueries=function(e){var t=this.queryManager.refetchQueries(e),n=[],i=[];t.forEach((function(e,t){n.push(t),i.push(e)}));var r=Promise.all(i);return r.queries=n,r.results=i,r.catch((function(e){__DEV__&&aC.debug("In client.refetchQueries, Promise.all promise rejected with error ".concat(e))})),r},e.prototype.getObservableQueries=function(e){return void 0===e&&(e="active"),this.queryManager.getObservableQueries(e)},e.prototype.extract=function(e){return this.cache.extract(e)},e.prototype.restore=function(e){return this.cache.restore(e)},e.prototype.addResolvers=function(e){this.localState.addResolvers(e)},e.prototype.setResolvers=function(e){this.localState.setResolvers(e)},e.prototype.getResolvers=function(){return this.localState.getResolvers()},e.prototype.setLocalStateFragmentMatcher=function(e){this.localState.setFragmentMatcher(e)},e.prototype.setLink=function(e){this.link=this.queryManager.link=e},e}(),pD=new Map,fD=new Map,mD=!0,gD=!1;function yD(e){return e.replace(/[\s,]+/g," ").trim()}function vD(e){var t=new Set,n=[];return e.definitions.forEach((function(e){if("FragmentDefinition"===e.kind){var i=e.name.value,r=yD((s=e.loc).source.body.substring(s.start,s.end)),o=fD.get(i);o&&!o.has(r)?mD&&console.warn("Warning: fragment with name "+i+" already exists.\ngraphql-tag enforces all fragment names across your application to be unique; read more about\nthis in the docs: http://dev.apollodata.com/core/fragments.html#unique-names"):o||fD.set(i,o=new Set),o.add(r),t.has(r)||(t.add(r),n.push(e))}else n.push(e);var s})),iy(iy({},e),{definitions:n})}function bD(e){var t=yD(e);if(!pD.has(t)){var n=function(e,t){return new mM(e,t).parseDocument()}(e,{experimentalFragmentVariables:gD,allowLegacyFragmentVariables:gD});if(!n||"Document"!==n.kind)throw new Error("Not a valid GraphQL document.");pD.set(t,function(e){var t=new Set(e.definitions);t.forEach((function(e){e.loc&&delete e.loc,Object.keys(e).forEach((function(n){var i=e[n];i&&"object"==typeof i&&t.add(i)}))}));var n=e.loc;return n&&(delete n.startToken,delete n.endToken),e}(vD(n)))}return pD.get(t)}function xD(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"string"==typeof e&&(e=[e]);var i=e[0];return t.forEach((function(t,n){t&&"Document"===t.kind?i+=t.loc.source.body:i+=t,i+=e[n+1]})),bD(i)}var _D,wD=xD,kD=function(){pD.clear(),fD.clear()},ED=function(){mD=!1},SD=function(){gD=!0},TD=function(){gD=!1};(_D=xD||(xD={})).gql=wD,_D.resetCaches=kD,_D.disableFragmentWarnings=ED,_D.enableExperimentalFragmentVariables=SD,_D.disableExperimentalFragmentVariables=TD,xD.default=xD;var CD=JI?Symbol.for("__APOLLO_CONTEXT__"):"__APOLLO_CONTEXT__";function MD(){var e=V.createContext[CD];return e||(Object.defineProperty(V.createContext,CD,{value:e=V.createContext({}),enumerable:!1,writable:!1,configurable:!0}),e.displayName="ApolloContext"),e}var ID,AD=function(e){var t=e.client,n=e.children,i=MD();return V.createElement(i.Consumer,null,(function(e){return void 0===e&&(e={}),t&&e.client!==t&&(e=Object.assign({},e,{client:t})),__DEV__?aC(e.client,'ApolloProvider was not passed a client instance. Make sure you pass in your client via the "client" prop.'):aC(e.client,29),V.createElement(i.Provider,{value:e},n)}))};function PD(e){var t=V.useContext(MD()),n=e||t.client;return __DEV__?aC(!!n,'Could not find "client" in the context or passed in as an option. Wrap the root component in an <ApolloProvider>, or pass an ApolloClient instance in via options.'):aC(!!n,32),n}!function(e){e[e.Query=0]="Query",e[e.Mutation=1]="Mutation",e[e.Subscription=2]="Subscription"}(ID||(ID={}));var OD=new Map;function DD(e){var t;switch(e){case ID.Query:t="Query";break;case ID.Mutation:t="Mutation";break;case ID.Subscription:t="Subscription"}return t}function RD(e,t){var n=function(e){var t,n,i=OD.get(e);if(i)return i;__DEV__?aC(!!e&&!!e.kind,"Argument of ".concat(e," passed to parser was not a valid GraphQL ")+"DocumentNode. You may need to use 'graphql-tag' or another method to convert your operation into a document"):aC(!!e&&!!e.kind,33);for(var r=[],o=[],s=[],a=[],l=0,c=e.definitions;l<c.length;l++){var u=c[l];if("FragmentDefinition"!==u.kind){if("OperationDefinition"===u.kind)switch(u.operation){case"query":o.push(u);break;case"mutation":s.push(u);break;case"subscription":a.push(u)}}else r.push(u)}__DEV__?aC(!r.length||o.length||s.length||a.length,"Passing only a fragment to 'graphql' is not yet supported. You must include a query, subscription or mutation as well"):aC(!r.length||o.length||s.length||a.length,34),__DEV__?aC(o.length+s.length+a.length<=1,"react-apollo only supports a query, subscription, or a mutation per HOC. "+"".concat(e," had ").concat(o.length," queries, ").concat(a.length," ")+"subscriptions and ".concat(s.length," mutations. ")+"You can use 'compose' to join multiple operation types to a component"):aC(o.length+s.length+a.length<=1,35),n=o.length?ID.Query:ID.Mutation,o.length||s.length||(n=ID.Subscription);var d=o.length?o:s.length?s:a;__DEV__?aC(1===d.length,"react-apollo only supports one definition per HOC. ".concat(e," had ")+"".concat(d.length," definitions. ")+"You can use 'compose' to join multiple operation types to a component"):aC(1===d.length,36);var h=d[0];t=h.variableDefinitions||[];var p={name:h.name&&"Name"===h.name.kind?h.name.value:"data",type:n,variables:t};return OD.set(e,p),p}(e),i=DD(t),r=DD(n.type);__DEV__?aC(n.type===t,"Running a ".concat(i," requires a graphql ")+"".concat(i,", but a ").concat(r," was used instead.")):aC(n.type===t,37)}function zD(e,t){var n=PD(null==t?void 0:t.client);RD(e,ID.Mutation);var i=V.useState({called:!1,loading:!1,client:n}),r=i[0],o=i[1],s=V.useRef({result:r,mutationId:0,isMounted:!0,client:n,mutation:e,options:t});Object.assign(s.current,{client:n,options:t,mutation:e});var a=V.useCallback((function(e){void 0===e&&(e={});var t=s.current,n=t.options,i=t.mutation,r=iy(iy({},n),{mutation:i}),a=e.client||s.current.client;s.current.result.loading||r.ignoreResults||!s.current.isMounted||o(s.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:a});var l=++s.current.mutationId,c=uA(r,e);return a.mutate(c).then((function(t){var n,i=t.data,r=t.errors,u=r&&r.length>0?new EA({graphQLErrors:r}):void 0;if(l===s.current.mutationId&&!c.ignoreResults){var d={called:!0,loading:!1,data:i,error:u,client:a};s.current.isMounted&&!jA(s.current.result,d)&&o(s.current.result=d)}var h=e.onCompleted||(null===(n=s.current.options)||void 0===n?void 0:n.onCompleted);return null==h||h(t.data,c),t})).catch((function(t){var n;if(l===s.current.mutationId&&s.current.isMounted){var i={loading:!1,error:t,data:void 0,called:!0,client:a};jA(s.current.result,i)||o(s.current.result=i)}var r=e.onError||(null===(n=s.current.options)||void 0===n?void 0:n.onError);if(r)return r(t,c),{data:void 0,errors:t};throw t}))}),[]),l=V.useCallback((function(){s.current.isMounted&&o({called:!1,loading:!1,client:n})}),[]);return V.useEffect((function(){return s.current.isMounted=!0,function(){s.current.isMounted=!1}}),[]),[a,iy({reset:l},r)]}function LD(e,t){var n=V.useRef(!1),i=PD(null==t?void 0:t.client);RD(e,ID.Subscription);var r=V.useState({loading:!(null==t?void 0:t.skip),error:void 0,data:void 0,variables:null==t?void 0:t.variables}),o=r[0],s=r[1];n.current||(n.current=!0,(null==t?void 0:t.onSubscriptionData)&&__DEV__&&aC.warn(t.onData?"'useSubscription' supports only the 'onSubscriptionData' or 'onData' option, but not both. Only the 'onData' option will be used.":"'onSubscriptionData' is deprecated and will be removed in a future major version. Please use the 'onData' option instead."),(null==t?void 0:t.onSubscriptionComplete)&&__DEV__&&aC.warn(t.onComplete?"'useSubscription' supports only the 'onSubscriptionComplete' or 'onComplete' option, but not both. Only the 'onComplete' option will be used.":"'onSubscriptionComplete' is deprecated and will be removed in a future major version. Please use the 'onComplete' option instead."));var a=V.useState((function(){return(null==t?void 0:t.skip)?null:i.subscribe({query:e,variables:null==t?void 0:t.variables,fetchPolicy:null==t?void 0:t.fetchPolicy,context:null==t?void 0:t.context})})),l=a[0],c=a[1],u=V.useRef(!1);V.useEffect((function(){return function(){u.current=!0}}),[]);var d=V.useRef({client:i,subscription:e,options:t});return V.useEffect((function(){var n,r,o,a,l=null==t?void 0:t.shouldResubscribe;"function"==typeof l&&(l=!!l(t)),(null==t?void 0:t.skip)?(!(null==t?void 0:t.skip)!=!(null===(n=d.current.options)||void 0===n?void 0:n.skip)||u.current)&&(s({loading:!1,data:void 0,error:void 0,variables:null==t?void 0:t.variables}),c(null),u.current=!1):(!1===l||i===d.current.client&&e===d.current.subscription&&(null==t?void 0:t.fetchPolicy)===(null===(r=d.current.options)||void 0===r?void 0:r.fetchPolicy)&&!(null==t?void 0:t.skip)==!(null===(o=d.current.options)||void 0===o?void 0:o.skip)&&jA(null==t?void 0:t.variables,null===(a=d.current.options)||void 0===a?void 0:a.variables))&&!u.current||(s({loading:!0,data:void 0,error:void 0,variables:null==t?void 0:t.variables}),c(i.subscribe({query:e,variables:null==t?void 0:t.variables,fetchPolicy:null==t?void 0:t.fetchPolicy,context:null==t?void 0:t.context})),u.current=!1),Object.assign(d.current,{client:i,subscription:e,options:t})}),[i,e,t,u.current]),V.useEffect((function(){if(l){var e=!1,n=l.subscribe({next:function(n){var r,o;if(!e){var a={loading:!1,data:n.data,error:void 0,variables:null==t?void 0:t.variables};s(a),(null===(r=d.current.options)||void 0===r?void 0:r.onData)?d.current.options.onData({client:i,data:a}):(null===(o=d.current.options)||void 0===o?void 0:o.onSubscriptionData)&&d.current.options.onSubscriptionData({client:i,subscriptionData:a})}},error:function(n){var i,r;e||(s({loading:!1,data:void 0,error:n,variables:null==t?void 0:t.variables}),null===(r=null===(i=d.current.options)||void 0===i?void 0:i.onError)||void 0===r||r.call(i,n))},complete:function(){var t,n;e||((null===(t=d.current.options)||void 0===t?void 0:t.onComplete)?d.current.options.onComplete():(null===(n=d.current.options)||void 0===n?void 0:n.onSubscriptionComplete)&&d.current.options.onSubscriptionComplete())}});return function(){e=!0,setTimeout((function(){n.unsubscribe()}))}}}),[l]),o}const BD=xD`
  fragment ChannelFields on Channel {
    id
    name
    url
    detail
    lat
    lng
    memberCount
    activeUserCount
    createdAt
    updatedAt
    deletedAt
  }
`;xD`
  mutation GetActiveChannels($lng: Float!, $lat: Float!) {
    getActiveChannels(lng: $lng, lat: $lat) {
      ...ChannelFields
    }
  }
  ${BD}
`;const ND=xD`
  mutation GetChannels($lng: Float!, $lat: Float!) {
    getChannels(lng: $lng, lat: $lat) {
      ...ChannelFields
    }
  }
  ${BD}
`,FD=xD`
  fragment UserFields on User {
    id
    email
    phone
    name
    isAdmin
    isCamOn
    isMicOn
    isSoundOn
    lng
    lat
    zoom
    activeChannelId
  }
`,$D=xD`
  fragment MembershipFields on Membership {
    id
    channelId 
    userId
    isOwner
    isSaved
    isActive
    lastVisitedAt
    createdAt
    updatedAt
    deletedAt
  }
`/*! Capacitor: https://capacitorjs.com/ - MIT License */,jD=e=>e.CapacitorPlatforms=(e=>{const t=new Map;t.set("web",{name:"web"});const n=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t};return n.addPlatform=(e,t)=>{n.platforms.set(e,t)},n.setPlatform=e=>{n.platforms.has(e)&&(n.currentPlatform=n.platforms.get(e))},n})(e),VD=jD("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});var UD;VD.addPlatform,VD.setPlatform,function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(UD||(UD={}));class qD extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}e("q",qD);const GD=e=>{var t,n,i,r,o;const s=e.CapacitorCustomPlatform||null,a=e.Capacitor||{},l=a.Plugins=a.Plugins||{},c=e.CapacitorPlatforms,u=(null===(t=null==c?void 0:c.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>null!==s?s.name:(e=>{var t,n;return(null==e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"})(e)),d=(null===(n=null==c?void 0:c.currentPlatform)||void 0===n?void 0:n.isNativePlatform)||(()=>"web"!==u()),h=(null===(i=null==c?void 0:c.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(e=>{const t=f.get(e);return!!(null==t?void 0:t.platforms.has(u()))||!!p(e)}),p=(null===(r=null==c?void 0:c.currentPlatform)||void 0===r?void 0:r.getPluginHeader)||(e=>{var t;return null===(t=a.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))}),f=new Map,m=(null===(o=null==c?void 0:c.currentPlatform)||void 0===o?void 0:o.registerPlugin)||((e,t={})=>{const n=f.get(e);if(n)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),n.proxy;const i=u(),r=p(e);let o;const c=n=>{let l;const c=(...c)=>{const u=(async()=>(!o&&i in t?o=o="function"==typeof t[i]?await t[i]():t[i]:null!==s&&!o&&"web"in t&&(o=o="function"==typeof t.web?await t.web():t.web),o))().then((t=>{const o=((t,n)=>{var o,s;if(!r){if(t)return null===(s=t[n])||void 0===s?void 0:s.bind(t);throw new qD(`"${e}" plugin is not implemented on ${i}`,UD.Unimplemented)}{const i=null==r?void 0:r.methods.find((e=>n===e.name));if(i)return"promise"===i.rtype?t=>a.nativePromise(e,n.toString(),t):(t,i)=>a.nativeCallback(e,n.toString(),t,i);if(t)return null===(o=t[n])||void 0===o?void 0:o.bind(t)}})(t,n);if(o){const e=o(...c);return l=null==e?void 0:e.remove,e}throw new qD(`"${e}.${n}()" is not implemented on ${i}`,UD.Unimplemented)}));return"addListener"===n&&(u.remove=async()=>l()),u};return c.toString=()=>`${n.toString()}() { [capacitor code] }`,Object.defineProperty(c,"name",{value:n,writable:!1,configurable:!1}),c},d=c("addListener"),h=c("removeListener"),m=(e,t)=>{const n=d({eventName:e},t),i=async()=>{const i=await n;h({eventName:e,callbackId:i},t)},r=new Promise((e=>n.then((()=>e({remove:i})))));return r.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()},r},g=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return r?m:d;case"removeListener":return h;default:return c(t)}}});return l[e]=g,f.set(e,{name:e,proxy:g,platforms:new Set([...Object.keys(t),...r?[i]:[]])}),g});return a.convertFileSrc||(a.convertFileSrc=e=>e),a.getPlatform=u,a.handleError=t=>e.console.error(t),a.isNativePlatform=d,a.isPluginAvailable=h,a.pluginMethodNoop=(e,t,n)=>Promise.reject(`${n} does not have an implementation of "${t}".`),a.registerPlugin=m,a.Exception=qD,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},WD=e=>e.Capacitor=GD(e),HD=WD("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),ZD=HD.registerPlugin;HD.Plugins;class XD{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n);const i=async()=>this.removeListener(e,t),r=Promise.resolve({remove:i});return Object.defineProperty(r,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()}}),r}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t){const n=this.listeners[e];n&&n.forEach((e=>e(t)))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new HD.Exception(e,UD.Unimplemented)}unavailable(e="not available"){return new HD.Exception(e,UD.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const i=n.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}e("W",XD);const KD=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),JD=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class YD extends XD{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach((e=>{if(e.length<=0)return;let[n,i]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=JD(n).trim(),i=JD(i).trim(),t[n]=i})),t}async setCookie(e){try{const t=KD(e.key),n=KD(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),o=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${i}; path=${r}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}ZD("CapacitorCookies",{web:()=>new YD});const QD=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),i=((e={})=>{const t=Object.keys(e),n=Object.keys(e).map((e=>e.toLocaleLowerCase()));return n.reduce(((n,i,r)=>(n[i]=e[t[r]],n)),{})})(e.headers),r=i["content-type"]||"";if("string"==typeof e.data)n.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[n,i]of Object.entries(e.data||{}))t.set(n,i);n.body=t.toString()}else if(r.includes("multipart/form-data")){const t=new FormData;if(e.data instanceof FormData)e.data.forEach(((e,n)=>{t.append(n,e)}));else for(const n of Object.keys(e.data))t.append(n,e.data[n]);n.body=t;const i=new Headers(n.headers);i.delete("content-type"),n.headers=i}else(r.includes("application/json")||"object"==typeof e.data)&&(n.body=JSON.stringify(e.data));return n};class eR extends XD{async request(e){const t=QD(e,e.webFetchExtra),n=((e,t=!0)=>e?Object.entries(e).reduce(((e,n)=>{const[i,r]=n;let o,s;return Array.isArray(r)?(s="",r.forEach((e=>{o=t?encodeURIComponent(e):e,s+=`${i}=${o}&`})),s.slice(0,-1)):(o=t?encodeURIComponent(r):r,s=`${i}=${o}`),`${e}&${s}`}),"").substr(1):null)(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,r=await fetch(i,t),o=r.headers.get("content-type")||"";let s,a,{responseType:l="text"}=r.ok?e:{};switch(o.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":a=await r.blob(),s=await(async e=>new Promise(((t,n)=>{const i=new FileReader;i.onload=()=>{const e=i.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},i.onerror=e=>n(e),i.readAsDataURL(e)})))(a);break;case"json":s=await r.json();break;default:s=await r.text()}const c={};return r.headers.forEach(((e,t)=>{c[t]=e})),{data:s,headers:c,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}ZD("CapacitorHttp",{web:()=>new eR});const tR=ZD("Preferences",{web:()=>ep((()=>t.import("./web-legacy-c137fa6d.js"))).then((e=>new e.PreferencesWeb))}),nR="www.jamn.io",iR="DEVICE_ID",rR="ACCESS_TOKEN",oR="REFRESH_TOKEN",sR=xD`
  mutation ActivateChannel($deviceId: Int, $channelId: Int) {
    activateChannel(deviceId: $deviceId, channelId: $channelId) {
      user {
        ...UserFields
      }
      channels {
        ...ChannelFields
      }
      memberships {
        ...MembershipFields
      }
    }
  }
  ${FD}
  ${BD}
  ${$D}
`,aR=()=>{const e=tC(),[t]=zD(sR,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(DS([t.activateChannel.user])),e(_S(t.activateChannel.channels)),e(fS(t.activateChannel.memberships))}});return async e=>{const{value:n}=await tR.get({key:iR});console.log("deviceId",n),t({variables:{deviceId:n?parseInt(n):null,channelId:e}})}};var lR,cR,uR={exports:{}},dR={exports:{}};lR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cR={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&cR.rotl(e,8)|4278255360&cR.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=cR.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,i=0;n<e.length;n++,i+=8)t[i>>>5]|=e[n]<<24-i%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var t=[],n=0;n<e.length;n+=3)for(var i=e[n]<<16|e[n+1]<<8|e[n+2],r=0;r<4;r++)8*n+6*r<=8*e.length?t.push(lR.charAt(i>>>6*(3-r)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],n=0,i=0;n<e.length;i=++n%4)0!=i&&t.push((lR.indexOf(e.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|lR.indexOf(e.charAt(n))>>>6-2*i);return t}},dR.exports=cR;var hR=dR.exports,pR={utf8:{stringToBytes:function(e){return pR.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(pR.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}},fR=pR,mR=function(e){return null!=e&&(gR(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&gR(e.slice(0,0))}(e)||!!e._isBuffer)};function gR(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}!function(){var e=hR,t=fR.utf8,n=mR,i=fR.bin,r=function(o,s){o.constructor==String?o=s&&"binary"===s.encoding?i.stringToBytes(o):t.stringToBytes(o):n(o)?o=Array.prototype.slice.call(o,0):Array.isArray(o)||o.constructor===Uint8Array||(o=o.toString());for(var a=e.bytesToWords(o),l=8*o.length,c=1732584193,u=-271733879,d=-1732584194,h=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[l>>>5]|=128<<l%32,a[14+(l+64>>>9<<4)]=l;var f=r._ff,m=r._gg,g=r._hh,y=r._ii;for(p=0;p<a.length;p+=16){var v=c,b=u,x=d,_=h;c=f(c,u,d,h,a[p+0],7,-680876936),h=f(h,c,u,d,a[p+1],12,-389564586),d=f(d,h,c,u,a[p+2],17,606105819),u=f(u,d,h,c,a[p+3],22,-1044525330),c=f(c,u,d,h,a[p+4],7,-176418897),h=f(h,c,u,d,a[p+5],12,1200080426),d=f(d,h,c,u,a[p+6],17,-1473231341),u=f(u,d,h,c,a[p+7],22,-45705983),c=f(c,u,d,h,a[p+8],7,1770035416),h=f(h,c,u,d,a[p+9],12,-1958414417),d=f(d,h,c,u,a[p+10],17,-42063),u=f(u,d,h,c,a[p+11],22,-1990404162),c=f(c,u,d,h,a[p+12],7,1804603682),h=f(h,c,u,d,a[p+13],12,-40341101),d=f(d,h,c,u,a[p+14],17,-1502002290),c=m(c,u=f(u,d,h,c,a[p+15],22,1236535329),d,h,a[p+1],5,-165796510),h=m(h,c,u,d,a[p+6],9,-1069501632),d=m(d,h,c,u,a[p+11],14,643717713),u=m(u,d,h,c,a[p+0],20,-373897302),c=m(c,u,d,h,a[p+5],5,-701558691),h=m(h,c,u,d,a[p+10],9,38016083),d=m(d,h,c,u,a[p+15],14,-660478335),u=m(u,d,h,c,a[p+4],20,-405537848),c=m(c,u,d,h,a[p+9],5,568446438),h=m(h,c,u,d,a[p+14],9,-1019803690),d=m(d,h,c,u,a[p+3],14,-187363961),u=m(u,d,h,c,a[p+8],20,1163531501),c=m(c,u,d,h,a[p+13],5,-1444681467),h=m(h,c,u,d,a[p+2],9,-51403784),d=m(d,h,c,u,a[p+7],14,1735328473),c=g(c,u=m(u,d,h,c,a[p+12],20,-1926607734),d,h,a[p+5],4,-378558),h=g(h,c,u,d,a[p+8],11,-2022574463),d=g(d,h,c,u,a[p+11],16,1839030562),u=g(u,d,h,c,a[p+14],23,-35309556),c=g(c,u,d,h,a[p+1],4,-1530992060),h=g(h,c,u,d,a[p+4],11,1272893353),d=g(d,h,c,u,a[p+7],16,-155497632),u=g(u,d,h,c,a[p+10],23,-1094730640),c=g(c,u,d,h,a[p+13],4,681279174),h=g(h,c,u,d,a[p+0],11,-358537222),d=g(d,h,c,u,a[p+3],16,-722521979),u=g(u,d,h,c,a[p+6],23,76029189),c=g(c,u,d,h,a[p+9],4,-640364487),h=g(h,c,u,d,a[p+12],11,-421815835),d=g(d,h,c,u,a[p+15],16,530742520),c=y(c,u=g(u,d,h,c,a[p+2],23,-995338651),d,h,a[p+0],6,-198630844),h=y(h,c,u,d,a[p+7],10,1126891415),d=y(d,h,c,u,a[p+14],15,-1416354905),u=y(u,d,h,c,a[p+5],21,-57434055),c=y(c,u,d,h,a[p+12],6,1700485571),h=y(h,c,u,d,a[p+3],10,-1894986606),d=y(d,h,c,u,a[p+10],15,-1051523),u=y(u,d,h,c,a[p+1],21,-2054922799),c=y(c,u,d,h,a[p+8],6,1873313359),h=y(h,c,u,d,a[p+15],10,-30611744),d=y(d,h,c,u,a[p+6],15,-1560198380),u=y(u,d,h,c,a[p+13],21,1309151649),c=y(c,u,d,h,a[p+4],6,-145523070),h=y(h,c,u,d,a[p+11],10,-1120210379),d=y(d,h,c,u,a[p+2],15,718787259),u=y(u,d,h,c,a[p+9],21,-343485551),c=c+v>>>0,u=u+b>>>0,d=d+x>>>0,h=h+_>>>0}return e.endian([c,u,d,h])};r._ff=function(e,t,n,i,r,o,s){var a=e+(t&n|~t&i)+(r>>>0)+s;return(a<<o|a>>>32-o)+t},r._gg=function(e,t,n,i,r,o,s){var a=e+(t&i|n&~i)+(r>>>0)+s;return(a<<o|a>>>32-o)+t},r._hh=function(e,t,n,i,r,o,s){var a=e+(t^n^i)+(r>>>0)+s;return(a<<o|a>>>32-o)+t},r._ii=function(e,t,n,i,r,o,s){var a=e+(n^(t|~i))+(r>>>0)+s;return(a<<o|a>>>32-o)+t},r._blocksize=16,r._digestsize=16,uR.exports=function(t,n){if(null==t)throw new Error("Illegal argument "+t);var o=e.wordsToBytes(r(t,n));return n&&n.asBytes?o:n&&n.asString?i.bytesToString(o):e.bytesToHex(o)}}();const yR=r(uR.exports),vR=e=>t=>{t&&(t.srcObject=e,t.play())},bR=({authModal:e,streams:t})=>{const n=nC(BS),i=nC(TS),r=nC((e=>{var t;return vS(e,null!==(t=null==i?void 0:i.id)&&void 0!==t?t:-1)})),o=nC(LS),s=aR();return ee("div",{children:[(null==n?void 0:n.activeChannelId)===(null==i?void 0:i.id)?Q(Q_,{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Q(hw,{onClick:()=>{s(null)},style:{backgroundColor:"red",color:"var(--ion-color-dark)",borderRadius:"5px",fontWeight:"bold"},children:"LEAVE"})}):Q(Q_,{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Q(hw,{onClick:()=>{var t;null!=n&&n.id?null!=i&&i.id&&s(i.id):null===(t=e.current)||void 0===t||t.present()},style:{backgroundColor:"green",color:"var(--ion-color-dark)",borderRadius:"5px",fontWeight:"bold"},children:"CALL"})}),Q("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},children:r.filter((e=>e.isActive)).sort(((e,t)=>e.userId===(null==n?void 0:n.id)?-1:t.userId===(null==n?void 0:n.id)?1:e.createdAt<t.createdAt?-1:e.createdAt>t.createdAt?1:0)).map((e=>{var i,r;return ee("div",{style:{margin:5,width:100},children:[ee("div",{children:[null!==(i=t[e.userId])&&void 0!==i&&i.video&&(e.userId!==(null==n?void 0:n.id)||null!=n&&n.isCamOn)?Q("video",{ref:vR(t[e.userId].video),playsInline:!0,autoPlay:!0,muted:!0,style:{width:100,height:100,transform:e.userId===(null==n?void 0:n.id)?"rotateY(180deg)":"",border:"1px solid",borderRadius:5}}):Q(Y_,{style:{width:100,height:100,border:"1px solid",borderRadius:5},children:Q("img",{src:`https://www.gravatar.com/avatar/${yR(o[e.userId].email||"")}?d=retro`})}),null!==(r=t[e.userId])&&void 0!==r&&r.audio&&null!=n&&n.isSoundOn&&e.userId!==(null==n?void 0:n.id)?Q("audio",{ref:vR(t[e.userId].audio),playsInline:!0,autoPlay:!0,muted:!1}):null]}),Q("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:o[e.userId].name})]},"membership-"+e.id)}))})]})},xR=xD`
  fragment PostFields on Post {
    id
    channelId 
    userId
    text
    createdAt
    updatedAt
    deletedAt
  }
`,_R=xD`
  mutation GetChannelPosts($channelId: Int!, $createdAt: String) {
    getChannelPosts(channelId: $channelId, createdAt: $createdAt) {
      ...PostFields
      user {
        id
        name
        email
      }
    }
  }
  ${xR}
`;function wR(e){this.content=e}function kR(e,t,n){for(let i=0;;i++){if(i==e.childCount||i==t.childCount)return e.childCount==t.childCount?null:n;let r=e.child(i),o=t.child(i);if(r!=o){if(!r.sameMarkup(o))return n;if(r.isText&&r.text!=o.text){for(let e=0;r.text[e]==o.text[e];e++)n++;return n}if(r.content.size||o.content.size){let e=kR(r.content,o.content,n+1);if(null!=e)return e}n+=r.nodeSize}else n+=r.nodeSize}}function ER(e,t,n,i){for(let r=e.childCount,o=t.childCount;;){if(0==r||0==o)return r==o?null:{a:n,b:i};let s=e.child(--r),a=t.child(--o),l=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:i};if(s.isText&&s.text!=a.text){let e=0,t=Math.min(s.text.length,a.text.length);for(;e<t&&s.text[s.text.length-e-1]==a.text[a.text.length-e-1];)e++,n--,i--;return{a:n,b:i}}if(s.content.size||a.content.size){let e=ER(s.content,a.content,n-1,i-1);if(e)return e}n-=l,i-=l}else n-=l,i-=l}}wR.prototype={constructor:wR,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var i=n&&n!=e?this.remove(n):this,r=i.find(e),o=i.content.slice();return-1==r?o.push(n||e,t):(o[r+1]=t,n&&(o[r]=n)),new wR(o)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new wR(n)},addToStart:function(e,t){return new wR([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new wR(n)},addBefore:function(e,t,n){var i=this.remove(t),r=i.content.slice(),o=i.find(e);return r.splice(-1==o?r.length:o,0,t,n),new wR(r)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=wR.from(e)).size?new wR(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=wR.from(e)).size?new wR(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=wR.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach((function(t,n){e[t]=n})),e},get size(){return this.content.length>>1}},wR.from=function(e){if(e instanceof wR)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new wR(t)};class SR{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,i=0,r){for(let o=0,s=0;s<t;o++){let a=this.content[o],l=s+a.nodeSize;if(l>e&&!1!==n(a,i+s,r||null,o)&&a.content.size){let r=s+1;a.nodesBetween(Math.max(0,e-r),Math.min(a.content.size,t-r),n,i+r)}s=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,i){let r="",o=!0;return this.nodesBetween(e,t,((s,a)=>{s.isText?(r+=s.text.slice(Math.max(e,a)-a,t-a),o=!n):s.isLeaf?(i?r+="function"==typeof i?i(s):i:s.type.spec.leafText&&(r+=s.type.spec.leafText(s)),o=!n):!o&&s.isBlock&&(r+=n,o=!0)}),0),r}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,i=this.content.slice(),r=0;for(t.isText&&t.sameMarkup(n)&&(i[i.length-1]=t.withText(t.text+n.text),r=1);r<e.content.length;r++)i.push(e.content[r]);return new SR(i,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],i=0;if(t>e)for(let r=0,o=0;o<t;r++){let s=this.content[r],a=o+s.nodeSize;a>e&&((o<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-o),Math.min(s.text.length,t-o)):s.cut(Math.max(0,e-o-1),Math.min(s.content.size,t-o-1))),n.push(s),i+=s.nodeSize),o=a}return new SR(n,i)}cutByIndex(e,t){return e==t?SR.empty:0==e&&t==this.content.length?this:new SR(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let i=this.content.slice(),r=this.size+t.nodeSize-n.nodeSize;return i[e]=t,new SR(i,r)}addToStart(e){return new SR([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new SR(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let i=this.content[t];e(i,n,t),n+=i.nodeSize}}findDiffStart(e,t=0){return kR(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return ER(this,e,t,n)}findIndex(e,t=-1){if(0==e)return CR(0,e);if(e==this.size)return CR(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let r=i+this.child(n).nodeSize;if(r>=e)return r==e||t>0?CR(n+1,r):CR(n,i);i=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map((e=>e.toJSON())):null}static fromJSON(e,t){if(!t)return SR.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new SR(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return SR.empty;let t,n=0;for(let i=0;i<e.length;i++){let r=e[i];n+=r.nodeSize,i&&r.isText&&e[i-1].sameMarkup(r)?(t||(t=e.slice(0,i)),t[t.length-1]=r.withText(t[t.length-1].text+r.text)):t&&t.push(r)}return new SR(t||e,n)}static from(e){if(!e)return SR.empty;if(e instanceof SR)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new SR([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}SR.empty=new SR([],0);const TR={index:0,offset:0};function CR(e,t){return TR.index=e,TR.offset=t,TR}function MR(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!MR(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!MR(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}let IR=class e{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let i=0;i<e.length;i++){let r=e[i];if(this.eq(r))return e;if(this.type.excludes(r.type))t||(t=e.slice(0,i));else{if(r.type.excludes(this.type))return e;!n&&r.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),n=!0),t&&t.push(r)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&MR(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);return n.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return e.none;if(t instanceof e)return[t];let n=t.slice();return n.sort(((e,t)=>e.type.rank-t.type.rank)),n}};IR.none=[];class AR extends Error{}class PR{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=DR(this.content,e+this.openStart,t);return n&&new PR(n,this.openStart,this.openEnd)}removeBetween(e,t){return new PR(OR(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return PR.empty;let n=t.openStart||0,i=t.openEnd||0;if("number"!=typeof n||"number"!=typeof i)throw new RangeError("Invalid input for Slice.fromJSON");return new PR(SR.fromJSON(e,t.content),n,i)}static maxOpen(e,t=!0){let n=0,i=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let r=e.lastChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.lastChild)i++;return new PR(e,n,i)}}function OR(e,t,n){let{index:i,offset:r}=e.findIndex(t),o=e.maybeChild(i),{index:s,offset:a}=e.findIndex(n);if(r==t||o.isText){if(a!=n&&!e.child(s).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(i!=s)throw new RangeError("Removing non-flat range");return e.replaceChild(i,o.copy(OR(o.content,t-r-1,n-r-1)))}function DR(e,t,n,i){let{index:r,offset:o}=e.findIndex(t),s=e.maybeChild(r);if(o==t||s.isText)return i&&!i.canReplace(r,r,n)?null:e.cut(0,t).append(n).append(e.cut(t));let a=DR(s.content,t-o-1,n);return a&&e.replaceChild(r,s.copy(a))}function RR(e,t,n){if(n.openStart>e.depth)throw new AR("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new AR("Inconsistent open depths");return zR(e,t,n,0)}function zR(e,t,n,i){let r=e.index(i),o=e.node(i);if(r==t.index(i)&&i<e.depth-n.openStart){let s=zR(e,t,n,i+1);return o.copy(o.content.replaceChild(r,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=i||t.depth!=i){let{start:r,end:s}=function(e,t){let n=t.depth-e.openStart,i=t.node(n).copy(e.content);for(let r=n-1;r>=0;r--)i=t.node(r).copy(SR.from(i));return{start:i.resolveNoCache(e.openStart+n),end:i.resolveNoCache(i.content.size-e.openEnd-n)}}(n,e);return $R(o,jR(e,r,s,t,i))}{let i=e.parent,r=i.content;return $R(i,r.cut(0,e.parentOffset).append(n.content).append(r.cut(t.parentOffset)))}}return $R(o,VR(e,t,i))}function LR(e,t){if(!t.type.compatibleContent(e.type))throw new AR("Cannot join "+t.type.name+" onto "+e.type.name)}function BR(e,t,n){let i=e.node(n);return LR(i,t.node(n)),i}function NR(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function FR(e,t,n,i){let r=(t||e).node(n),o=0,s=t?t.index(n):r.childCount;e&&(o=e.index(n),e.depth>n?o++:e.textOffset&&(NR(e.nodeAfter,i),o++));for(let a=o;a<s;a++)NR(r.child(a),i);t&&t.depth==n&&t.textOffset&&NR(t.nodeBefore,i)}function $R(e,t){return e.type.checkContent(t),e.copy(t)}function jR(e,t,n,i,r){let o=e.depth>r&&BR(e,t,r+1),s=i.depth>r&&BR(n,i,r+1),a=[];return FR(null,e,r,a),o&&s&&t.index(r)==n.index(r)?(LR(o,s),NR($R(o,jR(e,t,n,i,r+1)),a)):(o&&NR($R(o,VR(e,t,r+1)),a),FR(t,n,r,a),s&&NR($R(s,VR(n,i,r+1)),a)),FR(i,null,r,a),new SR(a)}function VR(e,t,n){let i=[];return FR(null,e,n,i),e.depth>n&&NR($R(BR(e,t,n+1),VR(e,t,n+1)),i),FR(t,null,n,i),new SR(i)}PR.empty=new PR(SR.empty,0,0);class UR{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(t);return n?e.child(t).cut(n):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],i=0==t?0:this.path[3*t-1]+1;for(let r=0;r<e;r++)i+=n.child(r).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return IR.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),i=e.maybeChild(t);if(!n){let e=n;n=i,i=e}let r=n.marks;for(var o=0;o<r.length;o++)!1!==r[o].type.spec.inclusive||i&&r[o].isInSet(i.marks)||(r=r[o--].removeFromSet(r));return r}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,i=e.parent.maybeChild(e.index());for(var r=0;r<n.length;r++)!1!==n[r].type.spec.inclusive||i&&n[r].isInSet(i.marks)||(n=n[r--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new HR(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],i=0,r=t;for(let o=e;;){let{index:e,offset:t}=o.content.findIndex(r),s=r-t;if(n.push(o,e,i+t),!s)break;if(o=o.child(e),o.isText)break;r=s-1,i+=t+1}return new UR(t,n,r)}static resolveCached(e,t){for(let i=0;i<qR.length;i++){let n=qR[i];if(n.pos==t&&n.doc==e)return n}let n=qR[GR]=UR.resolve(e,t);return GR=(GR+1)%WR,n}}let qR=[],GR=0,WR=12;class HR{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const ZR=Object.create(null);let XR=class e{constructor(e,t,n,i=IR.none){this.type=e,this.attrs=t,this.marks=i,this.content=n||SR.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,i=0){this.content.nodesBetween(e,t,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,i){return this.content.textBetween(e,t,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&MR(this.attrs,t||e.defaultAttrs||ZR)&&IR.sameSet(this.marks,n||IR.none)}copy(t=null){return t==this.content?this:new e(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new e(this.type,this.attrs,this.content,t)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return PR.empty;let i=this.resolve(e),r=this.resolve(t),o=n?0:i.sharedDepth(t),s=i.start(o),a=i.node(o).content.cut(i.pos-s,r.pos-s);return new PR(a,i.depth-o,r.depth-o)}replace(e,t,n){return RR(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let i=this.content.child(t-1);return{node:i,index:t-1,offset:n-i.nodeSize}}resolve(e){return UR.resolveCached(this,e)}resolveNoCache(e){return UR.resolve(this,e)}rangeHasMark(e,t,n){let i=!1;return t>e&&this.nodesBetween(e,t,(e=>(n.isInSet(e.marks)&&(i=!0),!i))),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),JR(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=SR.empty,i=0,r=n.childCount){let o=this.contentMatchAt(e).matchFragment(n,i,r),s=o&&o.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(let a=i;a<r;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,i){if(i&&!this.type.allowsMarks(i))return!1;let r=this.contentMatchAt(e).matchType(n),o=r&&r.matchFragment(this.content,t);return!!o&&o.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=IR.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!IR.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map((e=>e.type.name))}`);this.content.forEach((e=>e.check()))}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((e=>e.toJSON()))),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let i=SR.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,n)}};XR.prototype.text=void 0;class KR extends XR{constructor(e,t,n,i){if(super(e,t,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):JR(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new KR(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new KR(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function JR(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class YR{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new QR(e,t);if(null==n.next)return YR.empty;let i=ez(n);n.next&&n.err("Unexpected trailing text");let r=function(e){let t=Object.create(null);return n(sz(e,0));function n(i){let r=[];i.forEach((t=>{e[t].forEach((({term:t,to:n})=>{if(!t)return;let i;for(let e=0;e<r.length;e++)r[e][0]==t&&(i=r[e][1]);sz(e,n).forEach((e=>{i||r.push([t,i=[]]),-1==i.indexOf(e)&&i.push(e)}))}))}));let o=t[i.join(",")]=new YR(i.indexOf(e.length-1)>-1);for(let e=0;e<r.length;e++){let i=r[e][1].sort(oz);o.next.push({type:r[e][0],next:t[i.join(",")]||n(i)})}return o}}(function(e){let t=[[]];return r(o(e,0),n()),t;function n(){return t.push([])-1}function i(e,n,i){let r={term:i,to:n};return t[e].push(r),r}function r(e,t){e.forEach((e=>e.to=t))}function o(e,t){if("choice"==e.type)return e.exprs.reduce(((e,n)=>e.concat(o(n,t))),[]);if("seq"!=e.type){if("star"==e.type){let s=n();return i(t,s),r(o(e.expr,s),s),[i(s)]}if("plus"==e.type){let s=n();return r(o(e.expr,t),s),r(o(e.expr,s),s),[i(s)]}if("opt"==e.type)return[i(t)].concat(o(e.expr,t));if("range"==e.type){let s=t;for(let t=0;t<e.min;t++){let t=n();r(o(e.expr,s),t),s=t}if(-1==e.max)r(o(e.expr,s),s);else for(let t=e.min;t<e.max;t++){let t=n();i(s,t),r(o(e.expr,s),t),s=t}return[i(s)]}if("name"==e.type)return[i(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let i=0;;i++){let s=o(e.exprs[i],t);if(i==e.exprs.length-1)return s;r(s,t=n())}}}(i));return function(e,t){for(let n=0,i=[e];n<i.length;n++){let e=i[n],r=!e.validEnd,o=[];for(let t=0;t<e.next.length;t++){let{type:n,next:s}=e.next[t];o.push(n.name),!r||n.isText||n.hasRequiredAttrs()||(r=!1),-1==i.indexOf(s)&&i.push(s)}r&&t.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(r,n),r}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let i=this;for(let r=t;i&&r<n;r++)i=i.matchType(e.child(r).type);return i}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let i=[this];return function r(o,s){let a=o.matchFragment(e,n);if(a&&(!t||a.validEnd))return SR.from(s.map((e=>e.createAndFill())));for(let e=0;e<o.next.length;e++){let{type:t,next:n}=o.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==i.indexOf(n)){i.push(n);let e=r(n,s.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),r=i.match;if(r.matchType(e)){let e=[];for(let t=i;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<r.next.length;e++){let{type:o,next:s}=r.next[e];o.isLeaf||o.hasRequiredAttrs()||o.name in t||i.type&&!s.validEnd||(n.push({match:o.contentMatch,type:o,via:i}),t[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let i=0;i<n.next.length;i++)-1==e.indexOf(n.next[i].next)&&t(n.next[i].next)}(this),e.map(((t,n)=>{let i=n+(t.validEnd?"*":" ")+" ";for(let r=0;r<t.next.length;r++)i+=(r?", ":"")+t.next[r].type.name+"->"+e.indexOf(t.next[r].next);return i})).join("\n")}}YR.empty=new YR(!0);class QR{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function ez(e){let t=[];do{t.push(tz(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function tz(e){let t=[];do{t.push(nz(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function nz(e){let t=function(e){if(e.eat("(")){let t=ez(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,i=n[t];if(i)return[i];let r=[];for(let o in n){let e=n[o];e.groups.indexOf(t)>-1&&r.push(e)}return 0==r.length&&e.err("No node type or group '"+t+"' found"),r}(e,e.next).map((t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t})));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=rz(e,t)}return t}function iz(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function rz(e,t){let n=iz(e),i=n;return e.eat(",")&&(i="}"!=e.next?iz(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:t}}function oz(e,t){return t-e}function sz(e,t){let n=[];return function t(i){let r=e[i];if(1==r.length&&!r[0].term)return t(r[0].to);n.push(i);for(let e=0;e<r.length;e++){let{term:i,to:o}=r[e];i||-1!=n.indexOf(o)||t(o)}}(t),n.sort(oz)}function az(e){let t=Object.create(null);for(let n in e){let i=e[n];if(!i.hasDefault)return null;t[n]=i.default}return t}function lz(e,t){let n=Object.create(null);for(let i in e){let r=t&&t[i];if(void 0===r){let t=e[i];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+i);r=t.default}n[i]=r}return n}function cz(e){let t=Object.create(null);if(e)for(let n in e)t[n]=new dz(e[n]);return t}let uz=class e{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=cz(n.attrs),this.defaultAttrs=az(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==YR.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:lz(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new XR(this,this.computeAttrs(e),SR.from(t),IR.setFrom(n))}createChecked(e=null,t,n){return t=SR.from(t),this.checkContent(t),new XR(this,this.computeAttrs(e),t,IR.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=SR.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let i=this.contentMatch.matchFragment(t),r=i&&i.fillBefore(SR.empty,!0);return r?new XR(this,e,t.append(r),IR.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:IR.none:e}static compile(t,n){let i=Object.create(null);t.forEach(((t,r)=>i[t]=new e(t,n,r)));let r=n.spec.topNode||"doc";if(!i[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(let e in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}};class dz{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class hz{constructor(e,t,n,i){this.name=e,this.rank=t,this.schema=n,this.spec=i,this.attrs=cz(i.attrs),this.excluded=null;let r=az(this.attrs);this.instance=r?new IR(this,r):null}create(e=null){return!e&&this.instance?this.instance:new IR(this,lz(this.attrs,e))}static compile(e,t){let n=Object.create(null),i=0;return e.forEach(((e,r)=>n[e]=new hz(e,i++,t,r))),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class pz{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=wR.from(e.nodes),t.marks=wR.from(e.marks||{}),this.nodes=uz.compile(this.spec.nodes,this),this.marks=hz.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let e=this.nodes[i],t=e.spec.content||"",r=e.spec.marks;e.contentMatch=n[t]||(n[t]=YR.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.markSet="_"==r?null:r?fz(this,r.split(" ")):""!=r&&e.inlineContent?null:[]}for(let i in this.marks){let e=this.marks[i],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:fz(this,t.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,i){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof uz))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,i)}text(e,t){let n=this.nodes.text;return new KR(n,n.defaultAttrs,e,IR.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return XR.fromJSON(this,e)}markFromJSON(e){return IR.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function fz(e,t){let n=[];for(let i=0;i<t.length;i++){let r=t[i],o=e.marks[r],s=o;if(o)n.push(o);else for(let t in e.marks){let i=e.marks[t];("_"==r||i.spec.group&&i.spec.group.split(" ").indexOf(r)>-1)&&n.push(s=i)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[i]+"'")}return n}let mz=class e{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach((e=>{e.tag?this.tags.push(e):e.style&&this.styles.push(e)})),this.normalizeLists=!this.tags.some((t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)}))}parse(e,t={}){let n=new Ez(this,t,!1);return n.addAll(e,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new Ez(this,t,!0);return n.addAll(e,t.from,t.to),PR.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let n=this.tags[i];if(Sz(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,i){for(let r=i?this.styles.indexOf(i)+1:0;r<this.styles.length;r++){let i=this.styles[r],o=i.style;if(!(0!=o.indexOf(e)||i.context&&!n.matchesContext(i.context)||o.length>e.length&&(61!=o.charCodeAt(e.length)||o.slice(e.length+1)!=t))){if(i.getAttrs){let e=i.getAttrs(t);if(!1===e)continue;i.attrs=e||void 0}return i}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,i=0;for(;i<t.length;i++){let e=t[i];if((null==e.priority?50:e.priority)<n)break}t.splice(i,0,e)}for(let i in e.marks){let t=e.marks[i].spec.parseDOM;t&&t.forEach((e=>{n(e=Tz(e)),e.mark||e.ignore||e.clearMark||(e.mark=i)}))}for(let i in e.nodes){let t=e.nodes[i].spec.parseDOM;t&&t.forEach((e=>{n(e=Tz(e)),e.node||e.ignore||e.mark||(e.node=i)}))}return t}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new e(t,e.schemaRules(t)))}};const gz={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},yz={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},vz={ol:!0,ul:!0},bz=1,xz=2,_z=4;function wz(e,t,n){return null!=t?(t?bz:0)|("full"===t?xz:0):e&&"pre"==e.whitespace?bz|xz:n&~_z}class kz{constructor(e,t,n,i,r,o,s){this.type=e,this.attrs=t,this.marks=n,this.pendingMarks=i,this.solid=r,this.options=s,this.content=[],this.activeMarks=IR.none,this.stashMarks=[],this.match=o||(s&_z?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(SR.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&bz)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=SR.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(SR.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,n=this.pendingMarks;t<n.length;t++){let i=n[t];(this.type?this.type.allowsMarkType(i.type):Cz(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!gz.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Ez{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0;let i,r=t.topNode,o=wz(null,t.preserveWhitespace,0)|(n?_z:0);i=r?new kz(r.type,r.attrs,IR.none,IR.none,!0,t.topMatch||r.type.contentMatch,o):new kz(n?null:e.schema.topNodeType,null,IR.none,IR.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){3==e.nodeType?this.addTextNode(e):1==e.nodeType&&this.addElement(e)}withStyleRules(e,t){let n=e.getAttribute("style");if(!n)return t();let i=this.readStyles(function(e){let t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,i=[];for(;t=n.exec(e);)i.push(t[1],t[2].trim());return i}(n));if(!i)return;let[r,o]=i,s=this.top;for(let a=0;a<o.length;a++)this.removePendingMark(o[a],s);for(let a=0;a<r.length;a++)this.addPendingMark(r[a]);t();for(let a=0;a<r.length;a++)this.removePendingMark(r[a],s);for(let a=0;a<o.length;a++)this.addPendingMark(o[a])}addTextNode(e){let t=e.nodeValue,n=this.top;if(n.options&xz||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(n.options&bz)t=n.options&xz?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=n.content[n.content.length-1],r=e.previousSibling;(!i||r&&"BR"==r.nodeName||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let n,i=e.nodeName.toLowerCase();vz.hasOwnProperty(i)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&vz.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let r=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(r?r.ignore:yz.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e);else if(!r||r.skip||r.closeParent){r&&r.closeParent?this.open=Math.max(0,this.open-1):r&&r.skip.nodeType&&(e=r.skip);let t,n=this.top,o=this.needsBlock;if(gz.hasOwnProperty(i))n.content.length&&n.content[0].isInline&&this.open&&(this.open--,n=this.top),t=!0,n.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);r&&r.skip?this.addAll(e):this.withStyleRules(e,(()=>this.addAll(e))),t&&this.sync(n),this.needsBlock=o}else this.withStyleRules(e,(()=>{this.addElementByRule(e,r,!1===r.consuming?n:void 0)}))}leafFallback(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))}ignoreFallback(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=IR.none,n=IR.none;for(let i=0;i<e.length;i+=2)for(let r;;){let o=this.parser.matchStyle(e[i],e[i+1],this,r);if(!o)break;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach((e=>{o.clearMark(e)&&(n=e.addToSet(n))})):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),!1!==o.consuming)break;r=o}return[t,n]}addElementByRule(e,t,n){let i,r,o;t.node?(r=this.parser.schema.nodes[t.node],r.isLeaf?this.insertNode(r.create(t.attrs))||this.leafFallback(e):i=this.enter(r,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let s=this.top;if(r&&r.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((e=>this.insertNode(e)));else{let n=e;"string"==typeof t.contentElement?n=e.querySelector(t.contentElement):"function"==typeof t.contentElement?n=t.contentElement(e):t.contentElement&&(n=t.contentElement),this.findAround(e,n,!0),this.addAll(n)}i&&this.sync(s)&&this.open--,o&&this.removePendingMark(o,s)}addAll(e,t,n){let i=t||0;for(let r=t?e.childNodes[t]:e.firstChild,o=null==n?null:e.childNodes[n];r!=o;r=r.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(r);this.findAtPoint(e,i)}findPlace(e){let t,n;for(let i=this.open;i>=0;i--){let r=this.nodes[i],o=r.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,n=r,!o.length))break;if(r.solid)break}if(!t)return!1;this.sync(n);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let n=t.activeMarks;for(let i=0;i<e.marks.length;i++)t.type&&!t.type.allowsMarkType(e.marks[i].type)||(n=e.marks[i].addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,n),i}enterInner(e,t=null,n=!1,i){this.closeExtra();let r=this.top;r.applyPending(e),r.match=r.match&&r.match.matchType(e);let o=wz(e,i,r.options);r.options&_z&&0==r.content.length&&(o|=_z),this.nodes.push(new kz(e,t,r.activeMarks,r.pendingMarks,n,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)null==this.find[i].pos&&1==e.nodeType&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,i=!(this.isOpen||n&&n.parent.type!=this.nodes[0].type),r=-(n?n.depth+1:0)+(i?0:1),o=(e,s)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;s>=r;s--)if(o(e-1,s))return!0;return!1}{let e=s>0||0==s&&i?this.nodes[s].type:n&&s>=r?n.node(s-r).type:null;if(!e||e.name!=a&&-1==e.groups.indexOf(a))return!1;s--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}addPendingMark(e){let t=function(e,t){for(let n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let n=this.open;n>=0;n--){let i=this.nodes[n];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let t=i.popFromStashMark(e);t&&i.type&&i.type.allowsMarkType(t.type)&&(i.activeMarks=t.addToSet(i.activeMarks))}if(i==t)break}}}function Sz(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Tz(e){let t={};for(let n in e)t[n]=e[n];return t}function Cz(e,t){let n=t.schema.nodes;for(let i in n){let r=n[i];if(!r.allowsMarkType(e))continue;let o=[],s=e=>{o.push(e);for(let n=0;n<e.edgeCount;n++){let{type:i,next:r}=e.edge(n);if(i==t)return!0;if(o.indexOf(r)<0&&s(r))return!0}};if(s(r.contentMatch))return!0}}class Mz{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=Az(t).createDocumentFragment());let i=n,r=[];return e.forEach((e=>{if(r.length||e.marks.length){let n=0,o=0;for(;n<r.length&&o<e.marks.length;){let t=e.marks[o];if(this.marks[t.type.name]){if(!t.eq(r[n][0])||!1===t.type.spec.spanning)break;n++,o++}else o++}for(;n<r.length;)i=r.pop()[1];for(;o<e.marks.length;){let n=e.marks[o++],s=this.serializeMark(n,e.isInline,t);s&&(r.push([n,i]),i.appendChild(s.dom),i=s.contentDOM||s.dom)}}i.appendChild(this.serializeNodeInner(e,t))})),n}serializeNodeInner(e,t){let{dom:n,contentDOM:i}=Mz.renderSpec(Az(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let r=this.serializeMark(e.marks[i],e.isInline,t);r&&((r.contentDOM||r.dom).appendChild(n),n=r.dom)}return n}serializeMark(e,t,n={}){let i=this.marks[e.type.name];return i&&Mz.renderSpec(Az(n),i(e,t))}static renderSpec(e,t,n=null){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let i,r=t[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));let s=n?e.createElementNS(n,r):e.createElement(r),a=t[1],l=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a)){l=2;for(let e in a)if(null!=a[e]){let t=e.indexOf(" ");t>0?s.setAttributeNS(e.slice(0,t),e.slice(t+1),a[e]):s.setAttribute(e,a[e])}}for(let c=l;c<t.length;c++){let r=t[c];if(0===r){if(c<t.length-1||c>l)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}{let{dom:t,contentDOM:o}=Mz.renderSpec(e,r,n);if(s.appendChild(t),o){if(i)throw new RangeError("Multiple content holes");i=o}}}return{dom:s,contentDOM:i}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Mz(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Iz(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return Iz(e.marks)}}function Iz(e){let t={};for(let n in e){let i=e[n].spec.toDOM;i&&(t[n]=i)}return t}function Az(e){return e.document||window.document}const Pz=Math.pow(2,16);function Oz(e){return 65535&e}class Dz{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Rz{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Rz.empty)return Rz.empty}recover(e){let t=0,n=Oz(e);if(!this.inverted)for(let i=0;i<n;i++)t+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/Pz}(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let i=0,r=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let a=this.ranges[s]-(this.inverted?i:0);if(a>e)break;let l=this.ranges[s+r],c=this.ranges[s+o],u=a+l;if(e<=u){let r=a+i+((l?e==a?-1:e==u?1:t:t)<0?0:c);if(n)return r;let o=e==(t<0?a:u)?null:s/3+(e-a)*Pz,d=e==a?2:e==u?1:4;return(t<0?e!=a:e!=u)&&(d|=8),new Dz(r,d,o)}i+=c-l}return n?e+i:new Dz(e+i,0,null)}touches(e,t){let n=0,i=Oz(t),r=this.inverted?2:1,o=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let t=this.ranges[s]-(this.inverted?n:0);if(t>e)break;let a=this.ranges[s+r];if(e<=t+a&&s==3*i)return!0;n+=this.ranges[s+o]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,r=0;i<this.ranges.length;i+=3){let o=this.ranges[i],s=o-(this.inverted?r:0),a=o+(this.inverted?0:r),l=this.ranges[i+t],c=this.ranges[i+n];e(s,s+l,a,a+c),r+=c-l}}invert(){return new Rz(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?Rz.empty:new Rz(e<0?[0,-e,0]:[0,0,e])}}Rz.empty=new Rz([]);class zz{constructor(e=[],t,n=0,i=e.length){this.maps=e,this.mirror=t,this.from=n,this.to=i}slice(e=0,t=this.maps.length){return new zz(this.maps,this.mirror,e,t)}copy(){return new zz(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,n=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],null!=i&&i<t?n+i:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=i&&i>t?n-i-1:void 0)}}invert(){let e=new zz;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let i=0;for(let r=this.from;r<this.to;r++){let n=this.maps[r].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(r);if(null!=t&&t>r&&t<this.to){r=t,e=this.maps[t].recover(n.recover);continue}}i|=n.delInfo,e=n.pos}return n?e:new Dz(e,i,null)}}const Lz=Object.create(null);class Bz{getMap(){return Rz.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Lz[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Lz)throw new RangeError("Duplicate use of step JSON ID "+e);return Lz[e]=t,t.prototype.jsonID=e,t}}class Nz{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Nz(e,null)}static fail(e){return new Nz(null,e)}static fromReplace(e,t,n,i){try{return Nz.ok(e.replace(t,n,i))}catch(wT){if(wT instanceof AR)return Nz.fail(wT.message);throw wT}}}function Fz(e,t,n){let i=[];for(let r=0;r<e.childCount;r++){let o=e.child(r);o.content.size&&(o=o.copy(Fz(o.content,t,o))),o.isInline&&(o=t(o,n,r)),i.push(o)}return SR.fromArray(i)}class $z extends Bz{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),r=new PR(Fz(t.content,((e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e),i),t.openStart,t.openEnd);return Nz.fromReplace(e,this.from,this.to,r)}invert(){return new jz(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new $z(t.pos,n.pos,this.mark)}merge(e){return e instanceof $z&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $z(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new $z(t.from,t.to,e.markFromJSON(t.mark))}}Bz.jsonID("addMark",$z);class jz extends Bz{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new PR(Fz(t.content,(e=>e.mark(this.mark.removeFromSet(e.marks))),e),t.openStart,t.openEnd);return Nz.fromReplace(e,this.from,this.to,n)}invert(){return new $z(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new jz(t.pos,n.pos,this.mark)}merge(e){return e instanceof jz&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new jz(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new jz(t.from,t.to,e.markFromJSON(t.mark))}}Bz.jsonID("removeMark",jz);class Vz extends Bz{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nz.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Nz.fromReplace(e,this.pos,this.pos+1,new PR(SR.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new Vz(this.pos,t.marks[n]);return new Vz(this.pos,this.mark)}}return new Uz(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Vz(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Vz(t.pos,e.markFromJSON(t.mark))}}Bz.jsonID("addNodeMark",Vz);class Uz extends Bz{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nz.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Nz.fromReplace(e,this.pos,this.pos+1,new PR(SR.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new Vz(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Uz(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Uz(t.pos,e.markFromJSON(t.mark))}}Bz.jsonID("removeNodeMark",Uz);class qz extends Bz{constructor(e,t,n,i=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=i}apply(e){return this.structure&&Wz(e,this.from,this.to)?Nz.fail("Structure replace would overwrite content"):Nz.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Rz([this.from,this.to-this.from,this.slice.size])}invert(e){return new qz(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new qz(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof qz)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?PR.empty:new PR(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new qz(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?PR.empty:new PR(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new qz(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new qz(t.from,t.to,PR.fromJSON(e,t.slice),!!t.structure)}}Bz.jsonID("replace",qz);class Gz extends Bz{constructor(e,t,n,i,r,o,s=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=i,this.slice=r,this.insert=o,this.structure=s}apply(e){if(this.structure&&(Wz(e,this.from,this.gapFrom)||Wz(e,this.gapTo,this.to)))return Nz.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Nz.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?Nz.fromReplace(e,this.from,this.to,n):Nz.fail("Content does not fit in gap")}getMap(){return new Rz([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Gz(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),r=e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||i<t.pos||r>n.pos?null:new Gz(t.pos,n.pos,i,r,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Gz(t.from,t.to,t.gapFrom,t.gapTo,PR.fromJSON(e,t.slice),t.insert,!!t.structure)}}function Wz(e,t,n){let i=e.resolve(t),r=n-t,o=i.depth;for(;r>0&&o>0&&i.indexAfter(o)==i.node(o).childCount;)o--,r--;if(r>0){let e=i.node(o).maybeChild(i.indexAfter(o));for(;r>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,r--}}return!1}function Hz(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function Zz(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let i=e.$from.node(n),r=e.$from.index(n),o=e.$to.indexAfter(n);if(n<e.depth&&i.canReplace(r,o,t))return n;if(0==n||i.type.spec.isolating||!Hz(i,r,o))break}return null}function Xz(e,t,n=null,i=e){let r=function(e,t){let{parent:n,startIndex:i,endIndex:r}=e,o=n.contentMatchAt(i).findWrapping(t);if(!o)return null;let s=o.length?o[0]:t;return n.canReplaceWith(i,r,s)?o:null}(e,t),o=r&&function(e,t){let{parent:n,startIndex:i,endIndex:r}=e,o=n.child(i),s=t.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:t).contentMatch;for(let l=i;a&&l<r;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?s:null}(i,t);return o?r.map(Kz).concat({type:t,attrs:n}).concat(o.map(Kz)):null}function Kz(e){return{type:e,attrs:null}}function Jz(e,t,n=1,i){let r=e.resolve(t),o=r.depth-n,s=i&&i[i.length-1]||r.parent;if(o<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!s.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let c=r.depth-1,u=n-2;c>o;c--,u--){let e=r.node(c),t=r.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),o=i&&i[u+1];o&&(n=n.replaceChild(0,o.type.create(o.attrs)));let s=i&&i[u]||e;if(!e.canReplace(t+1,e.childCount)||!s.type.validContent(n))return!1}let a=r.indexAfter(o),l=i&&i[0];return r.node(o).canReplaceWith(a,a,l?l.type:r.node(o+1).type)}function Yz(e,t){let n=e.resolve(t),i=n.index();return Qz(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function Qz(e,t){return!(!e||!t||e.isLeaf||!e.canAppend(t))}function eL(e,t,n=-1){let i=e.resolve(t);for(let r=i.depth;;r--){let e,o,s=i.index(r);if(r==i.depth?(e=i.nodeBefore,o=i.nodeAfter):n>0?(e=i.node(r+1),s++,o=i.node(r).maybeChild(s)):(e=i.node(r).maybeChild(s-1),o=i.node(r+1)),e&&!e.isTextblock&&Qz(e,o)&&i.node(r).canReplace(s,s+1))return t;if(0==r)break;t=n<0?i.before(r):i.after(r)}}function tL(e,t,n){let i=e.resolve(t);if(!n.content.size)return t;let r=n.content;for(let o=0;o<n.openStart;o++)r=r.firstChild.content;for(let o=1;o<=(0==n.openStart&&n.size?2:1);o++)for(let e=i.depth;e>=0;e--){let t=e==i.depth?0:i.pos<=(i.start(e+1)+i.end(e+1))/2?-1:1,n=i.index(e)+(t>0?1:0),s=i.node(e),a=!1;if(1==o)a=s.canReplace(n,n,r);else{let e=s.contentMatchAt(n).findWrapping(r.firstChild.type);a=e&&s.canReplaceWith(n,n,e[0])}if(a)return 0==t?i.pos:t<0?i.before(e+1):i.after(e+1)}return null}function nL(e,t,n=t,i=PR.empty){if(t==n&&!i.size)return null;let r=e.resolve(t),o=e.resolve(n);return iL(r,o,i)?new qz(t,n,i):new rL(r,o,i).fit()}function iL(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}Bz.jsonID("replaceAround",Gz);class rL{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=SR.empty;for(let i=0;i<=e.depth;i++){let t=e.node(i);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=SR.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let r=this.placed,o=n.depth,s=i.depth;for(;o&&s&&1==r.childCount;)r=r.firstChild.content,o--,s--;let a=new PR(r,o,s);return e>-1?new Gz(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new qz(n.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let r=t.firstChild;if(t.childCount>1&&(i=0),r.type.spec.isolating&&i<=n){e=n;break}t=r.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,i=null;n?(i=aL(this.unplaced.content,n-1).firstChild,e=i.content):e=this.unplaced.content;let r=e.firstChild;for(let o=this.depth;o>=0;o--){let e,{type:s,match:a}=this.frontier[o],l=null;if(1==t&&(r?a.matchType(r.type)||(l=a.fillBefore(SR.from(r),!1)):i&&s.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:o,parent:i,inject:l};if(2==t&&r&&(e=a.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:o,parent:i,wrap:e};if(i&&a.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=aL(e,t);return!(!i.childCount||i.firstChild.isLeaf||(this.unplaced=new PR(e,t+1,Math.max(n,i.size+t>=e.size-n?t+1:0)),0))}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=aL(e,t);if(i.childCount<=1&&t>0){let r=e.size-t<=t+i.size;this.unplaced=new PR(oL(e,t-1,1),t-1,r?t-1:n)}else this.unplaced=new PR(oL(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:i,wrap:r}){for(;this.depth>t;)this.closeFrontierNode();if(r)for(let f=0;f<r.length;f++)this.openFrontierNode(r[f]);let o=this.unplaced,s=n?n.content:o.content,a=o.openStart-e,l=0,c=[],{match:u,type:d}=this.frontier[t];if(i){for(let e=0;e<i.childCount;e++)c.push(i.child(e));u=u.matchFragment(i)}let h=s.size+e-(o.content.size-o.openEnd);for(;l<s.childCount;){let e=s.child(l),t=u.matchType(e.type);if(!t)break;l++,(l>1||0==a||e.content.size)&&(u=t,c.push(lL(e.mark(d.allowedMarks(e.marks)),1==l?a:0,l==s.childCount?h:-1)))}let p=l==s.childCount;p||(h=-1),this.placed=sL(this.placed,t,SR.from(c)),this.frontier[t].match=u,p&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let f=0,m=s;f<h;f++){let e=m.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),m=e.content}this.unplaced=p?0==e?PR.empty:new PR(oL(o.content,e-1,1),e-1,h<0?o.openEnd:e-1):new PR(oL(o.content,e,l),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!cL(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:i}=this.frontier[t],r=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=cL(e,t,i,n,r);if(o){for(let n=t-1;n>=0;n--){let{match:t,type:i}=this.frontier[n],r=cL(e,n,i,t,!0);if(!r||r.childCount)continue e}return{depth:t,fit:o,move:r?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=sL(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),i=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,i)}return e}openFrontierNode(e,t=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=sL(this.placed,this.depth,SR.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(SR.empty,!0);e.childCount&&(this.placed=sL(this.placed,this.frontier.length,e))}}function oL(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(oL(e.firstChild.content,t-1,n)))}function sL(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(sL(e.lastChild.content,t-1,n)))}function aL(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function lL(e,t,n){if(t<=0)return e;let i=e.content;return t>1&&(i=i.replaceChild(0,lL(i.firstChild,t-1,1==i.childCount?n-1:0))),t>0&&(i=e.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(e.type.contentMatch.matchFragment(i).fillBefore(SR.empty,!0)))),e.copy(i)}function cL(e,t,n,i,r){let o=e.node(t),s=r?e.indexAfter(t):e.index(t);if(s==o.childCount&&!n.compatibleContent(o.type))return null;let a=i.fillBefore(o.content,!0,s);return a&&!function(e,t,n){for(let i=n;i<t.childCount;i++)if(!e.allowsMarks(t.child(i).marks))return!0;return!1}(n,o.content,s)?a:null}function uL(e,t,n,i,r){if(t<n){let r=e.firstChild;e=e.replaceChild(0,r.copy(uL(r.content,t+1,n,i,r)))}if(t>i){let t=r.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(SR.empty,!0))}return e}function dL(e,t){let n=[];for(let i=Math.min(e.depth,t.depth);i>=0;i--){let r=e.start(i);if(r<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(r==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==r-1)&&n.push(i)}return n}class hL extends Bz{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return Nz.fail("No node at attribute step's position");let n=Object.create(null);for(let r in t.attrs)n[r]=t.attrs[r];n[this.attr]=this.value;let i=t.type.create(n,null,t.marks);return Nz.fromReplace(e,this.pos,this.pos+1,new PR(SR.from(i),0,t.isLeaf?0:1))}getMap(){return Rz.empty}invert(e){return new hL(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new hL(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new hL(t.pos,t.attr,t.value)}}Bz.jsonID("attr",hL);class pL extends Bz{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return Nz.ok(n)}getMap(){return Rz.empty}invert(e){return new pL(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new pL(t.attr,t.value)}}Bz.jsonID("docAttr",pL);let fL=class extends Error{};fL=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},(fL.prototype=Object.create(Error.prototype)).constructor=fL,fL.prototype.name="TransformError";class mL{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new zz}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new fL(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=PR.empty){let i=nL(this.doc,e,t,n);return i&&this.step(i),this}replaceWith(e,t,n){return this.replace(e,t,new PR(SR.from(n),0,0))}delete(e,t){return this.replace(e,t,PR.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,i){if(!i.size)return e.deleteRange(t,n);let r=e.doc.resolve(t),o=e.doc.resolve(n);if(iL(r,o,i))return e.step(new qz(t,n,i));let s=dL(r,e.doc.resolve(n));0==s[s.length-1]&&s.pop();let a=-(r.depth+1);s.unshift(a);for(let p=r.depth,f=r.pos-1;p>0;p--,f--){let e=r.node(p).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;s.indexOf(p)>-1?a=p:r.before(p)==f&&s.splice(1,0,-p)}let l=s.indexOf(a),c=[],u=i.openStart;for(let p=i.content,f=0;;f++){let e=p.firstChild;if(c.push(e),f==i.openStart)break;p=e.content}for(let p=u-1;p>=0;p--){let e=c[p],t=(d=e.type).spec.defining||d.spec.definingForContent;if(t&&!e.sameMarkup(r.node(Math.abs(a)-1)))u=p;else if(t||!e.type.isTextblock)break}var d;for(let p=i.openStart;p>=0;p--){let t=(p+u+1)%(i.openStart+1),a=c[t];if(a)for(let c=0;c<s.length;c++){let u=s[(c+l)%s.length],d=!0;u<0&&(d=!1,u=-u);let h=r.node(u-1),p=r.index(u-1);if(h.canReplaceWith(p,p,a.type,a.marks))return e.replace(r.before(u),d?o.after(u):n,new PR(uL(i.content,0,i.openStart,t),t,i.openEnd))}}let h=e.steps.length;for(let p=s.length-1;p>=0&&(e.replace(t,n,i),!(e.steps.length>h));p--){let e=s[p];e<0||(t=r.before(e),n=o.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,i){if(!i.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let r=function(e,t,n){let i=e.resolve(t);if(i.parent.canReplaceWith(i.index(),i.index(),n))return t;if(0==i.parentOffset)for(let r=i.depth-1;r>=0;r--){let e=i.index(r);if(i.node(r).canReplaceWith(e,e,n))return i.before(r+1);if(e>0)return null}if(i.parentOffset==i.parent.content.size)for(let r=i.depth-1;r>=0;r--){let e=i.indexAfter(r);if(i.node(r).canReplaceWith(e,e,n))return i.after(r+1);if(e<i.node(r).childCount)return null}return null}(e.doc,t,i.type);null!=r&&(t=n=r)}e.replaceRange(t,n,new PR(SR.from(i),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let i=e.doc.resolve(t),r=e.doc.resolve(n),o=dL(i,r);for(let s=0;s<o.length;s++){let t=o[s],n=s==o.length-1;if(n&&0==t||i.node(t).type.contentMatch.validEnd)return e.delete(i.start(t),r.end(t));if(t>0&&(n||i.node(t-1).canReplace(i.index(t-1),r.indexAfter(t-1))))return e.delete(i.before(t),r.after(t))}for(let s=1;s<=i.depth&&s<=r.depth;s++)if(t-i.start(s)==i.depth-s&&n>i.end(s)&&r.end(s)-n!=r.depth-s)return e.delete(i.before(s),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:i,$to:r,depth:o}=t,s=i.before(o+1),a=r.after(o+1),l=s,c=a,u=SR.empty,d=0;for(let f=o,m=!1;f>n;f--)m||i.index(f)>0?(m=!0,u=SR.from(i.node(f).copy(u)),d++):l--;let h=SR.empty,p=0;for(let f=o,m=!1;f>n;f--)m||r.after(f+1)<r.end(f)?(m=!0,h=SR.from(r.node(f).copy(h)),p++):c++;e.step(new Gz(l,c,s,a,new PR(u.append(h),d,p),u.size-d,!0))}(this,e,t),this}join(e,t=1){return function(e,t,n){let i=new qz(t-n,t+n,PR.empty,!0);e.step(i)}(this,e,t),this}wrap(e,t){return function(e,t,n){let i=SR.empty;for(let s=n.length-1;s>=0;s--){if(i.size){let e=n[s].type.contentMatch.matchFragment(i);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=SR.from(n[s].type.create(n[s].attrs,i))}let r=t.start,o=t.end;e.step(new Gz(r,o,r,o,new PR(i,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,i=null){return function(e,t,n,i,r){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=e.steps.length;e.doc.nodesBetween(t,n,((t,n)=>{if(t.isTextblock&&!t.hasMarkup(i,r)&&function(e,t,n){let i=e.resolve(t),r=i.index();return i.parent.canReplaceWith(r,r+1,n)}(e.doc,e.mapping.slice(o).map(n),i)){e.clearIncompatible(e.mapping.slice(o).map(n,1),i);let s=e.mapping.slice(o),a=s.map(n,1),l=s.map(n+t.nodeSize,1);return e.step(new Gz(a,l,a+1,l-1,new PR(SR.from(i.create(r,null,t.marks)),0,0),1,!0)),!1}}))}(this,e,t,n,i),this}setNodeMarkup(e,t,n=null,i){return function(e,t,n,i,r){let o=e.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");n||(n=o.type);let s=n.create(i,null,r||o.marks);if(o.isLeaf)return e.replaceWith(t,t+o.nodeSize,s);if(!n.validContent(o.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new Gz(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new PR(SR.from(s),0,0),1,!0))}(this,e,t,n,i),this}setNodeAttribute(e,t,n){return this.step(new hL(e,t,n)),this}setDocAttribute(e,t){return this.step(new pL(e,t)),this}addNodeMark(e,t){return this.step(new Vz(e,t)),this}removeNodeMark(e,t){if(!(t instanceof IR)){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(!(t=t.isInSet(n.marks)))return this}return this.step(new Uz(e,t)),this}split(e,t=1,n){return function(e,t,n=1,i){let r=e.doc.resolve(t),o=SR.empty,s=SR.empty;for(let a=r.depth,l=r.depth-n,c=n-1;a>l;a--,c--){o=SR.from(r.node(a).copy(o));let e=i&&i[c];s=SR.from(e?e.type.create(e.attrs,s):r.node(a).copy(s))}e.step(new qz(t,t,new PR(o.append(s),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){return function(e,t,n,i){let r,o,s=[],a=[];e.doc.nodesBetween(t,n,((e,l,c)=>{if(!e.isInline)return;let u=e.marks;if(!i.isInSet(u)&&c.type.allowsMarkType(i.type)){let c=Math.max(l,t),d=Math.min(l+e.nodeSize,n),h=i.addToSet(u);for(let e=0;e<u.length;e++)u[e].isInSet(h)||(r&&r.to==c&&r.mark.eq(u[e])?r.to=d:s.push(r=new jz(c,d,u[e])));o&&o.to==c?o.to=d:a.push(o=new $z(c,d,i))}})),s.forEach((t=>e.step(t))),a.forEach((t=>e.step(t)))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,i){let r=[],o=0;e.doc.nodesBetween(t,n,((e,s)=>{if(!e.isInline)return;o++;let a=null;if(i instanceof hz){let t,n=e.marks;for(;t=i.isInSet(n);)(a||(a=[])).push(t),n=t.removeFromSet(n)}else i?i.isInSet(e.marks)&&(a=[i]):a=e.marks;if(a&&a.length){let i=Math.min(s+e.nodeSize,n);for(let e=0;e<a.length;e++){let n,l=a[e];for(let e=0;e<r.length;e++){let t=r[e];t.step==o-1&&l.eq(r[e].style)&&(n=t)}n?(n.to=i,n.step=o):r.push({style:l,from:Math.max(s,t),to:i,step:o})}}})),r.forEach((t=>e.step(new jz(t.from,t.to,t.style))))}(this,e,t,n),this}clearIncompatible(e,t,n){return function(e,t,n,i=n.contentMatch){let r=e.doc.nodeAt(t),o=[],s=t+1;for(let a=0;a<r.childCount;a++){let t=r.child(a),l=s+t.nodeSize,c=i.matchType(t.type);if(c){i=c;for(let i=0;i<t.marks.length;i++)n.allowsMarkType(t.marks[i].type)||e.step(new jz(s,l,t.marks[i]));if(t.isText&&!n.spec.code){let e,i,r=/\r?\n|\r/g;for(;e=r.exec(t.text);)i||(i=new PR(SR.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),o.push(new qz(s+e.index,s+e.index+e[0].length,i))}}else o.push(new qz(s,l,PR.empty));s=l}if(!i.validEnd){let t=i.fillBefore(SR.empty,!0);e.replace(s,s,new PR(t,0,0))}for(let a=o.length-1;a>=0;a--)e.step(o[a])}(this,e,t,n),this}}const gL=Object.create(null);class yL{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new vL(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=PR.empty){let n=t.content.lastChild,i=null;for(let s=0;s<t.openEnd;s++)i=n,n=n.lastChild;let r=e.steps.length,o=this.ranges;for(let s=0;s<o.length;s++){let{$from:a,$to:l}=o[s],c=e.mapping.slice(r);e.replaceRange(c.map(a.pos),c.map(l.pos),s?PR.empty:t),0==s&&ML(e,r,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,i=this.ranges;for(let r=0;r<i.length;r++){let{$from:o,$to:s}=i[r],a=e.mapping.slice(n),l=a.map(o.pos),c=a.map(s.pos);r?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),ML(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let i=e.parent.inlineContent?new _L(e):CL(e.node(0),e.parent,e.pos,e.index(),t,n);if(i)return i;for(let r=e.depth-1;r>=0;r--){let i=t<0?CL(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):CL(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(i)return i}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new SL(e.node(0))}static atStart(e){return CL(e,e,0,0,1)||new SL(e)}static atEnd(e){return CL(e,e,e.content.size,e.childCount,-1)||new SL(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=gL[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in gL)throw new RangeError("Duplicate use of selection JSON ID "+e);return gL[e]=t,t.prototype.jsonID=e,t}getBookmark(){return _L.between(this.$anchor,this.$head).getBookmark()}}yL.prototype.visible=!0;class vL{constructor(e,t){this.$from=e,this.$to=t}}let bL=!1;function xL(e){bL||e.parent.inlineContent||(bL=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class _L extends yL{constructor(e,t=e){xL(e),xL(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return yL.near(n);let i=e.resolve(t.map(this.anchor));return new _L(i.parent.inlineContent?i:n,n)}replace(e,t=PR.empty){if(super.replace(e,t),t==PR.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof _L&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new wL(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new _L(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let i=e.resolve(t);return new this(i,n==t?i:e.resolve(n))}static between(e,t,n){let i=e.pos-t.pos;if(n&&!i||(n=i>=0?1:-1),!t.parent.inlineContent){let e=yL.findFrom(t,n,!0)||yL.findFrom(t,-n,!0);if(!e)return yL.near(t,n);t=e.$head}return e.parent.inlineContent||(0==i||(e=(yL.findFrom(e,-n,!0)||yL.findFrom(e,n,!0)).$anchor).pos<t.pos!=i<0)&&(e=t),new _L(e,t)}}yL.jsonID("text",_L);class wL{constructor(e,t){this.anchor=e,this.head=t}map(e){return new wL(e.map(this.anchor),e.map(this.head))}resolve(e){return _L.between(e.resolve(this.anchor),e.resolve(this.head))}}class kL extends yL{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:i}=t.mapResult(this.anchor),r=e.resolve(i);return n?yL.near(r):new kL(r)}content(){return new PR(SR.from(this.node),0,0)}eq(e){return e instanceof kL&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new EL(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new kL(e.resolve(t.anchor))}static create(e,t){return new kL(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}kL.prototype.visible=!1,yL.jsonID("node",kL);class EL{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new wL(n,n):new EL(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&kL.isSelectable(n)?new kL(t):yL.near(t)}}class SL extends yL{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=PR.empty){if(t==PR.empty){e.delete(0,e.doc.content.size);let t=yL.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new SL(e)}map(e){return new SL(e)}eq(e){return e instanceof SL}getBookmark(){return TL}}yL.jsonID("all",SL);const TL={map(){return this},resolve:e=>new SL(e)};function CL(e,t,n,i,r,o=!1){if(t.inlineContent)return _L.create(e,n);for(let s=i-(r>0?0:1);r>0?s<t.childCount:s>=0;s+=r){let i=t.child(s);if(i.isAtom){if(!o&&kL.isSelectable(i))return kL.create(e,n-(r<0?i.nodeSize:0))}else{let t=CL(e,i,n+r,r<0?i.childCount:0,r,o);if(t)return t}n+=i.nodeSize*r}return null}function ML(e,t,n){let i=e.steps.length-1;if(i<t)return;let r,o=e.steps[i];(o instanceof qz||o instanceof Gz)&&(e.mapping.maps[i].forEach(((e,t,n,i)=>{null==r&&(r=i)})),e.setSelection(yL.near(e.doc.resolve(r),n)))}class IL extends mL{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return IR.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||IR.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let i=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);let r=this.storedMarks;if(!r){let e=this.doc.resolve(t);r=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,i.text(e,r)),this.selection.empty||this.setSelection(yL.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function AL(e,t){return t&&e?e.bind(t):e}class PL{constructor(e,t,n){this.name=e,this.init=AL(t.init,n),this.apply=AL(t.apply,n)}}const OL=[new PL("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new PL("selection",{init:(e,t)=>e.selection||yL.atStart(t.doc),apply:e=>e.selection}),new PL("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,i)=>i.selection.$cursor?e.storedMarks:null}),new PL("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class DL{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=OL.slice(),t&&t.forEach((e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new PL(e.key,e.spec.state,e))}))}}class RL{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),i=null;for(;;){let r=!1;for(let o=0;o<this.config.plugins.length;o++){let s=this.config.plugins[o];if(s.spec.appendTransaction){let a=i?i[o].n:0,l=i?i[o].state:this,c=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,o)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let e=0;e<this.config.plugins.length;e++)i.push(e<o?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),r=!0}i&&(i[o]={state:n,n:t.length})}}if(!r)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new RL(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let r=n[i];t[r.name]=r.apply(e,this[r.name],this,t)}return t}get tr(){return new IL(this)}static create(e){let t=new DL(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new RL(t);for(let i=0;i<t.fields.length;i++)n[t.fields[i].name]=t.fields[i].init(e,n);return n}reconfigure(e){let t=new DL(this.schema,e.plugins),n=t.fields,i=new RL(t);for(let r=0;r<n.length;r++){let t=n[r].name;i[t]=this.hasOwnProperty(t)?this[t]:n[r].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((e=>e.toJSON()))),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],r=i.spec.state;r&&r.toJSON&&(t[n]=r.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new DL(e.schema,e.plugins),r=new RL(i);return i.fields.forEach((i=>{if("doc"==i.name)r.doc=XR.fromJSON(e.schema,t.doc);else if("selection"==i.name)r.selection=yL.fromJSON(r.doc,t.selection);else if("storedMarks"==i.name)t.storedMarks&&(r.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let o in n){let s=n[o],a=s.spec.state;if(s.key==i.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,o))return void(r[i.name]=a.fromJSON.call(s,e,t[o],r))}r[i.name]=i.init(e,r)}})),r}}function zL(e,t,n){for(let i in e){let r=e[i];r instanceof Function?r=r.bind(t):"handleDOMEvents"==i&&(r=zL(r,t,{})),n[i]=r}return n}class LL{constructor(e){this.spec=e,this.props={},e.props&&zL(e.props,this,this.props),this.key=e.key?e.key.key:NL("plugin")}getState(e){return e[this.key]}}const BL=Object.create(null);function NL(e){return e in BL?e+"$"+ ++BL[e]:(BL[e]=0,e+"$")}class FL{constructor(e="key"){this.key=NL(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const $L=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},jL=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let VL=null;const UL=function(e,t,n){let i=VL||(VL=document.createRange());return i.setEnd(e,null==n?e.nodeValue.length:n),i.setStart(e,t||0),i},qL=function(e,t,n,i){return n&&(WL(e,t,n,i,-1)||WL(e,t,n,i,1))},GL=/^(img|br|input|textarea|hr)$/i;function WL(e,t,n,i,r){for(;;){if(e==n&&t==i)return!0;if(t==(r<0?0:HL(e))){let n=e.parentNode;if(!n||1!=n.nodeType||ZL(e)||GL.test(e.nodeName)||"false"==e.contentEditable)return!1;t=$L(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(r<0?-1:0)]).contentEditable)return!1;t=r<0?HL(e):0}}}function HL(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function ZL(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const XL=function(e){return e.focusNode&&qL(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function KL(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const JL="undefined"!=typeof navigator?navigator:null,YL="undefined"!=typeof document?document:null,QL=JL&&JL.userAgent||"",eB=/Edge\/(\d+)/.exec(QL),tB=/MSIE \d/.exec(QL),nB=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(QL),iB=!!(tB||nB||eB),rB=tB?document.documentMode:nB?+nB[1]:eB?+eB[1]:0,oB=!iB&&/gecko\/(\d+)/i.test(QL);oB&&(/Firefox\/(\d+)/.exec(QL)||[0,0])[1];const sB=!iB&&/Chrome\/(\d+)/.exec(QL),aB=!!sB,lB=sB?+sB[1]:0,cB=!iB&&!!JL&&/Apple Computer/.test(JL.vendor),uB=cB&&(/Mobile\/\w+/.test(QL)||!!JL&&JL.maxTouchPoints>2),dB=uB||!!JL&&/Mac/.test(JL.platform),hB=!!JL&&/Win/.test(JL.platform),pB=/Android \d/.test(QL),fB=!!YL&&"webkitFontSmoothing"in YL.documentElement.style,mB=fB?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function gB(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function yB(e,t){return"number"==typeof e?e:e[t]}function vB(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,i=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*i}}function bB(e,t,n){let i=e.someProp("scrollThreshold")||0,r=e.someProp("scrollMargin")||5,o=e.dom.ownerDocument;for(let s=n||e.dom;s;s=jL(s)){if(1!=s.nodeType)continue;let e=s,n=e==o.body,a=n?gB(o):vB(e),l=0,c=0;if(t.top<a.top+yB(i,"top")?c=-(a.top-t.top+yB(r,"top")):t.bottom>a.bottom-yB(i,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+yB(r,"top")-a.top:t.bottom-a.bottom+yB(r,"bottom")),t.left<a.left+yB(i,"left")?l=-(a.left-t.left+yB(r,"left")):t.right>a.right-yB(i,"right")&&(l=t.right-a.right+yB(r,"right")),l||c)if(n)o.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,i=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let r=e.scrollLeft-n,o=e.scrollTop-i;t={left:t.left-r,top:t.top-o,right:t.right-r,bottom:t.bottom-o}}if(n||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function xB(e){let t=[],n=e.ownerDocument;for(let i=e;i&&(t.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),e!=n);i=jL(i));return t}function _B(e,t){for(let n=0;n<e.length;n++){let{dom:i,top:r,left:o}=e[n];i.scrollTop!=r+t&&(i.scrollTop=r+t),i.scrollLeft!=o&&(i.scrollLeft=o)}}let wB=null;function kB(e,t){let n,i,r,o,s=2e8,a=0,l=t.top,c=t.top;for(let u=e.firstChild,d=0;u;u=u.nextSibling,d++){let e;if(1==u.nodeType)e=u.getClientRects();else{if(3!=u.nodeType)continue;e=UL(u).getClientRects()}for(let h=0;h<e.length;h++){let p=e[h];if(p.top<=l&&p.bottom>=c){l=Math.max(p.bottom,l),c=Math.min(p.top,c);let e=p.left>t.left?p.left-t.left:p.right<t.left?t.left-p.right:0;if(e<s){n=u,s=e,i=e&&3==n.nodeType?{left:p.right<t.left?p.right:p.left,top:t.top}:t,1==u.nodeType&&e&&(a=d+(t.left>=(p.left+p.right)/2?1:0));continue}}else p.top>t.top&&!r&&p.left<=t.left&&p.right>=t.left&&(r=u,o={left:Math.max(p.left,Math.min(p.right,t.left)),top:p.top});!n&&(t.left>=p.right&&t.top>=p.top||t.left>=p.left&&t.top>=p.bottom)&&(a=d+1)}}return!n&&r&&(n=r,i=o,s=0),n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,i=document.createRange();for(let r=0;r<n;r++){i.setEnd(e,r+1),i.setStart(e,r);let n=MB(i,1);if(n.top!=n.bottom&&EB(t,n))return{node:e,offset:r+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(n,i):!n||s&&1==n.nodeType?{node:e,offset:a}:kB(n,i)}function EB(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function SB(e,t,n){let i=e.childNodes.length;if(i&&n.top<n.bottom)for(let r=Math.max(0,Math.min(i-1,Math.floor(i*(t.top-n.top)/(n.bottom-n.top))-2)),o=r;;){let n=e.childNodes[o];if(1==n.nodeType){let e=n.getClientRects();for(let i=0;i<e.length;i++){let r=e[i];if(EB(t,r))return SB(n,t,r)}}if((o=(o+1)%i)==r)break}return e}function TB(e,t){let n,i=e.dom.ownerDocument,r=0,o=function(e,t,n){if(e.caretPositionFromPoint)try{let i=e.caretPositionFromPoint(t,n);if(i)return{node:i.offsetNode,offset:i.offset}}catch(Fk){}if(e.caretRangeFromPoint){let i=e.caretRangeFromPoint(t,n);if(i)return{node:i.startContainer,offset:i.startOffset}}}(i,t.left,t.top);o&&({node:n,offset:r}=o);let s,a=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=e.dom.getBoundingClientRect();if(!EB(t,n))return null;if(a=SB(e.dom,t,n),!a)return null}if(cB)for(let c=a;n&&c;c=jL(c))c.draggable&&(n=void 0);if(a=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(a,t),n){if(oB&&1==n.nodeType&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){let e,i=n.childNodes[r];"IMG"==i.nodeName&&(e=i.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&r++}let i;fB&&r&&1==n.nodeType&&1==(i=n.childNodes[r-1]).nodeType&&"false"==i.contentEditable&&i.getBoundingClientRect().top>=t.top&&r--,n==e.dom&&r==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?s=e.state.doc.content.size:0!=r&&1==n.nodeType&&"BR"==n.childNodes[r-1].nodeName||(s=function(e,t,n,i){let r=-1;for(let o=t,s=!1;o!=e.dom;){let t=e.docView.nearestDesc(o,!0);if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent&&!s||!t.contentDOM)){let e=t.dom.getBoundingClientRect();if(t.node.isBlock&&t.parent&&!s&&(s=!0,e.left>i.left||e.top>i.top?r=t.posBefore:(e.right<i.left||e.bottom<i.top)&&(r=t.posAfter)),!t.contentDOM&&r<0&&!t.node.isText)return(t.node.isBlock?i.top<(e.top+e.bottom)/2:i.left<(e.left+e.right)/2)?t.posBefore:t.posAfter}o=t.dom.parentNode}return r>-1?r:e.docView.posFromDOM(t,n,-1)}(e,n,r,t))}null==s&&(s=function(e,t,n){let{node:i,offset:r}=kB(t,n),o=-1;if(1==i.nodeType&&!i.firstChild){let e=i.getBoundingClientRect();o=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(i,r,o)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:s,inside:l?l.posAtStart-l.border:-1}}function CB(e){return e.top<e.bottom||e.left<e.right}function MB(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(CB(e))return e}return Array.prototype.find.call(n,CB)||e.getBoundingClientRect()}const IB=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function AB(e,t,n){let{node:i,offset:r,atom:o}=e.docView.domFromPos(t,n<0?-1:1),s=fB||oB;if(3==i.nodeType){if(!s||!IB.test(i.nodeValue)&&(n<0?r:r!=i.nodeValue.length)){let e=r,t=r,o=n<0?1:-1;return n<0&&!r?(t++,o=-1):n>=0&&r==i.nodeValue.length?(e--,o=1):n<0?e--:t++,PB(MB(UL(i,e,t),o),o<0)}{let e=MB(UL(i,r,r),n);if(oB&&r&&/\s/.test(i.nodeValue[r-1])&&r<i.nodeValue.length){let t=MB(UL(i,r-1,r-1),-1);if(t.top==e.top){let n=MB(UL(i,r,r+1),-1);if(n.top!=e.top)return PB(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(o||0)).parent.inlineContent){if(null==o&&r&&(n<0||r==HL(i))){let e=i.childNodes[r-1];if(1==e.nodeType)return OB(e.getBoundingClientRect(),!1)}if(null==o&&r<HL(i)){let e=i.childNodes[r];if(1==e.nodeType)return OB(e.getBoundingClientRect(),!0)}return OB(i.getBoundingClientRect(),n>=0)}if(null==o&&r&&(n<0||r==HL(i))){let e=i.childNodes[r-1],t=3==e.nodeType?UL(e,HL(e)-(s?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return PB(MB(t,1),!1)}if(null==o&&r<HL(i)){let e=i.childNodes[r];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?UL(e,0,s?0:1):1==e.nodeType?e:null:null;if(t)return PB(MB(t,-1),!0)}return PB(MB(3==i.nodeType?UL(i):i,-n),n>=0)}function PB(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function OB(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function DB(e,t,n){let i=e.state,r=e.root.activeElement;i!=t&&e.updateState(t),r!=e.dom&&e.focus();try{return n()}finally{i!=t&&e.updateState(i),r!=e.dom&&r&&r.focus()}}const RB=/[\u0590-\u08ac]/;let zB=null,LB=null,BB=!1;function NB(e,t,n){return zB==t&&LB==n?BB:(zB=t,LB=n,BB="up"==n||"down"==n?function(e,t,n){let i=t.selection,r="up"==n?i.$from:i.$to;return DB(e,t,(()=>{let{node:t}=e.docView.domFromPos(r.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let i=AB(e,r.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=UL(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let r=t[e];if(r.bottom>r.top+1&&("up"==n?i.top-r.top>2*(r.bottom-i.top):r.bottom-i.bottom>2*(i.bottom-r.top)))return!1}}return!0}))}(e,t,n):function(e,t,n){let{$head:i}=t.selection;if(!i.parent.isTextblock)return!1;let r=i.parentOffset,o=!r,s=r==i.parent.content.size,a=e.domSelection();return RB.test(i.parent.textContent)&&a.modify?DB(e,t,(()=>{let{focusNode:t,focusOffset:r,anchorNode:o,anchorOffset:s}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=i.depth?e.docView.domAfterPos(i.before()):e.dom,{focusNode:u,focusOffset:d}=e.domSelectionRange(),h=u&&!c.contains(1==u.nodeType?u:u.parentNode)||t==u&&r==d;try{a.collapse(o,s),t&&(t!=o||r!=s)&&a.extend&&a.extend(t,r)}catch(Fk){}return null!=l&&(a.caretBidiLevel=l),h})):"left"==n||"backward"==n?o:s}(e,t,n))}class FB{constructor(e,t,n,i){this.parent=e,this.children=t,this.dom=n,this.contentDOM=i,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let i=this.children[t];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,i;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(i)+i.size:this.posAtStart}{let n,i;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(i=n.pmViewDesc)||i.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(i):this.posAtEnd}}let i;if(e==this.dom&&this.contentDOM)i=t>$L(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){i=!1;break}if(t.previousSibling)break}if(null==i&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){i=!0;break}if(t.nextSibling)break}}return(null==i?n>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,i=e;i;i=i.parentNode){let r,o=this.getDesc(i);if(o&&(!t||o.node)){if(!n||!(r=o.nodeDOM)||(1==r.nodeType?r.contains(1==e.nodeType?e:e.parentNode):r==e))return o;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let i=e;i;i=i.parentNode){let r=this.getDesc(i);if(r)return r.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let i=this.children[t],r=n+i.size;if(n==e&&r!=n){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<r)return i.descAt(e-n-i.border);n=r}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let r=0;n<this.children.length;n++){let t=this.children[n],o=r+t.size;if(o>e||t instanceof WB){i=e-r;break}r=o}if(i)return this.children[n].domFromPos(i-this.children[n].border,t);for(let r;n&&!(r=this.children[n-1]).size&&r instanceof $B&&r.side>=0;n--);if(t<=0){let e,i=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,i=!1);return e&&t&&i&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?$L(e.dom)+1:0}}{let e,i=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,i=!1);return e&&i&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?$L(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,r=-1;for(let o=n,s=0;;s++){let n=this.children[s],a=o+n.size;if(-1==i&&e<=a){let r=o+n.border;if(e>=r&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,r);e=o;for(let t=s;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){i=$L(n.dom)+1;break}e-=n.size}-1==i&&(i=0)}if(i>-1&&(a>t||s==this.children.length-1)){t=a;for(let e=s+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){r=$L(n.dom);break}t+=n.size}-1==r&&(r=this.contentDOM.childNodes.length);break}o=a}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:r}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,i=!1){let r=Math.min(e,t),o=Math.max(e,t);for(let d=0,h=0;d<this.children.length;d++){let s=this.children[d],a=h+s.size;if(r>h&&o<a)return s.setSelection(e-h-s.border,t-h-s.border,n,i);h=a}let s=this.domFromPos(e,e?-1:1),a=t==e?s:this.domFromPos(t,t?-1:1),l=n.getSelection(),c=!1;if((oB||cB)&&e==t){let{node:e,offset:t}=s;if(3==e.nodeType){if(c=!(!t||"\n"!=e.nodeValue[t-1]),c&&t==e.nodeValue.length)for(let n,i=e;i;i=i.parentNode){if(n=i.nextSibling){"BR"==n.nodeName&&(s=a={node:n.parentNode,offset:$L(n)+1});break}let e=i.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];c=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(oB&&l.focusNode&&l.focusNode!=a.node&&1==l.focusNode.nodeType){let e=l.focusNode.childNodes[l.focusOffset];e&&"false"==e.contentEditable&&(i=!0)}if(!(i||c&&cB)&&qL(s.node,s.offset,l.anchorNode,l.anchorOffset)&&qL(a.node,a.offset,l.focusNode,l.focusOffset))return;let u=!1;if((l.extend||e==t)&&!c){l.collapse(s.node,s.offset);try{e!=t&&l.extend(a.node,a.offset),u=!0}catch(Fk){}}if(!u){if(e>t){let e=s;s=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,i=0;i<this.children.length;i++){let r=this.children[i],o=n+r.size;if(n==o?e<=o&&t>=n:e<o&&t>n){let i=n+r.border,s=o-r.border;if(e>=i&&t<=s)return this.dirty=e==n||t==o?2:1,void(e!=i||t!=s||!r.contentLost&&r.dom.parentNode==this.contentDOM?r.markDirty(e-i,t-i):r.dirty=3);r.dirty=r.dom!=r.contentDOM||r.dom.parentNode!=this.contentDOM||r.children.length?3:2}n=o}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class $B extends FB{constructor(e,t,n,i){let r,o=t.type.toDOM;if("function"==typeof o&&(o=o(n,(()=>r?r.parent?r.parent.posBeforeChild(r):void 0:i))),!t.type.spec.raw){if(1!=o.nodeType){let e=document.createElement("span");e.appendChild(o),o=e}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,r=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class jB extends FB{constructor(e,t,n,i){super(e,[],t,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class VB extends FB{constructor(e,t,n,i){super(e,[],n,i),this.mark=t}static create(e,t,n,i){let r=i.nodeViews[t.type.name],o=r&&r(t,i,n);return o&&o.dom||(o=Mz.renderSpec(document,t.type.spec.toDOM(t,n))),new VB(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let i=VB.create(this.parent,this.mark,!0,n),r=this.children,o=this.size;t<o&&(r=oN(r,t,o,n)),e>0&&(r=oN(r,0,e,n));for(let s=0;s<r.length;s++)r[s].parent=i;return i.children=r,i}}class UB extends FB{constructor(e,t,n,i,r,o,s,a,l){super(e,[],r,o),this.node=t,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=s}static create(e,t,n,i,r,o){let s,a=r.nodeViews[t.type.name],l=a&&a(t,r,(()=>s?s.parent?s.parent.posBeforeChild(s):void 0:o),n,i),c=l&&l.dom,u=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else c||({dom:c,contentDOM:u}=Mz.renderSpec(document,t.type.spec.toDOM(t)));u||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let d=c;return c=eN(c,n,t),l?s=new HB(e,t,n,i,c,u||null,d,l,r,o+1):t.isText?new GB(e,t,n,i,c,d,r):new UB(e,t,n,i,c,u||null,d,r,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>SR.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&tN(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,i=t,r=e.composing?this.localCompositionInfo(e,t):null,o=r&&r.pos>-1?r:null,s=r&&r.pos<0,a=new iN(this,o&&o.node,e);!function(e,t,n,i){let r=t.locals(e),o=0;if(0==r.length){for(let n=0;n<e.childCount;n++){let s=e.child(n);i(s,r,t.forChild(o,s),n),o+=s.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d,h,p;for(;s<r.length&&r[s].to==o;){let e=r[s++];e.widget&&(u?(d||(d=[u])).push(e):u=e)}if(u)if(d){d.sort(rN);for(let e=0;e<d.length;e++)n(d[e],c,!!l)}else n(u,c,!!l);if(l)p=-1,h=l,l=null;else{if(!(c<e.childCount))break;p=c,h=e.child(c++)}for(let e=0;e<a.length;e++)a[e].to<=o&&a.splice(e--,1);for(;s<r.length&&r[s].from<=o&&r[s].to>o;)a.push(r[s++]);let f=o+h.nodeSize;if(h.isText){let e=f;s<r.length&&r[s].from<e&&(e=r[s].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<f&&(l=h.cut(e-o),h=h.cut(0,e-o),f=e,p=-1)}let m=h.isInline&&!h.isLeaf?a.filter((e=>!e.inline)):a.slice();i(h,m,t.forChild(o,h),p),o=f}}(this.node,this.innerDeco,((t,r,o)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!o&&a.syncToMarks(r==this.node.childCount?IR.none:this.node.child(r).marks,n,e),a.placeWidget(t,e,i)}),((t,o,l,c)=>{let u;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,o,l,c)||s&&e.state.selection.from>i&&e.state.selection.to<i+t.nodeSize&&(u=a.findIndexWithChild(r.node))>-1&&a.updateNodeAt(t,o,l,u,e)||a.updateNextNode(t,o,l,e,c,i)||a.addNode(t,o,l,e,i),i+=t.nodeSize})),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(o&&this.protectLocalComposition(e,o),ZB(this.contentDOM,this.children,e),uB&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof _L)||n<t||i>t+this.node.content.size)return null;let r=e.domSelectionRange(),o=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=HL(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(r.focusNode,r.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let e=o.nodeValue,r=function(e,t,n,i){for(let r=0,o=0;r<e.childCount&&o<=i;){let s=e.child(r++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;r<e.childCount;){let t=e.child(r++);if(o+=t.nodeSize,!t.isText)break;l+=t.text}if(o>=n){if(o>=i&&l.slice(i-t.length-a,i-a)==t)return i-t.length;let e=a<i?l.lastIndexOf(t,i-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==i&&l.length>=i+t.length-a&&l.slice(i-a,i-a+t.length)==t)return i}}return-1}(this.node.content,e,n-t,i-t);return r<0?null:{node:o,pos:r,text:e}}return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:n,text:i}){if(this.getDesc(t))return;let r=t;for(;r.parentNode!=this.contentDOM;r=r.parentNode){for(;r.previousSibling;)r.parentNode.removeChild(r.previousSibling);for(;r.nextSibling;)r.parentNode.removeChild(r.nextSibling);r.pmViewDesc&&(r.pmViewDesc=void 0)}let o=new jB(this,r,t,i);e.input.compositionNodes.push(o),this.children=oN(this.children,n,n+i.length,e,o)}update(e,t,n,i){return!(3==this.dirty||!e.sameMarkup(this.node)||(this.updateInner(e,t,n,i),0))}updateInner(e,t,n,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(tN(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=YB(this.dom,this.nodeDOM,JB(this.outerDeco,this.node,t),JB(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function qB(e,t,n,i,r){eN(i,t,e);let o=new UB(void 0,e,t,n,i,i,i,r,0);return o.contentDOM&&o.updateChildren(r,0),o}class GB extends UB{constructor(e,t,n,i,r,o,s){super(e,t,n,i,r,null,o,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,i){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node)||(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=0,0))}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let i=this.node.cut(e,t),r=document.createTextNode(i.text);return new GB(this.parent,i,this.outerDeco,this.innerDeco,r,r,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}}class WB extends FB{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class HB extends UB{constructor(e,t,n,i,r,o,s,a,l,c){super(e,t,n,i,r,o,s,l,c),this.spec=a}update(e,t,n,i){if(3==this.dirty)return!1;if(this.spec.update){let r=this.spec.update(e,t,n);return r&&this.updateInner(e,t,n,i),r}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,i){this.spec.setSelection?this.spec.setSelection(e,t,n):super.setSelection(e,t,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ZB(e,t,n){let i=e.firstChild,r=!1;for(let o=0;o<t.length;o++){let s=t[o],a=s.dom;if(a.parentNode==e){for(;a!=i;)i=nN(i),r=!0;i=i.nextSibling}else r=!0,e.insertBefore(a,i);if(s instanceof VB){let t=i?i.previousSibling:e.lastChild;ZB(s.contentDOM,s.children,n),i=t?t.nextSibling:e.firstChild}}for(;i;)i=nN(i),r=!0;r&&n.trackWrites==e&&(n.trackWrites=null)}const XB=function(e){e&&(this.nodeName=e)};XB.prototype=Object.create(null);const KB=[new XB];function JB(e,t,n){if(0==e.length)return KB;let i=n?KB[0]:new XB,r=[i];for(let o=0;o<e.length;o++){let s=e[o].type.attrs;if(s){s.nodeName&&r.push(i=new XB(s.nodeName));for(let e in s){let o=s[e];null!=o&&(n&&1==r.length&&r.push(i=new XB(t.isInline?"span":"div")),"class"==e?i.class=(i.class?i.class+" ":"")+o:"style"==e?i.style=(i.style?i.style+";":"")+o:"nodeName"!=e&&(i[e]=o))}}}return r}function YB(e,t,n,i){if(n==KB&&i==KB)return t;let r=t;for(let o=0;o<i.length;o++){let t=i[o],s=n[o];if(o){let n;s&&s.nodeName==t.nodeName&&r!=e&&(n=r.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(r),s=KB[0]),r=n}QB(r,s||KB[0],t)}return r}function QB(e,t,n){for(let i in t)"class"==i||"style"==i||"nodeName"==i||i in n||e.removeAttribute(i);for(let i in n)"class"!=i&&"style"!=i&&"nodeName"!=i&&n[i]!=t[i]&&e.setAttribute(i,n[i]);if(t.class!=n.class){let i=t.class?t.class.split(" ").filter(Boolean):[],r=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<i.length;t++)-1==r.indexOf(i[t])&&e.classList.remove(i[t]);for(let t=0;t<r.length;t++)-1==i.indexOf(r[t])&&e.classList.add(r[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=i.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function eN(e,t,n){return YB(e,e,KB,JB(t,n,1!=e.nodeType))}function tN(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function nN(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class iN{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,i=n.children.length,r=e.childCount,o=new Map,s=[];e:for(;r>0;){let a;for(;;)if(i){let e=n.children[i-1];if(!(e instanceof VB)){a=e,i--;break}n=e,i=e.children.length}else{if(n==t)break e;i=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(r-1))break;--r,o.set(a,r),s.push(a)}}return{index:r,matched:o,matches:s.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let i=0,r=this.stack.length>>1,o=Math.min(r,e.length);for(;i<o&&(i==r-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&!1!==e[i].type.spec.spanning;)i++;for(;i<r;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),r--;for(;r<e.length;){this.stack.push(this.top,this.index+1);let i=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[r])&&!this.isLocked(n.dom)){i=t;break}}if(i>-1)i>this.index&&(this.changed=!0,this.destroyBetween(this.index,i)),this.top=this.top.children[this.index];else{let i=VB.create(this.top,e[r],t,n);this.top.children.splice(this.index,0,i),this.top=i,this.changed=!0}this.index=0,r++}}findNodeMatch(e,t,n,i){let r,o=-1;if(i>=this.preMatch.index&&(r=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&r.matchesNode(e,t,n))o=this.top.children.indexOf(r,this.index);else for(let s=this.index,a=Math.min(this.top.children.length,s+5);s<a;s++){let i=this.top.children[s];if(i.matchesNode(e,t,n)&&!this.preMatch.matched.has(i)){o=s;break}}return!(o<0||(this.destroyBetween(this.index,o),this.index++,0))}updateNodeAt(e,t,n,i,r){let o=this.top.children[i];return 3==o.dirty&&o.dom==o.contentDOM&&(o.dirty=2),!!o.update(e,t,n,r)&&(this.destroyBetween(this.index,i),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,i,r,o){for(let s=this.index;s<this.top.children.length;s++){let a=this.top.children[s];if(a instanceof UB){let l=this.preMatch.matched.get(a);if(null!=l&&l!=r)return!1;let c,u=a.dom,d=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&tN(t,a.outerDeco));if(!d&&a.update(e,t,n,i))return this.destroyBetween(this.index,s),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(c=this.recreateWrapper(a,e,t,n,i,o)))return this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(i,o+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,i,r,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let s=UB.create(this.top,t,n,i,r,o);if(s.contentDOM){s.children=e.children,e.children=[];for(let e of s.children)e.parent=s}return e.destroy(),s}addNode(e,t,n,i,r){let o=UB.create(this.top,e,t,n,i,r);o.contentDOM&&o.updateChildren(i,r+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(e)||e!=i.widget&&i.widget.type.toDOM.parentNode){let i=new $B(this.top,e,t,n);this.top.children.splice(this.index++,0,i),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof VB;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof GB)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((cB||aB)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let i=new WB(this.top,[],n,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function rN(e,t){return e.type.side-t.type.side}function oN(e,t,n,i,r){let o=[];for(let s=0,a=0;s<e.length;s++){let l=e[s],c=a,u=a+=l.size;c>=n||u<=t?o.push(l):(c<t&&o.push(l.slice(0,t-c,i)),r&&(o.push(r),r=void 0),u>n&&o.push(l.slice(n-c,l.size,i)))}return o}function sN(e,t=null){let n=e.domSelectionRange(),i=e.state.doc;if(!n.focusNode)return null;let r=e.docView.nearestDesc(n.focusNode),o=r&&0==r.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let a,l,c=i.resolve(s);if(XL(n)){for(a=c;r&&!r.node;)r=r.parent;let e=r.node;if(r&&e.isAtom&&kL.isSelectable(e)&&r.parent&&(!e.isInline||!function(e,t,n){for(let i=0==t,r=t==HL(e);i||r;){if(e==n)return!0;let t=$L(e);if(!(e=e.parentNode))return!1;i=i&&0==t,r=r&&t==HL(e)}}(n.focusNode,n.focusOffset,r.dom))){let e=r.posBefore;l=new kL(s==e?c:i.resolve(e))}}else{let t=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(t<0)return null;a=i.resolve(t)}return l||(l=mN(e,a,c,"pointer"==t||e.state.selection.head<c.pos&&!o?1:-1)),l}function aN(e){return e.editable?e.hasFocus():yN(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function lN(e,t=!1){let n=e.state.selection;if(pN(e,n),aN(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&aB){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&qL(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange(),i=e.cursorWrapper.dom,r="IMG"==i.nodeName;r?n.setEnd(i.parentNode,$L(i)+1):n.setEnd(i,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!r&&!e.state.selection.visible&&iB&&rB<=11&&(i.disabled=!0,i.disabled=!1)}(e);else{let i,r,{anchor:o,head:s}=n;!cN||n instanceof _L||(n.$from.parent.inlineContent||(i=uN(e,n.from)),n.empty||n.$from.parent.inlineContent||(r=uN(e,n.to))),e.docView.setSelection(o,s,e.root,t),cN&&(i&&hN(i),r&&hN(r)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),i=n.anchorNode,r=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==i&&n.anchorOffset==r||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout((()=>{aN(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const cN=cB||aB&&lB<63;function uN(e,t){let{node:n,offset:i}=e.docView.domFromPos(t,0),r=i<n.childNodes.length?n.childNodes[i]:null,o=i?n.childNodes[i-1]:null;if(cB&&r&&"false"==r.contentEditable)return dN(r);if(!(r&&"false"!=r.contentEditable||o&&"false"!=o.contentEditable)){if(r)return dN(r);if(o)return dN(o)}}function dN(e){return e.contentEditable="true",cB&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function hN(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function pN(e,t){if(t instanceof kL){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(fN(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else fN(e)}function fN(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function mN(e,t,n,i){return e.someProp("createSelectionBetween",(i=>i(e,t,n)))||_L.between(t,n,i)}function gN(e){return!(e.editable&&!e.hasFocus())&&yN(e)}function yN(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(Fk){return!1}}function vN(e,t){let{$anchor:n,$head:i}=e.selection,r=t>0?n.max(i):n.min(i),o=r.parent.inlineContent?r.depth?e.doc.resolve(t>0?r.after():r.before()):null:r;return o&&yL.findFrom(o,t)}function bN(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function xN(e,t,n){let i=e.state.selection;if(!(i instanceof _L)){if(i instanceof kL&&i.node.isInline)return bN(e,new _L(t>0?i.$to:i.$from));{let n=vN(e.state,t);return!!n&&bN(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=i,r=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!r||r.isText||!r.isLeaf)return!1;let o=e.state.doc.resolve(n.pos+r.nodeSize*(t<0?-1:1));return bN(e,new _L(i.$anchor,o))}if(!i.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=vN(e.state,t);return!!(n&&n instanceof kL)&&bN(e,n)}if(!(dB&&n.indexOf("m")>-1)){let n,r=i.$head,o=r.textOffset?null:t<0?r.nodeBefore:r.nodeAfter;if(!o||o.isText)return!1;let s=t<0?r.pos-o.nodeSize:r.pos;return!!(o.isAtom||(n=e.docView.descAt(s))&&!n.contentDOM)&&(kL.isSelectable(o)?bN(e,new kL(t<0?e.state.doc.resolve(r.pos-o.nodeSize):r)):!!fB&&bN(e,new _L(e.state.doc.resolve(t<0?s:s+o.nodeSize))))}}function _N(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function wN(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function kN(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,i=t.focusOffset;if(!n)return;let r,o,s=!1;for(oB&&1==n.nodeType&&i<_N(n)&&wN(n.childNodes[i],-1)&&(s=!0);;)if(i>0){if(1!=n.nodeType)break;{let e=n.childNodes[i-1];if(wN(e,-1))r=n,o=--i;else{if(3!=e.nodeType)break;n=e,i=n.nodeValue.length}}}else{if(EN(n))break;{let t=n.previousSibling;for(;t&&wN(t,-1);)r=n.parentNode,o=$L(t),t=t.previousSibling;if(t)n=t,i=_N(n);else{if(n=n.parentNode,n==e.dom)break;i=0}}}s?SN(e,n,i):r&&SN(e,r,o)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,i=t.focusOffset;if(!n)return;let r,o,s=_N(n);for(;;)if(i<s){if(1!=n.nodeType)break;if(!wN(n.childNodes[i],1))break;r=n,o=++i}else{if(EN(n))break;{let t=n.nextSibling;for(;t&&wN(t,1);)r=t.parentNode,o=$L(t)+1,t=t.nextSibling;if(t)n=t,i=0,s=_N(n);else{if(n=n.parentNode,n==e.dom)break;i=s=0}}}r&&SN(e,r,o)}(e)}function EN(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function SN(e,t,n){if(3!=t.nodeType){let e,i;(i=function(e,t){for(;e&&t==e.childNodes.length&&!ZL(e);)t=$L(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=i,n=0):(e=function(e,t){for(;e&&!t&&!ZL(e);)t=$L(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let i=e.domSelection();if(XL(i)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),i.removeAllRanges(),i.addRange(e)}else i.extend&&i.extend(t,n);e.domObserver.setCurSelection();let{state:r}=e;setTimeout((()=>{e.state==r&&lN(e)}),50)}function TN(e,t){let n=e.state.doc.resolve(t);if(!aB&&!hB&&n.parent.inlineContent){let i=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),r=(n.top+n.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(n.left-i.left)>1)return n.left<i.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),r=(n.top+n.bottom)/2;if(r>i.top&&r<i.bottom&&Math.abs(n.left-i.left)>1)return n.left>i.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function CN(e,t,n){let i=e.state.selection;if(i instanceof _L&&!i.empty||n.indexOf("s")>-1)return!1;if(dB&&n.indexOf("m")>-1)return!1;let{$from:r,$to:o}=i;if(!r.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=vN(e.state,t);if(n&&n instanceof kL)return bN(e,n)}if(!r.parent.inlineContent){let n=t<0?r:o,s=i instanceof SL?yL.near(n,t):yL.findFrom(n,t);return!!s&&bN(e,s)}return!1}function MN(e,t){if(!(e.state.selection instanceof _L))return!0;let{$head:n,$anchor:i,empty:r}=e.state.selection;if(!n.sameParent(i))return!0;if(!r)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let o=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(o&&!o.isText){let i=e.state.tr;return t<0?i.delete(n.pos-o.nodeSize,n.pos):i.delete(n.pos,n.pos+o.nodeSize),e.dispatch(i),!0}return!1}function IN(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function AN(e,t){let n=t.keyCode,i=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||dB&&72==n&&"c"==i)return MN(e,-1)||kN(e,-1);if(46==n&&!t.shiftKey||dB&&68==n&&"c"==i)return MN(e,1)||kN(e,1);if(13==n||27==n)return!0;if(37==n||dB&&66==n&&"c"==i){let t=37==n?"ltr"==TN(e,e.state.selection.from)?-1:1:-1;return xN(e,t,i)||kN(e,t)}if(39==n||dB&&70==n&&"c"==i){let t=39==n?"ltr"==TN(e,e.state.selection.from)?1:-1:1;return xN(e,t,i)||kN(e,t)}return 38==n||dB&&80==n&&"c"==i?CN(e,-1,i)||kN(e,-1):40==n||dB&&78==n&&"c"==i?function(e){if(!cB||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;IN(e,n,"true"),setTimeout((()=>IN(e,n,"false")),20)}return!1}(e)||CN(e,1,i)||kN(e,1):i==(dB?"m":"c")&&(66==n||73==n||89==n||90==n)}function PN(e,t){e.someProp("transformCopied",(n=>{t=n(t,e)}));let n=[],{content:i,openStart:r,openEnd:o}=t;for(;r>1&&o>1&&1==i.childCount&&1==i.firstChild.childCount;){r--,o--;let e=i.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),i=e.content}let s=e.someProp("clipboardSerializer")||Mz.fromSchema(e.state.schema),a=jN(),l=a.createElement("div");l.appendChild(s.serializeFragment(i,{document:a}));let c,u=l.firstChild,d=0;for(;u&&1==u.nodeType&&(c=FN[u.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=a.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),d++}u=l.firstChild}u&&1==u.nodeType&&u.setAttribute("data-pm-slice",`${r} ${o}${d?` -${d}`:""} ${JSON.stringify(n)}`);let h=e.someProp("clipboardTextSerializer",(n=>n(t,e)))||t.content.textBetween(0,t.content.size,"\n\n");return{dom:l,text:h}}function ON(e,t,n,i,r){let o,s,a=r.parent.type.spec.code;if(!n&&!t)return null;let l=t&&(i||a||!n);if(l){if(e.someProp("transformPastedText",(n=>{t=n(t,a||i,e)})),a)return t?new PR(SR.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):PR.empty;let n=e.someProp("clipboardTextParser",(n=>n(t,r,i,e)));if(n)s=n;else{let n=r.marks(),{schema:i}=e.state,s=Mz.fromSchema(i);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach((e=>{let t=o.appendChild(document.createElement("p"));e&&t.appendChild(s.serializeNode(i.text(e,n)))}))}}else e.someProp("transformPastedHTML",(t=>{n=t(n,e)})),o=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,i=jN().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e);if((n=r&&FN[r[1].toLowerCase()])&&(e=n.map((e=>"<"+e+">")).join("")+e+n.map((e=>"</"+e+">")).reverse().join("")),i.innerHTML=e,n)for(let o=0;o<n.length;o++)i=i.querySelector(n[o])||i;return i}(n),fB&&function(e){let t=e.querySelectorAll(aB?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let i=t[n];1==i.childNodes.length&&" "==i.textContent&&i.parentNode&&i.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),i)}}(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let e=o.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;o=e}if(!s){let t=e.someProp("clipboardParser")||e.someProp("domParser")||mz.fromSchema(e.state.schema);s=t.parseSlice(o,{preserveWhitespace:!(!l&&!u),context:r,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||DN.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(u)s=function(e,t){if(!e.size)return e;let n,i=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(wT){return e}let{content:r,openStart:o,openEnd:s}=e;for(let a=n.length-2;a>=0;a-=2){let e=i.nodes[n[a]];if(!e||e.hasRequiredAttrs())break;r=SR.from(e.create(n[a+1],r)),o++,s++}return new PR(r,o,s)}(NN(s,+u[1],+u[2]),u[4]);else if(s=PR.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let i,r=t.node(n).contentMatchAt(t.index(n)),o=[];if(e.forEach((e=>{if(!o)return;let t,n=r.findWrapping(e.type);if(!n)return o=null;if(t=o.length&&i.length&&zN(n,i,e,o[o.length-1],0))o[o.length-1]=t;else{o.length&&(o[o.length-1]=LN(o[o.length-1],i.length));let t=RN(e,n);o.push(t),r=r.matchType(t.type),i=n}})),o)return SR.from(o)}return e}(s.content,r),!0),s.openStart||s.openEnd){let e=0,t=0;for(let n=s.content.firstChild;e<s.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=s.content.lastChild;t<s.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);s=NN(s,e,t)}return e.someProp("transformPasted",(t=>{s=t(s,e)})),s}const DN=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function RN(e,t,n=0){for(let i=t.length-1;i>=n;i--)e=t[i].create(null,SR.from(e));return e}function zN(e,t,n,i,r){if(r<e.length&&r<t.length&&e[r]==t[r]){let o=zN(e,t,n,i.lastChild,r+1);if(o)return i.copy(i.content.replaceChild(i.childCount-1,o));if(i.contentMatchAt(i.childCount).matchType(r==e.length-1?n.type:e[r+1]))return i.copy(i.content.append(SR.from(RN(n,e,r+1))))}}function LN(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,LN(e.lastChild,t-1)),i=e.contentMatchAt(e.childCount).fillBefore(SR.empty,!0);return e.copy(n.append(i))}function BN(e,t,n,i,r,o){let s=t<0?e.firstChild:e.lastChild,a=s.content;return e.childCount>1&&(o=0),r<i-1&&(a=BN(a,t,n,i,r+1,o)),r>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,o<=r).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(SR.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function NN(e,t,n){return t<e.openStart&&(e=new PR(BN(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new PR(BN(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const FN={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let $N=null;function jN(){return $N||($N=document.implementation.createHTMLDocument("title"))}const VN={},UN={},qN={touchstart:!0,touchmove:!0};class GN{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function WN(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function HN(e){e.someProp("handleDOMEvents",(t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>ZN(e,t))}))}function ZN(e,t){return e.someProp("handleDOMEvents",(n=>{let i=n[t.type];return!!i&&(i(e,t)||t.defaultPrevented)}))}function XN(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function KN(e){return{left:e.clientX,top:e.clientY}}function JN(e,t,n,i,r){if(-1==i)return!1;let o=e.state.doc.resolve(i);for(let s=o.depth+1;s>0;s--)if(e.someProp(t,(t=>s>o.depth?t(e,n,o.nodeAfter,o.before(s),r,!0):t(e,n,o.node(s),o.before(s),r,!1))))return!0;return!1}function YN(e,t,n){e.focused||e.focus();let i=e.state.tr.setSelection(t);"pointer"==n&&i.setMeta("pointer",!0),e.dispatch(i)}function QN(e,t,n,i,r){return JN(e,"handleClickOn",t,n,i)||e.someProp("handleClick",(n=>n(e,t,i)))||(r?function(e,t){if(-1==t)return!1;let n,i,r=e.state.selection;r instanceof kL&&(n=r.node);let o=e.state.doc.resolve(t);for(let s=o.depth+1;s>0;s--){let e=s>o.depth?o.nodeAfter:o.node(s);if(kL.isSelectable(e)){i=n&&r.$from.depth>0&&s>=r.$from.depth&&o.before(r.$from.depth+1)==r.$from.pos?o.before(r.$from.depth):o.before(s);break}}return null!=i&&(YN(e,kL.create(e.state.doc,i),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),i=n.nodeAfter;return!!(i&&i.isAtom&&kL.isSelectable(i))&&(YN(e,new kL(n),"pointer"),!0)}(e,n))}function eF(e,t,n,i){return JN(e,"handleDoubleClickOn",t,n,i)||e.someProp("handleDoubleClick",(n=>n(e,t,i)))}function tF(e,t,n,i){return JN(e,"handleTripleClickOn",t,n,i)||e.someProp("handleTripleClick",(n=>n(e,t,i)))||function(e,t,n){if(0!=n.button)return!1;let i=e.state.doc;if(-1==t)return!!i.inlineContent&&(YN(e,_L.create(i,0,i.content.size),"pointer"),!0);let r=i.resolve(t);for(let o=r.depth+1;o>0;o--){let t=o>r.depth?r.nodeAfter:r.node(o),n=r.before(o);if(t.inlineContent)YN(e,_L.create(i,n+1,n+1+t.content.size),"pointer");else{if(!kL.isSelectable(t))continue;YN(e,kL.create(i,n),"pointer")}return!0}}(e,n,i)}function nF(e){return cF(e)}UN.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!oF(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!pB||!aB||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!uB||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",(t=>t(e,n)))||AN(e,n)?n.preventDefault():WN(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout((()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",(t=>t(e,KL(13,"Enter")))),e.input.lastIOSEnter=0)}),200)}},UN.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},UN.keypress=(e,t)=>{let n=t;if(oF(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||dB&&n.metaKey)return;if(e.someProp("handleKeyPress",(t=>t(e,n))))return void n.preventDefault();let i=e.state.selection;if(!(i instanceof _L&&i.$from.sameParent(i.$to))){let t=String.fromCharCode(n.charCode);/[\r\n]/.test(t)||e.someProp("handleTextInput",(n=>n(e,i.$from.pos,i.$to.pos,t)))||e.dispatch(e.state.tr.insertText(t).scrollIntoView()),n.preventDefault()}};const iF=dB?"metaKey":"ctrlKey";VN.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let i=nF(e),r=Date.now(),o="singleClick";r-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,i=t.y-e.clientY;return n*n+i*i<100}(n,e.input.lastClick)&&!n[iF]&&("singleClick"==e.input.lastClick.type?o="doubleClick":"doubleClick"==e.input.lastClick.type&&(o="tripleClick")),e.input.lastClick={time:r,x:n.clientX,y:n.clientY,type:o};let s=e.posAtCoords(KN(n));s&&("singleClick"==o?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new rF(e,s,n,!!i)):("doubleClick"==o?eF:tF)(e,s.pos,s.inside,n)?n.preventDefault():WN(e,"pointer"))};class rF{constructor(e,t,n,i){let r,o;if(this.view=e,this.pos=t,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[iF],this.allowDefault=n.shiftKey,t.inside>-1)r=e.state.doc.nodeAt(t.inside),o=t.inside;else{let n=e.state.doc.resolve(t.pos);r=n.parent,o=n.depth?n.before():0}const s=i?null:n.target,a=s?e.docView.nearestDesc(s,!0):null;this.target=a?a.dom:null;let{selection:l}=e.state;(0==n.button&&r.type.spec.draggable&&!1!==r.type.spec.selectable||l instanceof kL&&l.from<=o&&l.to>o)&&(this.mightDrag={node:r,pos:o,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!oB||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),WN(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((()=>lN(this.view))),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(KN(e))),this.updateAllowDefault(e),this.allowDefault||!t?WN(this.view,"pointer"):QN(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||cB&&this.mightDrag&&!this.mightDrag.node.isAtom||aB&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(YN(this.view,yL.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):WN(this.view,"pointer")}move(e){this.updateAllowDefault(e),WN(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function oF(e,t){return!!e.composing||!!(cB&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}VN.touchstart=e=>{e.input.lastTouch=Date.now(),nF(e),WN(e,"pointer")},VN.touchmove=e=>{e.input.lastTouch=Date.now(),WN(e,"pointer")},VN.contextmenu=e=>nF(e);const sF=pB?5e3:-1;function aF(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout((()=>cF(e)),t))}function lF(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function cF(e,t=!1){if(!(pB&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),lF(e),t||e.docView&&e.docView.dirty){let t=sN(e);return t&&!t.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(t)):e.updateState(e.state),!0}return!1}}UN.compositionstart=UN.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((e=>!1===e.type.spec.inclusive))))e.markCursor=e.state.storedMarks||n.marks(),cF(e,!0),e.markCursor=null;else if(cF(e),oB&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,i=t.focusOffset;n&&1==n.nodeType&&0!=i;){let t=i<0?n.lastChild:n.childNodes[i-1];if(!t)break;if(3==t.nodeType){e.domSelection().collapse(t,t.nodeValue.length);break}n=t,i=-1}}e.input.composing=!0}aF(e,sF)},UN.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionPendingChanges&&Promise.resolve().then((()=>e.domObserver.flush())),e.input.compositionID++,aF(e,20))};const uF=iB&&rB<15||uB&&mB<604;function dF(e,t,n,i,r){let o=ON(e,t,n,i,e.state.selection.$from);if(e.someProp("handlePaste",(t=>t(e,r,o||PR.empty))))return!0;if(!o)return!1;let s=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(o),a=s?e.state.tr.replaceSelectionWith(s,i):e.state.tr.replaceSelection(o);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}VN.copy=UN.cut=(e,t)=>{let n=t,i=e.state.selection,r="cut"==n.type;if(i.empty)return;let o=uF?null:n.clipboardData,s=i.content(),{dom:a,text:l}=PN(e,s);o?(n.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),r=document.createRange();r.selectNodeContents(t),e.dom.blur(),i.removeAllRanges(),i.addRange(r),setTimeout((()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()}),50)}(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},UN.paste=(e,t)=>{let n=t;if(e.composing&&!pB)return;let i=uF?null:n.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;i&&dF(e,i.getData("text/plain"),i.getData("text/html"),r,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,i=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus();let r=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout((()=>{e.focus(),i.parentNode&&i.parentNode.removeChild(i),n?dF(e,i.value,null,r,t):dF(e,i.textContent,i.innerHTML,r,t)}),50)}(e,n)};class hF{constructor(e,t){this.slice=e,this.move=t}}const pF=dB?"altKey":"ctrlKey";VN.dragstart=(e,t)=>{let n=t,i=e.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let r=e.state.selection,o=r.empty?null:e.posAtCoords(KN(n));if(o&&o.pos>=r.from&&o.pos<=(r instanceof kL?r.to-1:r.to));else if(i&&i.mightDrag)e.dispatch(e.state.tr.setSelection(kL.create(e.state.doc,i.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&e.dispatch(e.state.tr.setSelection(kL.create(e.state.doc,t.posBefore)))}let s=e.state.selection.content(),{dom:a,text:l}=PN(e,s);n.dataTransfer.clearData(),n.dataTransfer.setData(uF?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",uF||n.dataTransfer.setData("text/plain",l),e.dragging=new hF(s,!n[pF])},VN.dragend=e=>{let t=e.dragging;window.setTimeout((()=>{e.dragging==t&&(e.dragging=null)}),50)},UN.dragover=UN.dragenter=(e,t)=>t.preventDefault(),UN.drop=(e,t)=>{let n=t,i=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let r=e.posAtCoords(KN(n));if(!r)return;let o=e.state.doc.resolve(r.pos),s=i&&i.slice;s?e.someProp("transformPasted",(t=>{s=t(s,e)})):s=ON(e,n.dataTransfer.getData(uF?"Text":"text/plain"),uF?null:n.dataTransfer.getData("text/html"),!1,o);let a=!(!i||n[pF]);if(e.someProp("handleDrop",(t=>t(e,n,s||PR.empty,a))))return void n.preventDefault();if(!s)return;n.preventDefault();let l=s?tL(e.state.doc,o.pos,s):o.pos;null==l&&(l=o.pos);let c=e.state.tr;a&&c.deleteSelection();let u=c.mapping.map(l),d=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(h))return;let p=c.doc.resolve(u);if(d&&kL.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new kL(p));else{let t=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach(((e,n,i,r)=>t=r)),c.setSelection(mN(e,p,c.doc.resolve(t)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))},VN.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&lN(e)}),20))},VN.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},VN.beforeinput=(e,t)=>{if(aB&&pB&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout((()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",(t=>t(e,KL(8,"Backspace")))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())}),50)}};for(let e in UN)VN[e]=UN[e];function fF(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class mF{constructor(e,t){this.toDOM=e,this.spec=t||xF,this.side=this.spec.side||0}map(e,t,n,i){let{pos:r,deleted:o}=e.mapResult(t.from+i,this.side<0?-1:1);return o?null:new vF(r-n,r-n,this)}valid(){return!0}eq(e){return this==e||e instanceof mF&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&fF(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class gF{constructor(e,t){this.attrs=e,this.spec=t||xF}map(e,t,n,i){let r=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-n,o=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-n;return r>=o?null:new vF(r,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof gF&&fF(this.attrs,e.attrs)&&fF(this.spec,e.spec)}static is(e){return e.type instanceof gF}destroy(){}}class yF{constructor(e,t){this.attrs=e,this.spec=t||xF}map(e,t,n,i){let r=e.mapResult(t.from+i,1);if(r.deleted)return null;let o=e.mapResult(t.to+i,-1);return o.deleted||o.pos<=r.pos?null:new vF(r.pos-n,o.pos-n,this)}valid(e,t){let n,{index:i,offset:r}=e.content.findIndex(t.from);return r==t.from&&!(n=e.child(i)).isText&&r+n.nodeSize==t.to}eq(e){return this==e||e instanceof yF&&fF(this.attrs,e.attrs)&&fF(this.spec,e.spec)}destroy(){}}class vF{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new vF(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new vF(e,e,new mF(t,n))}static inline(e,t,n,i){return new vF(e,t,new gF(n,i))}static node(e,t,n,i){return new vF(e,t,new yF(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof gF}get widget(){return this.type instanceof mF}}const bF=[],xF={};class _F{constructor(e,t){this.local=e.length?e:bF,this.children=t.length?t:bF}static create(e,t){return t.length?CF(t,e,0,xF):wF}find(e,t,n){let i=[];return this.findInner(null==e?0:e,null==t?1e9:t,i,0,n),i}findInner(e,t,n,i,r){for(let o=0;o<this.local.length;o++){let s=this.local[o];s.from<=t&&s.to>=e&&(!r||r(s.spec))&&n.push(s.copy(s.from+i,s.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let s=this.children[o]+1;this.children[o+2].findInner(e-s,t-s,n,i+s,r)}}map(e,t,n){return this==wF||0==e.maps.length?this:this.mapInner(e,t,0,0,n||xF)}mapInner(e,t,n,i,r){let o;for(let s=0;s<this.local.length;s++){let a=this.local[s].map(e,n,i);a&&a.type.valid(t,a)?(o||(o=[])).push(a):r.onRemove&&r.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,i,r,o,s){let a=e.slice();for(let c=0,u=o;c<n.maps.length;c++){let e=0;n.maps[c].forEach(((t,n,i,o)=>{let s=o-i-(n-t);for(let l=0;l<a.length;l+=3){let o=a[l+1];if(o<0||t>o+u-e)continue;let c=a[l]+u-e;n>=c?a[l+1]=t<=c?-2:-1:i>=r&&s&&(a[l]+=s,a[l+1]+=s)}e+=s})),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let t=n.map(e[c]+o),u=t-r;if(u<0||u>=i.content.size){l=!0;continue}let d=n.map(e[c+1]+o,-1)-r,{index:h,offset:p}=i.content.findIndex(u),f=i.maybeChild(h);if(f&&p==u&&p+f.nodeSize==d){let i=a[c+2].mapInner(n,f,t+1,e[c]+o+1,s);i!=wF?(a[c]=u,a[c+1]=d,a[c+2]=i):(a[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,i,r,o,s){function a(e,t){for(let o=0;o<e.local.length;o++){let a=e.local[o].map(i,r,t);a?n.push(a):s.onRemove&&s.onRemove(e.local[o].spec)}for(let n=0;n<e.children.length;n+=3)a(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+o+1);return n}(a,e,t,n,r,o,s),c=CF(l,i,0,s);t=c.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new _F(t.sort(MF),a)}(this.children,o||[],e,t,n,i,r):o?new _F(o.sort(MF),bF):wF}add(e,t){return t.length?this==wF?_F.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let i,r=0;e.forEach(((e,o)=>{let s,a=o+n;if(s=SF(t,e,a)){for(i||(i=this.children.slice());r<i.length&&i[r]<o;)r+=3;i[r]==o?i[r+2]=i[r+2].addInner(e,s,a+1):i.splice(r,0,o,o+e.nodeSize,CF(s,e,a+1,xF)),r+=3}}));let o=EF(r?TF(t):t,-n);for(let s=0;s<o.length;s++)o[s].type.valid(e,o[s])||o.splice(s--,1);return new _F(o.length?this.local.concat(o).sort(MF):this.local,i||this.children)}remove(e){return 0==e.length||this==wF?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,i=this.local;for(let r=0;r<n.length;r+=3){let i,o=n[r]+t,s=n[r+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>o&&t.to<s&&(e[n]=null,(i||(i=[])).push(t));if(!i)continue;n==this.children&&(n=this.children.slice());let a=n[r+2].removeInner(i,o+1);a!=wF?n[r+2]=a:(n.splice(r,3),r-=3)}if(i.length)for(let r,o=0;o<e.length;o++)if(r=e[o])for(let e=0;e<i.length;e++)i[e].eq(r,t)&&(i==this.local&&(i=this.local.slice()),i.splice(e--,1));return n==this.children&&i==this.local?this:i.length||n.length?new _F(i,n):wF}forChild(e,t){if(this==wF)return this;if(t.isLeaf)return _F.empty;let n,i;for(let s=0;s<this.children.length;s+=3)if(this.children[s]>=e){this.children[s]==e&&(n=this.children[s+2]);break}let r=e+1,o=r+t.content.size;for(let s=0;s<this.local.length;s++){let e=this.local[s];if(e.from<o&&e.to>r&&e.type instanceof gF){let t=Math.max(r,e.from)-r,n=Math.min(o,e.to)-r;t<n&&(i||(i=[])).push(e.copy(t,n))}}if(i){let e=new _F(i.sort(MF),bF);return n?new kF([e,n]):e}return n||wF}eq(e){if(this==e)return!0;if(!(e instanceof _F)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return IF(this.localsInner(e))}localsInner(e){if(this==wF)return bF;if(e.inlineContent||!this.local.some(gF.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof gF||t.push(this.local[n]);return t}}_F.empty=new _F([],[]),_F.removeOverlap=IF;const wF=_F.empty;class kF{constructor(e){this.members=e}map(e,t){const n=this.members.map((n=>n.map(e,t,xF)));return kF.from(n)}forChild(e,t){if(t.isLeaf)return _F.empty;let n=[];for(let i=0;i<this.members.length;i++){let r=this.members[i].forChild(e,t);r!=wF&&(r instanceof kF?n=n.concat(r.members):n.push(r))}return kF.from(n)}eq(e){if(!(e instanceof kF)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let i=0;i<this.members.length;i++){let r=this.members[i].localsInner(e);if(r.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<r.length;e++)t.push(r[e])}else t=r}return t?IF(n?t:t.sort(MF)):bF}static from(e){switch(e.length){case 0:return wF;case 1:return e[0];default:return new kF(e.every((e=>e instanceof _F))?e:e.reduce(((e,t)=>e.concat(t instanceof _F?t:t.members)),[]))}}}function EF(e,t){if(!t||!e.length)return e;let n=[];for(let i=0;i<e.length;i++){let r=e[i];n.push(new vF(r.from+t,r.to+t,r.type))}return n}function SF(e,t,n){if(t.isLeaf)return null;let i=n+t.nodeSize,r=null;for(let o,s=0;s<e.length;s++)(o=e[s])&&o.from>n&&o.to<i&&((r||(r=[])).push(o),e[s]=null);return r}function TF(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function CF(e,t,n,i){let r=[],o=!1;t.forEach(((t,s)=>{let a=SF(e,t,s+n);if(a){o=!0;let e=CF(a,t,n+s+1,i);e!=wF&&r.push(s,s+t.nodeSize,e)}}));let s=EF(o?TF(e):e,-n).sort(MF);for(let a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(i.onRemove&&i.onRemove(s[a].spec),s.splice(a--,1));return s.length||r.length?new _F(s,r):wF}function MF(e,t){return e.from-t.from||e.to-t.to}function IF(e){let t=e;for(let n=0;n<t.length-1;n++){let i=t[n];if(i.from!=i.to)for(let r=n+1;r<t.length;r++){let o=t[r];if(o.from!=i.from){o.from<i.to&&(t==e&&(t=e.slice()),t[n]=i.copy(i.from,o.from),AF(t,r,i.copy(o.from,i.to)));break}o.to!=i.to&&(t==e&&(t=e.slice()),t[r]=o.copy(o.from,i.to),AF(t,r+1,o.copy(i.to,o.to)))}}return t}function AF(e,t,n){for(;t<e.length&&MF(n,e[t])>0;)t++;e.splice(t,0,n)}function PF(e){let t=[];return e.someProp("decorations",(n=>{let i=n(e.state);i&&i!=wF&&t.push(i)})),e.cursorWrapper&&t.push(_F.create(e.state.doc,[e.cursorWrapper.deco])),kF.from(t)}const OF={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},DF=iB&&rB<=11;class RF{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class zF{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new RF,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver((e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);iB&&rB<=11&&e.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length))?this.flushSoon():this.flush()})),DF&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((()=>{this.flushingSoon=-1,this.flush()}),20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,OF)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout((()=>this.flush()),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout((()=>this.suppressingSelectionUpdates=!1),50)}onSelectionChange(){if(gN(this.view)){if(this.suppressingSelectionUpdates)return lN(this.view);if(iB&&rB<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&qL(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let r=e.focusNode;r;r=jL(r))n.add(r);for(let r=e.anchorNode;r;r=jL(r))if(n.has(r)){t=r;break}let i=t&&this.view.docView.nearestDesc(t);return i&&i.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&gN(e)&&!this.ignoreSelectionChange(n),r=-1,o=-1,s=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],a);e&&(r=r<0?e.from:Math.min(e.from,r),o=o<0?e.to:Math.max(e.to,o),e.typeOver&&(s=!0))}if(oB&&a.length>1){let e=a.filter((e=>"BR"==e.nodeName));if(2==e.length){let t=e[0],n=e[1];t.parentNode&&t.parentNode.parentNode==n.parentNode?n.remove():t.remove()}}let l=null;r<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&XL(n)&&(l=sN(e))&&l.eq(yL.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,lN(e),this.currentSelection.set(n),e.scrollToSelection()):(r>-1||i)&&(r>-1&&(e.docView.markDirty(r,o),function(e){if(!LF.has(e)&&(LF.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))){if(e.requiresGeckoHackNode=oB,BF)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),BF=!0}}(e)),this.handleDOMChange(r,o,s,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||lN(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++)t.push(e.addedNodes[n]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,r=e.nextSibling;if(iB&&rB<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:o}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(i=n),(!o||Array.prototype.indexOf.call(e.addedNodes,o)<0)&&(r=o)}let o=i&&i.parentNode==e.target?$L(i)+1:0,s=n.localPosFromDOM(e.target,o,-1),a=r&&r.parentNode==e.target?$L(r):e.target.childNodes.length;return{from:s,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let LF=new WeakMap,BF=!1;function NF(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(cB&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||cB&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const FF=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function $F(e,t,n,i,r){let o=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=sN(e,t);if(n&&!e.state.selection.eq(n)){if(aB&&pB&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",(t=>t(e,KL(13,"Enter")))))return;let i=e.state.tr.setSelection(n);"pointer"==t?i.setMeta("pointer",!0):"key"==t&&i.scrollIntoView(),o&&i.setMeta("composition",o),e.dispatch(i)}return}let s=e.state.doc.resolve(t),a=s.sharedDepth(n);t=s.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l,c,u=e.state.selection,d=function(e,t,n){let i,{node:r,fromOffset:o,toOffset:s,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),u=c.anchorNode;if(u&&e.dom.contains(1==u.nodeType?u:u.parentNode)&&(i=[{node:u,offset:c.anchorOffset}],XL(c)||i.push({node:c.focusNode,offset:c.focusOffset})),aB&&8===e.input.lastKeyCode)for(let g=s;g>o;g--){let e=r.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){s=g;break}if(!t||t.size)break}let d=e.state.doc,h=e.someProp("domParser")||mz.fromSchema(e.state.schema),p=d.resolve(a),f=null,m=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:o,to:s,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:i,ruleFromNode:NF,context:p});if(i&&null!=i[0].pos){let e=i[0].pos,t=i[1]&&i[1].pos;null==t&&(t=e),f={anchor:e+a,head:t+a}}return{doc:m,sel:f,from:a,to:l}}(e,t,n),h=e.state.doc,p=h.slice(d.from,d.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let f=function(e,t,n,i,r){let o=e.findDiffStart(t,n);if(null==o)return null;let{a:s,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);return"end"==r&&(i-=s+Math.max(0,o-Math.min(s,a))-o),s<o&&e.size<t.size?(o-=i<=o&&i>=s?o-i:0,a=o+(a-s),s=o):a<o&&(o-=i<=o&&i>=a?o-i:0,s=o+(s-a),a=o),{start:o,endA:s,endB:a}}(p.content,d.doc.content,d.from,l,c);if((uB&&e.input.lastIOSEnter>Date.now()-225||pB)&&r.some((e=>1==e.nodeType&&!FF.test(e.nodeName)))&&(!f||f.endA>=f.endB)&&e.someProp("handleKeyDown",(t=>t(e,KL(13,"Enter")))))return void(e.input.lastIOSEnter=0);if(!f){if(!(i&&u instanceof _L&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||d.sel&&d.sel.anchor!=d.sel.head){if(d.sel){let t=jF(e,e.state.doc,d.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);o&&n.setMeta("composition",o),e.dispatch(n)}}return}f={start:u.from,endA:u.to,endB:u.to}}if(aB&&e.cursorWrapper&&d.sel&&d.sel.anchor==e.cursorWrapper.deco.from&&d.sel.head==d.sel.anchor){let e=f.endB-f.start;d.sel={anchor:d.sel.anchor+e,head:d.sel.anchor+e}}e.input.domChangeCount++,e.state.selection.from<e.state.selection.to&&f.start==f.endB&&e.state.selection instanceof _L&&(f.start>e.state.selection.from&&f.start<=e.state.selection.from+2&&e.state.selection.from>=d.from?f.start=e.state.selection.from:f.endA<e.state.selection.to&&f.endA>=e.state.selection.to-2&&e.state.selection.to<=d.to&&(f.endB+=e.state.selection.to-f.endA,f.endA=e.state.selection.to)),iB&&rB<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>d.from&&"  "==d.doc.textBetween(f.start-d.from-1,f.start-d.from+1)&&(f.start--,f.endA--,f.endB--);let m,g=d.doc.resolveNoCache(f.start-d.from),y=d.doc.resolveNoCache(f.endB-d.from),v=h.resolve(f.start),b=g.sameParent(y)&&g.parent.inlineContent&&v.end()>=f.endA;if((uB&&e.input.lastIOSEnter>Date.now()-225&&(!b||r.some((e=>"DIV"==e.nodeName||"P"==e.nodeName)))||!b&&g.pos<d.doc.content.size&&!g.sameParent(y)&&(m=yL.findFrom(d.doc.resolve(g.pos+1),1,!0))&&m.head==y.pos)&&e.someProp("handleKeyDown",(t=>t(e,KL(13,"Enter")))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>f.start&&function(e,t,n,i,r){if(!i.parent.isTextblock||n-t<=r.pos-i.pos||VF(i,!0,!1)<r.pos)return!1;let o=e.resolve(t);if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=e.resolve(VF(o,!0,!0));return!(!s.parent.isTextblock||s.pos>n||VF(s,!0,!1)<n)&&i.parent.content.cut(i.parentOffset).eq(s.parent.content)}(h,f.start,f.endA,g,y)&&e.someProp("handleKeyDown",(t=>t(e,KL(8,"Backspace")))))return void(pB&&aB&&e.domObserver.suppressSelectionUpdates());aB&&pB&&f.endB==f.start&&(e.input.lastAndroidDelete=Date.now()),pB&&!b&&g.start()!=y.start()&&0==y.parentOffset&&g.depth==y.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==f.endA&&(f.endB-=2,y=d.doc.resolveNoCache(f.endB-d.from),setTimeout((()=>{e.someProp("handleKeyDown",(function(t){return t(e,KL(13,"Enter"))}))}),20));let x,_,w,k=f.start,E=f.endA;if(b)if(g.pos==y.pos)iB&&rB<=11&&0==g.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((()=>lN(e)),20)),x=e.state.tr.delete(k,E),_=h.resolve(f.start).marksAcross(h.resolve(f.endA));else if(f.endA==f.endB&&(w=function(e,t){let n,i,r,o=e.firstChild.marks,s=t.firstChild.marks,a=o,l=s;for(let u=0;u<s.length;u++)a=s[u].removeFromSet(a);for(let u=0;u<o.length;u++)l=o[u].removeFromSet(l);if(1==a.length&&0==l.length)i=a[0],n="add",r=e=>e.mark(i.addToSet(e.marks));else{if(0!=a.length||1!=l.length)return null;i=l[0],n="remove",r=e=>e.mark(i.removeFromSet(e.marks))}let c=[];for(let u=0;u<t.childCount;u++)c.push(r(t.child(u)));if(SR.from(c).eq(e))return{mark:i,type:n}}(g.parent.content.cut(g.parentOffset,y.parentOffset),v.parent.content.cut(v.parentOffset,f.endA-v.start()))))x=e.state.tr,"add"==w.type?x.addMark(k,E,w.mark):x.removeMark(k,E,w.mark);else if(g.parent.child(g.index()).isText&&g.index()==y.index()-(y.textOffset?0:1)){let t=g.parent.textBetween(g.parentOffset,y.parentOffset);if(e.someProp("handleTextInput",(n=>n(e,k,E,t))))return;x=e.state.tr.insertText(t,k,E)}if(x||(x=e.state.tr.replace(k,E,d.doc.slice(f.start-d.from,f.endB-d.from))),d.sel){let t=jF(e,x.doc,d.sel);t&&!(aB&&pB&&e.composing&&t.empty&&(f.start!=f.endB||e.input.lastAndroidDelete<Date.now()-100)&&(t.head==k||t.head==x.mapping.map(E)-1)||iB&&t.empty&&t.head==k)&&x.setSelection(t)}_&&x.ensureMarks(_),o&&x.setMeta("composition",o),e.dispatch(x.scrollIntoView())}function jF(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:mN(e,t.resolve(n.anchor),t.resolve(n.head))}function VF(e,t,n){let i=e.depth,r=t?e.end():e.pos;for(;i>0&&(t||e.indexAfter(i)==e.node(i).childCount);)i--,r++,t=!1;if(n){let t=e.node(i).maybeChild(e.indexAfter(i));for(;t&&!t.isLeaf;)t=t.firstChild,r++}return r}class UF{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new GN,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(ZF),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=WF(this),GF(this),this.nodeViews=HF(this),this.docView=qB(this.state.doc,qF(this),PF(this),this.dom,this),this.domObserver=new zF(this,((e,t,n,i)=>$F(this,e,t,n,i))),this.domObserver.start(),function(e){for(let t in VN){let n=VN[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!XN(e,t)||ZN(e,t)||!e.editable&&t.type in UN||n(e,t)},qN[t]?{passive:!0}:void 0)}cB&&e.dom.addEventListener("input",(()=>null)),HN(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&HN(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(ZF),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){let n=this.state,i=!1,r=!1;e.storedMarks&&this.composing&&(lF(this),r=!0),this.state=e;let o=n.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=HF(this);(function(e,t){let n=0,i=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let r in t)i++;return n!=i})(e,this.nodeViews)&&(this.nodeViews=e,i=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&HN(this),this.editable=WF(this),GF(this);let s=PF(this),a=qF(this),l=n.plugins==e.plugins||n.doc.eq(e.doc)?e.scrollToSelection>n.scrollToSelection?"to selection":"preserve":"reset",c=i||!this.docView.matchesNode(e.doc,a,s);!c&&e.selection.eq(n.selection)||(r=!0);let u="preserve"==l&&r&&null==this.dom.style.overflowAnchor&&function(e){let t,n,i=e.dom.getBoundingClientRect(),r=Math.max(0,i.top);for(let o=(i.left+i.right)/2,s=r+1;s<Math.min(innerHeight,i.bottom);s+=5){let i=e.root.elementFromPoint(o,s);if(!i||i==e.dom||!e.dom.contains(i))continue;let a=i.getBoundingClientRect();if(a.top>=r-20){t=i,n=a.top;break}}return{refDOM:t,refTop:n,stack:xB(e.dom)}}(this);if(r){this.domObserver.stop();let t=c&&(iB||aB)&&!this.composing&&!n.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(n.selection,e.selection);if(c){let n=aB?this.trackWrites=this.domSelectionRange().focusNode:null;!i&&this.docView.update(e.doc,a,s,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=qB(e.doc,a,s,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return qL(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?lN(this,t):(pN(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(n),"reset"==l?this.dom.scrollTop=0:"to selection"==l?this.scrollToSelection():u&&function({refDOM:e,refTop:t,stack:n}){let i=e?e.getBoundingClientRect().top:0;_B(n,0==i?0:i-t)}(u)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(this.someProp("handleScrollToSelection",(e=>e(this))));else if(this.state.selection instanceof kL){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&bB(this,t.getBoundingClientRect(),e)}else bB(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}someProp(e,t){let n,i=this._props&&this._props[e];if(null!=i&&(n=t?t(i):i))return n;for(let o=0;o<this.directPlugins.length;o++){let i=this.directPlugins[o].props[e];if(null!=i&&(n=t?t(i):i))return n}let r=this.state.plugins;if(r)for(let o=0;o<r.length;o++){let i=r[o].props[e];if(null!=i&&(n=t?t(i):i))return n}}hasFocus(){if(iB){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(wB)return e.focus(wB);let t=xB(e);e.focus(null==wB?{get preventScroll(){return wB={preventScroll:!0},!0}}:void 0),wB||(wB=!1,_B(t,0))}(this.dom),lN(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return TB(this,e)}coordsAtPos(e,t=1){return AB(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let i=this.docView.posFromDOM(e,t,n);if(null==i)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return NB(this,t||this.state,e)}pasteHTML(e,t){return dF(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return dF(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],PF(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){ZN(e,t)||!VN[t.type]||!e.editable&&t.type in UN||VN[t.type](e,t)}(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return cB&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom?function(e){let t;function n(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0]}e.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",n,!0);let i=t.startContainer,r=t.startOffset,o=t.endContainer,s=t.endOffset,a=e.domAtPos(e.state.selection.anchor);return qL(a.node,a.offset,o,s)&&([i,r,o,s]=[o,s,i,r]),{anchorNode:i,anchorOffset:r,focusNode:o,focusOffset:s}}(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function qF(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",(n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))})),t.translate||(t.translate="no"),[vF.node(0,e.state.doc.content.size,t)]}function GF(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:vF.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function WF(e){return!e.someProp("editable",(t=>!1===t(e.state)))}function HF(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function ZF(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}for(var XF={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},KF={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},JF="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),YF="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),QF=0;QF<10;QF++)XF[48+QF]=XF[96+QF]=String(QF);for(QF=1;QF<=24;QF++)XF[QF+111]="F"+QF;for(QF=65;QF<=90;QF++)XF[QF]=String.fromCharCode(QF+32),KF[QF]=String.fromCharCode(QF);for(var e$ in XF)KF.hasOwnProperty(e$)||(KF[e$]=XF[e$]);const t$="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function n$(e){let t,n,i,r,o=e.split(/-(?!$)/),s=o[o.length-1];"Space"==s&&(s=" ");for(let a=0;a<o.length-1;a++){let e=o[a];if(/^(cmd|meta|m)$/i.test(e))r=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))i=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);t$?r=!0:n=!0}}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),r&&(s="Meta-"+s),i&&(s="Shift-"+s),s}function i$(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function r$(e){let t=function(e){let t=Object.create(null);for(let n in e)t[n$(n)]=e[n];return t}(e);return function(e,n){let i,r=function(e){var t=!(JF&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||YF&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?KF:XF)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),o=t[i$(r,n)];if(o&&o(e.state,e.dispatch,e))return!0;if(1==r.length&&" "!=r){if(n.shiftKey){let i=t[i$(r,n,!1)];if(i&&i(e.state,e.dispatch,e))return!0}if((n.shiftKey||n.altKey||n.metaKey||r.charCodeAt(0)>127)&&(i=XF[n.keyCode])&&i!=r){let r=t[i$(i,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}function o$(e,t,n=!1){for(let i=e;i;i="start"==t?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&1!=i.childCount)return!1}return!1}function s$(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function a$(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function l$(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function c$(e,t,n){let i,r,o=t.nodeBefore,s=t.nodeAfter;if(o.type.spec.isolating||s.type.spec.isolating)return!1;if(function(e,t,n){let i=t.nodeBefore,r=t.nodeAfter,o=t.index();return!(!(i&&r&&i.type.compatibleContent(r.type))||(!i.content.size&&t.parent.canReplace(o-1,o)?(n&&n(e.tr.delete(t.pos-i.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(o,o+1)||!r.isTextblock&&!Yz(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,i.type,i.contentMatchAt(i.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;let a=t.parent.canReplace(t.index(),t.index()+1);if(a&&(i=(r=o.contentMatchAt(o.childCount)).findWrapping(s.type))&&r.matchType(i[0]||s.type).validEnd){if(n){let r=t.pos+s.nodeSize,a=SR.empty;for(let e=i.length-1;e>=0;e--)a=SR.from(i[e].create(null,a));a=SR.from(o.copy(a));let l=e.tr.step(new Gz(t.pos-1,r,t.pos,r,new PR(a,1,0),i.length,!0)),c=r+2*i.length;Yz(l.doc,c)&&l.join(c),n(l.scrollIntoView())}return!0}let l=yL.findFrom(t,1),c=l&&l.$from.blockRange(l.$to),u=c&&Zz(c);if(null!=u&&u>=t.depth)return n&&n(e.tr.lift(c,u).scrollIntoView()),!0;if(a&&o$(s,"start",!0)&&o$(o,"end")){let i=o,r=[];for(;r.push(i),!i.isTextblock;)i=i.lastChild;let a=s,l=1;for(;!a.isTextblock;a=a.firstChild)l++;if(i.canReplace(i.childCount,i.childCount,a.content)){if(n){let i=SR.empty;for(let e=r.length-1;e>=0;e--)i=SR.from(r[e].copy(i));n(e.tr.step(new Gz(t.pos-r.length,t.pos+s.nodeSize,t.pos+l,t.pos+s.nodeSize-l,new PR(i,r.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function u$(e){return function(t,n){let i=t.selection,r=e<0?i.$from:i.$to,o=r.depth;for(;r.node(o).isInline;){if(!o)return!1;o--}return!!r.node(o).isTextblock&&(n&&n(t.tr.setSelection(_L.create(t.doc,e<0?r.start(o):r.end(o)))),!0)}}const d$=u$(-1),h$=u$(1);function p$(e,t=null){return function(n,i){let r=!1;for(let o=0;o<n.selection.ranges.length&&!r;o++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[o];n.doc.nodesBetween(i,s,((i,o)=>{if(r)return!1;if(i.isTextblock&&!i.hasMarkup(e,t))if(i.type==e)r=!0;else{let t=n.doc.resolve(o),i=t.index();r=t.parent.canReplaceWith(i,i+1,e)}}))}if(!r)return!1;if(i){let r=n.tr;for(let i=0;i<n.selection.ranges.length;i++){let{$from:{pos:o},$to:{pos:s}}=n.selection.ranges[i];r.setBlockType(o,s,e,t)}i(r.scrollIntoView())}return!0}}function f$(e,t=null){return function(n,i){let{$from:r,$to:o}=n.selection,s=r.blockRange(o),a=!1,l=s;if(!s)return!1;if(s.depth>=2&&r.node(s.depth-1).type.compatibleContent(e)&&0==s.startIndex){if(0==r.index(s.depth-1))return!1;let e=n.doc.resolve(s.start-2);l=new HR(e,e,s.depth),s.endIndex<s.parent.childCount&&(s=new HR(r,n.doc.resolve(o.end(s.depth)),s.depth)),a=!0}let c=Xz(l,e,t,s);return!!c&&(i&&i(function(e,t,n,i,r){let o=SR.empty;for(let u=n.length-1;u>=0;u--)o=SR.from(n[u].type.create(n[u].attrs,o));e.step(new Gz(t.start-(i?2:0),t.end,t.start,t.end,new PR(o,0,0),n.length,!0));let s=0;for(let u=0;u<n.length;u++)n[u].type==r&&(s=u+1);let a=n.length-s,l=t.start+n.length-(i?2:0),c=t.parent;for(let u=t.startIndex,d=t.endIndex,h=!0;u<d;u++,h=!1)!h&&Jz(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return e}(n.tr,s,c,a,e).scrollIntoView()),!0)}}function m$(e){return function(t,n){let{$from:i,$to:r}=t.selection,o=i.blockRange(r,(t=>t.childCount>0&&t.firstChild.type==e));return!!o&&(!n||(i.node(o.depth-1).type==e?function(e,t,n,i){let r=e.tr,o=i.end,s=i.$to.end(i.depth);o<s&&(r.step(new Gz(o-1,s,o,s,new PR(SR.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new HR(r.doc.resolve(i.$from.pos),r.doc.resolve(s),i.depth));const a=Zz(i);if(null==a)return!1;r.lift(i,a);let l=r.mapping.map(o,-1)-1;return Yz(r.doc,l)&&r.join(l),t(r.scrollIntoView()),!0}(t,n,e,o):function(e,t,n){let i=e.tr,r=n.parent;for(let p=n.end,f=n.endIndex-1,m=n.startIndex;f>m;f--)p-=r.child(f).nodeSize,i.delete(p-1,p+1);let o=i.doc.resolve(n.start),s=o.nodeAfter;if(i.mapping.map(n.end)!=n.start+o.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==r.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?SR.empty:SR.from(r))))return!1;let d=o.pos,h=d+s.nodeSize;return i.step(new Gz(d-(a?1:0),h+(l?1:0),d+1,h-1,new PR((a?SR.empty:SR.from(r.copy(SR.empty))).append(l?SR.empty:SR.from(r.copy(SR.empty))),a?0:1,l?0:1),a?0:1)),t(i.scrollIntoView()),!0}(t,n,o)))}}function g$(e){const{state:t,transaction:n}=e;let{selection:i}=n,{doc:r}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return i},get doc(){return r},get tr(){return i=n.selection,r=n.doc,o=n.storedMarks,n}}}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class y${constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:i}=t,{tr:r}=n,o=this.buildProps(r);return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,(...e)=>{const n=t(...e)(o);return r.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(r),n}])))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:i,state:r}=this,{view:o}=i,s=[],a=!!e,l=e||r.tr,c={...Object.fromEntries(Object.entries(n).map((([e,n])=>[e,(...e)=>{const i=this.buildProps(l,t),r=n(...e)(i);return s.push(r),c}]))),run:()=>(a||!t||l.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(l),s.every((e=>!0===e)))};return c}createCan(e){const{rawCommands:t,state:n}=this,i=e||n.tr,r=this.buildProps(i,!1),o=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,(...e)=>t(...e)({...r,dispatch:void 0})])));return{...o,chain:()=>this.createChain(i,!1)}}buildProps(e,t=!0){const{rawCommands:n,editor:i,state:r}=this,{view:o}=i,s={tr:e,editor:i,view:o,state:g$({state:r,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map((([e,t])=>[e,(...e)=>t(...e)(s)])))}};return s}}class v${constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach((e=>e.apply(this,t))),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter((e=>e!==t)):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function b$(e,t,n){return void 0===e.config[t]&&e.parent?b$(e.parent,t,n):"function"==typeof e.config[t]?e.config[t].bind({...n,parent:e.parent?b$(e.parent,t,n):null}):e.config[t]}function x$(e){return{baseExtensions:e.filter((e=>"extension"===e.type)),nodeExtensions:e.filter((e=>"node"===e.type)),markExtensions:e.filter((e=>"mark"===e.type))}}function _$(e){const t=[],{nodeExtensions:n,markExtensions:i}=x$(e),r=[...n,...i],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach((e=>{const n=b$(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage});n&&n().forEach((e=>{e.types.forEach((n=>{Object.entries(e.attributes).forEach((([e,i])=>{t.push({type:n,name:e,attribute:{...o,...i}})}))}))}))})),r.forEach((e=>{const n={name:e.name,options:e.options,storage:e.storage},i=b$(e,"addAttributes",n);if(!i)return;const r=i();Object.entries(r).forEach((([n,i])=>{const r={...o,...i};"function"==typeof(null==r?void 0:r.default)&&(r.default=r.default()),(null==r?void 0:r.isRequired)&&void 0===(null==r?void 0:r.default)&&delete r.default,t.push({type:e.name,name:n,attribute:r})}))})),t}function w$(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function k$(...e){return e.filter((e=>!!e)).reduce(((e,t)=>{const n={...e};return Object.entries(t).forEach((([e,t])=>{if(n[e])if("class"===e){const i=t?t.split(" "):[],r=n[e]?n[e].split(" "):[],o=i.filter((e=>!r.includes(e)));n[e]=[...r,...o].join(" ")}else n[e]="style"===e?[n[e],t].join("; "):t;else n[e]=t})),n}),{})}function E$(e,t){return t.filter((e=>e.attribute.rendered)).map((t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]})).reduce(((e,t)=>k$(e,t)),{})}function S$(e){return"function"==typeof e}function T$(e,t=undefined,...n){return S$(e)?t?e.bind(t)(...n):e(...n):e}function C$(e,t){return e.style?e:{...e,getAttrs:n=>{const i=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===i)return!1;const r=t.reduce(((e,t)=>{const i=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!=typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null==i?e:{...e,[t.name]:i}}),{});return{...i,...r}}}}function M$(e){return Object.fromEntries(Object.entries(e).filter((([e,t])=>("attrs"!==e||!function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t)))}function I$(e,t){return t.nodes[e]||t.marks[e]||null}function A$(e,t){return Array.isArray(t)?t.some((t=>("string"==typeof t?t:t.name)===e.name)):t}const P$=(e,t=500)=>{let n="";const i=e.parentOffset;return e.parent.nodesBetween(Math.max(0,i-t),i,((e,t,r,o)=>{var s,a;const l=(null===(a=(s=e.type.spec).toText)||void 0===a?void 0:a.call(s,{node:e,pos:t,parent:r,index:o}))||e.textContent||"%leaf%";n+=l.slice(0,Math.max(0,i-t))})),n};function O$(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class D${constructor(e){this.find=e.find,this.handler=e.handler}}const R$=(e,t)=>{if(O$(t))return t.exec(e);const n=t(e);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=e,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i};function z$(e){var t;const{editor:n,from:i,to:r,text:o,rules:s,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(i);if(c.parent.type.spec.code||(null===(t=c.nodeBefore||c.nodeAfter)||void 0===t?void 0:t.marks.find((e=>e.type.spec.code))))return!1;let u=!1;const d=P$(c)+o;return s.forEach((e=>{if(u)return;const t=R$(d,e.find);if(!t)return;const s=l.state.tr,c=g$({state:l.state,transaction:s}),h={from:i-(t[0].length-o.length),to:r},{commands:p,chain:f,can:m}=new y$({editor:n,state:c});null!==e.handler({state:c,range:h,match:t,commands:p,chain:f,can:m})&&s.steps.length&&(s.setMeta(a,{transform:s,from:i,to:r,text:o}),l.dispatch(s),u=!0)})),u}function L$(e){const{editor:t,rules:n}=e,i=new LL({state:{init:()=>null,apply(e,t){const n=e.getMeta(i);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:(e,r,o,s)=>z$({editor:t,from:r,to:o,text:s,rules:n,plugin:i}),handleDOMEvents:{compositionend:e=>(setTimeout((()=>{const{$cursor:r}=e.state.selection;r&&z$({editor:t,from:r.pos,to:r.pos,text:"",rules:n,plugin:i})})),!1)},handleKeyDown(e,r){if("Enter"!==r.key)return!1;const{$cursor:o}=e.state.selection;return!!o&&z$({editor:t,from:o.pos,to:o.pos,text:"\n",rules:n,plugin:i})}},isInputRules:!0});return i}class B${constructor(e){this.find=e.find,this.handler=e.handler}}const N$=(e,t)=>{if(O$(t))return[...e.matchAll(t)];const n=t(e);return n?n.map((t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n})):[]};function F$(e){const{editor:t,rules:n}=e;let i=null,r=!1,o=!1,s=new ClipboardEvent("paste"),a=new DragEvent("drop");const l=n.map((e=>new LL({view(e){const t=t=>{var n;i=(null===(n=e.dom.parentElement)||void 0===n?void 0:n.contains(t.target))?e.dom.parentElement:null};return window.addEventListener("dragstart",t),{destroy(){window.removeEventListener("dragstart",t)}}},props:{handleDOMEvents:{drop:(e,t)=>(o=i===e.dom.parentElement,a=t,!1),paste:(e,t)=>{var n;const i=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");return s=t,r=!!(null==i?void 0:i.includes("data-pm-slice")),!1}}},appendTransaction:(n,i,l)=>{const c=n[0],u="paste"===c.getMeta("uiEvent")&&!r,d="drop"===c.getMeta("uiEvent")&&!o;if(!u&&!d)return;const h=i.doc.content.findDiffStart(l.doc.content),p=i.doc.content.findDiffEnd(l.doc.content);if("number"!=typeof h||!p||h===p.b)return;const f=l.tr,m=g$({state:l,transaction:f}),g=function(e){const{editor:t,state:n,from:i,to:r,rule:o,pasteEvent:s,dropEvent:a}=e,{commands:l,chain:c,can:u}=new y$({editor:t,state:n}),d=[];return n.doc.nodesBetween(i,r,((e,t)=>{if(!e.isTextblock||e.type.spec.code)return;const h=Math.max(i,t),p=Math.min(r,t+e.content.size),f=e.textBetween(h-t,p-t,void 0,"￼");N$(f,o.find).forEach((e=>{if(void 0===e.index)return;const t=h+e.index+1,i=t+e[0].length,r={from:n.tr.mapping.map(t),to:n.tr.mapping.map(i)},p=o.handler({state:n,range:r,match:e,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(p)}))})),d.every((e=>null!==e))}({editor:t,state:m,from:Math.max(h-1,0),to:p.b-1,rule:e,pasteEvent:s,dropEvent:a});return g&&f.steps.length?(a=new DragEvent("drop"),s=new ClipboardEvent("paste"),f):void 0}})));return l}class $${constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=$$.resolve(e),this.schema=function(e,t){var n;const i=_$(e),{nodeExtensions:r,markExtensions:o}=x$(e),s=null===(n=r.find((e=>b$(e,"topNode"))))||void 0===n?void 0:n.name,a=Object.fromEntries(r.map((n=>{const r=i.filter((e=>e.type===n.name)),o={name:n.name,options:n.options,storage:n.storage,editor:t},s=e.reduce(((e,t)=>{const i=b$(t,"extendNodeSchema",o);return{...e,...i?i(n):{}}}),{}),a=M$({...s,content:T$(b$(n,"content",o)),marks:T$(b$(n,"marks",o)),group:T$(b$(n,"group",o)),inline:T$(b$(n,"inline",o)),atom:T$(b$(n,"atom",o)),selectable:T$(b$(n,"selectable",o)),draggable:T$(b$(n,"draggable",o)),code:T$(b$(n,"code",o)),defining:T$(b$(n,"defining",o)),isolating:T$(b$(n,"isolating",o)),attrs:Object.fromEntries(r.map((e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]})))}),l=T$(b$(n,"parseHTML",o));l&&(a.parseDOM=l.map((e=>C$(e,r))));const c=b$(n,"renderHTML",o);c&&(a.toDOM=e=>c({node:e,HTMLAttributes:E$(e,r)}));const u=b$(n,"renderText",o);return u&&(a.toText=u),[n.name,a]}))),l=Object.fromEntries(o.map((n=>{const r=i.filter((e=>e.type===n.name)),o={name:n.name,options:n.options,storage:n.storage,editor:t},s=e.reduce(((e,t)=>{const i=b$(t,"extendMarkSchema",o);return{...e,...i?i(n):{}}}),{}),a=M$({...s,inclusive:T$(b$(n,"inclusive",o)),excludes:T$(b$(n,"excludes",o)),group:T$(b$(n,"group",o)),spanning:T$(b$(n,"spanning",o)),code:T$(b$(n,"code",o)),attrs:Object.fromEntries(r.map((e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]})))}),l=T$(b$(n,"parseHTML",o));l&&(a.parseDOM=l.map((e=>C$(e,r))));const c=b$(n,"renderHTML",o);return c&&(a.toDOM=e=>c({mark:e,HTMLAttributes:E$(e,r)})),[n.name,a]})));return new pz({topNode:s,nodes:a,marks:l})}(this.extensions,t),this.extensions.forEach((e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:I$(e.name,this.schema)};"mark"===e.type&&(null===(t=T$(b$(e,"keepOnSplit",n)))||void 0===t||t)&&this.splittableMarks.push(e.name);const i=b$(e,"onBeforeCreate",n);i&&this.editor.on("beforeCreate",i);const r=b$(e,"onCreate",n);r&&this.editor.on("create",r);const o=b$(e,"onUpdate",n);o&&this.editor.on("update",o);const s=b$(e,"onSelectionUpdate",n);s&&this.editor.on("selectionUpdate",s);const a=b$(e,"onTransaction",n);a&&this.editor.on("transaction",a);const l=b$(e,"onFocus",n);l&&this.editor.on("focus",l);const c=b$(e,"onBlur",n);c&&this.editor.on("blur",c);const u=b$(e,"onDestroy",n);u&&this.editor.on("destroy",u)}))}static resolve(e){const t=$$.sort($$.flatten(e)),n=function(e){const t=e.filter(((t,n)=>e.indexOf(t)!==n));return[...new Set(t)]}(t.map((e=>e.name)));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map((e=>`'${e}'`)).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map((e=>{const t=b$(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...this.flatten(t())]:e})).flat(10)}static sort(e){return e.sort(((e,t)=>{const n=b$(e,"priority")||100,i=b$(t,"priority")||100;return n>i?-1:n<i?1:0}))}get commands(){return this.extensions.reduce(((e,t)=>{const n=b$(t,"addCommands",{name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:I$(t.name,this.schema)});return n?{...e,...n()}:e}),{})}get plugins(){const{editor:e}=this,t=$$.sort([...this.extensions].reverse()),n=[],i=[],r=t.map((t=>{const r={name:t.name,options:t.options,storage:t.storage,editor:e,type:I$(t.name,this.schema)},o=[],s=b$(t,"addKeyboardShortcuts",r);let a={};if("mark"===t.type&&t.config.exitable&&(a.ArrowRight=()=>Pj.handleExit({editor:e,mark:t})),s){const t=Object.fromEntries(Object.entries(s()).map((([t,n])=>[t,()=>n({editor:e})])));a={...a,...t}}const l=new LL({props:{handleKeyDown:r$(a)}});o.push(l);const c=b$(t,"addInputRules",r);A$(t,e.options.enableInputRules)&&c&&n.push(...c());const u=b$(t,"addPasteRules",r);A$(t,e.options.enablePasteRules)&&u&&i.push(...u());const d=b$(t,"addProseMirrorPlugins",r);if(d){const e=d();o.push(...e)}return o})).flat();return[L$({editor:e,rules:n}),...F$({editor:e,rules:i}),...r]}get attributes(){return _$(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=x$(this.extensions);return Object.fromEntries(t.filter((e=>!!b$(e,"addNodeView"))).map((t=>{const n=this.attributes.filter((e=>e.type===t.name)),i={name:t.name,options:t.options,storage:t.storage,editor:e,type:w$(t.name,this.schema)},r=b$(t,"addNodeView",i);return r?[t.name,(i,o,s,a)=>{const l=E$(i,n);return r()({editor:e,node:i,getPos:s,decorations:a,HTMLAttributes:l,extension:t})}]:[]})))}}function j$(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function V$(e,t){const n={...e};return j$(e)&&j$(t)&&Object.keys(t).forEach((i=>{j$(t[i])?i in e?n[i]=V$(e[i],t[i]):Object.assign(n,{[i]:t[i]}):Object.assign(n,{[i]:t[i]})})),n}class U${constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=T$(b$(this,"addOptions",{name:this.name}))),this.storage=T$(b$(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new U$(e)}configure(e={}){const t=this.extend();return t.options=V$(this.options,e),t.storage=T$(b$(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new U$(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=T$(b$(t,"addOptions",{name:t.name})),t.storage=T$(b$(t,"addStorage",{name:t.name,options:t.options})),t}}function q$(e,t,n){const{from:i,to:r}=t,{blockSeparator:o="\n\n",textSerializers:s={}}=n||{};let a="",l=!0;return e.nodesBetween(i,r,((e,n,c,u)=>{var d;const h=null==s?void 0:s[e.type.name];h?(e.isBlock&&!l&&(a+=o,l=!0),c&&(a+=h({node:e,pos:n,parent:c,index:u,range:t}))):e.isText?(a+=null===(d=null==e?void 0:e.text)||void 0===d?void 0:d.slice(Math.max(i,n)-n,r-n),l=!1):e.isBlock&&!l&&(a+=o,l=!0)})),a}function G$(e){return Object.fromEntries(Object.entries(e.nodes).filter((([,e])=>e.spec.toText)).map((([e,t])=>[e,t.spec.toText])))}const W$=U$.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new LL({key:new FL("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:i,selection:r}=t,{ranges:o}=r,s=Math.min(...o.map((e=>e.$from.pos))),a=Math.max(...o.map((e=>e.$to.pos)));return q$(i,{from:s,to:a},{textSerializers:G$(n)})}}})]}});function H$(e,t,n={strict:!0}){const i=Object.keys(t);return!i.length||i.every((i=>n.strict?t[i]===e[i]:O$(t[i])?t[i].test(e[i]):t[i]===e[i]))}function Z$(e,t,n={}){return e.find((e=>e.type===t&&H$(e.attrs,n)))}function X$(e,t,n={}){return!!Z$(e,t,n)}function K$(e,t,n={}){if(!e||!t)return;let i=e.parent.childAfter(e.parentOffset);if(e.parentOffset===i.offset&&0!==i.offset&&(i=e.parent.childBefore(e.parentOffset)),!i.node)return;const r=Z$([...i.node.marks],t,n);if(!r)return;let o=i.index,s=e.start()+i.offset,a=o+1,l=s+i.node.nodeSize;for(Z$([...i.node.marks],t,n);o>0&&r.isInSet(e.parent.child(o-1).marks);)o-=1,s-=e.parent.child(o).nodeSize;for(;a<e.parent.childCount&&X$([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:s,to:l}}function J$(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function Y$(e){return e instanceof _L}function Q$(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function ej(e,t=null){if(!t)return null;const n=yL.atStart(e),i=yL.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return i;const r=n.from,o=i.to;return"all"===t?_L.create(e,Q$(0,r,o),Q$(e.content.size,r,o)):_L.create(e,Q$(t,r,o),Q$(t,r,o))}function tj(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function nj(e){const t=`<body>${e}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function ij(e,t,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof e&&null!==e)try{return Array.isArray(e)&&e.length>0?SR.fromArray(e.map((e=>t.nodeFromJSON(e)))):t.nodeFromJSON(e)}catch(i){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",i),ij("",t,n)}if("string"==typeof e){const i=mz.fromSchema(t);return n.slice?i.parseSlice(nj(e),n.parseOptions).content:i.parse(nj(e),n.parseOptions)}return ij("",t,n)}function rj(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function oj(e,t,n={}){const{from:i,to:r,empty:o}=e.selection,s=t?w$(t,e.schema):null,a=[];e.doc.nodesBetween(i,r,((e,t)=>{if(e.isText)return;const n=Math.max(i,t),o=Math.min(r,t+e.nodeSize);a.push({node:e,from:n,to:o})}));const l=r-i,c=a.filter((e=>!s||s.name===e.node.type.name)).filter((e=>H$(e.node.attrs,n,{strict:!1})));return o?!!c.length:c.reduce(((e,t)=>e+t.to-t.from),0)>=l}function sj(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function aj(e,t){const n="string"==typeof t?[t]:t;return Object.keys(e).reduce(((t,i)=>(n.includes(i)||(t[i]=e[i]),t)),{})}function lj(e,t,n={}){return ij(e,t,{slice:!1,parseOptions:n})}function cj(e,t){const n=J$(t,e.schema),{from:i,to:r,empty:o}=e.selection,s=[];o?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(i,r,(e=>{s.push(...e.marks)}));const a=s.find((e=>e.type.name===n.name));return a?{...a.attrs}:{}}function uj(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const i=e.node(n);if(t(i))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:i}}}(t.$from,e)}function dj(e,t){const n=sj("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=w$(t,e.schema),{from:i,to:r}=e.selection,o=[];e.doc.nodesBetween(i,r,(e=>{o.push(e)}));const s=o.reverse().find((e=>e.type.name===n.name));return s?{...s.attrs}:{}}(e,t):"mark"===n?cj(e,t):{}}function hj(e,t,n){const i=[];return e===t?n.resolve(e).marks().forEach((t=>{const r=K$(n.resolve(e-1),t.type);r&&i.push({mark:t,...r})})):n.nodesBetween(e,t,((e,t)=>{i.push(...e.marks.map((n=>({from:t,to:t+e.nodeSize,mark:n}))))})),i}function pj(e,t,n){return Object.fromEntries(Object.entries(n).filter((([n])=>{const i=e.find((e=>e.type===t&&e.name===n));return!!i&&i.attribute.keepOnSplit})))}function fj(e,t,n={}){const{empty:i,ranges:r}=e.selection,o=t?J$(t,e.schema):null;if(i)return!!(e.storedMarks||e.selection.$from.marks()).filter((e=>!o||o.name===e.type.name)).find((e=>H$(e.attrs,n,{strict:!1})));let s=0;const a=[];if(r.forEach((({$from:t,$to:n})=>{const i=t.pos,r=n.pos;e.doc.nodesBetween(i,r,((e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(i,t),o=Math.min(r,t+e.nodeSize);s+=o-n,a.push(...e.marks.map((e=>({mark:e,from:n,to:o}))))}))})),0===s)return!1;const l=a.filter((e=>!o||o.name===e.mark.type.name)).filter((e=>H$(e.mark.attrs,n,{strict:!1}))).reduce(((e,t)=>e+t.to-t.from),0),c=a.filter((e=>!o||e.mark.type!==o&&e.mark.type.excludes(o))).reduce(((e,t)=>e+t.to-t.from),0);return(l>0?l+c:l)>=s}function mj(e,t){const{nodeExtensions:n}=x$(t),i=n.find((t=>t.name===e));if(!i)return!1;const r=T$(b$(i,"group",{name:i.name,options:i.options,storage:i.storage}));return"string"==typeof r&&r.split(" ").includes("list")}function gj(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const i=n.filter((e=>null==t?void 0:t.includes(e.type.name)));e.tr.ensureMarks(i)}}const yj=(e,t)=>{const n=uj((e=>e.type===t))(e.selection);if(!n)return!0;const i=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===i)return!0;const r=e.doc.nodeAt(i);return n.node.type!==(null==r?void 0:r.type)||!Yz(e.doc,n.pos)||(e.join(n.pos),!0)},vj=(e,t)=>{const n=uj((e=>e.type===t))(e.selection);if(!n)return!0;const i=e.doc.resolve(n.start).after(n.depth);if(void 0===i)return!0;const r=e.doc.nodeAt(i);return n.node.type!==(null==r?void 0:r.type)||!Yz(e.doc,i)||(e.join(i),!0)};var bj=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame((()=>{var n;e.isDestroyed||(t.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())})),!0),clearContent:(e=!1)=>({commands:t})=>t.setContent("",e),clearNodes:()=>({state:e,tr:t,dispatch:n})=>{const{selection:i}=t,{ranges:r}=i;return!n||(r.forEach((({$from:n,$to:i})=>{e.doc.nodesBetween(n.pos,i.pos,((e,n)=>{if(e.type.isText)return;const{doc:i,mapping:r}=t,o=i.resolve(r.map(n)),s=i.resolve(r.map(n+e.nodeSize)),a=o.blockRange(s);if(!a)return;const l=Zz(a);if(e.type.isTextblock){const{defaultType:e}=o.parent.contentMatchAt(o.index());t.setNodeMarkup(a.start,e)}(l||0===l)&&t.lift(a,l)}))})),!0)},command:e=>t=>e(t),createParagraphNear:()=>({state:e,dispatch:t})=>((e,t)=>{let n=e.selection,{$from:i,$to:r}=n;if(n instanceof SL||i.parent.inlineContent||r.parent.inlineContent)return!1;let o=l$(r.parent.contentMatchAt(r.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let n=(!i.parentOffset&&r.index()<r.parent.childCount?i:r).pos,s=e.tr.insert(n,o.createAndFill());s.setSelection(_L.create(s.doc,n+1)),t(s.scrollIntoView())}return!0})(e,t),cut:(e,t)=>({editor:n,tr:i})=>{const{state:r}=n,o=r.doc.slice(e.from,e.to);i.deleteRange(e.from,e.to);const s=i.mapping.map(t);return i.insert(s,o.content),i.setSelection(new _L(i.doc.resolve(s-1))),!0},deleteCurrentNode:()=>({tr:e,dispatch:t})=>{const{selection:n}=e,i=n.$anchor.node();if(i.content.size>0)return!1;const r=e.selection.$anchor;for(let o=r.depth;o>0;o-=1)if(r.node(o).type===i.type){if(t){const t=r.before(o),n=r.after(o);e.delete(t,n).scrollIntoView()}return!0}return!1},deleteNode:e=>({tr:t,state:n,dispatch:i})=>{const r=w$(e,n.schema),o=t.selection.$anchor;for(let e=o.depth;e>0;e-=1)if(o.node(e).type===r){if(i){const n=o.before(e),i=o.after(e);t.delete(n,i).scrollIntoView()}return!0}return!1},deleteRange:e=>({tr:t,dispatch:n})=>{const{from:i,to:r}=e;return n&&t.delete(i,r),!0},deleteSelection:()=>({state:e,dispatch:t})=>((e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0))(e,t),enter:()=>({commands:e})=>e.keyboardShortcut("Enter"),exitCode:()=>({state:e,dispatch:t})=>((e,t)=>{let{$head:n,$anchor:i}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let r=n.node(-1),o=n.indexAfter(-1),s=l$(r.contentMatchAt(o));if(!s||!r.canReplaceWith(o,o,s))return!1;if(t){let i=n.after(),r=e.tr.replaceWith(i,i,s.createAndFill());r.setSelection(yL.near(r.doc.resolve(i),1)),t(r.scrollIntoView())}return!0})(e,t),extendMarkRange:(e,t={})=>({tr:n,state:i,dispatch:r})=>{const o=J$(e,i.schema),{doc:s,selection:a}=n,{$from:l,from:c,to:u}=a;if(r){const e=K$(l,o,t);if(e&&e.from<=c&&e.to>=u){const t=_L.create(s,e.from,e.to);n.setSelection(t)}}return!0},first:e=>t=>{const n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:(e=null,t={})=>({editor:n,view:i,tr:r,dispatch:o})=>{t={scrollIntoView:!0,...t};const s=()=>{tj()&&i.dom.focus(),requestAnimationFrame((()=>{n.isDestroyed||(i.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())}))};if(i.hasFocus()&&null===e||!1===e)return!0;if(o&&null===e&&!Y$(n.state.selection))return s(),!0;const a=ej(r.doc,e)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||r.setSelection(a),l&&r.storedMarks&&r.setStoredMarks(r.storedMarks),s()),!0},forEach:(e,t)=>n=>e.every(((e,i)=>t(e,{...n,index:i}))),insertContent:(e,t)=>({tr:n,commands:i})=>i.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),insertContentAt:(e,t,n)=>({tr:i,dispatch:r,editor:o})=>{if(r){n={parseOptions:{},updateSelection:!0,...n};const r=ij(t,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if("<>"===r.toString())return!0;let{from:s,to:a}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},l=!0,c=!0;if((r.toString().startsWith("<")?r:[r]).forEach((e=>{e.check(),l=!!l&&e.isText&&0===e.marks.length,c=!!c&&e.isBlock})),s===a&&c){const{parent:e}=i.doc.resolve(s);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(s-=1,a+=1)}l?Array.isArray(t)?i.insertText(t.map((e=>e.text||"")).join(""),s,a):"object"==typeof t&&t&&t.text?i.insertText(t.text,s,a):i.insertText(t,s,a):i.replaceWith(s,a,r),n.updateSelection&&function(e,t,n){const i=e.steps.length-1;if(i<t)return;const r=e.steps[i];if(!(r instanceof qz||r instanceof Gz))return;const o=e.mapping.maps[i];let s=0;o.forEach(((e,t,n,i)=>{0===s&&(s=i)})),e.setSelection(yL.near(e.doc.resolve(s),n))}(i,i.steps.length-1,-1)}return!0},joinUp:()=>({state:e,dispatch:t})=>((e,t)=>{let n,i=e.selection,r=i instanceof kL;if(r){if(i.node.isTextblock||!Yz(e.doc,i.from))return!1;n=i.from}else if(n=eL(e.doc,i.from,-1),null==n)return!1;if(t){let i=e.tr.join(n);r&&i.setSelection(kL.create(i.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(i.scrollIntoView())}return!0})(e,t),joinDown:()=>({state:e,dispatch:t})=>((e,t)=>{let n,i=e.selection;if(i instanceof kL){if(i.node.isTextblock||!Yz(e.doc,i.to))return!1;n=i.to}else if(n=eL(e.doc,i.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(e,t),joinBackward:()=>({state:e,dispatch:t})=>((e,t,n)=>{let i=function(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}(e,n);if(!i)return!1;let r=s$(i);if(!r){let n=i.blockRange(),r=n&&Zz(n);return null!=r&&(t&&t(e.tr.lift(n,r).scrollIntoView()),!0)}let o=r.nodeBefore;if(!o.type.spec.isolating&&c$(e,r,t))return!0;if(0==i.parent.content.size&&(o$(o,"end")||kL.isSelectable(o))){let n=nL(e.doc,i.before(),i.after(),PR.empty);if(n&&n.slice.size<n.to-n.from){if(t){let i=e.tr.step(n);i.setSelection(o$(o,"end")?yL.findFrom(i.doc.resolve(i.mapping.map(r.pos,-1)),-1):kL.create(i.doc,r.pos-o.nodeSize)),t(i.scrollIntoView())}return!0}}return!(!o.isAtom||r.depth!=i.depth-1||(t&&t(e.tr.delete(r.pos-o.nodeSize,r.pos).scrollIntoView()),0))})(e,t),joinForward:()=>({state:e,dispatch:t})=>((e,t,n)=>{let i=function(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}(e,n);if(!i)return!1;let r=a$(i);if(!r)return!1;let o=r.nodeAfter;if(c$(e,r,t))return!0;if(0==i.parent.content.size&&(o$(o,"start")||kL.isSelectable(o))){let n=nL(e.doc,i.before(),i.after(),PR.empty);if(n&&n.slice.size<n.to-n.from){if(t){let i=e.tr.step(n);i.setSelection(o$(o,"start")?yL.findFrom(i.doc.resolve(i.mapping.map(r.pos)),1):kL.create(i.doc,i.mapping.map(r.pos))),t(i.scrollIntoView())}return!0}}return!(!o.isAtom||r.depth!=i.depth-1||(t&&t(e.tr.delete(r.pos,r.pos+o.nodeSize).scrollIntoView()),0))})(e,t),joinItemBackward:()=>({tr:e,state:t,dispatch:n})=>{try{const i=eL(t.doc,t.selection.$from.pos,-1);return null!=i&&(e.join(i,2),n&&n(e),!0)}catch{return!1}},joinItemForward:()=>({state:e,dispatch:t,tr:n})=>{try{const i=eL(e.doc,e.selection.$from.pos,1);return null!=i&&(n.join(i,2),t&&t(n),!0)}catch(wT){return!1}},keyboardShortcut:e=>({editor:t,view:n,tr:i,dispatch:r})=>{const o=function(e){const t=e.split(/-(?!$)/);let n,i,r,o,s=t[t.length-1];"Space"===s&&(s=" ");for(let a=0;a<t.length-1;a+=1){const e=t[a];if(/^(cmd|meta|m)$/i.test(e))o=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))i=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error(`Unrecognized modifier name: ${e}`);tj()||rj()?o=!0:i=!0}}return n&&(s=`Alt-${s}`),i&&(s=`Ctrl-${s}`),o&&(s=`Meta-${s}`),r&&(s=`Shift-${s}`),s}(e).split(/-(?!$)/),s=o.find((e=>!["Alt","Ctrl","Meta","Shift"].includes(e))),a=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction((()=>{n.someProp("handleKeyDown",(e=>e(n,a)))}));return null==l||l.steps.forEach((e=>{const t=e.map(i.mapping);t&&r&&i.maybeStep(t)})),!0},lift:(e,t={})=>({state:n,dispatch:i})=>!!oj(n,w$(e,n.schema),t)&&((e,t)=>{let{$from:n,$to:i}=e.selection,r=n.blockRange(i),o=r&&Zz(r);return null!=o&&(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)})(n,i),liftEmptyBlock:()=>({state:e,dispatch:t})=>((e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let i=n.before();if(Jz(e.doc,i))return t&&t(e.tr.split(i).scrollIntoView()),!0}let i=n.blockRange(),r=i&&Zz(i);return null!=r&&(t&&t(e.tr.lift(i,r).scrollIntoView()),!0)})(e,t),liftListItem:e=>({state:t,dispatch:n})=>m$(w$(e,t.schema))(t,n),newlineInCode:()=>({state:e,dispatch:t})=>((e,t)=>{let{$head:n,$anchor:i}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(i)||(t&&t(e.tr.insertText("\n").scrollIntoView()),0))})(e,t),resetAttributes:(e,t)=>({tr:n,state:i,dispatch:r})=>{let o=null,s=null;const a=sj("string"==typeof e?e:e.name,i.schema);return!!a&&("node"===a&&(o=w$(e,i.schema)),"mark"===a&&(s=J$(e,i.schema)),r&&n.selection.ranges.forEach((e=>{i.doc.nodesBetween(e.$from.pos,e.$to.pos,((e,i)=>{o&&o===e.type&&n.setNodeMarkup(i,void 0,aj(e.attrs,t)),s&&e.marks.length&&e.marks.forEach((r=>{s===r.type&&n.addMark(i,i+e.nodeSize,s.create(aj(r.attrs,t)))}))}))})),!0)},scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),selectAll:()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),selectNodeBackward:()=>({state:e,dispatch:t})=>((e,t,n)=>{let{$head:i,empty:r}=e.selection,o=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):i.parentOffset>0)return!1;o=s$(i)}let s=o&&o.nodeBefore;return!(!s||!kL.isSelectable(s)||(t&&t(e.tr.setSelection(kL.create(e.doc,o.pos-s.nodeSize)).scrollIntoView()),0))})(e,t),selectNodeForward:()=>({state:e,dispatch:t})=>((e,t,n)=>{let{$head:i,empty:r}=e.selection,o=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)return!1;o=a$(i)}let s=o&&o.nodeAfter;return!(!s||!kL.isSelectable(s)||(t&&t(e.tr.setSelection(kL.create(e.doc,o.pos)).scrollIntoView()),0))})(e,t),selectParentNode:()=>({state:e,dispatch:t})=>((e,t)=>{let n,{$from:i,to:r}=e.selection,o=i.sharedDepth(r);return 0!=o&&(n=i.before(o),t&&t(e.tr.setSelection(kL.create(e.doc,n))),!0)})(e,t),selectTextblockEnd:()=>({state:e,dispatch:t})=>h$(e,t),selectTextblockStart:()=>({state:e,dispatch:t})=>d$(e,t),setContent:(e,t=!1,n={})=>({tr:i,editor:r,dispatch:o})=>{const{doc:s}=i,a=lj(e,r.schema,n);return o&&i.replaceWith(0,s.content.size,a).setMeta("preventUpdate",!t),!0},setMark:(e,t={})=>({tr:n,state:i,dispatch:r})=>{const{selection:o}=n,{empty:s,ranges:a}=o,l=J$(e,i.schema);if(r)if(s){const e=cj(i,l);n.addStoredMark(l.create({...e,...t}))}else a.forEach((e=>{const r=e.$from.pos,o=e.$to.pos;i.doc.nodesBetween(r,o,((e,i)=>{const s=Math.max(i,r),a=Math.min(i+e.nodeSize,o);e.marks.find((e=>e.type===l))?e.marks.forEach((e=>{l===e.type&&n.addMark(s,a,l.create({...e.attrs,...t}))})):n.addMark(s,a,l.create(t))}))}));return function(e,t,n){var i;const{selection:r}=t;let o=null;if(Y$(r)&&(o=r.$cursor),o){const t=null!==(i=e.storedMarks)&&void 0!==i?i:o.marks();return!!n.isInSet(t)||!t.some((e=>e.type.excludes(n)))}const{ranges:s}=r;return s.some((({$from:t,$to:i})=>{let r=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,i.pos,((e,t,i)=>{if(r)return!1;if(e.isInline){const t=!i||i.type.allowsMarkType(n),o=!!n.isInSet(e.marks)||!e.marks.some((e=>e.type.excludes(n)));r=t&&o}return!r})),r}))}(i,n,l)},setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),setNode:(e,t={})=>({state:n,dispatch:i,chain:r})=>{const o=w$(e,n.schema);return o.isTextblock?r().command((({commands:e})=>!!p$(o,t)(n)||e.clearNodes())).command((({state:e})=>p$(o,t)(e,i))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,i=Q$(e,0,n.content.size),r=kL.create(n,i);t.setSelection(r)}return!0},setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,{from:i,to:r}="number"==typeof e?{from:e,to:e}:e,o=_L.atStart(n).from,s=_L.atEnd(n).to,a=Q$(i,o,s),l=Q$(r,o,s),c=_L.create(n,a,l);t.setSelection(c)}return!0},sinkListItem:e=>({state:t,dispatch:n})=>{const i=w$(e,t.schema);return(r=i,function(e,t){let{$from:n,$to:i}=e.selection,o=n.blockRange(i,(e=>e.childCount>0&&e.firstChild.type==r));if(!o)return!1;let s=o.startIndex;if(0==s)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=r)return!1;if(t){let n=l.lastChild&&l.lastChild.type==a.type,i=SR.from(n?r.create():null),s=new PR(SR.from(r.create(null,SR.from(a.type.create(null,i)))),n?3:1,0),c=o.start,u=o.end;t(e.tr.step(new Gz(c-(n?3:1),u,c,u,s,1,!0)).scrollIntoView())}return!0})(t,n);var r},splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:i,editor:r})=>{const{selection:o,doc:s}=t,{$from:a,$to:l}=o,c=pj(r.extensionManager.attributes,a.node().type.name,a.node().attrs);if(o instanceof kL&&o.node.isBlock)return!(!a.parentOffset||!Jz(s,a.pos)||(i&&(e&&gj(n,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),0));if(!a.parent.isBlock)return!1;if(i){const i=l.parentOffset===l.parent.content.size;o instanceof _L&&t.deleteSelection();const s=0===a.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(a.node(-1).contentMatchAt(a.indexAfter(-1)));let u=i&&s?[{type:s,attrs:c}]:void 0,d=Jz(t.doc,t.mapping.map(a.pos),1,u);if(u||d||!Jz(t.doc,t.mapping.map(a.pos),1,s?[{type:s}]:void 0)||(d=!0,u=s?[{type:s,attrs:c}]:void 0),d&&(t.split(t.mapping.map(a.pos),1,u),s&&!i&&!a.parentOffset&&a.parent.type!==s)){const e=t.mapping.map(a.before()),n=t.doc.resolve(e);a.node(-1).canReplaceWith(n.index(),n.index()+1,s)&&t.setNodeMarkup(t.mapping.map(a.before()),s)}e&&gj(n,r.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:e=>({tr:t,state:n,dispatch:i,editor:r})=>{var o;const s=w$(e,n.schema),{$from:a,$to:l}=n.selection,c=n.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==s)return!1;const d=r.extensionManager.attributes;if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==s||a.index(-2)!==a.node(-2).childCount-1)return!1;if(i){let e=SR.empty;const n=a.index(-1)?1:a.index(-2)?2:3;for(let t=a.depth-n;t>=a.depth-3;t-=1)e=SR.from(a.node(t).copy(e));const i=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,r=pj(d,a.node().type.name,a.node().attrs),l=(null===(o=s.contentMatch.defaultType)||void 0===o?void 0:o.createAndFill(r))||void 0;e=e.append(SR.from(s.createAndFill(null,l)||void 0));const c=a.before(a.depth-(n-1));t.replace(c,a.after(-i),new PR(e,4-n,0));let u=-1;t.doc.nodesBetween(c,t.doc.content.size,((e,t)=>{if(u>-1)return!1;e.isTextblock&&0===e.content.size&&(u=t+1)})),u>-1&&t.setSelection(_L.near(t.doc.resolve(u))),t.scrollIntoView()}return!0}const h=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,p=pj(d,u.type.name,u.attrs),f=pj(d,a.node().type.name,a.node().attrs);t.delete(a.pos,l.pos);const m=h?[{type:s,attrs:p},{type:h,attrs:f}]:[{type:s,attrs:p}];if(!Jz(t.doc,a.pos,2))return!1;if(i){const{selection:e,storedMarks:o}=n,{splittableMarks:s}=r.extensionManager,l=o||e.$to.parentOffset&&e.$from.marks();if(t.split(a.pos,2,m).scrollIntoView(),!l||!i)return!0;const c=l.filter((e=>s.includes(e.type.name)));t.ensureMarks(c)}return!0},toggleList:(e,t,n,i={})=>({editor:r,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=r.extensionManager,p=w$(e,s.schema),f=w$(t,s.schema),{selection:m,storedMarks:g}=s,{$from:y,$to:v}=m,b=y.blockRange(v),x=g||m.$to.parentOffset&&m.$from.marks();if(!b)return!1;const _=uj((e=>mj(e.type.name,d)))(m);if(b.depth>=1&&_&&b.depth-_.depth<=1){if(_.node.type===p)return c.liftListItem(f);if(mj(_.node.type.name,d)&&p.validContent(_.node.content)&&a)return l().command((()=>(o.setNodeMarkup(_.pos,p),!0))).command((()=>yj(o,p))).command((()=>vj(o,p))).run()}return n&&x&&a?l().command((()=>{const e=u().wrapInList(p,i),t=x.filter((e=>h.includes(e.type.name)));return o.ensureMarks(t),!!e||c.clearNodes()})).wrapInList(p,i).command((()=>yj(o,p))).command((()=>vj(o,p))).run():l().command((()=>!!u().wrapInList(p,i)||c.clearNodes())).wrapInList(p,i).command((()=>yj(o,p))).command((()=>vj(o,p))).run()},toggleMark:(e,t={},n={})=>({state:i,commands:r})=>{const{extendEmptyMarkRange:o=!1}=n,s=J$(e,i.schema);return fj(i,s,t)?r.unsetMark(s,{extendEmptyMarkRange:o}):r.setMark(s,t)},toggleNode:(e,t,n={})=>({state:i,commands:r})=>{const o=w$(e,i.schema),s=w$(t,i.schema);return oj(i,o,n)?r.setNode(s):r.setNode(o,n)},toggleWrap:(e,t={})=>({state:n,commands:i})=>{const r=w$(e,n.schema);return oj(n,r,t)?i.lift(r):i.wrapIn(r,t)},undoInputRule:()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let i=0;i<n.length;i+=1){const r=n[i];let o;if(r.spec.isInputRules&&(o=r.getState(e))){if(t){const t=e.tr,n=o.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(o.text){const n=t.doc.resolve(o.from).marks();t.replaceWith(o.from,o.to,e.schema.text(o.text,n))}else t.delete(o.from,o.to)}return!0}}return!1},unsetAllMarks:()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:i,ranges:r}=n;return i||t&&r.forEach((t=>{e.removeMark(t.$from.pos,t.$to.pos)})),!0},unsetMark:(e,t={})=>({tr:n,state:i,dispatch:r})=>{var o;const{extendEmptyMarkRange:s=!1}=t,{selection:a}=n,l=J$(e,i.schema),{$from:c,empty:u,ranges:d}=a;if(!r)return!0;if(u&&s){let{from:e,to:t}=a;const i=null===(o=c.marks().find((e=>e.type===l)))||void 0===o?void 0:o.attrs,r=K$(c,l,i);r&&(e=r.from,t=r.to),n.removeMark(e,t,l)}else d.forEach((e=>{n.removeMark(e.$from.pos,e.$to.pos,l)}));return n.removeStoredMark(l),!0},updateAttributes:(e,t={})=>({tr:n,state:i,dispatch:r})=>{let o=null,s=null;const a=sj("string"==typeof e?e:e.name,i.schema);return!!a&&("node"===a&&(o=w$(e,i.schema)),"mark"===a&&(s=J$(e,i.schema)),r&&n.selection.ranges.forEach((e=>{const r=e.$from.pos,a=e.$to.pos;i.doc.nodesBetween(r,a,((e,i)=>{o&&o===e.type&&n.setNodeMarkup(i,void 0,{...e.attrs,...t}),s&&e.marks.length&&e.marks.forEach((o=>{if(s===o.type){const l=Math.max(i,r),c=Math.min(i+e.nodeSize,a);n.addMark(l,c,s.create({...o.attrs,...t}))}}))}))})),!0)},wrapIn:(e,t={})=>({state:n,dispatch:i})=>function(e,t=null){return function(n,i){let{$from:r,$to:o}=n.selection,s=r.blockRange(o),a=s&&Xz(s,e,t);return!!a&&(i&&i(n.tr.wrap(s,a).scrollIntoView()),!0)}}(w$(e,n.schema),t)(n,i),wrapInList:(e,t={})=>({state:n,dispatch:i})=>f$(w$(e,n.schema),t)(n,i)});const xj=U$.create({name:"commands",addCommands:()=>({...bj})}),_j=U$.create({name:"editable",addProseMirrorPlugins(){return[new LL({key:new FL("editable"),props:{editable:()=>this.editor.options.editable}})]}}),wj=U$.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new LL({key:new FL("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const i=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(i),!1},blur:(t,n)=>{e.isFocused=!1;const i=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(i),!1}}}})]}}),kj=U$.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first((({commands:e})=>[()=>e.undoInputRule(),()=>e.command((({tr:t})=>{const{selection:n,doc:i}=t,{empty:r,$anchor:o}=n,{pos:s,parent:a}=o,l=o.parent.isTextblock?t.doc.resolve(s-1):o,c=l.parent.type.spec.isolating,u=o.pos-o.parentOffset,d=c&&1===l.parent.childCount?u===o.pos:yL.atStart(i).from===s;return!(!(r&&d&&a.type.isTextblock)||a.textContent.length)&&e.clearNodes()})),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()])),t=()=>this.editor.commands.first((({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()])),n={Enter:()=>this.editor.commands.first((({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},r={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return tj()||rj()?r:i},addProseMirrorPlugins(){return[new LL({key:new FL("clearDocument"),appendTransaction:(e,t,n)=>{if(!e.some((e=>e.docChanged))||t.doc.eq(n.doc))return;const{empty:i,from:r,to:o}=t.selection,s=yL.atStart(t.doc).from,a=yL.atEnd(t.doc).to;if(i||r!==s||o!==a)return;if(0!==n.doc.textBetween(0,n.doc.content.size," "," ").length)return;const l=n.tr,c=g$({state:n,transaction:l}),{commands:u}=new y$({editor:this.editor,state:c});return u.clearNodes(),l.steps.length?l:void 0}})]}}),Ej=U$.create({name:"tabindex",addProseMirrorPlugins(){return[new LL({key:new FL("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var Sj=Object.freeze({__proto__:null,ClipboardTextSerializer:W$,Commands:xj,Editable:_j,FocusEvents:wj,Keymap:kj,Tabindex:Ej});let Tj=class extends v${constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){const i=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(null!==i)return i;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute("data-tiptap-style"+(n?`-${n}`:""),""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n=S$(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:n});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const t="string"==typeof e?`${e}$`:e.key,n=this.state.reconfigure({plugins:this.state.plugins.filter((e=>!e.key.startsWith(t)))});this.view.updateState(n)}createExtensionManager(){const e=[...this.options.enableCoreExtensions?Object.values(Sj):[],...this.options.extensions].filter((e=>["extension","node","mark"].includes(null==e?void 0:e.type)));this.extensionManager=new $$(e,this)}createCommandManager(){this.commandManager=new y$({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=lj(this.options.content,this.schema,this.options.parseOptions),t=ej(e,this.options.autofocus);this.view=new UF(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:RL.create({doc:e,selection:t||void 0})});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.createNodeViews(),this.prependClass(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach((e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)})):void(this.capturedTransaction=e);const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),r=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),r&&this.emit("blur",{editor:this,event:r.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return dj(this.state,e)}isActive(e,t){const n="string"==typeof e?e:null,i="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return oj(e,null,n)||fj(e,null,n);const i=sj(t,e.schema);return"node"===i?oj(e,t,n):"mark"===i&&fj(e,t,n)}(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function(e,t){const n=Mz.fromSchema(t).serializeFragment(e),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return function(e,t){return q$(e,{from:0,to:e.content.size},t)}(this.state.doc,{blockSeparator:t,textSerializers:{...G$(this.schema),...n}})}get isEmpty(){return function(e){var t;const n=null===(t=e.type.createAndFill())||void 0===t?void 0:t.toJSON(),i=e.toJSON();return JSON.stringify(n)===JSON.stringify(i)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}};function Cj(e){return new D$({find:e.find,handler:({state:t,range:n,match:i})=>{const r=T$(e.getAttributes,void 0,i);if(!1===r||null===r)return null;const{tr:o}=t,s=i[i.length-1],a=i[0];if(s){const i=a.search(/\S/),l=n.from+a.indexOf(s),c=l+s.length;if(hj(n.from,n.to,t.doc).filter((t=>t.mark.type.excluded.find((n=>n===e.type&&n!==t.mark.type)))).filter((e=>e.to>l)).length)return null;c<n.to&&o.delete(c,n.to),l>n.from&&o.delete(n.from+i,l);const u=n.from+i+s.length;o.addMark(n.from+i,u,e.type.create(r||{})),o.removeStoredMark(e.type)}}})}function Mj(e){return new D$({find:e.find,handler:({state:t,range:n,match:i})=>{const r=T$(e.getAttributes,void 0,i)||{},{tr:o}=t,s=n.from;let a=n.to;const l=e.type.create(r);if(i[1]){let e=s+i[0].lastIndexOf(i[1]);e>a?e=a:a=e+i[1].length;const t=i[0][i[0].length-1];o.insertText(t,s+i[0].length-1),o.replaceWith(e,a,l)}else i[0]&&o.insert(s-1,e.type.create(r)).delete(o.mapping.map(s),o.mapping.map(a));o.scrollIntoView()}})}function Ij(e){return new D$({find:e.find,handler:({state:t,range:n,match:i})=>{const r=t.doc.resolve(n.from),o=T$(e.getAttributes,void 0,i)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function Aj(e){return new D$({find:e.find,handler:({state:t,range:n,match:i,chain:r})=>{const o=T$(e.getAttributes,void 0,i)||{},s=t.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),l=a&&Xz(a,e.type,o);if(!l)return null;if(s.wrap(a,l),e.keepMarks&&e.editor){const{selection:n,storedMarks:i}=t,{splittableMarks:r}=e.editor.extensionManager,o=i||n.$to.parentOffset&&n.$from.marks();if(o){const e=o.filter((e=>r.includes(e.type.name)));s.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";r().updateAttributes(t,o).run()}const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===e.type&&Yz(s.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(i,c))&&s.join(n.from-1)}})}class Pj{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=T$(b$(this,"addOptions",{name:this.name}))),this.storage=T$(b$(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Pj(e)}configure(e={}){const t=this.extend();return t.options=V$(this.options,e),t.storage=T$(b$(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Pj(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=T$(b$(t,"addOptions",{name:t.name})),t.storage=T$(b$(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const r=i.marks(),o=!!r.find((e=>(null==e?void 0:e.type.name)===t.name));if(!o)return!1;const s=r.find((e=>(null==e?void 0:e.type.name)===t.name));return s&&n.removeStoredMark(s),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}}let Oj=class e{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=T$(b$(this,"addOptions",{name:this.name}))),this.storage=T$(b$(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new e(t)}configure(e={}){const t=this.extend();return t.options=V$(this.options,e),t.storage=T$(b$(t,"addStorage",{name:t.name,options:t.options})),t}extend(t={}){const n=new e(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=T$(b$(n,"addOptions",{name:n.name})),n.storage=T$(b$(n,"addStorage",{name:n.name,options:n.options})),n}};function Dj(e){return new B$({find:e.find,handler:({state:t,range:n,match:i,pasteEvent:r})=>{const o=T$(e.getAttributes,void 0,i,r);if(!1===o||null===o)return null;const{tr:s}=t,a=i[i.length-1],l=i[0];let c=n.to;if(a){const i=l.search(/\S/),r=n.from+l.indexOf(a),u=r+a.length;if(hj(n.from,n.to,t.doc).filter((t=>t.mark.type.excluded.find((n=>n===e.type&&n!==t.mark.type)))).filter((e=>e.to>r)).length)return null;u<n.to&&s.delete(u,n.to),r>n.from&&s.delete(n.from+i,r),c=n.from+i+a.length,s.addMark(n.from+i,c,e.type.create(o||{})),s.removeStoredMark(e.type)}}})}const Rj=/^\s*>\s$/,zj=Oj.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Aj({find:Rj,type:this.type})]}}),Lj=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,Bj=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Nj=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Fj=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,$j=Pj.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],renderHTML({HTMLAttributes:e}){return["strong",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Cj({find:Lj,type:this.type}),Cj({find:Nj,type:this.type})]},addPasteRules(){return[Dj({find:Bj,type:this.type}),Dj({find:Fj,type:this.type})]}}),jj=Oj.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",k$(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Vj=Pj.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=cj(e,this.type);return!!Object.entries(n).some((([,e])=>!!e))||t.unsetMark(this.name)}}}}),Uj=/^\s*([-+*])\s$/,qj=Oj.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(jj.name,this.editor.getAttributes(Vj.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=Aj({find:Uj,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Aj({find:Uj,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Vj.name),editor:this.editor})),[e]}}),Gj=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Wj=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Hj=Pj.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Cj({find:Gj,type:this.type})]},addPasteRules(){return[Dj({find:Wj,type:this.type})]}}),Zj=/^```([a-z]+)?[\s\n]$/,Xj=/^~~~([a-z]+)?[\s\n]$/,Kj=Oj.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,i=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter((e=>e.startsWith(n))).map((e=>e.replace(n,"")))[0];return i||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",k$(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:i,empty:r}=n;if(!r||i.parent.type!==this.type)return!1;const o=i.parentOffset===i.parent.nodeSize-2,s=i.parent.textContent.endsWith("\n\n");return!(!o||!s)&&e.chain().command((({tr:e})=>(e.delete(i.pos-2,i.pos),!0))).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:i}=t,{$from:r,empty:o}=n;if(!o||r.parent.type!==this.type)return!1;if(r.parentOffset!==r.parent.nodeSize-2)return!1;const s=r.after();return void 0!==s&&(!i.nodeAt(s)&&e.commands.exitCode())}}},addInputRules(){return[Ij({find:Zj,type:this.type,getAttributes:e=>({language:e[1]})}),Ij({find:Xj,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new LL({key:new FL("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),i=t.clipboardData.getData("vscode-editor-data"),r=i?JSON.parse(i):void 0,o=null==r?void 0:r.mode;if(!n||!o)return!1;const{tr:s}=e.state;return s.replaceSelectionWith(this.type.create({language:o})),s.setSelection(_L.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.insertText(n.replace(/\r\n?/g,"\n")),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),Jj=Oj.create({name:"doc",topNode:!0,content:"block+"});function Yj(e={}){return new LL({view:t=>new Qj(t,e)})}class Qj{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map((t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}}))}destroy(){this.handlers.forEach((({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t)))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent;if(n){let n=t.nodeBefore,i=t.nodeAfter;if(n||i){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let r=t.getBoundingClientRect(),o=n?r.bottom:r.top;n&&i&&(o=(o+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),e={left:r.left,right:r.right,top:o-this.width/2,bottom:o+this.width/2}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos);e={left:t.left-this.width/2,right:t.left+this.width/2,top:t.top,bottom:t.bottom}}let i,r,o=this.editorView.dom.offsetParent;if(this.element||(this.element=o.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!o||o==document.body&&"static"==getComputedStyle(o).position)i=-pageXOffset,r=-pageYOffset;else{let e=o.getBoundingClientRect();i=e.left-o.scrollLeft,r=e.top-o.scrollTop}this.element.style.left=e.left-i+"px",this.element.style.top=e.top-r+"px",this.element.style.width=e.right-e.left+"px",this.element.style.height=e.bottom-e.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout((()=>this.setCursor(null)),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=n&&n.type.spec.disableDropCursor,r="function"==typeof i?i(this.editorView,t,e):i;if(t&&!r){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=tL(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){e.target!=this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const eV=U$.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[Yj(this.options)]}});class tV extends yL{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return tV.valid(n)?new tV(n):yL.near(n)}content(){return PR.empty}eq(e){return e instanceof tV&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new tV(e.resolve(t.pos))}getBookmark(){return new nV(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),i=e.node(t);if(0!=n)for(let e=i.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),i=e.node(t);if(n!=i.childCount)for(let e=i.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(i.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,n=!1){e:for(;;){if(!n&&tV.valid(e))return e;let i=e.pos,r=null;for(let n=e.depth;;n--){let o=e.node(n);if(t>0?e.indexAfter(n)<o.childCount:e.index(n)>0){r=o.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;i+=t;let s=e.doc.resolve(i);if(tV.valid(s))return s}for(;;){let o=t>0?r.firstChild:r.lastChild;if(!o){if(r.isAtom&&!r.isText&&!kL.isSelectable(r)){e=e.doc.resolve(i+r.nodeSize*t),n=!1;continue e}break}r=o,i+=t;let s=e.doc.resolve(i);if(tV.valid(s))return s}return null}}}tV.prototype.visible=!1,tV.findFrom=tV.findGapCursorFrom,yL.jsonID("gapcursor",tV);class nV{constructor(e){this.pos=e}map(e){return new nV(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return tV.valid(t)?new tV(t):yL.near(t)}}const iV=r$({ArrowLeft:rV("horiz",-1),ArrowRight:rV("horiz",1),ArrowUp:rV("vert",-1),ArrowDown:rV("vert",1)});function rV(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,i,r){let o=e.selection,s=t>0?o.$to:o.$from,a=o.empty;if(o instanceof _L){if(!r.endOfTextblock(n)||0==s.depth)return!1;a=!1,s=e.doc.resolve(t>0?s.after():s.before())}let l=tV.findGapCursorFrom(s,t,a);return!!l&&(i&&i(e.tr.setSelection(new tV(l))),!0)}}function oV(e,t,n){if(!e||!e.editable)return!1;let i=e.state.doc.resolve(t);if(!tV.valid(i))return!1;let r=e.posAtCoords({left:n.clientX,top:n.clientY});return!(r&&r.inside>-1&&kL.isSelectable(e.state.doc.nodeAt(r.inside))||(e.dispatch(e.state.tr.setSelection(new tV(i))),0))}function sV(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof tV))return!1;let{$from:n}=e.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!i)return!1;let r=SR.empty;for(let s=i.length-1;s>=0;s--)r=SR.from(i[s].createAndFill(null,r));let o=e.state.tr.replace(n.pos,n.pos,new PR(r,0,0));return o.setSelection(_L.near(o.doc.resolve(n.pos+1))),e.dispatch(o),!1}function aV(e){if(!(e.selection instanceof tV))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",_F.create(e.doc,[vF.widget(e.selection.head,t,{key:"gapcursor"})])}const lV=U$.create({name:"gapCursor",addProseMirrorPlugins:()=>[new LL({props:{decorations:aV,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&tV.valid(n)?new tV(n):null,handleClick:oV,handleKeyDown:iV,handleDOMEvents:{beforeinput:sV}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=T$(b$(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==t?t:null}}}),cV=Oj.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",k$(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:i})=>e.first([()=>e.exitCode(),()=>e.command((()=>{const{selection:e,storedMarks:r}=n;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:s}=i.extensionManager,a=r||e.$to.parentOffset&&e.$from.marks();return t().insertContent({type:this.name}).command((({tr:e,dispatch:t})=>{if(t&&a&&o){const t=a.filter((e=>s.includes(e.type.name)));e.ensureMarks(t)}return!0})).run()}))])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),uV=Oj.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map((e=>({tag:`h${e}`,attrs:{level:e}})))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,k$(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce(((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})})),{})},addInputRules(){return this.options.levels.map((e=>Ij({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}})))}});var dV=200,hV=function(){};hV.prototype.append=function(e){return e.length?(e=hV.from(e),!this.length&&e||e.length<dV&&this.leafAppend(e)||this.length<dV&&e.leafPrepend(this)||this.appendInner(e)):this},hV.prototype.prepend=function(e){return e.length?hV.from(e).append(this):this},hV.prototype.appendInner=function(e){return new fV(this,e)},hV.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?hV.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},hV.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},hV.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},hV.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var i=[];return this.forEach((function(t,n){return i.push(e(t,n))}),t,n),i},hV.from=function(e){return e instanceof hV?e:e&&e.length?new pV(e):hV.empty};var pV=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,i){for(var r=t;r<n;r++)if(!1===e(this.values[r],i+r))return!1},t.prototype.forEachInvertedInner=function(e,t,n,i){for(var r=t-1;r>=n;r--)if(!1===e(this.values[r],i+r))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=dV)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=dV)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(hV);hV.empty=new pV([]);var fV=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,i){var r=this.left.length;return!(t<r&&!1===this.left.forEachInner(e,t,Math.min(n,r),i))&&!(n>r&&!1===this.right.forEachInner(e,Math.max(t-r,0),Math.min(this.length,n)-r,i+r))&&void 0},t.prototype.forEachInvertedInner=function(e,t,n,i){var r=this.left.length;return!(t>r&&!1===this.right.forEachInvertedInner(e,t-r,Math.max(n,r)-r,i+r))&&!(n<r&&!1===this.left.forEachInvertedInner(e,Math.min(t,r),n,i))&&void 0},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(hV);class mV{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,i,r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}t&&(n=this.remapping(r,this.items.length),i=n.maps.length);let o,s,a=e.tr,l=[],c=[];return this.items.forEach(((e,t)=>{if(!e.step)return n||(n=this.remapping(r,t+1),i=n.maps.length),i--,void c.push(e);if(n){c.push(new gV(e.map));let t,r=e.step.map(n.slice(i));r&&a.maybeStep(r).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new gV(t,void 0,void 0,l.length+c.length))),i--,t&&n.appendMap(t,i)}else a.maybeStep(e.step);return e.selection?(o=n?e.selection.map(n.slice(i)):e.selection,s=new mV(this.items.slice(0,r).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0}),this.items.length,0),{remaining:s,transform:a,selection:o}}addTransform(e,t,n,i){let r=[],o=this.eventCount,s=this.items,a=!i&&s.length?s.get(s.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),u=new gV(e.mapping.maps[c],l,t);(n=a&&a.merge(u))&&(u=n,c?r.pop():s=s.slice(0,s.length-1)),r.push(u),t&&(o++,t=void 0),i||(a=u)}let l=o-n.depth;return l>vV&&(s=function(e,t){let n;return e.forEach(((e,i)=>{if(e.selection&&0==t--)return n=i,!1})),e.slice(n)}(s,l),o-=l),new mV(s.append(r),o)}remapping(e,t){let n=new zz;return this.items.forEach(((t,i)=>{let r=null!=t.mirrorOffset&&i-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,r)}),e,t),n}addMaps(e){return 0==this.eventCount?this:new mV(this.items.append(e.map((e=>new gV(e)))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-t),r=e.mapping,o=e.steps.length,s=this.eventCount;this.items.forEach((e=>{e.selection&&s--}),i);let a=t;this.items.forEach((t=>{let i=r.getMirror(--a);if(null==i)return;o=Math.min(o,i);let l=r.maps[i];if(t.step){let o=e.steps[i].invert(e.docs[i]),c=t.selection&&t.selection.map(r.slice(a+1,i));c&&s++,n.push(new gV(l,o,c))}else n.push(new gV(l))}),i);let l=[];for(let d=t;d<o;d++)l.push(new gV(r.maps[d]));let c=this.items.slice(0,i).append(l).append(n),u=new mV(c,s);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach((t=>{t.step||e++})),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,i=[],r=0;return this.items.forEach(((o,s)=>{if(s>=e)i.push(o),o.selection&&r++;else if(o.step){let e=o.step.map(t.slice(n)),s=e&&e.getMap();if(n--,s&&t.appendMap(s,n),e){let a=o.selection&&o.selection.map(t.slice(n));a&&r++;let l,c=new gV(s.invert(),e,a),u=i.length-1;(l=i.length&&i[u].merge(c))?i[u]=l:i.push(c)}}else o.map&&n--}),this.items.length,0),new mV(hV.from(i.reverse()),r)}}mV.empty=new mV(hV.empty,0);class gV{constructor(e,t,n,i){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new gV(t.getMap().invert(),t,this.selection)}}}class yV{constructor(e,t,n,i,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=i,this.prevComposition=r}}const vV=20;function bV(e){let t=[];return e.forEach(((e,n,i,r)=>t.push(i,r))),t}function xV(e,t){if(!e)return null;let n=[];for(let i=0;i<e.length;i+=2){let r=t.map(e[i],1),o=t.map(e[i+1],-1);r<=o&&n.push(r,o)}return n}function _V(e,t,n,i){let r=EV(t),o=SV.get(t).spec.config,s=(i?e.undone:e.done).popEvent(t,r);if(!s)return;let a=s.selection.resolve(s.transform.doc),l=(i?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),o,r),c=new yV(i?l:s.remaining,i?s.remaining:l,null,0,-1);n(s.transform.setSelection(a).setMeta(SV,{redo:i,historyState:c}).scrollIntoView())}let wV=!1,kV=null;function EV(e){let t=e.plugins;if(kV!=t){wV=!1,kV=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){wV=!0;break}}return wV}const SV=new FL("history"),TV=new FL("closeHistory");function CV(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new LL({key:SV,state:{init:()=>new yV(mV.empty,mV.empty,null,0,-1),apply:(t,n,i)=>function(e,t,n,i){let r,o=n.getMeta(SV);if(o)return o.historyState;n.getMeta(TV)&&(e=new yV(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(SV))return s.getMeta(SV).redo?new yV(e.done.addTransform(n,void 0,i,EV(t)),e.undone,bV(n.mapping.maps[n.steps.length-1]),e.prevTime,e.prevComposition):new yV(e.done,e.undone.addTransform(n,void 0,i,EV(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(r=n.getMeta("rebased"))?new yV(e.done.rebased(n,r),e.undone.rebased(n,r),xV(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new yV(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),xV(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let r=n.getMeta("composition"),o=0==e.prevTime||!s&&e.prevComposition!=r&&(e.prevTime<(n.time||0)-i.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach(((e,i)=>{for(let r=0;r<t.length;r+=2)e<=t[r+1]&&i>=t[r]&&(n=!0)})),n}(n,e.prevRanges)),a=s?xV(e.prevRanges,n.mapping):bV(n.mapping.maps[n.steps.length-1]);return new yV(e.done.addTransform(n,o?t.selection.getBookmark():void 0,i,EV(t)),mV.empty,a,n.time,null==r?e.prevComposition:r)}}(n,i,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,i="historyUndo"==n?MV:"historyRedo"==n?IV:null;return!!i&&(t.preventDefault(),i(e.state,e.dispatch))}}}})}const MV=(e,t)=>{let n=SV.getState(e);return!(!n||0==n.done.eventCount||(t&&_V(n,e,t,!1),0))},IV=(e,t)=>{let n=SV.getState(e);return!(!n||0==n.undone.eventCount||(t&&_V(n,e,t,!0),0))},AV=U$.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>MV(e,t),redo:()=>({state:e,dispatch:t})=>IV(e,t)}),addProseMirrorPlugins(){return[CV(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),PV=Oj.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",k$(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{$to:n}=t.selection,i=e();return 0===n.parentOffset?i.insertContentAt(Math.max(n.pos-2,0),{type:this.name}):i.insertContent({type:this.name}),i.command((({tr:e,dispatch:t})=>{var n;if(t){const{$to:t}=e.selection,i=t.end();if(t.nodeAfter)t.nodeAfter.isTextblock?e.setSelection(_L.create(e.doc,t.pos+1)):t.nodeAfter.isBlock?e.setSelection(kL.create(e.doc,t.pos)):e.setSelection(_L.create(e.doc,t.pos));else{const r=null===(n=t.parent.type.contentMatch.defaultType)||void 0===n?void 0:n.create();r&&(e.insert(i,r),e.setSelection(_L.create(e.doc,i+1)))}e.scrollIntoView()}return!0})).run()}}},addInputRules(){return[Mj({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),OV=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,DV=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,RV=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,zV=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,LV=Pj.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:e}){return["em",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Cj({find:OV,type:this.type}),Cj({find:RV,type:this.type})]},addPasteRules(){return[Dj({find:DV,type:this.type}),Dj({find:zV,type:this.type})]}}),BV=Oj.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",k$(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),NV=Oj.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",k$(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),FV=Pj.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:e=>!!e.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:e}){return["span",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=cj(e,this.type);return!!Object.entries(n).some((([,e])=>!!e))||t.unsetMark(this.name)}}}}),$V=/^(\d+)\.\s$/,jV=Oj.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return 1===t?["ol",k$(this.options.HTMLAttributes,n),0]:["ol",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(NV.name,this.editor.getAttributes(FV.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=Aj({find:$V,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=Aj({find:$V,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(FV.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),VV=Oj.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),UV=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,qV=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,GV=Pj.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",k$(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){const e={};return rj()?e["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():e["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),e},addInputRules(){return[Cj({find:UV,type:this.type})]},addPasteRules(){return[Dj({find:qV,type:this.type})]}}),WV=Oj.create({name:"text",group:"inline"}),HV=U$.create({name:"starterKit",addExtensions(){var e,t,n,i,r,o,s,a,l,c,u,d,h,p,f,m,g,y;const v=[];return!1!==this.options.blockquote&&v.push(zj.configure(null===(e=this.options)||void 0===e?void 0:e.blockquote)),!1!==this.options.bold&&v.push($j.configure(null===(t=this.options)||void 0===t?void 0:t.bold)),!1!==this.options.bulletList&&v.push(qj.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&v.push(Hj.configure(null===(i=this.options)||void 0===i?void 0:i.code)),!1!==this.options.codeBlock&&v.push(Kj.configure(null===(r=this.options)||void 0===r?void 0:r.codeBlock)),!1!==this.options.document&&v.push(Jj.configure(null===(o=this.options)||void 0===o?void 0:o.document)),!1!==this.options.dropcursor&&v.push(eV.configure(null===(s=this.options)||void 0===s?void 0:s.dropcursor)),!1!==this.options.gapcursor&&v.push(lV.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&v.push(cV.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&v.push(uV.configure(null===(c=this.options)||void 0===c?void 0:c.heading)),!1!==this.options.history&&v.push(AV.configure(null===(u=this.options)||void 0===u?void 0:u.history)),!1!==this.options.horizontalRule&&v.push(PV.configure(null===(d=this.options)||void 0===d?void 0:d.horizontalRule)),!1!==this.options.italic&&v.push(LV.configure(null===(h=this.options)||void 0===h?void 0:h.italic)),!1!==this.options.listItem&&v.push(BV.configure(null===(p=this.options)||void 0===p?void 0:p.listItem)),!1!==this.options.orderedList&&v.push(jV.configure(null===(f=this.options)||void 0===f?void 0:f.orderedList)),!1!==this.options.paragraph&&v.push(VV.configure(null===(m=this.options)||void 0===m?void 0:m.paragraph)),!1!==this.options.strike&&v.push(GV.configure(null===(g=this.options)||void 0===g?void 0:g.strike)),!1!==this.options.text&&v.push(WV.configure(null===(y=this.options)||void 0===y?void 0:y.text)),v}}),ZV=({renderers:e})=>U.createElement(U.Fragment,null,Object.entries(e).map((([e,t])=>cd.createPortal(t.reactElement,t.element,e))));class XV extends U.Component{constructor(e){super(e),this.editorContentRef=U.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:e}=this.props;if(e&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=this,e.createNodeViews(),this.initialized=!0}}maybeFlushSync(e){this.initialized?ld.flushSync(e):e()}setRenderer(e,t){this.maybeFlushSync((()=>{this.setState((({renderers:n})=>({renderers:{...n,[e]:t}})))}))}removeRenderer(e){this.maybeFlushSync((()=>{this.setState((({renderers:t})=>{const n={...t};return delete n[e],{renderers:n}}))}))}componentWillUnmount(){const{editor:e}=this.props;if(!e)return;if(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild)return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,...t}=this.props;return U.createElement(U.Fragment,null,U.createElement("div",{ref:this.editorContentRef,...t}),U.createElement(ZV,{renderers:this.state.renderers}))}}const KV=U.memo((e=>{const t=U.useMemo((()=>Math.floor(4294967295*Math.random()).toString()),[e.editor]);return U.createElement(XV,{key:t,...e})}));class JV extends Tj{constructor(){super(...arguments),this.contentComponent=null}}const YV=(e={},t=[])=>{const[n,i]=V.useState(null),r=function(){const[,e]=V.useState(0);return()=>e((e=>e+1))}(),{onBeforeCreate:o,onBlur:s,onCreate:a,onDestroy:l,onFocus:c,onSelectionUpdate:u,onTransaction:d,onUpdate:h}=e,p=V.useRef(o),f=V.useRef(s),m=V.useRef(a),g=V.useRef(l),y=V.useRef(c),v=V.useRef(u),b=V.useRef(d),x=V.useRef(h);return V.useEffect((()=>{n&&(o&&(n.off("beforeCreate",p.current),n.on("beforeCreate",o),p.current=o),s&&(n.off("blur",f.current),n.on("blur",s),f.current=s),a&&(n.off("create",m.current),n.on("create",a),m.current=a),l&&(n.off("destroy",g.current),n.on("destroy",l),g.current=l),c&&(n.off("focus",y.current),n.on("focus",c),y.current=c),u&&(n.off("selectionUpdate",v.current),n.on("selectionUpdate",u),v.current=u),d&&(n.off("transaction",b.current),n.on("transaction",d),b.current=d),h&&(n.off("update",x.current),n.on("update",h),x.current=h))}),[o,s,a,l,c,u,d,h,n]),V.useEffect((()=>{let t=!0;const n=new JV(e);return i(n),n.on("transaction",(()=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{t&&r()}))}))})),()=>{t=!1}}),t),V.useEffect((()=>()=>{null==n||n.destroy()}),[n]),n};V.createContext({editor:null}).Consumer;const QV=V.createContext({onDragStart:void 0});U.forwardRef(((e,t)=>{const{onDragStart:n}=V.useContext(QV),i=e.as||"div";return U.createElement(i,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})}));const eU=xD`
  mutation CreatePost($deviceId: Int, $channelId: Int!, $text: String!) {
    createPost(deviceId: $deviceId, channelId: $channelId, text: $text) {
      post {
        ...PostFields
      }
      membership {
        ...MembershipFields
      }
    }
  }
  ${xR}
  ${$D}
`,tU=[HV.configure({history:{depth:100}})],nU=({isPopup:e})=>{var t;nC(BS);const n=nC(TS),i=nC((e=>{var t;return PS(e,null!==(t=null==n?void 0:n.id)&&void 0!==t?t:-1)})),r=nC(LS),o=(()=>{const e=tC(),[t]=zD(_R,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(MS(t.getChannelPosts))}});return(e,n)=>{t({variables:{channelId:e,createdAt:n}})}})(),[s,a]=V.useState(!0);V.useEffect((()=>{if(s){if(a(!1),!n||!c)return;null==c||c.setEditable(!1),h(n.id,c.getText())}}),[s]);const l=U$.create({name:"custom",addKeyboardShortcuts:()=>({Enter:()=>(a(!0),!0)})});tU.push(l);const c=YV({extensions:tU,content:""}),[u,d]=V.useState(""),h=(e=>{const t=tC(),[n]=zD(eU,{onError:t=>{console.log(t),e()},onCompleted:n=>{console.log(n),t(MS([n.createPost])),t(fS([n.createPost.membership])),e()}});return async(e,t)=>{const{value:i}=await tR.get({key:iR});console.log("deviceId",i),n({variables:{deviceId:i?parseInt(i):null,channelId:e,text:t}})}})((e=>{null==c||c.commands.clearContent(),null==c||c.setEditable(!0),e&&(d(e),setTimeout((()=>{d("")}),3e3))})),[p,f]=V.useState(!0);V.useEffect((()=>{var e;if(null==n||!n.id)return;if(!p)return;const t=i.reduce(((e,t)=>e?t.createdAt<e?t.createdAt:e:t.createdAt),null===(e=i[0])||void 0===e?void 0:e.createdAt);o(n.id,t),f(!1)}),[null==n?void 0:n.id,p]);const m=V.useRef(null),[g,y]=V.useState(!0),[v,b]=V.useState(0);return V.useEffect((()=>{m.current&&(b(m.current.scrollHeight),g?m.current.scrollTo({top:m.current.scrollHeight,behavior:"auto"}):m.current.scrollHeight>v&&m.current.scrollTo({top:m.current.scrollHeight-v+m.current.scrollTop}))}),[null===(t=m.current)||void 0===t?void 0:t.scrollHeight,g]),V.useEffect((()=>{var e;const t=()=>{var e,t,n,i,r,o;(null===(e=m.current)||void 0===e?void 0:e.scrollTop)===(null!==(t=null===(n=m.current)||void 0===n?void 0:n.scrollHeight)&&void 0!==t?t:0)-(null!==(i=null===(r=m.current)||void 0===r?void 0:r.offsetHeight)&&void 0!==i?i:0)?(console.log("scrolled to bottom"),y(!0)):(0===(null===(o=m.current)||void 0===o?void 0:o.scrollTop)&&f(!0),y(!1))};return null===(e=m.current)||void 0===e||e.addEventListener("scroll",t),()=>{var e;null===(e=m.current)||void 0===e||e.removeEventListener("scroll",t)}}),[m.current]),ee("div",{style:{fontSize:14,display:"flex",flexDirection:"column",justifyContent:"end",height:"100%"},children:[ee("div",{ref:m,style:{height:"100%",overflowY:"scroll"},children:[Q("div",{style:{display:p?"flex":"none",padding:20},children:Q(aw,{})}),i.sort(((e,t)=>e.createdAt<t.createdAt?-1:1)).map((e=>{var t,n,i;return ee(pw,{style:{margin:5,padding:10},children:[ee("div",{style:{display:"flex",marginBottom:5},children:[Q(Y_,{style:{width:20,height:20,marginRight:5},children:Q("img",{src:`https://www.gravatar.com/avatar/${yR(null!==(t=null===(n=r[e.userId])||void 0===n?void 0:n.email)&&void 0!==t?t:"")}?d=retro`})}),null===(i=r[e.userId])||void 0===i?void 0:i.name]}),Q("div",{style:{color:"var(--ion-color-dark)"},children:e.text})]},e.id)}))]}),ee("div",{style:{margin:10,border:"1px solid",borderRadius:5,display:"flex"},children:[Q("div",{style:{minWidth:e?150:320},children:Q(KV,{editor:c})}),Q(Q_,{style:{paddingRight:5},children:Q(hw,{onClick:()=>{n&&c&&(c.setEditable(!1),h(n.id,c.getText()))},style:{border:"1px solid",borderRadius:5},children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M470.3 271.15L43.16 447.31a7.83 7.83 0 01-11.16-7V327a8 8 0 016.51-7.86l247.62-47c17.36-3.29 17.36-28.15 0-31.44l-247.63-47a8 8 0 01-6.5-7.85V72.59c0-5.74 5.88-10.26 11.16-8L470.3 241.76a16 16 0 010 29.39z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>"})})})]})]})},iU=({})=>(nC(BS),nC(TS),ee("div",{children:[Q("div",{children:"SUPER"}),Q("div",{children:"SUB"})]})),rU=xD`
  mutation SaveMembership($membershipId: Int!, $isSaved: Boolean!) {
    saveMembership(membershipId: $membershipId, isSaved: $isSaved) {
      ...MembershipFields
    }
  }
  ${$D}
`,oU=()=>{const e=tC(),[t]=zD(rU,{onError:e=>{console.error(e)},onCompleted:t=>{console.log(t),e(fS([t.saveMembership]))}});return(e,n)=>{t({variables:{membershipId:e,isSaved:n}})}},sU=({router:e,authModal:t,streams:n,channelMode:i,setChannelMode:r})=>{var o,s,a,l,c;tC();const u=nC(LS),d=nC(BS),h=nC(TS),p=nC((e=>{var t;return vS(e,null!==(t=null==h?void 0:h.id)&&void 0!==t?t:-1)})),f=nC((e=>{var t,n;return bS(e,null!==(t=null==h?void 0:h.id)&&void 0!==t?t:-1,null!==(n=null==d?void 0:d.id)&&void 0!==n?n:-1)})),m=p.find((e=>e.isOwner));console.log(m,u,p);const g=oU();return ee("div",{className:"popup",style:{width:220},children:[ee("div",{children:[ee("div",{style:{display:"flex",justifyContent:"space-between",marginLeft:-5,marginRight:-5},children:[Q(Q_,{children:Q(hw,{onClick:()=>{null!=f&&f.id&&!f.isOwner&&g(f.id,!f.isSaved)},style:{},children:Q(Hw,{icon:null!=f&&f.isSaved||null!=f&&f.isOwner?vk:bk,size:"small",style:{color:null!=f&&f.isSaved||null!=f&&f.isOwner?"var(--ion-color-primary)":null}})})}),ee(Q_,{children:[Q(hw,{onClick:()=>{e.push("/channel/"+(null==h?void 0:h.id),"none")},children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><rect x='96' y='96' width='320' height='320' rx='24' ry='24' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",size:"small"})}),Q(hw,{onClick:()=>{e.push("/map","none")},children:Q(Hw,{icon:yk,size:"small"})})]})]}),Q("div",{style:{marginTop:2,textAlign:"left",fontSize:18,fontWeight:"bold",color:"var(--ion-color-dark)"},children:null==h?void 0:h.name}),ee("div",{style:{marginTop:5,display:null!=m&&m.userId?"flex":"none",color:"var(--ion-color-medium)",fontSize:14},children:[Q(Y_,{style:{width:15,height:15,marginTop:2,marginRight:2},children:Q("img",{src:`https://www.gravatar.com/avatar/${yR(null!==(o=null===(s=u[null!==(a=null==m?void 0:m.userId)&&void 0!==a?a:-1])||void 0===s?void 0:s.email)&&void 0!==o?o:"")}?d=retro`})}),null===(l=u[null!==(c=null==m?void 0:m.userId)&&void 0!==c?c:-1])||void 0===l?void 0:l.name]}),Q("div",{style:{marginTop:10,textAlign:"left",fontSize:14,color:"var(--ion-color-medium)"},children:null==h?void 0:h.detail}),ee(Q_,{style:{marginTop:5,display:"flex",flexDirection:"row",justifyContent:"center"},children:[Q(hw,{onClick:()=>r("talk"),style:{color:"talk"===i?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:"talk"===i?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TALK"}),Q(hw,{onClick:()=>r("text"),style:{color:"text"===i?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:"text"===i?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TEXT"}),Q(hw,{onClick:()=>r("roam"),style:{color:"roam"===i?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:"roam"===i?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"ROAM"})]})]}),Q("div",{style:{marginTop:10,height:300},children:"talk"===i?Q(bR,{authModal:t,streams:n}):"text"===i?Q(nU,{isPopup:!0}):"roam"===i?Q(iU,{}):null})]})},aU=({createChannel:e})=>Q("div",{className:"popup",style:{marginTop:5},children:Q(Q_,{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Q(hw,{onClick:e,style:{color:"var(--ion-color-primary)",border:"1px solid var(--ion-color-primary)",borderRadius:"5px",fontWeight:"bold"},children:"NEW CHANNEL"})})}),lU=xD`
  mutation SetUserMap($lng: Float!, $lat: Float!,  $zoom: Float!) {
    setUserMap(lng: $lng, lat: $lat, zoom: $zoom) {
      id
      lng
      lat
      zoom
    }
  }
`;wk.accessToken="pk.eyJ1Ijoid2VpaHoiLCJhIjoiY2xlNjVuaWI1MDJjcjNybXJsbGo4bXgyMiJ9.w_9vD530_V81gcdS-yZOLw";const cU=({})=>{var e,t,n;const i=tC(),{streams:r,authModal:o,shouldUpdateMapData:s,setShouldUpdateMapData:a,newChannelLngLat:l,setNewChannelLngLat:c,channelMode:u,setChannelMode:d}=V.useContext(pW),h=Jw(),p=nC(BS),f=nC(TS),[m,g]=V.useState(-118.306),[y,v]=V.useState(34.115),[b,x]=V.useState(9),_=V.useRef(null),w=V.useRef(null),k=V.useRef(null),E=V.useRef(null),S=V.useRef(null),T=V.useRef(null),C=nC(LS),M=nC(SS),I=nC((e=>{var t;return yS(e,null!==(t=null==p?void 0:p.id)&&void 0!==t?t:-1)})),[A,P]=V.useState(!1),O=(e=>{const t=tC(),[n]=zD(ND,{onError:e=>{console.log(e)},onCompleted:n=>{console.log(n),t(_S(n.getChannels)),e(!0)}});return(e,t)=>{n({variables:{lng:e,lat:t}})}})(a),D=(()=>{const[e]=zD(lU,{onError:e=>{console.error(e)},onCompleted:e=>{console.log("set user map",e)}});return(t,n,i)=>{e({variables:{lng:t,lat:n,zoom:i}})}})();V.useEffect((()=>{null!=p&&p.id&&k.current&&k.current.easeTo({center:[p.lng,p.lat],zoom:p.zoom})}),[null==p?void 0:p.id]);const R=()=>{var e,t,n;null!=p&&p.id?(null===(e=_.current)||void 0===e||e.getPopup().remove(),null===(t=_.current)||void 0===t||t.remove(),console.log(h.routeInfo.pathname),h.push("/create-channel","none")):null==o||null===(n=o.current)||void 0===n||n.present()},[z,L]=V.useState(-1);V.useEffect((()=>{var e;(console.log("pathname",h.routeInfo.pathname,z,null==f?void 0:f.id),h.routeInfo.pathname.match(/^\/map/)&&-1!==z)&&(z?z===(null!==(e=null==f?void 0:f.id)&&void 0!==e?e:null)?h.push("/map","none"):h.push("/map/"+z,"none"):"/map"!==h.routeInfo.pathname&&h.push("/map","none"),L(-1))}),[z,null==f?void 0:f.id,h.routeInfo.pathname]),V.useEffect((()=>{const e=h.routeInfo.pathname.match(/^\/map\/(\d+)/);if(e){const t=parseInt(e[1]);t!==(null==f?void 0:f.id)&&i(wS(t))}else{const e=/^\/channel\/(\d+)/,t=h.routeInfo.pathname.match(e);if(t){const e=parseInt(t[1]);e!==(null==f?void 0:f.id)&&i(wS(e))}else null!=f&&f.id&&i(wS(null))}}),[h.routeInfo.pathname]),V.useEffect((()=>{O(m,y)}),[]),V.useEffect((()=>{console.log("initializing map"),k.current=new wk.Map({container:w.current,style:"mapbox://styles/mapbox/streets-v12",center:[m,y],zoom:b,trackResize:!0}),k.current.on("load",(function(){var e;console.log("map loaded"),null===(e=k.current)||void 0===e||e.resize(),P(!0)})),k.current.on("move",(()=>{k.current&&(g(k.current.getCenter().lng),v(k.current.getCenter().lat),x(k.current.getZoom()))})),k.current.on("click",(e=>{setTimeout((()=>{e.clickOnLayer||(console.log("map click",e.lngLat),c(e.lngLat),L(null))}),100)}))}),[]),V.useEffect((()=>{k.current&&A&&s&&(k.current.getSource("channels")&&(k.current.removeLayer("clusters"),k.current.removeLayer("cluster-count"),k.current.removeLayer("unclustered-point"),k.current.removeLayer("unclustered-point-label"),k.current.removeSource("channels")),k.current.addSource("channels",{type:"geojson",data:{type:"FeatureCollection",features:Object.values(M).map((e=>({type:"Feature",properties:{id:e.id,name:e.name,memberCount:e.memberCount,activeUserCount:e.activeUserCount},geometry:{type:"Point",coordinates:[e.lng,e.lat]}})))},cluster:!0,clusterMaxZoom:14,clusterRadius:30,clusterProperties:{memberCount:["+",["get","memberCount"]],activeUserCount:["+",["get","activeUserCount"]]}}),k.current.addLayer({id:"clusters",type:"circle",source:"channels",filter:["has","point_count"],paint:{"circle-color":["case",[">",["get","activeUserCount"],0],"#f4900c","grey"],"circle-radius":["step",["get","point_count"],20,10,30,100,40,1e3,50],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),k.current.addLayer({id:"cluster-count",type:"symbol",source:"channels",filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-font":["Open Sans Semibold"],"text-size":12}}),k.current.addLayer({id:"unclustered-point",type:"circle",source:"channels",filter:["!",["has","point_count"]],paint:{"circle-color":["case",[">",["get","activeUserCount"],0],"#f4900c","grey"],"circle-radius":12,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),k.current.addLayer({id:"unclustered-point-label",type:"symbol",source:"channels",filter:["!",["has","point_count"]],layout:{"text-field":["get","name"],"text-font":["Open Sans Semibold"],"text-size":14,"text-offset":[0,1.5]}}),k.current.on("click","clusters",(e=>{var t,n,i;e.clickOnLayer=!0,L(null);const r=null===(t=k.current)||void 0===t?void 0:t.queryRenderedFeatures(e.point,{layers:["clusters"]});if(!r)return;const o=null===(n=r[0].properties)||void 0===n?void 0:n.cluster_id;(null===(i=k.current)||void 0===i?void 0:i.getSource("channels")).getClusterExpansionZoom(o,((e,t)=>{var n;e||null===(n=k.current)||void 0===n||n.easeTo({center:r[0].geometry.coordinates,zoom:t})}))})),k.current.on("click","unclustered-point",(e=>{var t;if(e.clickOnLayer=!0,!e.features)return;const n=null===(t=e.features[0].properties)||void 0===t?void 0:t.id;n&&L(n)})),k.current.on("mouseenter","clusters",(()=>{k.current&&(k.current.getCanvas().style.cursor="pointer")})),k.current.on("mouseleave","clusters",(()=>{k.current&&(k.current.getCanvas().style.cursor="")})),k.current.on("mouseenter","unclustered-point",(()=>{k.current&&(k.current.getCanvas().style.cursor="pointer")})),k.current.on("mouseleave","unclustered-point",(()=>{k.current&&(k.current.getCanvas().style.cursor="")})),k.current.on("moveend",(()=>{if(!k.current)return;k.current.getBounds();const e=k.current.getCenter(),t=k.current.getZoom();T.current&&clearTimeout(T.current),setTimeout((()=>{D(e.lng,e.lat,t)}),1e3)})),k.current.on("zoomend",(()=>{if(!k.current)return;k.current.getBounds();const e=k.current.getCenter(),t=k.current.getZoom();T.current&&clearTimeout(T.current),setTimeout((()=>{D(e.lng,e.lat,t)}),1e3)})),a(!1))}),[A,s,M,I,null===(e=k.current)||void 0===e?void 0:e.getSource("channels"),C]);const[B,N]=V.useState(!1),F=V.useRef(null),[$,j]=V.useState(null);V.useEffect((()=>{var e,t,n,i;if(console.log("update channel popup",null==f?void 0:f.id,$,u,null===(e=w.current)||void 0===e?void 0:e.clientWidth,null===(t=w.current)||void 0===t?void 0:t.clientHeight),j(null!==(n=null==f?void 0:f.id)&&void 0!==n?n:null),null!=f&&f.id)if((null==f?void 0:f.id)!==$){var s,a;f.lat===y&&f.lng===m||null===(a=k.current)||void 0===a||a.easeTo({center:[f.lng,f.lat]}),null===(s=F.current)||void 0===s||s.remove(),c(null);const e=document.createElement("div");E.current=ud(e),E.current.render(Q(AD,{client:IW,children:Q(BT,{store:eC,children:Q(sU,{router:h,authModal:o,streams:r,channelMode:u,setChannelMode:d})})})),F.current=new wk.Popup({offset:15,focusAfterOpen:!0,closeButton:!1}).setLngLat([f.lng,f.lat]).setDOMContent(e).addTo(k.current)}else{var l;null===(l=E.current)||void 0===l||l.render(Q(AD,{client:IW,children:Q(BT,{store:eC,children:Q(sU,{router:h,authModal:o,streams:r,channelMode:u,setChannelMode:d})})}))}else null===(i=F.current)||void 0===i||i.remove(),F.current=null}),[null==f?void 0:f.id,r,u,B]),V.useEffect((()=>{var e;if(l)if(L(null),_.current&&S.current)S.current.render(Q(aU,{createChannel:R})),_.current.setLngLat(l).addTo(k.current),_.current.getPopup().isOpen()||_.current.togglePopup();else{const e=document.createElement("div"),t=ud(e);t.render(Q(aU,{createChannel:R})),S.current=t,_.current=new wk.Marker({color:"#f4900c"}).setLngLat(l).setPopup(new wk.Popup({offset:40,focusAfterOpen:!0,closeButton:!1}).setDOMContent(e)).addTo(k.current).togglePopup(),_.current.getElement().addEventListener("click",(e=>{var t;e.stopPropagation(),c(null),null===(t=_.current)||void 0===t||t.remove()}))}else null===(e=_.current)||void 0===e||e.remove()}),[l,h.push]);const U=oU();return V.useEffect((()=>{var e;null===(e=k.current)||void 0===e||e.resize(),N((e=>!e))}),[null===(t=w.current)||void 0===t?void 0:t.clientWidth,null===(n=w.current)||void 0===n?void 0:n.clientHeight]),ee(Y,{children:[ee(ow,{type:"overlay",menuId:"map-menu",contentId:"map-main-content",children:[Q(nw,{style:{marginTop:cw("ios")&&!cw("mobileweb")?105:50,padding:10},children:"STARRED CHANNELS"}),Q(ew,{children:I.filter((e=>e.isSaved||e.isOwner)).sort(((e,t)=>e.lastVisitedAt>t.lastVisitedAt?-1:1)).map((e=>{return ee(pw,{onClick:(n=e.channelId,()=>{h.push("/map/"+n,"none"),_g.close()}),style:{margin:5,padding:10,cursor:"pointer",display:"flex",justifyContent:"space-between"},children:[ee("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[ee("div",{style:{display:"flex"},children:[Q("div",{children:M[e.channelId].name})," ",Q("div",{style:{color:"#f4900c"},children:e.isOwner?"(owner)":null})]}),M[e.channelId].activeUserCount>0?ee("div",{style:{fontSize:12,color:"#f4900c"},children:[M[e.channelId].activeUserCount," active"]}):null]}),Q(Q_,{children:Q(hw,{onClick:(t=e.id,e=>{e.stopPropagation(),U(t,!1)}),disabled:e.isOwner,children:Q(Hw,{icon:yk})})})]},e.id);var t,n}))})]}),Q(Pw,{id:"map-main-content",children:ee(ew,{fullscreen:!0,style:{position:"relative"},children:[Q("div",{ref:w,className:"map-container",style:{opacity:A?1:0,top:0,left:0,right:0,bottom:0,position:"fixed"}}),Q(pw,{style:{position:"fixed",borderRadius:3,zIndex:10,left:cw("ios")?-10:0,top:cw("ios")?cw("mobileweb")?32:92:52,padding:10},children:null!=f&&f.id?M[f.id].lng.toPrecision(6)+", "+M[f.id].lat.toPrecision(6):l?(null==l?void 0:l.lng.toPrecision(6))+", "+(null==l?void 0:l.lat.toPrecision(6)):m.toPrecision(6)+", "+y.toPrecision(6)}),Q(pw,{style:{position:"fixed",borderRadius:3,zIndex:10,left:cw("ios")?-10:0,top:cw("ios")?cw("mobileweb")?72:142:92},children:Q(sw,{autoHide:!1,children:Q(Q_,{children:Q(hw,{children:Q(Hw,{icon:vk,size:"small"})})})})})]})})]})};function uU(e){return Uint8Array.from(window.atob(e),(e=>e.charCodeAt(0)))}const dU=({deal:e})=>{const[t,n]=V.useState("");V.useEffect((()=>{const t=uU(e.image.data),i=new Blob([t],{type:"image/jpeg"}),r=URL.createObjectURL(i);return n(r),()=>{URL.revokeObjectURL(r)}}),[]);const i="/deal/"+e.id;return ee(pw,{routerLink:i,style:{margin:"auto",marginBottom:10,padding:10,maxWidth:420,color:"var(--ion-color-secondary-contrast)",backgroundColor:"var(--ion-color-primary-contrast)"},children:[Q("h1",{style:{marginTop:0,marginBottom:10,fontWeight:"bold",fontSize:32,display:"flex",flexDirection:"row",justifyContent:"center"},children:e.name}),Q("img",{src:t,style:{width:"100%",borderRadius:5}}),Q("h3",{style:{margin:5,display:"flex",flexDirection:"row",justifyContent:"center"},children:e.detail}),ee("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",padding:10},children:[ee("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.quantity," available @ "]}),Q(Q_,{children:ee(hw,{routerLink:i,style:{backgroundColor:"",borderRadius:5,border:"1px solid"},children:["$",e.price]})})]})]})},hU=xD`
  mutation GetDeals {
    getDeals {
      id
      vendorId
      name
      detail
      quantity
      price
      image {
        data
      }
    }
  }
`,pU=()=>{const e=Jw(),t=tC(),{authModal:n}=V.useContext(pW),i=nC(BS),r=nC(YT),[o]=zD(hU,{onError:e=>{console.log(e)},onCompleted:e=>{console.log(e),t(KT(e.getDeals))}});return V.useEffect((()=>{o()}),[]),Q(Pw,{children:ee(ew,{fullscreen:!0,children:[Q("div",{style:{padding:10,backgroundColor:"#222222",minHeight:"100%"},children:Object.values(r).map((e=>Q(dU,{deal:e},"deal"+e.id)))}),Q(tw,{vertical:"bottom",horizontal:"end",slot:"fixed",children:Q(fw,{onClick:()=>{var t;null!=i&&i.id?e.push("/create-deal"):null===(t=n.current)||void 0===t||t.present()},size:"small",style:{boxShadow:"0 5px 15px rgb(0 0 0 / 0.2)",borderRadius:"50%"},children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M256 112v288M400 256H112' class='ionicon-fill-none ionicon-stroke-width'/></svg>"})})})]})})};function fU(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function mU(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fU(Object(n),!0).forEach((function(t){yU(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fU(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gU(e){return gU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gU(e)}function yU(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vU(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(l){a=!0,r=l}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return bU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bU(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bU(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var xU=function(e){var t=U.useRef(e);return U.useEffect((function(){t.current=e}),[e]),t.current},_U=function(e){return null!==e&&"object"===gU(e)},wU="[object Object]",kU=function e(t,n){if(!_U(t)||!_U(n))return t===n;var i=Array.isArray(t);if(i!==Array.isArray(n))return!1;var r=Object.prototype.toString.call(t)===wU;if(r!==(Object.prototype.toString.call(n)===wU))return!1;if(!r&&!i)return t===n;var o=Object.keys(t),s=Object.keys(n);if(o.length!==s.length)return!1;for(var a={},l=0;l<o.length;l+=1)a[o[l]]=!0;for(var c=0;c<s.length;c+=1)a[s[c]]=!0;var u=Object.keys(a);if(u.length!==o.length)return!1;var d=t,h=n;return u.every((function(t){return e(d[t],h[t])}))},EU=function(e,t,n){return _U(e)?Object.keys(e).reduce((function(i,r){var o=!_U(t)||!kU(e[r],t[r]);return n.includes(r)?(o&&console.warn("Unsupported prop change: options.".concat(r," is not a mutable property.")),i):o?mU(mU({},i||{}),{},yU({},r,e[r])):i}),null):null},SU=function(e){if(null===e||_U(t=e)&&"function"==typeof t.elements&&"function"==typeof t.createToken&&"function"==typeof t.createPaymentMethod&&"function"==typeof t.confirmCardPayment)return e;var t;throw new Error("Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.")},TU=function(e){if(function(e){return _U(e)&&"function"==typeof e.then}(e))return{tag:"async",stripePromise:Promise.resolve(e).then(SU)};var t=SU(e);return null===t?{tag:"empty"}:{tag:"sync",stripe:t}},CU=U.createContext(null);CU.displayName="ElementsContext";var MU=U.createContext(null);MU.displayName="CartElementContext";var IU=function(e){var t=e.stripe,n=e.options,i=e.children,r=U.useMemo((function(){return TU(t)}),[t]),o=vU(U.useState(null),2),s=o[0],a=o[1],l=vU(U.useState(null),2),c=l[0],u=l[1],d=vU(U.useState((function(){return{stripe:"sync"===r.tag?r.stripe:null,elements:"sync"===r.tag?r.stripe.elements(n):null}})),2),h=d[0],p=d[1];U.useEffect((function(){var e=!0,t=function(e){p((function(t){return t.stripe?t:{stripe:e,elements:e.elements(n)}}))};return"async"!==r.tag||h.stripe?"sync"!==r.tag||h.stripe||t(r.stripe):r.stripePromise.then((function(n){n&&e&&t(n)})),function(){e=!1}}),[r,h,n]);var f=xU(t);U.useEffect((function(){null!==f&&f!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")}),[f,t]);var m=xU(n);return U.useEffect((function(){if(h.elements){var e=EU(n,m,["clientSecret","fonts"]);e&&h.elements.update(e)}}),[n,m,h.elements]),U.useEffect((function(){var e=h.stripe;e&&e._registerWrapper&&e.registerAppInfo&&(e._registerWrapper({name:"react-stripe-js",version:"2.1.1"}),e.registerAppInfo({name:"react-stripe-js",version:"2.1.1",url:"https://stripe.com/docs/stripe-js/react"}))}),[h.stripe]),U.createElement(CU.Provider,{value:h},U.createElement(MU.Provider,{value:{cart:s,setCart:a,cartState:c,setCartState:u}},i))};IU.propTypes={stripe:yd.any,options:yd.object};var AU=function(e){return function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e}(U.useContext(CU),e)},PU=function(e){return function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e}(U.useContext(MU),e)};yd.func.isRequired;var OU=function(e,t,n){var i=!!n,r=U.useRef(n);U.useEffect((function(){r.current=n}),[n]),U.useEffect((function(){if(!i||!e)return function(){};var n=function(){r.current&&r.current.apply(r,arguments)};return e.on(t,n),function(){e.off(t,n)}}),[i,t,e,r])},DU=function(e,t){var n,i="".concat((n=e).charAt(0).toUpperCase()+n.slice(1),"Element"),r=t?function(e){AU("mounts <".concat(i,">")),PU("mounts <".concat(i,">"));var t=e.id,n=e.className;return U.createElement("div",{id:t,className:n})}:function(t){var n,r=t.id,o=t.className,s=t.options,a=void 0===s?{}:s,l=t.onBlur,c=t.onFocus,u=t.onReady,d=t.onChange,h=t.onEscape,p=t.onClick,f=t.onLoadError,m=t.onLoaderStart,g=t.onNetworksChange,y=t.onCheckout,v=t.onLineItemClick,b=t.onConfirm,x=t.onCancel,_=t.onShippingAddressChange,w=t.onShippingRateChange,k=AU("mounts <".concat(i,">")).elements,E=vU(U.useState(null),2),S=E[0],T=E[1],C=U.useRef(null),M=U.useRef(null),I=PU("mounts <".concat(i,">")),A=I.setCart,P=I.setCartState;OU(S,"blur",l),OU(S,"focus",c),OU(S,"escape",h),OU(S,"click",p),OU(S,"loaderror",f),OU(S,"loaderstart",m),OU(S,"networkschange",g),OU(S,"lineitemclick",v),OU(S,"confirm",b),OU(S,"cancel",x),OU(S,"shippingaddresschange",_),OU(S,"shippingratechange",w),"cart"===e?n=function(e){P(e),u&&u(e)}:u&&(n="expressCheckout"===e?u:function(){u(S)}),OU(S,"ready",n),OU(S,"change","cart"===e?function(e){P(e),d&&d(e)}:d),OU(S,"checkout","cart"===e?function(e){P(e),y&&y(e)}:y),U.useLayoutEffect((function(){if(null===C.current&&k&&null!==M.current){var t=k.create(e,a);"cart"===e&&A&&A(t),C.current=t,T(t),t.mount(M.current)}}),[k,a,A]);var O=xU(a);return U.useEffect((function(){if(C.current){var e=EU(a,O,["paymentRequest"]);e&&C.current.update(e)}}),[a,O]),U.useLayoutEffect((function(){return function(){if(C.current&&"function"==typeof C.current.destroy)try{C.current.destroy(),C.current=null}catch(e){}}}),[]),U.createElement("div",{id:r,className:o,ref:M})};return r.propTypes={id:yd.string,className:yd.string,onChange:yd.func,onBlur:yd.func,onFocus:yd.func,onReady:yd.func,onEscape:yd.func,onClick:yd.func,onLoadError:yd.func,onLoaderStart:yd.func,onNetworksChange:yd.func,onCheckout:yd.func,onLineItemClick:yd.func,onConfirm:yd.func,onCancel:yd.func,onShippingAddressChange:yd.func,onShippingRateChange:yd.func,options:yd.object},r.displayName=i,r.__elementType=e,r},RU="undefined"==typeof window;DU("auBankAccount",RU),DU("card",RU),DU("cardNumber",RU),DU("cardExpiry",RU),DU("cardCvc",RU),DU("fpxBank",RU),DU("iban",RU),DU("idealBank",RU),DU("p24Bank",RU),DU("epsBank",RU);var zU=DU("payment",RU);DU("expressCheckout",RU),DU("paymentRequestButton",RU);var LU=DU("linkAuthentication",RU);DU("address",RU),DU("shippingAddress",RU),DU("cart",RU),DU("paymentMethodMessaging",RU),DU("affirmMessage",RU),DU("afterpayClearpayMessage",RU);var BU="https://js.stripe.com/v3",NU=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,FU="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",$U=null,jU=function(e){return null!==$U||($U=new Promise((function(t,n){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe&&e&&console.warn(FU),window.Stripe)t(window.Stripe);else try{var i=function(){for(var e=document.querySelectorAll('script[src^="'.concat(BU,'"]')),t=0;t<e.length;t++){var n=e[t];if(NU.test(n.src))return n}return null}();i&&e?console.warn(FU):i||(i=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(BU).concat(t);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n}(e)),i.addEventListener("load",(function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))})),i.addEventListener("error",(function(){n(new Error("Failed to load Stripe.js"))}))}catch(r){return void n(r)}else t(null)}))),$U},VU=Promise.resolve().then((function(){return jU(null)})),UU=!1;VU.catch((function(e){UU||console.warn(e)}));const qU=({deal:e})=>{const t=AU("calls useStripe()").stripe,n=AU("calls useElements()").elements,[i,r]=V.useState(""),[o,s]=V.useState(""),[a,l]=V.useState(!1);return V.useEffect((()=>{if(!t)return;const e=new URLSearchParams(window.location.search).get("payment_intent_client_secret");e&&t.retrievePaymentIntent(e).then((({paymentIntent:e})=>{switch(null==e?void 0:e.status){case"succeeded":s("Payment succeeded!");break;case"processing":s("Your payment is processing.");break;case"requires_payment_method":s("Your payment was not successful, please try again.");break;default:s("Something went wrong.")}}))}),[t]),ee(pw,{style:{margin:0,backgroundColor:"white",padding:10},children:[ee("div",{style:{fontSize:24,marginBottom:10},children:["$",e.price]}),Q(LU,{id:"link-authentication-element",onChange:e=>{var t;return r(null==e||null===(t=e.target)||void 0===t?void 0:t.value)}}),Q(zU,{id:"payment-element",options:{layout:"tabs"}}),Q("div",{style:{paddingTop:10},children:Q(hw,{disabled:a||!t||!n,onClick:async e=>{if(e.preventDefault(),!t||!n)return;l(!0);const{error:i}=await t.confirmPayment({elements:n,confirmParams:{return_url:"https://jamn.io/home"}});"card_error"===i.type||"validation_error"===i.type?s(i.message||""):s("An unexpected error occurred."),l(!1)},children:Q("span",{id:"button-text",children:a?Q("div",{className:"spinner",id:"spinner"}):"PAY NOW"})})}),o&&Q("div",{id:"payment-message",children:o})]})},GU=xD`
  mutation CreatePaymentIntent($price: Int!) {
    createPaymentIntent(price: $price)
  }
`,WU=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];UU=!0;var i=Date.now();return VU.then((function(e){return function(e,t,n){if(null===e)return null;var i=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"1.54.1",startTime:t})}(i,n),i}(e,t,i)}))}("pk_test_51NKshHEepGte6R38JUzw5SLrUnIZpJfotvPkvwfT6VVnMjNkRxzLFPDOJzVP8fFqMjIIOj2iZ29oFBvjSJsQNI3E00ex7nypzU"),HU=({deal:e})=>{const[t,n]=V.useState(""),[i]=zD(GU,{onError:e=>{console.log(e)},onCompleted:e=>{console.log(e),n(e.createPaymentIntent)}});return V.useEffect((()=>{i({variables:{price:100*e.price}})}),[]),t?Q(IU,{options:{clientSecret:t,appearance:{theme:"stripe"}},stripe:WU,children:Q(qU,{deal:e})}):null},ZU=({match:e})=>{const t=nC(BS),n=nC((t=>QT(t,parseInt(e.params.id)))),[i,r]=V.useState("");return V.useEffect((()=>{if(!n)return;const e=uU(n.image.data),t=new Blob([e],{type:"image/jpeg"}),i=URL.createObjectURL(t);return r(i),()=>{URL.revokeObjectURL(i)}}),[null==n?void 0:n.id]),n?Q(Pw,{children:ee(ew,{fullscreen:!0,children:[ee("div",{style:{display:"flex",flexDirection:"row",justifyContent:"start",marginLeft:5,marginTop:5},children:[Q(Q_,{style:{display:"inline-flex",flexDirection:"column",justifyContent:"center"},children:Q(hw,{routerLink:"/deal",style:{},children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M244 400L100 256l144-144M120 256h292' class='ionicon-fill-none'/></svg>"})})}),Q("div",{style:{display:"inline-flex",fontSize:32,fontWeight:"bold",flexDirection:"column",justifyContent:"center"},children:n.name})]}),ee("div",{style:{margin:"auto",maxWidth:420,padding:20,paddingTop:0},children:[Q("img",{src:i,style:{marginTop:15,width:"100%",borderRadius:5}}),Q("h3",{style:{},children:n.detail}),(null==t?void 0:t.id)&&n.quantity>0&&n.vendorId!==(null==t?void 0:t.id)&&Q(HU,{deal:n})]})]})}):null},XU=xD`
  mutation SetUserCam($isCamOn: Boolean!) {
    setUserCam(isCamOn: $isCamOn) {
      id
      isCamOn
    }
  }
`,KU=xD`
  mutation SetUserMic($isMicOn: Boolean!) {
    setUserMic(isMicOn: $isMicOn) {
      id
      isMicOn
    }
  }
`,JU=xD`
  mutation SetUserSound($isSoundOn: Boolean!) {
    setUserSound(isSoundOn: $isSoundOn) {
      id
      isSoundOn
    }
  }
`,YU=()=>{tC();const e=Jw(),t=nC(BS),n=nC(TS),[i,r]=V.useState(0);V.useEffect((()=>{if(null!=t&&t.activeChannelId){r(0);const e=setInterval((()=>{r((e=>e+1))}),1e3);return()=>{clearInterval(e)}}}),[null==t?void 0:t.activeChannelId]);const o=function(){const e=tC(),[t]=zD(XU,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(DS([t.setUserCam]))}});return async function(e){t({variables:{isCamOn:e}})}}(),s=function(){const e=tC(),[t]=zD(KU,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(DS([t.setUserMic]))}});return async function(e){t({variables:{isMicOn:e}})}}(),a=function(){const e=tC(),[t]=zD(JU,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(DS([t.setUserSound]))}});return async function(e){t({variables:{isSoundOn:e}})}}();return Q(nw,{style:{},children:ee("div",{style:{backgroundColor:"var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7))",width:"100%",height:cw("ios")&&!cw("mobileweb")?100:50,display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Q(Q_,{style:{display:"flex",flexDirection:"column",justifyContent:"end",paddingBottom:10},children:Q(hw,{children:Q("img",{src:"/JAMN.png",style:{width:30,height:30,borderRadius:20,backgroundColor:"var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7))"}})})}),Q("div",{style:{display:"flex",flexDirection:"column",justifyContent:"end",paddingBottom:10},children:ee(Q_,{style:{display:"flex",flexDirection:"row"},children:[ee(hw,{onClick:()=>{null!=t&&t.activeChannelId&&t.activeChannelId!==(null==n?void 0:n.id)&&(e.routeInfo.pathname==="/channel/"+t.activeChannelId&&e.routeInfo.pathname==="/map/"+t.activeChannelId||e.push("/map/"+t.activeChannelId,"none"))},style:{display:null!=t&&t.activeChannelId?"block":"none",borderRadius:5,minWidth:60,backgroundColor:"green",color:"var(--ion-color-dark)",marginRight:10},children:[Math.floor(i/60).toString().padStart(2,"0"),":",(i%60).toString().padStart(2,"0")]}),Q(hw,{onClick:()=>{null!=t&&t.id&&o(!t.isCamOn)},style:{display:null!=t&&t.id?"block":"none",color:null!=t&&t.activeChannelId&&null!=t&&t.isCamOn?"green":"var(--ion-color-dark)",marginRight:5},children:null!=t&&t.isCamOn?Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M374.79 308.78L457.5 367a16 16 0 0022.5-14.62V159.62A16 16 0 00457.5 145l-82.71 58.22A16 16 0 00368 216.3v79.4a16 16 0 006.79 13.08z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/><path d='M268 384H84a52.15 52.15 0 01-52-52V180a52.15 52.15 0 0152-52h184.48A51.68 51.68 0 01320 179.52V332a52.15 52.15 0 01-52 52z' stroke-miterlimit='10' class='ionicon-fill-none ionicon-stroke-width'/></svg>"}):Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M374.79 308.78L457.5 367a16 16 0 0022.5-14.62V159.62A16 16 0 00457.5 145l-82.71 58.22A16 16 0 00368 216.3v79.4a16 16 0 006.79 13.08z' class='ionicon-fill-none ionicon-stroke-width'/><path stroke-linecap='round' stroke-miterlimit='10' d='M50.19 140.57A51.94 51.94 0 0032 180v152a52.15 52.15 0 0052 52h184a51.6 51.6 0 0022-4.9M208 128h60.48A51.68 51.68 0 01320 179.52V248M416 416L80 80' class='ionicon-fill-none ionicon-stroke-width'/></svg>"})}),Q(hw,{onClick:()=>{t&&s(!t.isMicOn)},style:{display:null!=t&&t.id?"block":"none",color:null!=t&&t.activeChannelId&&null!=t&&t.isMicOn?"green":"var(--ion-color-dark)",marginRight:3},children:null!=t&&t.isMicOn?Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M192 448h128M384 208v32c0 70.4-57.6 128-128 128h0c-70.4 0-128-57.6-128-128v-32M256 368v80' class='ionicon-fill-none ionicon-stroke-width'/><path d='M256 64a63.68 63.68 0 00-64 64v111c0 35.2 29 65 64 65s64-29 64-65V128c0-36-28-64-64-64z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>"}):Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-miterlimit='10' d='M432 400L96 64' class='ionicon-fill-none ionicon-stroke-width'/><path d='M400 240v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 00368 208v32a111.58 111.58 0 01-2.45 23.31 4.05 4.05 0 001.07 3.69l21.82 21.81a2 2 0 003.29-.72A143.27 143.27 0 00400 240zM256 352a112.36 112.36 0 01-112-112v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 00112 208v32c0 74 56.1 135.12 128 143.11V432h-47.55c-8.61 0-16 6.62-16.43 15.23A16 16 0 00192 464h127.55c8.61 0 16-6.62 16.43-15.23A16 16 0 00320 432h-48v-48.89a143.08 143.08 0 0052-16.22 4 4 0 00.91-6.35L307 342.63a4 4 0 00-4.51-.78A110.78 110.78 0 01256 352zM256 80a47.18 47.18 0 0148 48v74.72a4 4 0 001.17 2.82L332.59 233a2 2 0 003.41-1.42V128.91C336 85 301 48.6 257.14 48a79.66 79.66 0 00-68.47 36.57 4 4 0 00.54 5l19.54 19.54a2 2 0 003.25-.63A47.44 47.44 0 01256 80z'/><path d='M207.27 242.9L179.41 215a2 2 0 00-3.41 1.42V239a80.89 80.89 0 0023.45 56.9 78.55 78.55 0 0077.8 21.19 2 2 0 00.86-3.35l-24.91-24.91a4.08 4.08 0 00-2.42-1.15c-21.65-2.52-39.48-20.44-42.37-42.43a4 4 0 00-1.14-2.35z'/></svg>"})}),Q(hw,{onClick:()=>{t&&a(!t.isSoundOn)},style:{display:null!=t&&t.id?"block":"none",color:null!=t&&t.activeChannelId&&null!=t&&t.isSoundOn?"green":"var(--ion-color-dark)",marginRight:10},children:null!=t&&t.isSoundOn?Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M126 192H56a8 8 0 00-8 8v112a8 8 0 008 8h69.65a15.93 15.93 0 0110.14 3.54l91.47 74.89A8 8 0 00240 392V120a8 8 0 00-12.74-6.43l-91.47 74.89A15 15 0 01126 192zM320 320c9.74-19.38 16-40.84 16-64 0-23.48-6-44.42-16-64M368 368c19.48-33.92 32-64.06 32-112s-12-77.74-32-112M416 416c30-46 48-91.43 48-160s-18-113-48-160' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>"}):Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-miterlimit='10' d='M416 432L64 80' class='ionicon-fill-none ionicon-stroke-width'/><path d='M224 136.92v33.8a4 4 0 001.17 2.82l24 24a4 4 0 006.83-2.82v-74.15a24.53 24.53 0 00-12.67-21.72 23.91 23.91 0 00-25.55 1.83 8.27 8.27 0 00-.66.51l-31.94 26.15a4 4 0 00-.29 5.92l17.05 17.06a4 4 0 005.37.26zM224 375.08l-78.07-63.92a32 32 0 00-20.28-7.16H64v-96h50.72a4 4 0 002.82-6.83l-24-24a4 4 0 00-2.82-1.17H56a24 24 0 00-24 24v112a24 24 0 0024 24h69.76l91.36 74.8a8.27 8.27 0 00.66.51 23.93 23.93 0 0025.85 1.69A24.49 24.49 0 00256 391.45v-50.17a4 4 0 00-1.17-2.82l-24-24a4 4 0 00-6.83 2.82zM125.82 336zM352 256c0-24.56-5.81-47.88-17.75-71.27a16 16 0 00-28.5 14.54C315.34 218.06 320 236.62 320 256q0 4-.31 8.13a8 8 0 002.32 6.25l19.66 19.67a4 4 0 006.75-2A146.89 146.89 0 00352 256zM416 256c0-51.19-13.08-83.89-34.18-120.06a16 16 0 00-27.64 16.12C373.07 184.44 384 211.83 384 256c0 23.83-3.29 42.88-9.37 60.65a8 8 0 001.9 8.26l16.77 16.76a4 4 0 006.52-1.27C410.09 315.88 416 289.91 416 256z'/><path d='M480 256c0-74.26-20.19-121.11-50.51-168.61a16 16 0 10-27 17.22C429.82 147.38 448 189.5 448 256c0 47.45-8.9 82.12-23.59 113a4 4 0 00.77 4.55L443 391.39a4 4 0 006.4-1C470.88 348.22 480 307 480 256z'/></svg>"})}),Q(hw,{id:"auth-modal-button",style:{display:null!=t&&t.id?"none":"block"},children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M258.9 48C141.92 46.42 46.42 141.92 48 258.9c1.56 112.19 92.91 203.54 205.1 205.1 117 1.6 212.48-93.9 210.88-210.88C462.44 140.91 371.09 49.56 258.9 48zm126.42 327.25a4 4 0 01-6.14-.32 124.27 124.27 0 00-32.35-29.59C321.37 329 289.11 320 256 320s-65.37 9-90.83 25.34a124.24 124.24 0 00-32.35 29.58 4 4 0 01-6.14.32A175.32 175.32 0 0180 259c-1.63-97.31 78.22-178.76 175.57-179S432 158.81 432 256a175.32 175.32 0 01-46.68 119.25z'/><path d='M256 144c-19.72 0-37.55 7.39-50.22 20.82s-19 32-17.57 51.93C191.11 256 221.52 288 256 288s64.83-32 67.79-71.24c1.48-19.74-4.8-38.14-17.68-51.82C293.39 151.44 275.59 144 256 144z'/></svg>"})}),Q(hw,{id:"account-modal-button",style:{display:null!=t&&t.id?"block":"none"},children:Q(Y_,{style:{width:30,height:30,cursor:"pointer"},children:Q("img",{src:`https://www.gravatar.com/avatar/${yR((null==t?void 0:t.email)||"")}?d=retro`})})})]})})]})})},QU=xD`
  mutation Refresh($refreshToken: String!) {
    refresh(refreshToken: $refreshToken) {
      user {
        ...UserFields
      }
      accessToken
    }
  }
  ${FD}
`;function eq(){const e=tC(),t=nC(HT),[n]=zD(QU,{onError:n=>{console.log(n),t&&clearInterval(t),e(GT(!0)),e(qT(null)),e(RS(null))},onCompleted:t=>{console.log(t),e(GT(!0)),e(DS([t.refresh.user])),e(RS(t.refresh.user.id)),tR.set({key:rR,value:t.refresh.accessToken})}}),i=async()=>{const{value:t}=await tR.get({key:oR});t?n({variables:{refreshToken:t}}):(e(GT(!0)),e(qT(null)),e(RS(null)))};return{refreshToken:i,refreshTokenInterval:()=>{const t=setInterval(i,24e4);e(qT(t))}}}const tq=xD`
  mutation GoogleAuth($credential: String!, $ios: Boolean!) {
    googleAuth(credential: $credential, ios: $ios) {
      user {
        ...UserFields
      }
      accessToken
      refreshToken
    }
  }
  ${FD}
`;var nq={exports:{}};!function(e,t){e.exports=function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(4)},function(e,t,n){e.exports=n(6)()},function(t,n){t.exports=e},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return decodeURIComponent(e.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(t).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}},function(e,t,n){function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=i(n(2)),u=i(n(1)),d=i(n(5)),h=i(n(3)),p=function(){var e=!1;try{e=!!(window.navigator&&window.navigator.standalone||navigator.userAgent.match("CriOS")||navigator.userAgent.match(/mobile/i))}catch(t){}return e},f=function(e){function t(){var e,n,i;r(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return n=i=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),i.state={isSdkLoaded:!1,isProcessing:!1},i.responseApi=function(e){window.FB.api("/me",{locale:i.props.language,fields:i.props.fields},(function(t){a(t,e),i.props.callback(t)}))},i.checkLoginState=function(e){i.setStateIfMounted({isProcessing:!1}),e.authResponse?i.responseApi(e.authResponse):i.props.onFailure?i.props.onFailure({status:e.status}):i.props.callback({status:e.status})},i.checkLoginAfterRefresh=function(e){"connected"===e.status?i.checkLoginState(e):window.FB.login((function(e){return i.checkLoginState(e)}),!0)},i.click=function(e){if(i.state.isSdkLoaded&&!i.state.isProcessing&&!i.props.isDisabled){i.setState({isProcessing:!0});var t=i.props,n=t.scope,r=t.appId,o=t.onClick,s=t.returnScopes,a=t.responseType,l=t.redirectUri,c=t.disableMobileRedirect,u=t.authType,h=t.state;if("function"!=typeof o||(o(e),!e.defaultPrevented)){var p={client_id:r,redirect_uri:l,state:h,return_scopes:s,scope:n,response_type:a,auth_type:u};if(i.props.isMobile&&!c)window.location.href="https://www.facebook.com/dialog/oauth"+(0,d.default)(p);else{if(!window.FB)return void(i.props.onFailure&&i.props.onFailure({status:"facebookNotLoaded"}));window.FB.login(i.checkLoginState,{scope:n,return_scopes:s,auth_type:p.auth_type})}}}},o(i,n)}return s(t,e),l(t,[{key:"componentDidMount",value:function(){if(this._isMounted=!0,document.getElementById("facebook-jssdk"))this.sdkLoaded();else{this.setFbAsyncInit(),this.loadSdkAsynchronously();var e=document.getElementById("fb-root");e||((e=document.createElement("div")).id="fb-root",document.body.appendChild(e))}}},{key:"componentWillReceiveProps",value:function(e){this.state.isSdkLoaded&&e.autoLoad&&!this.props.autoLoad&&window.FB.getLoginStatus(this.checkLoginAfterRefresh)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"setStateIfMounted",value:function(e){this._isMounted&&this.setState(e)}},{key:"setFbAsyncInit",value:function(){var e=this,t=this.props,n=t.appId,i=t.xfbml,r=t.cookie,o=t.version,s=t.autoLoad;window.fbAsyncInit=function(){window.FB.init({version:"v"+o,appId:n,xfbml:i,cookie:r}),e.setStateIfMounted({isSdkLoaded:!0}),(s||e.isRedirectedFromFb())&&window.FB.getLoginStatus(e.checkLoginAfterRefresh)}}},{key:"isRedirectedFromFb",value:function(){var e=window.location.search;return(0,h.default)(e,"code")||(0,h.default)(e,"granted_scopes")}},{key:"sdkLoaded",value:function(){this.setState({isSdkLoaded:!0})}},{key:"loadSdkAsynchronously",value:function(){var e=this.props.language;!function(t,n,i){var r=t.getElementsByTagName(n)[0],o=r,s=r;t.getElementById(i)||((s=t.createElement(n)).id=i,s.src="https://connect.facebook.net/"+e+"/sdk.js",o.parentNode.insertBefore(s,o))}(document,"script","facebook-jssdk")}},{key:"render",value:function(){var e=this.props.render;if(!e)throw new Error("ReactFacebookLogin requires a render prop to render");var t={onClick:this.click,isDisabled:!!this.props.isDisabled,isProcessing:this.state.isProcessing,isSdkLoaded:this.state.isSdkLoaded};return this.props.render(t)}}]),t}(c.default.Component);f.propTypes={isDisabled:u.default.bool,callback:u.default.func.isRequired,appId:u.default.string.isRequired,xfbml:u.default.bool,cookie:u.default.bool,authType:u.default.string,scope:u.default.string,state:u.default.string,responseType:u.default.string,returnScopes:u.default.bool,redirectUri:u.default.string,autoLoad:u.default.bool,disableMobileRedirect:u.default.bool,isMobile:u.default.bool,fields:u.default.string,version:u.default.string,language:u.default.string,onClick:u.default.func,onFailure:u.default.func,render:u.default.func.isRequired},f.defaultProps={redirectUri:"undefined"!=typeof window?window.location.href:"/",scope:"public_profile,email",returnScopes:!1,xfbml:!1,cookie:!1,authType:"",fields:"name",version:"2.3",language:"en_US",disableMobileRedirect:!1,isMobile:p(),onFailure:null,state:"facebookdirect",responseType:"code"},t.default=f},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"?"+Object.keys(e).map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")}},function(e,t,n){function i(){}var r=n(7);e.exports=function(){function e(e,t,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=i,n.PropTypes=n,n}},function(e,t){var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";e.exports=n}])}(V)}(nq);const iq=r(nq.exports),rq=xD`
  mutation FacebookAuth($credential: String!) {
    facebookAuth(credential: $credential) {
      user {
        ...UserFields
      }
      accessToken
      refreshToken
    }
  }
  ${FD}
`,oq=xD`
  mutation emailLogin($email: String!) {
    emailLogin(email: $email) {
      ...UserFields
    }
  }
  ${FD}
`,sq=ZD("GoogleAuth",{web:()=>ep((()=>t.import("./web-legacy-5208064d.js"))).then((e=>new e.GoogleAuthWeb))}),aq=({setPendingUser:e})=>{const[t,n]=V.useState(""),[i,r]=V.useState(!1),[o,s]=V.useState(!1),{authModal:a}=V.useContext(pW);V.useEffect((()=>{const e=cw("ios")&&!cw("mobileweb")?"752107153785-5tggr0pc3t5ll8vddlppkk37k83ln5j5.apps.googleusercontent.com":"752107153785-ii093j9qoppa2kvcifo1doqmogg0b4m3.apps.googleusercontent.com";sq.initialize({clientId:e,scopes:["email"]})}),[]);const l=(()=>{const e=tC(),{authModal:t}=V.useContext(pW),{refreshTokenInterval:n}=eq(),[i]=zD(tq,{onError:e=>{console.error(e)},onCompleted:async i=>{var r;console.log(i),i.googleAuth.user.id&&(null===(r=t.current)||void 0===r||r.dismiss(),e(DS([i.googleAuth.user])),e(RS(i.googleAuth.user.id)),await tR.set({key:rR,value:i.googleAuth.accessToken}),await tR.set({key:oR,value:i.googleAuth.refreshToken}),n())}});return e=>{e&&i({variables:{credential:e,ios:cw("ios")&&!cw("mobileweb")}})}})(),c=(()=>{const e=tC(),{authModal:t}=V.useContext(pW),{refreshTokenInterval:n}=eq(),[i]=zD(rq,{onError:e=>{console.error(e)},onCompleted:async i=>{var r;console.log(i),i.facebookAuth.user.id&&(null===(r=t.current)||void 0===r||r.dismiss(),e(DS([i.facebookAuth.user])),e(RS(i.facebookAuth.user.id)),await tR.set({key:rR,value:i.facebookAuth.accessToken}),await tR.set({key:oR,value:i.facebookAuth.refreshToken}),n())}});return async e=>{e&&await i({variables:{credential:e}})}})(),u=(e=>{const[t]=zD(oq,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(t.emailLogin)}});return e=>{t({variables:{email:e}})}})((t=>{s(!1),null!=t&&t.id&&(n(""),e(t))}));return ee(ew,{children:[ee("div",{style:{},children:[Q("div",{style:{textAlign:"center"},children:"Choose your preferred login method:"}),Q("div",{style:{marginBottom:20,paddingTop:20,display:"flex",flexDirection:"column",justifyContent:"center"},children:ee("div",{style:{paddingLeft:10,border:"1px solid",borderRadius:5,margin:"auto",width:250,display:"flex"},children:[Q(iw,{type:"email",placeholder:"email@domain.com",clearInput:!0,onIonInput:e=>{const t=e.target.value;n(t),/\S+@\S+\.\S+/.test(t)?r(!0):r(!1)},value:t}),Q(Q_,{children:Q(hw,{disabled:!i||o,onClick:()=>{s(!0);const e=t.trim();u(e)},children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M476.59 227.05l-.16-.07L49.35 49.84A23.56 23.56 0 0027.14 52 24.65 24.65 0 0016 72.59v113.29a24 24 0 0019.52 23.57l232.93 43.07a4 4 0 010 7.86L35.53 303.45A24 24 0 0016 327v113.31A23.57 23.57 0 0026.59 460a23.94 23.94 0 0013.22 4 24.55 24.55 0 009.52-1.93L476.4 285.94l.19-.09a32 32 0 000-58.8z'/></svg>",size:"small"})})})]})}),Q("div",{style:{display:"flex",justifyContent:"center"},children:Q(Q_,{children:ee(hw,{style:{width:250,height:50,backgroundColor:"dimgrey",color:"white",borderRadius:5,fontWeight:"bold",fontSize:16},onClick:()=>{sq.signIn().then((e=>{console.log(e),l(e.authentication.idToken)})).catch((e=>{console.log(e)}))},children:[Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M473.16 221.48l-2.26-9.59H262.46v88.22H387c-12.93 61.4-72.93 93.72-121.94 93.72-35.66 0-73.25-15-98.13-39.11a140.08 140.08 0 01-41.8-98.88c0-37.16 16.7-74.33 41-98.78s61-38.13 97.49-38.13c41.79 0 71.74 22.19 82.94 32.31l62.69-62.36C390.86 72.72 340.34 32 261.6 32c-60.75 0-119 23.27-161.58 65.71C58 139.5 36.25 199.93 36.25 256s20.58 113.48 61.3 155.6c43.51 44.92 105.13 68.4 168.58 68.4 57.73 0 112.45-22.62 151.45-63.66 38.34-40.4 58.17-96.3 58.17-154.9 0-24.67-2.48-39.32-2.59-39.96z'/></svg>"})," GOOGLE"]})})}),Q("div",{style:{display:"flex",justifyContent:"center",padding:20},children:Q(iq,{appId:"1483086142451421",autoLoad:!1,fields:"name,email,picture",scope:"public_profile, email",textButton:"Facebook",disableMobileRedirect:!0,onClick:()=>{},callback:e=>{console.log(e),c(e.accessToken)},render:e=>Q(Q_,{children:ee(hw,{style:{width:250,height:50,backgroundColor:"steelblue",color:"white",borderRadius:5,fontWeight:"bold",fontSize:16},onClick:e.onClick,children:[Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M480 257.35c0-123.7-100.3-224-224-224s-224 100.3-224 224c0 111.8 81.9 204.47 189 221.29V322.12h-56.89v-64.77H221V208c0-56.13 33.45-87.16 84.61-87.16 24.51 0 50.15 4.38 50.15 4.38v55.13H327.5c-27.81 0-36.51 17.26-36.51 35v42h62.12l-9.92 64.77H291v156.54c107.1-16.81 189-109.48 189-221.31z' fill-rule='evenodd'/></svg>"})," FACEBOOK"]})})})})]}),Q(Q_,{style:{margin:20},children:Q(hw,{onClick:()=>{var e;null===(e=a.current)||void 0===e||e.dismiss()},style:{border:"1px solid",borderRadius:5,fontSize:20,fontWeight:"bold",height:40},children:Q("span",{style:{padding:10},children:"BACK"})})})]})},lq=xD`
  mutation Verify($id: Int!, $code: String!) {
    verify(id: $id, code: $code) {
      user {
        ...UserFields
      }
      accessToken
      refreshToken
    }
  }
  ${FD}
`,cq=xD`
  mutation Resend($phone: String, $email: String) {
    resend(phone: $phone, email: $email) {
      ...UserFields
    }
  }
  ${FD}
`,uq=({pendingUser:e,setPendingUser:t})=>{const[n,i]=V.useState(""),[r,o]=V.useState(!1),s=((e,t)=>{const n=tC(),{authModal:i}=V.useContext(pW),{refreshTokenInterval:r}=eq(),[o]=zD(lq,{onError:t=>{console.log(t),e(t)},onCompleted:async e=>{var o;console.log(e),e.verify.user.id&&(null===(o=i.current)||void 0===o||o.dismiss(),n(DS([e.verify.user])),n(RS(e.verify.user.id)),await tR.set({key:rR,value:e.verify.accessToken}),await tR.set({key:oR,value:e.verify.refreshToken}),r()),t(e.verify.user)}});return(e,t)=>{o({variables:{id:e,code:t}})}})((e=>{"Invalid verification code"===e.message&&o(!0)}),(e=>{null!=e&&e.id&&t(null)})),[a,l]=V.useState(!1),[c]=zD(cq,{onError:e=>{console.log(e)},onCompleted:e=>{console.log(e),e.resend.id&&(l(!0),setTimeout((()=>{l(!1)}),3e3))}});return Q(ew,{children:ee("div",{children:[ee("div",{style:{margin:30},children:["A ",Q("b",{children:"verification code"})," has been ",e.email?"emailed":"texted"," to"]}),ee("div",{style:{margin:30,fontWeight:"bold",fontSize:24},children:[e.email?e.email:null,e.phone?ee("div",{children:["+1 ",e.phone.slice(0,3)," ",e.phone.slice(3,6)," ",e.phone.slice(-4)]}):null]}),Q("div",{style:{margin:30},children:"Enter this code to login."}),Q("div",{style:{margin:30,paddingLeft:10,paddingRight:10,border:"1px solid",borderRadius:5,marginTop:30,width:160},children:Q(iw,{type:"number",placeholder:"123456",onIonInput:e=>{const t=e.target.value;i(t),o(!1)},value:n,style:{fontSize:24}})}),ee(Q_,{style:{margin:30,display:"flex",flexDirection:"column",alignItems:"start"},children:[Q(hw,{disabled:6!==n.length,onClick:()=>{const t=n.replace(/[^0-9]/g,"").trim();s(e.id,t)},style:{border:"1px solid",borderRadius:5,fontSize:24,fontWeight:"bold",height:50,marginBottom:10},children:r?"INVALID CODE...":"LOGIN"}),Q(hw,{disabled:a,onClick:()=>{c({variables:{phone:e.phone,email:e.email}})},style:{border:"1px solid",borderRadius:5,fontSize:24,fontWeight:"bold",height:50,marginBottom:10},children:a?"CODE SENT...":"RESEND CODE"}),Q(hw,{onClick:()=>{t(null)},style:{border:"1px solid",borderRadius:5,fontSize:24,fontWeight:"bold",height:50},children:"BACK"})]})]})})},dq=()=>{const{authModal:e}=V.useContext(pW),t=nC(BS),n=nC(ZT),{refreshToken:i,refreshTokenInterval:r}=eq(),[o,s]=V.useState(null);return V.useEffect((()=>{n?t&&r():(console.log("initializing"),i())}),[n]),ee(bw,{trigger:"auth-modal-button",ref:e,children:[Q("div",{style:{fontWeight:"bold",fontSize:40,padding:20,paddingTop:cw("ios")&&!cw("mobileweb")?70:20,color:"inherit"},children:"LOG IN"}),o?Q(uq,{pendingUser:o,setPendingUser:s}):Q(aq,{setPendingUser:s})]})},hq=xD`
  mutation Logout {
    logout
  }
`,pq=xD`
  mutation ChangeName($name: String!) {
    changeName(name: $name) {
      ...UserFields
    }
  }
  ${FD}
`,fq=()=>{var e;const t=tC(),n=nC(BS),i=nC(HT),[r,o]=V.useState(!1),[s,a]=V.useState(!1),[l,c]=V.useState((null==n?void 0:n.name)||""),u=(()=>{const e=tC(),[t]=zD(pq,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(DS([t.changeName]))}});return e=>{t({variables:{name:e}})}})(),d=(()=>{const[e]=zD(hq,{onError:e=>{console.log(e)},onCompleted:e=>{console.log(e)}});return()=>{e()}})(),h=V.useRef(null);return ee(bw,{ref:h,trigger:"account-modal-button",children:[Q(nw,{style:{margin:20,fontWeight:"bold",fontSize:40,marginTop:cw("ios")&&!cw("mobileweb")?70:20},children:"MY ACCOUNT"}),ee(ew,{children:[ee("div",{style:{margin:20,fontSize:24,fontWeight:"bold",display:"flex",flexDirection:"row",justifyContent:"start"},children:["PROFILE ",ee(Q_,{style:{},children:[Q(hw,{onClick:()=>{n&&(c(n.name),o(!0))},style:{border:"1px solid",borderRadius:5,display:r?"none":"block"},children:"EDIT"}),Q(hw,{onClick:()=>{console.log("handleProfileSave",l),u(l),o(!1)},style:{border:"1px solid",borderRadius:5,display:r?"block":"none"},children:"SAVE"}),Q(hw,{onClick:()=>o(!1),style:{border:"1px solid",borderRadius:5,display:r?"block":"none"},children:"CANCEL"})]})]}),ee("div",{style:{marginLeft:30,display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[ee("div",{style:{display:"flex",flexDirection:"row"},children:[Q("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:Q(Y_,{children:Q("img",{style:{width:48,height:48,borderRadius:24},src:`https://www.gravatar.com/avatar/${yR(null!==(e=null==n?void 0:n.email)&&void 0!==e?e:"")}?d=retro`})})}),Q("div",{style:{marginLeft:20,display:r?"none":"flex",flexDirection:"column",justifyContent:"center",fontSize:22},children:null==n?void 0:n.name}),Q("div",{style:{display:r?"flex":"none",marginLeft:10,border:"1px solid",borderRadius:5,paddingLeft:10},children:Q(iw,{value:l,clearInput:!0,style:{display:r?"flex":"none",fontSize:22},onIonInput:e=>c(e.detail.value||"")})})]}),Q("div",{})]}),ee("div",{style:{margin:20,marginTop:60,fontSize:24,fontWeight:"bold",display:"flex",flexDirection:"row",justifyContent:"start"},children:["CREDENTIALS ",Q(Q_,{style:{},children:Q(hw,{onClick:()=>a(!0),style:{border:"1px solid",borderRadius:5,display:s?"none":"block"},children:"EDIT"})})]}),ee("div",{style:{display:"flex"},children:[Q("div",{style:{marginLeft:30,width:80,fontWeight:"bold"},children:"EMAIL"}),Q("div",{children:null==n?void 0:n.email})]}),ee("div",{style:{marginTop:20,display:"flex"},children:[Q("div",{style:{marginLeft:30,width:80,fontWeight:"bold"},children:"PHONE"}),Q("div",{children:null==n?void 0:n.phone})]}),ee(Q_,{style:{display:"flex",flexDirection:"column",alignItems:"start",margin:20,marginTop:60},children:[Q(hw,{onClick:async()=>{var e;null===(e=h.current)||void 0===e||e.dismiss(),d(),i&&(clearInterval(i),t(qT(null))),await tR.remove({key:rR}),await tR.remove({key:oR}),t(RS(null))},style:{fontWeight:"bold",fontSize:24,border:"1px solid",borderRadius:5,height:50},children:"LOGOUT"}),Q(hw,{onClick:()=>{var e;null===(e=h.current)||void 0===e||e.dismiss()},style:{fontWeight:"bold",fontSize:24,border:"1px solid",borderRadius:5,height:50,marginTop:10},children:"BACK"})]})]})]})};var mq,gq;!function(e){e.Documents="DOCUMENTS",e.Data="DATA",e.Library="LIBRARY",e.Cache="CACHE",e.External="EXTERNAL",e.ExternalStorage="EXTERNAL_STORAGE"}(mq||(mq={})),e("E",gq),function(e){e.UTF8="utf8",e.ASCII="ascii",e.UTF16="utf16"}(gq||e("E",gq={}));const yq=ZD("Filesystem",{web:()=>ep((()=>t.import("./web-legacy-8d9f75a1.js"))).then((e=>new e.FilesystemWeb))});var vq,bq,xq;e("C",vq),function(e){e.Prompt="PROMPT",e.Camera="CAMERA",e.Photos="PHOTOS"}(vq||e("C",vq={})),e("o",bq),function(e){e.Rear="REAR",e.Front="FRONT"}(bq||e("o",bq={})),function(e){e.Uri="uri",e.Base64="base64",e.DataUrl="dataUrl"}(xq||(xq={}));const _q=ZD("Camera",{web:()=>ep((()=>t.import("./web-legacy-0dd5187c.js"))).then((e=>new e.CameraWeb))});function wq(){const e=async(e,t)=>{let n;n=cw("hybrid")?(await yq.readFile({path:e.path})).data:await async function(e){const t=await fetch(e),n=await t.blob();return new Promise(((e,t)=>{const i=new FileReader;i.onerror=t,i.onload=()=>{"string"==typeof i.result?e(i.result):t("method did not return a string")},i.readAsDataURL(n)}))}(e.webPath);const i=await yq.writeFile({path:t,data:n,directory:mq.Data});return cw("hybrid")?{filepath:i.uri,webviewPath:HD.convertFileSrc(i.uri)}:{filepath:t,webviewPath:e.webPath}},[t,n]=V.useState();return{photo:t,takePhoto:async()=>{const t=await _q.getPhoto({resultType:xq.Uri,source:vq.Camera,quality:100}),i=(new Date).getTime()+".jpeg",r=await e(t,i);n(r),tR.set({key:"photos",value:JSON.stringify(r)})}}}const kq=()=>{const e=Jw(),[t,n]=V.useState(""),[i,r]=V.useState(""),[o,s]=V.useState(0),[a,l]=V.useState(0),{photo:c,takePhoto:u}=wq();return Q(Pw,{children:Q(ew,{fullscreen:!0,children:ee("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:[Q(nw,{style:{margin:20,alignItems:"center"},children:Q("h1",{children:"CREATE A DEAL"})}),ee("div",{style:{margin:20,marginTop:0,maxWidth:420},children:[ee(mw,{style:{display:"flex",justifyContent:"space-between"},children:[Q(rw,{children:"Photo: "}),Q(Q_,{children:Q(hw,{onClick:()=>u(),children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M350.54 148.68l-26.62-42.06C318.31 100.08 310.62 96 302 96h-92c-8.62 0-16.31 4.08-21.92 10.62l-26.62 42.06C155.85 155.23 148.62 160 140 160H80a32 32 0 00-32 32v192a32 32 0 0032 32h352a32 32 0 0032-32V192a32 32 0 00-32-32h-59c-8.65 0-16.85-4.77-22.46-11.32z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/><circle cx='256' cy='272' r='80' stroke-miterlimit='10' class='ionicon-fill-none ionicon-stroke-width'/><path stroke-linecap='round' stroke-linejoin='round' d='M124 158v-22h-24v22' class='ionicon-fill-none ionicon-stroke-width'/></svg>"})})})]}),Q(mw,{style:{display:c?"flex":"none"},children:c&&Q("img",{src:c.webviewPath,style:{borderRadius:5}})}),ee(mw,{style:{display:"flex"},children:[Q(rw,{children:"Name: "}),Q(iw,{type:"text",value:t,onIonChange:e=>n(e.target.value)})]}),ee(mw,{style:{display:"flex"},children:[Q(rw,{children:"Detail: "}),Q(iw,{type:"text",value:i,onIonChange:e=>r(e.target.value)})]}),ee(mw,{style:{display:"flex"},children:[Q(rw,{children:"Quantity: "}),Q(iw,{type:"number",value:o,onIonChange:e=>s(e.target.value)})]}),ee(mw,{style:{display:"flex"},children:[Q(rw,{children:"Price: "}),Q(iw,{type:"number",placeholder:"Price",value:a,onIonChange:e=>l(e.target.value)})]}),ee(Q_,{style:{marginTop:20,display:"flex",flexDirection:"column",alignItems:"start"},children:[Q(hw,{onClick:async()=>{if(!c)return;const n=uU((await yq.readFile({path:c.filepath,directory:mq.Data})).data),r=new Blob([n],{type:"image/jpeg"}),s=new FormData;s.append("file",r),s.append("name",t),s.append("detail",i),s.append("quantity",o.toString()),s.append("price",a.toString());const l=await tR.get({key:rR});fetch(nR+"/deals/add-deal",{method:"POST",body:s,headers:{accesstoken:l.value||""}}).then((t=>{console.log(t),e.push("/deal")})).catch((e=>{console.error(e)}))},style:{border:"1px solid",borderRadius:5,height:50,fontWeight:"bold",fontSize:24},children:"SUBMIT"}),Q(hw,{routerLink:"/deal",style:{marginTop:10,border:"1px solid",borderRadius:5,height:50,fontWeight:"bold",fontSize:24},children:"BACK"})]})]})]})})})},Eq=xD`
  mutation GetChannel($id: Int!) {
    getChannel(id: $id) {
      ...ChannelFields
    }
  }
  ${BD}
`,Sq=({match:e})=>{var t,n,i;const r=Jw(),o=tC(),{authModal:s,streams:a,channelMode:l,setChannelMode:c}=V.useContext(pW),u=nC(BS),d=nC(TS),h=nC((e=>{var t,n;return bS(e,null!==(t=null==d?void 0:d.id)&&void 0!==t?t:-1,null!==(n=null==u?void 0:u.id)&&void 0!==n?n:-1)})),[p,f]=V.useState(!1),m=oU(),[g]=zD(Eq,{onError:e=>{console.log(e)},onCompleted:({getChannel:e})=>{console.log(e),o(_S([e])),f(!0)}});V.useEffect((()=>{console.log(e.params.id),(null==d?void 0:d.id)===parseInt(e.params.id)?f(!0):(g({variables:{id:parseInt(e.params.id)}}),o(wS(parseInt(e.params.id))))}),[e.params.id]);const y=V.useRef(null);return V.useEffect((()=>{var e;console.log(null===(e=y.current)||void 0===e?void 0:e.clientHeight)}),[null===(t=y.current)||void 0===t?void 0:t.clientHeight]),p?null!=d&&d.id?ee(Pw,{children:[Q("div",{style:{height:cw("ios")&&!cw("mobileweb")?105:50}}),ee(ew,{style:{overflowY:"hidden"},children:[ee("div",{ref:y,children:[ee("div",{style:{fontSize:24,padding:10,fontWeight:"bold",display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Q("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:null==d?void 0:d.name}),ee(Q_,{style:{},children:[Q(hw,{onClick:()=>{null!=h&&h.id&&m(h.id,!h.isSaved)},children:Q(Hw,{icon:null!=h&&h.isSaved||null!=h&&h.isOwner?vk:bk,size:"small",style:{color:null!=h&&h.isSaved||null!=h&&h.isOwner?"var(--ion-color-primary)":null}})}),Q(hw,{onClick:()=>{r.push("/map/"+(null==d?void 0:d.id),"none")},children:Q(Hw,{icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M336 448h56a56 56 0 0056-56v-56M448 176v-56a56 56 0 00-56-56h-56M176 448h-56a56 56 0 01-56-56v-56M64 176v-56a56 56 0 0156-56h56' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",size:"small"})}),Q(hw,{onClick:()=>{r.push("/map","none")},children:Q(Hw,{icon:yk,size:"small"})})]})]}),Q("div",{style:{padding:10,textAlign:"left",fontSize:14,color:"var(--ion-color-medium)"},children:null==d?void 0:d.detail}),ee(Q_,{style:{marginTop:5,display:"flex",flexDirection:"row",justifyContent:"center"},children:[Q(hw,{onClick:()=>c("talk"),style:{color:"talk"===l?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:"talk"===l?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TALK"}),Q(hw,{onClick:()=>c("text"),style:{color:"text"===l?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:"text"===l?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TEXT"}),Q(hw,{onClick:()=>c("roam"),style:{color:"roam"===l?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:"roam"===l?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"ROAM"})]})]}),Q("div",{style:{paddingTop:10,height:`calc(100% - ${null!==(n=null===(i=y.current)||void 0===i?void 0:i.clientHeight)&&void 0!==n?n:0}px)`},children:"talk"===l?Q(bR,{authModal:s,streams:a}):"text"===l?Q(nU,{}):"roam"===l?Q(iU,{}):null})]})]}):Q(Pw,{children:Q(ew,{fullscreen:!0,children:Q("div",{style:{display:"flex",flexDirection:"column",marginLeft:5,marginTop:cw("ios")&&!cw("mobileweb")?105:50},children:Q("div",{style:{display:"inline-flex",fontSize:32,fontWeight:"bold",flexDirection:"column",justifyContent:"center"},children:"NOT FOUND..."})})})}):Q(Pw,{children:Q(ew,{fullscreen:!0,children:Q("div",{style:{display:"flex",flexDirection:"column",marginLeft:5,marginTop:cw("ios")&&!cw("mobileweb")?105:50},children:Q("div",{style:{display:"flex",fontSize:32,fontWeight:"bold",flexDirection:"column",justifyContent:"center"},children:"LOADING..."})})})})};Cq.sessions=new Map,Cq.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){let e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||Cq.extension.isInstalled()}return!0};var Tq={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){let t=window.setTimeout((function(){let t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){let e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){let n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){let e=new Error("NavigatorUserMediaError");e.name="You cancelled the request for permission, giving up...",n(e)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&window.clearTimeout(t.data.id)}))}};function Cq(e){if((e=e||{}).success="function"==typeof e.success?e.success:Cq.noop,e.error="function"==typeof e.error?e.error:Cq.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:Cq.noop,!Cq.initDone)return e.error("Library not initialized"),{};if(!Cq.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(Cq.log("Library initialized: "+Cq.initDone),!e.server)return e.error("Invalid server url"),{};let t=!1,n=null,i={},r=null,o=null,s=0,a=e.server;Cq.isArray(a)?(Cq.log("Multiple servers provided ("+a.length+"), will use the first that works"),a=null,o=e.server,Cq.debug(o)):0===a.indexOf("ws")?(t=!0,Cq.log("Using WebSockets to contact Janus: "+a)):(t=!1,Cq.log("Using REST API to contact Janus: "+a));let l=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],c=e.iceTransportPolicy,u=e.bundlePolicy,d=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(d=!0===e.withCredentials);let h=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(h=e.max_poll_events),h<1&&(h=1);let p=null;void 0!==e.token&&null!==e.token&&(p=e.token);let f=null;void 0!==e.apisecret&&null!==e.apisecret&&(f=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);let m=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(m=e.keepAlivePeriod),isNaN(m)&&(m=25e3);let g=6e4;function y(e){let t={high:9e5,medium:3e5,low:1e5};return null!=e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(g=e.longPollTimeout),isNaN(g)&&(g=6e4);let v=!1,b=null,x=new Map,_=this,w=0,k=new Map;function E(){if(null==b)return;if(Cq.debug("Long poll..."),!v)return void Cq.warn("Is the server down? (connected=false)");let t=a+"/"+b+"?rid="+(new Date).getTime();h&&(t=t+"&maxev="+h),p&&(t=t+"&token="+encodeURIComponent(p)),f&&(t=t+"&apisecret="+encodeURIComponent(f)),Cq.httpAPICall(t,{verb:"GET",withCredentials:d,success:S,timeout:g,error:function(t,n){if(Cq.error(t+":",n),w++,w>3)return v=!1,void e.error("Lost connection to the server (is it down?)");E()}})}function S(e,i){if(w=0,t||null==b||!0===i||E(),t||!Cq.isArray(e))if("keepalive"!==e.janus)if("server_info"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus){const t=e.sender;if(!t)return void Cq.warn("Missing sender...");const n=x.get(t);if(!n)return void Cq.debug("This handle is not attached to this session");let i=e.candidate;Cq.debug("Got a trickled candidate on session "+b),Cq.debug(i);let r=n.webrtcStuff;r.pc&&r.remoteSdp?(Cq.debug("Adding remote candidate:",i),i&&!0!==i.completed?r.pc.addIceCandidate(i):r.pc.addIceCandidate(Cq.endOfCandidates)):(Cq.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),r.candidates||(r.candidates=[]),r.candidates.push(i),Cq.debug(r.candidates))}else{if("webrtcup"===e.janus){Cq.debug("Got a webrtcup event on session "+b),Cq.debug(e);const t=e.sender;if(!t)return void Cq.warn("Missing sender...");const n=x.get(t);return n?void n.webrtcState(!0):void Cq.debug("This handle is not attached to this session")}if("hangup"===e.janus){Cq.debug("Got a hangup event on session "+b),Cq.debug(e);const t=e.sender;if(!t)return void Cq.warn("Missing sender...");const n=x.get(t);if(!n)return void Cq.debug("This handle is not attached to this session");n.webrtcState(!1,e.reason),n.hangup()}else if("detached"===e.janus){Cq.debug("Got a detached event on session "+b),Cq.debug(e);const t=e.sender;if(!t)return void Cq.warn("Missing sender...");const n=x.get(t);if(!n)return;n.ondetached(),n.detach()}else if("media"===e.janus){Cq.debug("Got a media event on session "+b),Cq.debug(e);const t=e.sender;if(!t)return void Cq.warn("Missing sender...");const n=x.get(t);if(!n)return void Cq.debug("This handle is not attached to this session");n.mediaState(e.type,e.receiving,e.mid)}else if("slowlink"===e.janus){Cq.debug("Got a slowlink event on session "+b),Cq.debug(e);const t=e.sender;if(!t)return void Cq.warn("Missing sender...");const n=x.get(t);if(!n)return void Cq.debug("This handle is not attached to this session");n.slowLink(e.uplink,e.lost,e.mid)}else{if("error"===e.janus){Cq.error("Ooops: "+e.error.code+" "+e.error.reason),Cq.debug(e);let t=e.transaction;if(t){let n=k.get(t);n&&n(e),k.delete(t)}return}if("event"===e.janus){Cq.debug("Got a plugin event on session "+b),Cq.debug(e);const t=e.sender;if(!t)return void Cq.warn("Missing sender...");let n=e.plugindata;if(!n)return void Cq.warn("Missing plugindata...");Cq.debug("  -- Event is coming from "+t+" ("+n.plugin+")");let i=n.data;Cq.debug(i);const r=x.get(t);if(!r)return void Cq.warn("This handle is not attached to this session");let o=e.jsep;o&&(Cq.debug("Handling SDP as well..."),Cq.debug(o));let s=r.onmessage;s?(Cq.debug("Notifying application..."),s(i,o)):Cq.debug("No provided notification callback")}else{if("timeout"===e.janus)return Cq.error("Timeout on session "+b),Cq.debug(e),void(t&&n.close(3504,"Gateway timeout"));Cq.warn("Unknown message/event  '"+e.janus+"' on session "+b),Cq.debug(e)}}}else{Cq.debug("Got a success on session "+b),Cq.debug(e);const t=e.transaction;if(t){const n=k.get(t);n&&n(e),k.delete(t)}}else{Cq.debug("Got an ack on session "+b),Cq.debug(e);const t=e.transaction;if(t){const n=k.get(t);n&&n(e),k.delete(t)}}else{Cq.debug("Got info on the Janus instance"),Cq.debug(e);const t=e.transaction;if(t){const n=k.get(t);n&&n(e),k.delete(t)}}else Cq.vdebug("Got a keepalive on session "+b);else for(let t=0;t<e.length;t++)S(e[t],!0)}function T(){if(!a||!t||!v)return;r=setTimeout(T,m);let e={janus:"keepalive",session_id:b,transaction:Cq.randomString(12)};p&&(e.token=p),f&&(e.apisecret=f),n.send(JSON.stringify(e))}function C(l){let c=Cq.randomString(12),u={janus:"create",transaction:c};if(l.reconnect&&(v=!1,u.janus="claim",u.session_id=b,n&&(n.onopen=null,n.onerror=null,n.onclose=null,r&&(clearTimeout(r),r=null))),p&&(u.token=p),f&&(u.apisecret=f),!a&&Cq.isArray(o)&&(a=o[s],0===a.indexOf("ws")?(t=!0,Cq.log("Server #"+(s+1)+": trying WebSockets to contact Janus ("+a+")")):(t=!1,Cq.log("Server #"+(s+1)+": trying REST API to contact Janus ("+a+")"))),t){n=Cq.newWebSocket(a,"janus-protocol"),i={error:function(){if(Cq.error("Error connecting to the Janus WebSockets server... "+a),Cq.isArray(o)&&!l.reconnect)return s++,s===o.length?void l.error("Error connecting to any of the provided Janus servers: Is the server down?"):(a=null,void setTimeout((function(){C(l)}),200));l.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){k.set(c,(function(e){if(Cq.debug(e),"success"!==e.janus)return Cq.error("Ooops: "+e.error.code+" "+e.error.reason),void l.error(e.error.reason);r=setTimeout(T,m),v=!0,b=e.session_id?e.session_id:e.data.id,l.reconnect?Cq.log("Claimed session: "+b):Cq.log("Created session: "+b),Cq.sessions.set(b,_),l.success()})),n.send(JSON.stringify(u))},message:function(e){S(JSON.parse(e.data))},close:function(){a&&v&&(v=!1,e.error("Lost connection to the server (is it down?)"))}};for(let e in i)n.addEventListener(e,i[e])}else Cq.httpAPICall(a,{verb:"POST",withCredentials:d,body:u,success:function(e){if(Cq.debug(e),"success"!==e.janus)return Cq.error("Ooops: "+e.error.code+" "+e.error.reason),void l.error(e.error.reason);v=!0,b=e.session_id?e.session_id:e.data.id,l.reconnect?Cq.log("Claimed session: "+b):Cq.log("Created session: "+b),Cq.sessions.set(b,_),E(),l.success()},error:function(e,t){if(Cq.error(e+":",t),Cq.isArray(o)&&!l.reconnect)return s++,s===o.length?void l.error("Error connecting to any of the provided Janus servers: Is the server down?"):(a=null,void setTimeout((function(){C(l)}),200));""===t?l.error(e+": Is the server down?"):t&&t.error?l.error(e+": "+t.error.message):l.error(e+": "+t)}})}function M(e,i){if((i=i||{}).success="function"==typeof i.success?i.success:Cq.noop,i.error="function"==typeof i.error?i.error:Cq.noop,!v)return Cq.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");let r=x.get(e);if(!r||!r.webrtcStuff)return Cq.warn("Invalid handle"),void i.error("Invalid handle");let o=i.message,s=i.jsep,l=Cq.randomString(12),c={janus:"message",body:o,transaction:l};if(r.token&&(c.token=r.token),f&&(c.apisecret=f),s){c.jsep={type:s.type,sdp:s.sdp},s.e2ee&&(c.jsep.e2ee=!0),"hml"!==s.rid_order&&"lmh"!==s.rid_order||(c.jsep.rid_order=s.rid_order),s.force_relay&&(c.jsep.force_relay=!0);let e=null,t=r.webrtcStuff;if(t.pc){let n=t.pc.getTransceivers();if(n&&n.length>0)for(let t in n){let i=n[t];if(i&&i.sender&&i.sender.track&&"video"===i.sender.track.kind){let n=i.sender.getParameters();n&&n.encodings&&n.encodings[0]&&n.encodings[0].scalabilityMode&&(e||(e=[]),e.push({mindex:parseInt(t),mid:i.mid,svc:n.encodings[0].scalabilityMode}))}}}e&&(c.jsep.svc=e)}if(Cq.debug("Sending message to plugin (handle="+e+"):"),Cq.debug(c),t)return c.session_id=b,c.handle_id=e,k.set(l,(function(e){if(Cq.debug("Message sent!"),Cq.debug(e),"success"===e.janus){let t=e.plugindata;if(!t)return Cq.warn("Request succeeded, but missing plugindata..."),void i.success();Cq.log("Synchronous transaction successful ("+t.plugin+")");let n=t.data;return Cq.debug(n),void i.success(n)}"ack"===e.janus?i.success():e.error?(Cq.error("Ooops: "+e.error.code+" "+e.error.reason),i.error(e.error.code+" "+e.error.reason)):(Cq.error("Unknown error"),i.error("Unknown error"))})),void n.send(JSON.stringify(c));Cq.httpAPICall(a+"/"+b+"/"+e,{verb:"POST",withCredentials:d,body:c,success:function(e){if(Cq.debug("Message sent!"),Cq.debug(e),"success"===e.janus){let t=e.plugindata;if(!t)return Cq.warn("Request succeeded, but missing plugindata..."),void i.success();Cq.log("Synchronous transaction successful ("+t.plugin+")");let n=t.data;return Cq.debug(n),void i.success(n)}"ack"===e.janus?i.success():e.error?(Cq.error("Ooops: "+e.error.code+" "+e.error.reason),i.error(e.error.code+" "+e.error.reason)):(Cq.error("Unknown error"),i.error("Unknown error"))},error:function(e,t){Cq.error(e+":",t),i.error(e+": "+t)}})}function I(e,i){if(!v)return void Cq.warn("Is the server down? (connected=false)");let r=x.get(e);if(!r||!r.webrtcStuff)return void Cq.warn("Invalid handle");let o={janus:"trickle",candidate:i,transaction:Cq.randomString(12)};if(r.token&&(o.token=r.token),f&&(o.apisecret=f),Cq.vdebug("Sending trickle candidate (handle="+e+"):"),Cq.vdebug(o),t)return o.session_id=b,o.handle_id=e,void n.send(JSON.stringify(o));Cq.httpAPICall(a+"/"+b+"/"+e,{verb:"POST",withCredentials:d,body:o,success:function(e){Cq.vdebug("Candidate sent!"),Cq.vdebug(e),"ack"===e.janus||Cq.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){Cq.error(e+":",t)}})}function A(e,t,n,i,r){let o=x.get(e);if(!o||!o.webrtcStuff)return void Cq.warn("Invalid handle");let s=o.webrtcStuff;if(!s.pc)return void Cq.warn("Invalid PeerConnection");let a=function(e){Cq.log("Received state change on data channel:",e);let t=e.target.label,n=e.target.protocol,i=s.dataChannel[t]?s.dataChannel[t].readyState:"null";if(Cq.log("State change on <"+t+"> data channel: "+i),"open"===i){if(s.dataChannel[t].pending&&s.dataChannel[t].pending.length>0){Cq.log("Sending pending messages on <"+t+">:",s.dataChannel[t].pending.length);for(let e of s.dataChannel[t].pending)Cq.log("Sending data on data channel <"+t+">"),Cq.debug(e),s.dataChannel[t].send(e);s.dataChannel[t].pending=[]}o.ondataopen(t,n)}};if(i)s.dataChannel[t]=i;else{let e=s.dataChannelOptions;n&&(e.protocol=n),s.dataChannel[t]=s.pc.createDataChannel(t,e)}s.dataChannel[t].onmessage=function(e){Cq.log("Received message on data channel:",e);let t=e.target.label;o.ondata(e.data,t)},s.dataChannel[t].onopen=a,s.dataChannel[t].onclose=a,s.dataChannel[t].onerror=function(e){Cq.error("Got error on data channel:",e)},s.dataChannel[t].pending=[],r&&s.dataChannel[t].pending.push(r)}function P(e,t){(t=t||{}).success="function"==typeof t.success?t.success:Cq.noop,t.error="function"==typeof t.error?t.error:Cq.noop;let n=x.get(e);if(!n||!n.webrtcStuff)return Cq.warn("Invalid handle"),void t.error("Invalid handle");let i=n.webrtcStuff,r=t.text||t.data;if(!r)return Cq.warn("Invalid data"),void t.error("Invalid data");let o=t.label?t.label:Cq.dataChanDefaultLabel;return i.dataChannel[o]?"open"!==i.dataChannel[o].readyState?(i.dataChannel[o].pending.push(r),void t.success()):(Cq.log("Sending data on data channel <"+o+">"),Cq.debug(r),i.dataChannel[o].send(r),void t.success()):(A(e,o,t.protocol,!1,r,t.protocol),void t.success())}function O(e,t){(t=t||{}).success="function"==typeof t.success?t.success:Cq.noop,t.error="function"==typeof t.error?t.error:Cq.noop;let n=x.get(e);if(!n||!n.webrtcStuff)return Cq.warn("Invalid handle"),void t.error("Invalid handle");let i=n.webrtcStuff;if(!i.dtmfSender){if(i.pc){let e=i.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!e)return Cq.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");i.dtmfSender=e.dtmf,i.dtmfSender&&(Cq.log("Created DTMF Sender"),i.dtmfSender.ontonechange=function(e){Cq.debug("Sent DTMF tone: "+e.tone)})}if(!i.dtmfSender)return Cq.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}let r=t.dtmf;if(!r)return Cq.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");let o=r.tones;if(!o)return Cq.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");let s="number"==typeof r.duration?r.duration:500,a="number"==typeof r.gap?r.gap:50;Cq.debug("Sending DTMF string "+o+" (duration "+s+"ms, gap "+a+"ms)"),i.dtmfSender.insertDTMF(o,s,a),t.success()}function D(e,i){(i=i||{}).success="function"==typeof i.success?i.success:Cq.noop,i.error="function"==typeof i.error?i.error:Cq.noop;let r=!0===i.noRequest;Cq.log("Destroying handle "+e+" (only-locally="+r+")"),H(e);let o=x.get(e);if(!o||o.detached)return x.delete(e),void i.success();if(o.detached=!0,r)return x.delete(e),void i.success();if(!v)return Cq.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");let s={janus:"detach",transaction:Cq.randomString(12)};if(o.token&&(s.token=o.token),f&&(s.apisecret=f),t)return s.session_id=b,s.handle_id=e,n.send(JSON.stringify(s)),x.delete(e),void i.success();Cq.httpAPICall(a+"/"+b+"/"+e,{verb:"POST",withCredentials:d,body:s,success:function(t){Cq.log("Destroyed handle:"),Cq.debug(t),"success"!==t.janus&&Cq.error("Ooops: "+t.error.code+" "+t.error.reason),x.delete(e),i.success()},error:function(t,n){Cq.error(t+":",n),x.delete(e),i.success()}})}function R(e,t){let n=x.get(e);if(!n||!n.webrtcStuff)throw Cq.warn("Invalid handle"),"Invalid handle";let i=n.webrtcStuff;if(i.pc)return;let r={iceServers:l,iceTransportPolicy:c,bundlePolicy:u,sdpSemantics:"unified-plan"},o=!1;if(t.tracks)for(let s of t.tracks)if(s.transforms&&(s.transforms.sender||s.transforms.receiver)){o=!0;break}RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&o&&(i.insertableStreams=!0,r.forceEncodedAudioInsertableStreams=!0,r.forceEncodedVideoInsertableStreams=!0,r.encodedInsertableStreams=!0),Cq.log("Creating PeerConnection"),i.pc=new RTCPeerConnection(r),Cq.debug(i.pc),i.pc.getStats&&(i.volume={},i.bitrate.value="0 kbits/sec"),Cq.log("Preparing local SDP and gathering candidates (trickle="+i.trickle+")"),i.pc.oniceconnectionstatechange=function(){i.pc&&n.iceState(i.pc.iceConnectionState)},i.pc.onicecandidate=function(n){if(!n.candidate||n.candidate.candidate&&n.candidate.candidate.indexOf("endOfCandidates")>0)Cq.log("End of candidates."),i.iceDone=!0,!0===i.trickle?I(e,{completed:!0}):function(e,t){(t=t||{}).success="function"==typeof t.success?t.success:Cq.noop,t.error="function"==typeof t.error?t.error:Cq.noop;let n=x.get(e);if(!n||!n.webrtcStuff)return void Cq.warn("Invalid handle, not sending anything");let i=n.webrtcStuff;Cq.log("Sending offer/answer SDP..."),i.mySdp?(i.mySdp={type:i.pc.localDescription.type,sdp:i.pc.localDescription.sdp},!1===i.trickle&&(i.mySdp.trickle=!1),Cq.debug(t),i.sdpSent=!0,t.success(i.mySdp)):Cq.warn("Local SDP instance is invalid, not sending anything...")}(e,t);else{let t={candidate:n.candidate.candidate,sdpMid:n.candidate.sdpMid,sdpMLineIndex:n.candidate.sdpMLineIndex};!0===i.trickle&&I(e,t)}},i.pc.ontrack=function(e){if(Cq.log("Handling Remote Track",e),!e.streams)return;if(!e.track)return;let t=e.transceiver?e.transceiver.mid:e.track.id;try{n.onremotetrack(e.track,t,!0,{reason:"created"})}catch(wT){Cq.error("Error calling onremotetrack",wT)}if(e.track.onended)return;let r=null;Cq.log("Adding onended callback to track:",e.track),e.track.onended=function(e){Cq.log("Remote track removed:",e),clearTimeout(r);let t=i.pc?i.pc.getTransceivers():null,o=t?t.find((t=>t.receiver.track===e.target)):null,s=o?o.mid:e.target.id;try{n.onremotetrack(e.target,s,!1,{reason:"ended"})}catch(wT){Cq.error("Error calling onremotetrack on removal",wT)}},e.track.onmute=function(e){Cq.log("Remote track muted:",e),r||(r=setTimeout((function(){Cq.log("Removing remote track");let t=i.pc?i.pc.getTransceivers():null,o=t?t.find((t=>t.receiver.track===e.target)):null,s=o?o.mid:e.target.id;try{n.onremotetrack(e.target,s,!1,{reason:"mute"})}catch(wT){Cq.error("Error calling onremotetrack on mute",wT)}r=null}),2520))},e.track.onunmute=function(e){if(Cq.log("Remote track flowing again:",e),null!=r)clearTimeout(r),r=null;else try{let t=i.pc?i.pc.getTransceivers():null,r=t?t.find((t=>t.receiver.track===e.target)):null,o=r?r.mid:e.target.id;n.onremotetrack(e.target,o,!0,{reason:"unmute"})}catch(wT){Cq.error("Error calling onremotetrack on unmute",wT)}}}}async function z(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:Cq.noop,n.error="function"==typeof n.error?n.error:W;let i=n.jsep;if(t&&i)return Cq.error("Provided a JSEP to a createOffer"),void n.error("Provided a JSEP to a createOffer");if(!(t||i&&i.type&&i.sdp))return Cq.error("A valid JSEP is required for createAnswer"),void n.error("A valid JSEP is required for createAnswer");if(n.media&&!n.tracks){if(n.tracks=Cq.mediaToTracks(n.media),!0===n.simulcast||!0===n.simulcast2||n.svc)for(let e of n.tracks)if("video"===e.type){!0===n.simulcast||!0===n.simulcast2?e.simulcast=!0:n.svc&&(e.svc=n.svc);break}Cq.warn("Deprecated media object passed, use tracks instead. Automatically translated to:",n.tracks)}if(n.tracks&&!Array.isArray(n.tracks))return Cq.error("Tracks must be an array"),void n.error("Tracks must be an array");let r=x.get(e);if(!r||!r.webrtcStuff)return Cq.warn("Invalid handle"),void n.error("Invalid handle");let o=r.webrtcStuff;var s;o.trickle=(s=n.trickle,Cq.debug("isTrickleEnabled:",s),!1!==s);try{if(R(e,n),t&&await N(e,n),i){if(await o.pc.setRemoteDescription(i),Cq.log("Remote description accepted!"),o.remoteSdp=i.sdp,o.candidates&&o.candidates.length>0){for(let e=0;e<o.candidates.length;e++){let t=o.candidates[e];Cq.debug("Adding remote candidate:",t),t&&!0!==t.completed?o.pc.addIceCandidate(t):o.pc.addIceCandidate(Cq.endOfCandidates)}o.candidates=[]}await N(e,n);let t=await async function(e,t){(t=t||{}).customizeSdp="function"==typeof t.customizeSdp?t.customizeSdp:Cq.noop;let n=x.get(e);if(!n||!n.webrtcStuff)throw Cq.warn("Invalid handle"),"Invalid handle";let i=n.webrtcStuff;Cq.log("Creating answer (iceDone="+i.iceDone+")");let r=await i.pc.createAnswer();Cq.debug(r);let o={type:"answer",sdp:r.sdp};return t.customizeSdp(o),r.sdp=o.sdp,Cq.log("Setting local description"),i.mySdp={type:"answer",sdp:r.sdp},await i.pc.setLocalDescription(r),i.iceDone||i.trickle?(i.insertableStreams&&(r.e2ee=!0),r):(Cq.log("Waiting for all candidates..."),null)}(e,n);n.success(t)}else{let t=await async function(e,t){(t=t||{}).customizeSdp="function"==typeof t.customizeSdp?t.customizeSdp:Cq.noop;let n=x.get(e);if(!n||!n.webrtcStuff)throw Cq.warn("Invalid handle"),"Invalid handle";let i=n.webrtcStuff;Cq.log("Creating offer (iceDone="+i.iceDone+")");let r={},o=!0===t.iceRestart;o&&(r.iceRestart=!0),Cq.debug(r);let s=await i.pc.createOffer(r);Cq.debug(s);let a={type:"offer",sdp:s.sdp};return t.customizeSdp(a),s.sdp=a.sdp,Cq.log("Setting local description"),i.mySdp={type:"offer",sdp:s.sdp},await i.pc.setLocalDescription(s),i.mediaConstraints=r,i.iceDone||i.trickle?(i.insertableStreams&&(s.e2ee=!0),s):(Cq.log("Waiting for all candidates..."),null)}(e,n);n.success(t)}}catch(a){Cq.error(a),n.error(a)}}function L(e,t){(t=t||{}).success="function"==typeof t.success?t.success:Cq.noop,t.error="function"==typeof t.error?t.error:W,t.customizeSdp="function"==typeof t.customizeSdp?t.customizeSdp:Cq.noop;let n=t.jsep,i=x.get(e);if(!i||!i.webrtcStuff)return Cq.warn("Invalid handle"),void t.error("Invalid handle");let r=i.webrtcStuff;if(n){if(!r.pc)return Cq.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");t.customizeSdp(n),r.pc.setRemoteDescription(n).then((function(){if(Cq.log("Remote description accepted!"),r.remoteSdp=n.sdp,r.candidates&&r.candidates.length>0){for(let e=0;e<r.candidates.length;e++){let t=r.candidates[e];Cq.debug("Adding remote candidate:",t),t&&!0!==t.completed?r.pc.addIceCandidate(t):r.pc.addIceCandidate(Cq.endOfCandidates)}r.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}async function B(e,t){if((t=t||{}).success="function"==typeof t.success?t.success:Cq.noop,t.error="function"==typeof t.error?t.error:Cq.noop,t.tracks&&!Array.isArray(t.tracks))return Cq.error("Tracks must be an array"),void t.error("Tracks must be an array");for(let i of t.tracks)(i.add||!i.replace&&!i.remove)&&(i.replace=!0);try{await N(e,t),t.success()}catch(n){Cq.error(n),t.error(n)}}async function N(e,t){let n=x.get(e);if(!n||!n.webrtcStuff)throw Cq.warn("Invalid handle, not sending anything"),"Invalid handle";let i=n.webrtcStuff;if(!i.pc)throw Cq.warn("Invalid PeerConnection"),"Invalid PeerConnection";let r=t.tracks;if(!r||!Array.isArray(r)||0===r.length)return;let o=!1,s={};for(let u of r){if(delete u.gumGroup,!u.type||!["audio","video"].includes(u.type))continue;if(!u.capture||u.capture instanceof MediaStreamTrack)continue;let e=u.group?u.group:"default";s[e]||(s[e]={}),s[e][u.type]||(u.gumGroup=e,s[e][u.type]=u)}let a=Object.keys(s);for(let u of a){let e=s[u];e.audio&&e.video||(e.audio&&delete e.audio.gumGroup,e.video&&delete e.video.gumGroup,delete s[u])}let l=!!t.jsep;for(let u of r){if(!u.type){Cq.warn("Missing track type:",u);continue}if("data"===u.type){if(i.pc.ondatachannel){Cq.warn("Data channel exists already, not creating another one");continue}Cq.log("Creating default data channel"),A(e,Cq.dataChanDefaultLabel,null,!1),i.pc.ondatachannel=function(t){Cq.log("Data channel created by Janus:",t),A(e,t.channel.label,t.channel.protocol,t.channel)};continue}if(void 0!==u.add&&null!==u.add||void 0!==u.remove&&null!==u.remove||void 0!==u.replace&&null!==u.replace||(u.add=!0),u.add&&u.remove||u.add&&u.remove&&u.replace){Cq.warn("Conflicting actions for track, ignoring:",u);continue}u.add&&u.replace?(Cq.warn("Both add and replace provided, falling back to replace:",u),delete u.add):u.remove&&u.replace&&(Cq.warn("Both remove and replace provided, falling back to remove:",u),delete u.replace);let t=u.type;"screen"===u.type&&(t="video");let r=null,a=null;if(r=u.mid?i.pc.getTransceivers().find((e=>e.mid===u.mid&&e.receiver.track.kind===t)):i.pc.getTransceivers().find((e=>e.receiver.track.kind===t)),u.replace||u.remove){if(!r){Cq.warn("Couldn't find a transceiver for track:",u);continue}if(!r.sender){Cq.warn("No sender in the transceiver for track:",u);continue}a=r.sender}if(l&&!r&&(r=i.pc.getTransceivers().find((e=>e.receiver.track.kind===t)),!r)){Cq.warn("Couldn't find a transceiver for track:",u);continue}let d=null,h=null;if((u.remove||u.replace)&&(Cq.log("Removing track from PeerConnection",u),h=a.track?a.track.id:null,await a.replaceTrack(null),h&&i.myStream)){let e=null;if("audio"===t&&i.myStream.getAudioTracks()&&i.myStream.getAudioTracks().length)for(let t of i.myStream.getAudioTracks())t.id===h&&(e=t,Cq.log("Removing audio track:",e));else if("video"===t&&i.myStream.getVideoTracks()&&i.myStream.getVideoTracks().length)for(let t of i.myStream.getVideoTracks())t.id===h&&(e=t,Cq.log("Removing video track:",e));if(e){try{i.myStream.removeTrack(e),n.onlocaltrack(e,!1)}catch(wT){Cq.error("Error calling onlocaltrack on removal for renegotiation",wT)}if(!0!==e.dontStop)try{e.stop()}catch(wT){}}}if(u.capture){if(u.gumGroup&&s[u.gumGroup]&&s[u.gumGroup].stream){let e=s[u.gumGroup].stream;d="audio"===u.type?e.getAudioTracks()[0]:e.getVideoTracks()[0],delete s[u.gumGroup].stream,delete s[u.gumGroup],delete u.gumGroup}else if(u.capture instanceof MediaStreamTrack)d=u.capture;else{o||(o=!0,n.consentDialog(!0));let e=Cq.trackConstraints(u),t=null;if("audio"===u.type||"video"===u.type){if(u.gumGroup){let t="audio"===u.type?"video":"audio";if(s[u.gumGroup]&&s[u.gumGroup][t]){let n=s[u.gumGroup][t],i=Cq.trackConstraints(n);e[t]=i[t]}}t=await navigator.mediaDevices.getUserMedia(e),u.gumGroup&&e.audio&&e.video&&(s[u.gumGroup].stream=t,delete u.gumGroup)}else t=await navigator.mediaDevices.getDisplayMedia(e);d="audio"===u.type?t.getAudioTracks()[0]:t.getVideoTracks()[0]}if(u.replace){await a.replaceTrack(d);let e="sendrecv";!1!==u.recv&&"inactive"!==r.direction&&"sendonly"!==r.direction||(e="sendonly"),r.setDirection?r.setDirection(e):r.direction=e}else{if(i.myStream||(i.myStream=new MediaStream),"audio"===t||!u.simulcast&&!u.svc)a=i.pc.addTrack(d,i.myStream),r=i.pc.getTransceivers().find((e=>e.sender===a));else if(u.simulcast){if("firefox"!==Cq.webRTCAdapter.browserDetails.browser){Cq.log("Enabling rid-based simulcasting:",d);let e=y(u.simulcastMaxBitrates);r=i.pc.addTransceiver(d,{direction:"sendrecv",streams:[i.myStream],sendEncodings:u.sendEncodings||[{rid:"h",active:!0,scalabilityMode:"L1T2",maxBitrate:e.high},{rid:"m",active:!0,scalabilityMode:"L1T2",maxBitrate:e.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,scalabilityMode:"L1T2",maxBitrate:e.low,scaleResolutionDownBy:4}]})}else if(Cq.log("Enabling Simulcasting for Firefox (RID)"),r=i.pc.addTransceiver(d,{direction:"sendrecv",streams:[i.myStream]}),a=r?r.sender:null,a){let e=a.getParameters();e||(e={});let t=y(u.simulcastMaxBitrates);e.encodings=u.sendEncodings||[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}],a.setParameters(e)}}else Cq.log("Enabling SVC ("+u.svc+"):",d),r=i.pc.addTransceiver(d,{direction:"sendrecv",streams:[i.myStream],sendEncodings:[{scalabilityMode:u.svc}]});if(a||(a=r?r.sender:null),u.codec)if("firefox"===Cq.webRTCAdapter.browserDetails.browser)Cq.warn("setCodecPreferences not supported in Firefox, ignoring codec for track:",u);else if("string"!=typeof u.codec)Cq.warn("Invalid codec value, ignoring for track:",u);else{let e=t+"/"+u.codec.toLowerCase(),n=RTCRtpReceiver.getCapabilities(t).codecs.filter((function(t){return t.mimeType.toLowerCase()===e}));if(n&&0!==n.length){if(r)try{r.setCodecPreferences(n)}catch(c){Cq.warn("Failed enforcing codec for this "+t+" track:",c)}}else Cq.warn("Codec not supported in this browser for this track, ignoring:",u)}if(u.bitrate)if(u.simulcast||u.svc)Cq.warn("Ignoring bitrate for simulcast/SVC track, use sendEncodings for that");else if(isNaN(u.bitrate)||u.bitrate<0)Cq.warn("Ignoring invalid bitrate for track:",u);else if(a){let e=a.getParameters();e&&e.encodings&&0!==e.encodings.length?(e.encodings[0].maxBitrate=u.bitrate,await a.setParameters(e)):Cq.warn("No encodings in the sender parameters, ignoring bitrate for track:",u)}if("video"===t&&u.framerate)if(u.simulcast||u.svc)Cq.warn("Ignoring framerate for simulcast/SVC track, use sendEncodings for that");else if(isNaN(u.framerate)||u.framerate<0)Cq.warn("Ignoring invalid framerate for track:",u);else if(a){let e=a.getParameters();e&&e.encodings&&0!==e.encodings.length?(e.encodings[0].maxFramerate=u.framerate,await a.setParameters(e)):Cq.warn("No encodings in the sender parameters, ignoring framerate for track:",u)}if(u.transforms){if(a&&u.transforms.sender){let e=null;RTCRtpSender.prototype.createEncodedStreams?e=a.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t?e=a.createEncodedAudioStreams():"video"===t&&(e=a.createEncodedVideoStreams())),e&&(e.readableStream&&e.writableStream?e.readableStream.pipeThrough(u.transforms.sender).pipeTo(e.writableStream):e.readable&&e.writable&&e.readable.pipeThrough(u.transforms.sender).pipeTo(e.writable))}if(r&&r.receiver&&u.transforms.receiver){let e=null;RTCRtpReceiver.prototype.createEncodedStreams?e=r.receiver.createEncodedStreams():(RTCRtpReceiver.prototype.createAudioEncodedStreams||RTCRtpReceiver.prototype.createEncodedVideoStreams)&&("audio"===t?e=r.receiver.createEncodedAudioStreams():"video"===t&&(e=r.receiver.createEncodedVideoStreams())),e&&(e.readableStream&&e.writableStream?e.readableStream.pipeThrough(u.transforms.receiver).pipeTo(e.writableStream):e.readable&&e.writable&&e.readable.pipeThrough(u.transforms.receiver).pipeTo(e.writable))}}}d&&!0===u.dontStop&&(d.dontStop=!0)}else if(u.recv&&(r||(r=i.pc.addTransceiver(t)),r)){if(u.codec)if("firefox"===Cq.webRTCAdapter.browserDetails.browser)Cq.warn("setCodecPreferences not supported in Firefox, ignoring codec for track:",u);else if("string"!=typeof u.codec)Cq.warn("Invalid codec value, ignoring for track:",u);else{let e=t+"/"+u.codec.toLowerCase(),n=RTCRtpReceiver.getCapabilities(t).codecs.filter((function(t){return t.mimeType.toLowerCase()===e}));if(n&&0!==n.length)try{r.setCodecPreferences(n)}catch(c){Cq.warn("Failed enforcing codec for this "+t+" track:",c)}else Cq.warn("Codec not supported in this browser for this track, ignoring:",u)}if(r.receiver&&u.transforms&&u.transforms.receiver){let e=null;RTCRtpReceiver.prototype.createEncodedStreams?e=r.receiver.createEncodedStreams():(RTCRtpReceiver.prototype.createAudioEncodedStreams||RTCRtpReceiver.prototype.createEncodedVideoStreams)&&("audio"===t?e=r.receiver.createEncodedAudioStreams():"video"===t&&(e=r.receiver.createEncodedVideoStreams())),e&&(e.readableStream&&e.writableStream?e.readableStream.pipeThrough(u.transforms.receiver).pipeTo(e.writableStream):e.readable&&e.writable&&e.readable.pipeThrough(u.transforms.receiver).pipeTo(e.writable))}}if(d){i.myStream.addTrack(d),d.onended=function(e){Cq.log("Local track removed:",e);try{n.onlocaltrack(e.target,!1)}catch(wT){Cq.error("Error calling onlocaltrack following end",wT)}};try{n.onlocaltrack(d,!0)}catch(wT){Cq.error("Error calling onlocaltrack for track add",wT)}}if(r){let e=r.direction,t=null,n=d&&r.sender.track,i=!1!==u.recv&&r.receiver.track;n&&i?t="sendrecv":n&&!i?t="sendonly":!n&&i?t="recvonly":n||i||(t="inactive"),t&&t!==e&&(Cq.warn("Changing direction of transceiver to "+t+" (was "+e+")",u),r.setDirection?r.setDirection(t):r.direction=t)}}o&&n.consentDialog(!1)}function F(e){let t=x.get(e);if(!t||!t.webrtcStuff)return Cq.warn("Invalid handle"),null;let n=t.webrtcStuff;if(!n.pc)return Cq.warn("Invalid PeerConnection"),null;let i=[],r=n.pc.getTransceivers();for(let o of r){let e=null;o.sender&&o.sender.track&&(e={mid:o.mid},e.type=o.sender.track.kind,e.id=o.sender.track.id,e.label=o.sender.track.label),e&&i.push(e)}return i}function $(e){let t=x.get(e);if(!t||!t.webrtcStuff)return Cq.warn("Invalid handle"),null;let n=t.webrtcStuff;if(!n.pc)return Cq.warn("Invalid PeerConnection"),null;let i=[],r=n.pc.getTransceivers();for(let o of r){let e=null;o.receiver&&o.receiver.track&&(e={mid:o.mid},e.type=o.receiver.track.kind,e.id=o.receiver.track.id,e.label=o.receiver.track.label),e&&i.push(e)}return i}function j(e,t,n,i){i="function"==typeof i?i:Cq.noop;let r=x.get(e);if(!r||!r.webrtcStuff)return Cq.warn("Invalid handle"),void i(0);let o=n?"remote":"local",s=r.webrtcStuff;if(s.volume[o]||(s.volume[o]={value:0}),s.pc&&s.pc.getStats&&("chrome"===Cq.webRTCAdapter.browserDetails.browser||"safari"===Cq.webRTCAdapter.browserDetails.browser)){let e=s.pc;if(t){let r=s.pc.getTransceivers().find((e=>e.mid===t&&"audio"===e.receiver.track.kind));if(!r)return Cq.warn("No audio transceiver with mid "+t),void i(0);if(n&&!r.receiver)return Cq.warn("Remote transceiver track unavailable"),void i(0);if(!n&&!r.sender)return Cq.warn("Local transceiver track unavailable"),void i(0);e=n?r.receiver:r.sender}return e.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(n&&!e.remoteSource||!n&&"media-source"!==e.type||i(e.audioLevel?e.audioLevel:0))}))})),s.volume[o].value}return Cq.warn("Getting the "+o+" volume unsupported by browser"),void i(0)}function V(e,t,n){let i=x.get(e);if(!i||!i.webrtcStuff)return Cq.warn("Invalid handle"),!0;let r=i.webrtcStuff;if(!r.pc)return Cq.warn("Invalid PeerConnection"),!0;if(!r.myStream)return Cq.warn("Invalid local MediaStream"),!0;if(n){if(!r.myStream.getVideoTracks()||0===r.myStream.getVideoTracks().length)return Cq.warn("No video track"),!0;if(t){let e=r.pc.getTransceivers().find((e=>e.mid===t&&"video"===e.receiver.track.kind));return e?e.sender&&e.sender.track?!e.sender.track.enabled:(Cq.warn("No video sender with mid "+t),!0):(Cq.warn("No video transceiver with mid "+t),!0)}return!r.myStream.getVideoTracks()[0].enabled}if(!r.myStream.getAudioTracks()||0===r.myStream.getAudioTracks().length)return Cq.warn("No audio track"),!0;if(t){let e=r.pc.getTransceivers().find((e=>e.mid===t&&"audio"===e.receiver.track.kind));return e?e.sender&&e.sender.track?!e.sender.track.enabled:(Cq.warn("No audio sender with mid "+t),!0):(Cq.warn("No audio transceiver with mid "+t),!0)}return!r.myStream.getAudioTracks()[0].enabled}function U(e,t,n,i){let r=x.get(e);if(!r||!r.webrtcStuff)return Cq.warn("Invalid handle"),!1;let o=r.webrtcStuff;if(!o.pc)return Cq.warn("Invalid PeerConnection"),!1;if(!o.myStream)return Cq.warn("Invalid local MediaStream"),!1;if(n){if(!o.myStream.getVideoTracks()||0===o.myStream.getVideoTracks().length)return Cq.warn("No video track"),!1;if(t){let e=o.pc.getTransceivers().find((e=>e.mid===t&&"video"===e.receiver.track.kind));if(!e)return Cq.warn("No video transceiver with mid "+t),!1;if(!e.sender||!e.sender.track)return Cq.warn("No video sender with mid "+t),!1;e.sender.track.enabled=!i}else for(const e of o.myStream.getVideoTracks())e.enabled=!i}else{if(!o.myStream.getAudioTracks()||0===o.myStream.getAudioTracks().length)return Cq.warn("No audio track"),!1;if(t){let e=o.pc.getTransceivers().find((e=>e.mid===t&&"audio"===e.receiver.track.kind));if(!e)return Cq.warn("No audio transceiver with mid "+t),!1;if(!e.sender||!e.sender.track)return Cq.warn("No audio sender with mid "+t),!1;e.sender.track.enabled=!i}else for(const e of o.myStream.getAudioTracks())e.enabled=!i}return!0}function q(e,t){let n=x.get(e);if(!n||!n.webrtcStuff)return Cq.warn("Invalid handle"),"Invalid handle";let i=n.webrtcStuff;if(!i.pc)return"Invalid PeerConnection";if(i.pc.getStats){let e=i.pc,n=t||"default";if(t){let n=i.pc.getTransceivers().find((e=>e.mid===t&&"video"===e.receiver.track.kind));if(!n)return Cq.warn("No video transceiver with mid "+t),"No video transceiver with mid "+t;if(!n.receiver)return Cq.warn("No video receiver with mid "+t),"No video receiver with mid "+t;e=n.receiver}return i.bitrate[n]||(i.bitrate[n]={timer:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,value:"0 kbits/sec"}),i.bitrate[n].timer?i.bitrate[n].value:(Cq.log("Starting bitrate timer"+(t?" for mid "+t:"")+" (via getStats)"),i.bitrate[n].timer=setInterval((function(){e.getStats().then((function(e){e.forEach((function(e){if(!e)return;let t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(i.bitrate[n].bsnow=e.bytesReceived,i.bitrate[n].tsnow=e.timestamp,null===i.bitrate[n].bsbefore||null===i.bitrate[n].tsbefore)i.bitrate[n].bsbefore=i.bitrate[n].bsnow,i.bitrate[n].tsbefore=i.bitrate[n].tsnow;else{let e=i.bitrate[n].tsnow-i.bitrate[n].tsbefore;"safari"===Cq.webRTCAdapter.browserDetails.browser&&(e/=1e3);let t=Math.round(8*(i.bitrate[n].bsnow-i.bitrate[n].bsbefore)/e);"safari"===Cq.webRTCAdapter.browserDetails.browser&&(t=parseInt(t/1e3)),i.bitrate[n].value=t+" kbits/sec",i.bitrate[n].bsbefore=i.bitrate[n].bsnow,i.bitrate[n].tsbefore=i.bitrate[n].tsnow}}))}))}),1e3),"0 kbits/sec")}return Cq.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"}function G(e,t,n){let i=x.get(e);if(!i||!i.webrtcStuff)return void Cq.warn("Invalid handle");let r=i.webrtcStuff;if(!r.pc)return void Cq.warn("Invalid PeerConnection");let o=r.pc.getTransceivers().find((e=>e.mid===t));if(!o)return void Cq.warn("No transceiver with mid",t);if(!o.sender)return void Cq.warn("No sender for transceiver with mid",t);let s=o.sender.getParameters();s&&s.encodings&&0!==s.encodings.length?s.encodings.length>1?Cq.warn("Ignoring bitrate for simulcast track, use sendEncodings for that"):isNaN(n)||n<0?Cq.warn("Invalid bitrate (must be a positive integer)"):(s.encodings[0].maxBitrate=n,o.sender.setParameters(s)):Cq.warn("No parameters encodings")}function W(e){Cq.error("WebRTC error:",e)}function H(e,i){Cq.log("Cleaning WebRTC stuff");let r=x.get(e);if(!r)return;let o=r.webrtcStuff;if(o){if(!0===i){let i={janus:"hangup",transaction:Cq.randomString(12)};r.token&&(i.token=r.token),f&&(i.apisecret=f),Cq.debug("Sending hangup request (handle="+e+"):"),Cq.debug(i),t?(i.session_id=b,i.handle_id=e,n.send(JSON.stringify(i))):Cq.httpAPICall(a+"/"+b+"/"+e,{verb:"POST",withCredentials:d,body:i})}o.volume&&(o.volume.local&&o.volume.local.timer&&clearInterval(o.volume.local.timer),o.volume.remote&&o.volume.remote.timer&&clearInterval(o.volume.remote.timer));for(let e in o.bitrate)o.bitrate[e].timer&&clearInterval(o.bitrate[e].timer);o.bitrate={},!o.streamExternal&&o.myStream&&(Cq.log("Stopping local stream tracks"),Cq.stopAllTracks(o.myStream)),o.streamExternal=!1,o.myStream=null;try{o.pc.close()}catch(wT){}o.pc=null,o.candidates=null,o.mySdp=null,o.remoteSdp=null,o.iceDone=!1,o.dataChannel={},o.dtmfSender=null,o.insertableStreams=!1}r.oncleanup()}C(e),this.getServer=function(){return a},this.isConnected=function(){return v},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:Cq.noop,e.error="function"==typeof e.error?e.error:Cq.noop,e.reconnect=!0,C(e)},this.getSessionId=function(){return b},this.getInfo=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:Cq.noop,e.error="function"==typeof e.error?e.error:Cq.noop,Cq.log("Getting info on Janus instance"),!v)return Cq.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");let i=Cq.randomString(12),r={janus:"info",transaction:i};if(p&&(r.token=p),f&&(r.apisecret=f),t)return k.set(i,(function(t){Cq.log("Server info:"),Cq.debug(t),"server_info"!==t.janus&&Cq.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)})),void n.send(JSON.stringify(r));Cq.httpAPICall(a,{verb:"POST",withCredentials:d,body:r,success:function(t){Cq.log("Server info:"),Cq.debug(t),"server_info"!==t.janus&&Cq.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},error:function(t,n){Cq.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)},this.destroy=function(o){!function(o){(o=o||{}).success="function"==typeof o.success?o.success:Cq.noop,o.error="function"==typeof o.error?o.error:Cq.noop;let s=!0===o.unload,l=!0;void 0!==o.notifyDestroyed&&null!==o.notifyDestroyed&&(l=!0===o.notifyDestroyed);let c=!0===o.cleanupHandles;if(Cq.log("Destroying session "+b+" (unload="+s+")"),!b)return Cq.warn("No session to destroy"),o.success(),void(l&&e.destroyed());if(c)for(const e of x.keys())D(e,{noRequest:!0});if(!v)return Cq.warn("Is the server down? (connected=false)"),b=null,void o.success();let u={janus:"destroy",transaction:Cq.randomString(12)};if(p&&(u.token=p),f&&(u.apisecret=f),s)return t?(n.onclose=null,n.close(),n=null):navigator.sendBeacon(a+"/"+b,JSON.stringify(u)),Cq.log("Destroyed session:"),b=null,v=!1,o.success(),void(l&&e.destroyed());if(t){u.session_id=b;let t=function(){for(let e in i)n.removeEventListener(e,i[e]);n.removeEventListener("message",s),n.removeEventListener("error",a),r&&clearTimeout(r),n.close()},s=function(n){let i=JSON.parse(n.data);i.session_id==u.session_id&&i.transaction==u.transaction&&(t(),o.success(),l&&e.destroyed())},a=function(){t(),o.error("Failed to destroy the server: Is the server down?"),l&&e.destroyed()};return n.addEventListener("message",s),n.addEventListener("error",a),void(1===n.readyState?n.send(JSON.stringify(u)):a())}Cq.httpAPICall(a+"/"+b,{verb:"POST",withCredentials:d,body:u,success:function(t){Cq.log("Destroyed session:"),Cq.debug(t),b=null,v=!1,"success"!==t.janus&&Cq.error("Ooops: "+t.error.code+" "+t.error.reason),o.success(),l&&e.destroyed()},error:function(t,n){Cq.error(t+":",n),b=null,v=!1,o.success(),l&&e.destroyed()}})}(o)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:Cq.noop,e.error="function"==typeof e.error?e.error:Cq.noop,e.dataChannelOptions=e.dataChannelOptions||{ordered:!0},e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:Cq.noop,e.iceState="function"==typeof e.iceState?e.iceState:Cq.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:Cq.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:Cq.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:Cq.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:Cq.noop,e.onlocaltrack="function"==typeof e.onlocaltrack?e.onlocaltrack:Cq.noop,e.onremotetrack="function"==typeof e.onremotetrack?e.onremotetrack:Cq.noop,e.ondata="function"==typeof e.ondata?e.ondata:Cq.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:Cq.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:Cq.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:Cq.noop,!v)return Cq.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");let i=e.plugin;if(!i)return Cq.error("Invalid plugin"),void e.error("Invalid plugin");let r=e.opaqueId,o=e.loopIndex,s=e.token?e.token:p,l=Cq.randomString(12),c={janus:"attach",plugin:i,opaque_id:r,loop_index:o,transaction:l};if(s&&(c.token=s),f&&(c.apisecret=f),t)return k.set(l,(function(t){if(Cq.debug(t),"success"!==t.janus)return Cq.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);let n=t.data.id;Cq.log("Created handle: "+n);let r={session:_,plugin:i,id:n,token:s,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:e.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(e,t){return j(n,e,!0,t)},getRemoteVolume:function(e,t){return j(n,e,!0,t)},getLocalVolume:function(e,t){return j(n,e,!1,t)},isAudioMuted:function(e){return V(n,e,!1)},muteAudio:function(e){return U(n,e,!1,!0)},unmuteAudio:function(e){return U(n,e,!1,!1)},isVideoMuted:function(e){return V(n,e,!0)},muteVideo:function(e){return U(n,e,!0,!0)},unmuteVideo:function(e){return U(n,e,!0,!1)},getBitrate:function(e){return q(n,e)},setMaxBitrate:function(e,t){return G(n,e,t)},send:function(e){M(n,e)},data:function(e){P(n,e)},dtmf:function(e){O(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){z(n,!0,e)},createAnswer:function(e){z(n,!1,e)},handleRemoteJsep:function(e){L(n,e)},replaceTracks:function(e){B(n,e)},getLocalTracks:function(){return F(n)},getRemoteTracks:function(){return $(n)},onlocaltrack:e.onlocaltrack,onremotetrack:e.onremotetrack,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){H(n,!0===e)},detach:function(e){D(n,e)}};x.set(n,r),e.success(r)})),c.session_id=b,void n.send(JSON.stringify(c));Cq.httpAPICall(a+"/"+b,{verb:"POST",withCredentials:d,body:c,success:function(t){if(Cq.debug(t),"success"!==t.janus)return Cq.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);let n=t.data.id;Cq.log("Created handle: "+n);let r={session:_,plugin:i,id:n,token:s,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:e.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(e,t){return j(n,e,!0,t)},getRemoteVolume:function(e,t){return j(n,e,!0,t)},getLocalVolume:function(e,t){return j(n,e,!1,t)},isAudioMuted:function(e){return V(n,e,!1)},muteAudio:function(e){return U(n,e,!1,!0)},unmuteAudio:function(e){return U(n,e,!1,!1)},isVideoMuted:function(e){return V(n,e,!0)},muteVideo:function(e){return U(n,e,!0,!0)},unmuteVideo:function(e){return U(n,e,!0,!1)},getBitrate:function(e){return q(n,e)},setMaxBitrate:function(e,t){return G(n,e,t)},send:function(e){M(n,e)},data:function(e){P(n,e)},dtmf:function(e){O(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){z(n,!0,e)},createAnswer:function(e){z(n,!1,e)},handleRemoteJsep:function(e){L(n,e)},replaceTracks:function(e){B(n,e)},getLocalTracks:function(){return F(n)},getRemoteTracks:function(){return $(n)},onlocaltrack:e.onlocaltrack,onremotetrack:e.onremotetrack,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){H(n,!0===e)},detach:function(e){D(n,e)}};x.set(n,r),e.success(r)},error:function(t,n){Cq.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)}}Cq.useDefaultDependencies=function(e){let t=e&&e.fetch||fetch,n=e&&e.Promise||Promise,i=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new i(e,t)},extension:e&&e.extension||Tq,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,i){let r={method:i.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===i.verb&&(r.headers["Content-Type"]="application/json"),void 0!==i.withCredentials&&(r.credentials=!0===i.withCredentials?"include":i.withCredentials?i.withCredentials:"omit"),i.body&&(r.body=JSON.stringify(i.body));let o=t(e,r).catch((function(e){return n.reject({message:"Probably a network error, is the server down?",error:e})}));if(i.timeout){let e=new n((function(e,t){let n=setTimeout((function(){return clearTimeout(n),t({message:"Request timed out",timeout:i.timeout})}),i.timeout)}));o=n.race([o,e])}return o.then((function(e){return e.ok?typeof i.success==typeof Cq.noop?e.json().then((function(e){try{i.success(e)}catch(t){Cq.error("Unhandled httpAPICall success callback error",t)}}),(function(t){return n.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:n.reject({message:"API call failed",response:e})})).catch((function(e){typeof i.error==typeof Cq.noop&&i.error(e.message||"<< internal error >>",e)})),o}}},Cq.useOldDependencies=function(e){let t=e&&e.jQuery||jQuery,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||Tq,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,n){let i=void 0!==n.body?{contentType:"application/json",data:JSON.stringify(n.body)}:{},r=void 0!==n.withCredentials?{xhrFields:{withCredentials:n.withCredentials}}:{};return t.ajax(t.extend(i,r,{url:e,type:n.verb,cache:!1,dataType:"json",async:n.async,timeout:n.timeout,success:function(e){typeof n.success==typeof Cq.noop&&n.success(e)},error:function(e,t,i){typeof n.error==typeof Cq.noop&&n.error(t,i)}}))}}},Cq.mediaToTracks=function(e){let t=[];if(e){if(!e.keepAudio&&!1!==e.audio&&(void 0===e.audio||e.audio||e.audioSend||e.audioRecv||e.addAudio||e.replaceAudio||e.removeAudio)){let n={type:"audio"};e.removeAudio?n.remove=!0:(e.addAudio?n.add=!0:e.replaceAudio&&(n.replace=!0),!1!==e.audioSend&&(n.capture=e.audio||!0),!1!==e.audioRecv&&(n.recv=!0)),(n.remove||n.capture||n.recv)&&t.push(n)}if(!e.keepVideo&&!1!==e.video&&(void 0===e.video||e.video||e.videoSend||e.videoRecv||e.addVideo||e.replaceVideo||e.removeVideo)){let n={type:"video"};e.removeVideo?n.remove=!0:(e.addVideo?n.add=!0:e.replaceVideo&&(n.replace=!0),!1!==e.videoSend&&(n.capture=e.video||!0,["screen","window","desktop"].includes(n.capture)&&(n.type="screen",n.capture={video:{}},e.screenshareFrameRate&&(n.capture.frameRate=e.screenshareFrameRate),e.screenshareHeight&&(n.capture.height=e.screenshareHeight),e.screenshareWidth&&(n.capture.width=e.screenshareWidth))),!1!==e.videoRecv&&(n.recv=!0)),(n.remove||n.capture||n.recv)&&t.push(n)}e.data&&t.push({type:"data"})}else t.push({type:"audio",capture:!0,recv:!0}),t.push({type:"video",capture:!0,recv:!0});return t},Cq.trackConstraints=function(e){let t={};if(!e||!e.capture)return t;if("audio"===e.type)t.audio=e.capture;else if("video"===e.type)if((e.simulcast||e.svc)&&!0===e.capture&&(e.capture="hires"),!0===e.capture||"object"==typeof e.capture)t.video=e.capture;else{let n=0,i=0;"lowres"===e.capture?(n=320,i=240):"lowres-16:9"===e.capture?(n=320,i=180):"hires"===e.capture||"hires-16:9"===e.capture||"hdres"===e.capture?(n=1280,i=720):"fhdres"===e.capture?(n=1920,i=1080):"4kres"===e.capture?(n=3840,i=2160):"stdres"===e.capture?(n=640,i=480):"stdres-16:9"===e.capture?(n=640,i=360):(Cq.log("Default video setting is stdres 4:3"),n=640,i=480),t.video={width:{ideal:n},height:{ideal:i}}}else"screen"===e.type&&(t.video=e.capture);return t},Cq.noop=function(){},Cq.dataChanDefaultLabel="JanusDataChannel",Cq.endOfCandidates=null,Cq.stopAllTracks=function(e){try{let t=e.getTracks();for(let e of t)Cq.log(e),e&&!0!==e.dontStop&&e.stop()}catch(wT){}},Cq.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:Cq.noop,Cq.initDone)e.callback();else{if(void 0===console.log&&(console.log=function(){}),Cq.trace=Cq.noop,Cq.debug=Cq.noop,Cq.vdebug=Cq.noop,Cq.log=Cq.noop,Cq.warn=Cq.noop,Cq.error=Cq.noop,!0===e.debug||"all"===e.debug)Cq.trace=console.trace.bind(console),Cq.debug=console.debug.bind(console),Cq.vdebug=console.debug.bind(console),Cq.log=console.log.bind(console),Cq.warn=console.warn.bind(console),Cq.error=console.error.bind(console);else if(Array.isArray(e.debug))for(let r of e.debug)switch(r){case"trace":Cq.trace=console.trace.bind(console);break;case"debug":Cq.debug=console.debug.bind(console);break;case"vdebug":Cq.vdebug=console.debug.bind(console);break;case"log":Cq.log=console.log.bind(console);break;case"warn":Cq.warn=console.warn.bind(console);break;case"error":Cq.error=console.error.bind(console)}Cq.log("Initializing library");let t=e.dependencies||Cq.useDefaultDependencies();Cq.isArray=t.isArray,Cq.webRTCAdapter=t.webRTCAdapter,Cq.httpAPICall=t.httpAPICall,Cq.newWebSocket=t.newWebSocket,Cq.extension=t.extension,Cq.extension.init(),Cq.listDevices=function(e,t){e="function"==typeof e?e:Cq.noop,t||(t={audio:!0,video:!0}),Cq.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){Cq.debug(n),e(n),Cq.stopAllTracks(t)}))})).catch((function(t){Cq.error(t),e([])})):(Cq.warn("navigator.mediaDevices unavailable"),e([]))},Cq.attachMediaStream=function(e,t){try{e.srcObject=t}catch(wT){try{e.src=URL.createObjectURL(t)}catch(wT){Cq.error("Error attaching stream to element",wT)}}},Cq.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(wT){try{e.src=t.src}catch(wT){Cq.error("Error reattaching stream to element",wT)}}};let n=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",i=window["on"+n];if(window.addEventListener(n,(function(){Cq.log("Closing window");for(const[e,t]of Cq.sessions)t&&t.destroyOnUnload&&(Cq.log("Destroying session "+e),t.destroy({unload:!0,notifyDestroyed:!1}));i&&"function"==typeof i&&i()})),Cq.safariVp8=!1,Cq.safariVp9=!1,"safari"===Cq.webRTCAdapter.browserDetails.browser&&Cq.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(let e of RTCRtpSender.getCapabilities("video").codecs)e&&e.mimeType&&"video/vp8"===e.mimeType.toLowerCase()?Cq.safariVp8=!0:e&&e.mimeType&&"video/vp9"===e.mimeType.toLowerCase()&&(Cq.safariVp9=!0);Cq.safariVp8?Cq.log("This version of Safari supports VP8"):Cq.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{let e=new RTCPeerConnection({});e.createOffer({offerToReceiveVideo:!0}).then((function(t){Cq.safariVp8=-1!==t.sdp.indexOf("VP8"),Cq.safariVp9=-1!==t.sdp.indexOf("VP9"),Cq.safariVp8?Cq.log("This version of Safari supports VP8"):Cq.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),e.close(),e=null}))}Cq.initDone=!0,e.callback()}},Cq.isWebrtcSupported=function(){return!!window.RTCPeerConnection},Cq.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},Cq.randomString=function(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="";for(let i=0;i<e;i++){let e=Math.floor(Math.random()*t.length);n+=t.charAt(e)}return n};let Mq=!0,Iq=!0;function Aq(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function Pq(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const o=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),r.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Oq(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Mq=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Dq(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Iq=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Rq(){if("object"==typeof window){if(Mq)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function zq(e,t){Iq&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Lq(e){return"[object Object]"===Object.prototype.toString.call(e)}function Bq(e){return Lq(e)?Object.keys(e).reduce((function(t,n){const i=Lq(e[n]),r=i?Bq(e[n]):e[n],o=i&&!Object.keys(r).length;return void 0===r||o?t:Object.assign(t,{[n]:r})}),{}):e}function Nq(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((i=>{i.endsWith("Id")?Nq(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((t=>{Nq(e,e.get(t),n)}))})))}function Fq(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===i&&n.trackId===t.id&&Nq(e,n,r)}))})),r}const $q=Rq;function jq(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"==typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach((e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{n=n.filter((e=>"videoinput"===e.kind));let s=n.find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=i(e.video),$q("chrome: "+JSON.stringify(e)),r(e)}))}e.video=i(e.video)}return $q("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{i&&i(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function Vq(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Uq(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})),t.stream.getTracks().forEach((n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Pq(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function qq(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Gq(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,i]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const r=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const i=function(e){n(o(r(e)))};return t.apply(this,[i,e])}return new Promise(((e,n)=>{t.apply(this,[function(t){e(o(r(t)))},n])})).then(n,i)}}function Wq(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Fq(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Pq(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Fq(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach((n=>{n.track===e&&(t?i=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?i=!0:n=t),t.track===e))),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Hq(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),r.apply(this,arguments)}}function Zq(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Hq(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{const t=this.getSenders().find((t=>t.track===e));if(t)throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const r=this.getSenders().find((e=>e.track===t));if(r)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=i[t]}));const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Xq(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}))}function Kq(e,t){Pq(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}const Jq=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Kq,shimAddTrackRemoveTrack:Zq,shimAddTrackRemoveTrackWithNative:Hq,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const i=n.video&&n.video.width,r=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},i&&(n.video.mandatory.maxWidth=i),r&&(n.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:qq,shimGetStats:Gq,shimGetUserMedia:jq,shimMediaStream:Vq,shimOnTrack:Uq,shimPeerConnection:Xq,shimSenderReceiverGetStats:Wq},Symbol.toStringTag,{value:"Module"}));function Yq(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){zq("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function Qq(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function eG(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,o]=arguments;return i.apply(this,[e||null]).then((e=>{if(t.version<53&&!r)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(wT){if("TypeError"!==wT.name)throw wT;e.forEach(((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(r,o)}}function tG(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function nG(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Pq(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function iG(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){zq("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function rG(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function oG(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return i})}function sG(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function aG(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function lG(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}const cG=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:oG,shimCreateAnswer:lG,shimCreateOffer:aG,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:sG,shimGetUserMedia:Yq,shimOnTrack:Qq,shimPeerConnection:eG,shimRTCDataChannel:rG,shimReceiverGetStats:nG,shimRemoveStream:iG,shimSenderGetStats:tG},Symbol.toStringTag,{value:"Module"}));function uG(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function dG(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function hG(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let a=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){const i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}function pG(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(fG(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function fG(e){return e&&void 0!==e.video?Object.assign({},e,{video:Bq(e.video)}):e}function mG(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(zq("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function gG(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function yG(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function vG(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const bG=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:vG,shimCallbacksAPI:hG,shimConstraints:fG,shimCreateOfferLegacy:yG,shimGetUserMedia:pG,shimLocalStreamsAPI:uG,shimRTCIceServerUrls:mG,shimRemoteStreamsAPI:dG,shimTrackEventTransceiver:gG},Symbol.toStringTag,{value:"Module"}));var xG={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((e=>0===e.indexOf(n)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:void 0===n[t[i]]&&(n[t[i]]=t[i+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let r=0;r<i.length;r++)n=i[r].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let o=3;o<i.length;o++){const r=i[o],s=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(s){const i=t.parseRtpMap(s),o=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(i.parameters=o.length?t.parseFmtp(o[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{n.headerExtensions.push(t.parseExtmap(e))}));const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach((e=>{r.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)}));let r=0;return n.codecs.forEach((e=>{e.maxptime>r&&(r=e.maxptime)})),r>0&&(i+="a=maxptime:"+r+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((e=>{i+=t.writeExtmap(e)})),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=s.length>0&&s[0].ssrc;let l;const c=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));c.length>0&&c[0].length>1&&c[0][0]===a&&(l=c[0][1]),i.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&l&&(t.rtx={ssrc:l}),n.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},n.push(t))}})),0===n.length&&a&&n.push({ssrc:a});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach((e=>{e.maxBitrate=u}))),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return r.length>0?(n=r[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let r;i.length>0&&(r=parseInt(i[0].substring(19),10)),isNaN(r)&&(r=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:r};const s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){const e=s[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let r;const o=void 0!==n?n:2;return r=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+r+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let t=0;t<i.length;t++)switch(i[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(xG);var _G=xG.exports;const wG=r(_G),kG=i({__proto__:null,default:wG},[_G]);function EG(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=wG.parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Pq(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function SG(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Pq(e,"icecandidate",(e=>{if(e.candidate){const t=wG.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function TG(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=wG.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=wG.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=wG.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>r}),this._sctp=o}return n.apply(this,arguments)}}function CG(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Pq(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function MG(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function IG(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function AG(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function PG(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>n.apply(this,[e])))})}const OG=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:IG,shimAddIceCandidateNullOrEmpty:AG,shimConnectionState:MG,shimMaxMessageSize:TG,shimParameterlessSetLocalDescription:PG,shimRTCIceCandidate:EG,shimRTCIceCandidateRelayProtocol:SG,shimSendThrowTypeError:CG},Symbol.toStringTag,{value:"Module"})),DG=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=Rq,i=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=Aq(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Aq(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Aq(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),r={browserDetails:i,commonShim:OG,extractVersion:Aq,disableLog:Oq,disableWarnings:Dq,sdp:kG};switch(i.browser){case"chrome":if(!Jq||!Xq||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=Jq,AG(e,i),PG(e),jq(e,i),Vq(e),Xq(e,i),Uq(e),Zq(e,i),qq(e),Gq(e),Wq(e),Kq(e,i),EG(e),SG(e),MG(e),TG(e,i),CG(e),IG(e,i);break;case"firefox":if(!cG||!eG||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=cG,AG(e,i),PG(e),Yq(e,i),eG(e,i),Qq(e),iG(e),tG(e),nG(e),rG(e),oG(e),sG(e),aG(e),lG(e),EG(e),MG(e),TG(e,i),CG(e);break;case"safari":if(!bG||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=bG,AG(e,i),PG(e),mG(e),yG(e),hG(e),uG(e),dG(e),gG(e),pG(e),vG(e),EG(e),SG(e),TG(e,i),CG(e),IG(e,i);break;default:n("Unsupported browser!")}return r}({window:"undefined"==typeof window?void 0:window});let RG=null,zG=null,LG="videoroomtest-"+Cq.randomString(12),BG=null,NG=null,FG=null,$G=null,jG=null,VG=null,UG={},qG={},GG={},WG={},HG={},ZG={},XG={},KG={},JG=[],YG={},QG={},eW="h264",tW=!1;const nW=()=>{tC();const e=nC(BS),[t,n]=V.useState(!1),[i,r]=V.useState(null),[o,s]=V.useState(null),[a,l]=V.useState({}),c=aR();V.useEffect((()=>{if(null==e||!e.id)return;Cq.init({debug:!0,dependencies:Cq.useDefaultDependencies({adapter:DG}),callback:()=>{Cq.log("Janus initialized")}}),RG=new Cq({server:"wss://viaweaver.com:8989",apisecret:"jamnrocks",success:()=>{Cq.log("Janus session connected")},error:e=>{Cq.error(e)},destroyed:()=>{n((e=>!e)),console.log("Janus session destroyed")}});const t=()=>{c(null)};return window.addEventListener("beforeunload",t),()=>{var e;window.removeEventListener("beforeunload",t),null===(e=RG)||void 0===e||e.destroy({})}}),[null==e?void 0:e.id]),V.useEffect((()=>{console.log(null==e?void 0:e.activeChannelId,i,o),"connected"===i||"connected"===o?null===(null==e?void 0:e.activeChannelId)&&f():"connected"!==i&&"connected"!==o&&null!=e&&e.activeChannelId&&(console.log("joinRoom"),u(e.activeChannelId,e.id,e.name))}),[null==e?void 0:e.activeChannelId,i,o]),V.useEffect((()=>{var t;const n={request:"configure",audio:null==e?void 0:e.isMicOn,video:null==e?void 0:e.isCamOn};null===(t=zG)||void 0===t||t.send({message:n,success:e=>{Cq.log("Reconfig success",e)},error:e=>{Cq.error("Reconfig error",e)}})}),[null==e?void 0:e.isCamOn,null==e?void 0:e.isMicOn]);const u=(t,i,o)=>{var a;null!=e&&e.id&&(BG=t,FG=i,NG=o,zG&&zG.hangup(),null===(a=RG)||void 0===a||a.attach({plugin:"janus.plugin.videoroom",opaqueId:"videoroomtest",success:e=>{n((e=>!e)),zG=e,Cq.log("Plugin attached! ("+zG.getPlugin()+", id="+zG.getId()+")"),Cq.log("  -- This is a publisher/manager"),(()=>{var e;let t={request:"join",id:FG,room:BG,ptype:"publisher",display:NG},n={request:"exists",room:BG};null===(e=zG)||void 0===e||e.send({message:n,success:e=>{if(Cq.log("Exists",e),e.exists){var n;null===(n=zG)||void 0===n||n.send({message:t,success:e=>{Cq.log("Register success",e)}})}else{var i;let e={request:"create",room:BG};e.videocodec=eW,e.h264_profile="42e01f",null===(i=zG)||void 0===i||i.send({message:e,success:e=>{var n;Cq.log("Create success",e),null===(n=zG)||void 0===n||n.send({message:t,success:e=>{Cq.log("Register success",e)}})}})}},error:e=>{Cq.error("Exists error",e)}})})()},error:e=>{Cq.error("Janus plugin error",e)},consentDialog:e=>{Cq.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:e=>{Cq.log("ICE state changed to",e)},mediaState:(e,t,n)=>{Cq.log("Janus "+(t?"started":"stopped")+" receiving our "+e+" (mid="+n+")"),"audio"===e?r(t?"connected":"disconnected"):"video"===e&&s(t?"connected":"disconnected")},webrtcState:e=>{Cq.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},slowLink:(e,t,n)=>{Cq.warn("Janus reports problems "+(e?"sending":"receiving")+" packets on mid "+n+" ("+t+" lost packets)")},onmessage:(t,i)=>{n((e=>!e)),Cq.debug(" ::: Got a message (publisher) :::",t);let r=t.videoroom;if(Cq.debug("Event: "+r),null!=r&&null!=r)if("joined"===r){if(FG=t.id,jG=t.private_id,Cq.log("Successfully joined room "+t.room+" with ID "+FG),d(null==e?void 0:e.isMicOn,null==e?void 0:e.isCamOn),t.publishers){let e=t.publishers;Cq.debug("Got a list of available publishers/feeds:",e);let n=null;for(let t in e){var o,s;if(e[t].dummy)continue;let i=e[t].id,r=e[t].display,a=e[t].streams;for(let e in a){let t=a[e];t.id=i,t.display=r}let l=qG[i]?null===(o=qG[i])||void 0===o?void 0:o.slot:null,c=qG[i]?null===(s=qG[i])||void 0===s?void 0:s.remoteVideos:0;qG[i]={id:i,display:r,streams:a,slot:l,remoteVideos:c},Cq.debug("  >> ["+i+"] "+r+":",a),n||(n=[]),n.push(a)}console.log("feedStreams",qG),n&&h(n)}}else if("destroyed"===r)Cq.warn("The room has been destroyed!"),c(null);else if("event"===r)if(t.streams){let e=t.streams;for(let t in e){let n=e[t];n.id=FG,n.display=NG}qG[FG]={id:FG,display:NG,streams:e},console.log("feedStreams",qG)}else if(t.publishers){let e=t.publishers;Cq.debug("Got a list of available publishers/feeds:",e);let n=null;for(let t in e){if(e[t].dummy)continue;let i=e[t].id,r=e[t].display,o=e[t].streams;for(let e in o){let t=o[e];t.id=i,t.display=r}let s=qG[i]?qG[i].slot:null,a=qG[i]?qG[i].remoteVideos:0;qG[i]={id:i,display:r,streams:o,slot:s,remoteVideos:a},Cq.debug("  >> ["+i+"] "+r+":",o),n||(n=[]),n.push(o)}n&&h(n)}else if(t.leaving){let e=t.leaving;Cq.log("Publisher left: "+e),p(e)}else if(t.unpublished){let e=t.unpublished;var a;if(Cq.log("Publisher left: "+e),"ok"===e)return null===(a=zG)||void 0===a||a.hangup(),zG=null,void(BG=null);p(e)}else t.error&&(426===t.error_code?console.warn("No such room exists"):console.error(t.error));if(i){var l;Cq.debug("Handling SDP as well...",i),null===(l=zG)||void 0===l||l.handleRemoteJsep({jsep:i});let e=t.audio_codec;$G&&$G.getAudioTracks()&&$G.getAudioTracks().length>0&&!e&&console.warn("Our audio stream has been rejected, viewers won't hear us");let n=t.video_codec;$G&&$G.getVideoTracks()&&$G.getVideoTracks().length>0&&!n&&console.warn("Our video stream has been rejected, viewers won't see us")}},onlocaltrack:(t,i)=>{var r,o;n((e=>!e)),Cq.debug(" ::: Got a local track event :::"),Cq.debug("Local track "+(i?"added":"removed")+":",t);let s=t.id;if(!i){let n=XG[s];if(n)try{let e=n.getTracks();for(let t in e){let n=e[t];n&&n.stop()}}catch(a){console.warn(a)}return t.kind,delete XG[s],void l((t=>{const n={...t};return delete n[null==e?void 0:e.id],n}))}if(!XG[s]){if("audio"===t.kind);else{let n=new MediaStream([t]);XG[s]=n,l((t=>{const i={...t};return i[null==e?void 0:e.id]={video:n},i})),Cq.log("Created local video stream:",n),Cq.log(n.getTracks()),Cq.log(n.getVideoTracks())}"completed"!==(null===(r=zG)||void 0===r?void 0:r.webrtcStuff.pc.iceConnectionState)&&"connected"!==(null===(o=zG)||void 0===o?void 0:o.webrtcStuff.pc.iceConnectionState)&&console.log("Publishing...")}},onremotetrack:(e,t,n)=>{},oncleanup:()=>{n((e=>!e)),Cq.log(" ::: Got a cleanup notification; we are unpublished now :::"),$G=null,delete qG[FG],XG={}}}))},d=(e,t)=>{var n;let i=[];e&&i.push({type:"audio",capture:!0,recv:!1}),i.push({type:"video",capture:!0,recv:!1,simulcast:!1,svc:void 0}),null===(n=zG)||void 0===n||n.createOffer({tracks:i,success:n=>{var i;Cq.debug("Got publisher SDP!"),Cq.debug(n);let r={request:"configure",audio:e,video:t};r.videocodec=eW,null===(i=zG)||void 0===i||i.send({message:r,jsep:n})},error:function(t){Cq.error("WebRTC error:",t),e?d(!1,!0):console.warn("WebRTC error... "+t.message)}})},h=t=>{var i;if(tW)setTimeout((()=>{h(t)}),500);else{if(VG){let e=null,n=null;console.log("sources1",t);for(let r in t){let i=t[r];for(let t in i){let r=i[t];if("video"===r.type&&"safari"===Cq.webRTCAdapter.browserDetails.browser&&"vp8"===r.codec&&Cq.safariVp8)console.warn("Publisher is using VP8 and Safari does not support it, disabling video");else if(r.disabled)Cq.log("Disabled stream:",r),n||(n=[]),n.push({feed:r.id,mid:r}),delete ZG[r.id][r.mid];else if(ZG[r.id]&&ZG[r.id][r.mid])Cq.log("Already subscribed to stream:",r);else{if(!qG[r.id].slot){let e;for(let t=1;t<=6;t++)if(!UG[t]){e=t,UG[e]=r.id,qG[r.id].slot=e,qG[r.id].remoteVideos=0;break}}e||(e=[]),e.push({feed:r.id,mid:r.mid}),ZG[r.id]||(ZG[r.id]={}),ZG[r.id][r.mid]=!0}}}if(!(e&&0!==e.length||n&&0!==n.length))return;let i={request:"update"};return e&&(i.subscribe=e),n&&(i.unsubscribe=n),void VG.send({message:i})}tW=!0,null===(i=RG)||void 0===i||i.attach({plugin:"janus.plugin.videoroom",opaqueId:LG,success:e=>{VG=e,KG={},Cq.log("Plugin attached! ("+VG.getPlugin()+", id="+VG.getId()+")"),Cq.log("  -- This is a multistream subscriber");let n=[];console.log("sources",t);for(let r in t){let e=t[r];console.log("streams",e);for(let t in e){let i=e[t];if("video"===i.type&&"safari"===Cq.webRTCAdapter.browserDetails.browser&&"vp8"===i.codec&&Cq.safariVp8)console.warn("Publisher is using VP8 and Safari does not support it, disabling video");else if(i.disabled)Cq.log("Disabled stream:",i);else if(Cq.log("Subscribed to "+i.id+"/"+i.mid+"?",ZG),ZG[i.id]&&ZG[i.id][i.mid])Cq.log("Already subscribed to stream, skipping: ",i);else{if(!qG[i.id].slot){let e;for(let t=1;t<=6;t++)if(!UG[t]){e=t,UG[e]=i.id,qG[i.id].slot=e,qG[i.id].remoteVideos=0;break}}n.push({feed:i.id,mid:i.mid}),ZG[i.id]||(ZG[i.id]={}),ZG[i.id][i.mid]=!0}}}let i={request:"join",room:BG,ptype:"subscriber",streams:n,use_msid:!1,private_id:jG};VG.send({message:i})},error:e=>{Cq.error("  -- Error attaching plugin...",e)},iceState:e=>{Cq.log("ICE state (remote feed) changed to "+e)},webrtcState:e=>{Cq.log("Janus says this WebRTC PeerConnection (remote feed) is "+(e?"up":"down")+" now")},slowLink:(e,t,n)=>{Cq.warn("Janus reports problems "+(e?"sending":"receiving")+" packets on mid "+n+" ("+t+" lost packets)")},onmessage:(e,t)=>{n((e=>!e)),Cq.debug(" ::: Got a message (subscriber) :::",e);let i=e.videoroom;if(Cq.debug("Event: "+i),e.error)console.warn(e.error);else if(i)if("attached"===i)tW=!1,Cq.log("Successfully attached to feed in room "+e.room);else if("event"===i){let t=e.mid,n=e.substream,i=e.temporal;if(null!=n||null!=i){let e=WG[t];YG[e]||(YG[e]=!0)}let r=e.spatial_layer;if(i=e.temporal_layer,null!=r||null!=i){let e=WG[t];QG[e]||(QG[e]=!0)}}if(e.streams)for(let n in e.streams){let t=e.streams[n].mid;GG[t]=e.streams[n];let i=qG[e.streams[n].feed_id];i&&i.slot&&(WG[t]=i.slot,HG[i.slot]=t)}var r;t&&(Cq.debug("Handling SDP as well...",t),null===(r=VG)||void 0===r||r.createAnswer({jsep:t,tracks:[{type:"data",capture:!0}],success:e=>{var t;Cq.debug("Got SDP!"),Cq.debug(e);let n={request:"start",room:BG};null===(t=VG)||void 0===t||t.send({message:n,jsep:e})},error:function(e){Cq.error("WebRTC error:",e)}}))},onlocaltrack:(e,t)=>{},onremotetrack:(e,t,i)=>{n((e=>!e)),Cq.debug("Remote track (mid="+t+") "+(i?"added":"removed")+":",e);let r=GG[t],o=qG[r.feed_id];Cq.debug(" >> This track is coming from feed "+r.feed_id+":",o);let s=WG[t];if(o&&!s&&(s=o.slot,WG[t]=o.slot,HG[o.slot]=t),Cq.debug(" >> mid "+t+" is in slot "+s),!i)return"video"===e.kind&&o&&(o.remoteVideos--,o.remoteVideos),l((t=>{const n={...t};return n[null==r?void 0:r.feed_id]&&(delete n[null==r?void 0:r.feed_id][null==e?void 0:e.kind],0===Object.keys(n[null==r?void 0:r.feed_id]).length&&delete n[null==r?void 0:r.feed_id]),n})),delete KG[t],delete WG[t],void delete HG[s];if(o.spinner&&(o.spinner.stop(),o.spinner=null),"audio"===e.kind){let n=new MediaStream([e]);KG[t]=n,l((e=>{const t={...e};return t[o.id]={...t[o.id],audio:n},t})),Cq.log("Created remote audio stream:",n),o.remoteVideos}else{o.remoteVideos++;let n=new MediaStream([e]);KG[t]=n,l((e=>{const t={...e};return t[o.id]={...t[o.id],video:n},t})),Cq.log("Created remote video stream:",n)}},oncleanup:()=>{n((e=>!e)),Cq.log(" ::: Got a cleanup notification (remote feed) :::");for(let e=1;e<6;e++)JG[e]&&clearInterval(JG[e]),JG[e]=null,qG[e].simulcastStarted=!1,qG[e].svcStarted=!1,qG[e].remoteVideos=0;l((t=>null!=e&&e.id&&t[e.id]?{[e.id]:t[e.id]}:{}))}})}},p=e=>{let t=qG[e];if(!t)return;Cq.debug("Feed "+e+" ("+t.display+") has left the room, detaching"),JG[t.slot]&&clearInterval(JG[t.slot]),JG[t.slot]=null,delete YG[t.slot],delete QG[t.slot],delete UG[t.slot],delete qG[e];let n={request:"unsubscribe",streams:[{feed:parseInt(e)}]};null!=VG&&VG.send({message:n}),delete ZG[e]},f=()=>{var e;null===(e=zG)||void 0===e||e.send({message:{request:"leave"},success:()=>{Cq.log("Leave success")},error:e=>{Cq.error(e)}}),Object.keys(qG).forEach((e=>{p(e)}))};return{refresh:t,streams:a,toggleMute:function(){var e;let t=null===(e=zG)||void 0===e?void 0:e.isAudioMuted();var n,i;Cq.log((t?"Unmuting":"Muting")+" local stream..."),t?null===(n=zG)||void 0===n||n.unmuteAudio():null===(i=zG)||void 0===i||i.muteAudio()},publishOwnFeed:d,unpublishOwnFeed:()=>{var e;null===(e=zG)||void 0===e||e.send({message:{request:"unpublish"}})},joinRoom:u,subscribeTo:h,unsubscribeFrom:p,disconnect:f}},iW=xD`
  mutation CreateChannel($lng: Float!, $lat: Float!, $name: String!, $url: String!, $desc: String!) {
    createChannel(lng: $lng, lat: $lat, name: $name, url: $url, desc: $desc) {
      channel {
        ...ChannelFields
      }
      membership {
        ...MembershipFields
      }
    }
  }
  ${BD}
  ${$D}
`,rW=()=>{const e=Jw(),[t,n]=V.useState(""),[i,r]=V.useState(""),[o,s]=V.useState(!1),[a,l]=V.useState(""),[c,u]=V.useState("");console.log("yolo");const d=((e,t)=>{const n=Jw(),i=tC(),{setShouldUpdateMapData:r,newChannelLngLat:o}=V.useContext(pW),[s]=zD(iW,{onError:t=>{console.log(t),e(t)},onCompleted:e=>{console.log(e),i(_S([e.createChannel.channel])),i(fS([e.createChannel.membership])),n.push("/map/"+e.createChannel.membership.channelId,"none"),r(!0),t()}});return(e,t,n)=>{if(!o)return;const{lng:i,lat:r}=o;s({variables:{lng:i,lat:r,name:e,url:t,desc:n}})}})((e=>{"URL already in use"===e.message?u("URL already in use"):u("Error creating channel")}),(()=>{n(""),r(""),l("")})),h=e=>e.toLowerCase().replace(/\s/g,"-").replace(/[^a-zA-Z0-9-]/g,"").slice(0,40);return Q(Pw,{children:ee("div",{style:{marginTop:cw("ios")&&!cw("mobileweb")?105:50,height:"calc(100% - 50px)",backgroundColor:"var(--ion-color-light)",display:"flex",flexDirection:"column",justifyContent:"stretch"},children:[ee(Q_,{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Q(hw,{onClick:()=>{console.log("hihi",e.routeInfo.pathname),e.push("/map","none")},style:{margin:20,border:"1px solid",borderRadius:5},children:"BACK"}),Q(hw,{onClick:()=>{t&&i&&d(t,i,a)},disabled:!t||!i,style:{margin:20,border:"1px solid",borderRadius:5,fontWeight:"bold",backgroundColor:"var(--ion-color-primary)",color:"var(--ion-color-light)"},children:"CREATE"})]}),ee(pw,{style:{position:"relative",marginTop:0},children:[Q(iw,{autofocus:!0,clearInput:!0,value:t,onIonInput:e=>{n(e.target.value),u("")},onIonBlur:()=>{o||r(h(t))},style:{margin:10,fontSize:32,fontWeight:"bold",width:"calc(100% - 20px)"},placeholder:"NAME"}),Q(iw,{clearInput:!0,value:i,onIonChange:e=>console.log(e.target.value),onIonInput:e=>{e.target.value!==i&&s(!0),r(h(e.target.value)),u("")},onIonBlur:()=>{i||(r(h(t)),s(!1))},style:{margin:10,fontSize:20,width:"calc(100% - 20px)"},placeholder:"URL"}),Q(iw,{clearInput:!0,value:a,onIonInput:e=>{l(e.target.value),u("")},style:{margin:10,fontSize:20,width:"calc(100% - 20px)"},placeholder:"DESCRIPTION"})]}),Q("div",{style:{margin:15,color:"red"},children:c})]})})},oW=xD`
  mutation GetMemberships {
    getMemberships {
      ...MembershipFields
      channel {
        ...ChannelFields
      }
    }
  }
  ${$D}
  ${BD}
`,sW=xD`
  subscription MembershipUpdated($channelIds: [Int!]!) {
    membershipUpdated(channelIds: $channelIds) {
      ...MembershipFields
      user {
        id
        name
        email
      }
    }
  }
  ${$D}
`,aW=xD`
  mutation JoinChannel($channelId: Int!) {
    joinChannel(channelId: $channelId) {
      ...ChannelFields
      memberships {
        ...MembershipFields
        user {
          id
          name
        }
      }
    }
  }
  ${BD}
  ${$D}
`,lW=xD`
  subscription ChannelUpdated($minLat: Float!, $maxLat: Float!, $minLng: Float!, $maxLng: Float!) {
    channelUpdated(minLat: $minLat, maxLat: $maxLat, minLng: $minLng, maxLng: $maxLng) {
      ...ChannelFields
    }
  }
  ${BD}
`,cW=xD`
  subscription PostUpdated($channelIds: [Int!]!) {
    postUpdated(channelIds: $channelIds) {
      ...PostFields
      user {
        id
        name
        email
      }
    }
  }
  ${xR}
`,uW=ZD("PushNotifications",{}),dW=xD`
  mutation addDevice($apnToken: String!) {
    addDevice(apnToken: $apnToken) {
      id
      apnToken
    }
  }
`,hW=()=>{const e=(()=>{const[e]=zD(dW,{onError:e=>{console.error(e)},onCompleted:e=>{console.log("add device",e,e.addDevice.id),tR.set({key:iR,value:e.addDevice.id.toString()})}});return t=>{e({variables:{apnToken:t}})}})(),t=nC(BS);V.useEffect((()=>{cw("ios")&&!cw("mobileweb")&&(async()=>{await uW.addListener("registration",(t=>{console.info("Registration token: ",t.value),e(t.value)})),await uW.addListener("registrationError",(e=>{console.error("Registration error: ",e.error)})),await uW.addListener("pushNotificationReceived",(e=>{console.log("Push notification received: ",e)})),await uW.addListener("pushNotificationActionPerformed",(e=>{console.log("Push notification action performed",e.actionId,e.inputValue)}))})()}),[]),V.useEffect((()=>{null!=t&&t.id&&cw("ios")&&!cw("mobileweb")&&(async()=>{let e=await uW.checkPermissions();if(console.log("permStatus",e),"prompt"===e.receive&&(e=await uW.requestPermissions()),"granted"!==e.receive)throw new Error("User denied permissions!");await uW.register()})()}),[null==t?void 0:t.id])};((e={})=>{"undefined"!=typeof document&&document.documentElement.classList.add("ion-ce"),ag(Object.assign({},e))})();const pW=V.createContext({}),fW=()=>{const e=nC(BS),t=nC(TS),n=nC((t=>{var n;return yS(t,null!==(n=null==e?void 0:e.id)&&void 0!==n?n:-1)})),[i,r]=V.useState(!1),[o,s]=V.useState(null),[a,l]=V.useState("talk"),{streams:c}=nW(),u=V.useRef(null),d=(e=>{const t=tC(),[n]=zD(oW,{onError:e=>{console.log(e)},onCompleted:n=>{console.log(n),t(fS(n.getMemberships)),e(!0)}});return()=>{n()}})(r),h=(()=>{const e=tC(),[t]=zD(aW,{onError:e=>{console.log(e)},onCompleted:t=>{console.log(t),e(_S([t.joinChannel]))}});return e=>{t({variables:{channelId:e}})}})();V.useEffect((()=>{null!=e&&e.id&&d()}),[null==e?void 0:e.id]),V.useEffect((()=>{null!=t&&t.id&&h(t.id)}),[null==t?void 0:t.id]),function(e,t,n,i,r){const o=tC();LD(lW,{variables:{minLat:t,maxLat:n,minLng:i,maxLng:r},shouldResubscribe:!0,onData:({data:{data:{channelUpdated:t}}})=>{console.log(t),o(_S([t])),e(!0)}})}(r,-90,90,-180,180);const p=n.filter((e=>e.isOwner||e.isSaved)).sort(((e,t)=>e.lastVisitedAt>t.lastVisitedAt?-1:1)).map((e=>e.channelId));return null!=t&&t.id&&p.push(t.id),function(e){const[t]=Qw(),n=tC(),i=nC(TS),r=nC(SS);LD(sW,{variables:{channelIds:e},shouldResubscribe:!0,onData:({data:{data:{membershipUpdated:e}}})=>{var o;console.log(e),e.isActive&&e.channelId!==(null==i?void 0:i.id)&&t({message:`${e.user.name} has joined ${null===(o=r[e.channelId])||void 0===o?void 0:o.name}`,duration:5e3}),n(fS([e]))}})}(p),function(e){const[t]=Qw(),n=tC(),i=nC(TS),r=nC(SS);LD(cW,{variables:{channelIds:e},shouldResubscribe:!0,onData:({data:{data:{postUpdated:e}}})=>{var o;console.log(e),e.channelId!==(null==i?void 0:i.id)&&t({message:`${e.user.name} has posted to ${null===(o=r[e.channelId])||void 0===o?void 0:o.name}`,duration:5e3,position:"top",htmlAttributes:{style:{top:20}}}),n(MS([e]))}})}(p),hW(),Q(Cw,{children:Q(pW.Provider,{value:{authModal:u,streams:c,shouldUpdateMapData:i,setShouldUpdateMapData:r,newChannelLngLat:o,setNewChannelLngLat:s,channelMode:a,setChannelMode:l},children:ee(fk,{children:[Q(YU,{}),Q(dq,{}),Q(fq,{}),ee(Gw,{children:[ee(Bw,{children:[Q(Qh,{exact:!0,path:"/channel/:id",component:Sq}),Q(Qh,{exact:!0,path:"/create-channel",component:rW}),Q(Qh,{exact:!0,path:"/create-deal",component:kq}),Q(Qh,{exact:!0,path:"/deal/:id",component:ZU}),Q(Qh,{exact:!0,path:"/trade",component:pU}),Q(Qh,{path:"/map",component:cU}),Q(Qh,{exact:!0,path:"/meme",component:xk}),Q(Qh,{exact:!0,path:"/",children:Q(Zh,{to:"/map"})})]}),ee(jw,{slot:"bottom",children:[ee(Nw,{tab:"meme",href:"/meme",children:[Q(Hw,{"aria-hidden":"true",icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M464 464H48a16 16 0 01-14.07-23.62l208-384a16 16 0 0128.14 0l208 384A16 16 0 01464 464z'/></svg>"}),Q(rw,{children:"MEME"})]}),ee(Nw,{tab:"map",href:"/map",children:[Q(Hw,{"aria-hidden":"true",icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M256 464c-114.69 0-208-93.31-208-208S141.31 48 256 48s208 93.31 208 208-93.31 208-208 208z'/></svg>"}),Q(rw,{children:"MAP"})]}),ee(Nw,{tab:"trade",href:"/trade",children:[Q(Hw,{"aria-hidden":"true",icon:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M416 464H96a48.05 48.05 0 01-48-48V96a48.05 48.05 0 0148-48h320a48.05 48.05 0 0148 48v320a48.05 48.05 0 01-48 48z'/></svg>"}),Q(rw,{children:"TRADE"})]})]})]})]})})})};var mW,gW,yW=function(e){function t(t){var n=e.call(this)||this;return n.client=t,n}return ny(t,e),t.prototype.request=function(e){var t=this;return new FI((function(n){return t.client.subscribe(iy(iy({},e),{query:EM(e.query)}),{next:n.next.bind(n),complete:n.complete.bind(n),error:function(e){if(e instanceof Error)return n.error(e);var t,i=NM(t=e)&&"code"in t&&"reason"in t;return i||function(e){var t;return NM(e)&&(null===(t=e.target)||void 0===t?void 0:t.readyState)===WebSocket.CLOSED}(e)?n.error(new Error("Socket closed".concat(i?" with event ".concat(e.code):"").concat(i?" ".concat(e.reason):""))):n.error(new EA({graphQLErrors:Array.isArray(e)?e:[e]}))}})}))},t}(yA);function vW(e){return null===e?"null":Array.isArray(e)?"array":typeof e}function bW(e){return"object"===vW(e)}function xW(e,t){return e.length<124?e:t}function _W(e){if(!bW(e))throw new Error(`Message is expected to be an object, but got ${vW(e)}`);if(!e.type)throw new Error("Message is missing the 'type' property");if("string"!=typeof e.type)throw new Error(`Message is expects the 'type' property to be a string, but got ${vW(e.type)}`);switch(e.type){case gW.ConnectionInit:case gW.ConnectionAck:case gW.Ping:case gW.Pong:if(null!=e.payload&&!bW(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object or nullish or missing, but got "${e.payload}"`);break;case gW.Subscribe:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${vW(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!bW(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${vW(e.payload)}`);if("string"!=typeof e.payload.query)throw new Error(`"${e.type}" message payload expects the 'query' property to be a string, but got ${vW(e.payload.query)}`);if(null!=e.payload.variables&&!bW(e.payload.variables))throw new Error(`"${e.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${vW(e.payload.variables)}`);if(null!=e.payload.operationName&&"string"!==vW(e.payload.operationName))throw new Error(`"${e.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${vW(e.payload.operationName)}`);if(null!=e.payload.extensions&&!bW(e.payload.extensions))throw new Error(`"${e.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${vW(e.payload.extensions)}`);break;case gW.Next:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${vW(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(!bW(e.payload))throw new Error(`"${e.type}" message expects the 'payload' property to be an object, but got ${vW(e.payload)}`);break;case gW.Error:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${vW(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);if(t=e.payload,!(Array.isArray(t)&&t.length>0&&t.every((e=>"message"in e))))throw new Error(`"${e.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(e.payload)}`);break;case gW.Complete:if("string"!=typeof e.id)throw new Error(`"${e.type}" message expects the 'id' property to be a string, but got ${vW(e.id)}`);if(!e.id)throw new Error(`"${e.type}" message requires a non-empty 'id' property`);break;default:throw new Error(`Invalid message 'type' property "${e.type}"`)}var t;return e}function wW(e,t){return _W(e),JSON.stringify(e,t)}!function(e){e[e.InternalServerError=4500]="InternalServerError",e[e.InternalClientError=4005]="InternalClientError",e[e.BadRequest=4400]="BadRequest",e[e.BadResponse=4004]="BadResponse",e[e.Unauthorized=4401]="Unauthorized",e[e.Forbidden=4403]="Forbidden",e[e.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",e[e.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",e[e.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",e[e.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",e[e.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"}(mW||(mW={})),function(e){e.ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete"}(gW||(gW={}));var kW=globalThis&&globalThis.__await||function(e){return this instanceof kW?(this.v=e,this):new kW(e)},EW=globalThis&&globalThis.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{!function(e){e.value instanceof kW?Promise.resolve(e.value.v).then(l,c):u(o[0][2],e)}(r[e](t))}catch(wT){u(o[0][3],wT)}}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}};function SW(e){return bW(e)&&"code"in e&&"reason"in e}window.EXCALIDRAW_ASSET_PATH="/excalidraw-assets";const TW=new yW(function(e){const{url:t,connectionParams:n,lazy:i=!0,onNonLazyError:r=console.error,lazyCloseTimeout:o=0,keepAlive:s=0,disablePong:a,connectionAckWaitTimeout:l=0,retryAttempts:c=5,retryWait:u=async function(e){let t=1e3;for(let n=0;n<e;n++)t*=2;await new Promise((e=>setTimeout(e,t+Math.floor(2700*Math.random()+300))))},shouldRetry:d=SW,isFatalConnectionProblem:h,on:p,webSocketImpl:f,generateID:m=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},jsonMessageReplacer:g,jsonMessageReviver:y}=e;let v;if(f){if(!("function"==typeof(b=f)&&"constructor"in b&&"CLOSED"in b&&"CLOSING"in b&&"CONNECTING"in b&&"OPEN"in b))throw new Error("Invalid WebSocket implementation provided");v=f}else"undefined"!=typeof WebSocket?v=WebSocket:"undefined"!=typeof global?v=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window&&(v=window.WebSocket||window.MozWebSocket);var b;if(!v)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const x=v,_=(()=>{const e=(()=>{const e={};return{on:(t,n)=>(e[t]=n,()=>{delete e[t]}),emit(t){var n;"id"in t&&(null===(n=e[t.id])||void 0===n||n.call(e,t))}}})(),t={connecting:(null==p?void 0:p.connecting)?[p.connecting]:[],opened:(null==p?void 0:p.opened)?[p.opened]:[],connected:(null==p?void 0:p.connected)?[p.connected]:[],ping:(null==p?void 0:p.ping)?[p.ping]:[],pong:(null==p?void 0:p.pong)?[p.pong]:[],message:(null==p?void 0:p.message)?[e.emit,p.message]:[e.emit],closed:(null==p?void 0:p.closed)?[p.closed]:[],error:(null==p?void 0:p.error)?[p.error]:[]};return{onMessage:e.on,on(e,n){const i=t[e];return i.push(n),()=>{i.splice(i.indexOf(n),1)}},emit(e,...n){for(const i of[...t[e]])i(...n)}}})();function w(e){const t=[_.on("error",(n=>{t.forEach((e=>e())),e(n)})),_.on("closed",(n=>{t.forEach((e=>e())),e(n)}))]}let k,E,S=0,T=!1,C=0,M=!1;async function I(){clearTimeout(E);const[e,i]=await(null!=k?k:k=new Promise(((e,i)=>(async()=>{if(T){if(await u(C),!S)return k=void 0,i({code:1e3,reason:"All Subscriptions Gone"});C++}_.emit("connecting");const r=new x("function"==typeof t?await t():t,"graphql-transport-ws");let o,c;function d(){isFinite(s)&&s>0&&(clearTimeout(c),c=setTimeout((()=>{r.readyState===x.OPEN&&(r.send(wW({type:gW.Ping})),_.emit("ping",!1,void 0))}),s))}w((e=>{k=void 0,clearTimeout(o),clearTimeout(c),i(e),SW(e)&&4499===e.code&&(r.close(4499,"Terminated"),r.onerror=null,r.onclose=null)})),r.onerror=e=>_.emit("error",e),r.onclose=e=>_.emit("closed",e),r.onopen=async()=>{try{_.emit("opened",r);const e="function"==typeof n?await n():n;if(r.readyState!==x.OPEN)return;r.send(wW(e?{type:gW.ConnectionInit,payload:e}:{type:gW.ConnectionInit},g)),isFinite(l)&&l>0&&(o=setTimeout((()=>{r.close(mW.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")}),l)),d()}catch(e){_.emit("error",e),r.close(mW.InternalClientError,xW(e instanceof Error?e.message:new Error(e).message,"Internal client error"))}};let h=!1;r.onmessage=({data:t})=>{try{const n=function(e,t){return _W("string"==typeof e?JSON.parse(e,t):e)}(t,y);if(_.emit("message",n),"ping"===n.type||"pong"===n.type)return _.emit(n.type,!0,n.payload),void("pong"===n.type?d():a||(r.send(wW(n.payload?{type:gW.Pong,payload:n.payload}:{type:gW.Pong})),_.emit("pong",!1,n.payload)));if(h)return;if(n.type!==gW.ConnectionAck)throw new Error(`First message cannot be of type ${n.type}`);clearTimeout(o),h=!0,_.emit("connected",r,n.payload),T=!1,C=0,e([r,new Promise(((e,t)=>w(t)))])}catch(n){r.onmessage=null,_.emit("error",n),r.close(mW.BadResponse,xW(n instanceof Error?n.message:new Error(n).message,"Bad response"))}}})())));e.readyState===x.CLOSING&&await i;let r=()=>{};const c=new Promise((e=>r=e));return[e,r,Promise.race([c.then((()=>{if(!S){const t=()=>e.close(1e3,"Normal Closure");isFinite(o)&&o>0?E=setTimeout((()=>{e.readyState===x.OPEN&&t()}),o):t()}})),i])]}function A(e){if(SW(e)&&(function(e){return![1e3,1001,1006,1005,1012,1013,1013].includes(e)&&e>=1e3&&e<=1999}(e.code)||[mW.InternalServerError,mW.InternalClientError,mW.BadRequest,mW.BadResponse,mW.Unauthorized,mW.SubprotocolNotAcceptable,mW.SubscriberAlreadyExists,mW.TooManyInitialisationRequests].includes(e.code)))throw e;if(M)return!1;if(SW(e)&&1e3===e.code)return S>0;if(!c||C>=c)throw e;if(!d(e))throw e;if(null==h?void 0:h(e))throw e;return T=!0}return i||(async()=>{for(S++;;)try{const[,,e]=await I();await e}catch(e){try{if(!A(e))return}catch(e){return null==r?void 0:r(e)}}})(),{on:_.on,subscribe(e,t){const n=m(e);let i=!1,r=!1,o=()=>{S--,i=!0};return(async()=>{for(S++;;)try{const[s,a,l]=await I();if(i)return a();const c=_.onMessage(n,(e=>{switch(e.type){case gW.Next:return void t.next(e.payload);case gW.Error:return r=!0,i=!0,t.error(e.payload),void o();case gW.Complete:return i=!0,void o()}}));return s.send(wW({id:n,type:gW.Subscribe,payload:e},g)),o=()=>{i||s.readyState!==x.OPEN||s.send(wW({id:n,type:gW.Complete},g)),S--,i=!0,a()},void(await l.finally(c))}catch(s){if(!A(s))return}})().then((()=>{r||t.complete()})).catch((e=>{t.error(e)})),()=>{i||o()}},iterate(e){const t=[],n={done:!1,error:null,resolve:()=>{}},i=this.subscribe(e,{next(e){t.push(e),n.resolve()},error(e){n.done=!0,n.error=e,n.resolve()},complete(){n.done=!0,n.resolve()}}),r=function(){return EW(this,arguments,(function*(){for(;;){for(t.length||(yield kW(new Promise((e=>n.resolve=e))));t.length;)yield yield kW(t.shift());if(n.error)throw n.error;if(n.done)return yield kW(void 0)}}))}();return r.throw=async e=>(n.done||(n.done=!0,n.error=e,n.resolve()),{done:!0,value:void 0}),r.return=async()=>(i(),{done:!0,value:void 0}),r},async dispose(){if(M=!0,k){const[e]=await k;e.close(1e3,"Normal Closure")}},terminate(){k&&_.emit("closed",{code:4499,reason:"Terminated",wasClean:!1})}}}({url:!cw("android")&&!cw("ios")||cw("mobileweb")?window.location.origin.replace(/^http/,"ws")+"/graphql":`ws://${nR}/graphql`})),CW=zA({uri:!cw("ios")&&!cw("android")||cw("mobileweb")?window.location.origin+"/graphql":`https://${nR}/graphql`,credentials:!cw("ios")&&!cw("android")||cw("mobileweb")?"same-origin":"include"});var MW;const IW=new hD({link:vA((({query:e})=>{const t=tI(e);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),TW,(MW=async(e,{headers:t})=>({headers:{...t,accesstoken:(await tR.get({key:rR})).value}}),new yA((function(e,t){var n=ry(e,[]);return new FI((function(i){var r,o=!1;return Promise.resolve(n).then((function(t){return MW(t,e.getContext())})).then(e.setContext).then((function(){o||(r=t(e).subscribe({next:i.next.bind(i),error:i.error.bind(i),complete:i.complete.bind(i)}))})).catch(i.error.bind(i)),function(){o=!0,r&&r.unsubscribe()}}))}))).concat(CW)),cache:new ZO}),AW=document.getElementById("root");ud(AW).render(Q(U.StrictMode,{children:Q(AD,{client:IW,children:Q(BT,{store:eC,children:Q(fW,{})})})}))}}}));
