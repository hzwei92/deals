function efe(){import.meta.url,import("_").catch(()=>1);async function*t(){}}function q8(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const a=Object.getOwnPropertyDescriptor(i,r);a&&Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();var uB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _c(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dB={exports:{}},t1={},hB={exports:{}},Jn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ov=Symbol.for("react.element"),W8=Symbol.for("react.portal"),G8=Symbol.for("react.fragment"),H8=Symbol.for("react.strict_mode"),Z8=Symbol.for("react.profiler"),X8=Symbol.for("react.provider"),K8=Symbol.for("react.context"),Y8=Symbol.for("react.forward_ref"),J8=Symbol.for("react.suspense"),Q8=Symbol.for("react.memo"),eq=Symbol.for("react.lazy"),CO=Symbol.iterator;function tq(t){return t===null||typeof t!="object"?null:(t=CO&&t[CO]||t["@@iterator"],typeof t=="function"?t:null)}var fB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pB=Object.assign,mB={};function hm(t,e,n){this.props=t,this.context=e,this.refs=mB,this.updater=n||fB}hm.prototype.isReactComponent={};hm.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};hm.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function gB(){}gB.prototype=hm.prototype;function h2(t,e,n){this.props=t,this.context=e,this.refs=mB,this.updater=n||fB}var f2=h2.prototype=new gB;f2.constructor=h2;pB(f2,hm.prototype);f2.isPureReactComponent=!0;var IO=Array.isArray,yB=Object.prototype.hasOwnProperty,p2={current:null},vB={key:!0,ref:!0,__self:!0,__source:!0};function bB(t,e,n){var i,r={},a=null,d=null;if(e!=null)for(i in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(a=""+e.key),e)yB.call(e,i)&&!vB.hasOwnProperty(i)&&(r[i]=e[i]);var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){for(var f=Array(o),g=0;g<o;g++)f[g]=arguments[g+2];r.children=f}if(t&&t.defaultProps)for(i in o=t.defaultProps,o)r[i]===void 0&&(r[i]=o[i]);return{$$typeof:Ov,type:t,key:a,ref:d,props:r,_owner:p2.current}}function nq(t,e){return{$$typeof:Ov,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function m2(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ov}function iq(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var AO=/\/+/g;function tE(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iq(""+t.key):e.toString(36)}function n_(t,e,n,i,r){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var d=!1;if(t===null)d=!0;else switch(a){case"string":case"number":d=!0;break;case"object":switch(t.$$typeof){case Ov:case W8:d=!0}}if(d)return d=t,r=r(d),t=i===""?"."+tE(d,0):i,IO(r)?(n="",t!=null&&(n=t.replace(AO,"$&/")+"/"),n_(r,e,n,"",function(g){return g})):r!=null&&(m2(r)&&(r=nq(r,n+(!r.key||d&&d.key===r.key?"":(""+r.key).replace(AO,"$&/")+"/")+t)),e.push(r)),1;if(d=0,i=i===""?".":i+":",IO(t))for(var o=0;o<t.length;o++){a=t[o];var f=i+tE(a,o);d+=n_(a,e,n,f,r)}else if(f=tq(t),typeof f=="function")for(t=f.call(t),o=0;!(a=t.next()).done;)a=a.value,f=i+tE(a,o++),d+=n_(a,e,n,f,r);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function _b(t,e,n){if(t==null)return t;var i=[],r=0;return n_(t,i,"","",function(a){return e.call(n,a,r++)}),i}function rq(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var es={current:null},i_={transition:null},oq={ReactCurrentDispatcher:es,ReactCurrentBatchConfig:i_,ReactCurrentOwner:p2};Jn.Children={map:_b,forEach:function(t,e,n){_b(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _b(t,function(){e++}),e},toArray:function(t){return _b(t,function(e){return e})||[]},only:function(t){if(!m2(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Jn.Component=hm;Jn.Fragment=G8;Jn.Profiler=Z8;Jn.PureComponent=h2;Jn.StrictMode=H8;Jn.Suspense=J8;Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oq;Jn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=pB({},t.props),r=t.key,a=t.ref,d=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,d=p2.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(f in e)yB.call(e,f)&&!vB.hasOwnProperty(f)&&(i[f]=e[f]===void 0&&o!==void 0?o[f]:e[f])}var f=arguments.length-2;if(f===1)i.children=n;else if(1<f){o=Array(f);for(var g=0;g<f;g++)o[g]=arguments[g+2];i.children=o}return{$$typeof:Ov,type:t.type,key:r,ref:a,props:i,_owner:d}};Jn.createContext=function(t){return t={$$typeof:K8,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:X8,_context:t},t.Consumer=t};Jn.createElement=bB;Jn.createFactory=function(t){var e=bB.bind(null,t);return e.type=t,e};Jn.createRef=function(){return{current:null}};Jn.forwardRef=function(t){return{$$typeof:Y8,render:t}};Jn.isValidElement=m2;Jn.lazy=function(t){return{$$typeof:eq,_payload:{_status:-1,_result:t},_init:rq}};Jn.memo=function(t,e){return{$$typeof:Q8,type:t,compare:e===void 0?null:e}};Jn.startTransition=function(t){var e=i_.transition;i_.transition={};try{t()}finally{i_.transition=e}};Jn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Jn.useCallback=function(t,e){return es.current.useCallback(t,e)};Jn.useContext=function(t){return es.current.useContext(t)};Jn.useDebugValue=function(){};Jn.useDeferredValue=function(t){return es.current.useDeferredValue(t)};Jn.useEffect=function(t,e){return es.current.useEffect(t,e)};Jn.useId=function(){return es.current.useId()};Jn.useImperativeHandle=function(t,e,n){return es.current.useImperativeHandle(t,e,n)};Jn.useInsertionEffect=function(t,e){return es.current.useInsertionEffect(t,e)};Jn.useLayoutEffect=function(t,e){return es.current.useLayoutEffect(t,e)};Jn.useMemo=function(t,e){return es.current.useMemo(t,e)};Jn.useReducer=function(t,e,n){return es.current.useReducer(t,e,n)};Jn.useRef=function(t){return es.current.useRef(t)};Jn.useState=function(t){return es.current.useState(t)};Jn.useSyncExternalStore=function(t,e,n){return es.current.useSyncExternalStore(t,e,n)};Jn.useTransition=function(){return es.current.useTransition()};Jn.version="18.2.0";hB.exports=Jn;var et=hB.exports;const We=_c(et);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sq=et,aq=Symbol.for("react.element"),lq=Symbol.for("react.fragment"),cq=Object.prototype.hasOwnProperty,uq=sq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dq={key:!0,ref:!0,__self:!0,__source:!0};function _B(t,e,n){var i,r={},a=null,d=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(d=e.ref);for(i in e)cq.call(e,i)&&!dq.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:aq,type:t,key:a,ref:d,props:r,_owner:uq.current}}t1.Fragment=lq;t1.jsx=_B;t1.jsxs=_B;dB.exports=t1;var g2=dB.exports;const hq=g2.Fragment,Ae=g2.jsx,Qt=g2.jsxs;var xB={exports:{}},Vs={},wB={exports:{}},SB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ze,ot){var Be=ze.length;ze.push(ot);e:for(;0<Be;){var ft=Be-1>>>1,gt=ze[ft];if(0<r(gt,ot))ze[ft]=ot,ze[Be]=gt,Be=ft;else break e}}function n(ze){return ze.length===0?null:ze[0]}function i(ze){if(ze.length===0)return null;var ot=ze[0],Be=ze.pop();if(Be!==ot){ze[0]=Be;e:for(var ft=0,gt=ze.length,Nt=gt>>>1;ft<Nt;){var en=2*(ft+1)-1,Xt=ze[en],wt=en+1,Zt=ze[wt];if(0>r(Xt,Be))wt<gt&&0>r(Zt,Xt)?(ze[ft]=Zt,ze[wt]=Be,ft=wt):(ze[ft]=Xt,ze[en]=Be,ft=en);else if(wt<gt&&0>r(Zt,Be))ze[ft]=Zt,ze[wt]=Be,ft=wt;else break e}}return ot}function r(ze,ot){var Be=ze.sortIndex-ot.sortIndex;return Be!==0?Be:ze.id-ot.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var d=Date,o=d.now();t.unstable_now=function(){return d.now()-o}}var f=[],g=[],_=1,w=null,T=3,A=!1,D=!1,z=!1,G=typeof setTimeout=="function"?setTimeout:null,V=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function q(ze){for(var ot=n(g);ot!==null;){if(ot.callback===null)i(g);else if(ot.startTime<=ze)i(g),ot.sortIndex=ot.expirationTime,e(f,ot);else break;ot=n(g)}}function K(ze){if(z=!1,q(ze),!D)if(n(f)!==null)D=!0,lt(se);else{var ot=n(g);ot!==null&&zt(K,ot.startTime-ze)}}function se(ze,ot){D=!1,z&&(z=!1,V(J),J=-1),A=!0;var Be=T;try{for(q(ot),w=n(f);w!==null&&(!(w.expirationTime>ot)||ze&&!Fe());){var ft=w.callback;if(typeof ft=="function"){w.callback=null,T=w.priorityLevel;var gt=ft(w.expirationTime<=ot);ot=t.unstable_now(),typeof gt=="function"?w.callback=gt:w===n(f)&&i(f),q(ot)}else i(f);w=n(f)}if(w!==null)var Nt=!0;else{var en=n(g);en!==null&&zt(K,en.startTime-ot),Nt=!1}return Nt}finally{w=null,T=Be,A=!1}}var ie=!1,Q=null,J=-1,te=5,me=-1;function Fe(){return!(t.unstable_now()-me<te)}function tt(){if(Q!==null){var ze=t.unstable_now();me=ze;var ot=!0;try{ot=Q(!0,ze)}finally{ot?At():(ie=!1,Q=null)}}else ie=!1}var At;if(typeof N=="function")At=function(){N(tt)};else if(typeof MessageChannel<"u"){var _t=new MessageChannel,xt=_t.port2;_t.port1.onmessage=tt,At=function(){xt.postMessage(null)}}else At=function(){G(tt,0)};function lt(ze){Q=ze,ie||(ie=!0,At())}function zt(ze,ot){J=G(function(){ze(t.unstable_now())},ot)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ze){ze.callback=null},t.unstable_continueExecution=function(){D||A||(D=!0,lt(se))},t.unstable_forceFrameRate=function(ze){0>ze||125<ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<ze?Math.floor(1e3/ze):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(ze){switch(T){case 1:case 2:case 3:var ot=3;break;default:ot=T}var Be=T;T=ot;try{return ze()}finally{T=Be}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ze,ot){switch(ze){case 1:case 2:case 3:case 4:case 5:break;default:ze=3}var Be=T;T=ze;try{return ot()}finally{T=Be}},t.unstable_scheduleCallback=function(ze,ot,Be){var ft=t.unstable_now();switch(typeof Be=="object"&&Be!==null?(Be=Be.delay,Be=typeof Be=="number"&&0<Be?ft+Be:ft):Be=ft,ze){case 1:var gt=-1;break;case 2:gt=250;break;case 5:gt=1073741823;break;case 4:gt=1e4;break;default:gt=5e3}return gt=Be+gt,ze={id:_++,callback:ot,priorityLevel:ze,startTime:Be,expirationTime:gt,sortIndex:-1},Be>ft?(ze.sortIndex=Be,e(g,ze),n(f)===null&&ze===n(g)&&(z?(V(J),J=-1):z=!0,zt(K,Be-ft))):(ze.sortIndex=gt,e(f,ze),D||A||(D=!0,lt(se))),ze},t.unstable_shouldYield=Fe,t.unstable_wrapCallback=function(ze){var ot=T;return function(){var Be=T;T=ot;try{return ze.apply(this,arguments)}finally{T=Be}}}})(SB);wB.exports=SB;var fq=wB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EB=et,Ns=fq;function jt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kB=new Set,Xy={};function zh(t,e){Up(t,e),Up(t+"Capture",e)}function Up(t,e){for(Xy[t]=e,t=0;t<e.length;t++)kB.add(e[t])}var pc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jk=Object.prototype.hasOwnProperty,pq=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,MO={},PO={};function mq(t){return jk.call(PO,t)?!0:jk.call(MO,t)?!1:pq.test(t)?PO[t]=!0:(MO[t]=!0,!1)}function gq(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yq(t,e,n,i){if(e===null||typeof e>"u"||gq(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ts(t,e,n,i,r,a,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=d}var xo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xo[t]=new ts(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xo[e]=new ts(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xo[t]=new ts(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xo[t]=new ts(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xo[t]=new ts(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xo[t]=new ts(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xo[t]=new ts(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xo[t]=new ts(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xo[t]=new ts(t,5,!1,t.toLowerCase(),null,!1,!1)});var y2=/[\-:]([a-z])/g;function v2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(y2,v2);xo[e]=new ts(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(y2,v2);xo[e]=new ts(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(y2,v2);xo[e]=new ts(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xo[t]=new ts(t,1,!1,t.toLowerCase(),null,!1,!1)});xo.xlinkHref=new ts("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xo[t]=new ts(t,1,!1,t.toLowerCase(),null,!0,!0)});function b2(t,e,n,i){var r=xo.hasOwnProperty(e)?xo[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yq(e,n,r,i)&&(n=null),i||r===null?mq(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var xc=EB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xb=Symbol.for("react.element"),sp=Symbol.for("react.portal"),ap=Symbol.for("react.fragment"),_2=Symbol.for("react.strict_mode"),Vk=Symbol.for("react.profiler"),TB=Symbol.for("react.provider"),CB=Symbol.for("react.context"),x2=Symbol.for("react.forward_ref"),Uk=Symbol.for("react.suspense"),qk=Symbol.for("react.suspense_list"),w2=Symbol.for("react.memo"),nu=Symbol.for("react.lazy"),IB=Symbol.for("react.offscreen"),OO=Symbol.iterator;function ty(t){return t===null||typeof t!="object"?null:(t=OO&&t[OO]||t["@@iterator"],typeof t=="function"?t:null)}var br=Object.assign,nE;function by(t){if(nE===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);nE=e&&e[1]||""}return`
`+nE+t}var iE=!1;function rE(t,e){if(!t||iE)return"";iE=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(g){var i=g}Reflect.construct(t,[],e)}else{try{e.call()}catch(g){i=g}t.call(e.prototype)}else{try{throw Error()}catch(g){i=g}t()}}catch(g){if(g&&i&&typeof g.stack=="string"){for(var r=g.stack.split(`
`),a=i.stack.split(`
`),d=r.length-1,o=a.length-1;1<=d&&0<=o&&r[d]!==a[o];)o--;for(;1<=d&&0<=o;d--,o--)if(r[d]!==a[o]){if(d!==1||o!==1)do if(d--,o--,0>o||r[d]!==a[o]){var f=`
`+r[d].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=d&&0<=o);break}}}finally{iE=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?by(t):""}function vq(t){switch(t.tag){case 5:return by(t.type);case 16:return by("Lazy");case 13:return by("Suspense");case 19:return by("SuspenseList");case 0:case 2:case 15:return t=rE(t.type,!1),t;case 11:return t=rE(t.type.render,!1),t;case 1:return t=rE(t.type,!0),t;default:return""}}function Wk(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ap:return"Fragment";case sp:return"Portal";case Vk:return"Profiler";case _2:return"StrictMode";case Uk:return"Suspense";case qk:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case CB:return(t.displayName||"Context")+".Consumer";case TB:return(t._context.displayName||"Context")+".Provider";case x2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case w2:return e=t.displayName||null,e!==null?e:Wk(t.type)||"Memo";case nu:e=t._payload,t=t._init;try{return Wk(t(e))}catch(n){}}return null}function bq(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wk(e);case 8:return e===_2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ru(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function AB(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _q(t){var e=AB(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(d){i=""+d,a.call(this,d)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(d){i=""+d},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wb(t){t._valueTracker||(t._valueTracker=_q(t))}function MB(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=AB(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function z_(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Gk(t,e){var n=e.checked;return br({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:t._wrapperState.initialChecked})}function DO(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Ru(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function PB(t,e){e=e.checked,e!=null&&b2(t,"checked",e,!1)}function Hk(t,e){PB(t,e);var n=Ru(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Zk(t,e.type,n):e.hasOwnProperty("defaultValue")&&Zk(t,e.type,Ru(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function RO(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Zk(t,e,n){(e!=="number"||z_(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var _y=Array.isArray;function Sp(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Ru(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Xk(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(jt(91));return br({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function LO(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(jt(92));if(_y(n)){if(1<n.length)throw Error(jt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ru(n)}}function OB(t,e){var n=Ru(e.value),i=Ru(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function zO(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function DB(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kk(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?DB(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Sb,RB=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Sb=Sb||document.createElement("div"),Sb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ky(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var My={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xq=["Webkit","ms","Moz","O"];Object.keys(My).forEach(function(t){xq.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),My[e]=My[t]})});function LB(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||My.hasOwnProperty(t)&&My[t]?(""+e).trim():e+"px"}function zB(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=LB(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var wq=br({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yk(t,e){if(e){if(wq[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(jt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(jt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(jt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(jt(62))}}function Jk(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qk=null;function S2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var eT=null,Ep=null,kp=null;function BO(t){if(t=Lv(t)){if(typeof eT!="function")throw Error(jt(280));var e=t.stateNode;e&&(e=s1(e),eT(t.stateNode,t.type,e))}}function BB(t){Ep?kp?kp.push(t):kp=[t]:Ep=t}function FB(){if(Ep){var t=Ep,e=kp;if(kp=Ep=null,BO(t),e)for(t=0;t<e.length;t++)BO(e[t])}}function NB(t,e){return t(e)}function $B(){}var oE=!1;function jB(t,e,n){if(oE)return t(e,n);oE=!0;try{return NB(t,e,n)}finally{oE=!1,(Ep!==null||kp!==null)&&($B(),FB())}}function Yy(t,e){var n=t.stateNode;if(n===null)return null;var i=s1(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(jt(231,e,typeof n));return n}var tT=!1;if(pc)try{var ny={};Object.defineProperty(ny,"passive",{get:function(){tT=!0}}),window.addEventListener("test",ny,ny),window.removeEventListener("test",ny,ny)}catch(t){tT=!1}function Sq(t,e,n,i,r,a,d,o,f){var g=Array.prototype.slice.call(arguments,3);try{e.apply(n,g)}catch(_){this.onError(_)}}var Py=!1,B_=null,F_=!1,nT=null,Eq={onError:function(t){Py=!0,B_=t}};function kq(t,e,n,i,r,a,d,o,f){Py=!1,B_=null,Sq.apply(Eq,arguments)}function Tq(t,e,n,i,r,a,d,o,f){if(kq.apply(this,arguments),Py){if(Py){var g=B_;Py=!1,B_=null}else throw Error(jt(198));F_||(F_=!0,nT=g)}}function Bh(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function VB(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function FO(t){if(Bh(t)!==t)throw Error(jt(188))}function Cq(t){var e=t.alternate;if(!e){if(e=Bh(t),e===null)throw Error(jt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var a=r.alternate;if(a===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return FO(r),t;if(a===i)return FO(r),e;a=a.sibling}throw Error(jt(188))}if(n.return!==i.return)n=r,i=a;else{for(var d=!1,o=r.child;o;){if(o===n){d=!0,n=r,i=a;break}if(o===i){d=!0,i=r,n=a;break}o=o.sibling}if(!d){for(o=a.child;o;){if(o===n){d=!0,n=a,i=r;break}if(o===i){d=!0,i=a,n=r;break}o=o.sibling}if(!d)throw Error(jt(189))}}if(n.alternate!==i)throw Error(jt(190))}if(n.tag!==3)throw Error(jt(188));return n.stateNode.current===n?t:e}function UB(t){return t=Cq(t),t!==null?qB(t):null}function qB(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qB(t);if(e!==null)return e;t=t.sibling}return null}var WB=Ns.unstable_scheduleCallback,NO=Ns.unstable_cancelCallback,Iq=Ns.unstable_shouldYield,Aq=Ns.unstable_requestPaint,Or=Ns.unstable_now,Mq=Ns.unstable_getCurrentPriorityLevel,E2=Ns.unstable_ImmediatePriority,GB=Ns.unstable_UserBlockingPriority,N_=Ns.unstable_NormalPriority,Pq=Ns.unstable_LowPriority,HB=Ns.unstable_IdlePriority,n1=null,kl=null;function Oq(t){if(kl&&typeof kl.onCommitFiberRoot=="function")try{kl.onCommitFiberRoot(n1,t,void 0,(t.current.flags&128)===128)}catch(e){}}var Ha=Math.clz32?Math.clz32:Lq,Dq=Math.log,Rq=Math.LN2;function Lq(t){return t>>>=0,t===0?32:31-(Dq(t)/Rq|0)|0}var Eb=64,kb=4194304;function xy(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function $_(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,a=t.pingedLanes,d=n&268435455;if(d!==0){var o=d&~r;o!==0?i=xy(o):(a&=d,a!==0&&(i=xy(a)))}else d=n&~r,d!==0?i=xy(d):a!==0&&(i=xy(a));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,a=e&-e,r>=a||r===16&&(a&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Ha(e),r=1<<n,i|=t[n],e&=~r;return i}function zq(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bq(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,a=t.pendingLanes;0<a;){var d=31-Ha(a),o=1<<d,f=r[d];f===-1?(!(o&n)||o&i)&&(r[d]=zq(o,e)):f<=e&&(t.expiredLanes|=o),a&=~o}}function iT(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ZB(){var t=Eb;return Eb<<=1,!(Eb&4194240)&&(Eb=64),t}function sE(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Dv(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ha(e),t[e]=n}function Fq(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Ha(n),a=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~a}}function k2(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Ha(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var ki=0;function XB(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var KB,T2,YB,JB,QB,rT=!1,Tb=[],_u=null,xu=null,wu=null,Jy=new Map,Qy=new Map,uu=[],Nq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $O(t,e){switch(t){case"focusin":case"focusout":_u=null;break;case"dragenter":case"dragleave":xu=null;break;case"mouseover":case"mouseout":wu=null;break;case"pointerover":case"pointerout":Jy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qy.delete(e.pointerId)}}function iy(t,e,n,i,r,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[r]},e!==null&&(e=Lv(e),e!==null&&T2(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function $q(t,e,n,i,r){switch(e){case"focusin":return _u=iy(_u,t,e,n,i,r),!0;case"dragenter":return xu=iy(xu,t,e,n,i,r),!0;case"mouseover":return wu=iy(wu,t,e,n,i,r),!0;case"pointerover":var a=r.pointerId;return Jy.set(a,iy(Jy.get(a)||null,t,e,n,i,r)),!0;case"gotpointercapture":return a=r.pointerId,Qy.set(a,iy(Qy.get(a)||null,t,e,n,i,r)),!0}return!1}function eF(t){var e=Yd(t.target);if(e!==null){var n=Bh(e);if(n!==null){if(e=n.tag,e===13){if(e=VB(n),e!==null){t.blockedOn=e,QB(t.priority,function(){YB(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function r_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=oT(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Qk=i,n.target.dispatchEvent(i),Qk=null}else return e=Lv(n),e!==null&&T2(e),t.blockedOn=n,!1;e.shift()}return!0}function jO(t,e,n){r_(t)&&n.delete(e)}function jq(){rT=!1,_u!==null&&r_(_u)&&(_u=null),xu!==null&&r_(xu)&&(xu=null),wu!==null&&r_(wu)&&(wu=null),Jy.forEach(jO),Qy.forEach(jO)}function ry(t,e){t.blockedOn===e&&(t.blockedOn=null,rT||(rT=!0,Ns.unstable_scheduleCallback(Ns.unstable_NormalPriority,jq)))}function ev(t){function e(r){return ry(r,t)}if(0<Tb.length){ry(Tb[0],t);for(var n=1;n<Tb.length;n++){var i=Tb[n];i.blockedOn===t&&(i.blockedOn=null)}}for(_u!==null&&ry(_u,t),xu!==null&&ry(xu,t),wu!==null&&ry(wu,t),Jy.forEach(e),Qy.forEach(e),n=0;n<uu.length;n++)i=uu[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<uu.length&&(n=uu[0],n.blockedOn===null);)eF(n),n.blockedOn===null&&uu.shift()}var Tp=xc.ReactCurrentBatchConfig,j_=!0;function Vq(t,e,n,i){var r=ki,a=Tp.transition;Tp.transition=null;try{ki=1,C2(t,e,n,i)}finally{ki=r,Tp.transition=a}}function Uq(t,e,n,i){var r=ki,a=Tp.transition;Tp.transition=null;try{ki=4,C2(t,e,n,i)}finally{ki=r,Tp.transition=a}}function C2(t,e,n,i){if(j_){var r=oT(t,e,n,i);if(r===null)gE(t,e,i,V_,n),$O(t,i);else if($q(r,t,e,n,i))i.stopPropagation();else if($O(t,i),e&4&&-1<Nq.indexOf(t)){for(;r!==null;){var a=Lv(r);if(a!==null&&KB(a),a=oT(t,e,n,i),a===null&&gE(t,e,i,V_,n),a===r)break;r=a}r!==null&&i.stopPropagation()}else gE(t,e,i,null,n)}}var V_=null;function oT(t,e,n,i){if(V_=null,t=S2(i),t=Yd(t),t!==null)if(e=Bh(t),e===null)t=null;else if(n=e.tag,n===13){if(t=VB(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return V_=t,null}function tF(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Mq()){case E2:return 1;case GB:return 4;case N_:case Pq:return 16;case HB:return 536870912;default:return 16}default:return 16}}var mu=null,I2=null,o_=null;function nF(){if(o_)return o_;var t,e=I2,n=e.length,i,r="value"in mu?mu.value:mu.textContent,a=r.length;for(t=0;t<n&&e[t]===r[t];t++);var d=n-t;for(i=1;i<=d&&e[n-i]===r[a-i];i++);return o_=r.slice(t,1<i?1-i:void 0)}function s_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Cb(){return!0}function VO(){return!1}function Us(t){function e(n,i,r,a,d){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=a,this.target=d,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Cb:VO,this.isPropagationStopped=VO,this}return br(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Cb)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Cb)},persist:function(){},isPersistent:Cb}),e}var fm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},A2=Us(fm),Rv=br({},fm,{view:0,detail:0}),qq=Us(Rv),aE,lE,oy,i1=br({},Rv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:M2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==oy&&(oy&&t.type==="mousemove"?(aE=t.screenX-oy.screenX,lE=t.screenY-oy.screenY):lE=aE=0,oy=t),aE)},movementY:function(t){return"movementY"in t?t.movementY:lE}}),UO=Us(i1),Wq=br({},i1,{dataTransfer:0}),Gq=Us(Wq),Hq=br({},Rv,{relatedTarget:0}),cE=Us(Hq),Zq=br({},fm,{animationName:0,elapsedTime:0,pseudoElement:0}),Xq=Us(Zq),Kq=br({},fm,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Yq=Us(Kq),Jq=br({},fm,{data:0}),qO=Us(Jq),Qq={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tW[t])?!!e[t]:!1}function M2(){return nW}var iW=br({},Rv,{key:function(t){if(t.key){var e=Qq[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=s_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:M2,charCode:function(t){return t.type==="keypress"?s_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?s_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),rW=Us(iW),oW=br({},i1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),WO=Us(oW),sW=br({},Rv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:M2}),aW=Us(sW),lW=br({},fm,{propertyName:0,elapsedTime:0,pseudoElement:0}),cW=Us(lW),uW=br({},i1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dW=Us(uW),hW=[9,13,27,32],P2=pc&&"CompositionEvent"in window,Oy=null;pc&&"documentMode"in document&&(Oy=document.documentMode);var fW=pc&&"TextEvent"in window&&!Oy,iF=pc&&(!P2||Oy&&8<Oy&&11>=Oy),GO=String.fromCharCode(32),HO=!1;function rF(t,e){switch(t){case"keyup":return hW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oF(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var lp=!1;function pW(t,e){switch(t){case"compositionend":return oF(e);case"keypress":return e.which!==32?null:(HO=!0,GO);case"textInput":return t=e.data,t===GO&&HO?null:t;default:return null}}function mW(t,e){if(lp)return t==="compositionend"||!P2&&rF(t,e)?(t=nF(),o_=I2=mu=null,lp=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return iF&&e.locale!=="ko"?null:e.data;default:return null}}var gW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZO(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gW[t.type]:e==="textarea"}function sF(t,e,n,i){BB(i),e=U_(e,"onChange"),0<e.length&&(n=new A2("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Dy=null,tv=null;function yW(t){yF(t,0)}function r1(t){var e=dp(t);if(MB(e))return t}function vW(t,e){if(t==="change")return e}var aF=!1;if(pc){var uE;if(pc){var dE="oninput"in document;if(!dE){var XO=document.createElement("div");XO.setAttribute("oninput","return;"),dE=typeof XO.oninput=="function"}uE=dE}else uE=!1;aF=uE&&(!document.documentMode||9<document.documentMode)}function KO(){Dy&&(Dy.detachEvent("onpropertychange",lF),tv=Dy=null)}function lF(t){if(t.propertyName==="value"&&r1(tv)){var e=[];sF(e,tv,t,S2(t)),jB(yW,e)}}function bW(t,e,n){t==="focusin"?(KO(),Dy=e,tv=n,Dy.attachEvent("onpropertychange",lF)):t==="focusout"&&KO()}function _W(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return r1(tv)}function xW(t,e){if(t==="click")return r1(e)}function wW(t,e){if(t==="input"||t==="change")return r1(e)}function SW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qa=typeof Object.is=="function"?Object.is:SW;function nv(t,e){if(Qa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!jk.call(e,r)||!Qa(t[r],e[r]))return!1}return!0}function YO(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function JO(t,e){var n=YO(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=YO(n)}}function cF(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?cF(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function uF(){for(var t=window,e=z_();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch(i){n=!1}if(n)t=e.contentWindow;else break;e=z_(t.document)}return e}function O2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function EW(t){var e=uF(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&cF(n.ownerDocument.documentElement,n)){if(i!==null&&O2(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,a=Math.min(i.start,r);i=i.end===void 0?a:Math.min(i.end,r),!t.extend&&a>i&&(r=i,i=a,a=r),r=JO(n,a);var d=JO(n,i);r&&d&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==d.node||t.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),a>i?(t.addRange(e),t.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kW=pc&&"documentMode"in document&&11>=document.documentMode,cp=null,sT=null,Ry=null,aT=!1;function QO(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;aT||cp==null||cp!==z_(i)||(i=cp,"selectionStart"in i&&O2(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ry&&nv(Ry,i)||(Ry=i,i=U_(sT,"onSelect"),0<i.length&&(e=new A2("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=cp)))}function Ib(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var up={animationend:Ib("Animation","AnimationEnd"),animationiteration:Ib("Animation","AnimationIteration"),animationstart:Ib("Animation","AnimationStart"),transitionend:Ib("Transition","TransitionEnd")},hE={},dF={};pc&&(dF=document.createElement("div").style,"AnimationEvent"in window||(delete up.animationend.animation,delete up.animationiteration.animation,delete up.animationstart.animation),"TransitionEvent"in window||delete up.transitionend.transition);function o1(t){if(hE[t])return hE[t];if(!up[t])return t;var e=up[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in dF)return hE[t]=e[n];return t}var hF=o1("animationend"),fF=o1("animationiteration"),pF=o1("animationstart"),mF=o1("transitionend"),gF=new Map,eD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qu(t,e){gF.set(t,e),zh(e,[t])}for(var fE=0;fE<eD.length;fE++){var pE=eD[fE],TW=pE.toLowerCase(),CW=pE[0].toUpperCase()+pE.slice(1);qu(TW,"on"+CW)}qu(hF,"onAnimationEnd");qu(fF,"onAnimationIteration");qu(pF,"onAnimationStart");qu("dblclick","onDoubleClick");qu("focusin","onFocus");qu("focusout","onBlur");qu(mF,"onTransitionEnd");Up("onMouseEnter",["mouseout","mouseover"]);Up("onMouseLeave",["mouseout","mouseover"]);Up("onPointerEnter",["pointerout","pointerover"]);Up("onPointerLeave",["pointerout","pointerover"]);zh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zh("onBeforeInput",["compositionend","keypress","textInput","paste"]);zh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IW=new Set("cancel close invalid load scroll toggle".split(" ").concat(wy));function tD(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,Tq(i,e,void 0,t),t.currentTarget=null}function yF(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var a=void 0;if(e)for(var d=i.length-1;0<=d;d--){var o=i[d],f=o.instance,g=o.currentTarget;if(o=o.listener,f!==a&&r.isPropagationStopped())break e;tD(r,o,g),a=f}else for(d=0;d<i.length;d++){if(o=i[d],f=o.instance,g=o.currentTarget,o=o.listener,f!==a&&r.isPropagationStopped())break e;tD(r,o,g),a=f}}}if(F_)throw t=nT,F_=!1,nT=null,t}function Hi(t,e){var n=e[hT];n===void 0&&(n=e[hT]=new Set);var i=t+"__bubble";n.has(i)||(vF(e,t,2,!1),n.add(i))}function mE(t,e,n){var i=0;e&&(i|=4),vF(n,t,i,e)}var Ab="_reactListening"+Math.random().toString(36).slice(2);function iv(t){if(!t[Ab]){t[Ab]=!0,kB.forEach(function(n){n!=="selectionchange"&&(IW.has(n)||mE(n,!1,t),mE(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ab]||(e[Ab]=!0,mE("selectionchange",!1,e))}}function vF(t,e,n,i){switch(tF(e)){case 1:var r=Vq;break;case 4:r=Uq;break;default:r=C2}n=r.bind(null,e,n,t),r=void 0,!tT||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function gE(t,e,n,i,r){var a=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var d=i.tag;if(d===3||d===4){var o=i.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(d===4)for(d=i.return;d!==null;){var f=d.tag;if((f===3||f===4)&&(f=d.stateNode.containerInfo,f===r||f.nodeType===8&&f.parentNode===r))return;d=d.return}for(;o!==null;){if(d=Yd(o),d===null)return;if(f=d.tag,f===5||f===6){i=a=d;continue e}o=o.parentNode}}i=i.return}jB(function(){var g=a,_=S2(n),w=[];e:{var T=gF.get(t);if(T!==void 0){var A=A2,D=t;switch(t){case"keypress":if(s_(n)===0)break e;case"keydown":case"keyup":A=rW;break;case"focusin":D="focus",A=cE;break;case"focusout":D="blur",A=cE;break;case"beforeblur":case"afterblur":A=cE;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=UO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=Gq;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=aW;break;case hF:case fF:case pF:A=Xq;break;case mF:A=cW;break;case"scroll":A=qq;break;case"wheel":A=dW;break;case"copy":case"cut":case"paste":A=Yq;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=WO}var z=(e&4)!==0,G=!z&&t==="scroll",V=z?T!==null?T+"Capture":null:T;z=[];for(var N=g,q;N!==null;){q=N;var K=q.stateNode;if(q.tag===5&&K!==null&&(q=K,V!==null&&(K=Yy(N,V),K!=null&&z.push(rv(N,K,q)))),G)break;N=N.return}0<z.length&&(T=new A(T,D,null,n,_),w.push({event:T,listeners:z}))}}if(!(e&7)){e:{if(T=t==="mouseover"||t==="pointerover",A=t==="mouseout"||t==="pointerout",T&&n!==Qk&&(D=n.relatedTarget||n.fromElement)&&(Yd(D)||D[mc]))break e;if((A||T)&&(T=_.window===_?_:(T=_.ownerDocument)?T.defaultView||T.parentWindow:window,A?(D=n.relatedTarget||n.toElement,A=g,D=D?Yd(D):null,D!==null&&(G=Bh(D),D!==G||D.tag!==5&&D.tag!==6)&&(D=null)):(A=null,D=g),A!==D)){if(z=UO,K="onMouseLeave",V="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(z=WO,K="onPointerLeave",V="onPointerEnter",N="pointer"),G=A==null?T:dp(A),q=D==null?T:dp(D),T=new z(K,N+"leave",A,n,_),T.target=G,T.relatedTarget=q,K=null,Yd(_)===g&&(z=new z(V,N+"enter",D,n,_),z.target=q,z.relatedTarget=G,K=z),G=K,A&&D)t:{for(z=A,V=D,N=0,q=z;q;q=Uf(q))N++;for(q=0,K=V;K;K=Uf(K))q++;for(;0<N-q;)z=Uf(z),N--;for(;0<q-N;)V=Uf(V),q--;for(;N--;){if(z===V||V!==null&&z===V.alternate)break t;z=Uf(z),V=Uf(V)}z=null}else z=null;A!==null&&nD(w,T,A,z,!1),D!==null&&G!==null&&nD(w,G,D,z,!0)}}e:{if(T=g?dp(g):window,A=T.nodeName&&T.nodeName.toLowerCase(),A==="select"||A==="input"&&T.type==="file")var se=vW;else if(ZO(T))if(aF)se=wW;else{se=_W;var ie=bW}else(A=T.nodeName)&&A.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(se=xW);if(se&&(se=se(t,g))){sF(w,se,n,_);break e}ie&&ie(t,T,g),t==="focusout"&&(ie=T._wrapperState)&&ie.controlled&&T.type==="number"&&Zk(T,"number",T.value)}switch(ie=g?dp(g):window,t){case"focusin":(ZO(ie)||ie.contentEditable==="true")&&(cp=ie,sT=g,Ry=null);break;case"focusout":Ry=sT=cp=null;break;case"mousedown":aT=!0;break;case"contextmenu":case"mouseup":case"dragend":aT=!1,QO(w,n,_);break;case"selectionchange":if(kW)break;case"keydown":case"keyup":QO(w,n,_)}var Q;if(P2)e:{switch(t){case"compositionstart":var J="onCompositionStart";break e;case"compositionend":J="onCompositionEnd";break e;case"compositionupdate":J="onCompositionUpdate";break e}J=void 0}else lp?rF(t,n)&&(J="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(J="onCompositionStart");J&&(iF&&n.locale!=="ko"&&(lp||J!=="onCompositionStart"?J==="onCompositionEnd"&&lp&&(Q=nF()):(mu=_,I2="value"in mu?mu.value:mu.textContent,lp=!0)),ie=U_(g,J),0<ie.length&&(J=new qO(J,t,null,n,_),w.push({event:J,listeners:ie}),Q?J.data=Q:(Q=oF(n),Q!==null&&(J.data=Q)))),(Q=fW?pW(t,n):mW(t,n))&&(g=U_(g,"onBeforeInput"),0<g.length&&(_=new qO("onBeforeInput","beforeinput",null,n,_),w.push({event:_,listeners:g}),_.data=Q))}yF(w,e)})}function rv(t,e,n){return{instance:t,listener:e,currentTarget:n}}function U_(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,a=r.stateNode;r.tag===5&&a!==null&&(r=a,a=Yy(t,n),a!=null&&i.unshift(rv(t,a,r)),a=Yy(t,e),a!=null&&i.push(rv(t,a,r))),t=t.return}return i}function Uf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function nD(t,e,n,i,r){for(var a=e._reactName,d=[];n!==null&&n!==i;){var o=n,f=o.alternate,g=o.stateNode;if(f!==null&&f===i)break;o.tag===5&&g!==null&&(o=g,r?(f=Yy(n,a),f!=null&&d.unshift(rv(n,f,o))):r||(f=Yy(n,a),f!=null&&d.push(rv(n,f,o)))),n=n.return}d.length!==0&&t.push({event:e,listeners:d})}var AW=/\r\n?/g,MW=/\u0000|\uFFFD/g;function iD(t){return(typeof t=="string"?t:""+t).replace(AW,`
`).replace(MW,"")}function Mb(t,e,n){if(e=iD(e),iD(t)!==e&&n)throw Error(jt(425))}function q_(){}var lT=null,cT=null;function uT(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dT=typeof setTimeout=="function"?setTimeout:void 0,PW=typeof clearTimeout=="function"?clearTimeout:void 0,rD=typeof Promise=="function"?Promise:void 0,OW=typeof queueMicrotask=="function"?queueMicrotask:typeof rD<"u"?function(t){return rD.resolve(null).then(t).catch(DW)}:dT;function DW(t){setTimeout(function(){throw t})}function yE(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),ev(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);ev(e)}function Su(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function oD(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var pm=Math.random().toString(36).slice(2),_l="__reactFiber$"+pm,ov="__reactProps$"+pm,mc="__reactContainer$"+pm,hT="__reactEvents$"+pm,RW="__reactListeners$"+pm,LW="__reactHandles$"+pm;function Yd(t){var e=t[_l];if(e)return e;for(var n=t.parentNode;n;){if(e=n[mc]||n[_l]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=oD(t);t!==null;){if(n=t[_l])return n;t=oD(t)}return e}t=n,n=t.parentNode}return null}function Lv(t){return t=t[_l]||t[mc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function dp(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(jt(33))}function s1(t){return t[ov]||null}var fT=[],hp=-1;function Wu(t){return{current:t}}function Zi(t){0>hp||(t.current=fT[hp],fT[hp]=null,hp--)}function Ni(t,e){hp++,fT[hp]=t.current,t.current=e}var Lu={},Bo=Wu(Lu),bs=Wu(!1),gh=Lu;function qp(t,e){var n=t.type.contextTypes;if(!n)return Lu;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},a;for(a in n)r[a]=e[a];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function _s(t){return t=t.childContextTypes,t!=null}function W_(){Zi(bs),Zi(Bo)}function sD(t,e,n){if(Bo.current!==Lu)throw Error(jt(168));Ni(Bo,e),Ni(bs,n)}function bF(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(jt(108,bq(t)||"Unknown",r));return br({},n,i)}function G_(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Lu,gh=Bo.current,Ni(Bo,t),Ni(bs,bs.current),!0}function aD(t,e,n){var i=t.stateNode;if(!i)throw Error(jt(169));n?(t=bF(t,e,gh),i.__reactInternalMemoizedMergedChildContext=t,Zi(bs),Zi(Bo),Ni(Bo,t)):Zi(bs),Ni(bs,n)}var rc=null,a1=!1,vE=!1;function _F(t){rc===null?rc=[t]:rc.push(t)}function zW(t){a1=!0,_F(t)}function Gu(){if(!vE&&rc!==null){vE=!0;var t=0,e=ki;try{var n=rc;for(ki=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}rc=null,a1=!1}catch(r){throw rc!==null&&(rc=rc.slice(t+1)),WB(E2,Gu),r}finally{ki=e,vE=!1}}return null}var fp=[],pp=0,H_=null,Z_=0,oa=[],sa=0,yh=null,ac=1,lc="";function Gd(t,e){fp[pp++]=Z_,fp[pp++]=H_,H_=t,Z_=e}function xF(t,e,n){oa[sa++]=ac,oa[sa++]=lc,oa[sa++]=yh,yh=t;var i=ac;t=lc;var r=32-Ha(i)-1;i&=~(1<<r),n+=1;var a=32-Ha(e)+r;if(30<a){var d=r-r%5;a=(i&(1<<d)-1).toString(32),i>>=d,r-=d,ac=1<<32-Ha(e)+r|n<<r|i,lc=a+t}else ac=1<<a|n<<r|i,lc=t}function D2(t){t.return!==null&&(Gd(t,1),xF(t,1,0))}function R2(t){for(;t===H_;)H_=fp[--pp],fp[pp]=null,Z_=fp[--pp],fp[pp]=null;for(;t===yh;)yh=oa[--sa],oa[sa]=null,lc=oa[--sa],oa[sa]=null,ac=oa[--sa],oa[sa]=null}var Fs=null,Bs=null,ir=!1,ja=null;function wF(t,e){var n=la(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function lD(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Fs=t,Bs=Su(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Fs=t,Bs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=yh!==null?{id:ac,overflow:lc}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=la(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Fs=t,Bs=null,!0):!1;default:return!1}}function pT(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mT(t){if(ir){var e=Bs;if(e){var n=e;if(!lD(t,e)){if(pT(t))throw Error(jt(418));e=Su(n.nextSibling);var i=Fs;e&&lD(t,e)?wF(i,n):(t.flags=t.flags&-4097|2,ir=!1,Fs=t)}}else{if(pT(t))throw Error(jt(418));t.flags=t.flags&-4097|2,ir=!1,Fs=t}}}function cD(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Fs=t}function Pb(t){if(t!==Fs)return!1;if(!ir)return cD(t),ir=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!uT(t.type,t.memoizedProps)),e&&(e=Bs)){if(pT(t))throw SF(),Error(jt(418));for(;e;)wF(t,e),e=Su(e.nextSibling)}if(cD(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(jt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Bs=Su(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Bs=null}}else Bs=Fs?Su(t.stateNode.nextSibling):null;return!0}function SF(){for(var t=Bs;t;)t=Su(t.nextSibling)}function Wp(){Bs=Fs=null,ir=!1}function L2(t){ja===null?ja=[t]:ja.push(t)}var BW=xc.ReactCurrentBatchConfig;function Na(t,e){if(t&&t.defaultProps){e=br({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var X_=Wu(null),K_=null,mp=null,z2=null;function B2(){z2=mp=K_=null}function F2(t){var e=X_.current;Zi(X_),t._currentValue=e}function gT(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Cp(t,e){K_=t,z2=mp=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ys=!0),t.firstContext=null)}function fa(t){var e=t._currentValue;if(z2!==t)if(t={context:t,memoizedValue:e,next:null},mp===null){if(K_===null)throw Error(jt(308));mp=t,K_.dependencies={lanes:0,firstContext:t}}else mp=mp.next=t;return e}var Jd=null;function N2(t){Jd===null?Jd=[t]:Jd.push(t)}function EF(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,N2(e)):(n.next=r.next,r.next=n),e.interleaved=n,gc(t,i)}function gc(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var iu=!1;function $2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kF(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function uc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Eu(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,ri&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,gc(t,n)}return r=i.interleaved,r===null?(e.next=e,N2(i)):(e.next=r.next,r.next=e),i.interleaved=e,gc(t,n)}function a_(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,k2(t,n)}}function uD(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?r=a=d:a=a.next=d,n=n.next}while(n!==null);a===null?r=a=e:a=a.next=e}else r=a=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Y_(t,e,n,i){var r=t.updateQueue;iu=!1;var a=r.firstBaseUpdate,d=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var f=o,g=f.next;f.next=null,d===null?a=g:d.next=g,d=f;var _=t.alternate;_!==null&&(_=_.updateQueue,o=_.lastBaseUpdate,o!==d&&(o===null?_.firstBaseUpdate=g:o.next=g,_.lastBaseUpdate=f))}if(a!==null){var w=r.baseState;d=0,_=g=f=null,o=a;do{var T=o.lane,A=o.eventTime;if((i&T)===T){_!==null&&(_=_.next={eventTime:A,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var D=t,z=o;switch(T=e,A=n,z.tag){case 1:if(D=z.payload,typeof D=="function"){w=D.call(A,w,T);break e}w=D;break e;case 3:D.flags=D.flags&-65537|128;case 0:if(D=z.payload,T=typeof D=="function"?D.call(A,w,T):D,T==null)break e;w=br({},w,T);break e;case 2:iu=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,T=r.effects,T===null?r.effects=[o]:T.push(o))}else A={eventTime:A,lane:T,tag:o.tag,payload:o.payload,callback:o.callback,next:null},_===null?(g=_=A,f=w):_=_.next=A,d|=T;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;T=o,o=T.next,T.next=null,r.lastBaseUpdate=T,r.shared.pending=null}}while(1);if(_===null&&(f=w),r.baseState=f,r.firstBaseUpdate=g,r.lastBaseUpdate=_,e=r.shared.interleaved,e!==null){r=e;do d|=r.lane,r=r.next;while(r!==e)}else a===null&&(r.shared.lanes=0);bh|=d,t.lanes=d,t.memoizedState=w}}function dD(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(jt(191,r));r.call(i)}}}var TF=new EB.Component().refs;function yT(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:br({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var l1={isMounted:function(t){return(t=t._reactInternals)?Bh(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Ko(),r=Tu(t),a=uc(i,r);a.payload=e,n!=null&&(a.callback=n),e=Eu(t,a,r),e!==null&&(Za(e,t,r,i),a_(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Ko(),r=Tu(t),a=uc(i,r);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=Eu(t,a,r),e!==null&&(Za(e,t,r,i),a_(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ko(),i=Tu(t),r=uc(n,i);r.tag=2,e!=null&&(r.callback=e),e=Eu(t,r,i),e!==null&&(Za(e,t,i,n),a_(e,t,i))}};function hD(t,e,n,i,r,a,d){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,a,d):e.prototype&&e.prototype.isPureReactComponent?!nv(n,i)||!nv(r,a):!0}function CF(t,e,n){var i=!1,r=Lu,a=e.contextType;return typeof a=="object"&&a!==null?a=fa(a):(r=_s(e)?gh:Bo.current,i=e.contextTypes,a=(i=i!=null)?qp(t,r):Lu),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=l1,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=a),e}function fD(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&l1.enqueueReplaceState(e,e.state,null)}function vT(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=TF,$2(t);var a=e.contextType;typeof a=="object"&&a!==null?r.context=fa(a):(a=_s(e)?gh:Bo.current,r.context=qp(t,a)),r.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(yT(t,e,a,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&l1.enqueueReplaceState(r,r.state,null),Y_(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function sy(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(jt(309));var i=n.stateNode}if(!i)throw Error(jt(147,t));var r=i,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(d){var o=r.refs;o===TF&&(o=r.refs={}),d===null?delete o[a]:o[a]=d},e._stringRef=a,e)}if(typeof t!="string")throw Error(jt(284));if(!n._owner)throw Error(jt(290,t))}return t}function Ob(t,e){throw t=Object.prototype.toString.call(e),Error(jt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function pD(t){var e=t._init;return e(t._payload)}function IF(t){function e(V,N){if(t){var q=V.deletions;q===null?(V.deletions=[N],V.flags|=16):q.push(N)}}function n(V,N){if(!t)return null;for(;N!==null;)e(V,N),N=N.sibling;return null}function i(V,N){for(V=new Map;N!==null;)N.key!==null?V.set(N.key,N):V.set(N.index,N),N=N.sibling;return V}function r(V,N){return V=Cu(V,N),V.index=0,V.sibling=null,V}function a(V,N,q){return V.index=q,t?(q=V.alternate,q!==null?(q=q.index,q<N?(V.flags|=2,N):q):(V.flags|=2,N)):(V.flags|=1048576,N)}function d(V){return t&&V.alternate===null&&(V.flags|=2),V}function o(V,N,q,K){return N===null||N.tag!==6?(N=kE(q,V.mode,K),N.return=V,N):(N=r(N,q),N.return=V,N)}function f(V,N,q,K){var se=q.type;return se===ap?_(V,N,q.props.children,K,q.key):N!==null&&(N.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===nu&&pD(se)===N.type)?(K=r(N,q.props),K.ref=sy(V,N,q),K.return=V,K):(K=f_(q.type,q.key,q.props,null,V.mode,K),K.ref=sy(V,N,q),K.return=V,K)}function g(V,N,q,K){return N===null||N.tag!==4||N.stateNode.containerInfo!==q.containerInfo||N.stateNode.implementation!==q.implementation?(N=TE(q,V.mode,K),N.return=V,N):(N=r(N,q.children||[]),N.return=V,N)}function _(V,N,q,K,se){return N===null||N.tag!==7?(N=sh(q,V.mode,K,se),N.return=V,N):(N=r(N,q),N.return=V,N)}function w(V,N,q){if(typeof N=="string"&&N!==""||typeof N=="number")return N=kE(""+N,V.mode,q),N.return=V,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case xb:return q=f_(N.type,N.key,N.props,null,V.mode,q),q.ref=sy(V,null,N),q.return=V,q;case sp:return N=TE(N,V.mode,q),N.return=V,N;case nu:var K=N._init;return w(V,K(N._payload),q)}if(_y(N)||ty(N))return N=sh(N,V.mode,q,null),N.return=V,N;Ob(V,N)}return null}function T(V,N,q,K){var se=N!==null?N.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return se!==null?null:o(V,N,""+q,K);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case xb:return q.key===se?f(V,N,q,K):null;case sp:return q.key===se?g(V,N,q,K):null;case nu:return se=q._init,T(V,N,se(q._payload),K)}if(_y(q)||ty(q))return se!==null?null:_(V,N,q,K,null);Ob(V,q)}return null}function A(V,N,q,K,se){if(typeof K=="string"&&K!==""||typeof K=="number")return V=V.get(q)||null,o(N,V,""+K,se);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case xb:return V=V.get(K.key===null?q:K.key)||null,f(N,V,K,se);case sp:return V=V.get(K.key===null?q:K.key)||null,g(N,V,K,se);case nu:var ie=K._init;return A(V,N,q,ie(K._payload),se)}if(_y(K)||ty(K))return V=V.get(q)||null,_(N,V,K,se,null);Ob(N,K)}return null}function D(V,N,q,K){for(var se=null,ie=null,Q=N,J=N=0,te=null;Q!==null&&J<q.length;J++){Q.index>J?(te=Q,Q=null):te=Q.sibling;var me=T(V,Q,q[J],K);if(me===null){Q===null&&(Q=te);break}t&&Q&&me.alternate===null&&e(V,Q),N=a(me,N,J),ie===null?se=me:ie.sibling=me,ie=me,Q=te}if(J===q.length)return n(V,Q),ir&&Gd(V,J),se;if(Q===null){for(;J<q.length;J++)Q=w(V,q[J],K),Q!==null&&(N=a(Q,N,J),ie===null?se=Q:ie.sibling=Q,ie=Q);return ir&&Gd(V,J),se}for(Q=i(V,Q);J<q.length;J++)te=A(Q,V,J,q[J],K),te!==null&&(t&&te.alternate!==null&&Q.delete(te.key===null?J:te.key),N=a(te,N,J),ie===null?se=te:ie.sibling=te,ie=te);return t&&Q.forEach(function(Fe){return e(V,Fe)}),ir&&Gd(V,J),se}function z(V,N,q,K){var se=ty(q);if(typeof se!="function")throw Error(jt(150));if(q=se.call(q),q==null)throw Error(jt(151));for(var ie=se=null,Q=N,J=N=0,te=null,me=q.next();Q!==null&&!me.done;J++,me=q.next()){Q.index>J?(te=Q,Q=null):te=Q.sibling;var Fe=T(V,Q,me.value,K);if(Fe===null){Q===null&&(Q=te);break}t&&Q&&Fe.alternate===null&&e(V,Q),N=a(Fe,N,J),ie===null?se=Fe:ie.sibling=Fe,ie=Fe,Q=te}if(me.done)return n(V,Q),ir&&Gd(V,J),se;if(Q===null){for(;!me.done;J++,me=q.next())me=w(V,me.value,K),me!==null&&(N=a(me,N,J),ie===null?se=me:ie.sibling=me,ie=me);return ir&&Gd(V,J),se}for(Q=i(V,Q);!me.done;J++,me=q.next())me=A(Q,V,J,me.value,K),me!==null&&(t&&me.alternate!==null&&Q.delete(me.key===null?J:me.key),N=a(me,N,J),ie===null?se=me:ie.sibling=me,ie=me);return t&&Q.forEach(function(tt){return e(V,tt)}),ir&&Gd(V,J),se}function G(V,N,q,K){if(typeof q=="object"&&q!==null&&q.type===ap&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case xb:e:{for(var se=q.key,ie=N;ie!==null;){if(ie.key===se){if(se=q.type,se===ap){if(ie.tag===7){n(V,ie.sibling),N=r(ie,q.props.children),N.return=V,V=N;break e}}else if(ie.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===nu&&pD(se)===ie.type){n(V,ie.sibling),N=r(ie,q.props),N.ref=sy(V,ie,q),N.return=V,V=N;break e}n(V,ie);break}else e(V,ie);ie=ie.sibling}q.type===ap?(N=sh(q.props.children,V.mode,K,q.key),N.return=V,V=N):(K=f_(q.type,q.key,q.props,null,V.mode,K),K.ref=sy(V,N,q),K.return=V,V=K)}return d(V);case sp:e:{for(ie=q.key;N!==null;){if(N.key===ie)if(N.tag===4&&N.stateNode.containerInfo===q.containerInfo&&N.stateNode.implementation===q.implementation){n(V,N.sibling),N=r(N,q.children||[]),N.return=V,V=N;break e}else{n(V,N);break}else e(V,N);N=N.sibling}N=TE(q,V.mode,K),N.return=V,V=N}return d(V);case nu:return ie=q._init,G(V,N,ie(q._payload),K)}if(_y(q))return D(V,N,q,K);if(ty(q))return z(V,N,q,K);Ob(V,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,N!==null&&N.tag===6?(n(V,N.sibling),N=r(N,q),N.return=V,V=N):(n(V,N),N=kE(q,V.mode,K),N.return=V,V=N),d(V)):n(V,N)}return G}var Gp=IF(!0),AF=IF(!1),zv={},Tl=Wu(zv),sv=Wu(zv),av=Wu(zv);function Qd(t){if(t===zv)throw Error(jt(174));return t}function j2(t,e){switch(Ni(av,e),Ni(sv,t),Ni(Tl,zv),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Kk(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Kk(e,t)}Zi(Tl),Ni(Tl,e)}function Hp(){Zi(Tl),Zi(sv),Zi(av)}function MF(t){Qd(av.current);var e=Qd(Tl.current),n=Kk(e,t.type);e!==n&&(Ni(sv,t),Ni(Tl,n))}function V2(t){sv.current===t&&(Zi(Tl),Zi(sv))}var gr=Wu(0);function J_(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var bE=[];function U2(){for(var t=0;t<bE.length;t++)bE[t]._workInProgressVersionPrimary=null;bE.length=0}var l_=xc.ReactCurrentDispatcher,_E=xc.ReactCurrentBatchConfig,vh=0,vr=null,Zr=null,io=null,Q_=!1,Ly=!1,lv=0,FW=0;function Po(){throw Error(jt(321))}function q2(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Qa(t[n],e[n]))return!1;return!0}function W2(t,e,n,i,r,a){if(vh=a,vr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,l_.current=t===null||t.memoizedState===null?VW:UW,t=n(i,r),Ly){a=0;do{if(Ly=!1,lv=0,25<=a)throw Error(jt(301));a+=1,io=Zr=null,e.updateQueue=null,l_.current=qW,t=n(i,r)}while(Ly)}if(l_.current=ex,e=Zr!==null&&Zr.next!==null,vh=0,io=Zr=vr=null,Q_=!1,e)throw Error(jt(300));return t}function G2(){var t=lv!==0;return lv=0,t}function vl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return io===null?vr.memoizedState=io=t:io=io.next=t,io}function pa(){if(Zr===null){var t=vr.alternate;t=t!==null?t.memoizedState:null}else t=Zr.next;var e=io===null?vr.memoizedState:io.next;if(e!==null)io=e,Zr=t;else{if(t===null)throw Error(jt(310));Zr=t,t={memoizedState:Zr.memoizedState,baseState:Zr.baseState,baseQueue:Zr.baseQueue,queue:Zr.queue,next:null},io===null?vr.memoizedState=io=t:io=io.next=t}return io}function cv(t,e){return typeof e=="function"?e(t):e}function xE(t){var e=pa(),n=e.queue;if(n===null)throw Error(jt(311));n.lastRenderedReducer=t;var i=Zr,r=i.baseQueue,a=n.pending;if(a!==null){if(r!==null){var d=r.next;r.next=a.next,a.next=d}i.baseQueue=r=a,n.pending=null}if(r!==null){a=r.next,i=i.baseState;var o=d=null,f=null,g=a;do{var _=g.lane;if((vh&_)===_)f!==null&&(f=f.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),i=g.hasEagerState?g.eagerState:t(i,g.action);else{var w={lane:_,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};f===null?(o=f=w,d=i):f=f.next=w,vr.lanes|=_,bh|=_}g=g.next}while(g!==null&&g!==a);f===null?d=i:f.next=o,Qa(i,e.memoizedState)||(ys=!0),e.memoizedState=i,e.baseState=d,e.baseQueue=f,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do a=r.lane,vr.lanes|=a,bh|=a,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function wE(t){var e=pa(),n=e.queue;if(n===null)throw Error(jt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,a=e.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do a=t(a,d.action),d=d.next;while(d!==r);Qa(a,e.memoizedState)||(ys=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,i]}function PF(){}function OF(t,e){var n=vr,i=pa(),r=e(),a=!Qa(i.memoizedState,r);if(a&&(i.memoizedState=r,ys=!0),i=i.queue,H2(LF.bind(null,n,i,t),[t]),i.getSnapshot!==e||a||io!==null&&io.memoizedState.tag&1){if(n.flags|=2048,uv(9,RF.bind(null,n,i,r,e),void 0,null),so===null)throw Error(jt(349));vh&30||DF(n,e,r)}return r}function DF(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=vr.updateQueue,e===null?(e={lastEffect:null,stores:null},vr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function RF(t,e,n,i){e.value=n,e.getSnapshot=i,zF(e)&&BF(t)}function LF(t,e,n){return n(function(){zF(e)&&BF(t)})}function zF(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Qa(t,n)}catch(i){return!0}}function BF(t){var e=gc(t,1);e!==null&&Za(e,t,1,-1)}function mD(t){var e=vl();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cv,lastRenderedState:t},e.queue=t,t=t.dispatch=jW.bind(null,vr,t),[e.memoizedState,t]}function uv(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=vr.updateQueue,e===null?(e={lastEffect:null,stores:null},vr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function FF(){return pa().memoizedState}function c_(t,e,n,i){var r=vl();vr.flags|=t,r.memoizedState=uv(1|e,n,void 0,i===void 0?null:i)}function c1(t,e,n,i){var r=pa();i=i===void 0?null:i;var a=void 0;if(Zr!==null){var d=Zr.memoizedState;if(a=d.destroy,i!==null&&q2(i,d.deps)){r.memoizedState=uv(e,n,a,i);return}}vr.flags|=t,r.memoizedState=uv(1|e,n,a,i)}function gD(t,e){return c_(8390656,8,t,e)}function H2(t,e){return c1(2048,8,t,e)}function NF(t,e){return c1(4,2,t,e)}function $F(t,e){return c1(4,4,t,e)}function jF(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VF(t,e,n){return n=n!=null?n.concat([t]):null,c1(4,4,jF.bind(null,e,t),n)}function Z2(){}function UF(t,e){var n=pa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&q2(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function qF(t,e){var n=pa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&q2(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function WF(t,e,n){return vh&21?(Qa(n,e)||(n=ZB(),vr.lanes|=n,bh|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ys=!0),t.memoizedState=n)}function NW(t,e){var n=ki;ki=n!==0&&4>n?n:4,t(!0);var i=_E.transition;_E.transition={};try{t(!1),e()}finally{ki=n,_E.transition=i}}function GF(){return pa().memoizedState}function $W(t,e,n){var i=Tu(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},HF(t))ZF(e,n);else if(n=EF(t,e,n,i),n!==null){var r=Ko();Za(n,t,i,r),XF(n,e,i)}}function jW(t,e,n){var i=Tu(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(HF(t))ZF(e,r);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var d=e.lastRenderedState,o=a(d,n);if(r.hasEagerState=!0,r.eagerState=o,Qa(o,d)){var f=e.interleaved;f===null?(r.next=r,N2(e)):(r.next=f.next,f.next=r),e.interleaved=r;return}}catch(g){}finally{}n=EF(t,e,r,i),n!==null&&(r=Ko(),Za(n,t,i,r),XF(n,e,i))}}function HF(t){var e=t.alternate;return t===vr||e!==null&&e===vr}function ZF(t,e){Ly=Q_=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function XF(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,k2(t,n)}}var ex={readContext:fa,useCallback:Po,useContext:Po,useEffect:Po,useImperativeHandle:Po,useInsertionEffect:Po,useLayoutEffect:Po,useMemo:Po,useReducer:Po,useRef:Po,useState:Po,useDebugValue:Po,useDeferredValue:Po,useTransition:Po,useMutableSource:Po,useSyncExternalStore:Po,useId:Po,unstable_isNewReconciler:!1},VW={readContext:fa,useCallback:function(t,e){return vl().memoizedState=[t,e===void 0?null:e],t},useContext:fa,useEffect:gD,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,c_(4194308,4,jF.bind(null,e,t),n)},useLayoutEffect:function(t,e){return c_(4194308,4,t,e)},useInsertionEffect:function(t,e){return c_(4,2,t,e)},useMemo:function(t,e){var n=vl();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=vl();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=$W.bind(null,vr,t),[i.memoizedState,t]},useRef:function(t){var e=vl();return t={current:t},e.memoizedState=t},useState:mD,useDebugValue:Z2,useDeferredValue:function(t){return vl().memoizedState=t},useTransition:function(){var t=mD(!1),e=t[0];return t=NW.bind(null,t[1]),vl().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=vr,r=vl();if(ir){if(n===void 0)throw Error(jt(407));n=n()}else{if(n=e(),so===null)throw Error(jt(349));vh&30||DF(i,e,n)}r.memoizedState=n;var a={value:n,getSnapshot:e};return r.queue=a,gD(LF.bind(null,i,a,t),[t]),i.flags|=2048,uv(9,RF.bind(null,i,a,n,e),void 0,null),n},useId:function(){var t=vl(),e=so.identifierPrefix;if(ir){var n=lc,i=ac;n=(i&~(1<<32-Ha(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=lv++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=FW++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},UW={readContext:fa,useCallback:UF,useContext:fa,useEffect:H2,useImperativeHandle:VF,useInsertionEffect:NF,useLayoutEffect:$F,useMemo:qF,useReducer:xE,useRef:FF,useState:function(){return xE(cv)},useDebugValue:Z2,useDeferredValue:function(t){var e=pa();return WF(e,Zr.memoizedState,t)},useTransition:function(){var t=xE(cv)[0],e=pa().memoizedState;return[t,e]},useMutableSource:PF,useSyncExternalStore:OF,useId:GF,unstable_isNewReconciler:!1},qW={readContext:fa,useCallback:UF,useContext:fa,useEffect:H2,useImperativeHandle:VF,useInsertionEffect:NF,useLayoutEffect:$F,useMemo:qF,useReducer:wE,useRef:FF,useState:function(){return wE(cv)},useDebugValue:Z2,useDeferredValue:function(t){var e=pa();return Zr===null?e.memoizedState=t:WF(e,Zr.memoizedState,t)},useTransition:function(){var t=wE(cv)[0],e=pa().memoizedState;return[t,e]},useMutableSource:PF,useSyncExternalStore:OF,useId:GF,unstable_isNewReconciler:!1};function Zp(t,e){try{var n="",i=e;do n+=vq(i),i=i.return;while(i);var r=n}catch(a){r=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:r,digest:null}}function SE(t,e,n){return{value:t,source:null,stack:n!=null?n:null,digest:e!=null?e:null}}function bT(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WW=typeof WeakMap=="function"?WeakMap:Map;function KF(t,e,n){n=uc(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){nx||(nx=!0,AT=i),bT(t,e)},n}function YF(t,e,n){n=uc(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){bT(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){bT(t,e),typeof i!="function"&&(ku===null?ku=new Set([this]):ku.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),n}function yD(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new WW;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=oG.bind(null,t,e,n),e.then(t,t))}function vD(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bD(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=uc(-1,1),e.tag=2,Eu(n,e,1))),n.lanes|=1),t)}var GW=xc.ReactCurrentOwner,ys=!1;function Ho(t,e,n,i){e.child=t===null?AF(e,null,n,i):Gp(e,t.child,n,i)}function _D(t,e,n,i,r){n=n.render;var a=e.ref;return Cp(e,r),i=W2(t,e,n,i,a,r),n=G2(),t!==null&&!ys?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,yc(t,e,r)):(ir&&n&&D2(e),e.flags|=1,Ho(t,e,i,r),e.child)}function xD(t,e,n,i,r){if(t===null){var a=n.type;return typeof a=="function"&&!nI(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,JF(t,e,a,i,r)):(t=f_(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&r)){var d=a.memoizedProps;if(n=n.compare,n=n!==null?n:nv,n(d,i)&&t.ref===e.ref)return yc(t,e,r)}return e.flags|=1,t=Cu(a,i),t.ref=e.ref,t.return=e,e.child=t}function JF(t,e,n,i,r){if(t!==null){var a=t.memoizedProps;if(nv(a,i)&&t.ref===e.ref)if(ys=!1,e.pendingProps=i=a,(t.lanes&r)!==0)t.flags&131072&&(ys=!0);else return e.lanes=t.lanes,yc(t,e,r)}return _T(t,e,n,i,r)}function QF(t,e,n){var i=e.pendingProps,r=i.children,a=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ni(yp,Ds),Ds|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ni(yp,Ds),Ds|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=a!==null?a.baseLanes:n,Ni(yp,Ds),Ds|=i}else a!==null?(i=a.baseLanes|n,e.memoizedState=null):i=n,Ni(yp,Ds),Ds|=i;return Ho(t,e,r,n),e.child}function e4(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function _T(t,e,n,i,r){var a=_s(n)?gh:Bo.current;return a=qp(e,a),Cp(e,r),n=W2(t,e,n,i,a,r),i=G2(),t!==null&&!ys?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,yc(t,e,r)):(ir&&i&&D2(e),e.flags|=1,Ho(t,e,n,r),e.child)}function wD(t,e,n,i,r){if(_s(n)){var a=!0;G_(e)}else a=!1;if(Cp(e,r),e.stateNode===null)u_(t,e),CF(e,n,i),vT(e,n,i,r),i=!0;else if(t===null){var d=e.stateNode,o=e.memoizedProps;d.props=o;var f=d.context,g=n.contextType;typeof g=="object"&&g!==null?g=fa(g):(g=_s(n)?gh:Bo.current,g=qp(e,g));var _=n.getDerivedStateFromProps,w=typeof _=="function"||typeof d.getSnapshotBeforeUpdate=="function";w||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(o!==i||f!==g)&&fD(e,d,i,g),iu=!1;var T=e.memoizedState;d.state=T,Y_(e,i,d,r),f=e.memoizedState,o!==i||T!==f||bs.current||iu?(typeof _=="function"&&(yT(e,n,_,i),f=e.memoizedState),(o=iu||hD(e,n,o,i,T,f,g))?(w||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=f),d.props=i,d.state=f,d.context=g,i=o):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{d=e.stateNode,kF(t,e),o=e.memoizedProps,g=e.type===e.elementType?o:Na(e.type,o),d.props=g,w=e.pendingProps,T=d.context,f=n.contextType,typeof f=="object"&&f!==null?f=fa(f):(f=_s(n)?gh:Bo.current,f=qp(e,f));var A=n.getDerivedStateFromProps;(_=typeof A=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(o!==w||T!==f)&&fD(e,d,i,f),iu=!1,T=e.memoizedState,d.state=T,Y_(e,i,d,r);var D=e.memoizedState;o!==w||T!==D||bs.current||iu?(typeof A=="function"&&(yT(e,n,A,i),D=e.memoizedState),(g=iu||hD(e,n,g,i,T,D,f)||!1)?(_||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(i,D,f),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(i,D,f)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=D),d.props=i,d.state=D,d.context=f,i=g):(typeof d.componentDidUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),i=!1)}return xT(t,e,n,i,a,r)}function xT(t,e,n,i,r,a){e4(t,e);var d=(e.flags&128)!==0;if(!i&&!d)return r&&aD(e,n,!1),yc(t,e,a);i=e.stateNode,GW.current=e;var o=d&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&d?(e.child=Gp(e,t.child,null,a),e.child=Gp(e,null,o,a)):Ho(t,e,o,a),e.memoizedState=i.state,r&&aD(e,n,!0),e.child}function t4(t){var e=t.stateNode;e.pendingContext?sD(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sD(t,e.context,!1),j2(t,e.containerInfo)}function SD(t,e,n,i,r){return Wp(),L2(r),e.flags|=256,Ho(t,e,n,i),e.child}var wT={dehydrated:null,treeContext:null,retryLane:0};function ST(t){return{baseLanes:t,cachePool:null,transitions:null}}function n4(t,e,n){var i=e.pendingProps,r=gr.current,a=!1,d=(e.flags&128)!==0,o;if((o=d)||(o=t!==null&&t.memoizedState===null?!1:(r&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Ni(gr,r&1),t===null)return mT(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=i.children,t=i.fallback,a?(i=e.mode,a=e.child,d={mode:"hidden",children:d},!(i&1)&&a!==null?(a.childLanes=0,a.pendingProps=d):a=h1(d,i,0,null),t=sh(t,i,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=ST(n),e.memoizedState=wT,t):X2(e,d));if(r=t.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return HW(t,e,d,i,o,r,n);if(a){a=i.fallback,d=e.mode,r=t.child,o=r.sibling;var f={mode:"hidden",children:i.children};return!(d&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=f,e.deletions=null):(i=Cu(r,f),i.subtreeFlags=r.subtreeFlags&14680064),o!==null?a=Cu(o,a):(a=sh(a,d,n,null),a.flags|=2),a.return=e,i.return=e,i.sibling=a,e.child=i,i=a,a=e.child,d=t.child.memoizedState,d=d===null?ST(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},a.memoizedState=d,a.childLanes=t.childLanes&~n,e.memoizedState=wT,i}return a=t.child,t=a.sibling,i=Cu(a,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function X2(t,e){return e=h1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Db(t,e,n,i){return i!==null&&L2(i),Gp(e,t.child,null,n),t=X2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HW(t,e,n,i,r,a,d){if(n)return e.flags&256?(e.flags&=-257,i=SE(Error(jt(422))),Db(t,e,d,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=i.fallback,r=e.mode,i=h1({mode:"visible",children:i.children},r,0,null),a=sh(a,r,d,null),a.flags|=2,i.return=e,a.return=e,i.sibling=a,e.child=i,e.mode&1&&Gp(e,t.child,null,d),e.child.memoizedState=ST(d),e.memoizedState=wT,a);if(!(e.mode&1))return Db(t,e,d,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var o=i.dgst;return i=o,a=Error(jt(419)),i=SE(a,i,void 0),Db(t,e,d,i)}if(o=(d&t.childLanes)!==0,ys||o){if(i=so,i!==null){switch(d&-d){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|d)?0:r,r!==0&&r!==a.retryLane&&(a.retryLane=r,gc(t,r),Za(i,t,r,-1))}return tI(),i=SE(Error(jt(421))),Db(t,e,d,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=sG.bind(null,t),r._reactRetry=e,null):(t=a.treeContext,Bs=Su(r.nextSibling),Fs=e,ir=!0,ja=null,t!==null&&(oa[sa++]=ac,oa[sa++]=lc,oa[sa++]=yh,ac=t.id,lc=t.overflow,yh=e),e=X2(e,i.children),e.flags|=4096,e)}function ED(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),gT(t.return,e,n)}function EE(t,e,n,i,r){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r)}function i4(t,e,n){var i=e.pendingProps,r=i.revealOrder,a=i.tail;if(Ho(t,e,i.children,n),i=gr.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ED(t,n,e);else if(t.tag===19)ED(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Ni(gr,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&J_(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),EE(e,!1,r,n,a);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&J_(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}EE(e,!0,n,null,a);break;case"together":EE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function u_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function yc(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bh|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(jt(153));if(e.child!==null){for(t=e.child,n=Cu(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Cu(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ZW(t,e,n){switch(e.tag){case 3:t4(e),Wp();break;case 5:MF(e);break;case 1:_s(e.type)&&G_(e);break;case 4:j2(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Ni(X_,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Ni(gr,gr.current&1),e.flags|=128,null):n&e.child.childLanes?n4(t,e,n):(Ni(gr,gr.current&1),t=yc(t,e,n),t!==null?t.sibling:null);Ni(gr,gr.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return i4(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ni(gr,gr.current),i)break;return null;case 22:case 23:return e.lanes=0,QF(t,e,n)}return yc(t,e,n)}var r4,ET,o4,s4;r4=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ET=function(){};o4=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Qd(Tl.current);var a=null;switch(n){case"input":r=Gk(t,r),i=Gk(t,i),a=[];break;case"select":r=br({},r,{value:void 0}),i=br({},i,{value:void 0}),a=[];break;case"textarea":r=Xk(t,r),i=Xk(t,i),a=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=q_)}Yk(n,i);var d;n=null;for(g in r)if(!i.hasOwnProperty(g)&&r.hasOwnProperty(g)&&r[g]!=null)if(g==="style"){var o=r[g];for(d in o)o.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Xy.hasOwnProperty(g)?a||(a=[]):(a=a||[]).push(g,null));for(g in i){var f=i[g];if(o=r!=null?r[g]:void 0,i.hasOwnProperty(g)&&f!==o&&(f!=null||o!=null))if(g==="style")if(o){for(d in o)!o.hasOwnProperty(d)||f&&f.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in f)f.hasOwnProperty(d)&&o[d]!==f[d]&&(n||(n={}),n[d]=f[d])}else n||(a||(a=[]),a.push(g,n)),n=f;else g==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,o=o?o.__html:void 0,f!=null&&o!==f&&(a=a||[]).push(g,f)):g==="children"?typeof f!="string"&&typeof f!="number"||(a=a||[]).push(g,""+f):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(Xy.hasOwnProperty(g)?(f!=null&&g==="onScroll"&&Hi("scroll",t),a||o===f||(a=[])):(a=a||[]).push(g,f))}n&&(a=a||[]).push("style",n);var g=a;(e.updateQueue=g)&&(e.flags|=4)}};s4=function(t,e,n,i){n!==i&&(e.flags|=4)};function ay(t,e){if(!ir)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Oo(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function XW(t,e,n){var i=e.pendingProps;switch(R2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oo(e),null;case 1:return _s(e.type)&&W_(),Oo(e),null;case 3:return i=e.stateNode,Hp(),Zi(bs),Zi(Bo),U2(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Pb(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ja!==null&&(OT(ja),ja=null))),ET(t,e),Oo(e),null;case 5:V2(e);var r=Qd(av.current);if(n=e.type,t!==null&&e.stateNode!=null)o4(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(jt(166));return Oo(e),null}if(t=Qd(Tl.current),Pb(e)){i=e.stateNode,n=e.type;var a=e.memoizedProps;switch(i[_l]=e,i[ov]=a,t=(e.mode&1)!==0,n){case"dialog":Hi("cancel",i),Hi("close",i);break;case"iframe":case"object":case"embed":Hi("load",i);break;case"video":case"audio":for(r=0;r<wy.length;r++)Hi(wy[r],i);break;case"source":Hi("error",i);break;case"img":case"image":case"link":Hi("error",i),Hi("load",i);break;case"details":Hi("toggle",i);break;case"input":DO(i,a),Hi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Hi("invalid",i);break;case"textarea":LO(i,a),Hi("invalid",i)}Yk(n,a),r=null;for(var d in a)if(a.hasOwnProperty(d)){var o=a[d];d==="children"?typeof o=="string"?i.textContent!==o&&(a.suppressHydrationWarning!==!0&&Mb(i.textContent,o,t),r=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Mb(i.textContent,o,t),r=["children",""+o]):Xy.hasOwnProperty(d)&&o!=null&&d==="onScroll"&&Hi("scroll",i)}switch(n){case"input":wb(i),RO(i,a,!0);break;case"textarea":wb(i),zO(i);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(i.onclick=q_)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{d=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=DB(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=d.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=d.createElement(n,{is:i.is}):(t=d.createElement(n),n==="select"&&(d=t,i.multiple?d.multiple=!0:i.size&&(d.size=i.size))):t=d.createElementNS(t,n),t[_l]=e,t[ov]=i,r4(t,e,!1,!1),e.stateNode=t;e:{switch(d=Jk(n,i),n){case"dialog":Hi("cancel",t),Hi("close",t),r=i;break;case"iframe":case"object":case"embed":Hi("load",t),r=i;break;case"video":case"audio":for(r=0;r<wy.length;r++)Hi(wy[r],t);r=i;break;case"source":Hi("error",t),r=i;break;case"img":case"image":case"link":Hi("error",t),Hi("load",t),r=i;break;case"details":Hi("toggle",t),r=i;break;case"input":DO(t,i),r=Gk(t,i),Hi("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=br({},i,{value:void 0}),Hi("invalid",t);break;case"textarea":LO(t,i),r=Xk(t,i),Hi("invalid",t);break;default:r=i}Yk(n,r),o=r;for(a in o)if(o.hasOwnProperty(a)){var f=o[a];a==="style"?zB(t,f):a==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&RB(t,f)):a==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&Ky(t,f):typeof f=="number"&&Ky(t,""+f):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Xy.hasOwnProperty(a)?f!=null&&a==="onScroll"&&Hi("scroll",t):f!=null&&b2(t,a,f,d))}switch(n){case"input":wb(t),RO(t,i,!1);break;case"textarea":wb(t),zO(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Ru(i.value));break;case"select":t.multiple=!!i.multiple,a=i.value,a!=null?Sp(t,!!i.multiple,a,!1):i.defaultValue!=null&&Sp(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=q_)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Oo(e),null;case 6:if(t&&e.stateNode!=null)s4(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(jt(166));if(n=Qd(av.current),Qd(Tl.current),Pb(e)){if(i=e.stateNode,n=e.memoizedProps,i[_l]=e,(a=i.nodeValue!==n)&&(t=Fs,t!==null))switch(t.tag){case 3:Mb(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Mb(i.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[_l]=e,e.stateNode=i}return Oo(e),null;case 13:if(Zi(gr),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ir&&Bs!==null&&e.mode&1&&!(e.flags&128))SF(),Wp(),e.flags|=98560,a=!1;else if(a=Pb(e),i!==null&&i.dehydrated!==null){if(t===null){if(!a)throw Error(jt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(jt(317));a[_l]=e}else Wp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Oo(e),a=!1}else ja!==null&&(OT(ja),ja=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||gr.current&1?Kr===0&&(Kr=3):tI())),e.updateQueue!==null&&(e.flags|=4),Oo(e),null);case 4:return Hp(),ET(t,e),t===null&&iv(e.stateNode.containerInfo),Oo(e),null;case 10:return F2(e.type._context),Oo(e),null;case 17:return _s(e.type)&&W_(),Oo(e),null;case 19:if(Zi(gr),a=e.memoizedState,a===null)return Oo(e),null;if(i=(e.flags&128)!==0,d=a.rendering,d===null)if(i)ay(a,!1);else{if(Kr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(d=J_(t),d!==null){for(e.flags|=128,ay(a,!1),i=d.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)a=n,t=i,a.flags&=14680066,d=a.alternate,d===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,t=d.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ni(gr,gr.current&1|2),e.child}t=t.sibling}a.tail!==null&&Or()>Xp&&(e.flags|=128,i=!0,ay(a,!1),e.lanes=4194304)}else{if(!i)if(t=J_(d),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ay(a,!0),a.tail===null&&a.tailMode==="hidden"&&!d.alternate&&!ir)return Oo(e),null}else 2*Or()-a.renderingStartTime>Xp&&n!==1073741824&&(e.flags|=128,i=!0,ay(a,!1),e.lanes=4194304);a.isBackwards?(d.sibling=e.child,e.child=d):(n=a.last,n!==null?n.sibling=d:e.child=d,a.last=d)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Or(),e.sibling=null,n=gr.current,Ni(gr,i?n&1|2:n&1),e):(Oo(e),null);case 22:case 23:return eI(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Ds&1073741824&&(Oo(e),e.subtreeFlags&6&&(e.flags|=8192)):Oo(e),null;case 24:return null;case 25:return null}throw Error(jt(156,e.tag))}function KW(t,e){switch(R2(e),e.tag){case 1:return _s(e.type)&&W_(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Hp(),Zi(bs),Zi(Bo),U2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return V2(e),null;case 13:if(Zi(gr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(jt(340));Wp()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Zi(gr),null;case 4:return Hp(),null;case 10:return F2(e.type._context),null;case 22:case 23:return eI(),null;case 24:return null;default:return null}}var Rb=!1,Lo=!1,YW=typeof WeakSet=="function"?WeakSet:Set,sn=null;function gp(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Er(t,e,i)}else n.current=null}function kT(t,e,n){try{n()}catch(i){Er(t,e,i)}}var kD=!1;function JW(t,e){if(lT=j_,t=uF(),O2(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch(K){n=null;break e}var d=0,o=-1,f=-1,g=0,_=0,w=t,T=null;t:for(;;){for(var A;w!==n||r!==0&&w.nodeType!==3||(o=d+r),w!==a||i!==0&&w.nodeType!==3||(f=d+i),w.nodeType===3&&(d+=w.nodeValue.length),(A=w.firstChild)!==null;)T=w,w=A;for(;;){if(w===t)break t;if(T===n&&++g===r&&(o=d),T===a&&++_===i&&(f=d),(A=w.nextSibling)!==null)break;w=T,T=w.parentNode}w=A}n=o===-1||f===-1?null:{start:o,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(cT={focusedElem:t,selectionRange:n},j_=!1,sn=e;sn!==null;)if(e=sn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,sn=t;else for(;sn!==null;){e=sn;try{var D=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(D!==null){var z=D.memoizedProps,G=D.memoizedState,V=e.stateNode,N=V.getSnapshotBeforeUpdate(e.elementType===e.type?z:Na(e.type,z),G);V.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var q=e.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(jt(163))}}catch(K){Er(e,e.return,K)}if(t=e.sibling,t!==null){t.return=e.return,sn=t;break}sn=e.return}return D=kD,kD=!1,D}function zy(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var a=r.destroy;r.destroy=void 0,a!==void 0&&kT(e,n,a)}r=r.next}while(r!==i)}}function u1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function TT(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function a4(t){var e=t.alternate;e!==null&&(t.alternate=null,a4(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_l],delete e[ov],delete e[hT],delete e[RW],delete e[LW])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function l4(t){return t.tag===5||t.tag===3||t.tag===4}function TD(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||l4(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function CT(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=q_));else if(i!==4&&(t=t.child,t!==null))for(CT(t,e,n),t=t.sibling;t!==null;)CT(t,e,n),t=t.sibling}function IT(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(IT(t,e,n),t=t.sibling;t!==null;)IT(t,e,n),t=t.sibling}var go=null,$a=!1;function Jc(t,e,n){for(n=n.child;n!==null;)c4(t,e,n),n=n.sibling}function c4(t,e,n){if(kl&&typeof kl.onCommitFiberUnmount=="function")try{kl.onCommitFiberUnmount(n1,n)}catch(o){}switch(n.tag){case 5:Lo||gp(n,e);case 6:var i=go,r=$a;go=null,Jc(t,e,n),go=i,$a=r,go!==null&&($a?(t=go,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):go.removeChild(n.stateNode));break;case 18:go!==null&&($a?(t=go,n=n.stateNode,t.nodeType===8?yE(t.parentNode,n):t.nodeType===1&&yE(t,n),ev(t)):yE(go,n.stateNode));break;case 4:i=go,r=$a,go=n.stateNode.containerInfo,$a=!0,Jc(t,e,n),go=i,$a=r;break;case 0:case 11:case 14:case 15:if(!Lo&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var a=r,d=a.destroy;a=a.tag,d!==void 0&&(a&2||a&4)&&kT(n,e,d),r=r.next}while(r!==i)}Jc(t,e,n);break;case 1:if(!Lo&&(gp(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){Er(n,e,o)}Jc(t,e,n);break;case 21:Jc(t,e,n);break;case 22:n.mode&1?(Lo=(i=Lo)||n.memoizedState!==null,Jc(t,e,n),Lo=i):Jc(t,e,n);break;default:Jc(t,e,n)}}function CD(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new YW),e.forEach(function(i){var r=aG.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function za(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var a=t,d=e,o=d;e:for(;o!==null;){switch(o.tag){case 5:go=o.stateNode,$a=!1;break e;case 3:go=o.stateNode.containerInfo,$a=!0;break e;case 4:go=o.stateNode.containerInfo,$a=!0;break e}o=o.return}if(go===null)throw Error(jt(160));c4(a,d,r),go=null,$a=!1;var f=r.alternate;f!==null&&(f.return=null),r.return=null}catch(g){Er(r,e,g)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)u4(e,t),e=e.sibling}function u4(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(za(e,t),gl(t),i&4){try{zy(3,t,t.return),u1(3,t)}catch(z){Er(t,t.return,z)}try{zy(5,t,t.return)}catch(z){Er(t,t.return,z)}}break;case 1:za(e,t),gl(t),i&512&&n!==null&&gp(n,n.return);break;case 5:if(za(e,t),gl(t),i&512&&n!==null&&gp(n,n.return),t.flags&32){var r=t.stateNode;try{Ky(r,"")}catch(z){Er(t,t.return,z)}}if(i&4&&(r=t.stateNode,r!=null)){var a=t.memoizedProps,d=n!==null?n.memoizedProps:a,o=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&PB(r,a),Jk(o,d);var g=Jk(o,a);for(d=0;d<f.length;d+=2){var _=f[d],w=f[d+1];_==="style"?zB(r,w):_==="dangerouslySetInnerHTML"?RB(r,w):_==="children"?Ky(r,w):b2(r,_,w,g)}switch(o){case"input":Hk(r,a);break;case"textarea":OB(r,a);break;case"select":var T=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var A=a.value;A!=null?Sp(r,!!a.multiple,A,!1):T!==!!a.multiple&&(a.defaultValue!=null?Sp(r,!!a.multiple,a.defaultValue,!0):Sp(r,!!a.multiple,a.multiple?[]:"",!1))}r[ov]=a}catch(z){Er(t,t.return,z)}}break;case 6:if(za(e,t),gl(t),i&4){if(t.stateNode===null)throw Error(jt(162));r=t.stateNode,a=t.memoizedProps;try{r.nodeValue=a}catch(z){Er(t,t.return,z)}}break;case 3:if(za(e,t),gl(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{ev(e.containerInfo)}catch(z){Er(t,t.return,z)}break;case 4:za(e,t),gl(t);break;case 13:za(e,t),gl(t),r=t.child,r.flags&8192&&(a=r.memoizedState!==null,r.stateNode.isHidden=a,!a||r.alternate!==null&&r.alternate.memoizedState!==null||(J2=Or())),i&4&&CD(t);break;case 22:if(_=n!==null&&n.memoizedState!==null,t.mode&1?(Lo=(g=Lo)||_,za(e,t),Lo=g):za(e,t),gl(t),i&8192){if(g=t.memoizedState!==null,(t.stateNode.isHidden=g)&&!_&&t.mode&1)for(sn=t,_=t.child;_!==null;){for(w=sn=_;sn!==null;){switch(T=sn,A=T.child,T.tag){case 0:case 11:case 14:case 15:zy(4,T,T.return);break;case 1:gp(T,T.return);var D=T.stateNode;if(typeof D.componentWillUnmount=="function"){i=T,n=T.return;try{e=i,D.props=e.memoizedProps,D.state=e.memoizedState,D.componentWillUnmount()}catch(z){Er(i,n,z)}}break;case 5:gp(T,T.return);break;case 22:if(T.memoizedState!==null){AD(w);continue}}A!==null?(A.return=T,sn=A):AD(w)}_=_.sibling}e:for(_=null,w=t;;){if(w.tag===5){if(_===null){_=w;try{r=w.stateNode,g?(a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=w.stateNode,f=w.memoizedProps.style,d=f!=null&&f.hasOwnProperty("display")?f.display:null,o.style.display=LB("display",d))}catch(z){Er(t,t.return,z)}}}else if(w.tag===6){if(_===null)try{w.stateNode.nodeValue=g?"":w.memoizedProps}catch(z){Er(t,t.return,z)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===t)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===t)break e;for(;w.sibling===null;){if(w.return===null||w.return===t)break e;_===w&&(_=null),w=w.return}_===w&&(_=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:za(e,t),gl(t),i&4&&CD(t);break;case 21:break;default:za(e,t),gl(t)}}function gl(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(l4(n)){var i=n;break e}n=n.return}throw Error(jt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Ky(r,""),i.flags&=-33);var a=TD(t);IT(t,a,r);break;case 3:case 4:var d=i.stateNode.containerInfo,o=TD(t);CT(t,o,d);break;default:throw Error(jt(161))}}catch(f){Er(t,t.return,f)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function QW(t,e,n){sn=t,d4(t)}function d4(t,e,n){for(var i=(t.mode&1)!==0;sn!==null;){var r=sn,a=r.child;if(r.tag===22&&i){var d=r.memoizedState!==null||Rb;if(!d){var o=r.alternate,f=o!==null&&o.memoizedState!==null||Lo;o=Rb;var g=Lo;if(Rb=d,(Lo=f)&&!g)for(sn=r;sn!==null;)d=sn,f=d.child,d.tag===22&&d.memoizedState!==null?MD(r):f!==null?(f.return=d,sn=f):MD(r);for(;a!==null;)sn=a,d4(a),a=a.sibling;sn=r,Rb=o,Lo=g}ID(t)}else r.subtreeFlags&8772&&a!==null?(a.return=r,sn=a):ID(t)}}function ID(t){for(;sn!==null;){var e=sn;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Lo||u1(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Lo)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Na(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&dD(e,a,i);break;case 3:var d=e.updateQueue;if(d!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}dD(e,d,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var g=e.alternate;if(g!==null){var _=g.memoizedState;if(_!==null){var w=_.dehydrated;w!==null&&ev(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(jt(163))}Lo||e.flags&512&&TT(e)}catch(T){Er(e,e.return,T)}}if(e===t){sn=null;break}if(n=e.sibling,n!==null){n.return=e.return,sn=n;break}sn=e.return}}function AD(t){for(;sn!==null;){var e=sn;if(e===t){sn=null;break}var n=e.sibling;if(n!==null){n.return=e.return,sn=n;break}sn=e.return}}function MD(t){for(;sn!==null;){var e=sn;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{u1(4,e)}catch(f){Er(e,n,f)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(f){Er(e,r,f)}}var a=e.return;try{TT(e)}catch(f){Er(e,a,f)}break;case 5:var d=e.return;try{TT(e)}catch(f){Er(e,d,f)}}}catch(f){Er(e,e.return,f)}if(e===t){sn=null;break}var o=e.sibling;if(o!==null){o.return=e.return,sn=o;break}sn=e.return}}var eG=Math.ceil,tx=xc.ReactCurrentDispatcher,K2=xc.ReactCurrentOwner,ua=xc.ReactCurrentBatchConfig,ri=0,so=null,Nr=null,_o=0,Ds=0,yp=Wu(0),Kr=0,dv=null,bh=0,d1=0,Y2=0,By=null,ms=null,J2=0,Xp=1/0,nc=null,nx=!1,AT=null,ku=null,Lb=!1,gu=null,ix=0,Fy=0,MT=null,d_=-1,h_=0;function Ko(){return ri&6?Or():d_!==-1?d_:d_=Or()}function Tu(t){return t.mode&1?ri&2&&_o!==0?_o&-_o:BW.transition!==null?(h_===0&&(h_=ZB()),h_):(t=ki,t!==0||(t=window.event,t=t===void 0?16:tF(t.type)),t):1}function Za(t,e,n,i){if(50<Fy)throw Fy=0,MT=null,Error(jt(185));Dv(t,n,i),(!(ri&2)||t!==so)&&(t===so&&(!(ri&2)&&(d1|=n),Kr===4&&du(t,_o)),xs(t,i),n===1&&ri===0&&!(e.mode&1)&&(Xp=Or()+500,a1&&Gu()))}function xs(t,e){var n=t.callbackNode;Bq(t,e);var i=$_(t,t===so?_o:0);if(i===0)n!==null&&NO(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&NO(n),e===1)t.tag===0?zW(PD.bind(null,t)):_F(PD.bind(null,t)),OW(function(){!(ri&6)&&Gu()}),n=null;else{switch(XB(i)){case 1:n=E2;break;case 4:n=GB;break;case 16:n=N_;break;case 536870912:n=HB;break;default:n=N_}n=b4(n,h4.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function h4(t,e){if(d_=-1,h_=0,ri&6)throw Error(jt(327));var n=t.callbackNode;if(Ip()&&t.callbackNode!==n)return null;var i=$_(t,t===so?_o:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=rx(t,i);else{e=i;var r=ri;ri|=2;var a=p4();(so!==t||_o!==e)&&(nc=null,Xp=Or()+500,oh(t,e));do try{iG();break}catch(o){f4(t,o)}while(1);B2(),tx.current=a,ri=r,Nr!==null?e=0:(so=null,_o=0,e=Kr)}if(e!==0){if(e===2&&(r=iT(t),r!==0&&(i=r,e=PT(t,r))),e===1)throw n=dv,oh(t,0),du(t,i),xs(t,Or()),n;if(e===6)du(t,i);else{if(r=t.current.alternate,!(i&30)&&!tG(r)&&(e=rx(t,i),e===2&&(a=iT(t),a!==0&&(i=a,e=PT(t,a))),e===1))throw n=dv,oh(t,0),du(t,i),xs(t,Or()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(jt(345));case 2:Hd(t,ms,nc);break;case 3:if(du(t,i),(i&130023424)===i&&(e=J2+500-Or(),10<e)){if($_(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Ko(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=dT(Hd.bind(null,t,ms,nc),e);break}Hd(t,ms,nc);break;case 4:if(du(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var d=31-Ha(i);a=1<<d,d=e[d],d>r&&(r=d),i&=~a}if(i=r,i=Or()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*eG(i/1960))-i,10<i){t.timeoutHandle=dT(Hd.bind(null,t,ms,nc),i);break}Hd(t,ms,nc);break;case 5:Hd(t,ms,nc);break;default:throw Error(jt(329))}}}return xs(t,Or()),t.callbackNode===n?h4.bind(null,t):null}function PT(t,e){var n=By;return t.current.memoizedState.isDehydrated&&(oh(t,e).flags|=256),t=rx(t,e),t!==2&&(e=ms,ms=n,e!==null&&OT(e)),t}function OT(t){ms===null?ms=t:ms.push.apply(ms,t)}function tG(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],a=r.getSnapshot;r=r.value;try{if(!Qa(a(),r))return!1}catch(d){return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function du(t,e){for(e&=~Y2,e&=~d1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ha(e),i=1<<n;t[n]=-1,e&=~i}}function PD(t){if(ri&6)throw Error(jt(327));Ip();var e=$_(t,0);if(!(e&1))return xs(t,Or()),null;var n=rx(t,e);if(t.tag!==0&&n===2){var i=iT(t);i!==0&&(e=i,n=PT(t,i))}if(n===1)throw n=dv,oh(t,0),du(t,e),xs(t,Or()),n;if(n===6)throw Error(jt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hd(t,ms,nc),xs(t,Or()),null}function Q2(t,e){var n=ri;ri|=1;try{return t(e)}finally{ri=n,ri===0&&(Xp=Or()+500,a1&&Gu())}}function _h(t){gu!==null&&gu.tag===0&&!(ri&6)&&Ip();var e=ri;ri|=1;var n=ua.transition,i=ki;try{if(ua.transition=null,ki=1,t)return t()}finally{ki=i,ua.transition=n,ri=e,!(ri&6)&&Gu()}}function eI(){Ds=yp.current,Zi(yp)}function oh(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,PW(n)),Nr!==null)for(n=Nr.return;n!==null;){var i=n;switch(R2(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&W_();break;case 3:Hp(),Zi(bs),Zi(Bo),U2();break;case 5:V2(i);break;case 4:Hp();break;case 13:Zi(gr);break;case 19:Zi(gr);break;case 10:F2(i.type._context);break;case 22:case 23:eI()}n=n.return}if(so=t,Nr=t=Cu(t.current,null),_o=Ds=e,Kr=0,dv=null,Y2=d1=bh=0,ms=By=null,Jd!==null){for(e=0;e<Jd.length;e++)if(n=Jd[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,a=n.pending;if(a!==null){var d=a.next;a.next=r,i.next=d}n.pending=i}Jd=null}return t}function f4(t,e){do{var n=Nr;try{if(B2(),l_.current=ex,Q_){for(var i=vr.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Q_=!1}if(vh=0,io=Zr=vr=null,Ly=!1,lv=0,K2.current=null,n===null||n.return===null){Kr=1,dv=e,Nr=null;break}e:{var a=t,d=n.return,o=n,f=e;if(e=_o,o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var g=f,_=o,w=_.tag;if(!(_.mode&1)&&(w===0||w===11||w===15)){var T=_.alternate;T?(_.updateQueue=T.updateQueue,_.memoizedState=T.memoizedState,_.lanes=T.lanes):(_.updateQueue=null,_.memoizedState=null)}var A=vD(d);if(A!==null){A.flags&=-257,bD(A,d,o,a,e),A.mode&1&&yD(a,g,e),e=A,f=g;var D=e.updateQueue;if(D===null){var z=new Set;z.add(f),e.updateQueue=z}else D.add(f);break e}else{if(!(e&1)){yD(a,g,e),tI();break e}f=Error(jt(426))}}else if(ir&&o.mode&1){var G=vD(d);if(G!==null){!(G.flags&65536)&&(G.flags|=256),bD(G,d,o,a,e),L2(Zp(f,o));break e}}a=f=Zp(f,o),Kr!==4&&(Kr=2),By===null?By=[a]:By.push(a),a=d;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var V=KF(a,f,e);uD(a,V);break e;case 1:o=f;var N=a.type,q=a.stateNode;if(!(a.flags&128)&&(typeof N.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(ku===null||!ku.has(q)))){a.flags|=65536,e&=-e,a.lanes|=e;var K=YF(a,o,e);uD(a,K);break e}}a=a.return}while(a!==null)}g4(n)}catch(se){e=se,Nr===n&&n!==null&&(Nr=n=n.return);continue}break}while(1)}function p4(){var t=tx.current;return tx.current=ex,t===null?ex:t}function tI(){(Kr===0||Kr===3||Kr===2)&&(Kr=4),so===null||!(bh&268435455)&&!(d1&268435455)||du(so,_o)}function rx(t,e){var n=ri;ri|=2;var i=p4();(so!==t||_o!==e)&&(nc=null,oh(t,e));do try{nG();break}catch(r){f4(t,r)}while(1);if(B2(),ri=n,tx.current=i,Nr!==null)throw Error(jt(261));return so=null,_o=0,Kr}function nG(){for(;Nr!==null;)m4(Nr)}function iG(){for(;Nr!==null&&!Iq();)m4(Nr)}function m4(t){var e=v4(t.alternate,t,Ds);t.memoizedProps=t.pendingProps,e===null?g4(t):Nr=e,K2.current=null}function g4(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=KW(n,e),n!==null){n.flags&=32767,Nr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kr=6,Nr=null;return}}else if(n=XW(n,e,Ds),n!==null){Nr=n;return}if(e=e.sibling,e!==null){Nr=e;return}Nr=e=t}while(e!==null);Kr===0&&(Kr=5)}function Hd(t,e,n){var i=ki,r=ua.transition;try{ua.transition=null,ki=1,rG(t,e,n,i)}finally{ua.transition=r,ki=i}return null}function rG(t,e,n,i){do Ip();while(gu!==null);if(ri&6)throw Error(jt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(jt(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if(Fq(t,a),t===so&&(Nr=so=null,_o=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Lb||(Lb=!0,b4(N_,function(){return Ip(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=ua.transition,ua.transition=null;var d=ki;ki=1;var o=ri;ri|=4,K2.current=null,JW(t,n),u4(n,t),EW(cT),j_=!!lT,cT=lT=null,t.current=n,QW(n),Aq(),ri=o,ki=d,ua.transition=a}else t.current=n;if(Lb&&(Lb=!1,gu=t,ix=r),a=t.pendingLanes,a===0&&(ku=null),Oq(n.stateNode),xs(t,Or()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(nx)throw nx=!1,t=AT,AT=null,t;return ix&1&&t.tag!==0&&Ip(),a=t.pendingLanes,a&1?t===MT?Fy++:(Fy=0,MT=t):Fy=0,Gu(),null}function Ip(){if(gu!==null){var t=XB(ix),e=ua.transition,n=ki;try{if(ua.transition=null,ki=16>t?16:t,gu===null)var i=!1;else{if(t=gu,gu=null,ix=0,ri&6)throw Error(jt(331));var r=ri;for(ri|=4,sn=t.current;sn!==null;){var a=sn,d=a.child;if(sn.flags&16){var o=a.deletions;if(o!==null){for(var f=0;f<o.length;f++){var g=o[f];for(sn=g;sn!==null;){var _=sn;switch(_.tag){case 0:case 11:case 15:zy(8,_,a)}var w=_.child;if(w!==null)w.return=_,sn=w;else for(;sn!==null;){_=sn;var T=_.sibling,A=_.return;if(a4(_),_===g){sn=null;break}if(T!==null){T.return=A,sn=T;break}sn=A}}}var D=a.alternate;if(D!==null){var z=D.child;if(z!==null){D.child=null;do{var G=z.sibling;z.sibling=null,z=G}while(z!==null)}}sn=a}}if(a.subtreeFlags&2064&&d!==null)d.return=a,sn=d;else e:for(;sn!==null;){if(a=sn,a.flags&2048)switch(a.tag){case 0:case 11:case 15:zy(9,a,a.return)}var V=a.sibling;if(V!==null){V.return=a.return,sn=V;break e}sn=a.return}}var N=t.current;for(sn=N;sn!==null;){d=sn;var q=d.child;if(d.subtreeFlags&2064&&q!==null)q.return=d,sn=q;else e:for(d=N;sn!==null;){if(o=sn,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:u1(9,o)}}catch(se){Er(o,o.return,se)}if(o===d){sn=null;break e}var K=o.sibling;if(K!==null){K.return=o.return,sn=K;break e}sn=o.return}}if(ri=r,Gu(),kl&&typeof kl.onPostCommitFiberRoot=="function")try{kl.onPostCommitFiberRoot(n1,t)}catch(se){}i=!0}return i}finally{ki=n,ua.transition=e}}return!1}function OD(t,e,n){e=Zp(n,e),e=KF(t,e,1),t=Eu(t,e,1),e=Ko(),t!==null&&(Dv(t,1,e),xs(t,e))}function Er(t,e,n){if(t.tag===3)OD(t,t,n);else for(;e!==null;){if(e.tag===3){OD(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ku===null||!ku.has(i))){t=Zp(n,t),t=YF(e,t,1),e=Eu(e,t,1),t=Ko(),e!==null&&(Dv(e,1,t),xs(e,t));break}}e=e.return}}function oG(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Ko(),t.pingedLanes|=t.suspendedLanes&n,so===t&&(_o&n)===n&&(Kr===4||Kr===3&&(_o&130023424)===_o&&500>Or()-J2?oh(t,0):Y2|=n),xs(t,e)}function y4(t,e){e===0&&(t.mode&1?(e=kb,kb<<=1,!(kb&130023424)&&(kb=4194304)):e=1);var n=Ko();t=gc(t,e),t!==null&&(Dv(t,e,n),xs(t,n))}function sG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),y4(t,n)}function aG(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(jt(314))}i!==null&&i.delete(e),y4(t,n)}var v4;v4=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||bs.current)ys=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ys=!1,ZW(t,e,n);ys=!!(t.flags&131072)}else ys=!1,ir&&e.flags&1048576&&xF(e,Z_,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;u_(t,e),t=e.pendingProps;var r=qp(e,Bo.current);Cp(e,n),r=W2(null,e,i,t,r,n);var a=G2();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_s(i)?(a=!0,G_(e)):a=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,$2(e),r.updater=l1,e.stateNode=r,r._reactInternals=e,vT(e,i,t,n),e=xT(null,e,i,!0,a,n)):(e.tag=0,ir&&a&&D2(e),Ho(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(u_(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=cG(i),t=Na(i,t),r){case 0:e=_T(null,e,i,t,n);break e;case 1:e=wD(null,e,i,t,n);break e;case 11:e=_D(null,e,i,t,n);break e;case 14:e=xD(null,e,i,Na(i.type,t),n);break e}throw Error(jt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Na(i,r),_T(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Na(i,r),wD(t,e,i,r,n);case 3:e:{if(t4(e),t===null)throw Error(jt(387));i=e.pendingProps,a=e.memoizedState,r=a.element,kF(t,e),Y_(e,i,null,n);var d=e.memoizedState;if(i=d.element,a.isDehydrated)if(a={element:i,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){r=Zp(Error(jt(423)),e),e=SD(t,e,i,n,r);break e}else if(i!==r){r=Zp(Error(jt(424)),e),e=SD(t,e,i,n,r);break e}else for(Bs=Su(e.stateNode.containerInfo.firstChild),Fs=e,ir=!0,ja=null,n=AF(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Wp(),i===r){e=yc(t,e,n);break e}Ho(t,e,i,n)}e=e.child}return e;case 5:return MF(e),t===null&&mT(e),i=e.type,r=e.pendingProps,a=t!==null?t.memoizedProps:null,d=r.children,uT(i,r)?d=null:a!==null&&uT(i,a)&&(e.flags|=32),e4(t,e),Ho(t,e,d,n),e.child;case 6:return t===null&&mT(e),null;case 13:return n4(t,e,n);case 4:return j2(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Gp(e,null,i,n):Ho(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Na(i,r),_D(t,e,i,r,n);case 7:return Ho(t,e,e.pendingProps,n),e.child;case 8:return Ho(t,e,e.pendingProps.children,n),e.child;case 12:return Ho(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,a=e.memoizedProps,d=r.value,Ni(X_,i._currentValue),i._currentValue=d,a!==null)if(Qa(a.value,d)){if(a.children===r.children&&!bs.current){e=yc(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){d=a.child;for(var f=o.firstContext;f!==null;){if(f.context===i){if(a.tag===1){f=uc(-1,n&-n),f.tag=2;var g=a.updateQueue;if(g!==null){g=g.shared;var _=g.pending;_===null?f.next=f:(f.next=_.next,_.next=f),g.pending=f}}a.lanes|=n,f=a.alternate,f!==null&&(f.lanes|=n),gT(a.return,n,e),o.lanes|=n;break}f=f.next}}else if(a.tag===10)d=a.type===e.type?null:a.child;else if(a.tag===18){if(d=a.return,d===null)throw Error(jt(341));d.lanes|=n,o=d.alternate,o!==null&&(o.lanes|=n),gT(d,n,e),d=a.sibling}else d=a.child;if(d!==null)d.return=a;else for(d=a;d!==null;){if(d===e){d=null;break}if(a=d.sibling,a!==null){a.return=d.return,d=a;break}d=d.return}a=d}Ho(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Cp(e,n),r=fa(r),i=i(r),e.flags|=1,Ho(t,e,i,n),e.child;case 14:return i=e.type,r=Na(i,e.pendingProps),r=Na(i.type,r),xD(t,e,i,r,n);case 15:return JF(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Na(i,r),u_(t,e),e.tag=1,_s(i)?(t=!0,G_(e)):t=!1,Cp(e,n),CF(e,i,r),vT(e,i,r,n),xT(null,e,i,!0,t,n);case 19:return i4(t,e,n);case 22:return QF(t,e,n)}throw Error(jt(156,e.tag))};function b4(t,e){return WB(t,e)}function lG(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(t,e,n,i){return new lG(t,e,n,i)}function nI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cG(t){if(typeof t=="function")return nI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===x2)return 11;if(t===w2)return 14}return 2}function Cu(t,e){var n=t.alternate;return n===null?(n=la(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function f_(t,e,n,i,r,a){var d=2;if(i=t,typeof t=="function")nI(t)&&(d=1);else if(typeof t=="string")d=5;else e:switch(t){case ap:return sh(n.children,r,a,e);case _2:d=8,r|=8;break;case Vk:return t=la(12,n,e,r|2),t.elementType=Vk,t.lanes=a,t;case Uk:return t=la(13,n,e,r),t.elementType=Uk,t.lanes=a,t;case qk:return t=la(19,n,e,r),t.elementType=qk,t.lanes=a,t;case IB:return h1(n,r,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case TB:d=10;break e;case CB:d=9;break e;case x2:d=11;break e;case w2:d=14;break e;case nu:d=16,i=null;break e}throw Error(jt(130,t==null?t:typeof t,""))}return e=la(d,n,e,r),e.elementType=t,e.type=i,e.lanes=a,e}function sh(t,e,n,i){return t=la(7,t,i,e),t.lanes=n,t}function h1(t,e,n,i){return t=la(22,t,i,e),t.elementType=IB,t.lanes=n,t.stateNode={isHidden:!1},t}function kE(t,e,n){return t=la(6,t,null,e),t.lanes=n,t}function TE(t,e,n){return e=la(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uG(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sE(0),this.expirationTimes=sE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sE(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function iI(t,e,n,i,r,a,d,o,f){return t=new uG(t,e,n,o,f),e===1?(e=1,a===!0&&(e|=8)):e=0,a=la(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$2(a),t}function dG(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sp,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function _4(t){if(!t)return Lu;t=t._reactInternals;e:{if(Bh(t)!==t||t.tag!==1)throw Error(jt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_s(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(jt(171))}if(t.tag===1){var n=t.type;if(_s(n))return bF(t,n,e)}return e}function x4(t,e,n,i,r,a,d,o,f){return t=iI(n,i,!0,t,r,a,d,o,f),t.context=_4(null),n=t.current,i=Ko(),r=Tu(n),a=uc(i,r),a.callback=e!=null?e:null,Eu(n,a,r),t.current.lanes=r,Dv(t,r,i),xs(t,i),t}function f1(t,e,n,i){var r=e.current,a=Ko(),d=Tu(r);return n=_4(n),e.context===null?e.context=n:e.pendingContext=n,e=uc(a,d),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Eu(r,e,d),t!==null&&(Za(t,r,d,a),a_(t,r,d)),d}function ox(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function DD(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function rI(t,e){DD(t,e),(t=t.alternate)&&DD(t,e)}function hG(){return null}var w4=typeof reportError=="function"?reportError:function(t){console.error(t)};function oI(t){this._internalRoot=t}p1.prototype.render=oI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(jt(409));f1(t,e,null,null)};p1.prototype.unmount=oI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_h(function(){f1(null,t,null,null)}),e[mc]=null}};function p1(t){this._internalRoot=t}p1.prototype.unstable_scheduleHydration=function(t){if(t){var e=JB();t={blockedOn:null,target:t,priority:e};for(var n=0;n<uu.length&&e!==0&&e<uu[n].priority;n++);uu.splice(n,0,t),n===0&&eF(t)}};function sI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function m1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function RD(){}function fG(t,e,n,i,r){if(r){if(typeof i=="function"){var a=i;i=function(){var g=ox(d);a.call(g)}}var d=x4(e,i,t,0,null,!1,!1,"",RD);return t._reactRootContainer=d,t[mc]=d.current,iv(t.nodeType===8?t.parentNode:t),_h(),d}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var o=i;i=function(){var g=ox(f);o.call(g)}}var f=iI(t,0,!1,null,null,!1,!1,"",RD);return t._reactRootContainer=f,t[mc]=f.current,iv(t.nodeType===8?t.parentNode:t),_h(function(){f1(e,f,n,i)}),f}function g1(t,e,n,i,r){var a=n._reactRootContainer;if(a){var d=a;if(typeof r=="function"){var o=r;r=function(){var f=ox(d);o.call(f)}}f1(e,d,t,r)}else d=fG(n,e,t,r,i);return ox(d)}KB=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xy(e.pendingLanes);n!==0&&(k2(e,n|1),xs(e,Or()),!(ri&6)&&(Xp=Or()+500,Gu()))}break;case 13:_h(function(){var i=gc(t,1);if(i!==null){var r=Ko();Za(i,t,1,r)}}),rI(t,1)}};T2=function(t){if(t.tag===13){var e=gc(t,134217728);if(e!==null){var n=Ko();Za(e,t,134217728,n)}rI(t,134217728)}};YB=function(t){if(t.tag===13){var e=Tu(t),n=gc(t,e);if(n!==null){var i=Ko();Za(n,t,e,i)}rI(t,e)}};JB=function(){return ki};QB=function(t,e){var n=ki;try{return ki=t,e()}finally{ki=n}};eT=function(t,e,n){switch(e){case"input":if(Hk(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=s1(i);if(!r)throw Error(jt(90));MB(i),Hk(i,r)}}}break;case"textarea":OB(t,n);break;case"select":e=n.value,e!=null&&Sp(t,!!n.multiple,e,!1)}};NB=Q2;$B=_h;var pG={usingClientEntryPoint:!1,Events:[Lv,dp,s1,BB,FB,Q2]},ly={findFiberByHostInstance:Yd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},mG={bundleType:ly.bundleType,version:ly.version,rendererPackageName:ly.rendererPackageName,rendererConfig:ly.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=UB(t),t===null?null:t.stateNode},findFiberByHostInstance:ly.findFiberByHostInstance||hG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zb.isDisabled&&zb.supportsFiber)try{n1=zb.inject(mG),kl=zb}catch(t){}}Vs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pG;Vs.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sI(e))throw Error(jt(200));return dG(t,e,null,n)};Vs.createRoot=function(t,e){if(!sI(t))throw Error(jt(299));var n=!1,i="",r=w4;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=iI(t,1,!1,null,null,n,!1,i,r),t[mc]=e.current,iv(t.nodeType===8?t.parentNode:t),new oI(e)};Vs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(jt(188)):(t=Object.keys(t).join(","),Error(jt(268,t)));return t=UB(e),t=t===null?null:t.stateNode,t};Vs.flushSync=function(t){return _h(t)};Vs.hydrate=function(t,e,n){if(!m1(e))throw Error(jt(200));return g1(null,t,e,!0,n)};Vs.hydrateRoot=function(t,e,n){if(!sI(t))throw Error(jt(405));var i=n!=null&&n.hydratedSources||null,r=!1,a="",d=w4;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),e=x4(e,null,t,1,n!=null?n:null,r,!1,a,d),t[mc]=e.current,iv(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new p1(e)};Vs.render=function(t,e,n){if(!m1(e))throw Error(jt(200));return g1(null,t,e,!1,n)};Vs.unmountComponentAtNode=function(t){if(!m1(t))throw Error(jt(40));return t._reactRootContainer?(_h(function(){g1(null,null,t,!1,function(){t._reactRootContainer=null,t[mc]=null})}),!0):!1};Vs.unstable_batchedUpdates=Q2;Vs.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!m1(n))throw Error(jt(200));if(t==null||t._reactInternals===void 0)throw Error(jt(38));return g1(t,e,n,!1,i)};Vs.version="18.2.0-next-9e3b772b8-20220608";function S4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(S4)}catch(t){console.error(t)}}S4(),xB.exports=Vs;var Bv=xB.exports;const E4=_c(Bv);var sx,LD=Bv;sx=LD.createRoot,LD.hydrateRoot;function DT(t,e){return DT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},DT(t,e)}function zu(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,DT(t,e)}var k4={exports:{}},gG="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",yG=gG,vG=yG;function T4(){}function C4(){}C4.resetWarningCache=T4;var bG=function(){function t(i,r,a,d,o,f){if(f!==vG){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:C4,resetWarningCache:T4};return n.PropTypes=n,n};k4.exports=bG();var _G=k4.exports;const mr=_c(_G);function Ss(){return Ss=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ss.apply(this,arguments)}function Bb(t){return t.charAt(0)==="/"}function CE(t,e){for(var n=e,i=n+1,r=t.length;i<r;n+=1,i+=1)t[n]=t[i];t.pop()}function xG(t,e){e===void 0&&(e="");var n=t&&t.split("/")||[],i=e&&e.split("/")||[],r=t&&Bb(t),a=e&&Bb(e),d=r||a;if(t&&Bb(t)?i=n:n.length&&(i.pop(),i=i.concat(n)),!i.length)return"/";var o;if(i.length){var f=i[i.length-1];o=f==="."||f===".."||f===""}else o=!1;for(var g=0,_=i.length;_>=0;_--){var w=i[_];w==="."?CE(i,_):w===".."?(CE(i,_),g++):g&&(CE(i,_),g--)}if(!d)for(;g--;g)i.unshift("..");d&&i[0]!==""&&(!i[0]||!Bb(i[0]))&&i.unshift("");var T=i.join("/");return o&&T.substr(-1)!=="/"&&(T+="/"),T}function zD(t){return t.valueOf?t.valueOf():Object.prototype.valueOf.call(t)}function p_(t,e){if(t===e)return!0;if(t==null||e==null)return!1;if(Array.isArray(t))return Array.isArray(e)&&t.length===e.length&&t.every(function(r,a){return p_(r,e[a])});if(typeof t=="object"||typeof e=="object"){var n=zD(t),i=zD(e);return n!==t||i!==e?p_(n,i):Object.keys(Object.assign({},t,e)).every(function(r){return p_(t[r],e[r])})}return!1}var wG=!0,IE="Invariant failed";function Fh(t,e){if(!t){if(wG)throw new Error(IE);var n=typeof e=="function"?e():e,i=n?"".concat(IE,": ").concat(n):IE;throw new Error(i)}}function Ny(t){return t.charAt(0)==="/"?t:"/"+t}function BD(t){return t.charAt(0)==="/"?t.substr(1):t}function SG(t,e){return t.toLowerCase().indexOf(e.toLowerCase())===0&&"/?#".indexOf(t.charAt(e.length))!==-1}function I4(t,e){return SG(t,e)?t.substr(e.length):t}function A4(t){return t.charAt(t.length-1)==="/"?t.slice(0,-1):t}function EG(t){var e=t||"/",n="",i="",r=e.indexOf("#");r!==-1&&(i=e.substr(r),e=e.substr(0,r));var a=e.indexOf("?");return a!==-1&&(n=e.substr(a),e=e.substr(0,a)),{pathname:e,search:n==="?"?"":n,hash:i==="#"?"":i}}function ia(t){var e=t.pathname,n=t.search,i=t.hash,r=e||"/";return n&&n!=="?"&&(r+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(r+=i.charAt(0)==="#"?i:"#"+i),r}function vs(t,e,n,i){var r;typeof t=="string"?(r=EG(t),r.state=e):(r=Ss({},t),r.pathname===void 0&&(r.pathname=""),r.search?r.search.charAt(0)!=="?"&&(r.search="?"+r.search):r.search="",r.hash?r.hash.charAt(0)!=="#"&&(r.hash="#"+r.hash):r.hash="",e!==void 0&&r.state===void 0&&(r.state=e));try{r.pathname=decodeURI(r.pathname)}catch(a){throw a instanceof URIError?new URIError('Pathname "'+r.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):a}return n&&(r.key=n),i?r.pathname?r.pathname.charAt(0)!=="/"&&(r.pathname=xG(r.pathname,i.pathname)):r.pathname=i.pathname:r.pathname||(r.pathname="/"),r}function kG(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&p_(t.state,e.state)}function aI(){var t=null;function e(d){return t=d,function(){t===d&&(t=null)}}function n(d,o,f,g){if(t!=null){var _=typeof t=="function"?t(d,o):t;typeof _=="string"?typeof f=="function"?f(_,g):g(!0):g(_!==!1)}else g(!0)}var i=[];function r(d){var o=!0;function f(){o&&d.apply(void 0,arguments)}return i.push(f),function(){o=!1,i=i.filter(function(g){return g!==f})}}function a(){for(var d=arguments.length,o=new Array(d),f=0;f<d;f++)o[f]=arguments[f];i.forEach(function(g){return g.apply(void 0,o)})}return{setPrompt:e,confirmTransitionTo:n,appendListener:r,notifyListeners:a}}var M4=!!(typeof window<"u"&&window.document&&window.document.createElement);function P4(t,e){e(window.confirm(t))}function TG(){var t=window.navigator.userAgent;return(t.indexOf("Android 2.")!==-1||t.indexOf("Android 4.0")!==-1)&&t.indexOf("Mobile Safari")!==-1&&t.indexOf("Chrome")===-1&&t.indexOf("Windows Phone")===-1?!1:window.history&&"pushState"in window.history}function CG(){return window.navigator.userAgent.indexOf("Trident")===-1}function IG(){return window.navigator.userAgent.indexOf("Firefox")===-1}function AG(t){return t.state===void 0&&navigator.userAgent.indexOf("CriOS")===-1}var FD="popstate",ND="hashchange";function $D(){try{return window.history.state||{}}catch(t){return{}}}function MG(t){t===void 0&&(t={}),M4||Fh(!1);var e=window.history,n=TG(),i=!CG(),r=t,a=r.forceRefresh,d=a===void 0?!1:a,o=r.getUserConfirmation,f=o===void 0?P4:o,g=r.keyLength,_=g===void 0?6:g,w=t.basename?A4(Ny(t.basename)):"";function T(ot){var Be=ot||{},ft=Be.key,gt=Be.state,Nt=window.location,en=Nt.pathname,Xt=Nt.search,wt=Nt.hash,Zt=en+Xt+wt;return w&&(Zt=I4(Zt,w)),vs(Zt,gt,ft)}function A(){return Math.random().toString(36).substr(2,_)}var D=aI();function z(ot){Ss(ze,ot),ze.length=e.length,D.notifyListeners(ze.location,ze.action)}function G(ot){AG(ot)||q(T(ot.state))}function V(){q(T($D()))}var N=!1;function q(ot){if(N)N=!1,z();else{var Be="POP";D.confirmTransitionTo(ot,Be,f,function(ft){ft?z({action:Be,location:ot}):K(ot)})}}function K(ot){var Be=ze.location,ft=ie.indexOf(Be.key);ft===-1&&(ft=0);var gt=ie.indexOf(ot.key);gt===-1&&(gt=0);var Nt=ft-gt;Nt&&(N=!0,me(Nt))}var se=T($D()),ie=[se.key];function Q(ot){return w+ia(ot)}function J(ot,Be){var ft="PUSH",gt=vs(ot,Be,A(),ze.location);D.confirmTransitionTo(gt,ft,f,function(Nt){if(Nt){var en=Q(gt),Xt=gt.key,wt=gt.state;if(n)if(e.pushState({key:Xt,state:wt},null,en),d)window.location.href=en;else{var Zt=ie.indexOf(ze.location.key),Fn=ie.slice(0,Zt+1);Fn.push(gt.key),ie=Fn,z({action:ft,location:gt})}else window.location.href=en}})}function te(ot,Be){var ft="REPLACE",gt=vs(ot,Be,A(),ze.location);D.confirmTransitionTo(gt,ft,f,function(Nt){if(Nt){var en=Q(gt),Xt=gt.key,wt=gt.state;if(n)if(e.replaceState({key:Xt,state:wt},null,en),d)window.location.replace(en);else{var Zt=ie.indexOf(ze.location.key);Zt!==-1&&(ie[Zt]=gt.key),z({action:ft,location:gt})}else window.location.replace(en)}})}function me(ot){e.go(ot)}function Fe(){me(-1)}function tt(){me(1)}var At=0;function _t(ot){At+=ot,At===1&&ot===1?(window.addEventListener(FD,G),i&&window.addEventListener(ND,V)):At===0&&(window.removeEventListener(FD,G),i&&window.removeEventListener(ND,V))}var xt=!1;function lt(ot){ot===void 0&&(ot=!1);var Be=D.setPrompt(ot);return xt||(_t(1),xt=!0),function(){return xt&&(xt=!1,_t(-1)),Be()}}function zt(ot){var Be=D.appendListener(ot);return _t(1),function(){_t(-1),Be()}}var ze={length:e.length,action:"POP",location:se,createHref:Q,push:J,replace:te,go:me,goBack:Fe,goForward:tt,block:lt,listen:zt};return ze}var jD="hashchange",PG={hashbang:{encodePath:function(e){return e.charAt(0)==="!"?e:"!/"+BD(e)},decodePath:function(e){return e.charAt(0)==="!"?e.substr(1):e}},noslash:{encodePath:BD,decodePath:Ny},slash:{encodePath:Ny,decodePath:Ny}};function O4(t){var e=t.indexOf("#");return e===-1?t:t.slice(0,e)}function cy(){var t=window.location.href,e=t.indexOf("#");return e===-1?"":t.substring(e+1)}function OG(t){window.location.hash=t}function AE(t){window.location.replace(O4(window.location.href)+"#"+t)}function DG(t){t===void 0&&(t={}),M4||Fh(!1);var e=window.history;IG();var n=t,i=n.getUserConfirmation,r=i===void 0?P4:i,a=n.hashType,d=a===void 0?"slash":a,o=t.basename?A4(Ny(t.basename)):"",f=PG[d],g=f.encodePath,_=f.decodePath;function w(){var Be=_(cy());return o&&(Be=I4(Be,o)),vs(Be)}var T=aI();function A(Be){Ss(ot,Be),ot.length=e.length,T.notifyListeners(ot.location,ot.action)}var D=!1,z=null;function G(Be,ft){return Be.pathname===ft.pathname&&Be.search===ft.search&&Be.hash===ft.hash}function V(){var Be=cy(),ft=g(Be);if(Be!==ft)AE(ft);else{var gt=w(),Nt=ot.location;if(!D&&G(Nt,gt)||z===ia(gt))return;z=null,N(gt)}}function N(Be){if(D)D=!1,A();else{var ft="POP";T.confirmTransitionTo(Be,ft,r,function(gt){gt?A({action:ft,location:Be}):q(Be)})}}function q(Be){var ft=ot.location,gt=Q.lastIndexOf(ia(ft));gt===-1&&(gt=0);var Nt=Q.lastIndexOf(ia(Be));Nt===-1&&(Nt=0);var en=gt-Nt;en&&(D=!0,Fe(en))}var K=cy(),se=g(K);K!==se&&AE(se);var ie=w(),Q=[ia(ie)];function J(Be){var ft=document.querySelector("base"),gt="";return ft&&ft.getAttribute("href")&&(gt=O4(window.location.href)),gt+"#"+g(o+ia(Be))}function te(Be,ft){var gt="PUSH",Nt=vs(Be,void 0,void 0,ot.location);T.confirmTransitionTo(Nt,gt,r,function(en){if(en){var Xt=ia(Nt),wt=g(o+Xt),Zt=cy()!==wt;if(Zt){z=Xt,OG(wt);var Fn=Q.lastIndexOf(ia(ot.location)),Ci=Q.slice(0,Fn+1);Ci.push(Xt),Q=Ci,A({action:gt,location:Nt})}else A()}})}function me(Be,ft){var gt="REPLACE",Nt=vs(Be,void 0,void 0,ot.location);T.confirmTransitionTo(Nt,gt,r,function(en){if(en){var Xt=ia(Nt),wt=g(o+Xt),Zt=cy()!==wt;Zt&&(z=Xt,AE(wt));var Fn=Q.indexOf(ia(ot.location));Fn!==-1&&(Q[Fn]=Xt),A({action:gt,location:Nt})}})}function Fe(Be){e.go(Be)}function tt(){Fe(-1)}function At(){Fe(1)}var _t=0;function xt(Be){_t+=Be,_t===1&&Be===1?window.addEventListener(jD,V):_t===0&&window.removeEventListener(jD,V)}var lt=!1;function zt(Be){Be===void 0&&(Be=!1);var ft=T.setPrompt(Be);return lt||(xt(1),lt=!0),function(){return lt&&(lt=!1,xt(-1)),ft()}}function ze(Be){var ft=T.appendListener(Be);return xt(1),function(){xt(-1),ft()}}var ot={length:e.length,action:"POP",location:ie,createHref:J,push:te,replace:me,go:Fe,goBack:tt,goForward:At,block:zt,listen:ze};return ot}function VD(t,e,n){return Math.min(Math.max(t,e),n)}function RG(t){t===void 0&&(t={});var e=t,n=e.getUserConfirmation,i=e.initialEntries,r=i===void 0?["/"]:i,a=e.initialIndex,d=a===void 0?0:a,o=e.keyLength,f=o===void 0?6:o,g=aI();function _(J){Ss(Q,J),Q.length=Q.entries.length,g.notifyListeners(Q.location,Q.action)}function w(){return Math.random().toString(36).substr(2,f)}var T=VD(d,0,r.length-1),A=r.map(function(J){return typeof J=="string"?vs(J,void 0,w()):vs(J,void 0,J.key||w())}),D=ia;function z(J,te){var me="PUSH",Fe=vs(J,te,w(),Q.location);g.confirmTransitionTo(Fe,me,n,function(tt){if(tt){var At=Q.index,_t=At+1,xt=Q.entries.slice(0);xt.length>_t?xt.splice(_t,xt.length-_t,Fe):xt.push(Fe),_({action:me,location:Fe,index:_t,entries:xt})}})}function G(J,te){var me="REPLACE",Fe=vs(J,te,w(),Q.location);g.confirmTransitionTo(Fe,me,n,function(tt){tt&&(Q.entries[Q.index]=Fe,_({action:me,location:Fe}))})}function V(J){var te=VD(Q.index+J,0,Q.entries.length-1),me="POP",Fe=Q.entries[te];g.confirmTransitionTo(Fe,me,n,function(tt){tt?_({action:me,location:Fe,index:te}):_()})}function N(){V(-1)}function q(){V(1)}function K(J){var te=Q.index+J;return te>=0&&te<Q.entries.length}function se(J){return J===void 0&&(J=!1),g.setPrompt(J)}function ie(J){return g.appendListener(J)}var Q={length:A.length,action:"POP",location:A[T],index:T,entries:A,createHref:D,push:z,replace:G,go:V,goBack:N,goForward:q,canGo:K,block:se,listen:ie};return Q}var mm={exports:{}},LG=Array.isArray||function(t){return Object.prototype.toString.call(t)=="[object Array]"},ax=LG;mm.exports=L4;mm.exports.parse=lI;mm.exports.compile=BG;mm.exports.tokensToFunction=D4;mm.exports.tokensToRegExp=R4;var zG=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function lI(t,e){for(var n=[],i=0,r=0,a="",d=e&&e.delimiter||"/",o;(o=zG.exec(t))!=null;){var f=o[0],g=o[1],_=o.index;if(a+=t.slice(r,_),r=_+f.length,g){a+=g[1];continue}var w=t[r],T=o[2],A=o[3],D=o[4],z=o[5],G=o[6],V=o[7];a&&(n.push(a),a="");var N=T!=null&&w!=null&&w!==T,q=G==="+"||G==="*",K=G==="?"||G==="*",se=o[2]||d,ie=D||z;n.push({name:A||i++,prefix:T||"",delimiter:se,optional:K,repeat:q,partial:N,asterisk:!!V,pattern:ie?$G(ie):V?".*":"[^"+m_(se)+"]+?"})}return r<t.length&&(a+=t.substr(r)),a&&n.push(a),n}function BG(t,e){return D4(lI(t,e),e)}function FG(t){return encodeURI(t).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function NG(t){return encodeURI(t).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function D4(t,e){for(var n=new Array(t.length),i=0;i<t.length;i++)typeof t[i]=="object"&&(n[i]=new RegExp("^(?:"+t[i].pattern+")$",uI(e)));return function(r,a){for(var d="",o=r||{},f=a||{},g=f.pretty?FG:encodeURIComponent,_=0;_<t.length;_++){var w=t[_];if(typeof w=="string"){d+=w;continue}var T=o[w.name],A;if(T==null)if(w.optional){w.partial&&(d+=w.prefix);continue}else throw new TypeError('Expected "'+w.name+'" to be defined');if(ax(T)){if(!w.repeat)throw new TypeError('Expected "'+w.name+'" to not repeat, but received `'+JSON.stringify(T)+"`");if(T.length===0){if(w.optional)continue;throw new TypeError('Expected "'+w.name+'" to not be empty')}for(var D=0;D<T.length;D++){if(A=g(T[D]),!n[_].test(A))throw new TypeError('Expected all "'+w.name+'" to match "'+w.pattern+'", but received `'+JSON.stringify(A)+"`");d+=(D===0?w.prefix:w.delimiter)+A}continue}if(A=w.asterisk?NG(T):g(T),!n[_].test(A))throw new TypeError('Expected "'+w.name+'" to match "'+w.pattern+'", but received "'+A+'"');d+=w.prefix+A}return d}}function m_(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function $G(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function cI(t,e){return t.keys=e,t}function uI(t){return t&&t.sensitive?"":"i"}function jG(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return cI(t,e)}function VG(t,e,n){for(var i=[],r=0;r<t.length;r++)i.push(L4(t[r],e,n).source);var a=new RegExp("(?:"+i.join("|")+")",uI(n));return cI(a,e)}function UG(t,e,n){return R4(lI(t,n),e,n)}function R4(t,e,n){ax(e)||(n=e||n,e=[]),n=n||{};for(var i=n.strict,r=n.end!==!1,a="",d=0;d<t.length;d++){var o=t[d];if(typeof o=="string")a+=m_(o);else{var f=m_(o.prefix),g="(?:"+o.pattern+")";e.push(o),o.repeat&&(g+="(?:"+f+g+")*"),o.optional?o.partial?g=f+"("+g+")?":g="(?:"+f+"("+g+"))?":g=f+"("+g+")",a+=g}}var _=m_(n.delimiter||"/"),w=a.slice(-_.length)===_;return i||(a=(w?a.slice(0,-_.length):a)+"(?:"+_+"(?=$))?"),r?a+="$":a+=i&&w?"":"(?="+_+"|$)",cI(new RegExp("^"+a,uI(n)),e)}function L4(t,e,n){return ax(e)||(n=e||n,e=[]),n=n||{},t instanceof RegExp?jG(t,e):ax(t)?VG(t,e,n):UG(t,e,n)}var qG=mm.exports;const z4=_c(qG);var B4={exports:{}},Ti={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ho=typeof Symbol=="function"&&Symbol.for,dI=ho?Symbol.for("react.element"):60103,hI=ho?Symbol.for("react.portal"):60106,y1=ho?Symbol.for("react.fragment"):60107,v1=ho?Symbol.for("react.strict_mode"):60108,b1=ho?Symbol.for("react.profiler"):60114,_1=ho?Symbol.for("react.provider"):60109,x1=ho?Symbol.for("react.context"):60110,fI=ho?Symbol.for("react.async_mode"):60111,w1=ho?Symbol.for("react.concurrent_mode"):60111,S1=ho?Symbol.for("react.forward_ref"):60112,E1=ho?Symbol.for("react.suspense"):60113,WG=ho?Symbol.for("react.suspense_list"):60120,k1=ho?Symbol.for("react.memo"):60115,T1=ho?Symbol.for("react.lazy"):60116,GG=ho?Symbol.for("react.block"):60121,HG=ho?Symbol.for("react.fundamental"):60117,ZG=ho?Symbol.for("react.responder"):60118,XG=ho?Symbol.for("react.scope"):60119;function qs(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case dI:switch(t=t.type,t){case fI:case w1:case y1:case b1:case v1:case E1:return t;default:switch(t=t&&t.$$typeof,t){case x1:case S1:case T1:case k1:case _1:return t;default:return e}}case hI:return e}}}function F4(t){return qs(t)===w1}Ti.AsyncMode=fI;Ti.ConcurrentMode=w1;Ti.ContextConsumer=x1;Ti.ContextProvider=_1;Ti.Element=dI;Ti.ForwardRef=S1;Ti.Fragment=y1;Ti.Lazy=T1;Ti.Memo=k1;Ti.Portal=hI;Ti.Profiler=b1;Ti.StrictMode=v1;Ti.Suspense=E1;Ti.isAsyncMode=function(t){return F4(t)||qs(t)===fI};Ti.isConcurrentMode=F4;Ti.isContextConsumer=function(t){return qs(t)===x1};Ti.isContextProvider=function(t){return qs(t)===_1};Ti.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===dI};Ti.isForwardRef=function(t){return qs(t)===S1};Ti.isFragment=function(t){return qs(t)===y1};Ti.isLazy=function(t){return qs(t)===T1};Ti.isMemo=function(t){return qs(t)===k1};Ti.isPortal=function(t){return qs(t)===hI};Ti.isProfiler=function(t){return qs(t)===b1};Ti.isStrictMode=function(t){return qs(t)===v1};Ti.isSuspense=function(t){return qs(t)===E1};Ti.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===y1||t===w1||t===b1||t===v1||t===E1||t===WG||typeof t=="object"&&t!==null&&(t.$$typeof===T1||t.$$typeof===k1||t.$$typeof===_1||t.$$typeof===x1||t.$$typeof===S1||t.$$typeof===HG||t.$$typeof===ZG||t.$$typeof===XG||t.$$typeof===GG)};Ti.typeOf=qs;B4.exports=Ti;var KG=B4.exports;function N4(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,a;for(a=0;a<i.length;a++)r=i[a],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}var pI=KG,YG={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},JG={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},QG={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},$4={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},mI={};mI[pI.ForwardRef]=QG;mI[pI.Memo]=$4;function UD(t){return pI.isMemo(t)?$4:mI[t.$$typeof]||YG}var e7=Object.defineProperty,t7=Object.getOwnPropertyNames,qD=Object.getOwnPropertySymbols,n7=Object.getOwnPropertyDescriptor,i7=Object.getPrototypeOf,WD=Object.prototype;function j4(t,e,n){if(typeof e!="string"){if(WD){var i=i7(e);i&&i!==WD&&j4(t,i,n)}var r=t7(e);qD&&(r=r.concat(qD(e)));for(var a=UD(t),d=UD(e),o=0;o<r.length;++o){var f=r[o];if(!JG[f]&&!(n&&n[f])&&!(d&&d[f])&&!(a&&a[f])){var g=n7(e,f);try{e7(t,f,g)}catch(_){}}}}return t}var r7=j4;const o7=_c(r7);var ME=1073741823,GD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{};function s7(){var t="__global_unique_id__";return GD[t]=(GD[t]||0)+1}function a7(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function l7(t){var e=[];return{on:function(i){e.push(i)},off:function(i){e=e.filter(function(r){return r!==i})},get:function(){return t},set:function(i,r){t=i,e.forEach(function(a){return a(t,r)})}}}function c7(t){return Array.isArray(t)?t[0]:t}function u7(t,e){var n,i,r="__create-react-context-"+s7()+"__",a=function(o){zu(f,o);function f(){for(var _,w=arguments.length,T=new Array(w),A=0;A<w;A++)T[A]=arguments[A];return _=o.call.apply(o,[this].concat(T))||this,_.emitter=l7(_.props.value),_}var g=f.prototype;return g.getChildContext=function(){var w;return w={},w[r]=this.emitter,w},g.componentWillReceiveProps=function(w){if(this.props.value!==w.value){var T=this.props.value,A=w.value,D;a7(T,A)?D=0:(D=typeof e=="function"?e(T,A):ME,D|=0,D!==0&&this.emitter.set(w.value,D))}},g.render=function(){return this.props.children},f}(We.Component);a.childContextTypes=(n={},n[r]=mr.object.isRequired,n);var d=function(o){zu(f,o);function f(){for(var _,w=arguments.length,T=new Array(w),A=0;A<w;A++)T[A]=arguments[A];return _=o.call.apply(o,[this].concat(T))||this,_.observedBits=void 0,_.state={value:_.getValue()},_.onUpdate=function(D,z){var G=_.observedBits|0;G&z&&_.setState({value:_.getValue()})},_}var g=f.prototype;return g.componentWillReceiveProps=function(w){var T=w.observedBits;this.observedBits=T==null?ME:T},g.componentDidMount=function(){this.context[r]&&this.context[r].on(this.onUpdate);var w=this.props.observedBits;this.observedBits=w==null?ME:w},g.componentWillUnmount=function(){this.context[r]&&this.context[r].off(this.onUpdate)},g.getValue=function(){return this.context[r]?this.context[r].get():t},g.render=function(){return c7(this.props.children)(this.state.value)},f}(We.Component);return d.contextTypes=(i={},i[r]=mr.object,i),{Provider:a,Consumer:d}}var d7=We.createContext||u7,V4=function(e){var n=d7();return n.displayName=e,n},h7=V4("Router-History"),Kp=V4("Router"),Fv=function(t){zu(e,t),e.computeRootMatch=function(r){return{path:"/",url:"/",params:{},isExact:r==="/"}};function e(i){var r;return r=t.call(this,i)||this,r.state={location:i.history.location},r._isMounted=!1,r._pendingLocation=null,i.staticContext||(r.unlisten=i.history.listen(function(a){r._pendingLocation=a})),r}var n=e.prototype;return n.componentDidMount=function(){var r=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen(function(a){r._isMounted&&r.setState({location:a})})),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return We.createElement(Kp.Provider,{value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},We.createElement(h7.Provider,{children:this.props.children||null,value:this.props.history}))},e}(We.Component);We.Component;var f7=function(t){zu(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(r){this.props.onUpdate&&this.props.onUpdate.call(this,this,r)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},e}(We.Component),PE={},p7=1e4,HD=0;function m7(t){if(PE[t])return PE[t];var e=z4.compile(t);return HD<p7&&(PE[t]=e,HD++),e}function ZD(t,e){return t===void 0&&(t="/"),e===void 0&&(e={}),t==="/"?t:m7(t)(e,{pretty:!0})}function g7(t){var e=t.computedMatch,n=t.to,i=t.push,r=i===void 0?!1:i;return We.createElement(Kp.Consumer,null,function(a){a||Fh(!1);var d=a.history,o=a.staticContext,f=r?d.push:d.replace,g=vs(e?typeof n=="string"?ZD(n,e.params):Ss({},n,{pathname:ZD(n.pathname,e.params)}):n);return o?(f(g),null):We.createElement(f7,{onMount:function(){f(g)},onUpdate:function(w,T){var A=vs(T.to);kG(A,Ss({},g,{key:A.key}))||f(g)},to:n})})}var XD={},y7=1e4,KD=0;function v7(t,e){var n=""+e.end+e.strict+e.sensitive,i=XD[n]||(XD[n]={});if(i[t])return i[t];var r=[],a=z4(t,r,e),d={regexp:a,keys:r};return KD<y7&&(i[t]=d,KD++),d}function xh(t,e){e===void 0&&(e={}),(typeof e=="string"||Array.isArray(e))&&(e={path:e});var n=e,i=n.path,r=n.exact,a=r===void 0?!1:r,d=n.strict,o=d===void 0?!1:d,f=n.sensitive,g=f===void 0?!1:f,_=[].concat(i);return _.reduce(function(w,T){if(!T&&T!=="")return null;if(w)return w;var A=v7(T,{end:a,strict:o,sensitive:g}),D=A.regexp,z=A.keys,G=D.exec(t);if(!G)return null;var V=G[0],N=G.slice(1),q=t===V;return a&&!q?null:{path:T,url:T==="/"&&V===""?"/":V,isExact:q,params:z.reduce(function(K,se,ie){return K[se.name]=N[ie],K},{})}},null)}function b7(t){return We.Children.count(t)===0}var tc=function(t){zu(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.render=function(){var r=this;return We.createElement(Kp.Consumer,null,function(a){a||Fh(!1);var d=r.props.location||a.location,o=r.props.computedMatch?r.props.computedMatch:r.props.path?xh(d.pathname,r.props):a.match,f=Ss({},a,{location:d,match:o}),g=r.props,_=g.children,w=g.component,T=g.render;return Array.isArray(_)&&b7(_)&&(_=null),We.createElement(Kp.Provider,{value:f},f.match?_?typeof _=="function"?_(f):_:w?We.createElement(w,f):T?T(f):null:typeof _=="function"?_(f):null)})},e}(We.Component);function gI(t){return t.charAt(0)==="/"?t:"/"+t}function _7(t,e){return t?Ss({},e,{pathname:gI(t)+e.pathname}):e}function x7(t,e){if(!t)return e;var n=gI(t);return e.pathname.indexOf(n)!==0?e:Ss({},e,{pathname:e.pathname.substr(n.length)})}function YD(t){return typeof t=="string"?t:ia(t)}function OE(t){return function(){Fh(!1)}}function JD(){}We.Component;We.Component;function w7(t){var e="withRouter("+(t.displayName||t.name)+")",n=function(r){var a=r.wrappedComponentRef,d=N4(r,["wrappedComponentRef"]);return We.createElement(Kp.Consumer,null,function(o){return o||Fh(!1),We.createElement(t,Ss({},d,o,{ref:a}))})};return n.displayName=e,n.WrappedComponent=t,o7(n,t)}We.useContext;const S7="modulepreload",E7=function(t){return"/"+t},QD={},Zo=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(a=>{if(a=E7(a),a in QD)return;QD[a]=!0;const d=a.endsWith(".css"),o=d?'[rel="stylesheet"]':"";if(!!i)for(let _=r.length-1;_>=0;_--){const w=r[_];if(w.href===a&&(!d||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${o}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":S7,d||(g.as="script",g.crossOrigin=""),g.href=a,document.head.appendChild(g),d)return new Promise((_,w)=>{g.addEventListener("load",_),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e()).catch(a=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=a,window.dispatchEvent(d),!d.defaultPrevented)throw a})},Xf={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let Kf,U4,C1,q4=!1,lx=!1,yI=!1,Rs=!1,eR=null,RT=!1;const k7={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},T7=t=>{const e=new URL(t,co.$resourcesUrl$);return e.origin!==$v.location.origin?e.href:e.pathname},wh=(t,e="")=>()=>{},tR="http://www.w3.org/1999/xlink",nR={},C7="http://www.w3.org/2000/svg",I7="http://www.w3.org/1999/xhtml",A7=t=>t!=null,vI=t=>(t=typeof t,t==="object"||t==="function");function M7(t){var e,n,i;return(i=(n=(e=t.head)===null||e===void 0?void 0:e.querySelector('meta[name="csp-nonce"]'))===null||n===void 0?void 0:n.getAttribute("content"))!==null&&i!==void 0?i:void 0}const Rt=(t,e,...n)=>{let i=null,r=null,a=null,d=!1,o=!1;const f=[],g=w=>{for(let T=0;T<w.length;T++)i=w[T],Array.isArray(i)?g(i):i!=null&&typeof i!="boolean"&&((d=typeof t!="function"&&!vI(i))&&(i=String(i)),d&&o?f[f.length-1].$text$+=i:f.push(d?cx(null,i):i),o=d)};if(g(n),e){e.key&&(r=e.key),e.name&&(a=e.name);{const w=e.className||e.class;w&&(e.class=typeof w!="object"?w:Object.keys(w).filter(T=>w[T]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,f,O7);const _=cx(t,null);return _.$attrs$=e,f.length>0&&(_.$children$=f),_.$key$=r,_.$name$=a,_},cx=(t,e)=>{const n={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return n.$attrs$=null,n.$key$=null,n.$name$=null,n},_r={},P7=t=>t&&t.$tag$===_r,O7={forEach:(t,e)=>t.map(iR).forEach(e),map:(t,e)=>t.map(iR).map(e).map(D7)},iR=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),D7=t=>{if(typeof t.vtag=="function"){const n=Object.assign({},t.vattrs);return t.vkey&&(n.key=t.vkey),t.vname&&(n.name=t.vname),Rt(t.vtag,n,...t.vchildren||[])}const e=cx(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},R7=t=>tN.map(e=>e(t)).find(e=>!!e),L7=t=>tN.push(t),z7=t=>gm(t).$modeName$,B7=(t,e)=>t!=null&&!vI(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t,F7=t=>t,Wn=(t,e,n)=>{const i=F7(t);return{emit:r=>N7(i,e,{bubbles:!!(n&4),composed:!!(n&2),cancelable:!!(n&1),detail:r})}},N7=(t,e,n)=>{const i=co.ce(e,n);return t.dispatchEvent(i),i},rR=new WeakMap,$7=(t,e,n)=>{let i=hx.get(t);f9&&n?(i=i||new CSSStyleSheet,typeof i=="string"?i=e:i.replaceSync(e)):i=e,hx.set(t,i)},j7=(t,e,n,i)=>{var r;let a=W4(e,n);const d=hx.get(a);if(t=t.nodeType===11?t:Xa,d)if(typeof d=="string"){t=t.head||t;let o=rR.get(t),f;if(o||rR.set(t,o=new Set),!o.has(a)){{f=Xa.createElement("style"),f.innerHTML=d;const g=(r=co.$nonce$)!==null&&r!==void 0?r:M7(Xa);g!=null&&f.setAttribute("nonce",g),t.insertBefore(f,t.querySelector("link"))}o&&o.add(a)}}else t.adoptedStyleSheets.includes(d)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,d]);return a},V7=t=>{const e=t.$cmpMeta$,n=t.$hostElement$,i=e.$flags$,r=wh("attachStyles",e.$tagName$),a=j7(n.shadowRoot?n.shadowRoot:n.getRootNode(),e,t.$modeName$);i&10&&(n["s-sc"]=a,n.classList.add(a+"-h"),i&2&&n.classList.add(a+"-s")),r()},W4=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),oR=(t,e,n,i,r,a)=>{if(n!==i){let d=cR(t,e),o=e.toLowerCase();if(e==="class"){const f=t.classList,g=sR(n),_=sR(i);f.remove(...g.filter(w=>w&&!_.includes(w))),f.add(..._.filter(w=>w&&!g.includes(w)))}else if(e==="style"){for(const f in n)(!i||i[f]==null)&&(f.includes("-")?t.style.removeProperty(f):t.style[f]="");for(const f in i)(!n||i[f]!==n[f])&&(f.includes("-")?t.style.setProperty(f,i[f]):t.style[f]=i[f])}else if(e!=="key")if(e==="ref")i&&i(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):cR($v,o)?e=o.slice(2):e=o[2]+e.slice(3),n&&co.rel(t,e,n,!1),i&&co.ael(t,e,i,!1);else{const f=vI(i);if((d||f&&i!==null)&&!r)try{if(t.tagName.includes("-"))t[e]=i;else{const _=i==null?"":i;e==="list"?d=!1:(n==null||t[e]!=_)&&(t[e]=_)}}catch(_){}let g=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(e=o,g=!0),i==null||i===!1?(i!==!1||t.getAttribute(e)==="")&&(g?t.removeAttributeNS(tR,e):t.removeAttribute(e)):(!d||a&4||r)&&!f&&(i=i===!0?"":i,g?t.setAttributeNS(tR,e,i):t.setAttribute(e,i))}}},U7=/\s/,sR=t=>t?t.split(U7):[],G4=(t,e,n,i)=>{const r=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,a=t&&t.$attrs$||nR,d=e.$attrs$||nR;for(i in a)i in d||oR(r,i,a[i],void 0,n,e.$flags$);for(i in d)oR(r,i,a[i],d[i],n,e.$flags$)},ux=(t,e,n,i)=>{const r=e.$children$[n];let a=0,d,o,f;if(q4||(yI=!0,r.$tag$==="slot"&&(Kf&&i.classList.add(Kf+"-s"),r.$flags$|=r.$children$?2:1)),r.$text$!==null)d=r.$elm$=Xa.createTextNode(r.$text$);else if(r.$flags$&1)d=r.$elm$=Xa.createTextNode("");else{if(Rs||(Rs=r.$tag$==="svg"),d=r.$elm$=Xa.createElementNS(Rs?C7:I7,r.$flags$&2?"slot-fb":r.$tag$),Rs&&r.$tag$==="foreignObject"&&(Rs=!1),G4(null,r,Rs),A7(Kf)&&d["s-si"]!==Kf&&d.classList.add(d["s-si"]=Kf),r.$children$)for(a=0;a<r.$children$.length;++a)o=ux(t,r,a,d),o&&d.appendChild(o);r.$tag$==="svg"?Rs=!1:d.tagName==="foreignObject"&&(Rs=!0)}return d["s-hn"]=C1,r.$flags$&3&&(d["s-sr"]=!0,d["s-cr"]=U4,d["s-sn"]=r.$name$||"",f=t&&t.$children$&&t.$children$[n],f&&f.$tag$===r.$tag$&&t.$elm$&&hv(t.$elm$,!1)),d},hv=(t,e)=>{co.$flags$|=1;const n=t.childNodes;for(let i=n.length-1;i>=0;i--){const r=n[i];r["s-hn"]!==C1&&r["s-ol"]&&(X4(r).insertBefore(r,bI(r)),r["s-ol"].remove(),r["s-ol"]=void 0,yI=!0),e&&hv(r,e)}co.$flags$&=-2},H4=(t,e,n,i,r,a)=>{let d=t["s-cr"]&&t["s-cr"].parentNode||t,o;for(d.shadowRoot&&d.tagName===C1&&(d=d.shadowRoot);r<=a;++r)i[r]&&(o=ux(null,n,r,t),o&&(i[r].$elm$=o,d.insertBefore(o,bI(e))))},Z4=(t,e,n)=>{for(let i=e;i<=n;++i){const r=t[i];if(r){const a=r.$elm$;J4(r),a&&(lx=!0,a["s-ol"]?a["s-ol"].remove():hv(a,!0),a.remove())}}},q7=(t,e,n,i)=>{let r=0,a=0,d=0,o=0,f=e.length-1,g=e[0],_=e[f],w=i.length-1,T=i[0],A=i[w],D,z;for(;r<=f&&a<=w;)if(g==null)g=e[++r];else if(_==null)_=e[--f];else if(T==null)T=i[++a];else if(A==null)A=i[--w];else if(Fb(g,T))Yf(g,T),g=e[++r],T=i[++a];else if(Fb(_,A))Yf(_,A),_=e[--f],A=i[--w];else if(Fb(g,A))(g.$tag$==="slot"||A.$tag$==="slot")&&hv(g.$elm$.parentNode,!1),Yf(g,A),t.insertBefore(g.$elm$,_.$elm$.nextSibling),g=e[++r],A=i[--w];else if(Fb(_,T))(g.$tag$==="slot"||A.$tag$==="slot")&&hv(_.$elm$.parentNode,!1),Yf(_,T),t.insertBefore(_.$elm$,g.$elm$),_=e[--f],T=i[++a];else{for(d=-1,o=r;o<=f;++o)if(e[o]&&e[o].$key$!==null&&e[o].$key$===T.$key$){d=o;break}d>=0?(z=e[d],z.$tag$!==T.$tag$?D=ux(e&&e[a],n,d,t):(Yf(z,T),e[d]=void 0,D=z.$elm$),T=i[++a]):(D=ux(e&&e[a],n,a,t),T=i[++a]),D&&X4(g.$elm$).insertBefore(D,bI(g.$elm$))}r>f?H4(t,i[w+1]==null?null:i[w+1].$elm$,n,i,a,w):a>w&&Z4(e,r,f)},Fb=(t,e)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:t.$key$===e.$key$:!1,bI=t=>t&&t["s-ol"]||t,X4=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,Yf=(t,e)=>{const n=e.$elm$=t.$elm$,i=t.$children$,r=e.$children$,a=e.$tag$,d=e.$text$;let o;d===null?(Rs=a==="svg"?!0:a==="foreignObject"?!1:Rs,a==="slot"||G4(t,e,Rs),i!==null&&r!==null?q7(n,i,e,r):r!==null?(t.$text$!==null&&(n.textContent=""),H4(n,null,e,r,0,r.length-1)):i!==null&&Z4(i,0,i.length-1),Rs&&a==="svg"&&(Rs=!1)):(o=n["s-cr"])?o.parentNode.textContent=d:t.$text$!==d&&(n.data=d)},K4=t=>{const e=t.childNodes;let n,i,r,a,d,o;for(i=0,r=e.length;i<r;i++)if(n=e[i],n.nodeType===1){if(n["s-sr"]){for(d=n["s-sn"],n.hidden=!1,a=0;a<r;a++)if(o=e[a].nodeType,e[a]["s-hn"]!==n["s-hn"]||d!==""){if(o===1&&d===e[a].getAttribute("slot")){n.hidden=!0;break}}else if(o===1||o===3&&e[a].textContent.trim()!==""){n.hidden=!0;break}}K4(n)}},Va=[],Y4=t=>{let e,n,i,r,a,d,o=0;const f=t.childNodes,g=f.length;for(;o<g;o++){if(e=f[o],e["s-sr"]&&(n=e["s-cr"])&&n.parentNode)for(i=n.parentNode.childNodes,r=e["s-sn"],d=i.length-1;d>=0;d--)n=i[d],!n["s-cn"]&&!n["s-nr"]&&n["s-hn"]!==e["s-hn"]&&(aR(n,r)?(a=Va.find(_=>_.$nodeToRelocate$===n),lx=!0,n["s-sn"]=n["s-sn"]||r,a?a.$slotRefNode$=e:Va.push({$slotRefNode$:e,$nodeToRelocate$:n}),n["s-sr"]&&Va.map(_=>{aR(_.$nodeToRelocate$,n["s-sn"])&&(a=Va.find(w=>w.$nodeToRelocate$===n),a&&!_.$slotRefNode$&&(_.$slotRefNode$=a.$slotRefNode$))})):Va.some(_=>_.$nodeToRelocate$===n)||Va.push({$nodeToRelocate$:n}));e.nodeType===1&&Y4(e)}},aR=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",J4=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(J4)},W7=(t,e)=>{const n=t.$hostElement$,i=t.$cmpMeta$,r=t.$vnode$||cx(null,null),a=P7(e)?e:Rt(null,null,e);C1=n.tagName,i.$attrsToReflect$&&(a.$attrs$=a.$attrs$||{},i.$attrsToReflect$.map(([d,o])=>a.$attrs$[o]=n[d])),a.$tag$=null,a.$flags$|=4,t.$vnode$=a,a.$elm$=r.$elm$=n.shadowRoot||n,Kf=n["s-sc"],U4=n["s-cr"],q4=(i.$flags$&1)!==0,lx=!1,Yf(r,a);{if(co.$flags$|=1,yI){Y4(a.$elm$);let d,o,f,g,_,w,T=0;for(;T<Va.length;T++)d=Va[T],o=d.$nodeToRelocate$,o["s-ol"]||(f=Xa.createTextNode(""),f["s-nr"]=o,o.parentNode.insertBefore(o["s-ol"]=f,o));for(T=0;T<Va.length;T++)if(d=Va[T],o=d.$nodeToRelocate$,d.$slotRefNode$){for(g=d.$slotRefNode$.parentNode,_=d.$slotRefNode$.nextSibling,f=o["s-ol"];f=f.previousSibling;)if(w=f["s-nr"],w&&w["s-sn"]===o["s-sn"]&&g===w.parentNode&&(w=w.nextSibling,!w||!w["s-nr"])){_=w;break}(!_&&g!==o.parentNode||o.nextSibling!==_)&&o!==_&&(!o["s-hn"]&&o["s-ol"]&&(o["s-hn"]=o["s-ol"].parentNode.nodeName),g.insertBefore(o,_))}else o.nodeType===1&&(o.hidden=!0)}lx&&K4(a.$elm$),co.$flags$&=-2,Va.length=0}},G7=(t,e)=>{},_I=(t,e)=>(t.$flags$|=16,G7(t,t.$ancestorComponent$),Al(()=>H7(t,e))),H7=(t,e)=>{const n=t.$hostElement$,i=wh("scheduleUpdate",t.$cmpMeta$.$tagName$),r=n;let a;return e?a=Ap(r,"componentWillLoad"):a=Ap(r,"componentWillUpdate"),a=lR(a,()=>Ap(r,"componentWillRender")),i(),lR(a,()=>X7(t,r,e))},lR=(t,e)=>Z7(t)?t.then(e):e(),Z7=t=>t instanceof Promise||t&&t.then&&typeof t.then=="function",X7=async(t,e,n)=>{const i=t.$hostElement$,r=wh("update",t.$cmpMeta$.$tagName$);i["s-rc"],n&&V7(t);const a=wh("render",t.$cmpMeta$.$tagName$);K7(t,e,i),a(),r(),Y7(t)},K7=(t,e,n)=>{try{eR=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(Xf.hasRenderFn||Xf.reflect)&&(Xf.vdomRender||Xf.reflect)&&(Xf.hydrateServerSide||W7(t,e))}catch(o){Nv(o,t.$hostElement$)}return eR=null,null},Y7=t=>{const e=t.$cmpMeta$.$tagName$,n=t.$hostElement$,i=wh("postUpdate",e),r=n;t.$ancestorComponent$,Ap(r,"componentDidRender"),t.$flags$&64?(Ap(r,"componentDidUpdate"),i()):(t.$flags$|=64,Ap(r,"componentDidLoad"),i())},dx=t=>{{const e=gm(t),n=e.$hostElement$.isConnected;return n&&(e.$flags$&18)===2&&_I(e,!1),n}},Ap=(t,e,n)=>{if(t&&t[e])try{return t[e](n)}catch(i){Nv(i)}},J7=(t,e)=>gm(t).$instanceValues$.get(e),Q7=(t,e,n,i)=>{const r=gm(t),a=t,d=r.$instanceValues$.get(e),o=r.$flags$,f=a;n=B7(n,i.$members$[e][0]);const g=Number.isNaN(d)&&Number.isNaN(n);if(n!==d&&!g){r.$instanceValues$.set(e,n);{if(i.$watchers$&&o&128){const w=i.$watchers$[e];w&&w.map(T=>{try{f[T](n,d,e)}catch(A){Nv(A,a)}})}if((o&18)===2){if(f.componentShouldUpdate&&f.componentShouldUpdate(n,d,e)===!1)return;_I(r,!1)}}}},e9=(t,e,n)=>{if(e.$members$){t.watchers&&(e.$watchers$=t.watchers);const i=Object.entries(e.$members$),r=t.prototype;i.map(([a,[d]])=>{(d&31||d&32)&&Object.defineProperty(r,a,{get(){return J7(this,a)},set(o){Q7(this,a,o,e)},configurable:!0,enumerable:!0})});{const a=new Map;r.attributeChangedCallback=function(d,o,f){co.jmp(()=>{const g=a.get(d);if(this.hasOwnProperty(g))f=this[g],delete this[g];else if(r.hasOwnProperty(g)&&typeof this[g]=="number"&&this[g]==f)return;this[g]=f===null&&typeof this[g]=="boolean"?!1:f})},t.observedAttributes=i.filter(([d,o])=>o[0]&15).map(([d,o])=>{const f=o[1]||d;return a.set(f,d),o[0]&512&&e.$attrsToReflect$.push([d,f]),f})}}return t},t9=async(t,e,n,i,r)=>{if(!(e.$flags$&32)&&(e.$flags$|=32,r=t.constructor,customElements.whenDefined(n.$tagName$).then(()=>e.$flags$|=128),r.style)){let d=r.style;typeof d!="string"&&(d=d[e.$modeName$=R7(t)]);const o=W4(n,e.$modeName$);if(!hx.has(o)){const f=wh("registerStyles",n.$tagName$);$7(o,d,!!(n.$flags$&1)),f()}}e.$ancestorComponent$,(()=>_I(e,!0))()},n9=t=>{},i9=t=>{if(!(co.$flags$&1)){const e=gm(t),n=e.$cmpMeta$,i=wh("connectedCallback",n.$tagName$);e.$flags$&1?(Q4(t,e,n.$listeners$),n9(e.$lazyInstance$)):(e.$flags$|=1,n.$flags$&12&&r9(t),n.$members$&&Object.entries(n.$members$).map(([r,[a]])=>{if(a&31&&t.hasOwnProperty(r)){const d=t[r];delete t[r],t[r]=d}}),t9(t,e,n)),i()}},r9=t=>{const e=t["s-cr"]=Xa.createComment("");e["s-cn"]=!0,t.insertBefore(e,t.firstChild)},o9=t=>{if(!(co.$flags$&1)){const e=gm(t);e.$rmListeners$&&(e.$rmListeners$.map(n=>n()),e.$rmListeners$=void 0)}},xr=(t,e)=>{const n={$flags$:e[0],$tagName$:e[1]};n.$members$=e[2],n.$listeners$=e[3],n.$watchers$=t.$watchers$,n.$attrsToReflect$=[];const i=t.prototype.connectedCallback,r=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){c9(this,n)},connectedCallback(){i9(this),i&&i.call(this)},disconnectedCallback(){o9(this),r&&r.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(n.$flags$&16)})}}),t.is=n.$tagName$,e9(t,n)},Q4=(t,e,n,i)=>{n&&n.map(([r,a,d])=>{const o=a9(t,r),f=s9(e,d),g=l9(r);co.ael(o,a,f,g),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>co.rel(o,a,f,g))})},s9=(t,e)=>n=>{try{Xf.lazyLoad||t.$hostElement$[e](n)}catch(i){Nv(i)}},a9=(t,e)=>e&4?Xa:e&8?$v:e&16?Xa.body:t,l9=t=>d9?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0,eN=new WeakMap,gm=t=>eN.get(t),c9=(t,e)=>{const n={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};return Q4(t,n,e.$listeners$),eN.set(t,n)},cR=(t,e)=>e in t,Nv=(t,e)=>(0,console.error)(t,e),hx=new Map,tN=[],$v=typeof window<"u"?window:{},Xa=$v.document||{head:{}},wr=$v.HTMLElement||class{},co={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,n,i)=>t.addEventListener(e,n,i),rel:(t,e,n,i)=>t.removeEventListener(e,n,i),ce:(t,e)=>new CustomEvent(t,e)},u9=t=>{Object.assign(co,t)},d9=(()=>{let t=!1;try{Xa.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch(e){}return t})(),h9=t=>Promise.resolve(t),f9=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch(t){}return!1})(),LT=[],nN=[],iN=(t,e)=>n=>{t.push(n),RT||(RT=!0,e&&co.$flags$&4?p9(zT):co.raf(zT))},uR=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(n){Nv(n)}t.length=0},zT=()=>{uR(LT),uR(nN),(RT=LT.length>0)&&co.raf(zT)},p9=t=>h9().then(t),fv=iN(LT,!1),Al=iN(nN,!0);/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Zn=typeof window<"u"?window:void 0,DE=typeof document<"u"?document:void 0;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Sh=(t,e)=>{t.componentOnReady?t.componentOnReady().then(n=>e(n)):ro(()=>e(t))},rN=t=>t.componentOnReady!==void 0,ym=(t,e=[])=>{const n={};return e.forEach(i=>{t.hasAttribute(i)&&(t.getAttribute(i)!==null&&(n[i]=t.getAttribute(i)),t.removeAttribute(i))}),n},m9=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],jv=(t,e)=>{let n=m9;return e&&e.length>0&&(n=n.filter(i=>!e.includes(i))),ym(t,n)},g9=(t,e,n,i)=>{var r;if(typeof window<"u"){const a=window,d=(r=a==null?void 0:a.Ionic)===null||r===void 0?void 0:r.config;if(d){const o=d.get("_ael");if(o)return o(t,e,n,i);if(d._ael)return d._ael(t,e,n,i)}}return t.addEventListener(e,n,i)},y9=(t,e,n,i)=>{var r;if(typeof window<"u"){const a=window,d=(r=a==null?void 0:a.Ionic)===null||r===void 0?void 0:r.config;if(d){const o=d.get("_rel");if(o)return o(t,e,n,i);if(d._rel)return d._rel(t,e,n,i)}}return t.removeEventListener(e,n,i)},Bu=(t,e=t)=>t.shadowRoot||e,ro=t=>typeof __zone_symbol__requestAnimationFrame=="function"?__zone_symbol__requestAnimationFrame(t):typeof requestAnimationFrame=="function"?requestAnimationFrame(t):setTimeout(t),v9=t=>!!t.shadowRoot&&!!t.attachShadow,oN=t=>{const e=t.closest("ion-item");return e?e.querySelector("ion-label"):null},b9=t=>{if(t.focus(),t.classList.contains("ion-focusable")){const e=t.closest("ion-app");e&&e.setFocus([t])}},Eh=(t,e,n)=>Math.max(t,Math.min(e,n)),Mr=(t,e)=>{if(!t){const n="ASSERT: "+e;console.error(n);debugger;throw new Error(n)}},tfe=t=>t.timeStamp||Date.now(),nfe=t=>{if(t){const e=t.changedTouches;if(e&&e.length>0){const n=e[0];return{x:n.clientX,y:n.clientY}}if(t.pageX!==void 0)return{x:t.pageX,y:t.pageY}}return{x:0,y:0}},dR=t=>{const e=document.dir==="rtl";switch(t){case"start":return e;case"end":return!e;default:throw new Error(`"${t}" is not a valid value for [side]. Use "start" or "end" instead.`)}},_9=(t,e)=>{const n=t._original||t;return{_original:t,emit:x9(n.emit.bind(n),e)}},x9=(t,e=0)=>{let n;return(...i)=>{clearTimeout(n),n=setTimeout(t,e,...i)}},sN=(t,e)=>{if(t!=null||(t={}),e!=null||(e={}),t===e)return!0;const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const i of n)if(!(i in e)||t[i]!==e[i])return!1;return!0};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */let RE;const w9=t=>(t.forEach(e=>{for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];if(n==="easing"){const r="animation-timing-function";e[r]=i,delete e[n]}else{const r=S9(n);r!==n&&(e[r]=i,delete e[n])}}}),t),S9=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xI=t=>{if(RE===void 0){const e=t.style.animationName!==void 0,n=t.style.webkitAnimationName!==void 0;RE=!e&&n?"-webkit-":""}return RE},tr=(t,e,n)=>{const i=e.startsWith("animation")?xI(t):"";t.style.setProperty(i+e,n)},Ba=(t,e)=>{const n=e.startsWith("animation")?xI(t):"";t.style.removeProperty(n+e)},E9=(t,e)=>{let n;const i={passive:!0},r=()=>{n&&n()},a=d=>{t===d.target&&(r(),e(d))};return t&&(t.addEventListener("webkitAnimationEnd",a,i),t.addEventListener("animationend",a,i),n=()=>{t.removeEventListener("webkitAnimationEnd",a,i),t.removeEventListener("animationend",a,i)}),r},k9=(t=[])=>t.map(e=>{const n=e.offset,i=[];for(const r in e)e.hasOwnProperty(r)&&r!=="offset"&&i.push(`${r}: ${e[r]};`);return`${n*100}% { ${i.join(" ")} }`}).join(" "),hR=[],T9=t=>{let e=hR.indexOf(t);return e<0&&(e=hR.push(t)-1),`ion-animation-${e}`},C9=t=>{const e=t.getRootNode!==void 0?t.getRootNode():t;return e.head||e},I9=(t,e,n)=>{var i;const r=C9(n),a=xI(n),d=r.querySelector("#"+t);if(d)return d;const o=((i=n.ownerDocument)!==null&&i!==void 0?i:document).createElement("style");return o.id=t,o.textContent=`@${a}keyframes ${t} { ${e} } @${a}keyframes ${t}-alt { ${e} }`,r.appendChild(o),o},Nb=(t=[],e)=>{if(e!==void 0){const n=Array.isArray(e)?e:[e];return[...t,...n]}return t},Di=t=>{let e,n,i,r,a,d,o=[],f=[],g=[],_=!1,w,T={},A=[],D=[],z={},G=0,V=!1,N=!1,q,K,se,ie,Q=!0,J=!1,te=!0,me,Fe,tt=!1;const At=t,_t=[],xt=[],lt=[],zt=[],ze=[],ot=[],Be=[],ft=[],gt=[],Nt=[],en=typeof AnimationEffect=="function"||Zn!==void 0&&typeof Zn.AnimationEffect=="function",Xt=typeof Element=="function"&&typeof Element.prototype.animate=="function"&&en,wt=100,Zt=()=>Nt,Fn=nt=>(zt.forEach($t=>{$t.destroy(nt)}),Ci(nt),lt.length=0,zt.length=0,o.length=0,fi(),_=!1,te=!0,Fe),Ci=nt=>{wo(),nt&&ni()},Vi=()=>{V=!1,N=!1,te=!0,K=void 0,se=void 0,ie=void 0,G=0,J=!1,Q=!0,tt=!1},gn=()=>G!==0&&!tt,sr=(nt,$t)=>(($t!=null&&$t.oneTimeCallback?xt:_t).push({c:nt,o:$t}),Fe),fi=()=>(_t.length=0,xt.length=0,Fe),wo=()=>{if(Xt)Nt.forEach(nt=>{nt.cancel()}),Nt.length=0;else{const nt=lt.slice();ro(()=>{nt.forEach($t=>{Ba($t,"animation-name"),Ba($t,"animation-duration"),Ba($t,"animation-timing-function"),Ba($t,"animation-iteration-count"),Ba($t,"animation-delay"),Ba($t,"animation-play-state"),Ba($t,"animation-fill-mode"),Ba($t,"animation-direction")})})}},ni=()=>{ze.forEach(nt=>{nt!=null&&nt.parentNode&&nt.parentNode.removeChild(nt)}),ze.length=0},Ur=nt=>(ot.push(nt),Fe),Hs=nt=>(Be.push(nt),Fe),jo=nt=>(ft.push(nt),Fe),ce=nt=>(gt.push(nt),Fe),Ee=nt=>(f=Nb(f,nt),Fe),Oe=nt=>(g=Nb(g,nt),Fe),pe=(nt={})=>(T=nt,Fe),Xe=(nt=[])=>{for(const $t of nt)T[$t]="";return Fe},Qe=nt=>(A=Nb(A,nt),Fe),$e=nt=>(D=Nb(D,nt),Fe),Ot=(nt={})=>(z=nt,Fe),mt=(nt=[])=>{for(const $t of nt)z[$t]="";return Fe},De=()=>a!==void 0?a:w?w.getFill():"both",Ke=()=>K!==void 0?K:d!==void 0?d:w?w.getDirection():"normal",Lt=()=>V?"linear":i!==void 0?i:w?w.getEasing():"linear",mn=()=>N?0:se!==void 0?se:n!==void 0?n:w?w.getDuration():0,An=()=>r!==void 0?r:w?w.getIterations():1,Xi=()=>ie!==void 0?ie:e!==void 0?e:w?w.getDelay():0,yt=()=>o,En=nt=>(d=nt,pn(!0),Fe),xi=nt=>(a=nt,pn(!0),Fe),fo=nt=>(e=nt,pn(!0),Fe),nl=nt=>(i=nt,pn(!0),Fe),_e=nt=>(!Xt&&nt===0&&(nt=1),n=nt,pn(!0),Fe),Y=nt=>(r=nt,pn(!0),Fe),ee=nt=>(w=nt,Fe),ve=nt=>{if(nt!=null)if(nt.nodeType===1)lt.push(nt);else if(nt.length>=0)for(let $t=0;$t<nt.length;$t++)lt.push(nt[$t]);else console.error("Invalid addElement value");return Fe},ke=nt=>{if(nt!=null)if(Array.isArray(nt))for(const $t of nt)$t.parent(Fe),zt.push($t);else nt.parent(Fe),zt.push(nt);return Fe},Pe=nt=>{const $t=o!==nt;return o=nt,$t&&je(o),Fe},je=nt=>{Xt?Zt().forEach($t=>{if($t.effect.setKeyframes)$t.effect.setKeyframes(nt);else{const an=new KeyframeEffect($t.effect.target,nt,$t.effect.getTiming());$t.effect=an}}):Mt()},Ne=()=>{ot.forEach(qi=>qi()),Be.forEach(qi=>qi());const nt=f,$t=g,an=T;lt.forEach(qi=>{const Li=qi.classList;nt.forEach(Ji=>Li.add(Ji)),$t.forEach(Ji=>Li.remove(Ji));for(const Ji in an)an.hasOwnProperty(Ji)&&tr(qi,Ji,an[Ji])})},Me=()=>{Yi(),ft.forEach(Li=>Li()),gt.forEach(Li=>Li());const nt=Q?1:0,$t=A,an=D,qi=z;lt.forEach(Li=>{const Ji=Li.classList;$t.forEach(Vo=>Ji.add(Vo)),an.forEach(Vo=>Ji.remove(Vo));for(const Vo in qi)qi.hasOwnProperty(Vo)&&tr(Li,Vo,qi[Vo])}),_t.forEach(Li=>Li.c(nt,Fe)),xt.forEach(Li=>Li.c(nt,Fe)),xt.length=0,te=!0,Q&&(J=!0),Q=!0},Ze=()=>{G!==0&&(G--,G===0&&(Me(),w&&w.animationFinish()))},Mt=(nt=!0)=>{ni();const $t=w9(o);lt.forEach(an=>{if($t.length>0){const qi=k9($t);me=t!==void 0?t:T9(qi);const Li=I9(me,qi,an);ze.push(Li),tr(an,"animation-duration",`${mn()}ms`),tr(an,"animation-timing-function",Lt()),tr(an,"animation-delay",`${Xi()}ms`),tr(an,"animation-fill-mode",De()),tr(an,"animation-direction",Ke());const Ji=An()===1/0?"infinite":An().toString();tr(an,"animation-iteration-count",Ji),tr(an,"animation-play-state","paused"),nt&&tr(an,"animation-name",`${Li.id}-alt`),ro(()=>{tr(an,"animation-name",Li.id||null)})}})},Bt=()=>{lt.forEach(nt=>{const $t=nt.animate(o,{id:At,delay:Xi(),duration:mn(),easing:Lt(),iterations:An(),fill:De(),direction:Ke()});$t.pause(),Nt.push($t)}),Nt.length>0&&(Nt[0].onfinish=()=>{Ze()})},kt=(nt=!0)=>{Ne(),o.length>0&&(Xt?Bt():Mt(nt)),_=!0},yn=nt=>{if(nt=Math.min(Math.max(nt,0),.9999),Xt)Nt.forEach($t=>{$t.currentTime=$t.effect.getComputedTiming().delay+mn()*nt,$t.pause()});else{const $t=`-${mn()*nt}ms`;lt.forEach(an=>{o.length>0&&(tr(an,"animation-delay",$t),tr(an,"animation-play-state","paused"))})}},In=nt=>{Nt.forEach($t=>{$t.effect.updateTiming({delay:Xi(),duration:mn(),easing:Lt(),iterations:An(),fill:De(),direction:Ke()})}),nt!==void 0&&yn(nt)},_n=(nt=!0,$t)=>{ro(()=>{lt.forEach(an=>{tr(an,"animation-name",me||null),tr(an,"animation-duration",`${mn()}ms`),tr(an,"animation-timing-function",Lt()),tr(an,"animation-delay",$t!==void 0?`-${$t*mn()}ms`:`${Xi()}ms`),tr(an,"animation-fill-mode",De()||null),tr(an,"animation-direction",Ke()||null);const qi=An()===1/0?"infinite":An().toString();tr(an,"animation-iteration-count",qi),nt&&tr(an,"animation-name",`${me}-alt`),ro(()=>{tr(an,"animation-name",me||null)})})})},pn=(nt=!1,$t=!0,an)=>(nt&&zt.forEach(qi=>{qi.update(nt,$t,an)}),Xt?In(an):_n($t,an),Fe),Ln=(nt=!1,$t)=>(zt.forEach(an=>{an.progressStart(nt,$t)}),Ar(),V=nt,_||kt(),pn(!1,!0,$t),Fe),wi=nt=>(zt.forEach($t=>{$t.progressStep(nt)}),yn(nt),Fe),Ui=(nt,$t,an)=>(V=!1,zt.forEach(qi=>{qi.progressEnd(nt,$t,an)}),an!==void 0&&(se=an),J=!1,Q=!0,nt===0?(K=Ke()==="reverse"?"normal":"reverse",K==="reverse"&&(Q=!1),Xt?(pn(),yn(1-$t)):(ie=(1-$t)*mn()*-1,pn(!1,!1))):nt===1&&(Xt?(pn(),yn($t)):(ie=$t*mn()*-1,pn(!1,!1))),nt!==void 0&&(sr(()=>{se=void 0,K=void 0,ie=void 0},{oneTimeCallback:!0}),w||jn()),Fe),Ar=()=>{_&&(Xt?Nt.forEach(nt=>{nt.pause()}):lt.forEach(nt=>{tr(nt,"animation-play-state","paused")}),tt=!0)},Ki=()=>(zt.forEach(nt=>{nt.pause()}),Ar(),Fe),ns=()=>{q=void 0,Ze()},Yi=()=>{q&&clearTimeout(q)},qr=()=>{if(Yi(),ro(()=>{lt.forEach(nt=>{o.length>0&&tr(nt,"animation-play-state","running")})}),o.length===0||lt.length===0)Ze();else{const nt=Xi()||0,$t=mn()||0,an=An()||1;isFinite(an)&&(q=setTimeout(ns,nt+$t*an+wt)),E9(lt[0],()=>{Yi(),ro(()=>{il(),ro(Ze)})})}},il=()=>{lt.forEach(nt=>{Ba(nt,"animation-duration"),Ba(nt,"animation-delay"),Ba(nt,"animation-play-state")})},Cm=()=>{Nt.forEach(nt=>{nt.play()}),(o.length===0||lt.length===0)&&Ze()},qh=()=>{Xt?(yn(0),In()):_n()},jn=nt=>new Promise($t=>{nt!=null&&nt.sync&&(N=!0,sr(()=>N=!1,{oneTimeCallback:!0})),_||kt(),J&&(qh(),J=!1),te&&(G=zt.length+1,te=!1),sr(()=>$t(),{oneTimeCallback:!0}),zt.forEach(an=>{an.play()}),Xt?Cm():qr(),tt=!1}),nd=()=>{zt.forEach(nt=>{nt.stop()}),_&&(wo(),_=!1),Vi()},rl=(nt,$t)=>{const an=o[0];return an!==void 0&&(an.offset===void 0||an.offset===0)?an[nt]=$t:o=[{offset:0,[nt]:$t},...o],Fe};return Fe={parentAnimation:w,elements:lt,childAnimations:zt,id:At,animationFinish:Ze,from:rl,to:(nt,$t)=>{const an=o[o.length-1];return an!==void 0&&(an.offset===void 0||an.offset===1)?an[nt]=$t:o=[...o,{offset:1,[nt]:$t}],Fe},fromTo:(nt,$t,an)=>rl(nt,$t).to(nt,an),parent:ee,play:jn,pause:Ki,stop:nd,destroy:Fn,keyframes:Pe,addAnimation:ke,addElement:ve,update:pn,fill:xi,direction:En,iterations:Y,duration:_e,easing:nl,delay:fo,getWebAnimations:Zt,getKeyframes:yt,getFill:De,getDirection:Ke,getDelay:Xi,getIterations:An,getEasing:Lt,getDuration:mn,afterAddRead:jo,afterAddWrite:ce,afterClearStyles:mt,afterStyles:Ot,afterRemoveClass:$e,afterAddClass:Qe,beforeAddRead:Ur,beforeAddWrite:Hs,beforeClearStyles:Xe,beforeStyles:pe,beforeRemoveClass:Oe,beforeAddClass:Ee,onFinish:sr,isRunning:gn,progressStart:Ln,progressStep:wi,progressEnd:Ui}},A9="ionViewWillEnter",M9="ionViewDidEnter",aN="ionViewWillLeave",lN="ionViewDidLeave",LE="ionViewWillUnload",P9=()=>Zo(()=>import("./ios.transition-0494e077.js"),[]),O9=()=>Zo(()=>import("./md.transition-686e645f.js"),[]),cN=t=>new Promise((e,n)=>{Al(()=>{D9(t),R9(t).then(i=>{i.animation&&i.animation.destroy(),fR(t),e(i)},i=>{fR(t),n(i)})})}),D9=t=>{const e=t.enteringEl,n=t.leavingEl;j9(e,n,t.direction),t.showGoBack?e.classList.add("can-go-back"):e.classList.remove("can-go-back"),BT(e,!1),e.style.setProperty("pointer-events","none"),n&&(BT(n,!1),n.style.setProperty("pointer-events","none"))},R9=async t=>{const e=await L9(t);return e&&k7.isBrowser?z9(e,t):B9(t)},fR=t=>{const e=t.enteringEl,n=t.leavingEl;e.classList.remove("ion-page-invisible"),e.style.removeProperty("pointer-events"),n!==void 0&&(n.classList.remove("ion-page-invisible"),n.style.removeProperty("pointer-events"))},L9=async t=>!t.leavingEl||!t.animated||t.duration===0?void 0:t.animationBuilder?t.animationBuilder:t.mode==="ios"?(await P9()).iosTransitionAnimation:(await O9()).mdTransitionAnimation,z9=async(t,e)=>{await uN(e,!0);const n=t(e.baseEl,e);dN(e.enteringEl,e.leavingEl);const i=await N9(n,e);return e.progressCallback&&e.progressCallback(void 0),i&&hN(e.enteringEl,e.leavingEl),{hasCompleted:i,animation:n}},B9=async t=>{const e=t.enteringEl,n=t.leavingEl;return await uN(t,!1),dN(e,n),hN(e,n),{hasCompleted:!0}},uN=async(t,e)=>{(t.deepWait!==void 0?t.deepWait:e)&&await Promise.all([fx(t.enteringEl),fx(t.leavingEl)]),await F9(t.viewIsReady,t.enteringEl)},F9=async(t,e)=>{t&&await t(e)},N9=(t,e)=>{const n=e.progressCallback,i=new Promise(r=>{t.onFinish(a=>r(a===1))});return n?(t.progressStart(!0),n(t)):t.play(),i},dN=(t,e)=>{sc(e,aN),sc(t,A9)},hN=(t,e)=>{sc(t,M9),sc(e,lN)},sc=(t,e)=>{if(t){const n=new CustomEvent(e,{bubbles:!1,cancelable:!1});t.dispatchEvent(n)}},$9=()=>new Promise(t=>ro(()=>ro(()=>t()))),fx=async t=>{const e=t;if(e){if(e.componentOnReady!=null){if(await e.componentOnReady()!=null)return}else if(e.__registerHost!=null){await new Promise(i=>ro(i));return}await Promise.all(Array.from(e.children).map(fx))}},BT=(t,e)=>{e?(t.setAttribute("aria-hidden","true"),t.classList.add("ion-page-hidden")):(t.hidden=!1,t.removeAttribute("aria-hidden"),t.classList.remove("ion-page-hidden"))},j9=(t,e,n)=>{t!==void 0&&(t.style.zIndex=n==="back"?"99":"101"),e!==void 0&&(e.style.zIndex="100")},ife=t=>{if(t.classList.contains("ion-page"))return t;const e=t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs");return e||t};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const kh=(t,e,n,i,r)=>U9(t[1],e[1],n[1],i[1],r).map(a=>V9(t[0],e[0],n[0],i[0],a)),V9=(t,e,n,i,r)=>{const a=3*e*Math.pow(r-1,2),d=-3*n*r+3*n+i*r,o=t*Math.pow(r-1,3);return r*(a+r*d)-o},U9=(t,e,n,i,r)=>(t-=r,e-=r,n-=r,i-=r,W9(i-3*n+3*e-t,3*n-6*e+3*t,3*e-3*t,t).filter(d=>d>=0&&d<=1)),q9=(t,e,n)=>{const i=e*e-4*t*n;return i<0?[]:[(-e+Math.sqrt(i))/(2*t),(-e-Math.sqrt(i))/(2*t)]},W9=(t,e,n,i)=>{if(t===0)return q9(e,n,i);e/=t,n/=t,i/=t;const r=(3*n-e*e)/3,a=(2*e*e*e-9*e*n+27*i)/27;if(r===0)return[Math.pow(-a,1/3)];if(a===0)return[Math.sqrt(-r),-Math.sqrt(-r)];const d=Math.pow(a/2,2)+Math.pow(r/3,3);if(d===0)return[Math.pow(a/2,1/2)-e/3];if(d>0)return[Math.pow(-(a/2)+Math.sqrt(d),1/3)-Math.pow(a/2+Math.sqrt(d),1/3)-e/3];const o=Math.sqrt(Math.pow(-(r/3),3)),f=Math.acos(-(a/(2*Math.sqrt(Math.pow(-(r/3),3))))),g=2*Math.pow(o,1/3);return[g*Math.cos(f/3)-e/3,g*Math.cos((f+2*Math.PI)/3)-e/3,g*Math.cos((f+4*Math.PI)/3)-e/3]};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */class G9{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(e){var n;return new H9(this,this.newID(),e.name,(n=e.priority)!==null&&n!==void 0?n:0,!!e.disableScroll)}createBlocker(e={}){return new Z9(this,this.newID(),e.disable,!!e.disableScroll)}start(e,n,i){return this.canStart(e)?(this.requestedStart.set(n,i),!0):(this.requestedStart.delete(n),!1)}capture(e,n,i){if(!this.start(e,n,i))return!1;const r=this.requestedStart;let a=-1e4;if(r.forEach(d=>{a=Math.max(a,d)}),a===i){this.capturedId=n,r.clear();const d=new CustomEvent("ionGestureCaptured",{detail:{gestureName:e}});return document.dispatchEvent(d),!0}return r.delete(n),!1}release(e){this.requestedStart.delete(e),this.capturedId===e&&(this.capturedId=void 0)}disableGesture(e,n){let i=this.disabledGestures.get(e);i===void 0&&(i=new Set,this.disabledGestures.set(e,i)),i.add(n)}enableGesture(e,n){const i=this.disabledGestures.get(e);i!==void 0&&i.delete(n)}disableScroll(e){this.disabledScroll.add(e),this.disabledScroll.size===1&&document.body.classList.add(pR)}enableScroll(e){this.disabledScroll.delete(e),this.disabledScroll.size===0&&document.body.classList.remove(pR)}canStart(e){return!(this.capturedId!==void 0||this.isDisabled(e))}isCaptured(){return this.capturedId!==void 0}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(e){const n=this.disabledGestures.get(e);return!!(n&&n.size>0)}newID(){return this.gestureId++,this.gestureId}}class H9{constructor(e,n,i,r,a){this.id=n,this.name=i,this.disableScroll=a,this.priority=r*1e6+n,this.ctrl=e}canStart(){return this.ctrl?this.ctrl.canStart(this.name):!1}start(){return this.ctrl?this.ctrl.start(this.name,this.id,this.priority):!1}capture(){if(!this.ctrl)return!1;const e=this.ctrl.capture(this.name,this.id,this.priority);return e&&this.disableScroll&&this.ctrl.disableScroll(this.id),e}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class Z9{constructor(e,n,i,r){this.id=n,this.disable=i,this.disableScroll=r,this.ctrl=e}block(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.disableGesture(e,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const e of this.disable)this.ctrl.enableGesture(e,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const pR="backdrop-no-scroll",I1=new G9;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Ud=(t,e,n,i)=>{const r=X9(t)?{capture:!!i.capture,passive:!!i.passive}:!!i.capture;let a,d;return t.__zone_symbol__addEventListener?(a="__zone_symbol__addEventListener",d="__zone_symbol__removeEventListener"):(a="addEventListener",d="removeEventListener"),t[a](e,n,r),()=>{t[d](e,n,r)}},X9=t=>{if($b===void 0)try{const e=Object.defineProperty({},"passive",{get:()=>{$b=!0}});t.addEventListener("optsTest",()=>{},e)}catch(e){$b=!1}return!!$b};let $b;const K9=2e3,Y9=(t,e,n,i,r)=>{let a,d,o,f,g,_,w,T=0;const A=ie=>{T=Date.now()+K9,e(ie)&&(!d&&n&&(d=Ud(t,"touchmove",n,r)),o||(o=Ud(ie.target,"touchend",z,r)),f||(f=Ud(ie.target,"touchcancel",z,r)))},D=ie=>{T>Date.now()||e(ie)&&(!_&&n&&(_=Ud(mR(t),"mousemove",n,r)),w||(w=Ud(mR(t),"mouseup",G,r)))},z=ie=>{V(),i&&i(ie)},G=ie=>{N(),i&&i(ie)},V=()=>{d&&d(),o&&o(),f&&f(),d=o=f=void 0},N=()=>{_&&_(),w&&w(),_=w=void 0},q=()=>{V(),N()},K=(ie=!0)=>{ie?(a||(a=Ud(t,"touchstart",A,r)),g||(g=Ud(t,"mousedown",D,r))):(a&&a(),g&&g(),a=g=void 0,q())};return{enable:K,stop:q,destroy:()=>{K(!1),i=n=e=void 0}}},mR=t=>t instanceof Document?t:t.ownerDocument,J9=(t,e,n)=>{const i=n*(Math.PI/180),r=t==="x",a=Math.cos(i),d=e*e;let o=0,f=0,g=!1,_=0;return{start(w,T){o=w,f=T,_=0,g=!0},detect(w,T){if(!g)return!1;const A=w-o,D=T-f,z=A*A+D*D;if(z<d)return!1;const G=Math.sqrt(z),V=(r?A:D)/G;return V>a?_=1:V<-a?_=-1:_=0,g=!1,!0},isGesture(){return _!==0},getDirection(){return _}}},wI=t=>{let e=!1,n=!1,i=!0,r=!1;const a=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},t),d=a.canStart,o=a.onWillStart,f=a.onStart,g=a.onEnd,_=a.notCaptured,w=a.onMove,T=a.threshold,A=a.passive,D=a.blurOnStart,z={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},G=J9(a.direction,a.threshold,a.maxAngle),V=I1.createGesture({name:t.gestureName,priority:t.gesturePriority,disableScroll:t.disableScroll}),N=tt=>{const At=pN(tt);return n||!i||(fN(tt,z),z.startX=z.currentX,z.startY=z.currentY,z.startTime=z.currentTime=At,z.velocityX=z.velocityY=z.deltaX=z.deltaY=0,z.event=tt,d&&d(z)===!1)||(V.release(),!V.start())?!1:(n=!0,T===0?se():(G.start(z.startX,z.startY),!0))},q=tt=>{if(e){!r&&i&&(r=!0,zE(z,tt),requestAnimationFrame(K));return}zE(z,tt),G.detect(z.currentX,z.currentY)&&(!G.isGesture()||!se())&&Fe()},K=()=>{e&&(r=!1,w&&w(z))},se=()=>V.capture()?(e=!0,i=!1,z.startX=z.currentX,z.startY=z.currentY,z.startTime=z.currentTime,o?o(z).then(Q):Q(),!0):!1,ie=()=>{if(typeof document<"u"){const tt=document.activeElement;tt!=null&&tt.blur&&tt.blur()}},Q=()=>{D&&ie(),f&&f(z),i=!0},J=()=>{e=!1,n=!1,r=!1,i=!0,V.release()},te=tt=>{const At=e,_t=i;if(J(),!!_t){if(zE(z,tt),At){g&&g(z);return}_&&_(z)}},me=Y9(a.el,N,q,te,{capture:!1,passive:A}),Fe=()=>{J(),me.stop(),_&&_(z)};return{enable(tt=!0){tt||(e&&te(void 0),J()),me.enable(tt)},destroy(){V.destroy(),me.destroy()}}},zE=(t,e)=>{if(!e)return;const n=t.currentX,i=t.currentY,r=t.currentTime;fN(e,t);const a=t.currentX,d=t.currentY,f=(t.currentTime=pN(e))-r;if(f>0&&f<100){const g=(a-n)/f,_=(d-i)/f;t.velocityX=g*.7+t.velocityX*.3,t.velocityY=_*.7+t.velocityY*.3}t.deltaX=a-t.startX,t.deltaY=d-t.startY,t.event=e},fN=(t,e)=>{let n=0,i=0;if(t){const r=t.changedTouches;if(r&&r.length>0){const a=r[0];n=a.clientX,i=a.clientY}else t.pageX!==void 0&&(n=t.pageX,i=t.pageY)}e.currentX=n,e.currentY=i},pN=t=>t.timeStamp||Date.now(),Q9=Object.freeze(Object.defineProperty({__proto__:null,GESTURE_CONTROLLER:I1,createGesture:wI},Symbol.toStringTag,{value:"Module"}));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */class eH{constructor(){this.m=new Map}reset(e){this.m=new Map(Object.entries(e))}get(e,n){const i=this.m.get(e);return i!==void 0?i:n}getBoolean(e,n=!1){const i=this.m.get(e);return i===void 0?n:typeof i=="string"?i==="true":!!i}getNumber(e,n){const i=parseFloat(this.m.get(e));return isNaN(i)?n!==void 0?n:NaN:i}set(e,n){this.m.set(e,n)}}const _i=new eH,tH=t=>{try{const e=t.sessionStorage.getItem(mN);return e!==null?JSON.parse(e):{}}catch(e){return{}}},nH=(t,e)=>{try{t.sessionStorage.setItem(mN,JSON.stringify(e))}catch(n){return}},iH=t=>{const e={};return t.location.search.slice(1).split("&").map(n=>n.split("=")).map(([n,i])=>[decodeURIComponent(n),decodeURIComponent(i)]).filter(([n])=>rH(n,gR)).map(([n,i])=>[n.slice(gR.length),i]).forEach(([n,i])=>{e[n]=i}),e},rH=(t,e)=>t.substr(0,e.length)===e,gR="ionic:",mN="ionic-persist-config",oH=t=>gN(t),cc=(t,e)=>(typeof t=="string"&&(e=t,t=void 0),oH(t).includes(e)),gN=(t=window)=>{if(typeof t>"u")return[];t.Ionic=t.Ionic||{};let e=t.Ionic.platforms;return e==null&&(e=t.Ionic.platforms=sH(t),e.forEach(n=>t.document.documentElement.classList.add(`plt-${n}`))),e},sH=t=>{const e=_i.get("platform");return Object.keys(yR).filter(n=>{const i=e==null?void 0:e[n];return typeof i=="function"?i(t):yR[n](t)})},aH=t=>A1(t)&&!vN(t),SI=t=>!!(Th(t,/iPad/i)||Th(t,/Macintosh/i)&&A1(t)),lH=t=>Th(t,/iPhone/i),cH=t=>Th(t,/iPhone|iPod/i)||SI(t),yN=t=>Th(t,/android|sink/i),uH=t=>yN(t)&&!Th(t,/mobile/i),dH=t=>{const e=t.innerWidth,n=t.innerHeight,i=Math.min(e,n),r=Math.max(e,n);return i>390&&i<520&&r>620&&r<800},hH=t=>{const e=t.innerWidth,n=t.innerHeight,i=Math.min(e,n),r=Math.max(e,n);return SI(t)||uH(t)||i>460&&i<820&&r>780&&r<1400},A1=t=>gH(t,"(any-pointer:coarse)"),fH=t=>!A1(t),vN=t=>bN(t)||_N(t),bN=t=>!!(t.cordova||t.phonegap||t.PhoneGap),_N=t=>{const e=t.Capacitor;return!!(e!=null&&e.isNative)},pH=t=>Th(t,/electron/i),mH=t=>{var e;return!!(!((e=t.matchMedia)===null||e===void 0)&&e.call(t,"(display-mode: standalone)").matches||t.navigator.standalone)},Th=(t,e)=>e.test(t.navigator.userAgent),gH=(t,e)=>{var n;return(n=t.matchMedia)===null||n===void 0?void 0:n.call(t,e).matches},yR={ipad:SI,iphone:lH,ios:cH,android:yN,phablet:dH,tablet:hH,cordova:bN,capacitor:_N,electron:pH,pwa:mH,mobile:A1,mobileweb:aH,desktop:fH,hybrid:vN};let Jf;const Xn=t=>t&&z7(t)||Jf,yH=(t={})=>{if(typeof window>"u")return;const e=window.document,n=window,i=n.Ionic=n.Ionic||{},r={};t._ael&&(r.ael=t._ael),t._rel&&(r.rel=t._rel),t._ce&&(r.ce=t._ce),u9(r);const a=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},tH(n)),{persistConfig:!1}),i.config),iH(n)),t);_i.reset(a),_i.getBoolean("persistConfig")&&nH(n,a),gN(n),i.config=_i,i.mode=Jf=_i.get("mode",e.documentElement.getAttribute("mode")||(cc(n,"ios")?"ios":"md")),_i.set("mode",Jf),e.documentElement.setAttribute("mode",Jf),e.documentElement.classList.add(Jf),_i.getBoolean("_testing")&&_i.set("animated",!1);const d=f=>{var g;return(g=f.tagName)===null||g===void 0?void 0:g.startsWith("ION-")},o=f=>["ios","md"].includes(f);L7(f=>{for(;f;){const g=f.mode||f.getAttribute("mode");if(g){if(o(g))return g;d(f)&&console.warn('Invalid ionic mode: "'+g+'", expected: "ios" or "md"')}f=f.parentElement}return Jf})};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const vH=()=>{document.addEventListener("backbutton",()=>{})},bH=()=>{const t=document;let e=!1;t.addEventListener("backbutton",()=>{if(e)return;let n=0,i=[];const r=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(o,f){i.push({priority:o,handler:f,id:n++})}}});t.dispatchEvent(r);const a=async o=>{try{if(o!=null&&o.handler){const f=o.handler(d);f!=null&&await f}}catch(f){console.error(f)}},d=()=>{if(i.length>0){let o={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};i.forEach(f=>{f.priority>=o.priority&&(o=f)}),e=!0,i=i.filter(f=>f.id!==o.id),a(o).then(()=>e=!1)}};d()})},xN=100,wN=99,_H=Object.freeze(Object.defineProperty({__proto__:null,MENU_BACK_BUTTON_PRIORITY:wN,OVERLAY_BACK_BUTTON_PRIORITY:xN,blockHardwareBackButton:vH,startHardwareBackButton:bH},Symbol.toStringTag,{value:"Module"}));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const EI=t=>Di().duration(t?400:300),xH=t=>{let e,n;const i=t.width+8,r=Di(),a=Di();t.isEndSide?(e=i+"px",n="0px"):(e=-i+"px",n="0px"),r.addElement(t.menuInnerEl).fromTo("transform",`translateX(${e})`,`translateX(${n})`);const o=Xn(t)==="ios",f=o?.2:.25;return a.addElement(t.backdropEl).fromTo("opacity",.01,f),EI(o).addAnimation([r,a])},wH=t=>{let e,n;const i=Xn(t),r=t.width;t.isEndSide?(e=-r+"px",n=r+"px"):(e=r+"px",n=-r+"px");const a=Di().addElement(t.menuInnerEl).fromTo("transform",`translateX(${n})`,"translateX(0px)"),d=Di().addElement(t.contentEl).fromTo("transform","translateX(0px)",`translateX(${e})`),o=Di().addElement(t.backdropEl).fromTo("opacity",.01,.32);return EI(i==="ios").addAnimation([a,d,o])},SH=t=>{const e=Xn(t),n=t.width*(t.isEndSide?-1:1)+"px",i=Di().addElement(t.contentEl).fromTo("transform","translateX(0px)",`translateX(${n})`);return EI(e==="ios").addAnimation(i)},EH=()=>{const t=new Map,e=[],n=async J=>{const te=await g(J);return te?te.open():!1},i=async J=>{const te=await(J!==void 0?g(J):_());return te!==void 0?te.close():!1},r=async J=>{const te=await g(J);return te?te.toggle():!1},a=async(J,te)=>{const me=await g(te);return me&&(me.disabled=!J),me},d=async(J,te)=>{const me=await g(te);return me&&(me.swipeGesture=J),me},o=async J=>{if(J!=null){const te=await g(J);return te!==void 0&&te.isOpen()}else return await _()!==void 0},f=async J=>{const te=await g(J);return te?!te.disabled:!1},g=async J=>{if(await Q(),J==="start"||J==="end"){const me=ie(Fe=>Fe.side===J&&!Fe.disabled);return me||ie(Fe=>Fe.side===J)}else if(J!=null)return ie(me=>me.menuId===J);const te=ie(me=>!me.disabled);return te||(e.length>0?e[0].el:void 0)},_=async()=>(await Q(),q()),w=async()=>(await Q(),K()),T=async()=>(await Q(),se()),A=(J,te)=>{t.set(J,te)},D=J=>{e.indexOf(J)<0&&(J.disabled||G(J),e.push(J))},z=J=>{const te=e.indexOf(J);te>-1&&e.splice(te,1)},G=J=>{const te=J.side;e.filter(me=>me.side===te&&me!==J).forEach(me=>me.disabled=!0)},V=async(J,te,me)=>{if(se())return!1;if(te){const Fe=await _();Fe&&J.el!==Fe&&await Fe.setOpen(!1,!1)}return J._setOpen(te,me)},N=(J,te)=>{const me=t.get(J);if(!me)throw new Error("animation not registered");return me(te)},q=()=>ie(J=>J._isOpen),K=()=>e.map(J=>J.el),se=()=>e.some(J=>J.isAnimating),ie=J=>{const te=e.find(J);if(te!==void 0)return te.el},Q=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(J=>new Promise(te=>Sh(J,te))));return A("reveal",SH),A("push",wH),A("overlay",xH),typeof document<"u"&&document.addEventListener("ionBackButton",J=>{const te=q();te&&J.detail.register(wN,()=>te.close())}),{registerAnimation:A,get:g,getMenus:w,getOpen:_,isEnabled:f,swipeGesture:d,isAnimating:T,isOpen:o,enable:a,toggle:r,close:i,open:n,_getOpenSync:q,_createAnimation:N,_register:D,_unregister:z,_setOpen:V,_setActiveMenu:G}},oc=EH();/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const kI=async(t,e,n,i,r,a)=>{var d;if(t)return t.attachViewToDom(e,n,r,i);if(!a&&typeof n!="string"&&!(n instanceof HTMLElement))throw new Error("framework delegate is missing");const o=typeof n=="string"?(d=e.ownerDocument)===null||d===void 0?void 0:d.createElement(n):n;return i&&i.forEach(f=>o.classList.add(f)),r&&Object.assign(o,r),e.appendChild(o),await new Promise(f=>Sh(o,f)),o},SN=(t,e)=>{if(e){if(t){const n=e.parentElement;return t.removeViewFromDom(n,e)}e.remove()}return Promise.resolve()},kH=()=>{let t,e;return{attachViewToDom:async(r,a,d={},o=[])=>{var f,g;if(t=r,a){const w=typeof a=="string"?(f=t.ownerDocument)===null||f===void 0?void 0:f.createElement(a):a;o.forEach(T=>w.classList.add(T)),Object.assign(w,d),t.appendChild(w),await new Promise(T=>Sh(w,T))}else if(t.children.length>0&&(t.tagName==="ION-MODAL"||t.tagName==="ION-POPOVER")&&!t.children[0].classList.contains("ion-delegate-host")){const T=(g=t.ownerDocument)===null||g===void 0?void 0:g.createElement("div");T.classList.add("ion-delegate-host"),o.forEach(A=>T.classList.add(A)),T.append(...t.children),t.appendChild(T)}const _=document.querySelector("ion-app")||document.body;return e=document.createComment("ionic teleport"),t.parentNode.insertBefore(e,t),_.appendChild(t),t},removeViewFromDom:()=>(t&&e&&(e.parentNode.insertBefore(t,e),e.remove()),Promise.resolve())}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const gs=(t,...e)=>console.warn(`[Ionic Warning]: ${t}`,...e),EN=(t,...e)=>console.error(`[Ionic Error]: ${t}`,...e),TH=(t,...e)=>console.error(`<${t.tagName.toLowerCase()}> must be used inside ${e.join(" or ")}.`);/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */let FT=0,CH=0;const px=new WeakMap,IH=t=>{typeof document<"u"&&OH(document);const e=FT++;t.overlayIndex=e},AH=t=>(t.hasAttribute("id")||(t.id=`ion-overlay-${++CH}`),t.id),pv='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',vR=(t,e)=>{let n=t.querySelector(pv);const i=n==null?void 0:n.shadowRoot;i&&(n=i.querySelector(pv)||n),n?b9(n):e.focus()},MH=t=>t.classList.contains("overlay-hidden"),bR=(t,e)=>{const n=Array.from(t.querySelectorAll(pv));let i=n.length>0?n[n.length-1]:null;const r=i==null?void 0:i.shadowRoot;r&&(i=r.querySelector(pv)||i),i?i.focus():e.focus()},PH=(t,e)=>{const n=mx(e,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),i=t.target;if(!n||!i||n.classList.contains("ion-disable-focus-trap"))return;const r=()=>{if(n===i)n.lastFocus=void 0;else{const d=Bu(n);if(!d.contains(i))return;const o=d.querySelector(".ion-overlay-wrapper");if(!o)return;if(o.contains(i))n.lastFocus=i;else{const f=n.lastFocus;vR(o,n),f===e.activeElement&&bR(o,n),n.lastFocus=e.activeElement}}},a=()=>{if(n.contains(i))n.lastFocus=i;else{const d=n.lastFocus;vR(n,n),d===e.activeElement&&bR(n,n),n.lastFocus=e.activeElement}};n.shadowRoot?a():r()},OH=t=>{FT===0&&(FT=1,t.addEventListener("focus",e=>{PH(e,t)},!0),t.addEventListener("ionBackButton",e=>{const n=mx(t);n!=null&&n.backdropDismiss&&e.detail.register(xN,()=>n.dismiss(void 0,NT))}),t.addEventListener("keydown",e=>{if(e.key==="Escape"){const n=mx(t);n!=null&&n.backdropDismiss&&n.dismiss(void 0,NT)}}))},DH=(t,e)=>(e===void 0&&(e="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(t.querySelectorAll(e)).filter(n=>n.overlayIndex>0)),mx=(t,e,n)=>{const i=DH(t,e).filter(r=>!MH(r));return n===void 0?i[i.length-1]:i.find(r=>r.id===n)},kN=(t=!1)=>{const n=BH(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");n&&(t?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden"))},RH=async(t,e,n,i,r)=>{var a,d;if(t.presented)return;kN(!0),t.presented=!0,t.willPresent.emit(),(a=t.willPresentShorthand)===null||a===void 0||a.emit();const o=Xn(t),f=t.enterAnimation?t.enterAnimation:_i.get(e,o==="ios"?n:i);await TN(t,f,t.el,r)&&(t.didPresent.emit(),(d=t.didPresentShorthand)===null||d===void 0||d.emit()),t.el.tagName!=="ION-TOAST"&&LH(t.el),t.keyboardClose&&(document.activeElement===null||!t.el.contains(document.activeElement))&&t.el.focus()},LH=async t=>{let e=document.activeElement;if(!e)return;const n=e==null?void 0:e.shadowRoot;n&&(e=n.querySelector(pv)||e),await t.onDidDismiss(),e.focus()},zH=async(t,e,n,i,r,a,d)=>{var o,f;if(!t.presented)return!1;kN(!1),t.presented=!1;try{t.el.style.setProperty("pointer-events","none"),t.willDismiss.emit({data:e,role:n}),(o=t.willDismissShorthand)===null||o===void 0||o.emit({data:e,role:n});const g=Xn(t),_=t.leaveAnimation?t.leaveAnimation:_i.get(i,g==="ios"?r:a);n!==$y&&await TN(t,_,t.el,d),t.didDismiss.emit({data:e,role:n}),(f=t.didDismissShorthand)===null||f===void 0||f.emit({data:e,role:n}),px.delete(t),t.el.classList.add("overlay-hidden"),t.el.style.removeProperty("pointer-events"),t.el.lastFocus!==void 0&&(t.el.lastFocus=void 0)}catch(g){console.error(g)}return t.el.remove(),!0},BH=t=>t.querySelector("ion-app")||t.body,TN=async(t,e,n,i)=>{n.classList.remove("overlay-hidden");const r=t.el,a=e(r,i);(!t.animated||!_i.getBoolean("animated",!0))&&a.duration(0),t.keyboardClose&&a.beforeAddWrite(()=>{const o=n.ownerDocument.activeElement;o!=null&&o.matches("input,ion-input, ion-textarea")&&o.blur()});const d=px.get(t)||[];return px.set(t,[...d,a]),await a.play(),!0},_R=(t,e)=>{let n;const i=new Promise(r=>n=r);return FH(t,e,r=>{n(r.detail)}),i},FH=(t,e,n)=>{const i=r=>{y9(t,e,i),n(r)};g9(t,e,i)},NT="backdrop",$y="gesture",NH=()=>{let t;const e=()=>{t&&(t(),t=void 0)};return{addClickListener:(i,r)=>{e();const a=r!==void 0?document.getElementById(r):null;if(!a){gs(`A trigger element with the ID "${r}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,i);return}t=((o,f)=>{const g=()=>{f.present()};return o.addEventListener("click",g),()=>{o.removeEventListener("click",g)}})(a,i)},removeClickListener:e}};var $T=function(t,e){return $T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},$T(t,e)};function ma(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$T(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var rt=function(){return rt=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},rt.apply(this,arguments)};function or(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n}function ru(t,e,n,i){function r(a){return a instanceof n?a:new n(function(d){d(a)})}return new(n||(n=Promise))(function(a,d){function o(_){try{g(i.next(_))}catch(w){d(w)}}function f(_){try{g(i.throw(_))}catch(w){d(w)}}function g(_){_.done?a(_.value):r(_.value).then(o,f)}g((i=i.apply(t,e||[])).next())})}function ou(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,d;return d={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function o(g){return function(_){return f([g,_])}}function f(g){if(i)throw new TypeError("Generator is already executing.");for(;d&&(d=0,g[0]&&(n=0)),n;)try{if(i=1,r&&(a=g[0]&2?r.return:g[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,g[1])).done)return a;switch(r=0,a&&(g=[g[0]&2,a.value]),g[0]){case 0:case 1:a=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,r=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!a||g[1]>a[0]&&g[1]<a[3])){n.label=g[1];break}if(g[0]===6&&n.label<a[1]){n.label=a[1],a=g;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(g);break}a[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(t,n)}catch(_){g=[6,_],r=0}finally{i=a=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function ah(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,a;i<r;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return t.concat(a||Array.prototype.slice.call(e))}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const xR="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M184 112l144 144-144 144' class='ionicon-fill-none'/></svg>",$H="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z'/></svg>",wR="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm75.31 260.69a16 16 0 11-22.62 22.62L256 278.63l-52.69 52.68a16 16 0 01-22.62-22.62L233.37 256l-52.68-52.69a16 16 0 0122.62-22.62L256 233.37l52.69-52.68a16 16 0 0122.62 22.62L278.63 256z'/></svg>",SR="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M400 145.49L366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49z'/></svg>";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */let BE;const jH=()=>{if(typeof window>"u")return new Map;if(!BE){const t=window;t.Ionicons=t.Ionicons||{},BE=t.Ionicons.map=t.Ionicons.map||new Map}return BE},VH=t=>{let e=FE(t.src);return e||(e=CN(t.name,t.icon,t.mode,t.ios,t.md),e?UH(e):t.icon&&(e=FE(t.icon),e||(e=FE(t.icon[t.mode]),e))?e:null)},UH=t=>{const e=jH().get(t);return e||T7(`svg/${t}.svg`)},CN=(t,e,n,i,r)=>(n=(n&&jb(n))==="ios"?"ios":"md",i&&n==="ios"?t=jb(i):r&&n==="md"?t=jb(r):(!t&&e&&!IN(e)&&(t=e),gx(t)&&(t=jb(t))),!gx(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),FE=t=>gx(t)&&(t=t.trim(),IN(t))?t:null,IN=t=>t.length>0&&/(\/|\.)/.test(t),gx=t=>typeof t=="string",jb=t=>t.toLowerCase(),qH=(t,e=[])=>{const n={};return e.forEach(i=>{t.hasAttribute(i)&&(t.getAttribute(i)!==null&&(n[i]=t.getAttribute(i)),t.removeAttribute(i))}),n},WH=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":(document==null?void 0:document.dir.toLowerCase())==="rtl",GH=t=>{const e=document.createElement("div");e.innerHTML=t;for(let i=e.childNodes.length-1;i>=0;i--)e.childNodes[i].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[i]);const n=e.firstElementChild;if(n&&n.nodeName.toLowerCase()==="svg"){const i=n.getAttribute("class")||"";if(n.setAttribute("class",(i+" s-ion-icon").trim()),AN(n))return e.innerHTML}return""},AN=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;if(gx(n)&&n.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!AN(t.childNodes[e]))return!1}return!0},HH=t=>t.startsWith("data:image/svg+xml"),ZH=t=>t.indexOf(";utf8,")!==-1,eh=new Map,ER=new Map;let NE;const XH=(t,e)=>{let n=ER.get(t);if(!n)if(typeof fetch<"u"&&typeof document<"u")if(HH(t)&&ZH(t)){NE||(NE=new DOMParser);const r=NE.parseFromString(t,"text/html").querySelector("svg");return r&&eh.set(t,r.outerHTML),Promise.resolve()}else n=fetch(t).then(i=>{if(i.ok)return i.text().then(r=>{r&&e!==!1&&(r=GH(r)),eh.set(t,r||"")});eh.set(t,"")}),ER.set(t,n);else return eh.set(t,""),Promise.resolve();return n},KH=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}:host(.flip-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.icon-small){font-size:18px !important}:host(.icon-large){font-size:32px !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",YH=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.isVisible=!1,this.mode=JH(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=qH(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(e,n,i){if(this.lazy&&typeof window<"u"&&window.IntersectionObserver){const r=this.io=new window.IntersectionObserver(a=>{a[0].isIntersecting&&(r.disconnect(),this.io=void 0,i())},{rootMargin:n});r.observe(e)}else i()}loadIcon(){if(this.isVisible){const e=VH(this);e&&(eh.has(e)?this.svgContent=eh.get(e):XH(e,this.sanitize).then(()=>this.svgContent=eh.get(e)))}this.iconName=CN(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{iconName:e,el:n,inheritedAttributes:i}=this,r=this.mode||"md",a=this.flipRtl||e&&(e.indexOf("arrow")>-1||e.indexOf("chevron")>-1)&&this.flipRtl!==!1;return Rt(_r,Object.assign({role:"img",class:Object.assign(Object.assign({[r]:!0},QH(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":!!a&&WH(n)})},i),this.svgContent?Rt("div",{class:"icon-inner",innerHTML:this.svgContent}):Rt("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return KH}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]}]),JH=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",QH=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function eZ(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{switch(e){case"ion-icon":customElements.get(e)||customElements.define(e,YH);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const tZ=":host{border-radius:var(--border-radius);display:block}::slotted(ion-img),::slotted(img){border-radius:var(--border-radius);width:100%;height:100%;-o-object-fit:cover;object-fit:cover;overflow:hidden}:host{--border-radius:50%;width:48px;height:48px}",nZ=":host{border-radius:var(--border-radius);display:block}::slotted(ion-img),::slotted(img){border-radius:var(--border-radius);width:100%;height:100%;-o-object-fit:cover;object-fit:cover;overflow:hidden}:host{--border-radius:50%;width:64px;height:64px}",iZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow()}render(){return Rt(_r,{class:Xn(this)},Rt("slot",null))}static get style(){return{ios:tZ,md:nZ}}},[33,"ion-avatar"]);function rZ(){if(typeof customElements>"u")return;["ion-avatar"].forEach(e=>{switch(e){case"ion-avatar":customElements.get(e)||customElements.define(e,iZ);break}})}const oZ=rZ;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const sZ=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",aZ=":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",lZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionBackdropTap=Wn(this,"ionBackdropTap",7),this.blocker=I1.createBlocker({disableScroll:!0}),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}connectedCallback(){this.stopPropagation&&this.blocker.block()}disconnectedCallback(){this.blocker.unblock()}onMouseDown(e){this.emitTap(e)}emitTap(e){this.stopPropagation&&(e.preventDefault(),e.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const e=Xn(this);return Rt(_r,{tabindex:"-1","aria-hidden":"true",class:{[e]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}static get style(){return{ios:sZ,md:aZ}}},[33,"ion-backdrop",{visible:[4],tappable:[4],stopPropagation:[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]);function MN(){if(typeof customElements>"u")return;["ion-backdrop"].forEach(e=>{switch(e){case"ion-backdrop":customElements.get(e)||customElements.define(e,lZ);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Ka=(t,e)=>e.closest(t)!==null,Ml=(t,e)=>typeof t=="string"&&t.length>0?Object.assign({"ion-color":!0,[`ion-color-${t}`]:!0},e):e,cZ=t=>t!==void 0?(Array.isArray(t)?t:t.split(" ")).filter(n=>n!=null).map(n=>n.trim()).filter(n=>n!==""):[],uZ=t=>{const e={};return cZ(t).forEach(n=>e[n]=!0),e},dZ=/^[a-z][a-z0-9+\-.]*:/,M1=async(t,e,n,i)=>{if(t!=null&&t[0]!=="#"&&!dZ.test(t)){const r=document.querySelector("ion-router");if(r)return e!=null&&e.preventDefault(),r.push(t,n,i)}return!1};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const hZ=".sc-ion-buttons-ios-h{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:99}.sc-ion-buttons-ios-s ion-button{--padding-top:0;--padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.sc-ion-buttons-ios-s ion-button{--padding-start:5px;--padding-end:5px;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;height:32px}.sc-ion-buttons-ios-s ion-button:not(.button-round){--border-radius:4px}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button{--color:initial;--border-color:initial;--background-focused:var(--ion-color-contrast)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-solid,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-solid{--background:var(--ion-color-contrast);--background-focused:#000;--background-focused-opacity:.12;--background-activated:#000;--background-activated-opacity:.12;--background-hover:var(--ion-color-base);--background-hover-opacity:0.45;--color:var(--ion-color-base);--color-focused:var(--ion-color-base)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-clear,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-clear{--color-activated:var(--ion-color-contrast);--color-focused:var(--ion-color-contrast)}.sc-ion-buttons-ios-h.ion-color.sc-ion-buttons-ios-s .button-outline,.ion-color .sc-ion-buttons-ios-h.sc-ion-buttons-ios-s .button-outline{--color-activated:var(--ion-color-base);--color-focused:var(--ion-color-contrast);--background-activated:var(--ion-color-contrast)}.sc-ion-buttons-ios-s .button-clear,.sc-ion-buttons-ios-s .button-outline{--background-activated:transparent;--background-focused:currentColor;--background-hover:transparent}.sc-ion-buttons-ios-s .button-solid:not(.ion-color){--background-focused:#000;--background-focused-opacity:.12;--background-activated:#000;--background-activated-opacity:.12}.sc-ion-buttons-ios-s ion-icon[slot=start]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-end:0.3em;margin-inline-end:0.3em;font-size:24px;line-height:0.67}.sc-ion-buttons-ios-s ion-icon[slot=end]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-start:0.4em;margin-inline-start:0.4em;font-size:24px;line-height:0.67}.sc-ion-buttons-ios-s ion-icon[slot=icon-only]{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;font-size:28px;line-height:0.67}",fZ=".sc-ion-buttons-md-h{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:99}.sc-ion-buttons-md-s ion-button{--padding-top:0;--padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.sc-ion-buttons-md-s ion-button{--padding-top:0;--padding-bottom:0;--padding-start:8px;--padding-end:8px;--box-shadow:none;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;height:32px}.sc-ion-buttons-md-s ion-button:not(.button-round){--border-radius:2px}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button{--color:initial;--color-focused:var(--ion-color-contrast);--color-hover:var(--ion-color-contrast);--background-activated:transparent;--background-focused:var(--ion-color-contrast);--background-hover:var(--ion-color-contrast)}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button-solid,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button-solid{--background:var(--ion-color-contrast);--background-activated:transparent;--background-focused:var(--ion-color-shade);--background-hover:var(--ion-color-base);--color:var(--ion-color-base);--color-focused:var(--ion-color-base);--color-hover:var(--ion-color-base)}.sc-ion-buttons-md-h.ion-color.sc-ion-buttons-md-s .button-outline,.ion-color .sc-ion-buttons-md-h.sc-ion-buttons-md-s .button-outline{--border-color:var(--ion-color-contrast)}.sc-ion-buttons-md-s .button-has-icon-only.button-clear{--padding-top:12px;--padding-end:12px;--padding-bottom:12px;--padding-start:12px;--border-radius:50%;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;width:48px;height:48px}.sc-ion-buttons-md-s .button{--background-hover:currentColor}.sc-ion-buttons-md-s .button-solid{--color:var(--ion-toolbar-background, var(--ion-background-color, #fff));--background:var(--ion-toolbar-color, var(--ion-text-color, #424242));--background-activated:transparent;--background-focused:currentColor}.sc-ion-buttons-md-s .button-outline{--color:initial;--background:transparent;--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--border-color:currentColor}.sc-ion-buttons-md-s .button-clear{--color:initial;--background:transparent;--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor}.sc-ion-buttons-md-s ion-icon[slot=start]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-end:0.3em;margin-inline-end:0.3em;font-size:1.4em}.sc-ion-buttons-md-s ion-icon[slot=end]{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-margin-start:0.4em;margin-inline-start:0.4em;font-size:1.4em}.sc-ion-buttons-md-s ion-icon[slot=icon-only]{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;font-size:1.8em}",pZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.collapse=!1}render(){const e=Xn(this);return Rt(_r,{class:{[e]:!0,"buttons-collapse":this.collapse}})}static get style(){return{ios:hZ,md:fZ}}},[34,"ion-buttons",{collapse:[4]}]);function mZ(){if(typeof customElements>"u")return;["ion-buttons"].forEach(e=>{switch(e){case"ion-buttons":customElements.get(e)||customElements.define(e,pZ);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const gZ=mZ;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const yZ=t=>{const e=t;let n;return{hasLegacyControl:()=>{if(n===void 0){const r=e.label!==void 0||vZ(e),a=e.hasAttribute("aria-label")||e.hasAttribute("aria-labelledby")&&e.shadowRoot===null,d=oN(e);n=e.legacy===!0||!r&&!a&&d!==null}return n}}},vZ=t=>t.shadowRoot===null?!1:!!(bZ.includes(t.tagName)&&t.querySelector('[slot="label"]')!==null||_Z.includes(t.tagName)&&t.textContent!==""),bZ=["ION-RANGE"],_Z=["ION-TOGGLE","ION-CHECKBOX","ION-RADIO"];/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const xZ=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}",wZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.type="bounded"}async addRipple(e,n){return new Promise(i=>{fv(()=>{const r=this.el.getBoundingClientRect(),a=r.width,d=r.height,o=Math.sqrt(a*a+d*d),f=Math.max(d,a),g=this.unbounded?f:o+EZ,_=Math.floor(f*kZ),w=g/_;let T=e-r.left,A=n-r.top;this.unbounded&&(T=a*.5,A=d*.5);const D=T-_*.5,z=A-_*.5,G=a*.5-T,V=d*.5-A;Al(()=>{const N=document.createElement("div");N.classList.add("ripple-effect");const q=N.style;q.top=z+"px",q.left=D+"px",q.width=q.height=_+"px",q.setProperty("--final-scale",`${w}`),q.setProperty("--translate-end",`${G}px, ${V}px`),(this.el.shadowRoot||this.el).appendChild(N),setTimeout(()=>{i(()=>{SZ(N)})},225+100)})})})}get unbounded(){return this.type==="unbounded"}render(){const e=Xn(this);return Rt(_r,{role:"presentation",class:{[e]:!0,unbounded:this.unbounded}})}get el(){return this}static get style(){return xZ}},[1,"ion-ripple-effect",{type:[1],addRipple:[64]}]),SZ=t=>{t.classList.add("fade-out"),setTimeout(()=>{t.remove()},200)},EZ=10,kZ=.5;function TZ(){if(typeof customElements>"u")return;["ion-ripple-effect"].forEach(e=>{switch(e){case"ion-ripple-effect":customElements.get(e)||customElements.define(e,wZ);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const Vb=typeof window<"u"?window:void 0;Vb&&(Vb.CSS&&Vb.CSS.supports&&Vb.CSS.supports("--a: 0"));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const CZ=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":(document==null?void 0:document.dir.toLowerCase())==="rtl";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const IZ=':host{--background:var(--ion-background-color, #fff);--color:var(--ion-text-color, #000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0 !important;padding:0 !important;font-family:var(--ion-font-family, inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.outer-content){--background:var(--ion-color-step-50, #f2f2f2)}#background-content{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute;background:var(--background)}.inner-scroll{left:0px;right:0px;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));position:absolute;color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-ms-touch-action:pan-x pan-y pinch-zoom;touch-action:pan-x pan-y pinch-zoom}.scroll-y,.scroll-x{-webkit-overflow-scrolling:touch;z-index:0;will-change:scroll-position}.scroll-y{overflow-y:var(--overflow);overscroll-behavior-y:contain}.scroll-x{overflow-x:var(--overflow);overscroll-behavior-x:contain}.overscroll::before,.overscroll::after{position:absolute;width:1px;height:1px;content:""}.overscroll::before{bottom:-1px}.overscroll::after{top:-1px}:host(.content-sizing){display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:0;contain:none}:host(.content-sizing) .inner-scroll{position:relative;top:0;bottom:0;margin-top:calc(var(--offset-top) * -1);margin-bottom:calc(var(--offset-bottom) * -1)}.transition-effect{display:none;position:absolute;width:100%;height:100vh;opacity:0;pointer-events:none}:host(.content-ltr) .transition-effect{left:-100%;}:host(.content-rtl) .transition-effect{right:-100%;}.transition-cover{position:absolute;right:0;width:100%;height:100%;background:black;opacity:0.1}.transition-shadow{display:block;position:absolute;width:100%;height:100%;-webkit-box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03);box-shadow:inset -9px 0 9px 0 rgba(0, 0, 100, 0.03)}:host(.content-ltr) .transition-shadow{right:0;}:host(.content-rtl) .transition-shadow{left:0;-webkit-transform:scaleX(-1);transform:scaleX(-1)}::slotted([slot=fixed]){position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0)}',AZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionScrollStart=Wn(this,"ionScrollStart",7),this.ionScroll=Wn(this,"ionScroll",7),this.ionScrollEnd=Wn(this,"ionScrollEnd",7),this.watchDog=null,this.isScrolling=!1,this.lastScroll=0,this.queued=!1,this.cTop=-1,this.cBottom=-1,this.isMainContent=!0,this.resizeTimeout=null,this.detail={scrollTop:0,scrollLeft:0,type:"scroll",event:void 0,startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,data:void 0,isScrolling:!0},this.color=void 0,this.fullscreen=!1,this.forceOverscroll=void 0,this.scrollX=!1,this.scrollY=!0,this.scrollEvents=!1}connectedCallback(){this.isMainContent=this.el.closest("ion-menu, ion-popover, ion-modal")===null}disconnectedCallback(){this.onScrollEnd()}onAppLoad(){this.resize()}onResize(){this.resizeTimeout&&(clearTimeout(this.resizeTimeout),this.resizeTimeout=null),this.resizeTimeout=setTimeout(()=>{this.el.offsetParent!==null&&this.resize()},100)}shouldForceOverscroll(){const{forceOverscroll:e}=this,n=Xn(this);return e===void 0?n==="ios"&&cc("ios"):e}resize(){this.fullscreen?fv(()=>this.readDimensions()):(this.cTop!==0||this.cBottom!==0)&&(this.cTop=this.cBottom=0,dx(this))}readDimensions(){const e=PZ(this.el),n=Math.max(this.el.offsetTop,0),i=Math.max(e.offsetHeight-n-this.el.offsetHeight,0);(n!==this.cTop||i!==this.cBottom)&&(this.cTop=n,this.cBottom=i,dx(this))}onScroll(e){const n=Date.now(),i=!this.isScrolling;this.lastScroll=n,i&&this.onScrollStart(),!this.queued&&this.scrollEvents&&(this.queued=!0,fv(r=>{this.queued=!1,this.detail.event=e,OZ(this.detail,this.scrollEl,r,i),this.ionScroll.emit(this.detail)}))}async getScrollElement(){return this.scrollEl||await new Promise(e=>Sh(this.el,e)),Promise.resolve(this.scrollEl)}async getBackgroundElement(){return this.backgroundContentEl||await new Promise(e=>Sh(this.el,e)),Promise.resolve(this.backgroundContentEl)}scrollToTop(e=0){return this.scrollToPoint(void 0,0,e)}async scrollToBottom(e=0){const n=await this.getScrollElement(),i=n.scrollHeight-n.clientHeight;return this.scrollToPoint(void 0,i,e)}async scrollByPoint(e,n,i){const r=await this.getScrollElement();return this.scrollToPoint(e+r.scrollLeft,n+r.scrollTop,i)}async scrollToPoint(e,n,i=0){const r=await this.getScrollElement();if(i<32){n!=null&&(r.scrollTop=n),e!=null&&(r.scrollLeft=e);return}let a,d=0;const o=new Promise(A=>a=A),f=r.scrollTop,g=r.scrollLeft,_=n!=null?n-f:0,w=e!=null?e-g:0,T=A=>{const D=Math.min(1,(A-d)/i)-1,z=Math.pow(D,3)+1;_!==0&&(r.scrollTop=Math.floor(z*_+f)),w!==0&&(r.scrollLeft=Math.floor(z*w+g)),z<1?requestAnimationFrame(T):a()};return requestAnimationFrame(A=>{d=A,T(A)}),o}onScrollStart(){this.isScrolling=!0,this.ionScrollStart.emit({isScrolling:!0}),this.watchDog&&clearInterval(this.watchDog),this.watchDog=setInterval(()=>{this.lastScroll<Date.now()-120&&this.onScrollEnd()},100)}onScrollEnd(){this.watchDog&&clearInterval(this.watchDog),this.watchDog=null,this.isScrolling&&(this.isScrolling=!1,this.ionScrollEnd.emit({isScrolling:!1}))}render(){const{isMainContent:e,scrollX:n,scrollY:i,el:r}=this,a=CZ(r)?"rtl":"ltr",d=Xn(this),o=this.shouldForceOverscroll(),f=d==="ios",g=e?"main":"div";return this.resize(),Rt(_r,{class:Ml(this.color,{[d]:!0,"content-sizing":Ka("ion-popover",this.el),overscroll:o,[`content-${a}`]:!0}),style:{"--offset-top":`${this.cTop}px`,"--offset-bottom":`${this.cBottom}px`}},Rt("div",{ref:_=>this.backgroundContentEl=_,id:"background-content",part:"background"}),Rt(g,{class:{"inner-scroll":!0,"scroll-x":n,"scroll-y":i,overscroll:(n||i)&&o},ref:_=>this.scrollEl=_,onScroll:this.scrollEvents?_=>this.onScroll(_):void 0,part:"scroll"},Rt("slot",null)),f?Rt("div",{class:"transition-effect"},Rt("div",{class:"transition-cover"}),Rt("div",{class:"transition-shadow"})):null,Rt("slot",{name:"fixed"}))}get el(){return this}static get style(){return IZ}},[1,"ion-content",{color:[513],fullscreen:[4],forceOverscroll:[1028,"force-overscroll"],scrollX:[4,"scroll-x"],scrollY:[4,"scroll-y"],scrollEvents:[4,"scroll-events"],getScrollElement:[64],getBackgroundElement:[64],scrollToTop:[64],scrollToBottom:[64],scrollByPoint:[64],scrollToPoint:[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]]),MZ=t=>{var e;return t.parentElement?t.parentElement:!((e=t.parentNode)===null||e===void 0)&&e.host?t.parentNode.host:null},PZ=t=>{const e=t.closest("ion-tabs");if(e)return e;const n=t.closest("ion-app, ion-page, .ion-page, page-inner, .popover-content");return n||MZ(t)},OZ=(t,e,n,i)=>{const r=t.currentX,a=t.currentY,d=t.currentTime,o=e.scrollLeft,f=e.scrollTop,g=n-d;if(i&&(t.startTime=n,t.startX=o,t.startY=f,t.velocityX=t.velocityY=0),t.currentTime=n,t.currentX=t.scrollLeft=o,t.currentY=t.scrollTop=f,t.deltaX=o-t.startX,t.deltaY=f-t.startY,g>0&&g<100){const _=(o-r)/g,w=(f-a)/g;t.velocityX=_*.7+t.velocityX*.3,t.velocityY=w*.7+t.velocityY*.3}};function DZ(){if(typeof customElements>"u")return;["ion-content"].forEach(e=>{switch(e){case"ion-content":customElements.get(e)||customElements.define(e,AZ);break}})}const RZ=DZ;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const LZ=':host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:14px;--padding-top:0;--padding-bottom:0;--padding-start:1em;--padding-end:1em;--transition:background-color, opacity 100ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:3.1em;font-size:16px;font-weight:500;letter-spacing:0}:host(.in-buttons){font-size:17px;font-weight:400}:host(.button-solid){--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1}:host(.button-outline){--border-radius:14px;--border-width:1px;--border-style:solid;--background-activated:var(--ion-color-primary, #3880ff);--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;--color-activated:var(--ion-color-primary-contrast, #fff)}:host(.button-clear){--background-activated:transparent;--background-activated-opacity:0;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:transparent;--background-focused-opacity:.1;font-size:17px;font-weight:normal}:host(.button-large){--border-radius:16px;--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:3.1em;font-size:20px}:host(.button-small){--border-radius:6px;--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-strong){font-weight:600}:host(.button-outline.ion-focused.ion-color) .button-native,:host(.button-clear.ion-focused.ion-color) .button-native{color:var(--ion-color-base)}:host(.button-outline.ion-focused.ion-color) .button-native::after,:host(.button-clear.ion-focused.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.button-clear:not(.ion-activated):hover),:host(.button-outline:not(.ion-activated):hover){opacity:0.6}:host(.button-clear.ion-color:hover) .button-native,:host(.button-outline.ion-color:hover) .button-native{color:var(--ion-color-base)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:transparent}:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}:host(:hover.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color):not(.ion-activated)) .button-native::after{background:#fff;opacity:0.1}}:host(.button-clear.ion-activated){opacity:0.4}:host(.button-outline.ion-activated.ion-color) .button-native{color:var(--ion-color-contrast)}:host(.button-outline.ion-activated.ion-color) .button-native::after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}',zZ=`:host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:0.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary, #3880ff);--color:var(--ion-color-primary-contrast, #fff)}:host(.button-outline){--border-color:var(--ion-color-primary, #3880ff);--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-clear){--border-width:0;--background:transparent;--color:var(--ion-color-primary, #3880ff)}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native::after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){-webkit-margin-start:-0.3em;margin-inline-start:-0.3em;-webkit-margin-end:0.3em;margin-inline-end:0.3em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=end]){-webkit-margin-start:0.3em;margin-inline-start:0.3em;-webkit-margin-end:-0.2em;margin-inline-end:-0.2em;margin-top:0;margin-bottom:0}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base);background:transparent;color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color, var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color, var(--color, var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--background));color:var(--ion-toolbar-background, var(--color))}:host(.button-outline.ion-activated.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color, var(--color));color:var(--ion-toolbar-background, var(--background), var(--ion-color-primary-contrast, #fff))}:host{--border-radius:4px;--padding-top:0;--padding-bottom:0;--padding-start:1.1em;--padding-end:1.1em;--transition:box-shadow 280ms cubic-bezier(.4, 0, .2, 1),
                background-color 15ms linear,
                color 15ms linear;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px;margin-top:4px;margin-bottom:4px;height:36px;font-size:14px;font-weight:500;letter-spacing:0.06em;text-transform:uppercase}:host(.button-solid){--background-activated:transparent;--background-hover:var(--ion-color-primary-contrast, #fff);--background-focused:var(--ion-color-primary-contrast, #fff);--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}:host(.button-solid.ion-activated){--box-shadow:0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12)}:host(.button-outline){--border-width:2px;--border-style:solid;--box-shadow:none;--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-outline.ion-activated.ion-color) .button-native{background:transparent}:host(.button-clear){--background-activated:transparent;--background-focused:var(--ion-color-primary, #3880ff);--background-hover:var(--ion-color-primary, #3880ff);--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-large){--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:2.8em;font-size:20px}:host(.button-small){--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-strong){font-weight:bold}::slotted(ion-icon[slot=icon-only]){padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}:host(.button-solid.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color.ion-focused) .button-native::after,:host(.button-outline.ion-color.ion-focused) .button-native::after{background:var(--ion-color-base)}@media (any-hover: hover){:host(.button-solid.ion-color:hover) .button-native::after{background:var(--ion-color-contrast)}:host(.button-clear.ion-color:hover) .button-native::after,:host(.button-outline.ion-color:hover) .button-native::after{background:var(--ion-color-base)}}`,BZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionFocus=Wn(this,"ionFocus",7),this.ionBlur=Wn(this,"ionBlur",7),this.inItem=!1,this.inListHeader=!1,this.inToolbar=!1,this.inheritedAttributes={},this.handleClick=e=>{const{el:n}=this;if(this.type==="button")M1(this.href,e,this.routerDirection,this.routerAnimation);else if(v9(n)){let i=this.findForm();const{form:r}=this;if(!i&&r!==void 0){gs(typeof r=="string"?`Form with selector: "#${r}" could not be found. Verify that the id is correct and the form is rendered in the DOM.`:'The provided "form" element is invalid. Verify that the form is a HTMLFormElement and rendered in the DOM.',n);return}if(i||(i=n.closest("form")),i){e.preventDefault();const a=document.createElement("button");a.type=this.type,a.style.display="none",i.appendChild(a),a.click(),a.remove()}}},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.color=void 0,this.buttonType="button",this.disabled=!1,this.expand=void 0,this.fill=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.download=void 0,this.href=void 0,this.rel=void 0,this.shape=void 0,this.size=void 0,this.strong=!1,this.target=void 0,this.type="button",this.form=void 0}componentWillLoad(){this.inToolbar=!!this.el.closest("ion-buttons"),this.inListHeader=!!this.el.closest("ion-list-header"),this.inItem=!!this.el.closest("ion-item")||!!this.el.closest("ion-item-divider"),this.inheritedAttributes=jv(this.el)}get hasIconOnly(){return!!this.el.querySelector('[slot="icon-only"]')}get rippleType(){return(this.fill===void 0||this.fill==="clear")&&this.hasIconOnly&&this.inToolbar?"unbounded":"bounded"}findForm(){const{form:e}=this;if(e instanceof HTMLFormElement)return e;if(typeof e=="string"){const n=document.getElementById(e);if(n instanceof HTMLFormElement)return n}return null}render(){const e=Xn(this),{buttonType:n,type:i,disabled:r,rel:a,target:d,size:o,href:f,color:g,expand:_,hasIconOnly:w,shape:T,strong:A,inheritedAttributes:D}=this,z=o===void 0&&this.inItem?"small":o,G=f===void 0?"button":"a",V=G==="button"?{type:i}:{download:this.download,href:f,rel:a,target:d};let N=this.fill;return N==null&&(N=this.inToolbar||this.inListHeader?"clear":"solid"),Rt(_r,{onClick:this.handleClick,"aria-disabled":r?"true":null,class:Ml(g,{[e]:!0,[n]:!0,[`${n}-${_}`]:_!==void 0,[`${n}-${z}`]:z!==void 0,[`${n}-${T}`]:T!==void 0,[`${n}-${N}`]:!0,[`${n}-strong`]:A,"in-toolbar":Ka("ion-toolbar",this.el),"in-toolbar-color":Ka("ion-toolbar[color]",this.el),"in-buttons":Ka("ion-buttons",this.el),"button-has-icon-only":w,"button-disabled":r,"ion-activatable":!0,"ion-focusable":!0})},Rt(G,Object.assign({},V,{class:"button-native",part:"native",disabled:r,onFocus:this.onFocus,onBlur:this.onBlur},D),Rt("span",{class:"button-inner"},Rt("slot",{name:"icon-only"}),Rt("slot",{name:"start"}),Rt("slot",null),Rt("slot",{name:"end"})),e==="md"&&Rt("ion-ripple-effect",{type:this.rippleType})))}get el(){return this}static get style(){return{ios:LZ,md:zZ}}},[33,"ion-button",{color:[513],buttonType:[1025,"button-type"],disabled:[516],expand:[513],fill:[1537],routerDirection:[1,"router-direction"],routerAnimation:[16],download:[1],href:[1],rel:[1],shape:[513],size:[513],strong:[4],target:[1],type:[1],form:[1]}]);/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const FZ=':host{--border-radius:0px;--border-width:0px;--border-style:solid;--padding-top:0px;--padding-bottom:0px;--padding-end:0px;--padding-start:0px;--inner-border-width:0px;--inner-padding-top:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;--inner-padding-end:0px;--inner-box-shadow:none;--show-full-highlight:0;--show-inset-highlight:0;--detail-icon-color:initial;--detail-icon-font-size:20px;--detail-icon-opacity:0.25;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:initial;text-decoration:none;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native,:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-inner{border-color:var(--ion-color-shade)}:host(.ion-activated) .item-native{color:var(--color-activated)}:host(.ion-activated) .item-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-color.ion-activated) .item-native{color:var(--ion-color-contrast)}:host(.ion-focused) .item-native{color:var(--color-focused)}:host(.ion-focused) .item-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-color.ion-focused) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .item-native::after{background:var(--ion-color-contrast)}@media (any-hover: hover){:host(.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--color-hover)}:host(.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--ion-color-contrast)}}:host(.item-interactive-disabled:not(.item-multiple-inputs)){cursor:default;pointer-events:none}:host(.item-disabled){cursor:default;opacity:0.3;pointer-events:none}.item-native{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.item-native::-moz-focus-inner{border:0}.item-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0;-webkit-transition:var(--transition);transition:var(--transition);z-index:-1}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}.item-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);-webkit-box-shadow:var(--inner-box-shadow);box-shadow:var(--inner-box-shadow);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.item-bottom{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--inner-padding-end);padding-inline-end:var(--inner-padding-end);padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.item-detail-icon{-webkit-margin-start:calc(var(--inner-padding-end) / 2);margin-inline-start:calc(var(--inner-padding-end) / 2);-webkit-margin-end:-6px;margin-inline-end:-6px;color:var(--detail-icon-color);font-size:var(--detail-icon-font-size);opacity:var(--detail-icon-opacity)}::slotted(ion-icon){font-size:1.6em}::slotted(ion-button){--margin-top:0;--margin-bottom:0;--margin-start:0;--margin-end:0;z-index:1}::slotted(ion-label:not([slot=end])){-ms-flex:1;flex:1}:host(.item-input){-ms-flex-align:center;align-items:center}.input-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.item-label-stacked),:host(.item-label-floating){-ms-flex-align:start;align-items:start}:host(.item-label-stacked) .input-wrapper,:host(.item-label-floating) .input-wrapper{-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column}.item-highlight,.item-inner-highlight{left:0;right:0;top:0;bottom:0;border-radius:inherit;position:absolute;width:100%;height:100%;-webkit-transform:scaleX(0);transform:scaleX(0);-webkit-transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:transform 200ms, border-bottom-width 200ms;transition:transform 200ms, border-bottom-width 200ms, -webkit-transform 200ms;z-index:2;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus),:host(.item-interactive.ion-touched.ion-invalid){--full-highlight-height:calc(var(--highlight-height) * var(--show-full-highlight));--inset-highlight-height:calc(var(--highlight-height) * var(--show-inset-highlight))}:host(.ion-focused) .item-highlight,:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-highlight,:host(.item-has-focus) .item-inner-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-style:var(--border-style);border-color:var(--highlight-background)}:host(.ion-focused) .item-highlight,:host(.item-has-focus) .item-highlight{border-width:var(--full-highlight-height);opacity:var(--show-full-highlight)}:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-inner-highlight{border-bottom-width:var(--inset-highlight-height);opacity:var(--show-inset-highlight)}:host(.ion-focused.item-fill-solid) .item-highlight,:host(.item-has-focus.item-fill-solid) .item-highlight{border-width:calc(var(--full-highlight-height) - 1px)}:host(.ion-focused) .item-inner-highlight,:host(.ion-focused:not(.item-fill-outline)) .item-highlight,:host(.item-has-focus) .item-inner-highlight,:host(.item-has-focus:not(.item-fill-outline)) .item-highlight{border-top:none;border-right:none;border-left:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus){--highlight-background:var(--highlight-color-focused)}:host(.item-interactive.ion-valid){--highlight-background:var(--highlight-color-valid)}:host(.item-interactive.ion-invalid){--highlight-background:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=helper]){display:none}::slotted([slot=error]){display:none;color:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=error]){display:block}:host(:not(.item-label)) ::slotted(ion-select.legacy-select){--padding-start:0;max-width:none}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0;-ms-flex-item-align:stretch;align-self:stretch;width:100%;max-width:100%}:host(:not(.item-label)) ::slotted(ion-datetime){--padding-start:0}:host(.item-label-stacked) ::slotted(ion-datetime),:host(.item-label-floating) ::slotted(ion-datetime){--padding-start:0;width:100%}:host(.item-multiple-inputs) ::slotted(ion-checkbox),:host(.item-multiple-inputs) ::slotted(ion-datetime),:host(.item-multiple-inputs) ::slotted(ion-radio),:host(.item-multiple-inputs) ::slotted(ion-select.legacy-select){position:relative}:host(.item-textarea){-ms-flex-align:stretch;align-items:stretch}::slotted(ion-reorder[slot]){margin-top:0;margin-bottom:0}ion-ripple-effect{color:var(--ripple-color)}:host(.item-fill-solid) ::slotted([slot=start]),:host(.item-fill-solid) ::slotted([slot=end]),:host(.item-fill-outline) ::slotted([slot=start]),:host(.item-fill-outline) ::slotted([slot=end]){-ms-flex-item-align:center;align-self:center}::slotted([slot=helper]),::slotted([slot=error]),.item-counter{padding-top:5px;font-size:12px;z-index:1}.item-counter{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}@media (prefers-reduced-motion: reduce){.item-highlight,.item-inner-highlight{-webkit-transition:none;transition:none}}:host{--min-height:44px;--transition:background-color 200ms linear, opacity 200ms linear;--padding-start:16px;--inner-padding-end:16px;--inner-border-width:0px 0px 0.55px 0px;--background:var(--ion-item-background, var(--ion-background-color, #fff));--background-activated:var(--ion-text-color, #000);--background-focused:var(--ion-text-color, #000);--background-hover:currentColor;--background-activated-opacity:.12;--background-focused-opacity:.15;--background-hover-opacity:.04;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));--color:var(--ion-item-color, var(--ion-text-color, #000));--highlight-height:0px;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);--bottom-padding-start:0px;font-size:16px}:host(.ion-activated){--transition:none}:host(.ion-color.ion-focused) .item-native::after{background:#000;opacity:0.15}:host(.ion-color.ion-activated) .item-native::after{background:#000;opacity:0.12}:host(.item-interactive){--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-full){--border-width:0px 0px 0.55px 0px;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-inset){--inner-border-width:0px 0px 0.55px 0px;--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-inset),:host(.item-lines-none){--border-width:0px;--show-full-highlight:0}:host(.item-lines-full),:host(.item-lines-none){--inner-border-width:0px;--show-inset-highlight:0}.item-highlight,.item-inner-highlight{-webkit-transition:none;transition:none}:host(.item-has-focus) .item-inner-highlight,:host(.item-has-focus) .item-highlight{border-top:none;border-right:none;border-left:none}::slotted([slot=start]){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:2px;margin-bottom:2px}::slotted(ion-icon[slot=start]),::slotted(ion-icon[slot=end]){margin-top:7px;margin-bottom:7px}::slotted(ion-toggle[slot=start]),::slotted(ion-toggle[slot=end]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}:host(.item-label-stacked) ::slotted([slot=end]),:host(.item-label-floating) ::slotted([slot=end]){margin-top:7px;margin-bottom:7px}::slotted(.button-small){--padding-top:0px;--padding-bottom:0px;--padding-start:.5em;--padding-end:.5em;height:24px;font-size:13px}::slotted(ion-avatar){width:36px;height:36px}::slotted(ion-thumbnail){--size:56px}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px;margin-bottom:8px}:host(.item-radio) ::slotted(ion-label),:host(.item-toggle) ::slotted(ion-label){-webkit-margin-start:0px;margin-inline-start:0px}::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:10px;margin-bottom:10px}:host(.item-label-floating),:host(.item-label-stacked){--min-height:68px}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0px}:host(.item-label-fixed) ::slotted(ion-select.legacy-select),:host(.item-label-fixed) ::slotted(ion-datetime){--padding-start:0}',NZ=':host{--border-radius:0px;--border-width:0px;--border-style:solid;--padding-top:0px;--padding-bottom:0px;--padding-end:0px;--padding-start:0px;--inner-border-width:0px;--inner-padding-top:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;--inner-padding-end:0px;--inner-box-shadow:none;--show-full-highlight:0;--show-inset-highlight:0;--detail-icon-color:initial;--detail-icon-font-size:20px;--detail-icon-opacity:0.25;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);text-align:initial;text-decoration:none;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-native,:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) .item-inner{border-color:var(--ion-color-shade)}:host(.ion-activated) .item-native{color:var(--color-activated)}:host(.ion-activated) .item-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-color.ion-activated) .item-native{color:var(--ion-color-contrast)}:host(.ion-focused) .item-native{color:var(--color-focused)}:host(.ion-focused) .item-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-color.ion-focused) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .item-native::after{background:var(--ion-color-contrast)}@media (any-hover: hover){:host(.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--color-hover)}:host(.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activatable:not(.ion-focused):hover) .item-native::after{background:var(--ion-color-contrast)}}:host(.item-interactive-disabled:not(.item-multiple-inputs)){cursor:default;pointer-events:none}:host(.item-disabled){cursor:default;opacity:0.3;pointer-events:none}.item-native{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.item-native::-moz-focus-inner{border:0}.item-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0;-webkit-transition:var(--transition);transition:var(--transition);z-index:-1}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}.item-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);-webkit-box-shadow:var(--inner-box-shadow);box-shadow:var(--inner-box-shadow);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.item-bottom{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--inner-padding-end);padding-inline-end:var(--inner-padding-end);padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.item-detail-icon{-webkit-margin-start:calc(var(--inner-padding-end) / 2);margin-inline-start:calc(var(--inner-padding-end) / 2);-webkit-margin-end:-6px;margin-inline-end:-6px;color:var(--detail-icon-color);font-size:var(--detail-icon-font-size);opacity:var(--detail-icon-opacity)}::slotted(ion-icon){font-size:1.6em}::slotted(ion-button){--margin-top:0;--margin-bottom:0;--margin-start:0;--margin-end:0;z-index:1}::slotted(ion-label:not([slot=end])){-ms-flex:1;flex:1}:host(.item-input){-ms-flex-align:center;align-items:center}.input-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.item-label-stacked),:host(.item-label-floating){-ms-flex-align:start;align-items:start}:host(.item-label-stacked) .input-wrapper,:host(.item-label-floating) .input-wrapper{-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column}.item-highlight,.item-inner-highlight{left:0;right:0;top:0;bottom:0;border-radius:inherit;position:absolute;width:100%;height:100%;-webkit-transform:scaleX(0);transform:scaleX(0);-webkit-transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:border-bottom-width 200ms, -webkit-transform 200ms;transition:transform 200ms, border-bottom-width 200ms;transition:transform 200ms, border-bottom-width 200ms, -webkit-transform 200ms;z-index:2;-webkit-box-sizing:border-box;box-sizing:border-box;pointer-events:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus),:host(.item-interactive.ion-touched.ion-invalid){--full-highlight-height:calc(var(--highlight-height) * var(--show-full-highlight));--inset-highlight-height:calc(var(--highlight-height) * var(--show-inset-highlight))}:host(.ion-focused) .item-highlight,:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-highlight,:host(.item-has-focus) .item-inner-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-style:var(--border-style);border-color:var(--highlight-background)}:host(.ion-focused) .item-highlight,:host(.item-has-focus) .item-highlight{border-width:var(--full-highlight-height);opacity:var(--show-full-highlight)}:host(.ion-focused) .item-inner-highlight,:host(.item-has-focus) .item-inner-highlight{border-bottom-width:var(--inset-highlight-height);opacity:var(--show-inset-highlight)}:host(.ion-focused.item-fill-solid) .item-highlight,:host(.item-has-focus.item-fill-solid) .item-highlight{border-width:calc(var(--full-highlight-height) - 1px)}:host(.ion-focused) .item-inner-highlight,:host(.ion-focused:not(.item-fill-outline)) .item-highlight,:host(.item-has-focus) .item-inner-highlight,:host(.item-has-focus:not(.item-fill-outline)) .item-highlight{border-top:none;border-right:none;border-left:none}:host(.item-interactive.ion-focused),:host(.item-interactive.item-has-focus){--highlight-background:var(--highlight-color-focused)}:host(.item-interactive.ion-valid){--highlight-background:var(--highlight-color-valid)}:host(.item-interactive.ion-invalid){--highlight-background:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=helper]){display:none}::slotted([slot=error]){display:none;color:var(--highlight-color-invalid)}:host(.item-interactive.ion-invalid) ::slotted([slot=error]){display:block}:host(:not(.item-label)) ::slotted(ion-select.legacy-select){--padding-start:0;max-width:none}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0;-ms-flex-item-align:stretch;align-self:stretch;width:100%;max-width:100%}:host(:not(.item-label)) ::slotted(ion-datetime){--padding-start:0}:host(.item-label-stacked) ::slotted(ion-datetime),:host(.item-label-floating) ::slotted(ion-datetime){--padding-start:0;width:100%}:host(.item-multiple-inputs) ::slotted(ion-checkbox),:host(.item-multiple-inputs) ::slotted(ion-datetime),:host(.item-multiple-inputs) ::slotted(ion-radio),:host(.item-multiple-inputs) ::slotted(ion-select.legacy-select){position:relative}:host(.item-textarea){-ms-flex-align:stretch;align-items:stretch}::slotted(ion-reorder[slot]){margin-top:0;margin-bottom:0}ion-ripple-effect{color:var(--ripple-color)}:host(.item-fill-solid) ::slotted([slot=start]),:host(.item-fill-solid) ::slotted([slot=end]),:host(.item-fill-outline) ::slotted([slot=start]),:host(.item-fill-outline) ::slotted([slot=end]){-ms-flex-item-align:center;align-self:center}::slotted([slot=helper]),::slotted([slot=error]),.item-counter{padding-top:5px;font-size:12px;z-index:1}.item-counter{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}@media (prefers-reduced-motion: reduce){.item-highlight,.item-inner-highlight{-webkit-transition:none;transition:none}}:host{--min-height:48px;--background:var(--ion-item-background, var(--ion-background-color, #fff));--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--background-activated-opacity:0;--background-focused-opacity:.12;--background-hover-opacity:.04;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));--color:var(--ion-item-color, var(--ion-text-color, #000));--transition:opacity 15ms linear, background-color 15ms linear;--padding-start:16px;--inner-padding-end:16px;--inner-border-width:0 0 1px 0;--highlight-height:1px;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);font-size:16px;font-weight:normal;text-transform:none}:host(.item-fill-outline){--highlight-height:2px}:host(.item-fill-none.item-interactive.ion-focus) .item-highlight,:host(.item-fill-none.item-interactive.item-has-focus) .item-highlight,:host(.item-fill-none.item-interactive.ion-touched.ion-invalid) .item-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-width:0 0 var(--full-highlight-height) 0;border-style:var(--border-style);border-color:var(--highlight-background)}:host(.item-fill-none.item-interactive.ion-focus) .item-native,:host(.item-fill-none.item-interactive.item-has-focus) .item-native,:host(.item-fill-none.item-interactive.ion-touched.ion-invalid) .item-native{border-bottom-color:var(--highlight-background)}:host(.item-fill-outline.item-interactive.ion-focus) .item-highlight,:host(.item-fill-outline.item-interactive.item-has-focus) .item-highlight{-webkit-transform:scaleX(1);transform:scaleX(1)}:host(.item-fill-outline.item-interactive.ion-focus) .item-highlight,:host(.item-fill-outline.item-interactive.item-has-focus) .item-highlight,:host(.item-fill-outline.item-interactive.ion-touched.ion-invalid) .item-highlight{border-width:var(--full-highlight-height);border-style:var(--border-style);border-color:var(--highlight-background)}:host(.item-fill-outline.item-interactive.ion-touched.ion-invalid) .item-native{border-color:var(--highlight-background)}:host(.item-fill-solid.item-interactive.ion-focus) .item-highlight,:host(.item-fill-solid.item-interactive.item-has-focus) .item-highlight,:host(.item-fill-solid.item-interactive.ion-touched.ion-invalid) .item-highlight{-webkit-transform:scaleX(1);transform:scaleX(1);border-width:0 0 var(--full-highlight-height) 0;border-style:var(--border-style);border-color:var(--highlight-background)}:host(.item-fill-solid.item-interactive.ion-focus) .item-native,:host(.item-fill-solid.item-interactive.item-has-focus) .item-native,:host(.item-fill-solid.item-interactive.ion-touched.ion-invalid) .item-native{border-bottom-color:var(--highlight-background)}:host(.ion-color.ion-activated) .item-native::after{background:transparent}:host(.item-has-focus) .item-native{caret-color:var(--highlight-background)}:host(.item-interactive){--border-width:0 0 1px 0;--inner-border-width:0;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-full){--border-width:0 0 1px 0;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-inset){--inner-border-width:0 0 1px 0;--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-inset),:host(.item-lines-none){--border-width:0;--show-full-highlight:0}:host(.item-lines-full),:host(.item-lines-none){--inner-border-width:0;--show-inset-highlight:0}:host(.item-fill-outline) .item-highlight{--position-offset:calc(-1 * var(--border-width));top:var(--position-offset);width:calc(100% + 2 * var(--border-width));height:calc(100% + 2 * var(--border-width));-webkit-transition:none;transition:none}@supports (inset-inline-start: 0){:host(.item-fill-outline) .item-highlight{inset-inline-start:var(--position-offset)}}@supports not (inset-inline-start: 0){:host(.item-fill-outline) .item-highlight{left:var(--position-offset)}:host-context([dir=rtl]):host(.item-fill-outline) .item-highlight,:host-context([dir=rtl]).item-fill-outline .item-highlight{left:unset;right:unset;right:var(--position-offset)}@supports selector(:dir(rtl)){:host(.item-fill-outline) .item-highlight:dir(rtl){left:unset;right:unset;right:var(--position-offset)}}}:host(.item-fill-outline.ion-focused) .item-native,:host(.item-fill-outline.item-has-focus) .item-native{border-color:transparent}:host(.item-multi-line) ::slotted([slot=start]),:host(.item-multi-line) ::slotted([slot=end]){margin-top:16px;margin-bottom:16px;-ms-flex-item-align:start;align-self:flex-start}::slotted([slot=start]){-webkit-margin-end:32px;margin-inline-end:32px}::slotted([slot=end]){-webkit-margin-start:32px;margin-inline-start:32px}:host(.item-fill-solid) ::slotted([slot=start]),:host(.item-fill-solid) ::slotted([slot=end]),:host(.item-fill-outline) ::slotted([slot=start]),:host(.item-fill-outline) ::slotted([slot=end]){-ms-flex-item-align:center;align-self:center}::slotted(ion-icon){color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);font-size:24px}:host(.ion-color:not(.item-fill-solid):not(.item-fill-outline)) ::slotted(ion-icon){color:var(--ion-color-contrast)}::slotted(ion-icon[slot]){margin-top:12px;margin-bottom:12px}::slotted(ion-icon[slot=start]){-webkit-margin-end:32px;margin-inline-end:32px}::slotted(ion-icon[slot=end]){-webkit-margin-start:16px;margin-inline-start:16px}:host(.item-fill-solid) ::slotted(ion-icon[slot=start]),:host(.item-fill-outline) ::slotted(ion-icon[slot=start]){-webkit-margin-end:8px;margin-inline-end:8px}::slotted(ion-toggle[slot=start]),::slotted(ion-toggle[slot=end]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}::slotted(ion-note){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-ms-flex-item-align:start;align-self:flex-start;font-size:11px}::slotted(ion-note[slot]:not([slot=helper]):not([slot=error])){padding-left:0;padding-right:0;padding-top:18px;padding-bottom:10px}::slotted(ion-note[slot=start]){-webkit-padding-end:16px;padding-inline-end:16px}::slotted(ion-note[slot=end]){-webkit-padding-start:16px;padding-inline-start:16px}::slotted(ion-avatar){width:40px;height:40px}::slotted(ion-thumbnail){--size:56px}::slotted(ion-avatar),::slotted(ion-thumbnail){margin-top:8px;margin-bottom:8px}::slotted(ion-avatar[slot=start]),::slotted(ion-thumbnail[slot=start]){-webkit-margin-end:16px;margin-inline-end:16px}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){-webkit-margin-start:16px;margin-inline-start:16px}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:10px;margin-bottom:10px}:host(.item-label-stacked) ::slotted([slot=end]),:host(.item-label-floating) ::slotted([slot=end]){margin-top:7px;margin-bottom:7px}:host(.item-label-fixed) ::slotted(ion-select.legacy-select),:host(.item-label-fixed) ::slotted(ion-datetime){--padding-start:8px}:host(.item-toggle) ::slotted(ion-label),:host(.item-radio) ::slotted(ion-label){-webkit-margin-start:0;margin-inline-start:0}::slotted(.button-small){--padding-top:0;--padding-bottom:0;--padding-start:.6em;--padding-end:.6em;height:25px;font-size:12px}:host(.item-label-floating),:host(.item-label-stacked){--min-height:55px}:host(.item-label-stacked) ::slotted(ion-select.legacy-select),:host(.item-label-floating) ::slotted(ion-select.legacy-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0}:host(.ion-focused:not(.ion-color)) ::slotted(.label-stacked),:host(.ion-focused:not(.ion-color)) ::slotted(.label-floating),:host(.item-has-focus:not(.ion-color)) ::slotted(.label-stacked),:host(.item-has-focus:not(.ion-color)) ::slotted(.label-floating){color:var(--ion-color-primary, #3880ff)}:host(.ion-color){--highlight-color-focused:var(--ion-color-contrast)}:host(.item-label-color){--highlight-color-focused:var(--ion-color-base)}:host(.item-fill-solid.ion-color),:host(.item-fill-outline.ion-color){--highlight-color-focused:var(--ion-color-base)}:host(.item-fill-solid){--background:var(--ion-color-step-50, #f2f2f2);--background-hover:var(--ion-color-step-100, #e6e6e6);--background-focused:var(--ion-color-step-150, #d9d9d9);--border-width:0 0 1px 0;--inner-border-width:0;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.item-fill-solid),:host-context([dir=rtl]).item-fill-solid{border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.item-fill-solid):dir(rtl){border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}}:host(.item-fill-solid) .item-native{--border-color:var(--ion-color-step-500, gray)}:host(.item-fill-solid.ion-focused) .item-native,:host(.item-fill-solid.item-has-focus) .item-native{--background:var(--background-focused)}:host(.item-fill-solid.item-shape-round){border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.item-fill-solid.item-shape-round),:host-context([dir=rtl]).item-fill-solid.item-shape-round{border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.item-fill-solid.item-shape-round):dir(rtl){border-top-left-radius:16px;border-top-right-radius:16px;border-bottom-right-radius:0;border-bottom-left-radius:0}}@media (any-hover: hover){:host(.item-fill-solid:hover) .item-native{--background:var(--background-hover);--border-color:var(--ion-color-step-750, #404040)}}:host(.item-fill-outline){--ripple-color:transparent;--background-focused:transparent;--background-hover:transparent;--border-color:var(--ion-color-step-500, gray);--border-width:1px;border:none;overflow:visible}:host(.item-fill-outline) .item-native{--native-padding-left:16px;border-radius:4px}:host(.item-fill-outline.item-shape-round) .item-native{--inner-padding-start:16px;border-radius:28px}:host(.item-fill-outline.item-shape-round) .item-bottom{-webkit-padding-start:32px;padding-inline-start:32px}:host(.item-fill-outline.item-label-floating.ion-focused) .item-native ::slotted(ion-input:not(:first-child)),:host(.item-fill-outline.item-label-floating.ion-focused) .item-native ::slotted(ion-textarea:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-focus) .item-native ::slotted(ion-input:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-focus) .item-native ::slotted(ion-textarea:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-value) .item-native ::slotted(ion-input:not(:first-child)),:host(.item-fill-outline.item-label-floating.item-has-value) .item-native ::slotted(ion-textarea:not(:first-child)){-webkit-transform:translateY(-14px);transform:translateY(-14px)}@media (any-hover: hover){:host(.item-fill-outline:hover) .item-native{--border-color:var(--ion-color-step-750, #404040)}}.item-counter{letter-spacing:0.0333333333em}',$Z=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.labelColorStyles={},this.itemStyles=new Map,this.inheritedAriaAttributes={},this.multipleInputs=!1,this.focusable=!0,this.color=void 0,this.button=!1,this.detail=void 0,this.detailIcon=xR,this.disabled=!1,this.download=void 0,this.fill=void 0,this.shape=void 0,this.href=void 0,this.rel=void 0,this.lines=void 0,this.counter=!1,this.routerAnimation=void 0,this.routerDirection="forward",this.target=void 0,this.type="button",this.counterFormatter=void 0,this.counterString=void 0}counterFormatterChanged(){this.updateCounterOutput(this.getFirstInput())}handleIonInput(e){this.counter&&e.target===this.getFirstInput()&&this.updateCounterOutput(e.target)}labelColorChanged(e){const{color:n}=this;n===void 0&&(this.labelColorStyles=e.detail)}itemStyle(e){e.stopPropagation();const n=e.target.tagName,i=e.detail,r={},a=this.itemStyles.get(n)||{};let d=!1;Object.keys(i).forEach(o=>{if(i[o]){const f=`item-${o}`;a[f]||(d=!0),r[f]=!0}}),!d&&Object.keys(r).length!==Object.keys(a).length&&(d=!0),d&&(this.itemStyles.set(n,r),dx(this))}connectedCallback(){this.counter&&this.updateCounterOutput(this.getFirstInput()),this.hasStartEl()}componentWillLoad(){this.inheritedAriaAttributes=ym(this.el,["aria-label"])}componentDidLoad(){const{el:e,counter:n,counterFormatter:i,fill:r,shape:a}=this;e.querySelector('[slot="helper"]')!==null&&gs('The "helper" slot has been deprecated in favor of using the "helperText" property on ion-input or ion-textarea.',e),e.querySelector('[slot="error"]')!==null&&gs('The "error" slot has been deprecated in favor of using the "errorText" property on ion-input or ion-textarea.',e),n===!0&&gs('The "counter" property has been deprecated in favor of using the "counter" property on ion-input or ion-textarea.',e),i!==void 0&&gs('The "counterFormatter" property has been deprecated in favor of using the "counterFormatter" property on ion-input or ion-textarea.',e),r!==void 0&&gs('The "fill" property has been deprecated in favor of using the "fill" property on ion-input or ion-textarea.',e),a!==void 0&&gs('The "shape" property has been deprecated in favor of using the "shape" property on ion-input or ion-textarea.',e),ro(()=>{this.setMultipleInputs(),this.focusable=this.isFocusable()})}setMultipleInputs(){const e=this.el.querySelectorAll("ion-checkbox, ion-datetime, ion-select, ion-radio"),n=this.el.querySelectorAll("ion-input, ion-range, ion-searchbar, ion-segment, ion-textarea, ion-toggle"),i=this.el.querySelectorAll("ion-anchor, ion-button, a, button");this.multipleInputs=e.length+n.length>1||e.length+i.length>1||e.length>0&&this.isClickable()}hasCover(){return this.el.querySelectorAll("ion-checkbox, ion-datetime, ion-select, ion-radio").length===1&&!this.multipleInputs}isClickable(){return this.href!==void 0||this.button}canActivate(){return this.isClickable()||this.hasCover()}isFocusable(){const e=this.el.querySelector(".ion-focusable");return this.canActivate()||e!==null}getFirstInput(){return this.el.querySelectorAll("ion-input, ion-textarea")[0]}updateCounterOutput(e){var n,i;const{counter:r,counterFormatter:a,defaultCounterFormatter:d}=this;if(r&&!this.multipleInputs&&(e==null?void 0:e.maxlength)!==void 0){const o=(i=(n=e==null?void 0:e.value)===null||n===void 0?void 0:n.toString().length)!==null&&i!==void 0?i:0;if(a===void 0)this.counterString=d(o,e.maxlength);else try{this.counterString=a(o,e.maxlength)}catch(f){EN("Exception in provided `counterFormatter`.",f),this.counterString=d(o,e.maxlength)}}}defaultCounterFormatter(e,n){return`${e} / ${n}`}hasStartEl(){this.el.querySelector('[slot="start"]')!==null&&this.el.classList.add("item-has-start-slot")}render(){const{counterString:e,detail:n,detailIcon:i,download:r,fill:a,labelColorStyles:d,lines:o,disabled:f,href:g,rel:_,shape:w,target:T,routerAnimation:A,routerDirection:D,inheritedAriaAttributes:z}=this,G={},V=Xn(this),N=this.isClickable(),q=this.canActivate(),K=N?g===void 0?"button":"a":"div",se=K==="button"?{type:this.type}:{download:r,href:g,rel:_,target:T},ie=N?{onClick:Fe=>{M1(g,Fe,D,A)}}:{},Q=n!==void 0?n:V==="ios"&&N;this.itemStyles.forEach(Fe=>{Object.assign(G,Fe)});const J=f||G["item-interactive-disabled"]?"true":null,te=a||"none",me=Ka("ion-list",this.el);return Rt(_r,{"aria-disabled":J,class:Object.assign(Object.assign(Object.assign({},G),d),Ml(this.color,{item:!0,[V]:!0,"item-lines-default":o===void 0,[`item-lines-${o}`]:o!==void 0,[`item-fill-${te}`]:!0,[`item-shape-${w}`]:w!==void 0,"item-disabled":f,"in-list":me,"item-multiple-inputs":this.multipleInputs,"ion-activatable":q,"ion-focusable":this.focusable,"item-rtl":document.dir==="rtl"})),role:me?"listitem":null},Rt(K,Object.assign({},se,z,{class:"item-native",part:"native",disabled:f},ie),Rt("slot",{name:"start"}),Rt("div",{class:"item-inner"},Rt("div",{class:"input-wrapper"},Rt("slot",null)),Rt("slot",{name:"end"}),Q&&Rt("ion-icon",{icon:i,lazy:!1,class:"item-detail-icon",part:"detail-icon","aria-hidden":"true","flip-rtl":i===xR}),Rt("div",{class:"item-inner-highlight"})),q&&V==="md"&&Rt("ion-ripple-effect",null),Rt("div",{class:"item-highlight"})),Rt("div",{class:"item-bottom"},Rt("slot",{name:"error"}),Rt("slot",{name:"helper"}),e&&Rt("ion-note",{class:"item-counter"},e)))}static get delegatesFocus(){return!0}get el(){return this}static get watchers(){return{counterFormatter:["counterFormatterChanged"]}}static get style(){return{ios:FZ,md:NZ}}},[49,"ion-item",{color:[513],button:[4],detail:[4],detailIcon:[1,"detail-icon"],disabled:[4],download:[1],fill:[1],shape:[1],href:[1],rel:[1],lines:[1],counter:[4],routerAnimation:[16],routerDirection:[1,"router-direction"],target:[1],type:[1],counterFormatter:[16],multipleInputs:[32],focusable:[32],counterString:[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]]);/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const jZ=".item.sc-ion-label-ios-h,.item .sc-ion-label-ios-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-ios-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{white-space:normal}.item-interactive-disabled.sc-ion-label-ios-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-ios-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-ios-h,.item-input .sc-ion-label-ios-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-ios-h,.item-textarea .sc-ion-label-ios-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-ios-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-ios-h,.label-floating.sc-ion-label-ios-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-ios-h{-webkit-transition:none;transition:none}.sc-ion-label-ios-s h1,.sc-ion-label-ios-s h2,.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-ios-h,[text-wrap].sc-ion-label-ios-h{font-size:14px;line-height:1.5}.label-stacked.sc-ion-label-ios-h{margin-bottom:4px;font-size:14px}.label-floating.sc-ion-label-ios-h{margin-bottom:0;-webkit-transform:translate(0, 29px);transform:translate(0, 29px);-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform 150ms ease-in-out;transition:-webkit-transform 150ms ease-in-out;transition:transform 150ms ease-in-out;transition:transform 150ms ease-in-out, -webkit-transform 150ms ease-in-out}[dir=rtl].sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl] .sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h,[dir=rtl].label-floating.sc-ion-label-ios-h,[dir=rtl] .label-floating.sc-ion-label-ios-h{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.label-floating.sc-ion-label-ios-h:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.item-textarea.label-floating.sc-ion-label-ios-h,.item-textarea .label-floating.sc-ion-label-ios-h{-webkit-transform:translate(0, 28px);transform:translate(0, 28px)}.item-has-focus.label-floating.sc-ion-label-ios-h,.item-has-focus .label-floating.sc-ion-label-ios-h,.item-has-placeholder.sc-ion-label-ios-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-ios-h,.item-has-value.label-floating.sc-ion-label-ios-h,.item-has-value .label-floating.sc-ion-label-ios-h{-webkit-transform:scale(0.82);transform:scale(0.82)}.sc-ion-label-ios-s h1{margin-left:0;margin-right:0;margin-top:3px;margin-bottom:2px;font-size:22px;font-weight:normal}.sc-ion-label-ios-s h2{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:17px;font-weight:normal}.sc-ion-label-ios-s h3,.sc-ion-label-ios-s h4,.sc-ion-label-ios-s h5,.sc-ion-label-ios-s h6{margin-left:0;margin-right:0;margin-top:0;margin-bottom:3px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-ios-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}.sc-ion-label-ios-s>p{color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.4)}.sc-ion-label-ios-h.in-item-color.sc-ion-label-ios-s>p{color:inherit}.sc-ion-label-ios-s h2:last-child,.sc-ion-label-ios-s h3:last-child,.sc-ion-label-ios-s h4:last-child,.sc-ion-label-ios-s h5:last-child,.sc-ion-label-ios-s h6:last-child,.sc-ion-label-ios-s p:last-child{margin-bottom:0}",VZ='.item.sc-ion-label-md-h,.item .sc-ion-label-md-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family, inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-md-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{white-space:normal}.item-interactive-disabled.sc-ion-label-md-h:not(.item-multiple-inputs),.item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-md-h{cursor:default;opacity:0.3;pointer-events:none}.item-input.sc-ion-label-md-h,.item-input .sc-ion-label-md-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-md-h,.item-textarea .sc-ion-label-md-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-md-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-md-h{-webkit-transition:none;transition:none}.sc-ion-label-md-s h1,.sc-ion-label-md-s h2,.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-md-h,[text-wrap].sc-ion-label-md-h{line-height:1.5}.label-stacked.sc-ion-label-md-h,.label-floating.sc-ion-label-md-h{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-transform-origin:top left;transform-origin:top left}.label-stacked.label-rtl.sc-ion-label-md-h,.label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform-origin:top right;transform-origin:top right}.label-stacked.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.label-floating.sc-ion-label-md-h{-webkit-transform:translateY(96%);transform:translateY(96%);-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1)}.ion-focused.label-floating.sc-ion-label-md-h,.ion-focused .label-floating.sc-ion-label-md-h,.item-has-focus.label-floating.sc-ion-label-md-h,.item-has-focus .label-floating.sc-ion-label-md-h,.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-has-value.label-floating.sc-ion-label-md-h,.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h{-webkit-transform:translateY(-6px) scale(0.75);transform:translateY(-6px) scale(0.75);position:relative;max-width:-webkit-min-content;max-width:-moz-min-content;max-width:min-content;background-color:var(--ion-item-background, var(--ion-background-color, #fff));overflow:visible;z-index:3}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{position:absolute;width:4px;height:100%;background-color:var(--ion-item-background, var(--ion-background-color, #fff));content:""}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::before,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::before,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::before,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::before{left:calc(-1 * 4px)}.item-fill-outline.ion-focused.label-floating.sc-ion-label-md-h::after,.item-fill-outline.ion-focused .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-focus .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).label-floating::after,.item-fill-outline.item-has-placeholder:not(.item-input) .label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value.label-floating.sc-ion-label-md-h::after,.item-fill-outline.item-has-value .label-floating.sc-ion-label-md-h::after{right:calc(-1 * 4px)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.sc-ion-label-md-h{-webkit-transform:translateX(-32px) translateY(-6px) scale(0.75);transform:translateX(-32px) translateY(-6px) scale(0.75)}.item-fill-outline.ion-focused.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.ion-focused.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-focus.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-placeholder.sc-ion-label-md-h:not(.item-input).item-has-start-slot.label-floating.label-rtl,.item-fill-outline.item-has-placeholder:not(.item-input).item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot.label-floating.label-rtl.sc-ion-label-md-h,.item-fill-outline.item-has-value.item-has-start-slot .label-floating.label-rtl.sc-ion-label-md-h{-webkit-transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75);transform:translateX(calc(-1 * -32px)) translateY(-6px) scale(0.75)}.ion-focused.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-primary, #3880ff)}.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-contrast)}.item-fill-solid.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.ion-focused.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-solid.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-stacked.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color.label-floating.sc-ion-label-md-h:not(.ion-color),.item-fill-outline.item-has-focus.ion-color .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--ion-color-base)}.ion-invalid.ion-touched.label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-stacked.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched.label-floating.sc-ion-label-md-h:not(.ion-color),.ion-invalid.ion-touched .label-floating.sc-ion-label-md-h:not(.ion-color){color:var(--highlight-color-invalid)}.sc-ion-label-md-s h1{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:24px;font-weight:normal}.sc-ion-label-md-s h2{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:16px;font-weight:normal}.sc-ion-label-md-s h3,.sc-ion-label-md-s h4,.sc-ion-label-md-s h5,.sc-ion-label-md-s h6{margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:14px;font-weight:normal;line-height:normal}.sc-ion-label-md-s p{margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:20px;text-overflow:inherit;overflow:inherit}.sc-ion-label-md-s>p{color:var(--ion-color-step-600, #666666)}.sc-ion-label-md-h.in-item-color.sc-ion-label-md-s>p{color:inherit}',UZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.ionColor=Wn(this,"ionColor",7),this.ionStyle=Wn(this,"ionStyle",7),this.inRange=!1,this.color=void 0,this.position=void 0,this.noAnimate=!1}componentWillLoad(){this.inRange=!!this.el.closest("ion-range"),this.noAnimate=this.position==="floating",this.emitStyle(),this.emitColor()}componentDidLoad(){this.noAnimate&&setTimeout(()=>{this.noAnimate=!1},1e3)}colorChanged(){this.emitColor()}positionChanged(){this.emitStyle()}emitColor(){const{color:e}=this;this.ionColor.emit({"item-label-color":e!==void 0,[`ion-color-${e}`]:e!==void 0})}emitStyle(){const{inRange:e,position:n}=this;e||this.ionStyle.emit({label:!0,[`label-${n}`]:n!==void 0})}render(){const e=this.position,n=Xn(this);return Rt(_r,{class:Ml(this.color,{[n]:!0,"in-item-color":Ka("ion-item.ion-color",this.el),[`label-${e}`]:e!==void 0,"label-no-animate":this.noAnimate,"label-rtl":document.dir==="rtl"})})}get el(){return this}static get watchers(){return{color:["colorChanged"],position:["positionChanged"]}}static get style(){return{ios:jZ,md:VZ}}},[34,"ion-label",{color:[513],position:[1],noAnimate:[32]}]);function qZ(){if(typeof customElements>"u")return;["ion-label"].forEach(e=>{switch(e){case"ion-label":customElements.get(e)||customElements.define(e,UZ);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const WZ=":host{position:absolute;z-index:999}:host(.fab-horizontal-center){-webkit-margin-start:-28px;margin-inline-start:-28px}@supports (inset-inline-start: 0){:host(.fab-horizontal-center){inset-inline-start:50%}}@supports not (inset-inline-start: 0){:host(.fab-horizontal-center){left:50%}:host-context([dir=rtl]):host(.fab-horizontal-center),:host-context([dir=rtl]).fab-horizontal-center{left:unset;right:unset;right:50%}@supports selector(:dir(rtl)){:host(.fab-horizontal-center):dir(rtl){left:unset;right:unset;right:50%}}}@supports (inset-inline-start: 0){:host(.fab-horizontal-start){inset-inline-start:calc(10px + var(--ion-safe-area-left, 0px))}}@supports not (inset-inline-start: 0){:host(.fab-horizontal-start){left:calc(10px + var(--ion-safe-area-left, 0px))}:host-context([dir=rtl]):host(.fab-horizontal-start),:host-context([dir=rtl]).fab-horizontal-start{left:unset;right:unset;right:calc(10px + var(--ion-safe-area-left, 0px))}@supports selector(:dir(rtl)){:host(.fab-horizontal-start):dir(rtl){left:unset;right:unset;right:calc(10px + var(--ion-safe-area-left, 0px))}}}@supports (inset-inline-start: 0){:host(.fab-horizontal-end){inset-inline-end:calc(10px + var(--ion-safe-area-right, 0px))}}@supports not (inset-inline-start: 0){:host(.fab-horizontal-end){right:calc(10px + var(--ion-safe-area-right, 0px))}:host-context([dir=rtl]):host(.fab-horizontal-end),:host-context([dir=rtl]).fab-horizontal-end{left:unset;right:unset;left:calc(10px + var(--ion-safe-area-right, 0px))}@supports selector(:dir(rtl)){:host(.fab-horizontal-end):dir(rtl){left:unset;right:unset;left:calc(10px + var(--ion-safe-area-right, 0px))}}}:host(.fab-vertical-top){top:10px}:host(.fab-vertical-top.fab-edge){top:-28px}:host(.fab-vertical-bottom){bottom:10px}:host(.fab-vertical-bottom.fab-edge){bottom:-28px}:host(.fab-vertical-center){margin-top:-28px;top:50%}",GZ=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.horizontal=void 0,this.vertical=void 0,this.edge=!1,this.activated=!1}activatedChanged(){const e=this.activated,n=this.getFab();n&&(n.activated=e),Array.from(this.el.querySelectorAll("ion-fab-list")).forEach(i=>{i.activated=e})}componentDidLoad(){this.activated&&this.activatedChanged()}async close(){this.activated=!1}getFab(){return this.el.querySelector("ion-fab-button")}async toggle(){!!this.el.querySelector("ion-fab-list")&&(this.activated=!this.activated)}render(){const{horizontal:e,vertical:n,edge:i}=this,r=Xn(this);return Rt(_r,{class:{[r]:!0,[`fab-horizontal-${e}`]:e!==void 0,[`fab-vertical-${n}`]:n!==void 0,"fab-edge":i}},Rt("slot",null))}get el(){return this}static get watchers(){return{activated:["activatedChanged"]}}static get style(){return WZ}},[1,"ion-fab",{horizontal:[1],vertical:[1],edge:[4],activated:[1028],close:[64],toggle:[64]}]);function HZ(){if(typeof customElements>"u")return;["ion-fab"].forEach(e=>{switch(e){case"ion-fab":customElements.get(e)||customElements.define(e,GZ);break}})}const ZZ=HZ;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const XZ="ION-CONTENT",PN="ion-content",ON=".ion-content-scroll-host",DN=`${PN}, ${ON}`,Ch=t=>t.tagName===XZ,kR=async t=>Ch(t)?(await new Promise(e=>Sh(t,e)),t.getScrollElement()):t,jT=t=>{const e=t.querySelector(ON);return e||t.querySelector(DN)},KZ=t=>t.closest(DN),pfe=(t,e)=>Ch(t)?t.scrollToTop(e):Promise.resolve(t.scrollTo({top:0,left:0,behavior:e>0?"smooth":"auto"})),mfe=(t,e,n,i)=>Ch(t)?t.scrollByPoint(e,n,i):Promise.resolve(t.scrollBy({top:n,left:e,behavior:i>0?"smooth":"auto"})),VT=t=>TH(t,PN),TR=t=>{if(Ch(t)){const e=t,n=e.scrollY;return e.scrollY=!1,n}else return t.style.setProperty("overflow","hidden"),!0},YZ=(t,e)=>{Ch(t)?t.scrollY=e:t.style.removeProperty("overflow")};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */var UT;(function(t){t.Body="body",t.Ionic="ionic",t.Native="native",t.None="none"})(UT||(UT={}));const RN={getEngine(){var t;return((t=Zn==null?void 0:Zn.Capacitor)===null||t===void 0?void 0:t.isPluginAvailable("Keyboard"))&&(Zn==null?void 0:Zn.Capacitor.Plugins.Keyboard)},getResizeMode(){const t=this.getEngine();return t!=null&&t.getResizeMode?t.getResizeMode().catch(e=>{if(e.code!=="UNIMPLEMENTED")throw e}):Promise.resolve(void 0)}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const LN=t=>{if(DE===void 0||t===UT.None||t===void 0)return null;const e=DE.querySelector("ion-app");return e!=null?e:DE.body},CR=t=>{const e=LN(t);return e===null?0:e.clientHeight},JZ=async t=>{let e,n,i,r;const a=async()=>{const _=await RN.getResizeMode(),w=_===void 0?void 0:_.mode;e=()=>{r===void 0&&(r=CR(w)),i=!0,d(i,w)},n=()=>{i=!1,d(i,w)},Zn==null||Zn.addEventListener("keyboardWillShow",e),Zn==null||Zn.addEventListener("keyboardWillHide",n)},d=(_,w)=>{t&&t(_,o(w))},o=_=>{if(r===0||r===CR(_))return;const w=LN(_);if(w!==null)return new Promise(T=>{const A=()=>{w.clientHeight===r&&(D.disconnect(),T())},D=new ResizeObserver(A);D.observe(w)})},f=()=>{Zn==null||Zn.removeEventListener("keyboardWillShow",e),Zn==null||Zn.removeEventListener("keyboardWillHide",n),e=n=void 0},g=()=>i;return await a(),{init:a,destroy:f,isKeyboardVisible:g}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const QZ="all 0.2s ease-in-out",IR=t=>{const e=document.querySelector(`${t}.ion-cloned-element`);if(e!==null)return e;const n=document.createElement(t);return n.classList.add("ion-cloned-element"),n.style.setProperty("display","none"),document.body.appendChild(n),n},AR=t=>{if(!t)return;const e=t.querySelectorAll("ion-toolbar");return{el:t,toolbars:Array.from(e).map(n=>{const i=n.querySelector("ion-title");return{el:n,background:n.shadowRoot.querySelector(".toolbar-background"),ionTitleEl:i,innerTitleEl:i?i.shadowRoot.querySelector(".toolbar-title"):null,ionButtonsEl:Array.from(n.querySelectorAll("ion-buttons"))}})}},eX=(t,e,n)=>{fv(()=>{const i=t.scrollTop,r=Eh(1,1+-i/500,1.1);n.querySelector("ion-refresher.refresher-native")===null&&Al(()=>{iX(e.toolbars,r)})})},TI=(t,e)=>{t.collapse!=="fade"&&(e===void 0?t.style.removeProperty("--opacity-scale"):t.style.setProperty("--opacity-scale",e.toString()))},tX=(t,e,n)=>{if(!t[0].isIntersecting)return;const i=t[0].intersectionRatio>.9||n<=0?0:(1-t[0].intersectionRatio)*100/75;TI(e.el,i===1?void 0:i)},nX=(t,e,n,i)=>{Al(()=>{const r=i.scrollTop;tX(t,e,r);const a=t[0],d=a.intersectionRect,o=d.width*d.height,f=a.rootBounds.width*a.rootBounds.height,g=o===0&&f===0,_=Math.abs(d.left-a.boundingClientRect.left),w=Math.abs(d.right-a.boundingClientRect.right),T=o>0&&(_>=5||w>=5);g||T||(a.isIntersecting?(Sy(e,!1),Sy(n)):(d.x===0&&d.y===0||d.width!==0&&d.height!==0)&&r>0&&(Sy(e),Sy(n,!1),TI(e.el)))})},Sy=(t,e=!0)=>{const n=t.el;e?(n.classList.remove("header-collapse-condense-inactive"),n.removeAttribute("aria-hidden")):(n.classList.add("header-collapse-condense-inactive"),n.setAttribute("aria-hidden","true"))},iX=(t=[],e=1,n=!1)=>{t.forEach(i=>{const r=i.ionTitleEl,a=i.innerTitleEl;!r||r.size!=="large"||(a.style.transition=n?QZ:"",a.style.transform=`scale3d(${e}, ${e}, 1)`)})},MR=(t,e,n)=>{fv(()=>{const i=t.scrollTop,r=e.clientHeight,a=n?n.clientHeight:0;if(n!==null&&i<a){e.style.setProperty("--opacity-scale","0"),t.style.setProperty("clip-path",`inset(${r}px 0px 0px 0px)`);return}const d=i-a,f=Eh(0,d/10,1);Al(()=>{t.style.removeProperty("clip-path"),e.style.setProperty("--opacity-scale",f.toString())})})},rX="ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-ios ion-toolbar:last-of-type{--border-width:0 0 0.55px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.header-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.header-translucent-ios ion-toolbar{--opacity:.8}.header-collapse-condense-inactive .header-background{-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}}.header-ios.ion-no-border ion-toolbar:last-of-type{--border-width:0}.header-collapse-fade ion-toolbar{--opacity-scale:inherit}.header-collapse-condense{z-index:9}.header-collapse-condense ion-toolbar{position:-webkit-sticky;position:sticky;top:0}.header-collapse-condense ion-toolbar:first-of-type{padding-top:7px;z-index:1}.header-collapse-condense ion-toolbar{--background:var(--ion-background-color, #fff);z-index:0}.header-collapse-condense ion-toolbar:last-of-type{--border-width:0px}.header-collapse-condense ion-toolbar ion-searchbar{height:48px;padding-top:0px;padding-bottom:13px}.header-collapse-main{--opacity-scale:1}.header-collapse-main ion-toolbar{--opacity-scale:inherit}.header-collapse-main ion-toolbar.in-toolbar ion-title,.header-collapse-main ion-toolbar.in-toolbar ion-buttons{-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-buttons.buttons-collapse{opacity:0;pointer-events:none}.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-title,.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-buttons.buttons-collapse{visibility:hidden}",oX="ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top, 0)}.header-md{-webkit-box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12);box-shadow:0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12)}.header-collapse-condense{display:none}.header-md.ion-no-border{-webkit-box-shadow:none;box-shadow:none}",sX=xr(class extends wr{constructor(){super(),this.__registerHost(),this.inheritedAttributes={},this.setupFadeHeader=async(e,n)=>{const i=this.scrollEl=await kR(e);this.contentScrollCallback=()=>{MR(this.scrollEl,this.el,n)},i.addEventListener("scroll",this.contentScrollCallback),MR(this.scrollEl,this.el,n)},this.collapse=void 0,this.translucent=!1}componentWillLoad(){this.inheritedAttributes=jv(this.el)}componentDidLoad(){this.checkCollapsibleHeader()}componentDidUpdate(){this.checkCollapsibleHeader()}disconnectedCallback(){this.destroyCollapsibleHeader()}async checkCollapsibleHeader(){if(Xn(this)!=="ios")return;const{collapse:n}=this,i=n==="condense",r=n==="fade";if(this.destroyCollapsibleHeader(),i){const a=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),d=a?jT(a):null;Al(()=>{const o=IR("ion-title");o.size="large",IR("ion-back-button")}),await this.setupCondenseHeader(d,a)}else if(r){const a=this.el.closest("ion-app,ion-page,.ion-page,page-inner"),d=a?jT(a):null;if(!d){VT(this.el);return}const o=d.querySelector('ion-header[collapse="condense"]');await this.setupFadeHeader(d,o)}}destroyCollapsibleHeader(){this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=void 0),this.scrollEl&&this.contentScrollCallback&&(this.scrollEl.removeEventListener("scroll",this.contentScrollCallback),this.contentScrollCallback=void 0),this.collapsibleMainHeader&&(this.collapsibleMainHeader.classList.remove("header-collapse-main"),this.collapsibleMainHeader=void 0)}async setupCondenseHeader(e,n){if(!e||!n){VT(this.el);return}if(typeof IntersectionObserver>"u")return;this.scrollEl=await kR(e);const i=n.querySelectorAll("ion-header");if(this.collapsibleMainHeader=Array.from(i).find(o=>o.collapse!=="condense"),!this.collapsibleMainHeader)return;const r=AR(this.collapsibleMainHeader),a=AR(this.el);if(!r||!a)return;Sy(r,!1),TI(r.el,0);const d=o=>{nX(o,r,a,this.scrollEl)};this.intersectionObserver=new IntersectionObserver(d,{root:e,threshold:[.25,.3,.4,.5,.6,.7,.8,.9,1]}),this.intersectionObserver.observe(a.toolbars[a.toolbars.length-1].el),this.contentScrollCallback=()=>{eX(this.scrollEl,a,e)},this.scrollEl.addEventListener("scroll",this.contentScrollCallback),Al(()=>{this.collapsibleMainHeader!==void 0&&this.collapsibleMainHeader.classList.add("header-collapse-main")})}render(){const{translucent:e,inheritedAttributes:n}=this,i=Xn(this),r=this.collapse||"none",a=Ka("ion-menu",this.el)?"none":"banner";return Rt(_r,Object.assign({role:a,class:{[i]:!0,[`header-${i}`]:!0,"header-translucent":this.translucent,[`header-collapse-${r}`]:!0,[`header-translucent-${i}`]:this.translucent}},n),i==="ios"&&e&&Rt("div",{class:"header-background"}),Rt("slot",null))}get el(){return this}static get style(){return{ios:rX,md:oX}}},[36,"ion-header",{collapse:[1],translucent:[4]}]);function aX(){if(typeof customElements>"u")return;["ion-header"].forEach(e=>{switch(e){case"ion-header":customElements.get(e)||customElements.define(e,sX);break}})}const lX=aX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const cX={bubbles:{dur:1e3,circles:9,fn:(t,e,n)=>{const i=`${t*e/n-t}ms`,r=2*Math.PI*e/n;return{r:5,style:{top:`${32*Math.sin(r)}%`,left:`${32*Math.cos(r)}%`,"animation-delay":i}}}},circles:{dur:1e3,circles:8,fn:(t,e,n)=>{const i=e/n,r=`${t*i-t}ms`,a=2*Math.PI*i;return{r:5,style:{top:`${32*Math.sin(a)}%`,left:`${32*Math.cos(a)}%`,"animation-delay":r}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(t,e)=>{const n=-(110*e)+"ms";return{r:6,style:{left:`${32-32*e}%`,"animation-delay":n}}}},lines:{dur:1e3,lines:8,fn:(t,e,n)=>{const i=`rotate(${360/n*e+(e<n/2?180:-180)}deg)`,r=`${t*e/n-t}ms`;return{y1:14,y2:26,style:{transform:i,"animation-delay":r}}}},"lines-small":{dur:1e3,lines:8,fn:(t,e,n)=>{const i=`rotate(${360/n*e+(e<n/2?180:-180)}deg)`,r=`${t*e/n-t}ms`;return{y1:12,y2:20,style:{transform:i,"animation-delay":r}}}},"lines-sharp":{dur:1e3,lines:12,fn:(t,e,n)=>{const i=`rotate(${30*e+(e<6?180:-180)}deg)`,r=`${t*e/n-t}ms`;return{y1:17,y2:29,style:{transform:i,"animation-delay":r}}}},"lines-sharp-small":{dur:1e3,lines:12,fn:(t,e,n)=>{const i=`rotate(${30*e+(e<6?180:-180)}deg)`,r=`${t*e/n-t}ms`;return{y1:12,y2:20,style:{transform:i,"animation-delay":r}}}}},PR=cX,uX=":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{-webkit-transform-origin:center;transform-origin:center;position:absolute;top:0;left:0;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}[dir=rtl] svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}@supports selector(:dir(rtl)){svg:dir(rtl){-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:7px}:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-width:4px}:host(.spinner-lines) line,:host(.spinner-lines-small) line,:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg,:host(.spinner-lines-sharp) svg,:host(.spinner-lines-sharp-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular) svg{-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}",dX=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.color=void 0,this.duration=void 0,this.name=void 0,this.paused=!1}getName(){const e=this.name||_i.get("spinner"),n=Xn(this);return e||(n==="ios"?"lines":"circular")}render(){var e;const n=this,i=Xn(n),r=n.getName(),a=(e=PR[r])!==null&&e!==void 0?e:PR.lines,d=typeof n.duration=="number"&&n.duration>10?n.duration:a.dur,o=[];if(a.circles!==void 0)for(let f=0;f<a.circles;f++)o.push(hX(a,d,f,a.circles));else if(a.lines!==void 0)for(let f=0;f<a.lines;f++)o.push(fX(a,d,f,a.lines));return Rt(_r,{class:Ml(n.color,{[i]:!0,[`spinner-${r}`]:!0,"spinner-paused":n.paused||_i.getBoolean("_testing")}),role:"progressbar",style:a.elmDuration?{animationDuration:d+"ms"}:{}},o)}static get style(){return uX}},[1,"ion-spinner",{color:[513],duration:[2],name:[1],paused:[4]}]),hX=(t,e,n,i)=>{const r=t.fn(e,n,i);return r.style["animation-duration"]=e+"ms",Rt("svg",{viewBox:r.viewBox||"0 0 64 64",style:r.style},Rt("circle",{transform:r.transform||"translate(32,32)",cx:r.cx,cy:r.cy,r:r.r,style:t.elmDuration?{animationDuration:e+"ms"}:{}}))},fX=(t,e,n,i)=>{const r=t.fn(e,n,i);return r.style["animation-duration"]=e+"ms",Rt("svg",{viewBox:r.viewBox||"0 0 64 64",style:r.style},Rt("line",{transform:"translate(32,32)",y1:r.y1,y2:r.y2}))};function pX(){if(typeof customElements>"u")return;["ion-spinner"].forEach(e=>{switch(e){case"ion-spinner":customElements.get(e)||customElements.define(e,dX);break}})}/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const mX=(t,e,n)=>{let i;const r=()=>!(e()===void 0||t.label!==void 0||n()===null),a=()=>{r()&&ro(()=>{d()})},d=()=>{const f=e();if(f===void 0)return;if(!r()){f.style.removeProperty("width");return}const g=n().scrollWidth;if(g===0&&f.offsetParent===null&&Zn!==void 0&&"IntersectionObserver"in Zn){if(i!==void 0)return;const _=i=new IntersectionObserver(w=>{w[0].intersectionRatio===1&&(d(),_.disconnect(),i=void 0)},{threshold:.01,root:t});_.observe(f);return}f.style.setProperty("width",`${g*.75}px`)};return{calculateNotchWidth:a,destroy:()=>{i&&(i.disconnect(),i=void 0)}}};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const gX=(t,e,n)=>{let i,r;Zn!==void 0&&"MutationObserver"in Zn&&(i=new MutationObserver(f=>{for(const g of f)for(const _ of g.addedNodes)if(_.nodeType===Node.ELEMENT_NODE&&_.slot===e){n(),ro(()=>a(_));return}}),i.observe(t,{childList:!0}));const a=f=>{var g;r&&(r.disconnect(),r=void 0),r=new MutationObserver(_=>{n();for(const w of _)for(const T of w.removedNodes)T.nodeType===Node.ELEMENT_NODE&&T.slot===e&&o()}),r.observe((g=f.parentElement)!==null&&g!==void 0?g:f,{subtree:!0,childList:!0})},d=()=>{i&&(i.disconnect(),i=void 0),o()},o=()=>{r&&(r.disconnect(),r=void 0)};return{destroy:d}},yX=(t,e,n)=>{const i=t==null?0:t.toString().length,r=vX(i,e);if(n===void 0)return r;try{return n(i,e)}catch(a){return EN("Exception in provided `counterFormatter`.",a),r}},vX=(t,e)=>`${t} / ${e}`;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const bX=".sc-ion-input-ios-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:0.6;--padding-top:0px;--padding-end:0px;--padding-bottom:0px;--padding-start:0px;--background:transparent;--color:initial;--border-style:solid;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);--highlight-color:var(--highlight-color-focused);display:block;position:relative;width:100%;padding:0 !important;color:var(--color);font-family:var(--ion-font-family, inherit);z-index:2}.legacy-input.sc-ion-input-ios-h{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;background:var(--background)}.legacy-input.sc-ion-input-ios-h .native-input.sc-ion-input-ios{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius)}ion-item.sc-ion-input-ios-h:not(.item-label):not(.item-has-modern-input),ion-item:not(.item-label):not(.item-has-modern-input) .sc-ion-input-ios-h{--padding-start:0}ion-item[slot=start].sc-ion-input-ios-h,ion-item [slot=start].sc-ion-input-ios-h,ion-item[slot=end].sc-ion-input-ios-h,ion-item [slot=end].sc-ion-input-ios-h{width:auto}.legacy-input.ion-color.sc-ion-input-ios-h{color:var(--ion-color-base)}.ion-color.sc-ion-input-ios-h{--highlight-color-focused:var(--ion-color-base)}.native-input.sc-ion-input-ios{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:inline-block;position:relative;-ms-flex:1;flex:1;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none;z-index:1}.native-input.sc-ion-input-ios::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-ios:-webkit-autofill{background-color:transparent}.native-input.sc-ion-input-ios:invalid{-webkit-box-shadow:none;box-shadow:none}.native-input.sc-ion-input-ios::-ms-clear{display:none}.cloned-input.sc-ion-input-ios{top:0;bottom:0;position:absolute;pointer-events:none}@supports (inset-inline-start: 0){.cloned-input.sc-ion-input-ios{inset-inline-start:0}}@supports not (inset-inline-start: 0){.cloned-input.sc-ion-input-ios{left:0}[dir=rtl].sc-ion-input-ios-h .cloned-input.sc-ion-input-ios,[dir=rtl] .sc-ion-input-ios-h .cloned-input.sc-ion-input-ios{left:unset;right:unset;right:0}[dir=rtl].sc-ion-input-ios .cloned-input.sc-ion-input-ios{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.cloned-input.sc-ion-input-ios:dir(rtl){left:unset;right:unset;right:0}}}.cloned-input.sc-ion-input-ios:disabled{opacity:1}.legacy-input.sc-ion-input-ios-h .input-clear-icon.sc-ion-input-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.input-clear-icon.sc-ion-input-ios{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;background-position:center;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:30px;height:30px;border:0;outline:none;background-color:transparent;background-repeat:no-repeat;color:var(--ion-color-step-600, #666666);visibility:hidden;-webkit-appearance:none;-moz-appearance:none;appearance:none}.in-item-color.sc-ion-input-ios-h .input-clear-icon.sc-ion-input-ios{color:inherit}.input-clear-icon.sc-ion-input-ios:focus{opacity:0.5}.has-value.sc-ion-input-ios-h .input-clear-icon.sc-ion-input-ios{visibility:visible}.has-focus.sc-ion-input-ios-h{pointer-events:none}.has-focus.sc-ion-input-ios-h input.sc-ion-input-ios,.has-focus.sc-ion-input-ios-h a.sc-ion-input-ios,.has-focus.sc-ion-input-ios-h button.sc-ion-input-ios{pointer-events:auto}.item-label-floating.item-has-placeholder.sc-ion-input-ios-h:not(.item-has-value),.item-label-floating.item-has-placeholder:not(.item-has-value) .sc-ion-input-ios-h{opacity:0}.item-label-floating.item-has-placeholder.sc-ion-input-ios-h:not(.item-has-value).item-has-focus,.item-label-floating.item-has-placeholder:not(.item-has-value).item-has-focus .sc-ion-input-ios-h{-webkit-transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.input-wrapper.sc-ion-input-ios{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:stretch;align-items:stretch;height:inherit;min-height:inherit;-webkit-transition:background-color 15ms linear;transition:background-color 15ms linear;background:var(--background);line-height:normal}.native-wrapper.sc-ion-input-ios{display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;width:100%}.ion-touched.ion-invalid.sc-ion-input-ios-h{--highlight-color:var(--highlight-color-invalid)}.ion-valid.sc-ion-input-ios-h{--highlight-color:var(--highlight-color-valid)}.input-bottom.sc-ion-input-ios{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:5px;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;border-top:var(--border-width) var(--border-style) var(--border-color);font-size:12px}.has-focus.ion-valid.sc-ion-input-ios-h,.ion-touched.ion-invalid.sc-ion-input-ios-h{--border-color:var(--highlight-color)}.input-bottom.sc-ion-input-ios .error-text.sc-ion-input-ios{display:none;color:var(--highlight-color-invalid)}.input-bottom.sc-ion-input-ios .helper-text.sc-ion-input-ios{display:block;color:var(--ion-color-step-550, #737373)}.ion-touched.ion-invalid.sc-ion-input-ios-h .input-bottom.sc-ion-input-ios .error-text.sc-ion-input-ios{display:block}.ion-touched.ion-invalid.sc-ion-input-ios-h .input-bottom.sc-ion-input-ios .helper-text.sc-ion-input-ios{display:none}.input-bottom.sc-ion-input-ios .counter.sc-ion-input-ios{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}.has-focus.sc-ion-input-ios-h input.sc-ion-input-ios{caret-color:var(--highlight-color)}.label-text-wrapper.sc-ion-input-ios{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;max-width:200px;-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);pointer-events:none}.label-text.sc-ion-input-ios,.sc-ion-input-ios-s>[slot=label]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.label-text-wrapper-hidden.sc-ion-input-ios,.input-outline-notch-hidden.sc-ion-input-ios{display:none}.input-wrapper.sc-ion-input-ios input.sc-ion-input-ios{-webkit-transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.input-label-placement-start.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios{-ms-flex-direction:row;flex-direction:row}.input-label-placement-start.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-end.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.input-label-placement-end.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:0;margin-inline-end:0;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-ios-h .label-text.sc-ion-input-ios{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.input-label-placement-stacked.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios,.input-label-placement-floating.sc-ion-input-ios-h .input-wrapper.sc-ion-input-ios{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:start}.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform-origin:left top;transform-origin:left top;max-width:100%}[dir=rtl].sc-ion-input-ios-h -no-combinator.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .sc-ion-input-ios-h -no-combinator.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl].input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl].sc-ion-input-ios-h -no-combinator.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .sc-ion-input-ios-h -no-combinator.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl].input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,[dir=rtl] .input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios:dir(rtl),.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.input-label-placement-stacked.sc-ion-input-ios-h input.sc-ion-input-ios,.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios{margin-left:0;margin-right:0;margin-top:1px;margin-bottom:0}.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform:translateY(100%) scale(1);transform:translateY(100%) scale(1)}.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios{opacity:0}.has-focus.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios,.has-value.input-label-placement-floating.sc-ion-input-ios-h input.sc-ion-input-ios{opacity:1}.input-label-placement-stacked.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,.has-focus.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios,.has-value.input-label-placement-floating.sc-ion-input-ios-h .label-text-wrapper.sc-ion-input-ios{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);max-width:calc(100% / 0.75)}.sc-ion-input-ios-h{--border-width:0.55px;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));font-size:inherit}.legacy-input.sc-ion-input-ios-h{--padding-top:10px;--padding-end:8px;--padding-bottom:10px;--padding-start:0}.item-label-stacked.sc-ion-input-ios-h,.item-label-stacked .sc-ion-input-ios-h,.item-label-floating.sc-ion-input-ios-h,.item-label-floating .sc-ion-input-ios-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0px}.input-clear-icon.sc-ion-input-ios ion-icon.sc-ion-input-ios{width:18px;height:18px}.sc-ion-input-ios-h:not(.legacy-input){min-height:44px}.input-label-placement-floating.sc-ion-input-ios-h,.input-label-placement-stacked.sc-ion-input-ios-h{min-height:56px}.legacy-input.sc-ion-input-ios-h .native-input[disabled].sc-ion-input-ios,.input-disabled.sc-ion-input-ios-h{opacity:0.3}",_X=".sc-ion-input-md-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:0.6;--padding-top:0px;--padding-end:0px;--padding-bottom:0px;--padding-start:0px;--background:transparent;--color:initial;--border-style:solid;--highlight-color-focused:var(--ion-color-primary, #3880ff);--highlight-color-valid:var(--ion-color-success, #2dd36f);--highlight-color-invalid:var(--ion-color-danger, #eb445a);--highlight-color:var(--highlight-color-focused);display:block;position:relative;width:100%;padding:0 !important;color:var(--color);font-family:var(--ion-font-family, inherit);z-index:2}.legacy-input.sc-ion-input-md-h{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;background:var(--background)}.legacy-input.sc-ion-input-md-h .native-input.sc-ion-input-md{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius)}ion-item.sc-ion-input-md-h:not(.item-label):not(.item-has-modern-input),ion-item:not(.item-label):not(.item-has-modern-input) .sc-ion-input-md-h{--padding-start:0}ion-item[slot=start].sc-ion-input-md-h,ion-item [slot=start].sc-ion-input-md-h,ion-item[slot=end].sc-ion-input-md-h,ion-item [slot=end].sc-ion-input-md-h{width:auto}.legacy-input.ion-color.sc-ion-input-md-h{color:var(--ion-color-base)}.ion-color.sc-ion-input-md-h{--highlight-color-focused:var(--ion-color-base)}.native-input.sc-ion-input-md{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:inline-block;position:relative;-ms-flex:1;flex:1;width:100%;max-width:100%;max-height:100%;border:0;outline:none;background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none;z-index:1}.native-input.sc-ion-input-md::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.native-input.sc-ion-input-md:-webkit-autofill{background-color:transparent}.native-input.sc-ion-input-md:invalid{-webkit-box-shadow:none;box-shadow:none}.native-input.sc-ion-input-md::-ms-clear{display:none}.cloned-input.sc-ion-input-md{top:0;bottom:0;position:absolute;pointer-events:none}@supports (inset-inline-start: 0){.cloned-input.sc-ion-input-md{inset-inline-start:0}}@supports not (inset-inline-start: 0){.cloned-input.sc-ion-input-md{left:0}[dir=rtl].sc-ion-input-md-h .cloned-input.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h .cloned-input.sc-ion-input-md{left:unset;right:unset;right:0}[dir=rtl].sc-ion-input-md .cloned-input.sc-ion-input-md{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.cloned-input.sc-ion-input-md:dir(rtl){left:unset;right:unset;right:0}}}.cloned-input.sc-ion-input-md:disabled{opacity:1}.legacy-input.sc-ion-input-md-h .input-clear-icon.sc-ion-input-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}.input-clear-icon.sc-ion-input-md{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:auto;margin-bottom:auto;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;background-position:center;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:30px;height:30px;border:0;outline:none;background-color:transparent;background-repeat:no-repeat;color:var(--ion-color-step-600, #666666);visibility:hidden;-webkit-appearance:none;-moz-appearance:none;appearance:none}.in-item-color.sc-ion-input-md-h .input-clear-icon.sc-ion-input-md{color:inherit}.input-clear-icon.sc-ion-input-md:focus{opacity:0.5}.has-value.sc-ion-input-md-h .input-clear-icon.sc-ion-input-md{visibility:visible}.has-focus.sc-ion-input-md-h{pointer-events:none}.has-focus.sc-ion-input-md-h input.sc-ion-input-md,.has-focus.sc-ion-input-md-h a.sc-ion-input-md,.has-focus.sc-ion-input-md-h button.sc-ion-input-md{pointer-events:auto}.item-label-floating.item-has-placeholder.sc-ion-input-md-h:not(.item-has-value),.item-label-floating.item-has-placeholder:not(.item-has-value) .sc-ion-input-md-h{opacity:0}.item-label-floating.item-has-placeholder.sc-ion-input-md-h:not(.item-has-value).item-has-focus,.item-label-floating.item-has-placeholder:not(.item-has-value).item-has-focus .sc-ion-input-md-h{-webkit-transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 0.15s cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.input-wrapper.sc-ion-input-md{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);border-radius:var(--border-radius);display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;-ms-flex-align:stretch;align-items:stretch;height:inherit;min-height:inherit;-webkit-transition:background-color 15ms linear;transition:background-color 15ms linear;background:var(--background);line-height:normal}.native-wrapper.sc-ion-input-md{display:-ms-flexbox;display:flex;position:relative;-ms-flex-positive:1;flex-grow:1;width:100%}.ion-touched.ion-invalid.sc-ion-input-md-h{--highlight-color:var(--highlight-color-invalid)}.ion-valid.sc-ion-input-md-h{--highlight-color:var(--highlight-color-valid)}.input-bottom.sc-ion-input-md{-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:5px;padding-bottom:0;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;border-top:var(--border-width) var(--border-style) var(--border-color);font-size:12px}.has-focus.ion-valid.sc-ion-input-md-h,.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}.input-bottom.sc-ion-input-md .error-text.sc-ion-input-md{display:none;color:var(--highlight-color-invalid)}.input-bottom.sc-ion-input-md .helper-text.sc-ion-input-md{display:block;color:var(--ion-color-step-550, #737373)}.ion-touched.ion-invalid.sc-ion-input-md-h .input-bottom.sc-ion-input-md .error-text.sc-ion-input-md{display:block}.ion-touched.ion-invalid.sc-ion-input-md-h .input-bottom.sc-ion-input-md .helper-text.sc-ion-input-md{display:none}.input-bottom.sc-ion-input-md .counter.sc-ion-input-md{-webkit-margin-start:auto;margin-inline-start:auto;color:var(--ion-color-step-550, #737373);white-space:nowrap;-webkit-padding-start:16px;padding-inline-start:16px}.has-focus.sc-ion-input-md-h input.sc-ion-input-md{caret-color:var(--highlight-color)}.label-text-wrapper.sc-ion-input-md{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;max-width:200px;-webkit-transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:color 150ms cubic-bezier(0.4, 0, 0.2, 1), transform 150ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1);pointer-events:none}.label-text.sc-ion-input-md,.sc-ion-input-md-s>[slot=label]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.label-text-wrapper-hidden.sc-ion-input-md,.input-outline-notch-hidden.sc-ion-input-md{display:none}.input-wrapper.sc-ion-input-md input.sc-ion-input-md{-webkit-transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1);transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.input-label-placement-start.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{-ms-flex-direction:row;flex-direction:row}.input-label-placement-start.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-end.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.input-label-placement-end.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:0;margin-inline-end:0;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:0;margin-bottom:0}.input-label-placement-fixed.sc-ion-input-md-h .label-text.sc-ion-input-md{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.input-label-placement-stacked.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,.input-label-placement-floating.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:start}.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:left top;transform-origin:left top;max-width:100%}[dir=rtl].sc-ion-input-md-h -no-combinator.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].sc-ion-input-md-h -no-combinator.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl),.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.input-label-placement-stacked.sc-ion-input-md-h input.sc-ion-input-md,.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{margin-left:0;margin-right:0;margin-top:1px;margin-bottom:0}.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform:translateY(100%) scale(1);transform:translateY(100%) scale(1)}.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{opacity:0}.has-focus.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md,.has-value.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{opacity:1}.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-focus.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-value.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform:translateY(50%) scale(0.75);transform:translateY(50%) scale(0.75);max-width:calc(100% / 0.75)}.input-fill-solid.sc-ion-input-md-h{--background:var(--ion-color-step-50, #f2f2f2);--border-color:var(--ion-color-step-500, gray);--border-radius:4px;--padding-start:16px;--padding-end:16px}.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-bottom:var(--border-width) var(--border-style) var(--border-color)}.has-focus.input-fill-solid.ion-valid.sc-ion-input-md-h,.input-fill-solid.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}.input-fill-solid.sc-ion-input-md-h .input-bottom.sc-ion-input-md{border-top:none}@media (any-hover: hover){.input-fill-solid.sc-ion-input-md-h:hover{--background:var(--ion-color-step-100, #e6e6e6);--border-color:var(--ion-color-step-750, #404040)}}.input-fill-solid.has-focus.sc-ion-input-md-h{--background:var(--ion-color-step-150, #d9d9d9);--border-color:var(--ion-color-step-750, #404040)}.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0px;border-bottom-left-radius:0px}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,[dir=rtl].input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md,[dir=rtl] .input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0px;border-bottom-left-radius:0px}@supports selector(:dir(rtl)){.input-fill-solid.sc-ion-input-md-h .input-wrapper.sc-ion-input-md:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0px;border-bottom-left-radius:0px}}.input-fill-solid.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-focus.input-fill-solid.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-value.input-fill-solid.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{max-width:calc(100% / 0.75)}.input-fill-outline.sc-ion-input-md-h{--border-color:var(--ion-color-step-300, #b3b3b3);--border-radius:4px;--padding-start:16px;--padding-end:16px}.input-fill-outline.input-shape-round.sc-ion-input-md-h{--border-radius:28px;--padding-start:32px;--padding-end:32px}.has-focus.input-fill-outline.ion-valid.sc-ion-input-md-h,.input-fill-outline.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}@media (any-hover: hover){.input-fill-outline.sc-ion-input-md-h:hover{--border-color:var(--ion-color-step-750, #404040)}}.input-fill-outline.has-focus.sc-ion-input-md-h{--border-width:2px;--border-color:var(--highlight-color)}.input-fill-outline.sc-ion-input-md-h .input-bottom.sc-ion-input-md{border-top:none}.input-fill-outline.sc-ion-input-md-h .input-wrapper.sc-ion-input-md{border-bottom:none}.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:left top;transform-origin:left top;position:absolute;max-width:calc(100% - var(--padding-start) - var(--padding-end))}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl].input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,[dir=rtl] .input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform-origin:right top;transform-origin:right top}@supports selector(:dir(rtl)){.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl),.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md:dir(rtl){-webkit-transform-origin:right top;transform-origin:right top}}.input-fill-outline.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{position:relative;z-index:1}.has-focus.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-value.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{-webkit-transform:translateY(-32%) scale(0.75);transform:translateY(-32%) scale(0.75);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;max-width:calc((100% - var(--padding-start) - var(--padding-end) - 8px) / 0.75)}.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h input.sc-ion-input-md,.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h input.sc-ion-input-md{margin-left:0;margin-right:0;margin-top:6px;margin-bottom:6px}.input-fill-outline.sc-ion-input-md-h .input-outline-container.sc-ion-input-md{left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;width:100%;height:100%}.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{pointer-events:none}.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,.input-fill-outline.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md,.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{border-top:var(--border-width) var(--border-style) var(--border-color);border-bottom:var(--border-width) var(--border-style) var(--border-color)}.input-fill-outline.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md{max-width:calc(100% - var(--padding-start) - var(--padding-end))}.input-fill-outline.sc-ion-input-md-h .notch-spacer.sc-ion-input-md{-webkit-padding-end:8px;padding-inline-end:8px;font-size:calc(1em * 0.75);opacity:0;pointer-events:none;-webkit-box-sizing:content-box;box-sizing:content-box}.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:var(--border-radius);-webkit-border-start:var(--border-width) var(--border-style) var(--border-color);border-inline-start:var(--border-width) var(--border-style) var(--border-color);width:calc(var(--padding-start) - 4px)}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,[dir=rtl].input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md,[dir=rtl] .input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md{border-top-left-radius:0px;border-top-right-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-bottom-left-radius:0px}@supports selector(:dir(rtl)){.input-fill-outline.sc-ion-input-md-h .input-outline-start.sc-ion-input-md:dir(rtl){border-top-left-radius:0px;border-top-right-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-bottom-left-radius:0px}}.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{-webkit-border-end:var(--border-width) var(--border-style) var(--border-color);border-inline-end:var(--border-width) var(--border-style) var(--border-color);border-top-left-radius:0px;border-top-right-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-bottom-left-radius:0px;-ms-flex-positive:1;flex-grow:1}[dir=rtl].sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md,[dir=rtl].input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md,[dir=rtl] .input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md{border-top-left-radius:var(--border-radius);border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:var(--border-radius)}@supports selector(:dir(rtl)){.input-fill-outline.sc-ion-input-md-h .input-outline-end.sc-ion-input-md:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:0px;border-bottom-right-radius:0px;border-bottom-left-radius:var(--border-radius)}}.has-focus.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md,.has-value.input-fill-outline.input-label-placement-floating.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md,.input-fill-outline.input-label-placement-stacked.sc-ion-input-md-h .input-outline-notch.sc-ion-input-md{border-top:none}.sc-ion-input-md-h{--border-width:1px;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));font-size:inherit}.legacy-input.sc-ion-input-md-h{--padding-top:10px;--padding-end:0;--padding-bottom:10px;--padding-start:8px}.item-label-stacked.sc-ion-input-md-h,.item-label-stacked .sc-ion-input-md-h,.item-label-floating.sc-ion-input-md-h,.item-label-floating .sc-ion-input-md-h{--padding-top:8px;--padding-bottom:8px;--padding-start:0}.input-clear-icon.sc-ion-input-md ion-icon.sc-ion-input-md{width:22px;height:22px}.legacy-input.sc-ion-input-md-h .native-input[disabled].sc-ion-input-md,.input-disabled.sc-ion-input-md-h{opacity:0.38}.has-focus.ion-valid.sc-ion-input-md-h,.ion-touched.ion-invalid.sc-ion-input-md-h{--border-color:var(--highlight-color)}.input-bottom.sc-ion-input-md .counter.sc-ion-input-md{letter-spacing:0.0333333333em}.sc-ion-input-md-h:not(.legacy-input){min-height:56px}.input-label-placement-floating.has-focus.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-stacked.has-focus.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{color:var(--highlight-color)}.has-focus.input-label-placement-floating.ion-valid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-floating.ion-touched.ion-invalid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.has-focus.input-label-placement-stacked.ion-valid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md,.input-label-placement-stacked.ion-touched.ion-invalid.sc-ion-input-md-h .label-text-wrapper.sc-ion-input-md{color:var(--highlight-color)}.input-highlight.sc-ion-input-md{bottom:-1px;position:absolute;width:100%;height:2px;-webkit-transform:scale(0);transform:scale(0);-webkit-transition:-webkit-transform 200ms;transition:-webkit-transform 200ms;transition:transform 200ms;transition:transform 200ms, -webkit-transform 200ms;background:var(--highlight-color)}@supports (inset-inline-start: 0){.input-highlight.sc-ion-input-md{inset-inline-start:0}}@supports not (inset-inline-start: 0){.input-highlight.sc-ion-input-md{left:0}[dir=rtl].sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h .input-highlight.sc-ion-input-md{left:unset;right:unset;right:0}[dir=rtl].sc-ion-input-md .input-highlight.sc-ion-input-md{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.input-highlight.sc-ion-input-md:dir(rtl){left:unset;right:unset;right:0}}}.has-focus.sc-ion-input-md-h .input-highlight.sc-ion-input-md{-webkit-transform:scale(1);transform:scale(1)}.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{bottom:0}@supports (inset-inline-start: 0){.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{inset-inline-start:0}}@supports not (inset-inline-start: 0){.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{left:0}[dir=rtl].sc-ion-input-md-h -no-combinator.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl] .sc-ion-input-md-h -no-combinator.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl].in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md,[dir=rtl] .in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md{left:unset;right:unset;right:0}@supports selector(:dir(rtl)){.in-item.sc-ion-input-md-h .input-highlight.sc-ion-input-md:dir(rtl){left:unset;right:unset;right:0}}}.input-shape-round.sc-ion-input-md-h{--border-radius:16px}",xX=xr(class extends wr{constructor(){super(),this.__registerHost(),this.ionInput=Wn(this,"ionInput",7),this.ionChange=Wn(this,"ionChange",7),this.ionBlur=Wn(this,"ionBlur",7),this.ionFocus=Wn(this,"ionFocus",7),this.ionStyle=Wn(this,"ionStyle",7),this.inputId=`ion-input-${wX++}`,this.inheritedAttributes={},this.isComposing=!1,this.hasLoggedDeprecationWarning=!1,this.didInputClearOnEdit=!1,this.onInput=e=>{const n=e.target;n&&(this.value=n.value||""),this.emitInputChange(e)},this.onChange=e=>{this.emitValueChange(e)},this.onBlur=e=>{this.hasFocus=!1,this.emitStyle(),this.focusedValue!==this.value&&this.emitValueChange(e),this.didInputClearOnEdit=!1,this.ionBlur.emit(e)},this.onFocus=e=>{this.hasFocus=!0,this.focusedValue=this.value,this.emitStyle(),this.ionFocus.emit(e)},this.onKeydown=e=>{this.checkClearOnEdit(e)},this.onCompositionStart=()=>{this.isComposing=!0},this.onCompositionEnd=()=>{this.isComposing=!1},this.clearTextInput=e=>{this.clearInput&&!this.readonly&&!this.disabled&&e&&(e.preventDefault(),e.stopPropagation(),this.setFocus()),this.value="",this.emitInputChange(e)},this.hasFocus=!1,this.color=void 0,this.accept=void 0,this.autocapitalize="off",this.autocomplete="off",this.autocorrect="off",this.autofocus=!1,this.clearInput=!1,this.clearOnEdit=void 0,this.counter=!1,this.counterFormatter=void 0,this.debounce=void 0,this.disabled=!1,this.enterkeyhint=void 0,this.errorText=void 0,this.fill=void 0,this.inputmode=void 0,this.helperText=void 0,this.label=void 0,this.labelPlacement="start",this.legacy=void 0,this.max=void 0,this.maxlength=void 0,this.min=void 0,this.minlength=void 0,this.multiple=void 0,this.name=this.inputId,this.pattern=void 0,this.placeholder=void 0,this.readonly=!1,this.required=!1,this.shape=void 0,this.spellcheck=!1,this.step=void 0,this.size=void 0,this.type="text",this.value=""}debounceChanged(){const{ionInput:e,debounce:n,originalIonInput:i}=this;this.ionInput=n===void 0?i!=null?i:e:_9(e,n)}disabledChanged(){this.emitStyle()}placeholderChanged(){this.emitStyle()}valueChanged(){const e=this.nativeInput,n=this.getValue();e&&e.value!==n&&!this.isComposing&&(e.value=n),this.emitStyle()}componentWillLoad(){this.inheritedAttributes=Object.assign(Object.assign({},jv(this.el)),ym(this.el,["tabindex","title","data-form-type"]))}connectedCallback(){const{el:e}=this;this.legacyFormController=yZ(e),this.slotMutationController=gX(e,"label",()=>dx(this)),this.notchController=mX(e,()=>this.notchSpacerEl,()=>this.labelSlot),this.emitStyle(),this.debounceChanged(),document.dispatchEvent(new CustomEvent("ionInputDidLoad",{detail:this.el}))}componentDidLoad(){this.originalIonInput=this.ionInput}componentDidRender(){var e;(e=this.notchController)===null||e===void 0||e.calculateNotchWidth()}disconnectedCallback(){document.dispatchEvent(new CustomEvent("ionInputDidUnload",{detail:this.el})),this.slotMutationController&&(this.slotMutationController.destroy(),this.slotMutationController=void 0),this.notchController&&(this.notchController.destroy(),this.notchController=void 0)}async setFocus(){this.nativeInput&&this.nativeInput.focus()}getInputElement(){return Promise.resolve(this.nativeInput)}emitValueChange(e){const{value:n}=this,i=n==null?n:n.toString();this.focusedValue=i,this.ionChange.emit({value:i,event:e})}emitInputChange(e){const{value:n}=this,i=n==null?n:n.toString();this.ionInput.emit({value:i,event:e})}shouldClearOnEdit(){const{type:e,clearOnEdit:n}=this;return n===void 0?e==="password":n}getValue(){return typeof this.value=="number"?this.value.toString():(this.value||"").toString()}emitStyle(){this.legacyFormController.hasLegacyControl()&&this.ionStyle.emit({interactive:!0,input:!0,"has-placeholder":this.placeholder!==void 0,"has-value":this.hasValue(),"has-focus":this.hasFocus,"interactive-disabled":this.disabled})}checkClearOnEdit(e){this.shouldClearOnEdit()&&(!this.didInputClearOnEdit&&this.hasValue()&&e.key!=="Enter"&&(this.value="",this.emitInputChange(e)),this.didInputClearOnEdit=!0)}hasValue(){return this.getValue().length>0}renderHintText(){const{helperText:e,errorText:n}=this;return[Rt("div",{class:"helper-text"},e),Rt("div",{class:"error-text"},n)]}renderCounter(){const{counter:e,maxlength:n,counterFormatter:i,value:r}=this;if(!(e!==!0||n===void 0))return Rt("div",{class:"counter"},yX(r,n,i))}renderBottomContent(){const{counter:e,helperText:n,errorText:i,maxlength:r}=this;if(!(!(n||i)&&!(e===!0&&r!==void 0)))return Rt("div",{class:"input-bottom"},this.renderHintText(),this.renderCounter())}renderLabel(){const{label:e}=this;return Rt("div",{class:{"label-text-wrapper":!0,"label-text-wrapper-hidden":!this.hasLabel}},e===void 0?Rt("slot",{name:"label"}):Rt("div",{class:"label-text"},e))}get labelSlot(){return this.el.querySelector('[slot="label"]')}get hasLabel(){return this.label!==void 0||this.labelSlot!==null}renderLabelContainer(){return Xn(this)==="md"&&this.fill==="outline"?[Rt("div",{class:"input-outline-container"},Rt("div",{class:"input-outline-start"}),Rt("div",{class:{"input-outline-notch":!0,"input-outline-notch-hidden":!this.hasLabel}},Rt("div",{class:"notch-spacer","aria-hidden":"true",ref:i=>this.notchSpacerEl=i},this.label)),Rt("div",{class:"input-outline-end"})),this.renderLabel()]:this.renderLabel()}renderInput(){const{disabled:e,fill:n,readonly:i,shape:r,inputId:a,labelPlacement:d}=this,o=Xn(this),f=this.getValue(),g=Ka("ion-item",this.el),_=o==="md"&&n!=="outline"&&!g;return Rt(_r,{class:Ml(this.color,{[o]:!0,"has-value":this.hasValue(),"has-focus":this.hasFocus,[`input-fill-${n}`]:n!==void 0,[`input-shape-${r}`]:r!==void 0,[`input-label-placement-${d}`]:!0,"in-item":g,"in-item-color":Ka("ion-item.ion-color",this.el),"input-disabled":e})},Rt("label",{class:"input-wrapper"},this.renderLabelContainer(),Rt("div",{class:"native-wrapper"},Rt("input",Object.assign({class:"native-input",ref:w=>this.nativeInput=w,id:a,disabled:e,accept:this.accept,autoCapitalize:this.autocapitalize,autoComplete:this.autocomplete,autoCorrect:this.autocorrect,autoFocus:this.autofocus,enterKeyHint:this.enterkeyhint,inputMode:this.inputmode,min:this.min,max:this.max,minLength:this.minlength,maxLength:this.maxlength,multiple:this.multiple,name:this.name,pattern:this.pattern,placeholder:this.placeholder||"",readOnly:i,required:this.required,spellcheck:this.spellcheck,step:this.step,size:this.size,type:this.type,value:f,onInput:this.onInput,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeydown,onCompositionstart:this.onCompositionStart,onCompositionend:this.onCompositionEnd},this.inheritedAttributes)),this.clearInput&&!i&&!e&&Rt("button",{"aria-label":"reset",type:"button",class:"input-clear-icon",onPointerDown:w=>{w.preventDefault()},onClick:this.clearTextInput},Rt("ion-icon",{"aria-hidden":"true",icon:o==="ios"?wR:SR}))),_&&Rt("div",{class:"input-highlight"})),this.renderBottomContent())}renderLegacyInput(){this.hasLoggedDeprecationWarning||(gs(`ion-input now requires providing a label with either the "label" property or the "aria-label" attribute. To migrate, remove any usage of "ion-label" and pass the label text to either the "label" property or the "aria-label" attribute.

Example: <ion-input label="Email"></ion-input>
Example with aria-label: <ion-input aria-label="Email"></ion-input>

For inputs that do not render the label immediately next to the input, developers may continue to use "ion-label" but must manually associate the label with the input by using "aria-labelledby".

Developers can use the "legacy" property to continue using the legacy form markup. This property will be removed in an upcoming major release of Ionic where this form control will use the modern form markup.`,this.el),this.legacy&&gs(`ion-input is being used with the "legacy" property enabled which will forcibly enable the legacy form markup. This property will be removed in an upcoming major release of Ionic where this form control will use the modern form markup.

Developers can dismiss this warning by removing their usage of the "legacy" property and using the new input syntax.`,this.el),this.hasLoggedDeprecationWarning=!0);const e=Xn(this),n=this.getValue(),i=this.inputId+"-lbl",r=oN(this.el);return r&&(r.id=i),Rt(_r,{"aria-disabled":this.disabled?"true":null,class:Ml(this.color,{[e]:!0,"has-value":this.hasValue(),"has-focus":this.hasFocus,"legacy-input":!0,"in-item-color":Ka("ion-item.ion-color",this.el)})},Rt("input",Object.assign({class:"native-input",ref:a=>this.nativeInput=a,"aria-labelledby":r?r.id:null,disabled:this.disabled,accept:this.accept,autoCapitalize:this.autocapitalize,autoComplete:this.autocomplete,autoCorrect:this.autocorrect,autoFocus:this.autofocus,enterKeyHint:this.enterkeyhint,inputMode:this.inputmode,min:this.min,max:this.max,minLength:this.minlength,maxLength:this.maxlength,multiple:this.multiple,name:this.name,pattern:this.pattern,placeholder:this.placeholder||"",readOnly:this.readonly,required:this.required,spellcheck:this.spellcheck,step:this.step,size:this.size,type:this.type,value:n,onInput:this.onInput,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeydown},this.inheritedAttributes)),this.clearInput&&!this.readonly&&!this.disabled&&Rt("button",{"aria-label":"reset",type:"button",class:"input-clear-icon",onPointerDown:a=>{a.preventDefault()},onClick:this.clearTextInput},Rt("ion-icon",{"aria-hidden":"true",icon:e==="ios"?wR:SR})))}render(){const{legacyFormController:e}=this;return e.hasLegacyControl()?this.renderLegacyInput():this.renderInput()}get el(){return this}static get watchers(){return{debounce:["debounceChanged"],disabled:["disabledChanged"],placeholder:["placeholderChanged"],value:["valueChanged"]}}static get style(){return{ios:bX,md:_X}}},[38,"ion-input",{color:[513],accept:[1],autocapitalize:[1],autocomplete:[1],autocorrect:[1],autofocus:[4],clearInput:[4,"clear-input"],clearOnEdit:[4,"clear-on-edit"],counter:[4],counterFormatter:[16],debounce:[2],disabled:[4],enterkeyhint:[1],errorText:[1,"error-text"],fill:[1],inputmode:[1],helperText:[1,"helper-text"],label:[1],labelPlacement:[1,"label-placement"],legacy:[4],max:[8],maxlength:[2],min:[8],minlength:[2],multiple:[4],name:[1],pattern:[1],placeholder:[1],readonly:[4],required:[4],shape:[1],spellcheck:[4],step:[1],size:[2],type:[1],value:[1032],hasFocus:[32],setFocus:[64],getInputElement:[64]}]);let wX=0;function SX(){if(typeof customElements>"u")return;["ion-input","ion-icon"].forEach(e=>{switch(e){case"ion-input":customElements.get(e)||customElements.define(e,xX);break;case"ion-icon":customElements.get(e)||eZ();break}})}const EX=SX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const kX=qZ,TX=":host{--width:304px;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--background:var(--ion-background-color, #fff);left:0;right:0;top:0;bottom:0;display:none;position:absolute;contain:strict}:host(.show-menu){display:block}.menu-inner{-webkit-transform:translateX(-9999px);transform:translateX(-9999px);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:strict}:host(.menu-side-start) .menu-inner{--ion-safe-area-right:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{inset-inline-start:0;inset-inline-end:auto}}@supports not (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{left:0;right:auto}:host-context([dir=rtl]):host(.menu-side-start) .menu-inner,:host-context([dir=rtl]).menu-side-start .menu-inner{left:unset;right:unset;left:auto;right:0}@supports selector(:dir(rtl)){:host(.menu-side-start) .menu-inner:dir(rtl){left:unset;right:unset;left:auto;right:0}}}:host(.menu-side-end) .menu-inner{--ion-safe-area-left:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{inset-inline-start:auto;inset-inline-end:0}}@supports not (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{left:auto;right:0}:host-context([dir=rtl]):host(.menu-side-end) .menu-inner,:host-context([dir=rtl]).menu-side-end .menu-inner{left:unset;right:unset;left:0;right:auto}@supports selector(:dir(rtl)){:host(.menu-side-end) .menu-inner:dir(rtl){left:unset;right:unset;left:0;right:auto}}}ion-backdrop{display:none;opacity:0.01;z-index:-1}@media (max-width: 340px){.menu-inner{--width:264px}}:host(.menu-type-reveal){z-index:0}:host(.menu-type-reveal.show-menu) .menu-inner{-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0)}:host(.menu-type-overlay){z-index:1000}:host(.menu-type-overlay) .show-backdrop{display:block;cursor:pointer}:host(.menu-pane-visible){width:var(--width);min-width:var(--min-width);max-width:var(--max-width)}:host(.menu-pane-visible) .menu-inner{left:0;right:0;width:auto;-webkit-transform:none !important;transform:none !important;-webkit-box-shadow:none !important;box-shadow:none !important}:host(.menu-pane-visible) ion-backdrop{display:hidden !important;}:host(.menu-type-push){z-index:1000}:host(.menu-type-push) .show-backdrop{display:block}",CX=":host{--width:304px;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--background:var(--ion-background-color, #fff);left:0;right:0;top:0;bottom:0;display:none;position:absolute;contain:strict}:host(.show-menu){display:block}.menu-inner{-webkit-transform:translateX(-9999px);transform:translateX(-9999px);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:strict}:host(.menu-side-start) .menu-inner{--ion-safe-area-right:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{inset-inline-start:0;inset-inline-end:auto}}@supports not (inset-inline-start: 0){:host(.menu-side-start) .menu-inner{left:0;right:auto}:host-context([dir=rtl]):host(.menu-side-start) .menu-inner,:host-context([dir=rtl]).menu-side-start .menu-inner{left:unset;right:unset;left:auto;right:0}@supports selector(:dir(rtl)){:host(.menu-side-start) .menu-inner:dir(rtl){left:unset;right:unset;left:auto;right:0}}}:host(.menu-side-end) .menu-inner{--ion-safe-area-left:0px;top:0;bottom:0}@supports (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{inset-inline-start:auto;inset-inline-end:0}}@supports not (inset-inline-start: 0){:host(.menu-side-end) .menu-inner{left:auto;right:0}:host-context([dir=rtl]):host(.menu-side-end) .menu-inner,:host-context([dir=rtl]).menu-side-end .menu-inner{left:unset;right:unset;left:0;right:auto}@supports selector(:dir(rtl)){:host(.menu-side-end) .menu-inner:dir(rtl){left:unset;right:unset;left:0;right:auto}}}ion-backdrop{display:none;opacity:0.01;z-index:-1}@media (max-width: 340px){.menu-inner{--width:264px}}:host(.menu-type-reveal){z-index:0}:host(.menu-type-reveal.show-menu) .menu-inner{-webkit-transform:translate3d(0,  0,  0);transform:translate3d(0,  0,  0)}:host(.menu-type-overlay){z-index:1000}:host(.menu-type-overlay) .show-backdrop{display:block;cursor:pointer}:host(.menu-pane-visible){width:var(--width);min-width:var(--min-width);max-width:var(--max-width)}:host(.menu-pane-visible) .menu-inner{left:0;right:0;width:auto;-webkit-transform:none !important;transform:none !important;-webkit-box-shadow:none !important;box-shadow:none !important}:host(.menu-pane-visible) ion-backdrop{display:hidden !important;}:host(.menu-type-overlay) .menu-inner{-webkit-box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18);box-shadow:4px 0px 16px rgba(0, 0, 0, 0.18)}",IX="cubic-bezier(0.32,0.72,0,1)",AX="cubic-bezier(0.0,0.0,0.2,1)",MX="cubic-bezier(1, 0, 0.68, 0.28)",PX="cubic-bezier(0.4, 0, 0.6, 1)",OR='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .ion-focusable:not([tabindex^="-"])',OX=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionWillOpen=Wn(this,"ionWillOpen",7),this.ionWillClose=Wn(this,"ionWillClose",7),this.ionDidOpen=Wn(this,"ionDidOpen",7),this.ionDidClose=Wn(this,"ionDidClose",7),this.ionMenuChange=Wn(this,"ionMenuChange",7),this.lastOnEnd=0,this.blocker=I1.createBlocker({disableScroll:!0}),this.isAnimating=!1,this._isOpen=!1,this.inheritedAttributes={},this.handleFocus=e=>{const n=mx(document);n&&!n.contains(this.el)||this.trapKeyboardFocus(e,document)},this.isPaneVisible=!1,this.isEndSide=!1,this.contentId=void 0,this.menuId=void 0,this.type=void 0,this.disabled=!1,this.side="start",this.swipeGesture=!0,this.maxEdgeStart=50}typeChanged(e,n){const i=this.contentEl;i&&(n!==void 0&&i.classList.remove(`menu-content-${n}`),i.classList.add(`menu-content-${e}`),i.removeAttribute("style")),this.menuInnerEl&&this.menuInnerEl.removeAttribute("style"),this.animation=void 0}disabledChanged(){this.updateState(),this.ionMenuChange.emit({disabled:this.disabled,open:this._isOpen})}sideChanged(){this.isEndSide=dR(this.side),this.animation=void 0}swipeGestureChanged(){this.updateState()}async connectedCallback(){typeof customElements<"u"&&customElements!=null&&await customElements.whenDefined("ion-menu"),this.type===void 0&&(this.type=_i.get("menuType","overlay"));const e=this.contentId!==void 0?document.getElementById(this.contentId):null;if(e===null){console.error('Menu: must have a "content" element to listen for drag events on.');return}this.el.contains(e)&&console.error(`Menu: "contentId" should refer to the main view's ion-content, not the ion-content inside of the ion-menu.`),this.contentEl=e,e.classList.add("menu-content"),this.typeChanged(this.type,void 0),this.sideChanged(),oc._register(this),this.gesture=(await Zo(()=>Promise.resolve().then(()=>Q9),void 0)).createGesture({el:document,gestureName:"menu-swipe",gesturePriority:30,threshold:10,blurOnStart:!0,canStart:n=>this.canStart(n),onWillStart:()=>this.onWillStart(),onStart:()=>this.onStart(),onMove:n=>this.onMove(n),onEnd:n=>this.onEnd(n)}),this.updateState()}componentWillLoad(){this.inheritedAttributes=jv(this.el)}async componentDidLoad(){this.ionMenuChange.emit({disabled:this.disabled,open:this._isOpen}),this.updateState()}async disconnectedCallback(){await this.close(!1),this.blocker.destroy(),oc._unregister(this),this.animation&&this.animation.destroy(),this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.animation=void 0,this.contentEl=void 0}onSplitPaneChanged(e){this.isPaneVisible=e.detail.isPane(this.el),this.updateState()}onBackdropClick(e){this._isOpen&&this.lastOnEnd<e.timeStamp-100&&(e.composedPath&&!e.composedPath().includes(this.menuInnerEl))&&(e.preventDefault(),e.stopPropagation(),this.close())}onKeydown(e){e.key==="Escape"&&this.close()}isOpen(){return Promise.resolve(this._isOpen)}isActive(){return Promise.resolve(this._isActive())}open(e=!0){return this.setOpen(!0,e)}close(e=!0){return this.setOpen(!1,e)}toggle(e=!0){return this.setOpen(!this._isOpen,e)}setOpen(e,n=!0){return oc._setOpen(this,e,n)}focusFirstDescendant(){const{el:e}=this,n=e.querySelector(OR);n?n.focus():e.focus()}focusLastDescendant(){const{el:e}=this,n=Array.from(e.querySelectorAll(OR)),i=n.length>0?n[n.length-1]:null;i?i.focus():e.focus()}trapKeyboardFocus(e,n){const i=e.target;i&&(this.el.contains(i)?this.lastFocus=i:(this.focusFirstDescendant(),this.lastFocus===n.activeElement&&this.focusLastDescendant()))}async _setOpen(e,n=!0){return!this._isActive()||this.isAnimating||e===this._isOpen?!1:(this.beforeAnimation(e),await this.loadAnimation(),await this.startAnimation(e,n),this.afterAnimation(e),!0)}async loadAnimation(){const e=this.menuInnerEl.offsetWidth,n=dR(this.side);e===this.width&&this.animation!==void 0&&n===this.isEndSide||(this.width=e,this.isEndSide=n,this.animation&&(this.animation.destroy(),this.animation=void 0),this.animation=await oc._createAnimation(this.type,this),_i.getBoolean("animated",!0)||this.animation.duration(0),this.animation.fill("both"))}async startAnimation(e,n){const i=!e,r=Xn(this),a=r==="ios"?IX:AX,d=r==="ios"?MX:PX,o=this.animation.direction(i?"reverse":"normal").easing(i?d:a).onFinish(()=>{o.getDirection()==="reverse"&&o.direction("normal")});n?await o.play():o.play({sync:!0})}_isActive(){return!this.disabled&&!this.isPaneVisible}canSwipe(){return this.swipeGesture&&!this.isAnimating&&this._isActive()}canStart(e){return!!document.querySelector("ion-modal.show-modal")||!this.canSwipe()?!1:this._isOpen?!0:oc._getOpenSync()?!1:DX(window,e.currentX,this.isEndSide,this.maxEdgeStart)}onWillStart(){return this.beforeAnimation(!this._isOpen),this.loadAnimation()}onStart(){if(!this.isAnimating||!this.animation){Mr(!1,"isAnimating has to be true");return}this.animation.progressStart(!0,this._isOpen?1:0)}onMove(e){if(!this.isAnimating||!this.animation){Mr(!1,"isAnimating has to be true");return}const i=DR(e.deltaX,this._isOpen,this.isEndSide)/this.width;this.animation.progressStep(this._isOpen?1-i:i)}onEnd(e){if(!this.isAnimating||!this.animation){Mr(!1,"isAnimating has to be true");return}const n=this._isOpen,i=this.isEndSide,r=DR(e.deltaX,n,i),a=this.width,d=r/a,o=e.velocityX,f=a/2,g=o>=0&&(o>.2||e.deltaX>f),_=o<=0&&(o<-.2||e.deltaX<-f),w=n?i?g:_:i?_:g;let T=!n&&w;n&&!w&&(T=!0),this.lastOnEnd=e.currentTime;let A=w?.001:-.001;const D=d<0?.01:d;A+=kh([0,0],[.4,0],[.6,1],[1,1],Eh(0,D,.9999))[0]||0;const z=this._isOpen?!w:w;this.animation.easing("cubic-bezier(0.4, 0.0, 0.6, 1)").onFinish(()=>this.afterAnimation(T),{oneTimeCallback:!0}).progressEnd(z?1:0,this._isOpen?1-A:A,300)}beforeAnimation(e){Mr(!this.isAnimating,"_before() should not be called while animating"),this.el.classList.add(RR),this.el.setAttribute("tabindex","0"),this.backdropEl&&this.backdropEl.classList.add(LR),this.contentEl&&(this.contentEl.classList.add(zR),this.contentEl.setAttribute("aria-hidden","true")),this.blocker.block(),this.isAnimating=!0,e?this.ionWillOpen.emit():this.ionWillClose.emit()}afterAnimation(e){var n;Mr(this.isAnimating,"_before() should be called while animating"),this._isOpen=e,this.isAnimating=!1,this._isOpen||this.blocker.unblock(),e?(this.ionDidOpen.emit(),((n=document.activeElement)===null||n===void 0?void 0:n.closest("ion-menu"))!==this.el&&this.el.focus(),document.addEventListener("focus",this.handleFocus,!0)):(this.el.classList.remove(RR),this.el.removeAttribute("tabindex"),this.contentEl&&(this.contentEl.classList.remove(zR),this.contentEl.removeAttribute("aria-hidden")),this.backdropEl&&this.backdropEl.classList.remove(LR),this.animation&&this.animation.stop(),this.ionDidClose.emit(),document.removeEventListener("focus",this.handleFocus,!0))}updateState(){const e=this._isActive();this.gesture&&this.gesture.enable(e&&this.swipeGesture),!e&&this._isOpen&&this.forceClosing(),this.disabled||oc._setActiveMenu(this),Mr(!this.isAnimating,"can not be animating")}forceClosing(){Mr(this._isOpen,"menu cannot be closed"),this.isAnimating=!0,this.animation.direction("reverse").play({sync:!0}),this.afterAnimation(!1)}render(){const{type:e,disabled:n,isPaneVisible:i,inheritedAttributes:r,side:a}=this,d=Xn(this);return Rt(_r,{role:"navigation","aria-label":r["aria-label"]||"menu",class:{[d]:!0,[`menu-type-${e}`]:!0,"menu-enabled":!n,[`menu-side-${a}`]:!0,"menu-pane-visible":i}},Rt("div",{class:"menu-inner",part:"container",ref:o=>this.menuInnerEl=o},Rt("slot",null)),Rt("ion-backdrop",{ref:o=>this.backdropEl=o,class:"menu-backdrop",tappable:!1,stopPropagation:!1,part:"backdrop"}))}get el(){return this}static get watchers(){return{type:["typeChanged"],disabled:["disabledChanged"],side:["sideChanged"],swipeGesture:["swipeGestureChanged"]}}static get style(){return{ios:TX,md:CX}}},[33,"ion-menu",{contentId:[513,"content-id"],menuId:[513,"menu-id"],type:[1025],disabled:[1028],side:[513],swipeGesture:[4,"swipe-gesture"],maxEdgeStart:[2,"max-edge-start"],isPaneVisible:[32],isEndSide:[32],isOpen:[64],isActive:[64],open:[64],close:[64],toggle:[64],setOpen:[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]]),DR=(t,e,n)=>Math.max(0,e!==n?-t:t),DX=(t,e,n,i)=>n?e>=t.innerWidth-i:e<=i,RR="show-menu",LR="show-backdrop",zR="menu-content-open";function RX(){if(typeof customElements>"u")return;["ion-menu","ion-backdrop"].forEach(e=>{switch(e){case"ion-menu":customElements.get(e)||customElements.define(e,OX);break;case"ion-backdrop":customElements.get(e)||MN();break}})}const LX=RX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const zX=async t=>{const e=await oc.get(t);return!!(e&&await e.isActive())};/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const BX=":host(.menu-toggle-hidden){display:none}",FX=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.onClick=()=>oc.toggle(this.menu),this.visible=!1,this.menu=void 0,this.autoHide=!0}connectedCallback(){this.visibilityChanged()}async visibilityChanged(){this.visible=await zX(this.menu)}render(){const e=Xn(this),n=this.autoHide&&!this.visible;return Rt(_r,{onClick:this.onClick,"aria-hidden":n?"true":null,class:{[e]:!0,"menu-toggle-hidden":n}},Rt("slot",null))}static get style(){return BX}},[1,"ion-menu-toggle",{menu:[1],autoHide:[4,"auto-hide"],visible:[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]);function NX(){if(typeof customElements>"u")return;["ion-menu-toggle"].forEach(e=>{switch(e){case"ion-menu-toggle":customElements.get(e)||customElements.define(e,FX);break}})}const $X=NX,zN=1,BN=2,yx=3;class qT{constructor(e,n){this.component=e,this.params=n,this.state=zN}async init(e){if(this.state=BN,!this.element){const n=this.component;this.element=await kI(this.delegate,e,n,["ion-page","ion-page-invisible"],this.params)}}_destroy(){Mr(this.state!==yx,"view state must be ATTACHED");const e=this.element;e&&(this.delegate?this.delegate.removeViewFromDom(e.parentElement,e):e.remove()),this.nav=void 0,this.state=yx}}const BR=(t,e,n)=>!t||t.component!==e?!1:sN(t.params,n),FR=(t,e)=>t?t instanceof qT?t:new qT(t,e):null,jX=t=>t.map(e=>e instanceof qT?e:"component"in e?FR(e.component,e.componentProps===null?void 0:e.componentProps):FR(e,void 0)).filter(e=>e!==null),VX=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}",UX=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Wn(this,"ionNavWillLoad",7),this.ionNavWillChange=Wn(this,"ionNavWillChange",3),this.ionNavDidChange=Wn(this,"ionNavDidChange",3),this.transInstr=[],this.animationEnabled=!0,this.useRouter=!1,this.isTransitioning=!1,this.destroyed=!1,this.views=[],this.didLoad=!1,this.delegate=void 0,this.swipeGesture=void 0,this.animated=!0,this.animation=void 0,this.rootParams=void 0,this.root=void 0}swipeGestureChanged(){this.gesture&&this.gesture.enable(this.swipeGesture===!0)}rootChanged(){this.root!==void 0&&this.didLoad!==!1&&(this.useRouter||this.root!==void 0&&this.setRoot(this.root,this.rootParams))}componentWillLoad(){if(this.useRouter=document.querySelector("ion-router")!==null&&this.el.closest("[no-router]")===null,this.swipeGesture===void 0){const e=Xn(this);this.swipeGesture=_i.getBoolean("swipeBackEnabled",e==="ios")}this.ionNavWillLoad.emit()}async componentDidLoad(){this.didLoad=!0,this.rootChanged(),this.gesture=(await Zo(()=>import("./swipe-back-7655847b.js"),[])).createSwipeBackGesture(this.el,this.canStart.bind(this),this.onStart.bind(this),this.onMove.bind(this),this.onEnd.bind(this)),this.swipeGestureChanged()}connectedCallback(){this.destroyed=!1}disconnectedCallback(){for(const e of this.views)sc(e.element,LE),e._destroy();this.gesture&&(this.gesture.destroy(),this.gesture=void 0),this.transInstr.length=0,this.views.length=0,this.destroyed=!0}push(e,n,i,r){return this.insert(-1,e,n,i,r)}insert(e,n,i,r,a){return this.insertPages(e,[{component:n,componentProps:i}],r,a)}insertPages(e,n,i,r){return this.queueTrns({insertStart:e,insertViews:n,opts:i},r)}pop(e,n){return this.removeIndex(-1,1,e,n)}popTo(e,n,i){const r={removeStart:-1,removeCount:-1,opts:n};return typeof e=="object"&&e.component?(r.removeView=e,r.removeStart=1):typeof e=="number"&&(r.removeStart=e+1),this.queueTrns(r,i)}popToRoot(e,n){return this.removeIndex(1,-1,e,n)}removeIndex(e,n=1,i,r){return this.queueTrns({removeStart:e,removeCount:n,opts:i},r)}setRoot(e,n,i,r){return this.setPages([{component:e,componentProps:n}],i,r)}setPages(e,n,i){return n!=null||(n={}),n.animated!==!0&&(n.animated=!1),this.queueTrns({insertStart:0,insertViews:e,removeStart:0,removeCount:-1,opts:n},i)}setRouteId(e,n,i,r){const a=this.getActiveSync();if(BR(a,e,n))return Promise.resolve({changed:!1,element:a.element});let d;const o=new Promise(_=>d=_);let f;const g={updateURL:!1,viewIsReady:_=>{let w;const T=new Promise(A=>w=A);return d({changed:!0,element:_,markVisible:async()=>{w(),await f}}),T}};if(i==="root")f=this.setRoot(e,n,g);else{const _=this.views.find(w=>BR(w,e,n));_?f=this.popTo(_,Object.assign(Object.assign({},g),{direction:"back",animationBuilder:r})):i==="forward"?f=this.push(e,n,Object.assign(Object.assign({},g),{animationBuilder:r})):i==="back"&&(f=this.setRoot(e,n,Object.assign(Object.assign({},g),{direction:"back",animated:!0,animationBuilder:r})))}return o}async getRouteId(){const e=this.getActiveSync();if(e)return{id:e.element.tagName,params:e.params,element:e.element}}async getActive(){return this.getActiveSync()}async getByIndex(e){return this.views[e]}async canGoBack(e){return this.canGoBackSync(e)}async getPrevious(e){return this.getPreviousSync(e)}getLength(){return this.views.length}getActiveSync(){return this.views[this.views.length-1]}canGoBackSync(e=this.getActiveSync()){return!!(e&&this.getPreviousSync(e))}getPreviousSync(e=this.getActiveSync()){if(!e)return;const n=this.views,i=n.indexOf(e);return i>0?n[i-1]:void 0}async queueTrns(e,n){var i,r;if(this.isTransitioning&&(!((i=e.opts)===null||i===void 0)&&i.skipIfBusy))return!1;const a=new Promise((d,o)=>{e.resolve=d,e.reject=o});if(e.done=n,e.opts&&e.opts.updateURL!==!1&&this.useRouter){const d=document.querySelector("ion-router");if(d){const o=await d.canTransition();if(o===!1)return!1;if(typeof o=="string")return d.push(o,e.opts.direction||"back"),!1}}return((r=e.insertViews)===null||r===void 0?void 0:r.length)===0&&(e.insertViews=void 0),this.transInstr.push(e),this.nextTrns(),a}success(e,n){if(this.destroyed){this.fireError("nav controller was destroyed",n);return}if(n.done&&n.done(e.hasCompleted,e.requiresTransition,e.enteringView,e.leavingView,e.direction),n.resolve(e.hasCompleted),n.opts.updateURL!==!1&&this.useRouter){const i=document.querySelector("ion-router");if(i){const r=e.direction==="back"?"back":"forward";i.navChanged(r)}}}failed(e,n){if(this.destroyed){this.fireError("nav controller was destroyed",n);return}this.transInstr.length=0,this.fireError(e,n)}fireError(e,n){n.done&&n.done(!1,!1,e),n.reject&&!this.destroyed?n.reject(e):n.resolve(!1)}nextTrns(){if(this.isTransitioning)return!1;const e=this.transInstr.shift();return e?(this.runTransition(e),!0):!1}async runTransition(e){try{this.ionNavWillChange.emit(),this.isTransitioning=!0,this.prepareTI(e);const n=this.getActiveSync(),i=this.getEnteringView(e,n);if(!n&&!i)throw new Error("no views in the stack to be removed");i&&i.state===zN&&await i.init(this.el),this.postViewInit(i,n,e);const r=(e.enteringRequiresTransition||e.leavingRequiresTransition)&&i!==n;r&&e.opts&&n&&(e.opts.direction==="back"&&(e.opts.animationBuilder=e.opts.animationBuilder||(i==null?void 0:i.animationBuilder)),n.animationBuilder=e.opts.animationBuilder);let a;r?a=await this.transition(i,n,e):a={hasCompleted:!0,requiresTransition:!1},this.success(a,e),this.ionNavDidChange.emit()}catch(n){this.failed(n,e)}this.isTransitioning=!1,this.nextTrns()}prepareTI(e){var n,i,r;const a=this.views.length;if((n=e.opts)!==null&&n!==void 0||(e.opts={}),(i=(r=e.opts).delegate)!==null&&i!==void 0||(r.delegate=this.delegate),e.removeView!==void 0){Mr(e.removeStart!==void 0,"removeView needs removeStart"),Mr(e.removeCount!==void 0,"removeView needs removeCount");const f=this.views.indexOf(e.removeView);if(f<0)throw new Error("removeView was not found");e.removeStart+=f}e.removeStart!==void 0&&(e.removeStart<0&&(e.removeStart=a-1),e.removeCount<0&&(e.removeCount=a-e.removeStart),e.leavingRequiresTransition=e.removeCount>0&&e.removeStart+e.removeCount===a),e.insertViews&&((e.insertStart<0||e.insertStart>a)&&(e.insertStart=a),e.enteringRequiresTransition=e.insertStart===a);const d=e.insertViews;if(!d)return;Mr(d.length>0,"length can not be zero");const o=jX(d);if(o.length===0)throw new Error("invalid views to insert");for(const f of o){f.delegate=e.opts.delegate;const g=f.nav;if(g&&g!==this)throw new Error("inserted view was already inserted");if(f.state===yx)throw new Error("inserted view was already destroyed")}e.insertViews=o}getEnteringView(e,n){const i=e.insertViews;if(i!==void 0)return i[i.length-1];const r=e.removeStart;if(r!==void 0){const a=this.views,d=r+e.removeCount;for(let o=a.length-1;o>=0;o--){const f=a[o];if((o<r||o>=d)&&f!==n)return f}}}postViewInit(e,n,i){var r,a,d;Mr(n||e,"Both leavingView and enteringView are null"),Mr(i.resolve,"resolve must be valid"),Mr(i.reject,"reject must be valid");const o=i.opts,{insertViews:f,removeStart:g,removeCount:_}=i;let w;if(g!==void 0&&_!==void 0){Mr(g>=0,"removeStart can not be negative"),Mr(_>=0,"removeCount can not be negative"),w=[];for(let A=g;A<g+_;A++){const D=this.views[A];D!==void 0&&D!==e&&D!==n&&w.push(D)}(r=o.direction)!==null&&r!==void 0||(o.direction="back")}const T=this.views.length+((a=f==null?void 0:f.length)!==null&&a!==void 0?a:0)-(_!=null?_:0);if(Mr(T>=0,"final balance can not be negative"),T===0)throw console.warn("You can't remove all the pages in the navigation stack. nav.pop() is probably called too many times.",this,this.el),new Error("navigation stack needs at least one root page");if(f){let A=i.insertStart;for(const D of f)this.insertViewAt(D,A),A++;i.enteringRequiresTransition&&((d=o.direction)!==null&&d!==void 0||(o.direction="forward"))}if(w&&w.length>0){for(const A of w)sc(A.element,aN),sc(A.element,lN),sc(A.element,LE);for(const A of w)this.destroyView(A)}}async transition(e,n,i){const r=i.opts,a=r.progressAnimation?w=>this.sbAni=w:void 0,d=Xn(this),o=e.element,f=n&&n.element,g=Object.assign(Object.assign({mode:d,showGoBack:this.canGoBackSync(e),baseEl:this.el,progressCallback:a,animated:this.animated&&_i.getBoolean("animated",!0),enteringEl:o,leavingEl:f},r),{animationBuilder:r.animationBuilder||this.animation||_i.get("navAnimation")}),{hasCompleted:_}=await cN(g);return this.transitionFinish(_,e,n,r)}transitionFinish(e,n,i,r){const a=e?n:i;return a&&this.unmountInactiveViews(a),{hasCompleted:e,requiresTransition:!0,enteringView:n,leavingView:i,direction:r.direction}}insertViewAt(e,n){const i=this.views,r=i.indexOf(e);r>-1?(Mr(e.nav===this,"view is not part of the nav"),i.splice(r,1),i.splice(n,0,e)):(Mr(!e.nav,"nav is used"),e.nav=this,i.splice(n,0,e))}removeView(e){Mr(e.state===BN||e.state===yx,"view state should be loaded or destroyed");const n=this.views,i=n.indexOf(e);Mr(i>-1,"view must be part of the stack"),i>=0&&n.splice(i,1)}destroyView(e){e._destroy(),this.removeView(e)}unmountInactiveViews(e){if(this.destroyed)return;const n=this.views,i=n.indexOf(e);for(let r=n.length-1;r>=0;r--){const a=n[r],d=a.element;d&&(r>i?(sc(d,LE),this.destroyView(a)):r<i&&BT(d,!0))}}canStart(){return!!this.swipeGesture&&!this.isTransitioning&&this.transInstr.length===0&&this.animationEnabled&&this.canGoBackSync()}onStart(){this.pop({direction:"back",progressAnimation:!0})}onMove(e){this.sbAni&&this.sbAni.progressStep(e)}onEnd(e,n,i){if(this.sbAni){this.animationEnabled=!1,this.sbAni.onFinish(()=>{this.animationEnabled=!0},{oneTimeCallback:!0});let r=e?-.001:.001;e?r+=kh([0,0],[.32,.72],[0,1],[1,1],n)[0]:(this.sbAni.easing("cubic-bezier(1, 0, 0.68, 0.28)"),r+=kh([0,0],[1,0],[.68,.28],[1,1],n)[0]),this.sbAni.progressEnd(e?1:0,r,i)}}render(){return Rt("slot",null)}get el(){return this}static get watchers(){return{swipeGesture:["swipeGestureChanged"],root:["rootChanged"]}}static get style(){return VX}},[1,"ion-nav",{delegate:[16],swipeGesture:[1028,"swipe-gesture"],animated:[4],animation:[16],rootParams:[16],root:[1],push:[64],insert:[64],insertPages:[64],pop:[64],popTo:[64],popToRoot:[64],removeIndex:[64],setRoot:[64],setPages:[64],setRouteId:[64],getRouteId:[64],getActive:[64],getByIndex:[64],canGoBack:[64],getPrevious:[64]}]);function qX(){if(typeof customElements>"u")return;["ion-nav"].forEach(e=>{switch(e){case"ion-nav":customElements.get(e)||customElements.define(e,UX);break}})}const WX=qX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const GX=pX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const HX=BZ;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const ZX=":host{--ion-safe-area-left:0px;--ion-safe-area-right:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);contain:content;overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.card-disabled){cursor:default;opacity:0.3;pointer-events:none}.card-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:inherit}.card-native::-moz-focus-inner{border:0}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}ion-ripple-effect{color:var(--ripple-color)}:host{--background:var(--ion-card-background, var(--ion-item-background, var(--ion-background-color, #fff)));--color:var(--ion-card-color, var(--ion-item-color, var(--ion-color-step-600, #666666)));-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px;margin-top:24px;margin-bottom:24px;border-radius:8px;-webkit-transition:-webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:-webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);transition:transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1), -webkit-transform 500ms cubic-bezier(0.12, 0.72, 0.29, 1);font-size:14px;-webkit-box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);box-shadow:0 4px 16px rgba(0, 0, 0, 0.12)}:host(.ion-activated){-webkit-transform:scale3d(0.97, 0.97, 1);transform:scale3d(0.97, 0.97, 1)}",XX=":host{--ion-safe-area-left:0px;--ion-safe-area-right:0px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;background:var(--background);color:var(--color);font-family:var(--ion-font-family, inherit);contain:content;overflow:hidden}:host(.ion-color){background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.card-disabled){cursor:default;opacity:0.3;pointer-events:none}.card-native{font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:inherit}.card-native::-moz-focus-inner{border:0}button,a{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}ion-ripple-effect{color:var(--ripple-color)}:host{--background:var(--ion-card-background, var(--ion-item-background, var(--ion-background-color, #fff)));--color:var(--ion-card-color, var(--ion-item-color, var(--ion-color-step-550, #737373)));-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px;margin-top:10px;margin-bottom:10px;border-radius:4px;font-size:14px;-webkit-box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12);box-shadow:0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)}",KX=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.inheritedAriaAttributes={},this.color=void 0,this.button=!1,this.type="button",this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.target=void 0}componentWillLoad(){this.inheritedAriaAttributes=ym(this.el,["aria-label"])}isClickable(){return this.href!==void 0||this.button}renderCard(e){const n=this.isClickable();if(!n)return[Rt("slot",null)];const{href:i,routerAnimation:r,routerDirection:a,inheritedAriaAttributes:d}=this,o=n?i===void 0?"button":"a":"div",f=o==="button"?{type:this.type}:{download:this.download,href:this.href,rel:this.rel,target:this.target};return Rt(o,Object.assign({},f,d,{class:"card-native",part:"native",disabled:this.disabled,onClick:g=>M1(i,g,a,r)}),Rt("slot",null),n&&e==="md"&&Rt("ion-ripple-effect",null))}render(){const e=Xn(this);return Rt(_r,{class:Ml(this.color,{[e]:!0,"card-disabled":this.disabled,"ion-activatable":this.isClickable()})},this.renderCard(e))}get el(){return this}static get style(){return{ios:ZX,md:XX}}},[33,"ion-card",{color:[513],button:[4],type:[1],disabled:[4],download:[1],href:[1],rel:[1],routerDirection:[1,"router-direction"],routerAnimation:[16],target:[1]}]),YX=KX;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const JX=':host{--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--background-hover:var(--ion-color-primary-contrast, #fff);--background-hover-opacity:.08;--transition:background-color, opacity 100ms linear;--ripple-color:currentColor;--border-radius:50%;--border-width:0;--border-style:none;--border-color:initial;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:56px;height:56px;font-size:14px;text-align:center;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transform:var(--transform);transform:var(--transform);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);background-clip:padding-box;color:var(--color);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:strict;cursor:pointer;overflow:hidden;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-icon){line-height:1}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;z-index:1}:host(.fab-button-disabled){cursor:default;opacity:0.5;pointer-events:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-activated) .button-native{color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}::slotted(ion-icon){line-height:1}:host(.fab-button-small){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px;margin-bottom:8px;width:40px;height:40px}.close-icon{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;left:0;right:0;top:0;position:absolute;height:100%;-webkit-transform:scale(0.4) rotateZ(-45deg);transform:scale(0.4) rotateZ(-45deg);-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;font-size:var(--close-icon-font-size);opacity:0;z-index:1}:host(.fab-button-close-active) .close-icon{-webkit-transform:scale(1) rotateZ(0deg);transform:scale(1) rotateZ(0deg);opacity:1}:host(.fab-button-close-active) .button-inner{-webkit-transform:scale(0.4) rotateZ(45deg);transform:scale(0.4) rotateZ(45deg);opacity:0}ion-ripple-effect{color:var(--ripple-color)}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent) .button-native{-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter)}}:host(.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{--background:var(--ion-color-primary, #3880ff);--background-activated:var(--ion-color-primary-shade, #3171e0);--background-focused:var(--ion-color-primary-shade, #3171e0);--background-hover:var(--ion-color-primary-tint, #4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1;--color:var(--ion-color-primary-contrast, #fff);--box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);--transition:0.2s transform cubic-bezier(0.25, 1.11, 0.78, 1.59);--close-icon-font-size:28px}:host(.ion-activated){--box-shadow:0 4px 16px rgba(0, 0, 0, 0.12);--transform:scale(1.1);--transition:0.2s transform ease-out}::slotted(ion-icon){font-size:28px}:host(.fab-button-in-list){--background:var(--ion-color-light, #f4f5f8);--background-activated:var(--ion-color-light-shade, #d7d8da);--background-focused:var(--background-activated);--background-hover:var(--ion-color-light-tint, #f5f6f9);--color:var(--ion-color-light-contrast, #000);--color-activated:var(--ion-color-light-contrast, #000);--color-focused:var(--color-activated);--transition:transform 200ms ease 10ms, opacity 200ms ease 10ms}:host(.fab-button-in-list) ::slotted(ion-icon){font-size:18px}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-shade)}:host(.ion-color.ion-focused) .button-native,:host(.ion-color.ion-activated) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .button-native::after,:host(.ion-color.ion-activated) .button-native::after{background:var(--ion-color-shade)}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-contrast)}:host(.ion-color:hover) .button-native::after{background:var(--ion-color-tint)}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent){--background:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.9);--background-hover:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.8);--background-focused:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.82);--backdrop-filter:saturate(180%) blur(20px)}:host(.fab-button-translucent-in-list){--background:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.9);--background-hover:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.8);--background-focused:rgba(var(--ion-color-light-rgb, 244, 245, 248), 0.82)}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){@media (any-hover: hover){:host(.fab-button-translucent.ion-color:hover) .button-native{background:rgba(var(--ion-color-base-rgb), 0.8)}}:host(.ion-color.fab-button-translucent) .button-native{background:rgba(var(--ion-color-base-rgb), 0.9)}:host(.ion-color.ion-focused.fab-button-translucent) .button-native,:host(.ion-color.ion-activated.fab-button-translucent) .button-native{background:var(--ion-color-base)}}',QX=':host{--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--background-hover:var(--ion-color-primary-contrast, #fff);--background-hover-opacity:.08;--transition:background-color, opacity 100ms linear;--ripple-color:currentColor;--border-radius:50%;--border-width:0;--border-style:none;--border-color:initial;--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;width:56px;height:56px;font-size:14px;text-align:center;text-overflow:ellipsis;text-transform:none;white-space:nowrap;-webkit-font-kerning:none;font-kerning:none}.button-native{border-radius:var(--border-radius);-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transform:var(--transform);transform:var(--transform);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);background-clip:padding-box;color:var(--color);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:strict;cursor:pointer;overflow:hidden;z-index:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-icon){line-height:1}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{left:0;right:0;top:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;z-index:1}:host(.fab-button-disabled){cursor:default;opacity:0.5;pointer-events:none}@media (any-hover: hover){:host(:hover) .button-native{color:var(--color-hover)}:host(:hover) .button-native::after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-activated) .button-native{color:var(--color-activated)}:host(.ion-activated) .button-native::after{background:var(--background-activated);opacity:var(--background-activated-opacity)}::slotted(ion-icon){line-height:1}:host(.fab-button-small){-webkit-margin-start:8px;margin-inline-start:8px;-webkit-margin-end:8px;margin-inline-end:8px;margin-top:8px;margin-bottom:8px;width:40px;height:40px}.close-icon{-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;left:0;right:0;top:0;position:absolute;height:100%;-webkit-transform:scale(0.4) rotateZ(-45deg);transform:scale(0.4) rotateZ(-45deg);-webkit-transition:all ease-in-out 300ms;transition:all ease-in-out 300ms;-webkit-transition-property:opacity, -webkit-transform;transition-property:opacity, -webkit-transform;transition-property:transform, opacity;transition-property:transform, opacity, -webkit-transform;font-size:var(--close-icon-font-size);opacity:0;z-index:1}:host(.fab-button-close-active) .close-icon{-webkit-transform:scale(1) rotateZ(0deg);transform:scale(1) rotateZ(0deg);opacity:1}:host(.fab-button-close-active) .button-inner{-webkit-transform:scale(0.4) rotateZ(45deg);transform:scale(0.4) rotateZ(45deg);opacity:0}ion-ripple-effect{color:var(--ripple-color)}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.fab-button-translucent) .button-native{-webkit-backdrop-filter:var(--backdrop-filter);backdrop-filter:var(--backdrop-filter)}}:host(.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host{--background:var(--ion-color-primary, #3880ff);--background-activated:transparent;--background-focused:currentColor;--background-hover:currentColor;--background-activated-opacity:0;--background-focused-opacity:.24;--background-hover-opacity:.08;--color:var(--ion-color-primary-contrast, #fff);--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1), background-color 280ms cubic-bezier(0.4, 0, 0.2, 1), color 280ms cubic-bezier(0.4, 0, 0.2, 1), opacity 15ms linear 30ms, transform 270ms cubic-bezier(0, 0, 0.2, 1) 0ms;--close-icon-font-size:24px}:host(.ion-activated){--box-shadow:0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 12px 17px 2px rgba(0, 0, 0, 0.14), 0 5px 22px 4px rgba(0, 0, 0, 0.12)}::slotted(ion-icon){font-size:24px}:host(.fab-button-in-list){--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);--color-activated:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54);--color-focused:var(--color-activated);--background:var(--ion-color-light, #f4f5f8);--background-activated:transparent;--background-focused:var(--ion-color-light-shade, #d7d8da);--background-hover:var(--ion-color-light-tint, #f5f6f9)}:host(.fab-button-in-list) ::slotted(ion-icon){font-size:18px}:host(.ion-color.ion-focused) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .button-native::after{background:var(--ion-color-contrast)}:host(.ion-color.ion-activated) .button-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activated) .button-native::after{background:transparent}@media (any-hover: hover){:host(.ion-color:hover) .button-native{color:var(--ion-color-contrast)}:host(.ion-color:hover) .button-native::after{background:var(--ion-color-contrast)}}',eK=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionFocus=Wn(this,"ionFocus",7),this.ionBlur=Wn(this,"ionBlur",7),this.fab=null,this.inheritedAttributes={},this.onFocus=()=>{this.ionFocus.emit()},this.onBlur=()=>{this.ionBlur.emit()},this.onClick=()=>{const{fab:e}=this;e&&e.toggle()},this.color=void 0,this.activated=!1,this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.routerDirection="forward",this.routerAnimation=void 0,this.target=void 0,this.show=!1,this.translucent=!1,this.type="button",this.size=void 0,this.closeIcon=$H}connectedCallback(){this.fab=this.el.closest("ion-fab")}componentWillLoad(){this.inheritedAttributes=jv(this.el)}render(){const{el:e,disabled:n,color:i,href:r,activated:a,show:d,translucent:o,size:f,inheritedAttributes:g}=this,_=Ka("ion-fab-list",e),w=Xn(this),T=r===void 0?"button":"a",A=T==="button"?{type:this.type}:{download:this.download,href:r,rel:this.rel,target:this.target};return Rt(_r,{onClick:this.onClick,"aria-disabled":n?"true":null,class:Ml(i,{[w]:!0,"fab-button-in-list":_,"fab-button-translucent-in-list":_&&o,"fab-button-close-active":a,"fab-button-show":d,"fab-button-disabled":n,"fab-button-translucent":o,"ion-activatable":!0,"ion-focusable":!0,[`fab-button-${f}`]:f!==void 0})},Rt(T,Object.assign({},A,{class:"button-native",part:"native",disabled:n,onFocus:this.onFocus,onBlur:this.onBlur,onClick:D=>M1(r,D,this.routerDirection,this.routerAnimation)},g),Rt("ion-icon",{"aria-hidden":"true",icon:this.closeIcon,part:"close-icon",class:"close-icon",lazy:!1}),Rt("span",{class:"button-inner"},Rt("slot",null)),w==="md"&&Rt("ion-ripple-effect",null)))}get el(){return this}static get style(){return{ios:JX,md:QX}}},[33,"ion-fab-button",{color:[513],activated:[4],disabled:[4],download:[1],href:[1],rel:[1],routerDirection:[1,"router-direction"],routerAnimation:[16],target:[1],show:[4],translucent:[4],type:[1],size:[1],closeIcon:[1,"close-icon"]}]),tK=eK;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const nK=$Z;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const vx="ionKeyboardDidShow",FN="ionKeyboardDidHide",iK=150;let bx={},dc={},vm=!1;const rK=()=>{bx={},dc={},vm=!1},oK=t=>{if(RN.getEngine())sK(t);else{if(!t.visualViewport)return;dc=MI(t.visualViewport),t.visualViewport.onresize=()=>{jN(t),NN()||$N(t)?CI(t):AI(t)&&II(t)}}},sK=t=>{t.addEventListener("keyboardDidShow",e=>CI(t,e)),t.addEventListener("keyboardDidHide",()=>II(t))},CI=(t,e)=>{aK(t,e),vm=!0},II=t=>{lK(t),vm=!1},NN=()=>{const t=(bx.height-dc.height)*dc.scale;return!vm&&bx.width===dc.width&&t>iK},$N=t=>vm&&!AI(t),AI=t=>vm&&dc.height===t.innerHeight,aK=(t,e)=>{const n=e?e.keyboardHeight:t.innerHeight-dc.height,i=new CustomEvent(vx,{detail:{keyboardHeight:n}});t.dispatchEvent(i)},lK=t=>{const e=new CustomEvent(FN);t.dispatchEvent(e)},jN=t=>{bx=Object.assign({},dc),dc=MI(t.visualViewport)},MI=t=>({width:Math.round(t.width),height:Math.round(t.height),offsetTop:t.offsetTop,offsetLeft:t.offsetLeft,pageTop:t.pageTop,pageLeft:t.pageLeft,scale:t.scale}),cK=Object.freeze(Object.defineProperty({__proto__:null,KEYBOARD_DID_CLOSE:FN,KEYBOARD_DID_OPEN:vx,copyVisualViewport:MI,keyboardDidClose:AI,keyboardDidOpen:NN,keyboardDidResize:$N,resetKeyboardAssist:rK,setKeyboardClose:II,setKeyboardOpen:CI,startKeyboardAssist:oK,trackViewportChanges:jN},Symbol.toStringTag,{value:"Module"}));/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */var Yp;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Yp||(Yp={}));const mv={getEngine(){var t;return((t=Zn==null?void 0:Zn.Capacitor)===null||t===void 0?void 0:t.isPluginAvailable("StatusBar"))&&(Zn==null?void 0:Zn.Capacitor.Plugins.StatusBar)},supportsDefaultStatusBarStyle(){var t;return!!(!((t=Zn==null?void 0:Zn.Capacitor)===null||t===void 0)&&t.PluginHeaders)},setStyle(t){const e=this.getEngine();e&&e.setStyle(t)},getStyle:async function(){const t=this.getEngine();if(!t)return Yp.Default;const{style:e}=await t.getInfo();return e}},WT=(t,e)=>{if(e===1)return 0;const n=1/(1-e),i=-(e*n);return t*n+i},VN=()=>{!Zn||Zn.innerWidth>=768||!mv.supportsDefaultStatusBarStyle()||mv.setStyle({style:Yp.Dark})},UN=(t=Yp.Default)=>{!Zn||Zn.innerWidth>=768||!mv.supportsDefaultStatusBarStyle()||mv.setStyle({style:t})},qN=async(t,e)=>{typeof t.canDismiss!="function"||!await t.canDismiss(void 0,$y)||(e.isRunning()?e.onFinish(()=>{t.dismiss(void 0,"handler")},{oneTimeCallback:!0}):t.dismiss(void 0,"handler"))},GT=t=>.00255275*2.71828**(-14.9619*t)-1.00255*2.71828**(-.0380968*t)+1,_x={MIN_PRESENTING_SCALE:.93},uK=(t,e,n,i)=>{const a=t.offsetHeight;let d=!1,o=!1,f=null,g=null;const _=.2;let w=!0,T=0;const A=()=>f&&Ch(f)?f.scrollY:!0,N=wI({el:t,gestureName:"modalSwipeToClose",gesturePriority:39,direction:"y",threshold:10,canStart:q=>{const K=q.event.target;return K===null||!K.closest?!0:(f=KZ(K),f?(Ch(f)?g=Bu(f).querySelector(".inner-scroll"):g=f,!!!f.querySelector("ion-refresher")&&g.scrollTop===0):K.closest("ion-footer")===null)},onStart:q=>{const{deltaY:K}=q;w=A(),o=t.canDismiss!==void 0&&t.canDismiss!==!0,K>0&&f&&TR(f),e.progressStart(!0,d?1:0)},onMove:q=>{const{deltaY:K}=q;K>0&&f&&TR(f);const se=q.deltaY/a,ie=se>=0&&o,Q=ie?_:.9999,J=ie?GT(se/Q):se,te=Eh(1e-4,J,Q);e.progressStep(te),te>=.5&&T<.5?UN(n):te<.5&&T>=.5&&VN(),T=te},onEnd:q=>{const K=q.velocityY,se=q.deltaY/a,ie=se>=0&&o,Q=ie?_:.9999,J=ie?GT(se/Q):se,te=Eh(1e-4,J,Q),me=(q.deltaY+K*1e3)/a,Fe=!ie&&me>=.5;let tt=Fe?-.001:.001;Fe?(e.easing("cubic-bezier(0.32, 0.72, 0, 1)"),tt+=kh([0,0],[.32,.72],[0,1],[1,1],te)[0]):(e.easing("cubic-bezier(1, 0, 0.68, 0.28)"),tt+=kh([0,0],[1,0],[.68,.28],[1,1],te)[0]);const At=NR(Fe?se*a:(1-te)*a,K);d=Fe,N.enable(!1),f&&YZ(f,w),e.onFinish(()=>{Fe||N.enable(!0)}).progressEnd(Fe?1:0,tt,At),ie&&te>Q/4?qN(t,e):Fe&&i()}});return N},NR=(t,e)=>Eh(400,t/Math.abs(e*1.1),500),WN=t=>{const{currentBreakpoint:e,backdropBreakpoint:n}=t,i=n===void 0||n<e,r=i?`calc(var(--backdrop-opacity) * ${e})`:"0",a=Di("backdropAnimation").fromTo("opacity",0,r);return i&&a.beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),{wrapperAnimation:Di("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:`translateY(${100-e*100}%)`}]),backdropAnimation:a}},GN=t=>{const{currentBreakpoint:e,backdropBreakpoint:n}=t,i=`calc(var(--backdrop-opacity) * ${WT(e,n)})`,r=[{offset:0,opacity:i},{offset:1,opacity:0}],a=[{offset:0,opacity:i},{offset:n,opacity:0},{offset:1,opacity:0}],d=Di("backdropAnimation").keyframes(n!==0?a:r);return{wrapperAnimation:Di("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:`translateY(${100-e*100}%)`},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:d}},dK=()=>{const t=Di().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=Di().fromTo("transform","translateY(100vh)","translateY(0vh)");return{backdropAnimation:t,wrapperAnimation:e}},$R=(t,e)=>{const{presentingEl:n,currentBreakpoint:i}=e,r=Bu(t),{wrapperAnimation:a,backdropAnimation:d}=i!==void 0?WN(e):dK();d.addElement(r.querySelector("ion-backdrop")),a.addElement(r.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const o=Di("entering-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation(a);if(n){const f=window.innerWidth<768,g=n.tagName==="ION-MODAL"&&n.presentingElement!==void 0,_=Bu(n),w=Di().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),T=document.body;if(f){const A=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",D=g?"-10px":A,z=_x.MIN_PRESENTING_SCALE,G=`translateY(${D}) scale(${z})`;w.afterStyles({transform:G}).beforeAddWrite(()=>T.style.setProperty("background-color","black")).addElement(n).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:G,borderRadius:"10px 10px 0 0"}]),o.addAnimation(w)}else if(o.addAnimation(d),!g)a.fromTo("opacity","0","1");else{const D=`translateY(-10px) scale(${g?_x.MIN_PRESENTING_SCALE:1})`;w.afterStyles({transform:D}).addElement(_.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:D}]);const z=Di().afterStyles({transform:D}).addElement(_.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:D}]);o.addAnimation([w,z])}}else o.addAnimation(d);return o},hK=()=>{const t=Di().fromTo("opacity","var(--backdrop-opacity)",0),e=Di().fromTo("transform","translateY(0vh)","translateY(100vh)");return{backdropAnimation:t,wrapperAnimation:e}},jR=(t,e,n=500)=>{const{presentingEl:i,currentBreakpoint:r}=e,a=Bu(t),{wrapperAnimation:d,backdropAnimation:o}=r!==void 0?GN(e):hK();o.addElement(a.querySelector("ion-backdrop")),d.addElement(a.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const f=Di("leaving-base").addElement(t).easing("cubic-bezier(0.32,0.72,0,1)").duration(n).addAnimation(d);if(i){const g=window.innerWidth<768,_=i.tagName==="ION-MODAL"&&i.presentingElement!==void 0,w=Bu(i),T=Di().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish(D=>{if(D!==1)return;i.style.setProperty("overflow",""),Array.from(A.querySelectorAll("ion-modal")).filter(G=>G.presentingElement!==void 0).length<=1&&A.style.setProperty("background-color","")}),A=document.body;if(g){const D=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",z=_?"-10px":D,G=_x.MIN_PRESENTING_SCALE,V=`translateY(${z}) scale(${G})`;T.addElement(i).keyframes([{offset:0,filter:"contrast(0.85)",transform:V,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),f.addAnimation(T)}else if(f.addAnimation(o),!_)d.fromTo("opacity","1","0");else{const z=`translateY(-10px) scale(${_?_x.MIN_PRESENTING_SCALE:1})`;T.addElement(w.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:z},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const G=Di().addElement(w.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:z},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);f.addAnimation([T,G])}}else f.addAnimation(o);return f},fK=()=>{const t=Di().fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),e=Di().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}]);return{backdropAnimation:t,wrapperAnimation:e}},pK=(t,e)=>{const{currentBreakpoint:n}=e,i=Bu(t),{wrapperAnimation:r,backdropAnimation:a}=n!==void 0?WN(e):fK();return a.addElement(i.querySelector("ion-backdrop")),r.addElement(i.querySelector(".modal-wrapper")),Di().addElement(t).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([a,r])},mK=()=>{const t=Di().fromTo("opacity","var(--backdrop-opacity)",0),e=Di().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}]);return{backdropAnimation:t,wrapperAnimation:e}},gK=(t,e)=>{const{currentBreakpoint:n}=e,i=Bu(t),{wrapperAnimation:r,backdropAnimation:a}=n!==void 0?GN(e):mK();return a.addElement(i.querySelector("ion-backdrop")),r.addElement(i.querySelector(".modal-wrapper")),Di().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([a,r])},yK=(t,e,n,i,r,a,d=[],o,f,g)=>{const _=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}],w=[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-r,opacity:0},{offset:1,opacity:0}],T={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:r!==0?w:_},A=t.querySelector("ion-content"),D=n.clientHeight;let z=i,G=0,V=!1;const N=.95,q=a.childAnimations.find(xt=>xt.id==="wrapperAnimation"),K=a.childAnimations.find(xt=>xt.id==="backdropAnimation"),se=d[d.length-1],ie=d[0],Q=()=>{t.style.setProperty("pointer-events","auto"),e.style.setProperty("pointer-events","auto"),t.classList.remove("ion-disable-focus-trap")},J=()=>{t.style.setProperty("pointer-events","none"),e.style.setProperty("pointer-events","none"),t.classList.add("ion-disable-focus-trap")};q&&K&&(q.keyframes([...T.WRAPPER_KEYFRAMES]),K.keyframes([...T.BACKDROP_KEYFRAMES]),a.progressStart(!0,1-z),z>r?Q():J()),A&&z!==se&&(A.scrollY=!1);const te=xt=>{const lt=xt.event.target.closest("ion-content");return z=o(),!(z===1&&lt)},me=()=>{V=t.canDismiss!==void 0&&t.canDismiss!==!0&&ie===0,A&&(A.scrollY=!1),ro(()=>{t.focus()}),a.progressStart(!0,1-z)},Fe=xt=>{const lt=1-z,zt=d.length>1?1-d[1]:void 0,ze=lt+xt.deltaY/D,ot=zt!==void 0&&ze>=zt&&V,Be=ot?N:.9999,ft=ot&&zt!==void 0?zt+GT((ze-zt)/(Be-zt)):ze;G=Eh(1e-4,ft,Be),a.progressStep(G)},tt=xt=>{const lt=xt.velocityY,zt=(xt.deltaY+lt*350)/D,ze=z-zt,ot=d.reduce((Be,ft)=>Math.abs(ft-ze)<Math.abs(Be-ze)?ft:Be);At({breakpoint:ot,breakpointOffset:G,canDismiss:V})},At=xt=>{const{breakpoint:lt,canDismiss:zt,breakpointOffset:ze}=xt,ot=zt&&lt===0,Be=ot?z:lt,ft=Be!==0;return z=0,q&&K&&(q.keyframes([{offset:0,transform:`translateY(${ze*100}%)`},{offset:1,transform:`translateY(${(1-Be)*100}%)`}]),K.keyframes([{offset:0,opacity:`calc(var(--backdrop-opacity) * ${WT(1-ze,r)})`},{offset:1,opacity:`calc(var(--backdrop-opacity) * ${WT(Be,r)})`}]),a.progressStep(0)),_t.enable(!1),ot?qN(t,a):ft||f(),new Promise(gt=>{a.onFinish(()=>{ft?q&&K?ro(()=>{q.keyframes([...T.WRAPPER_KEYFRAMES]),K.keyframes([...T.BACKDROP_KEYFRAMES]),a.progressStart(!0,1-Be),z=Be,g(z),A&&z===d[d.length-1]&&(A.scrollY=!0),z>r?Q():J(),_t.enable(!0),gt()}):(_t.enable(!0),gt()):gt()},{oneTimeCallback:!0}).progressEnd(1,0,500)})},_t=wI({el:n,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:te,onStart:me,onMove:Fe,onEnd:tt});return{gesture:_t,moveSheetToBreakpoint:At}},vK=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-card) .modal-wrapper,:host-context([dir=rtl]).modal-card .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-card) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-sheet) .modal-wrapper,:host-context([dir=rtl]).modal-sheet .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}@supports selector(:dir(rtl)){:host(.modal-sheet) .modal-wrapper:dir(rtl){border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}}',bK=':host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);contain:strict}.modal-wrapper,ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);border:0;background:var(--ion-color-step-350, #c0c0be);cursor:pointer;z-index:11}.modal-handle::before{-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px;padding-top:4px;padding-bottom:4px;position:absolute;width:36px;height:5px;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);content:""}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}',_K=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.didPresent=Wn(this,"ionModalDidPresent",7),this.willPresent=Wn(this,"ionModalWillPresent",7),this.willDismiss=Wn(this,"ionModalWillDismiss",7),this.didDismiss=Wn(this,"ionModalDidDismiss",7),this.ionBreakpointDidChange=Wn(this,"ionBreakpointDidChange",7),this.didPresentShorthand=Wn(this,"didPresent",7),this.willPresentShorthand=Wn(this,"willPresent",7),this.willDismissShorthand=Wn(this,"willDismiss",7),this.didDismissShorthand=Wn(this,"didDismiss",7),this.ionMount=Wn(this,"ionMount",7),this.triggerController=NH(),this.coreDelegate=kH(),this.isSheetModal=!1,this.inheritedAttributes={},this.inline=!1,this.gestureAnimationDismissing=!1,this.onHandleClick=()=>{const{sheetTransition:e,handleBehavior:n}=this;n!=="cycle"||e!==void 0||this.moveToNextBreakpoint()},this.onBackdropTap=()=>{const{sheetTransition:e}=this;e===void 0&&this.dismiss(void 0,NT)},this.onLifecycle=e=>{const n=this.usersElement,i=xK[e.type];if(n&&i){const r=new CustomEvent(i,{bubbles:!1,cancelable:!1,detail:e.detail});n.dispatchEvent(r)}},this.presented=!1,this.hasController=!1,this.overlayIndex=void 0,this.delegate=void 0,this.keyboardClose=!0,this.enterAnimation=void 0,this.leaveAnimation=void 0,this.breakpoints=void 0,this.initialBreakpoint=void 0,this.backdropBreakpoint=0,this.handle=void 0,this.handleBehavior="none",this.component=void 0,this.componentProps=void 0,this.cssClass=void 0,this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.presentingElement=void 0,this.htmlAttributes=void 0,this.isOpen=!1,this.trigger=void 0,this.keepContentsMounted=!1,this.canDismiss=!0}onIsOpenChange(e,n){e===!0&&n===!1?this.present():e===!1&&n===!0&&this.dismiss()}triggerChanged(){const{trigger:e,el:n,triggerController:i}=this;e&&i.addClickListener(n,e)}breakpointsChanged(e){e!==void 0&&(this.sortedBreakpoints=e.sort((n,i)=>n-i))}connectedCallback(){const{el:e}=this;IH(e),this.triggerChanged()}disconnectedCallback(){this.triggerController.removeClickListener()}componentWillLoad(){const{breakpoints:e,initialBreakpoint:n,el:i}=this,r=this.isSheetModal=e!==void 0&&n!==void 0;this.inheritedAttributes=ym(i,["aria-label","role"]),r&&(this.currentBreakpoint=this.initialBreakpoint),e!==void 0&&n!==void 0&&!e.includes(n)&&gs("Your breakpoints array must include the initialBreakpoint value."),AH(i)}componentDidLoad(){this.isOpen===!0&&ro(()=>this.present()),this.breakpointsChanged(this.breakpoints)}getDelegate(e=!1){if(this.workingDelegate&&!e)return{delegate:this.workingDelegate,inline:this.inline};const n=this.el.parentNode,i=this.inline=n!==null&&!this.hasController,r=this.workingDelegate=i?this.delegate||this.coreDelegate:this.delegate;return{inline:i,delegate:r}}async checkCanDismiss(e,n){const{canDismiss:i}=this;return typeof i=="function"?i(e,n):i}async present(){if(this.presented)return;const{presentingElement:e,el:n}=this;this.currentTransition!==void 0&&await this.currentTransition,this.currentBreakpoint=this.initialBreakpoint;const{inline:i,delegate:r}=this.getDelegate(!0);this.usersElement=await kI(r,n,this.component,["ion-page"],this.componentProps,i),this.ionMount.emit(),rN(n)?await fx(this.usersElement):this.keepContentsMounted||await $9(),Al(()=>this.el.classList.add("show-modal")),this.currentTransition=RH(this,"modalEnter",$R,pK,{presentingEl:e,currentBreakpoint:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint}),typeof window<"u"&&(this.keyboardOpenCallback=()=>{this.gesture&&(this.gesture.enable(!1),ro(()=>{this.gesture&&this.gesture.enable(!0)}))},window.addEventListener(vx,this.keyboardOpenCallback));const a=e!==void 0;a&&Xn(this)==="ios"&&(this.statusBarStyle=await mv.getStyle(),VN()),await this.currentTransition,this.isSheetModal?this.initSheetGesture():a&&this.initSwipeToClose(),this.currentTransition=void 0}initSwipeToClose(){var e;if(Xn(this)!=="ios")return;const{el:n}=this,i=this.leaveAnimation||_i.get("modalLeave",jR),r=this.animation=i(n,{presentingEl:this.presentingElement});if(!jT(n)){VT(n);return}const d=(e=this.statusBarStyle)!==null&&e!==void 0?e:Yp.Default;this.gesture=uK(n,r,d,()=>{this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{await this.dismiss(void 0,$y),this.gestureAnimationDismissing=!1})}),this.gesture.enable(!0)}initSheetGesture(){const{wrapperEl:e,initialBreakpoint:n,backdropBreakpoint:i}=this;if(!e||n===void 0)return;const r=this.enterAnimation||_i.get("modalEnter",$R),a=this.animation=r(this.el,{presentingEl:this.presentingElement,currentBreakpoint:n,backdropBreakpoint:i});a.progressStart(!0,1);const{gesture:d,moveSheetToBreakpoint:o}=yK(this.el,this.backdropEl,e,n,i,a,this.sortedBreakpoints,()=>{var f;return(f=this.currentBreakpoint)!==null&&f!==void 0?f:0},()=>this.sheetOnDismiss(),f=>{this.currentBreakpoint!==f&&(this.currentBreakpoint=f,this.ionBreakpointDidChange.emit({breakpoint:f}))});this.gesture=d,this.moveSheetToBreakpoint=o,this.gesture.enable(!0)}sheetOnDismiss(){this.gestureAnimationDismissing=!0,this.animation.onFinish(async()=>{this.currentBreakpoint=0,this.ionBreakpointDidChange.emit({breakpoint:this.currentBreakpoint}),await this.dismiss(void 0,$y),this.gestureAnimationDismissing=!1})}async dismiss(e,n){var i;if(this.gestureAnimationDismissing&&n!==$y||n!=="handler"&&!await this.checkCanDismiss(e,n))return!1;const{presentingElement:r}=this;r!==void 0&&Xn(this)==="ios"&&UN(this.statusBarStyle),typeof window<"u"&&this.keyboardOpenCallback&&(window.removeEventListener(vx,this.keyboardOpenCallback),this.keyboardOpenCallback=void 0),this.currentTransition!==void 0&&await this.currentTransition;const d=px.get(this)||[];this.currentTransition=zH(this,e,n,"modalLeave",jR,gK,{presentingEl:r,currentBreakpoint:(i=this.currentBreakpoint)!==null&&i!==void 0?i:this.initialBreakpoint,backdropBreakpoint:this.backdropBreakpoint});const o=await this.currentTransition;if(o){const{delegate:f}=this.getDelegate();await SN(f,this.usersElement),Al(()=>this.el.classList.remove("show-modal")),this.animation&&this.animation.destroy(),this.gesture&&this.gesture.destroy(),d.forEach(g=>g.destroy())}return this.currentBreakpoint=void 0,this.currentTransition=void 0,this.animation=void 0,o}onDidDismiss(){return _R(this.el,"ionModalDidDismiss")}onWillDismiss(){return _R(this.el,"ionModalWillDismiss")}async setCurrentBreakpoint(e){if(!this.isSheetModal){gs("setCurrentBreakpoint is only supported on sheet modals.");return}if(!this.breakpoints.includes(e)){gs(`Attempted to set invalid breakpoint value ${e}. Please double check that the breakpoint value is part of your defined breakpoints.`);return}const{currentBreakpoint:n,moveSheetToBreakpoint:i,canDismiss:r,breakpoints:a}=this;n!==e&&i&&(this.sheetTransition=i({breakpoint:e,breakpointOffset:1-n,canDismiss:r!==void 0&&r!==!0&&a[0]===0}),await this.sheetTransition,this.sheetTransition=void 0)}async getCurrentBreakpoint(){return this.currentBreakpoint}async moveToNextBreakpoint(){const{breakpoints:e,currentBreakpoint:n}=this;if(!e||n==null)return!1;const i=e.filter(o=>o!==0),a=(i.indexOf(n)+1)%i.length,d=i[a];return await this.setCurrentBreakpoint(d),!0}render(){const{handle:e,isSheetModal:n,presentingElement:i,htmlAttributes:r,handleBehavior:a,inheritedAttributes:d}=this,o=e!==!1&&n,f=Xn(this),g=i!==void 0&&f==="ios",_=a==="cycle";return Rt(_r,Object.assign({"no-router":!0,tabindex:"-1"},r,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[f]:!0,"modal-default":!g&&!n,"modal-card":g,"modal-sheet":n,"overlay-hidden":!0},uZ(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle}),Rt("ion-backdrop",{ref:w=>this.backdropEl=w,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),f==="ios"&&Rt("div",{class:"modal-shadow"}),Rt("div",Object.assign({role:"dialog"},d,{"aria-modal":"true",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:w=>this.wrapperEl=w}),o&&Rt("button",{class:"modal-handle",tabIndex:_?0:-1,"aria-label":"Activate to adjust the size of the dialog overlaying the screen",onClick:_?this.onHandleClick:void 0,part:"handle"}),Rt("slot",null)))}get el(){return this}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["triggerChanged"]}}static get style(){return{ios:vK,md:bK}}},[33,"ion-modal",{hasController:[4,"has-controller"],overlayIndex:[2,"overlay-index"],delegate:[16],keyboardClose:[4,"keyboard-close"],enterAnimation:[16],leaveAnimation:[16],breakpoints:[16],initialBreakpoint:[2,"initial-breakpoint"],backdropBreakpoint:[2,"backdrop-breakpoint"],handle:[4],handleBehavior:[1,"handle-behavior"],component:[1],componentProps:[16],cssClass:[1,"css-class"],backdropDismiss:[4,"backdrop-dismiss"],showBackdrop:[4,"show-backdrop"],animated:[4],presentingElement:[16],htmlAttributes:[16],isOpen:[4,"is-open"],trigger:[1],keepContentsMounted:[4,"keep-contents-mounted"],canDismiss:[4,"can-dismiss"],presented:[32],present:[64],dismiss:[64],onDidDismiss:[64],onWillDismiss:[64],setCurrentBreakpoint:[64],getCurrentBreakpoint:[64]}]),xK={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"};function wK(){if(typeof customElements>"u")return;["ion-modal","ion-backdrop"].forEach(e=>{switch(e){case"ion-modal":customElements.get(e)||customElements.define(e,_K);break;case"ion-backdrop":customElements.get(e)||MN();break}})}const SK=wK,EK="html.plt-mobile ion-app{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html.plt-mobile ion-app [contenteditable]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}ion-app.force-statusbar-padding{--ion-safe-area-top:20px}",kK=xr(class extends wr{constructor(){super(),this.__registerHost()}componentDidLoad(){CK(async()=>{const e=cc(window,"hybrid");if(_i.getBoolean("_testing")||Zo(()=>import("./index9-f83998e2.js"),[]).then(i=>i.startTapClick(_i)),_i.getBoolean("statusTap",e)&&Zo(()=>import("./status-tap-1aa2b3ed.js"),[]).then(i=>i.startStatusTap()),_i.getBoolean("inputShims",TK())){const i=cc(window,"ios")?"ios":"android";Zo(()=>import("./input-shims-cb8a070a.js"),[]).then(r=>r.startInputShims(_i,i))}const n=await Zo(()=>Promise.resolve().then(()=>_H),void 0);_i.getBoolean("hardwareBackButton",e)?n.startHardwareBackButton():n.blockHardwareBackButton(),typeof window<"u"&&Zo(()=>Promise.resolve().then(()=>cK),void 0).then(i=>i.startKeyboardAssist(window)),Zo(()=>import("./focus-visible-9c13edeb.js"),[]).then(i=>this.focusVisible=i.startFocusVisible())})}async setFocus(e){this.focusVisible&&this.focusVisible.setFocus(e)}render(){const e=Xn(this);return Rt(_r,{class:{[e]:!0,"ion-page":!0,"force-statusbar-padding":_i.getBoolean("_forceStatusbarPadding")}})}get el(){return this}static get style(){return EK}},[0,"ion-app",{setFocus:[64]}]),TK=()=>!!(cc(window,"ios")&&cc(window,"mobile")||cc(window,"android")&&cc(window,"mobileweb")),CK=t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):setTimeout(t,32)};function IK(){if(typeof customElements>"u")return;["ion-app"].forEach(e=>{switch(e){case"ion-app":customElements.get(e)||customElements.define(e,kK);break}})}const AK=IK,MK=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:layout size style;overflow:hidden;z-index:0}",PK=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionNavWillLoad=Wn(this,"ionNavWillLoad",7),this.ionNavWillChange=Wn(this,"ionNavWillChange",3),this.ionNavDidChange=Wn(this,"ionNavDidChange",3),this.gestureOrAnimationInProgress=!1,this.mode=Xn(this),this.delegate=void 0,this.animated=!0,this.animation=void 0,this.swipeHandler=void 0}swipeHandlerChanged(){this.gesture&&this.gesture.enable(this.swipeHandler!==void 0)}async connectedCallback(){const e=()=>{this.gestureOrAnimationInProgress=!0,this.swipeHandler&&this.swipeHandler.onStart()};this.gesture=(await Zo(()=>import("./swipe-back-7655847b.js"),[])).createSwipeBackGesture(this.el,()=>!this.gestureOrAnimationInProgress&&!!this.swipeHandler&&this.swipeHandler.canStart(),()=>e(),n=>{var i;return(i=this.ani)===null||i===void 0?void 0:i.progressStep(n)},(n,i,r)=>{if(this.ani){this.ani.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(n)},{oneTimeCallback:!0});let a=n?-.001:.001;n?a+=kh([0,0],[.32,.72],[0,1],[1,1],i)[0]:(this.ani.easing("cubic-bezier(1, 0, 0.68, 0.28)"),a+=kh([0,0],[1,0],[.68,.28],[1,1],i)[0]),this.ani.progressEnd(n?1:0,a,r)}else this.gestureOrAnimationInProgress=!1}),this.swipeHandlerChanged()}componentWillLoad(){this.ionNavWillLoad.emit()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}async commit(e,n,i){const r=await this.lock();let a=!1;try{a=await this.transition(e,n,i)}catch(d){console.error(d)}return r(),a}async setRouteId(e,n,i,r){return{changed:await this.setRoot(e,n,{duration:i==="root"?0:void 0,direction:i==="back"?"back":"forward",animationBuilder:r}),element:this.activeEl}}async getRouteId(){const e=this.activeEl;return e?{id:e.tagName,element:e,params:this.activeParams}:void 0}async setRoot(e,n,i){if(this.activeComponent===e&&sN(n,this.activeParams))return!1;const r=this.activeEl,a=await kI(this.delegate,this.el,e,["ion-page","ion-page-invisible"],n);return this.activeComponent=e,this.activeEl=a,this.activeParams=n,await this.commit(a,r,i),await SN(this.delegate,r),!0}async transition(e,n,i={}){if(n===e)return!1;this.ionNavWillChange.emit();const{el:r,mode:a}=this,d=this.animated&&_i.getBoolean("animated",!0),o=i.animationBuilder||this.animation||_i.get("navAnimation");return await cN(Object.assign(Object.assign({mode:a,animated:d,enteringEl:e,leavingEl:n,baseEl:r,deepWait:rN(r),progressCallback:i.progressAnimation?f=>{f!==void 0&&!this.gestureOrAnimationInProgress?(this.gestureOrAnimationInProgress=!0,f.onFinish(()=>{this.gestureOrAnimationInProgress=!1,this.swipeHandler&&this.swipeHandler.onEnd(!1)},{oneTimeCallback:!0}),f.progressEnd(0,0,0)):this.ani=f}:void 0},i),{animationBuilder:o})),this.ionNavDidChange.emit(),!0}async lock(){const e=this.waitPromise;let n;return this.waitPromise=new Promise(i=>n=i),e!==void 0&&await e,n}render(){return Rt("slot",null)}get el(){return this}static get watchers(){return{swipeHandler:["swipeHandlerChanged"]}}static get style(){return MK}},[1,"ion-router-outlet",{mode:[1025],delegate:[16],animated:[4],animation:[16],swipeHandler:[16],commit:[64],setRouteId:[64],getRouteId:[64]}]);function OK(){if(typeof customElements>"u")return;["ion-router-outlet"].forEach(e=>{switch(e){case"ion-router-outlet":customElements.get(e)||customElements.define(e,PK);break}})}const DK=OK;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const RK=":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:0.55px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.2))));--color:var(--ion-tab-bar-color, var(--ion-color-step-600, #666666));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:50px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.tab-bar-translucent){--background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(210%) blur(20px);backdrop-filter:saturate(210%) blur(20px)}:host(.ion-color.tab-bar-translucent){background:rgba(var(--ion-color-base-rgb), 0.8)}:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.6)}}",LK=":host{-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:auto;padding-bottom:var(--ion-safe-area-bottom, 0);border-top:var(--border);background:var(--background);color:var(--color);text-align:center;contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host(.ion-color) ::slotted(ion-tab-button){--background-focused:var(--ion-color-shade);--color-selected:var(--ion-color-contrast)}:host(.ion-color) ::slotted(.tab-selected){color:var(--ion-color-contrast)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){color:rgba(var(--ion-color-contrast-rgb), 0.7)}:host(.ion-color),:host(.ion-color) ::slotted(ion-tab-button){background:var(--ion-color-base)}:host(.ion-color) ::slotted(ion-tab-button.ion-focused),:host(.tab-bar-translucent) ::slotted(ion-tab-button.ion-focused){background:var(--background-focused)}:host(.tab-bar-translucent) ::slotted(ion-tab-button){background:transparent}:host([slot=top]){padding-top:var(--ion-safe-area-top, 0);padding-bottom:0;border-top:0;border-bottom:var(--border)}:host(.tab-bar-hidden){display:none !important}:host{--background:var(--ion-tab-bar-background, var(--ion-background-color, #fff));--background-focused:var(--ion-tab-bar-background-focused, #e0e0e0);--border:1px solid var(--ion-tab-bar-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.07))));--color:var(--ion-tab-bar-color, var(--ion-color-step-650, #595959));--color-selected:var(--ion-tab-bar-color-selected, var(--ion-color-primary, #3880ff));height:56px}",zK=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabBarChanged=Wn(this,"ionTabBarChanged",7),this.keyboardCtrl=null,this.keyboardVisible=!1,this.color=void 0,this.selectedTab=void 0,this.translucent=!1}selectedTabChanged(){this.selectedTab!==void 0&&this.ionTabBarChanged.emit({tab:this.selectedTab})}componentWillLoad(){this.selectedTabChanged()}async connectedCallback(){this.keyboardCtrl=await JZ(async(e,n)=>{e===!1&&n!==void 0&&await n,this.keyboardVisible=e})}disconnectedCallback(){this.keyboardCtrl&&this.keyboardCtrl.destroy()}render(){const{color:e,translucent:n,keyboardVisible:i}=this,r=Xn(this),a=i&&this.el.getAttribute("slot")!=="top";return Rt(_r,{role:"tablist","aria-hidden":a?"true":null,class:Ml(e,{[r]:!0,"tab-bar-translucent":n,"tab-bar-hidden":a})},Rt("slot",null))}get el(){return this}static get watchers(){return{selectedTab:["selectedTabChanged"]}}static get style(){return{ios:RK,md:LK}}},[33,"ion-tab-bar",{color:[513],selectedTab:[1,"selected-tab"],translucent:[4],keyboardVisible:[32]}]);function BK(){if(typeof customElements>"u")return;["ion-tab-bar"].forEach(e=>{switch(e){case"ion-tab-bar":customElements.get(e)||customElements.define(e,zK);break}})}const FK=BK;/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const NK=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:2px;--padding-bottom:0;--padding-start:2px;max-width:240px;font-size:10px}::slotted(ion-badge){-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px;padding-top:1px;padding-bottom:1px;top:4px;height:auto;font-size:12px;line-height:16px}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-icon){margin-top:2px;margin-bottom:2px;font-size:30px}::slotted(ion-icon::before){vertical-align:top}::slotted(ion-label){margin-top:0;margin-bottom:1px;min-height:11px;font-weight:500}:host(.tab-has-label-only) ::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;font-size:12px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-label),:host(.tab-layout-icon-start) ::slotted(ion-label),:host(.tab-layout-icon-hide) ::slotted(ion-label){margin-top:2px;margin-bottom:2px;font-size:14px;line-height:1.1}:host(.tab-layout-icon-end) ::slotted(ion-icon),:host(.tab-layout-icon-start) ::slotted(ion-icon){min-width:24px;height:26px;margin-top:2px;margin-bottom:1px;font-size:24px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:calc(50% + 12px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:calc(50% + 12px)}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 12px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 12px)}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:1px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:4px}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:calc(50% + 35px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:calc(50% + 35px)}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 35px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 35px)}}}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:10px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:calc(50% + 30px)}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:calc(50% + 30px)}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 30px)}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 30px)}}}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:10px}:host(.tab-layout-label-hide) ::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}',$K=':host{--ripple-color:var(--color-selected);--background-focused-opacity:1;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;height:100%;outline:none;background:var(--background);color:var(--color)}.button-native{border-radius:inherit;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;border:0;outline:none;background:transparent;text-decoration:none;cursor:pointer;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-user-drag:none}.button-native::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:inherit;flex-flow:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:100%;height:100%;z-index:1}:host(.ion-focused) .button-native{color:var(--color-focused)}:host(.ion-focused) .button-native::after{background:var(--background-focused);opacity:var(--background-focused-opacity)}@media (any-hover: hover){a:hover{color:var(--color-selected)}}:host(.tab-selected){color:var(--color-selected)}:host(.tab-hidden){display:none !important}:host(.tab-disabled){pointer-events:none;opacity:0.4}::slotted(ion-label),::slotted(ion-icon){display:block;-ms-flex-item-align:center;align-self:center;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}::slotted(ion-label){-ms-flex-order:0;order:0}::slotted(ion-icon){-ms-flex-order:-1;order:-1;height:1em}:host(.tab-has-label-only) ::slotted(ion-label){white-space:normal}::slotted(ion-badge){-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;z-index:1}:host(.tab-layout-icon-start){-ms-flex-direction:row;flex-direction:row}:host(.tab-layout-icon-end){-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host(.tab-layout-icon-bottom){-ms-flex-direction:column-reverse;flex-direction:column-reverse}:host(.tab-layout-icon-hide) ::slotted(ion-icon){display:none}:host(.tab-layout-label-hide) ::slotted(ion-label){display:none}ion-ripple-effect{color:var(--ripple-color)}:host{--padding-top:0;--padding-end:12px;--padding-bottom:0;--padding-start:12px;max-width:168px;font-size:12px;font-weight:normal;letter-spacing:0.03em}::slotted(ion-label){margin-left:0;margin-right:0;margin-top:2px;margin-bottom:2px;text-transform:none}::slotted(ion-icon){margin-left:0;margin-right:0;margin-top:16px;margin-bottom:16px;-webkit-transform-origin:center center;transform-origin:center center;font-size:22px}:host-context([dir=rtl]) ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}[dir=rtl] ::slotted(ion-icon){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}@supports selector(:dir(rtl)){::slotted(ion-icon):dir(rtl){-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}}::slotted(ion-badge){border-radius:8px;-webkit-padding-start:2px;padding-inline-start:2px;-webkit-padding-end:2px;padding-inline-end:2px;padding-top:3px;padding-bottom:2px;top:8px;min-width:12px;font-size:8px;font-weight:normal}@supports (inset-inline-start: 0){::slotted(ion-badge){inset-inline-start:calc(50% + 6px)}}@supports not (inset-inline-start: 0){::slotted(ion-badge){left:calc(50% + 6px)}:host-context([dir=rtl]) ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}[dir=rtl] ::slotted(ion-badge){left:unset;right:unset;right:calc(50% + 6px)}@supports selector(:dir(rtl)){::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:calc(50% + 6px)}}}::slotted(ion-badge:empty){display:block;min-width:8px;height:8px}:host(.tab-layout-icon-top) ::slotted(ion-icon){margin-top:6px;margin-bottom:2px}:host(.tab-layout-icon-top) ::slotted(ion-label){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-badge){top:8px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-bottom) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-bottom) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-bottom ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-bottom) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-bottom) ::slotted(ion-icon){margin-top:0;margin-bottom:6px}:host(.tab-layout-icon-bottom) ::slotted(ion-label){margin-top:6px;margin-bottom:0}:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){inset-inline-start:80%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-start) ::slotted(ion-badge),:host(.tab-layout-icon-end) ::slotted(ion-badge){left:80%}:host-context([dir=rtl]):host(.tab-layout-icon-start) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-start ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-layout-icon-end) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-end ::slotted(ion-badge){left:unset;right:unset;right:80%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-start) ::slotted(ion-badge):dir(rtl),:host(.tab-layout-icon-end) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:80%}}}:host(.tab-layout-icon-start) ::slotted(ion-icon){-webkit-margin-end:6px;margin-inline-end:6px}:host(.tab-layout-icon-end) ::slotted(ion-icon){-webkit-margin-start:6px;margin-inline-start:6px}:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){top:16px}@supports (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){inset-inline-start:70%}}@supports not (inset-inline-start: 0){:host(.tab-layout-icon-hide) ::slotted(ion-badge),:host(.tab-has-label-only) ::slotted(ion-badge){left:70%}:host-context([dir=rtl]):host(.tab-layout-icon-hide) ::slotted(ion-badge),:host-context([dir=rtl]).tab-layout-icon-hide ::slotted(ion-badge),:host-context([dir=rtl]):host(.tab-has-label-only) ::slotted(ion-badge),:host-context([dir=rtl]).tab-has-label-only ::slotted(ion-badge){left:unset;right:unset;right:70%}@supports selector(:dir(rtl)){:host(.tab-layout-icon-hide) ::slotted(ion-badge):dir(rtl),:host(.tab-has-label-only) ::slotted(ion-badge):dir(rtl){left:unset;right:unset;right:70%}}}:host(.tab-layout-icon-hide) ::slotted(ion-label),:host(.tab-has-label-only) ::slotted(ion-label){margin-top:0;margin-bottom:0}:host(.tab-layout-label-hide) ::slotted(ion-badge),:host(.tab-has-icon-only) ::slotted(ion-badge){top:16px}:host(.tab-layout-label-hide) ::slotted(ion-icon),:host(.tab-has-icon-only) ::slotted(ion-icon){margin-top:0;margin-bottom:0;font-size:24px}',jK=xr(class extends wr{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.ionTabButtonClick=Wn(this,"ionTabButtonClick",7),this.inheritedAttributes={},this.onKeyUp=e=>{(e.key==="Enter"||e.key===" ")&&this.selectTab(e)},this.onClick=e=>{this.selectTab(e)},this.disabled=!1,this.download=void 0,this.href=void 0,this.rel=void 0,this.layout=void 0,this.selected=!1,this.tab=void 0,this.target=void 0}onTabBarChanged(e){const n=e.target,i=this.el.parentElement;(e.composedPath().includes(i)||n!=null&&n.contains(this.el))&&(this.selected=this.tab===e.detail.tab)}componentWillLoad(){this.inheritedAttributes=Object.assign({},ym(this.el,["aria-label"])),this.layout===void 0&&(this.layout=_i.get("tabButtonLayout","icon-top"))}selectTab(e){this.tab!==void 0&&(this.disabled||this.ionTabButtonClick.emit({tab:this.tab,href:this.href,selected:this.selected}),e.preventDefault())}get hasLabel(){return!!this.el.querySelector("ion-label")}get hasIcon(){return!!this.el.querySelector("ion-icon")}render(){const{disabled:e,hasIcon:n,hasLabel:i,href:r,rel:a,target:d,layout:o,selected:f,tab:g,inheritedAttributes:_}=this,w=Xn(this),T={download:this.download,href:r,rel:a,target:d};return Rt(_r,{onClick:this.onClick,onKeyup:this.onKeyUp,id:g!==void 0?`tab-button-${g}`:null,class:{[w]:!0,"tab-selected":f,"tab-disabled":e,"tab-has-label":i,"tab-has-icon":n,"tab-has-label-only":i&&!n,"tab-has-icon-only":n&&!i,[`tab-layout-${o}`]:!0,"ion-activatable":!0,"ion-selectable":!0,"ion-focusable":!0}},Rt("a",Object.assign({},T,{class:"button-native",part:"native",role:"tab","aria-selected":f?"true":null,"aria-disabled":e?"true":null,tabindex:e?"-1":void 0},_),Rt("span",{class:"button-inner"},Rt("slot",null)),w==="md"&&Rt("ion-ripple-effect",{type:"unbounded"})))}get el(){return this}static get style(){return{ios:NK,md:$K}}},[33,"ion-tab-button",{disabled:[4],download:[1],href:[1],rel:[1],layout:[1025],selected:[1028],tab:[1],target:[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]]);function VK(){if(typeof customElements>"u")return;["ion-tab-button","ion-ripple-effect"].forEach(e=>{switch(e){case"ion-tab-button":customElements.get(e)||customElements.define(e,jK);break;case"ion-ripple-effect":customElements.get(e)||TZ();break}})}const UK=VK,Qf={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,safari10:!1,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,cssVarShim:!1,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,dynamicImportShim:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0};let ep,HN,P1,ZN=!1,xx=!1,PI=!1,Ls=!1,VR=null,HT=!1;const qK=t=>{const e=new URL(t,Fo.$resourcesUrl$);return e.origin!==Uv.location.origin?e.href:e.pathname},Ih=(t,e="")=>()=>{},UR="http://www.w3.org/1999/xlink",qR={},WK="http://www.w3.org/2000/svg",GK="http://www.w3.org/1999/xhtml",HK=t=>t!=null,OI=t=>(t=typeof t,t==="object"||t==="function");function ZK(t){var e,n,i;return(i=(n=(e=t.head)===null||e===void 0?void 0:e.querySelector('meta[name="csp-nonce"]'))===null||n===void 0?void 0:n.getAttribute("content"))!==null&&i!==void 0?i:void 0}const jy=(t,e,...n)=>{let i=null,r=null,a=null,d=!1,o=!1;const f=[],g=w=>{for(let T=0;T<w.length;T++)i=w[T],Array.isArray(i)?g(i):i!=null&&typeof i!="boolean"&&((d=typeof t!="function"&&!OI(i))&&(i=String(i)),d&&o?f[f.length-1].$text$+=i:f.push(d?wx(null,i):i),o=d)};if(g(n),e){e.key&&(r=e.key),e.name&&(a=e.name);{const w=e.className||e.class;w&&(e.class=typeof w!="object"?w:Object.keys(w).filter(T=>w[T]).join(" "))}}if(typeof t=="function")return t(e===null?{}:e,f,KK);const _=wx(t,null);return _.$attrs$=e,f.length>0&&(_.$children$=f),_.$key$=r,_.$name$=a,_},wx=(t,e)=>{const n={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return n.$attrs$=null,n.$key$=null,n.$name$=null,n},XN={},XK=t=>t&&t.$tag$===XN,KK={forEach:(t,e)=>t.map(WR).forEach(e),map:(t,e)=>t.map(WR).map(e).map(YK)},WR=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),YK=t=>{if(typeof t.vtag=="function"){const n=Object.assign({},t.vattrs);return t.vkey&&(n.key=t.vkey),t.vname&&(n.name=t.vname),jy(t.vtag,n,...t.vchildren||[])}const e=wx(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},JK=t=>EY.map(e=>e(t)).find(e=>!!e),QK=(t,e)=>t!=null&&!OI(t)?e&4?t==="false"?!1:t===""||!!t:e&2?parseFloat(t):e&1?String(t):t:t,GR=new WeakMap,eY=(t,e,n)=>{let i=Ex.get(t);IY&&n?(i=i||new CSSStyleSheet,typeof i=="string"?i=e:i.replaceSync(e)):i=e,Ex.set(t,i)},tY=(t,e,n,i)=>{var r;let a=KN(e,n);const d=Ex.get(a);if(t=t.nodeType===11?t:Ya,d)if(typeof d=="string"){t=t.head||t;let o=GR.get(t),f;if(o||GR.set(t,o=new Set),!o.has(a)){{f=Ya.createElement("style"),f.innerHTML=d;const g=(r=Fo.$nonce$)!==null&&r!==void 0?r:ZK(Ya);g!=null&&f.setAttribute("nonce",g),t.insertBefore(f,t.querySelector("link"))}o&&o.add(a)}}else t.adoptedStyleSheets.includes(d)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,d]);return a},nY=t=>{const e=t.$cmpMeta$,n=t.$hostElement$,i=e.$flags$,r=Ih("attachStyles",e.$tagName$),a=tY(n.shadowRoot?n.shadowRoot:n.getRootNode(),e,t.$modeName$);i&10&&(n["s-sc"]=a,n.classList.add(a+"-h"),i&2&&n.classList.add(a+"-s")),r()},KN=(t,e)=>"sc-"+(e&&t.$flags$&32?t.$tagName$+"-"+e:t.$tagName$),HR=(t,e,n,i,r,a)=>{if(n!==i){let d=YR(t,e),o=e.toLowerCase();if(e==="class"){const f=t.classList,g=ZR(n),_=ZR(i);f.remove(...g.filter(w=>w&&!_.includes(w))),f.add(..._.filter(w=>w&&!g.includes(w)))}else if(e==="style"){for(const f in n)(!i||i[f]==null)&&(f.includes("-")?t.style.removeProperty(f):t.style[f]="");for(const f in i)(!n||i[f]!==n[f])&&(f.includes("-")?t.style.setProperty(f,i[f]):t.style[f]=i[f])}else if(e!=="key")if(e==="ref")i&&i(t);else if(!t.__lookupSetter__(e)&&e[0]==="o"&&e[1]==="n")e[2]==="-"?e=e.slice(3):YR(Uv,o)?e=o.slice(2):e=o[2]+e.slice(3),n&&Fo.rel(t,e,n,!1),i&&Fo.ael(t,e,i,!1);else{const f=OI(i);if((d||f&&i!==null)&&!r)try{if(t.tagName.includes("-"))t[e]=i;else{const _=i==null?"":i;e==="list"?d=!1:(n==null||t[e]!=_)&&(t[e]=_)}}catch(_){}let g=!1;o!==(o=o.replace(/^xlink\:?/,""))&&(e=o,g=!0),i==null||i===!1?(i!==!1||t.getAttribute(e)==="")&&(g?t.removeAttributeNS(UR,e):t.removeAttribute(e)):(!d||a&4||r)&&!f&&(i=i===!0?"":i,g?t.setAttributeNS(UR,e,i):t.setAttribute(e,i))}}},iY=/\s/,ZR=t=>t?t.split(iY):[],YN=(t,e,n,i)=>{const r=e.$elm$.nodeType===11&&e.$elm$.host?e.$elm$.host:e.$elm$,a=t&&t.$attrs$||qR,d=e.$attrs$||qR;for(i in a)i in d||HR(r,i,a[i],void 0,n,e.$flags$);for(i in d)HR(r,i,a[i],d[i],n,e.$flags$)},Sx=(t,e,n,i)=>{const r=e.$children$[n];let a=0,d,o,f;if(ZN||(PI=!0,r.$tag$==="slot"&&(ep&&i.classList.add(ep+"-s"),r.$flags$|=r.$children$?2:1)),r.$text$!==null)d=r.$elm$=Ya.createTextNode(r.$text$);else if(r.$flags$&1)d=r.$elm$=Ya.createTextNode("");else{if(Ls||(Ls=r.$tag$==="svg"),d=r.$elm$=Ya.createElementNS(Ls?WK:GK,r.$flags$&2?"slot-fb":r.$tag$),Ls&&r.$tag$==="foreignObject"&&(Ls=!1),YN(null,r,Ls),HK(ep)&&d["s-si"]!==ep&&d.classList.add(d["s-si"]=ep),r.$children$)for(a=0;a<r.$children$.length;++a)o=Sx(t,r,a,d),o&&d.appendChild(o);r.$tag$==="svg"?Ls=!1:d.tagName==="foreignObject"&&(Ls=!0)}return d["s-hn"]=P1,r.$flags$&3&&(d["s-sr"]=!0,d["s-cr"]=HN,d["s-sn"]=r.$name$||"",f=t&&t.$children$&&t.$children$[n],f&&f.$tag$===r.$tag$&&t.$elm$&&gv(t.$elm$,!1)),d},gv=(t,e)=>{Fo.$flags$|=1;const n=t.childNodes;for(let i=n.length-1;i>=0;i--){const r=n[i];r["s-hn"]!==P1&&r["s-ol"]&&(e5(r).insertBefore(r,DI(r)),r["s-ol"].remove(),r["s-ol"]=void 0,PI=!0),e&&gv(r,e)}Fo.$flags$&=-2},JN=(t,e,n,i,r,a)=>{let d=t["s-cr"]&&t["s-cr"].parentNode||t,o;for(d.shadowRoot&&d.tagName===P1&&(d=d.shadowRoot);r<=a;++r)i[r]&&(o=Sx(null,n,r,t),o&&(i[r].$elm$=o,d.insertBefore(o,DI(e))))},QN=(t,e,n,i,r)=>{for(;e<=n;++e)(i=t[e])&&(r=i.$elm$,i5(i),xx=!0,r["s-ol"]?r["s-ol"].remove():gv(r,!0),r.remove())},rY=(t,e,n,i)=>{let r=0,a=0,d=0,o=0,f=e.length-1,g=e[0],_=e[f],w=i.length-1,T=i[0],A=i[w],D,z;for(;r<=f&&a<=w;)if(g==null)g=e[++r];else if(_==null)_=e[--f];else if(T==null)T=i[++a];else if(A==null)A=i[--w];else if(Ub(g,T))tp(g,T),g=e[++r],T=i[++a];else if(Ub(_,A))tp(_,A),_=e[--f],A=i[--w];else if(Ub(g,A))(g.$tag$==="slot"||A.$tag$==="slot")&&gv(g.$elm$.parentNode,!1),tp(g,A),t.insertBefore(g.$elm$,_.$elm$.nextSibling),g=e[++r],A=i[--w];else if(Ub(_,T))(g.$tag$==="slot"||A.$tag$==="slot")&&gv(_.$elm$.parentNode,!1),tp(_,T),t.insertBefore(_.$elm$,g.$elm$),_=e[--f],T=i[++a];else{for(d=-1,o=r;o<=f;++o)if(e[o]&&e[o].$key$!==null&&e[o].$key$===T.$key$){d=o;break}d>=0?(z=e[d],z.$tag$!==T.$tag$?D=Sx(e&&e[a],n,d,t):(tp(z,T),e[d]=void 0,D=z.$elm$),T=i[++a]):(D=Sx(e&&e[a],n,a,t),T=i[++a]),D&&e5(g.$elm$).insertBefore(D,DI(g.$elm$))}r>f?JN(t,i[w+1]==null?null:i[w+1].$elm$,n,i,a,w):a>w&&QN(e,r,f)},Ub=(t,e)=>t.$tag$===e.$tag$?t.$tag$==="slot"?t.$name$===e.$name$:t.$key$===e.$key$:!1,DI=t=>t&&t["s-ol"]||t,e5=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,tp=(t,e)=>{const n=e.$elm$=t.$elm$,i=t.$children$,r=e.$children$,a=e.$tag$,d=e.$text$;let o;d===null?(Ls=a==="svg"?!0:a==="foreignObject"?!1:Ls,a==="slot"||YN(t,e,Ls),i!==null&&r!==null?rY(n,i,e,r):r!==null?(t.$text$!==null&&(n.textContent=""),JN(n,null,e,r,0,r.length-1)):i!==null&&QN(i,0,i.length-1),Ls&&a==="svg"&&(Ls=!1)):(o=n["s-cr"])?o.parentNode.textContent=d:t.$text$!==d&&(n.data=d)},t5=t=>{const e=t.childNodes;let n,i,r,a,d,o;for(i=0,r=e.length;i<r;i++)if(n=e[i],n.nodeType===1){if(n["s-sr"]){for(d=n["s-sn"],n.hidden=!1,a=0;a<r;a++)if(o=e[a].nodeType,e[a]["s-hn"]!==n["s-hn"]||d!==""){if(o===1&&d===e[a].getAttribute("slot")){n.hidden=!0;break}}else if(o===1||o===3&&e[a].textContent.trim()!==""){n.hidden=!0;break}}t5(n)}},Ua=[],n5=t=>{let e,n,i,r,a,d,o=0;const f=t.childNodes,g=f.length;for(;o<g;o++){if(e=f[o],e["s-sr"]&&(n=e["s-cr"])&&n.parentNode)for(i=n.parentNode.childNodes,r=e["s-sn"],d=i.length-1;d>=0;d--)n=i[d],!n["s-cn"]&&!n["s-nr"]&&n["s-hn"]!==e["s-hn"]&&(XR(n,r)?(a=Ua.find(_=>_.$nodeToRelocate$===n),xx=!0,n["s-sn"]=n["s-sn"]||r,a?a.$slotRefNode$=e:Ua.push({$slotRefNode$:e,$nodeToRelocate$:n}),n["s-sr"]&&Ua.map(_=>{XR(_.$nodeToRelocate$,n["s-sn"])&&(a=Ua.find(w=>w.$nodeToRelocate$===n),a&&!_.$slotRefNode$&&(_.$slotRefNode$=a.$slotRefNode$))})):Ua.some(_=>_.$nodeToRelocate$===n)||Ua.push({$nodeToRelocate$:n}));e.nodeType===1&&n5(e)}},XR=(t,e)=>t.nodeType===1?t.getAttribute("slot")===null&&e===""||t.getAttribute("slot")===e:t["s-sn"]===e?!0:e==="",i5=t=>{t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(i5)},oY=(t,e)=>{const n=t.$hostElement$,i=t.$cmpMeta$,r=t.$vnode$||wx(null,null),a=XK(e)?e:jy(null,null,e);P1=n.tagName,i.$attrsToReflect$&&(a.$attrs$=a.$attrs$||{},i.$attrsToReflect$.map(([d,o])=>a.$attrs$[o]=n[d])),a.$tag$=null,a.$flags$|=4,t.$vnode$=a,a.$elm$=r.$elm$=n.shadowRoot||n,ep=n["s-sc"],HN=n["s-cr"],ZN=(i.$flags$&1)!==0,xx=!1,tp(r,a);{if(Fo.$flags$|=1,PI){n5(a.$elm$);let d,o,f,g,_,w,T=0;for(;T<Ua.length;T++)d=Ua[T],o=d.$nodeToRelocate$,o["s-ol"]||(f=Ya.createTextNode(""),f["s-nr"]=o,o.parentNode.insertBefore(o["s-ol"]=f,o));for(T=0;T<Ua.length;T++)if(d=Ua[T],o=d.$nodeToRelocate$,d.$slotRefNode$){for(g=d.$slotRefNode$.parentNode,_=d.$slotRefNode$.nextSibling,f=o["s-ol"];f=f.previousSibling;)if(w=f["s-nr"],w&&w["s-sn"]===o["s-sn"]&&g===w.parentNode&&(w=w.nextSibling,!w||!w["s-nr"])){_=w;break}(!_&&g!==o.parentNode||o.nextSibling!==_)&&o!==_&&(!o["s-hn"]&&o["s-ol"]&&(o["s-hn"]=o["s-ol"].parentNode.nodeName),g.insertBefore(o,_))}else o.nodeType===1&&(o.hidden=!0)}xx&&t5(a.$elm$),Fo.$flags$&=-2,Ua.length=0}},sY=(t,e)=>{},r5=(t,e)=>(t.$flags$|=16,sY(t,t.$ancestorComponent$),PY(()=>aY(t,e))),aY=(t,e)=>{const n=t.$hostElement$,i=Ih("scheduleUpdate",t.$cmpMeta$.$tagName$),r=n;let a;return e?a=Mp(r,"componentWillLoad"):a=Mp(r,"componentWillUpdate"),a=KR(a,()=>Mp(r,"componentWillRender")),i(),KR(a,()=>lY(t,r,e))},lY=async(t,e,n)=>{const i=t.$hostElement$,r=Ih("update",t.$cmpMeta$.$tagName$);i["s-rc"],n&&nY(t);const a=Ih("render",t.$cmpMeta$.$tagName$);cY(t,e,i),a(),r(),uY(t)},cY=(t,e,n)=>{try{VR=e,e=e.render&&e.render(),t.$flags$&=-17,t.$flags$|=2,(Qf.hasRenderFn||Qf.reflect)&&(Qf.vdomRender||Qf.reflect)&&(Qf.hydrateServerSide||oY(t,e))}catch(o){Vv(o,t.$hostElement$)}return VR=null,null},uY=t=>{const e=t.$cmpMeta$.$tagName$,n=t.$hostElement$,i=Ih("postUpdate",e),r=n;t.$ancestorComponent$,Mp(r,"componentDidRender"),t.$flags$&64?(Mp(r,"componentDidUpdate"),i()):(t.$flags$|=64,Mp(r,"componentDidLoad"),i())},Mp=(t,e,n)=>{if(t&&t[e])try{return t[e](n)}catch(i){Vv(i)}},KR=(t,e)=>t&&t.then?t.then(e):e(),dY=(t,e)=>O1(t).$instanceValues$.get(e),hY=(t,e,n,i)=>{const r=O1(t),a=t,d=r.$instanceValues$.get(e),o=r.$flags$,f=a;n=QK(n,i.$members$[e][0]);const g=Number.isNaN(d)&&Number.isNaN(n);if(n!==d&&!g){r.$instanceValues$.set(e,n);{if(i.$watchers$&&o&128){const w=i.$watchers$[e];w&&w.map(T=>{try{f[T](n,d,e)}catch(A){Vv(A,a)}})}if((o&18)===2){if(f.componentShouldUpdate&&f.componentShouldUpdate(n,d,e)===!1)return;r5(r,!1)}}}},fY=(t,e,n)=>{if(e.$members$){t.watchers&&(e.$watchers$=t.watchers);const i=Object.entries(e.$members$),r=t.prototype;i.map(([a,[d]])=>{(d&31||d&32)&&Object.defineProperty(r,a,{get(){return dY(this,a)},set(o){hY(this,a,o,e)},configurable:!0,enumerable:!0})});{const a=new Map;r.attributeChangedCallback=function(d,o,f){Fo.jmp(()=>{const g=a.get(d);if(this.hasOwnProperty(g))f=this[g],delete this[g];else if(r.hasOwnProperty(g)&&typeof this[g]=="number"&&this[g]==f)return;this[g]=f===null&&typeof this[g]=="boolean"?!1:f})},t.observedAttributes=i.filter(([d,o])=>o[0]&15).map(([d,o])=>{const f=o[1]||d;return a.set(f,d),o[0]&512&&e.$attrsToReflect$.push([d,f]),f})}}return t},pY=async(t,e,n,i,r)=>{if(!(e.$flags$&32)&&(r=t.constructor,e.$flags$|=32,customElements.whenDefined(n.$tagName$).then(()=>e.$flags$|=128),r.style)){let d=r.style;typeof d!="string"&&(d=d[e.$modeName$=JK(t)]);const o=KN(n,e.$modeName$);if(!Ex.has(o)){const f=Ih("registerStyles",n.$tagName$);eY(o,d,!!(n.$flags$&1)),f()}}e.$ancestorComponent$,(()=>r5(e,!0))()},mY=t=>{},gY=t=>{if(!(Fo.$flags$&1)){const e=O1(t),n=e.$cmpMeta$,i=Ih("connectedCallback",n.$tagName$);e.$flags$&1?(o5(t,e,n.$listeners$),mY(e.$lazyInstance$)):(e.$flags$|=1,n.$flags$&12&&yY(t),n.$members$&&Object.entries(n.$members$).map(([r,[a]])=>{if(a&31&&t.hasOwnProperty(r)){const d=t[r];delete t[r],t[r]=d}}),pY(t,e,n)),i()}},yY=t=>{const e=t["s-cr"]=Ya.createComment("");e["s-cn"]=!0,t.insertBefore(e,t.firstChild)},vY=t=>{if(!(Fo.$flags$&1)){const e=O1(t);e.$rmListeners$&&(e.$rmListeners$.map(n=>n()),e.$rmListeners$=void 0)}},bY=(t,e)=>{const n={$flags$:e[0],$tagName$:e[1]};n.$members$=e[2],n.$listeners$=e[3],n.$watchers$=t.$watchers$,n.$attrsToReflect$=[];const i=t.prototype.connectedCallback,r=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){SY(this,n)},connectedCallback(){gY(this),i&&i.call(this)},disconnectedCallback(){vY(this),r&&r.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(n.$flags$&16)})}}),t.is=n.$tagName$,fY(t,n)},o5=(t,e,n,i)=>{n&&n.map(([r,a,d])=>{const o=xY(t,r),f=_Y(e,d),g=wY(r);Fo.ael(o,a,f,g),(e.$rmListeners$=e.$rmListeners$||[]).push(()=>Fo.rel(o,a,f,g))})},_Y=(t,e)=>n=>{try{Qf.lazyLoad||t.$hostElement$[e](n)}catch(i){Vv(i)}},xY=(t,e)=>e&4?Ya:e&8?Uv:e&16?Ya.body:t,wY=t=>TY?{passive:(t&1)!==0,capture:(t&2)!==0}:(t&2)!==0,s5=new WeakMap,O1=t=>s5.get(t),SY=(t,e)=>{const n={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};return o5(t,n,e.$listeners$),s5.set(t,n)},YR=(t,e)=>e in t,Vv=(t,e)=>(0,console.error)(t,e),Ex=new Map,EY=[],Uv=typeof window<"u"?window:{},Ya=Uv.document||{head:{}},kY=Uv.HTMLElement||class{},Fo={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,n,i)=>t.addEventListener(e,n,i),rel:(t,e,n,i)=>t.removeEventListener(e,n,i),ce:(t,e)=>new CustomEvent(t,e)},TY=(()=>{let t=!1;try{Ya.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch(e){}return t})(),CY=t=>Promise.resolve(t),IY=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch(t){}return!1})(),JR=[],a5=[],AY=(t,e)=>n=>{t.push(n),HT||(HT=!0,e&&Fo.$flags$&4?MY(ZT):Fo.raf(ZT))},QR=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(n){Vv(n)}t.length=0},ZT=()=>{QR(JR),QR(a5),(HT=JR.length>0)&&Fo.raf(ZT)},MY=t=>CY().then(t),PY=AY(a5,!0);let $E;const OY=()=>{if(typeof window>"u")return new Map;if(!$E){const t=window;t.Ionicons=t.Ionicons||{},$E=t.Ionicons.map=t.Ionicons.map||new Map}return $E},DY=t=>{let e=jE(t.src);return e||(e=l5(t.name,t.icon,t.mode,t.ios,t.md),e?RY(e):t.icon&&(e=jE(t.icon),e||(e=jE(t.icon[t.mode]),e))?e:null)},RY=t=>{const e=OY().get(t);return e||qK(`svg/${t}.svg`)},l5=(t,e,n,i,r)=>(n=(n&&qb(n))==="ios"?"ios":"md",i&&n==="ios"?t=qb(i):r&&n==="md"?t=qb(r):(!t&&e&&!c5(e)&&(t=e),kx(t)&&(t=qb(t))),!kx(t)||t.trim()===""||t.replace(/[a-z]|-|\d/gi,"")!==""?null:t),jE=t=>kx(t)&&(t=t.trim(),c5(t))?t:null,c5=t=>t.length>0&&/(\/|\.)/.test(t),kx=t=>typeof t=="string",qb=t=>t.toLowerCase(),LY=(t,e=[])=>{const n={};return e.forEach(i=>{t.hasAttribute(i)&&(t.getAttribute(i)!==null&&(n[i]=t.getAttribute(i)),t.removeAttribute(i))}),n},zY=t=>t&&t.dir!==""?t.dir.toLowerCase()==="rtl":(document==null?void 0:document.dir.toLowerCase())==="rtl",BY=t=>{const e=document.createElement("div");e.innerHTML=t;for(let i=e.childNodes.length-1;i>=0;i--)e.childNodes[i].nodeName.toLowerCase()!=="svg"&&e.removeChild(e.childNodes[i]);const n=e.firstElementChild;if(n&&n.nodeName.toLowerCase()==="svg"){const i=n.getAttribute("class")||"";if(n.setAttribute("class",(i+" s-ion-icon").trim()),u5(n))return e.innerHTML}return""},u5=t=>{if(t.nodeType===1){if(t.nodeName.toLowerCase()==="script")return!1;for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;if(kx(n)&&n.toLowerCase().indexOf("on")===0)return!1}for(let e=0;e<t.childNodes.length;e++)if(!u5(t.childNodes[e]))return!1}return!0},FY=t=>t.startsWith("data:image/svg+xml"),NY=t=>t.indexOf(";utf8,")!==-1,th=new Map,eL=new Map;let VE;const $Y=(t,e)=>{let n=eL.get(t);if(!n)if(typeof fetch<"u"&&typeof document<"u")if(FY(t)&&NY(t)){VE||(VE=new DOMParser);const r=VE.parseFromString(t,"text/html").querySelector("svg");return r&&th.set(t,r.outerHTML),Promise.resolve()}else n=fetch(t).then(i=>{if(i.ok)return i.text().then(r=>{r&&e!==!1&&(r=BY(r)),th.set(t,r||"")});th.set(t,"")}),eL.set(t,n);else return th.set(t,""),Promise.resolve();return n},jY=":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box !important;box-sizing:content-box !important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width, 32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}@supports (background: -webkit-named-image(i)){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}@supports not selector(:dir(rtl)) and selector(:host-context([dir='rtl'])){:host(.icon-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}}:host(.flip-rtl):host-context([dir='rtl']) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@supports selector(:dir(rtl)){:host(.flip-rtl:dir(rtl)) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.flip-rtl:dir(ltr)) .icon-inner{-webkit-transform:scaleX(1);transform:scaleX(1)}}:host(.icon-small){font-size:18px !important}:host(.icon-large){font-size:32px !important}:host(.ion-color){color:var(--ion-color-base) !important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary, #3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary, #0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary, #f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success, #10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning, #ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger, #f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light, #f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium, #989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark, #222428)}",VY=bY(class extends kY{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.iconName=null,this.inheritedAttributes={},this.isVisible=!1,this.mode=UY(),this.lazy=!1,this.sanitize=!0}componentWillLoad(){this.inheritedAttributes=LY(this.el,["aria-label"])}connectedCallback(){this.waitUntilVisible(this.el,"50px",()=>{this.isVisible=!0,this.loadIcon()})}disconnectedCallback(){this.io&&(this.io.disconnect(),this.io=void 0)}waitUntilVisible(t,e,n){if(this.lazy&&typeof window<"u"&&window.IntersectionObserver){const i=this.io=new window.IntersectionObserver(r=>{r[0].isIntersecting&&(i.disconnect(),this.io=void 0,n())},{rootMargin:e});i.observe(t)}else n()}loadIcon(){if(this.isVisible){const t=DY(this);t&&(th.has(t)?this.svgContent=th.get(t):$Y(t,this.sanitize).then(()=>this.svgContent=th.get(t)))}this.iconName=l5(this.name,this.icon,this.mode,this.ios,this.md)}render(){const{flipRtl:t,iconName:e,inheritedAttributes:n,el:i}=this,r=this.mode||"md",a=e?(e.includes("arrow")||e.includes("chevron"))&&t!==!1:!1,d=t||a;return jy(XN,Object.assign({role:"img",class:Object.assign(Object.assign({[r]:!0},qY(this.color)),{[`icon-${this.size}`]:!!this.size,"flip-rtl":d,"icon-rtl":d&&zY(i)})},n),this.svgContent?jy("div",{class:"icon-inner",innerHTML:this.svgContent}):jy("div",{class:"icon-inner"}))}static get assetsDirs(){return["svg"]}get el(){return this}static get watchers(){return{name:["loadIcon"],src:["loadIcon"],icon:["loadIcon"],ios:["loadIcon"],md:["loadIcon"]}}static get style(){return jY}},[1,"ion-icon",{mode:[1025],color:[1],ios:[1],md:[1],flipRtl:[4,"flip-rtl"],name:[513],src:[1],icon:[8],size:[1],lazy:[4],sanitize:[4],svgContent:[32],isVisible:[32]}]),UY=()=>typeof document<"u"&&document.documentElement.getAttribute("mode")||"md",qY=t=>t?{"ion-color":!0,[`ion-color-${t}`]:!0}:null;function WY(){if(typeof customElements>"u")return;["ion-icon"].forEach(e=>{switch(e){case"ion-icon":customElements.get(e)||customElements.define(e,VY);break}})}const GY=WY,RI=We.createContext({onIonViewWillEnter:()=>{},ionViewWillEnter:()=>{},onIonViewDidEnter:()=>{},ionViewDidEnter:()=>{},onIonViewWillLeave:()=>{},ionViewWillLeave:()=>{},onIonViewDidLeave:()=>{},ionViewDidLeave:()=>{}}),HY=class{constructor(){this.ionViewWillEnterCallbacks=[],this.ionViewDidEnterCallbacks=[],this.ionViewWillLeaveCallbacks=[],this.ionViewDidLeaveCallbacks=[]}onIonViewWillEnter(t){if(t.id){const e=this.ionViewWillEnterCallbacks.findIndex(n=>n.id===t.id);e>-1?this.ionViewWillEnterCallbacks[e]=t:this.ionViewWillEnterCallbacks.push(t)}else this.ionViewWillEnterCallbacks.push(t)}ionViewWillEnter(){this.ionViewWillEnterCallbacks.forEach(t=>t())}onIonViewDidEnter(t){if(t.id){const e=this.ionViewDidEnterCallbacks.findIndex(n=>n.id===t.id);e>-1?this.ionViewDidEnterCallbacks[e]=t:this.ionViewDidEnterCallbacks.push(t)}else this.ionViewDidEnterCallbacks.push(t)}ionViewDidEnter(){this.ionViewDidEnterCallbacks.forEach(t=>t())}onIonViewWillLeave(t){if(t.id){const e=this.ionViewWillLeaveCallbacks.findIndex(n=>n.id===t.id);e>-1?this.ionViewWillLeaveCallbacks[e]=t:this.ionViewWillLeaveCallbacks.push(t)}else this.ionViewWillLeaveCallbacks.push(t)}ionViewWillLeave(){this.ionViewWillLeaveCallbacks.forEach(t=>t())}onIonViewDidLeave(t){if(t.id){const e=this.ionViewDidLeaveCallbacks.findIndex(n=>n.id===t.id);e>-1?this.ionViewDidLeaveCallbacks[e]=t:this.ionViewDidLeaveCallbacks.push(t)}else this.ionViewDidLeaveCallbacks.push(t)}ionViewDidLeave(){this.ionViewDidLeaveCallbacks.forEach(t=>t()),this.componentCanBeDestroyed()}onComponentCanBeDestroyed(t){this.componentCanBeDestroyedCallback=t}componentCanBeDestroyed(){this.componentCanBeDestroyedCallback&&this.componentCanBeDestroyedCallback()}},Ll=We.createContext({getIonRedirect:()=>{},getIonRoute:()=>{},getPageManager:()=>{},getStackManager:()=>{},goBack:t=>{typeof window<"u"&&(typeof t=="string"?window.location.pathname=t:window.history.back())},navigate:t=>{typeof window<"u"&&(window.location.pathname=t)},hasIonicRouter:()=>!1,routeInfo:void 0,setCurrentTab:()=>{},changeTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)},resetTab:(t,e)=>{typeof window<"u"&&(window.location.pathname=e)}}),LI=t=>t.toLowerCase().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(""),D1=t=>t.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`),zI=(t,e,n={})=>{if(t instanceof Element){const i=ZY(t.classList,e,n);i!==""&&(t.className=i),Object.keys(e).forEach(r=>{if(!(r==="children"||r==="style"||r==="ref"||r==="class"||r==="className"||r==="forwardedRef"))if(r.indexOf("on")===0&&r[2]===r[2].toUpperCase()){const a=r.substring(2),d=a[0].toLowerCase()+a.substring(1);qv(d)||KY(t,d,e[r])}else t[r]=e[r],typeof e[r]==="string"&&t.setAttribute(D1(r),e[r])})}},ZY=(t,e,n)=>{const i=e.className||e.class,r=n.className||n.class,a=UE(t),d=UE(i?i.split(" "):[]),o=UE(r?r.split(" "):[]),f=[];return a.forEach(g=>{d.has(g)?(f.push(g),d.delete(g)):o.has(g)||f.push(g)}),d.forEach(g=>f.push(g)),f.join(" ")},XY=t=>{switch(t){case"doubleclick":return"dblclick"}return t};/**
 * Checks if an event is supported in the current execution environment.
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */const qv=t=>{if(typeof document>"u")return!0;{const e="on"+XY(t);let n=e in document;if(!n){const i=document.createElement("div");i.setAttribute(e,"return;"),n=typeof i[e]=="function"}return n}},KY=(t,e,n)=>{const i=t.__events||(t.__events={}),r=i[e];r&&t.removeEventListener(e,r),t.addEventListener(e,i[e]=function(d){n&&n.call(this,d)})},UE=t=>{const e=new Map;return t.forEach(n=>e.set(n,n)),e},YY=(t,e)=>{typeof t=="function"?t(e):t!=null&&(t.current=e)},R1=(...t)=>e=>{t.forEach(n=>{YY(n,e)})},JY=(t,e)=>{const n=(i,r)=>We.createElement(t,Object.assign({},i,{forwardedRef:r}));return n.displayName=e,We.forwardRef(n)},QY=(t,e)=>{e!==void 0&&typeof customElements<"u"&&!customElements.get(t)&&customElements.define(t,e)},No=(t,e,n,i)=>{i!==void 0&&i();const r=LI(t),a=class extends We.Component{constructor(d){super(d),this.setComponentElRef=o=>{this.componentEl=o}}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(d){zI(this.componentEl,this.props,d)}render(){const d=this.props,{children:o,forwardedRef:f,style:g,className:_,ref:w}=d,T=or(d,["children","forwardedRef","style","className","ref"]);let A=Object.keys(T).reduce((z,G)=>{const V=T[G];if(G.indexOf("on")===0&&G[2]===G[2].toUpperCase()){const N=G.substring(2).toLowerCase();typeof document<"u"&&qv(N)&&(z[G]=V)}else{const N=typeof V;(N==="string"||N==="boolean"||N==="number")&&(z[D1(G)]=V)}return z},{});n&&(A=n(this.props,A));const D=Object.assign(Object.assign({},A),{ref:R1(f,this.setComponentElRef),style:g});return et.createElement(t,D,o)}static get displayName(){return r}};return e&&(a.contextType=e),JY(a,r)},L1=No("ion-avatar",void 0,void 0,oZ),rr=No("ion-buttons",void 0,void 0,gZ),da=No("ion-content",void 0,void 0,RZ),eJ=No("ion-fab",void 0,void 0,ZZ),z1=No("ion-header",void 0,void 0,lX),wl=No("ion-input",void 0,void 0,EX),hu=No("ion-label",void 0,void 0,kX),tJ=No("ion-menu",void 0,void 0,LX),nJ=No("ion-menu-toggle",void 0,void 0,$X),iJ=No("ion-spinner",void 0,void 0,GX),Nh=(t,e)=>{const n=(i,r)=>We.createElement(t,Object.assign({},i,{forwardedRef:r}));return n.displayName=e,We.forwardRef(n)},ii=t=>cc(window,t),BI=()=>{if(typeof window<"u"){const t=window.Ionic;if(t&&t.config)return t.config}return null},B1=(t,e)=>{QY(t,e);const n=LI(t),i=class extends We.Component{constructor(r){super(r),this.handleClick=a=>{const{routerLink:d,routerDirection:o,routerOptions:f,routerAnimation:g}=this.props;d!==void 0&&(a.preventDefault(),this.context.navigate(d,o,void 0,g,f))},this.ref=We.createRef(),this.stableMergedRefs=R1(this.ref,this.props.forwardedRef)}componentDidMount(){this.componentDidUpdate(this.props)}componentDidUpdate(r){const a=this.ref.current;zI(a,this.props,r)}render(){const r=this.props,{children:a,forwardedRef:d,style:o,className:f,ref:g}=r,_=or(r,["children","forwardedRef","style","className","ref"]),w=Object.keys(_).reduce((A,D)=>{if(D.indexOf("on")===0&&D[2]===D[2].toUpperCase()){const z=D.substring(2).toLowerCase();qv(z)&&(A[D]=_[D])}else["string","boolean","number"].includes(typeof _[D])&&(A[D1(D)]=_[D]);return A},{}),T=Object.assign(Object.assign({},w),{ref:this.stableMergedRefs,style:o});if(this.props.routerLink&&!this.props.href&&(T.href=this.props.routerLink),T.onClick){const A=T.onClick;T.onClick=D=>{A(D),D.defaultPrevented||this.handleClick(D)}}else T.onClick=this.handleClick;return et.createElement(t,T,a)}static get displayName(){return n}static get contextType(){return Ll}};return Nh(i,n)},Rn=B1("ion-button",HX),lh=B1("ion-card",YX),rJ=B1("ion-fab-button",tK),qf=B1("ion-item",nK),oJ=(t,e)=>{t instanceof Element&&Object.keys(e).forEach(n=>{if(n.indexOf("on")===0&&n[2]===n[2].toUpperCase()){const i=n.substring(2),r=i[0].toLowerCase()+i.substring(1);qv(r)||sJ(t,r)}})},sJ=(t,e)=>{const n=t.__events||(t.__events={}),i=n[e];i&&(t.removeEventListener(e,i),n[e]=void 0)},aJ=(t,e,n)=>{e&&e();const i=LI(t),r=class extends We.Component{constructor(a){super(a),this.handleIonMount=()=>{this.setState({isOpen:!0})},this.handleWillPresent=d=>{this.setState({isOpen:!0}),this.props.onWillPresent&&this.props.onWillPresent(d)},this.handleDidDismiss=d=>{const o=this.wrapperRef.current,f=this.ref.current;o&&f&&(f.append(o),this.setState({isOpen:!1})),this.props.onDidDismiss&&this.props.onDidDismiss(d)},this.ref=We.createRef(),this.stableMergedRefs=R1(this.ref,this.props.forwardedRef),this.state={isOpen:!1},this.wrapperRef=We.createRef()}componentDidMount(){var a,d,o;this.componentDidUpdate(this.props),(a=this.ref.current)===null||a===void 0||a.addEventListener("ionMount",this.handleIonMount),(d=this.ref.current)===null||d===void 0||d.addEventListener("willPresent",this.handleWillPresent),(o=this.ref.current)===null||o===void 0||o.addEventListener("didDismiss",this.handleDidDismiss)}componentDidUpdate(a){const d=this.ref.current;zI(d,this.props,a)}componentWillUnmount(){const a=this.ref.current;a&&this.state.isOpen&&(a.removeEventListener("didDismiss",this.handleDidDismiss),a.remove(),oJ(a,this.props))}render(){const a=this.props,{children:d,forwardedRef:o,style:f,className:g,ref:_}=a,w=or(a,["children","forwardedRef","style","className","ref"]),T=Object.keys(w).reduce((z,G)=>{if(G.indexOf("on")===0&&G[2]===G[2].toUpperCase()){const V=G.substring(2).toLowerCase();qv(V)&&(z[G]=w[G])}else["string","boolean","number"].includes(typeof w[G])&&(z[D1(G)]=w[G]);return z},{}),A=Object.assign(Object.assign({},T),{ref:this.stableMergedRefs,style:f}),D=()=>n?`${tL} ion-page`:tL;return et.createElement("template",{},et.createElement(t,A,this.state.isOpen||this.props.keepContentsMounted?et.createElement("div",{ref:this.wrapperRef,className:D()},d):null))}static get displayName(){return i}};return Nh(r,i)},tL="ion-delegate-host",d5=aJ("ion-modal",SK,!0),lJ=We.createContext({addOverlay:()=>{},removeOverlay:()=>{}}),cJ=({onAddOverlay:t,onRemoveOverlay:e})=>{const[n,i]=et.useState({}),r=et.useRef({});r.current=n,et.useEffect(()=>{t(a),e(d)},[]);const a=(f,g,_)=>{const w=Object.assign({},r.current);w[f]={component:g,containerElement:_},i(w)},d=f=>{const g=Object.assign({},r.current);delete g[f],i(g)},o=Object.keys(n);return We.createElement(We.Fragment,null,o.map(f=>{const g=n[f];return E4.createPortal(g.component,g.containerElement,`overlay-${f}`)}))},uJ=No("ion-tab-button",void 0,void 0,UK),dJ=No("ion-tab-bar",void 0,void 0,FK),XT=No("ion-router-outlet",void 0,void 0,DK),hJ=No("ion-app",void 0,void 0,AK),fJ=No("ion-icon",void 0,void 0,GY),pJ=(()=>class extends We.Component{constructor(t){super(t),this.ionContext={addOverlay:(e,n,i)=>{this.addOverlayCallback&&this.addOverlayCallback(e,n,i)},removeOverlay:e=>{this.removeOverlayCallback&&this.removeOverlayCallback(e)}}}render(){return We.createElement(lJ.Provider,{value:this.ionContext},We.createElement(hJ,Object.assign({},this.props),this.props.children),We.createElement(cJ,{onAddOverlay:t=>{this.addOverlayCallback=t},onRemoveOverlay:t=>{this.removeOverlayCallback=t}}))}static get displayName(){return"IonApp"}})(),FI=We.createContext({registerIonPage:()=>{},isInOutlet:()=>!1});class NI extends We.PureComponent{constructor(e){super(e),this.ionPageElementRef=We.createRef(),this.stableMergedRefs=R1(this.ionPageElementRef,this.props.forwardedRef)}componentDidMount(){this.ionPageElementRef.current&&(this.context.isInOutlet()&&this.ionPageElementRef.current.classList.add("ion-page-invisible"),this.context.registerIonPage(this.ionPageElementRef.current,this.props.routeInfo),this.ionPageElementRef.current.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionPageElementRef.current&&(this.ionPageElementRef.current.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionPageElementRef.current.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const e=this.props,{className:n,children:i,routeInfo:r,forwardedRef:a}=e,d=or(e,["className","children","routeInfo","forwardedRef"]);return We.createElement(RI.Consumer,null,o=>(this.ionLifeCycleContext=o,We.createElement("div",Object.assign({className:n?`${n} ion-page`:"ion-page",ref:this.stableMergedRefs},d),i)))}static get contextType(){return FI}}class mJ extends We.Component{constructor(e){super(e)}render(){const e=this.props,{className:n,children:i,forwardedRef:r}=e,a=or(e,["className","children","forwardedRef"]);return this.context.hasIonicRouter()?We.createElement(NI,Object.assign({className:n?`${n}`:"",routeInfo:this.context.routeInfo,forwardedRef:r},a),i):We.createElement("div",Object.assign({className:n?`ion-page ${n}`:"ion-page",ref:r},a),i)}static get displayName(){return"IonPage"}static get contextType(){return Ll}}const hc=Nh(mJ,"IonPage"),gJ=(t,e)=>{const n=new WeakMap;return{attachViewToDom:async(a,d,o,f)=>{const g=document.createElement("div");f&&g.classList.add(...f),a.appendChild(g);const _=d(o),w=Bv.createPortal(_,g);return n.set(g,w),t(w),Promise.resolve(g)},removeViewFromDom:(a,d)=>{const o=n.get(d);return o&&e(o),d.remove(),Promise.resolve()}}},yJ=No("ion-nav",void 0,void 0,WX),vJ=t=>{var{children:e,forwardedRef:n}=t,i=or(t,["children","forwardedRef"]);const[r,a]=et.useState([]),d=g=>a(_=>[..._,g]),o=g=>a(_=>_.filter(w=>w!==g)),f=et.useMemo(()=>gJ(d,o),[]);return We.createElement(yJ,Object.assign({delegate:f,ref:n},i),r)};Nh(vJ,"IonNav");const bJ=We.createContext({activeTab:void 0,selectTab:()=>!1}),_J=typeof HTMLElement<"u"?HTMLElement:class{};class xJ extends We.Component{constructor(e){super(e),this.outletIsReady=!1}componentDidMount(){this.ionRouterOutlet&&(this.outletIsReady||Sh(this.ionRouterOutlet,()=>{this.outletIsReady=!0,this.context.registerIonPage(this.ionRouterOutlet,this.props.routeInfo)}),this.ionRouterOutlet.addEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.addEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}componentWillUnmount(){this.ionRouterOutlet&&(this.ionRouterOutlet.removeEventListener("ionViewWillEnter",this.ionViewWillEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidEnter",this.ionViewDidEnterHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewWillLeave",this.ionViewWillLeaveHandler.bind(this)),this.ionRouterOutlet.removeEventListener("ionViewDidLeave",this.ionViewDidLeaveHandler.bind(this)))}ionViewWillEnterHandler(){this.ionLifeCycleContext.ionViewWillEnter()}ionViewDidEnterHandler(){this.ionLifeCycleContext.ionViewDidEnter()}ionViewWillLeaveHandler(){this.ionLifeCycleContext.ionViewWillLeave()}ionViewDidLeaveHandler(){this.ionLifeCycleContext.ionViewDidLeave()}render(){const e=this.props,{StackManager:n,children:i,routeInfo:r}=e,a=or(e,["StackManager","children","routeInfo"]);return We.createElement(RI.Consumer,null,d=>(this.ionLifeCycleContext=d,We.createElement(n,{routeInfo:r},We.createElement(XT,Object.assign({setRef:o=>this.ionRouterOutlet=o},a),i))))}static get contextType(){return FI}}class wJ extends We.Component{constructor(e){super(e)}render(){const e=this.context.getStackManager(),n=this.props,{children:i,forwardedRef:r}=n,a=or(n,["children","forwardedRef"]);return this.context.hasIonicRouter()?a.ionPage?We.createElement(xJ,Object.assign({StackManager:e,routeInfo:this.context.routeInfo},a),i):We.createElement(e,{routeInfo:this.context.routeInfo},We.createElement(XT,Object.assign({},a,{forwardedRef:r}),i)):We.createElement(XT,Object.assign({ref:r},this.props),this.props.children)}static get contextType(){return Ll}}const KT=Nh(wJ,"IonRouterOutlet"),Pp=(()=>class extends We.Component{constructor(t){super(t),this.handleIonTabButtonClick=this.handleIonTabButtonClick.bind(this)}handleIonTabButtonClick(){this.props.onClick&&this.props.onClick(new CustomEvent("ionTabButtonClick",{detail:{tab:this.props.tab,href:this.props.href,routeOptions:this.props.routerOptions}}))}render(){const t=this.props,e=or(t,["onClick"]);return We.createElement(uJ,Object.assign({onIonTabButtonClick:this.handleIonTabButtonClick},e))}static get displayName(){return"IonTabButton"}})();class SJ extends We.PureComponent{constructor(e){super(e),this.setActiveTabOnContext=i=>{};const n={};We.Children.forEach(e.children,i=>{var r,a,d,o;i!=null&&typeof i=="object"&&i.props&&(i.type===Pp||i.type.isTabButton)&&(n[i.props.tab]={originalHref:i.props.href,currentHref:i.props.href,originalRouteOptions:i.props.href===((r=e.routeInfo)===null||r===void 0?void 0:r.pathname)?(a=e.routeInfo)===null||a===void 0?void 0:a.routeOptions:void 0,currentRouteOptions:i.props.href===((d=e.routeInfo)===null||d===void 0?void 0:d.pathname)?(o=e.routeInfo)===null||o===void 0?void 0:o.routeOptions:void 0})}),this.state={tabs:n},this.onTabButtonClick=this.onTabButtonClick.bind(this),this.renderTabButton=this.renderTabButton.bind(this),this.setActiveTabOnContext=this.setActiveTabOnContext.bind(this),this.selectTab=this.selectTab.bind(this)}componentDidMount(){const e=this.state.tabs,i=Object.keys(e).find(r=>{const a=e[r].originalHref;return this.props.routeInfo.pathname.startsWith(a)});i&&this.setState({activeTab:i})}componentDidUpdate(){this.state.activeTab&&this.setActiveTabOnContext(this.state.activeTab)}selectTab(e){const n=this.state.tabs[e];return n?(this.onTabButtonClick(new CustomEvent("ionTabButtonClick",{detail:{href:n.currentHref,tab:e,selected:e===this.state.activeTab,routeOptions:void 0}})),!0):!1}static getDerivedStateFromProps(e,n){var i,r,a;const d=Object.assign({},n.tabs),f=Object.keys(n.tabs).find(_=>{const w=n.tabs[_].originalHref;return e.routeInfo.pathname.startsWith(w)});We.Children.forEach(e.children,_=>{if(_!=null&&typeof _=="object"&&_.props&&(_.type===Pp||_.type.isTabButton)){const w=d[_.props.tab];(!w||w.originalHref!==_.props.href)&&(d[_.props.tab]={originalHref:_.props.href,currentHref:_.props.href,originalRouteOptions:_.props.routeOptions,currentRouteOptions:_.props.routeOptions})}});const{activeTab:g}=n;if(f&&g){const _=n.tabs[g].currentHref,w=n.tabs[g].currentRouteOptions;(f!==g||_!==((i=e.routeInfo)===null||i===void 0?void 0:i.pathname)||w!==((r=e.routeInfo)===null||r===void 0?void 0:r.routeOptions))&&(d[f]={originalHref:d[f].originalHref,currentHref:e.routeInfo.pathname+(e.routeInfo.search||""),originalRouteOptions:d[f].originalRouteOptions,currentRouteOptions:(a=e.routeInfo)===null||a===void 0?void 0:a.routeOptions},e.routeInfo.routeAction==="pop"&&f!==g&&(d[g]={originalHref:d[g].originalHref,currentHref:d[g].originalHref,originalRouteOptions:d[g].originalRouteOptions,currentRouteOptions:d[g].currentRouteOptions}))}return f&&e.onSetCurrentTab(f,e.routeInfo),{activeTab:f,tabs:d}}onTabButtonClick(e,n){const i=this.state.tabs[e.detail.tab],r=i.originalHref,a=e.detail.href,{activeTab:d}=this.state;n&&n(e),d===e.detail.tab?r!==a&&this.context.resetTab(e.detail.tab,r,i.originalRouteOptions):(this.props.onIonTabsWillChange&&this.props.onIonTabsWillChange(new CustomEvent("ionTabWillChange",{detail:{tab:e.detail.tab}})),this.props.onIonTabsDidChange&&this.props.onIonTabsDidChange(new CustomEvent("ionTabDidChange",{detail:{tab:e.detail.tab}})),this.setActiveTabOnContext(e.detail.tab),this.context.changeTab(e.detail.tab,a,e.detail.routeOptions))}renderTabButton(e){return n=>{var i,r;if(n!=null&&n.props&&(n.type===Pp||n.type.isTabButton)){const a=n.props.tab===e?(i=this.props.routeInfo)===null||i===void 0?void 0:i.pathname:this.state.tabs[n.props.tab].currentHref,d=n.props.tab===e?(r=this.props.routeInfo)===null||r===void 0?void 0:r.routeOptions:this.state.tabs[n.props.tab].currentRouteOptions;return We.cloneElement(n,{href:a,routeOptions:d,onClick:o=>this.onTabButtonClick(o,n.props.onClick)})}return null}}render(){const{activeTab:e}=this.state;return We.createElement(dJ,Object.assign({},this.props,{selectedTab:e}),We.Children.map(this.props.children,this.renderTabButton(e)))}static get contextType(){return Ll}}const EJ=We.memo(t=>{var{forwardedRef:e}=t,n=or(t,["forwardedRef"]);const i=et.useContext(Ll);return We.createElement(SJ,Object.assign({ref:e},n,{routeInfo:n.routeInfo||i.routeInfo||{pathname:window.location.pathname},onSetCurrentTab:i.setCurrentTab}),n.children)}),YT=Nh(EJ,"IonTabBar");class kJ extends _J{constructor(){super()}}typeof window<"u"&&window.customElements&&(window.customElements.get("ion-tabs")||window.customElements.define("ion-tabs",kJ));const nL={display:"flex",position:"absolute",top:"0",left:"0",right:"0",bottom:"0",flexDirection:"column",width:"100%",height:"100%",contain:"layout size style"},iL={position:"relative",flex:1,contain:"layout size style"},TJ=(()=>class extends We.Component{constructor(t){super(t),this.routerOutletRef=We.createRef(),this.tabBarRef=We.createRef(),this.ionTabContextState={activeTab:void 0,selectTab:()=>!1}}componentDidMount(){this.tabBarRef.current&&(this.ionTabContextState.activeTab=this.tabBarRef.current.state.activeTab,this.tabBarRef.current.setActiveTabOnContext=t=>{this.ionTabContextState.activeTab=t},this.ionTabContextState.selectTab=this.tabBarRef.current.selectTab)}render(){let t,e;const n=this.props,{className:i,onIonTabsDidChange:r,onIonTabsWillChange:a}=n,d=or(n,["className","onIonTabsDidChange","onIonTabsWillChange"]),o=typeof this.props.children=="function"?this.props.children(this.ionTabContextState):this.props.children;if(We.Children.forEach(o,f=>{if(f==null||typeof f!="object"||!f.hasOwnProperty("type"))return;f.type===KT||f.type.isRouterOutlet?t=We.cloneElement(f):f.type===et.Fragment&&f.props.children[0].type===KT&&(t=f.props.children[0]);let g={ref:this.tabBarRef};r!==void 0&&(g=Object.assign(Object.assign({},g),{onIonTabsDidChange:r})),a!==void 0&&(g=Object.assign(Object.assign({},g),{onIonTabsWillChange:a})),f.type===YT||f.type.isTabBar?e=We.cloneElement(f,g):f.type===et.Fragment&&(f.props.children[1].type===YT||f.props.children[1].type.isTabBar)&&(e=We.cloneElement(f.props.children[1],g))}),!t)throw new Error("IonTabs must contain an IonRouterOutlet");if(!e)throw new Error("IonTabs needs a IonTabBar");return We.createElement(bJ.Provider,{value:this.ionTabContextState},this.context.hasIonicRouter()?We.createElement(NI,Object.assign({className:i?`${i}`:"",routeInfo:this.context.routeInfo},d),We.createElement("ion-tabs",{className:"ion-tabs",style:nL},e.props.slot==="top"?e:null,We.createElement("div",{style:iL,className:"tabs-inner"},t),e.props.slot==="bottom"?e:null)):We.createElement("div",Object.assign({className:i?`${i}`:"ion-tabs"},d,{style:nL}),e.props.slot==="top"?e:null,We.createElement("div",{style:iL,className:"tabs-inner"},t),e.props.slot==="bottom"?e:null))}static get contextType(){return Ll}})();class CJ extends We.PureComponent{constructor(e){super(e),this.props.name&&console.warn('In Ionic React, you import icons from "ionicons/icons" and set the icon you imported to the "icon" property. Setting the "name" property has no effect.')}render(){var e,n;const i=this.props,{icon:r,ios:a,md:d,mode:o}=i,f=or(i,["icon","ios","md","mode"]);let g;const _=BI(),w=o||(_==null?void 0:_.get("mode"));return a||d?w==="ios"?g=(e=a!=null?a:d)!==null&&e!==void 0?e:r:g=(n=d!=null?d:a)!==null&&n!==void 0?n:r:g=r,We.createElement(fJ,Object.assign({ref:this.props.forwardedRef,icon:g},f),this.props.children)}static get contextType(){return Ll}}const yr=Nh(CJ,"IonIcon");class $I extends We.PureComponent{render(){const e=this.context.getIonRoute();return!this.context.hasIonicRouter()||!$I?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRoute>"),null):We.createElement(e,Object.assign({},this.props))}static get contextType(){return Ll}}class h5 extends We.PureComponent{render(){const e=this.context.getIonRedirect();return!this.context.hasIonicRouter()||!h5?(console.error("You either do not have an Ionic Router package, or your router does not support using <IonRedirect>"),null):We.createElement(e,Object.assign({},this.props))}static get contextType(){return Ll}}const f5=We.createContext({routeInfo:void 0,push:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},back:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},canGoBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")},nativeBack:()=>{throw new Error("An Ionic Router is required for IonRouterContext")}});function bm(){const t=et.useContext(f5);return et.useMemo(()=>({back:t.back,push:t.push,goBack:t.back,canGoBack:t.canGoBack,routeInfo:t.routeInfo}),[t.back,t.push,t.canGoBack,t.routeInfo])}class Afe extends We.PureComponent{constructor(e){super(e),this.nodes=new Map,this.animation=Di(e.id)}setupAnimation(e){const n=this.animation;this.nodes.size>0&&n.addElement(Array.from(this.nodes.values())),rL(n,e),oL(n,e)}componentDidMount(){const e=this.props;this.setupAnimation(e)}componentDidUpdate(e){const n=this.animation,i=this.props;rL(n,i,e),IJ(n,i,e),oL(n,i,e)}render(){const{children:e}=this.props;return We.createElement(We.Fragment,null,We.Children.map(e,(n,i)=>We.cloneElement(n,{ref:r=>this.nodes.set(i,r)})))}}const rL=(t,e={},n={})=>{const i=["children","progressStart","progressStep","progressEnd","pause","stop","destroy","play","from","to","fromTo","onFinish"];for(const f in e)e.hasOwnProperty(f)&&!i.includes(f)&&e[f]!==n[f]&&t[f](e[f]);const r=e.from;r&&r!==n.from&&(Array.isArray(r)?r:[r]).forEach(g=>t.from(g.property,g.value));const a=e.to;a&&a!==n.to&&(Array.isArray(a)?a:[a]).forEach(g=>t.to(g.property,g.value));const d=e.fromTo;d&&d!==n.fromTo&&(Array.isArray(d)?d:[d]).forEach(g=>t.fromTo(g.property,g.fromValue,g.toValue));const o=e.onFinish;o&&o!==n.onFinish&&(Array.isArray(o)?o:[o]).forEach(g=>t.onFinish(g.callback,g.opts))},IJ=(t,e={},n={})=>{var i,r,a,d,o;const{progressStart:f,progressStep:g,progressEnd:_}=e;f&&(((i=n.progressStart)===null||i===void 0?void 0:i.forceLinearEasing)!==(f==null?void 0:f.forceLinearEasing)||((r=n.progressStart)===null||r===void 0?void 0:r.step)!==(f==null?void 0:f.step))&&t.progressStart(f.forceLinearEasing,f.step),g&&((a=n.progressStep)===null||a===void 0?void 0:a.step)!==(g==null?void 0:g.step)&&t.progressStep(g.step),_&&(((d=n.progressEnd)===null||d===void 0?void 0:d.playTo)!==(_==null?void 0:_.playTo)||((o=n.progressEnd)===null||o===void 0?void 0:o.step)!==(_==null?void 0:_.step)||(n==null?void 0:n.dur)!==(_==null?void 0:_.dur))&&t.progressEnd(_.playTo,_.step,_.dur)},oL=(t,e={},n={})=>{!n.play&&e.play&&t.play(),!n.pause&&e.pause&&t.pause(),!n.stop&&e.stop&&t.stop(),!n.destroy&&e.destroy&&t.destroy()},sL={main:0},Tx=(t="main")=>{var e;const n=((e=sL[t])!==null&&e!==void 0?e:0)+1;return sL[t]=n,n.toString()},AJ=(t={})=>{typeof document<"u"&&document.documentElement.classList.add("ion-ce"),yH(Object.assign({},t))},p5=We.createContext({addViewItem:()=>{},canGoBack:()=>{},clearOutlet:()=>{},createViewItem:()=>{},findViewItemByPathname:()=>{},findLeavingViewItemByRouteInfo:()=>{},findViewItemByRouteInfo:()=>{},getChildrenToRender:()=>{},goBack:()=>{},unMountViewItem:()=>{}});class aL extends We.Component{constructor(e){super(e),this.ionLifeCycleContext=new HY,this._isMounted=!1,this.ionLifeCycleContext.onComponentCanBeDestroyed(()=>{this.props.mount||this._isMounted&&this.setState({show:!1},()=>this.props.removeView())}),this.state={show:!0}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{show:e}=this.state;return We.createElement(RI.Provider,{value:this.ionLifeCycleContext},e&&this.props.children)}}class MJ{constructor(){this.locationHistory=[],this.tabHistory={}}add(e){e.routeAction==="push"||e.routeAction==null?this._add(e):e.routeAction==="pop"?this._pop(e):e.routeAction==="replace"&&this._replace(e),e.routeDirection==="root"&&(this._clear(),this._add(e))}clearTabStack(e){const n=this._getRouteInfosByKey(e);n&&(n.forEach(i=>{this.locationHistory=this.locationHistory.filter(r=>r.id!==i.id)}),this.tabHistory[e]=[])}update(e){const n=this.locationHistory.findIndex(r=>r.id===e.id);n>-1&&this.locationHistory.splice(n,1,e);const i=this.tabHistory[e.tab||""];if(i){const r=i.findIndex(a=>a.id===e.id);r>-1?i.splice(r,1,e):i.push(e)}else e.tab&&(this.tabHistory[e.tab]=[e])}_add(e){const n=this._getRouteInfosByKey(e.tab);n&&(this._areRoutesEqual(n[n.length-1],e)&&n.pop(),n.push(e)),this.locationHistory.push(e)}_areRoutesEqual(e,n){return!e||!n?!1:e.pathname===n.pathname&&e.search===n.search}_pop(e){const n=this._getRouteInfosByKey(e.tab);n&&(n.pop(),n.pop(),n.push(e)),this.locationHistory.pop(),this.locationHistory.pop(),this.locationHistory.push(e)}_replace(e){const n=this._getRouteInfosByKey(e.tab);n&&n.pop(),this.locationHistory.pop(),this._add(e)}_clear(){Object.keys(this.tabHistory).forEach(n=>this.tabHistory[n]=[]),this.locationHistory=[]}_getRouteInfosByKey(e){let n;return e&&(n=this.tabHistory[e],n||(n=this.tabHistory[e]=[])),n}getFirstRouteInfoForTab(e){const n=this._getRouteInfosByKey(e);if(n)return n[0]}getCurrentRouteInfoForTab(e){const n=this._getRouteInfosByKey(e);if(n)return n[n.length-1]}findLastLocation(e){const n=this._getRouteInfosByKey(e.tab);if(n)for(let i=n.length-2;i>=0;i--){const r=n[i];if(r&&r.pathname===e.pushedByRoute)return r}for(let i=this.locationHistory.length-2;i>=0;i--){const r=this.locationHistory[i];if(r&&r.pathname===e.pushedByRoute)return r}}previous(){return this.locationHistory[this.locationHistory.length-2]||this.locationHistory[this.locationHistory.length-1]}current(){return this.locationHistory[this.locationHistory.length-1]}canGoBack(){return this.locationHistory.length>1}}class PJ extends We.PureComponent{constructor(e){super(e),this.ionRouterContextValue={push:(n,i,r,a,d)=>{this.navigate(n,i,r,d,a)},back:n=>{this.goBack(void 0,n)},canGoBack:()=>this.props.locationHistory.canGoBack(),nativeBack:()=>this.props.onNativeBack(),routeInfo:this.props.routeInfo},this.state={goBack:this.goBack.bind(this),hasIonicRouter:()=>!0,navigate:this.navigate.bind(this),getIonRedirect:this.getIonRedirect.bind(this),getIonRoute:this.getIonRoute.bind(this),getStackManager:this.getStackManager.bind(this),getPageManager:this.getPageManager.bind(this),routeInfo:this.props.routeInfo,setCurrentTab:this.props.onSetCurrentTab,changeTab:this.props.onChangeTab,resetTab:this.props.onResetTab}}componentDidMount(){typeof document<"u"&&(this.handleHardwareBackButton=this.handleHardwareBackButton.bind(this),document.addEventListener("ionBackButton",this.handleHardwareBackButton))}componentWillUnmount(){typeof document<"u"&&document.removeEventListener("ionBackButton",this.handleHardwareBackButton)}handleHardwareBackButton(e){e.detail.register(0,n=>{this.nativeGoBack(),n()})}goBack(e,n){this.props.onNavigateBack(e,n)}nativeGoBack(){this.props.onNativeBack()}navigate(e,n="forward",i="push",r,a,d){this.props.onNavigate(e,i,n,r,a,d)}getPageManager(){return NI}getIonRedirect(){return this.props.ionRedirect}getIonRoute(){return this.props.ionRoute}getStackManager(){return this.props.stackManager}render(){return We.createElement(Ll.Provider,{value:Object.assign(Object.assign({},this.state),{routeInfo:this.props.routeInfo})},We.createElement(f5.Provider,{value:Object.assign(Object.assign({},this.ionRouterContextValue),{routeInfo:this.props.routeInfo})},this.props.children))}}class OJ{constructor(){this.viewStacks={},this.add=this.add.bind(this),this.clear=this.clear.bind(this),this.getViewItemsForOutlet=this.getViewItemsForOutlet.bind(this),this.remove=this.remove.bind(this)}add(e){const{outletId:n}=e;this.viewStacks[n]?this.viewStacks[n].push(e):this.viewStacks[n]=[e]}clear(e){return setTimeout(()=>{delete this.viewStacks[e]},500)}getViewItemsForOutlet(e){return this.viewStacks[e]||[]}remove(e){const{outletId:n}=e,i=this.viewStacks[n];if(i){const r=i.find(a=>a.id===e.id);r&&(r.mount=!1,this.viewStacks[n]=i.filter(a=>a.id!==r.id))}}getStackIds(){return Object.keys(this.viewStacks)}getAllViewItems(){const e=this.getStackIds(),n=[];return e.forEach(i=>{n.push(...this.viewStacks[i])}),n}}class DJ extends We.PureComponent{render(){return We.createElement(tc,Object.assign({path:this.props.path,exact:this.props.exact,render:this.props.render},this.props.computedMatch!==void 0?{computedMatch:this.props.computedMatch}:{}))}}class RJ extends OJ{constructor(){super(),this.createViewItem=this.createViewItem.bind(this),this.findViewItemByRouteInfo=this.findViewItemByRouteInfo.bind(this),this.findLeavingViewItemByRouteInfo=this.findLeavingViewItemByRouteInfo.bind(this),this.getChildrenToRender=this.getChildrenToRender.bind(this),this.findViewItemByPathname=this.findViewItemByPathname.bind(this)}createViewItem(e,n,i,r){const a={id:Tx("viewItem"),outletId:e,ionPageElement:r,reactElement:n,mount:!0,ionRoute:!1},d={exact:n.props.exact,path:n.props.path||n.props.from,component:n.props.component},o=xh(i.pathname,d);return n.type===$I&&(a.ionRoute=!0,a.disableIonPageManagement=n.props.disableIonPageManagement),a.routeData={match:o,childProps:n.props},a}getChildrenToRender(e,n,i){const r=this.getViewItemsForOutlet(e);return We.Children.forEach(n.props.children,d=>{const o=r.find(f=>lL(d,f.routeData.childProps.path||f.routeData.childProps.from));o&&(o.reactElement=d)}),r.map(d=>{let o;if(d.ionRoute&&!d.disableIonPageManagement)o=We.createElement(aL,{key:`view-${d.id}`,mount:d.mount,removeView:()=>this.remove(d)},We.cloneElement(d.reactElement,{computedMatch:d.routeData.match}));else{const f=lL(d.reactElement,i.pathname);o=We.createElement(aL,{key:`view-${d.id}`,mount:d.mount,removeView:()=>this.remove(d)},We.cloneElement(d.reactElement,{computedMatch:d.routeData.match})),!f&&d.routeData.match&&(d.routeData.match=void 0,d.mount=!1)}return o})}findViewItemByRouteInfo(e,n,i){const{viewItem:r,match:a}=this.findViewItemByPath(e.pathname,n);return(i===void 0||i===!0)&&r&&a&&(r.routeData.match=a),r}findLeavingViewItemByRouteInfo(e,n,i=!0){const{viewItem:r}=this.findViewItemByPath(e.lastPathname,n,!1,i);return r}findViewItemByPathname(e,n){const{viewItem:i}=this.findViewItemByPath(e,n);return i}findViewItemByPath(e,n,i,r){let a,d,o;if(n)o=this.getViewItemsForOutlet(n),o.some(f),a||o.some(g);else{const _=this.getAllViewItems();_.some(f),a||_.some(g)}return{viewItem:a,match:d};function f(_){if(r&&!_.ionRoute)return!1;const w={exact:i?!0:_.routeData.childProps.exact,path:_.routeData.childProps.path||_.routeData.childProps.from,component:_.routeData.childProps.component},T=xh(e,w);return T?(a=_,d=T,!0):!1}function g(_){return!_.routeData.childProps.path&&!_.routeData.childProps.from?(d={path:e,url:e,isExact:!0,params:{}},a=_,!0):!1}}}function lL(t,e,n){const i={exact:n?!0:t.props.exact,path:t.props.path||t.props.from,component:t.props.component};return xh(e,i)}function LJ(t){let e;if(typeof t=="string"?e=t:e=t.outerHTML,document){const n=document.createElement("div");n.innerHTML=e,n.style.zIndex="";const i=n.getElementsByTagName("ion-back-button");return i[0]&&i[0].remove(),n.firstChild}}const cL=t=>!t.classList.contains("ion-page-invisible")&&!t.classList.contains("ion-page-hidden");class zJ extends We.PureComponent{constructor(e){super(e),this.stackContextValue={registerIonPage:this.registerIonPage.bind(this),isInOutlet:()=>!0},this.pendingPageTransition=!1,this.registerIonPage=this.registerIonPage.bind(this),this.transitionPage=this.transitionPage.bind(this),this.handlePageTransition=this.handlePageTransition.bind(this),this.id=Tx("routerOutlet"),this.prevProps=void 0,this.skipTransition=!1}componentDidMount(){this.clearOutletTimeout&&clearTimeout(this.clearOutletTimeout),this.routerOutletElement&&(this.setupRouterOutlet(this.routerOutletElement),this.handlePageTransition(this.props.routeInfo))}componentDidUpdate(e){const{pathname:n}=this.props.routeInfo,{pathname:i}=e.routeInfo;n!==i?(this.prevProps=e,this.handlePageTransition(this.props.routeInfo)):this.pendingPageTransition&&(this.handlePageTransition(this.props.routeInfo),this.pendingPageTransition=!1)}componentWillUnmount(){this.clearOutletTimeout=this.context.clearOutlet(this.id)}async handlePageTransition(e){var n,i;if(!this.routerOutletElement||!this.routerOutletElement.commit)this.pendingPageTransition=!0;else{let r=this.context.findViewItemByRouteInfo(e,this.id),a=this.context.findLeavingViewItemByRouteInfo(e,this.id);!a&&e.prevRouteLastPathname&&(a=this.context.findViewItemByPathname(e.prevRouteLastPathname,this.id)),a&&(e.routeAction==="replace"?a.mount=!1:e.routeAction==="push"&&e.routeDirection==="forward"?!((n=e.routeOptions)===null||n===void 0)&&n.unmount&&(a.mount=!1):e.routeDirection!=="none"&&r!==a&&(a.mount=!1));const d=BJ((i=this.ionRouterOutlet)===null||i===void 0?void 0:i.props.children,e);if(r?r.reactElement=d:d&&(r=this.context.createViewItem(this.id,d,e),this.context.addViewItem(r)),r&&r.ionPageElement){if(r===a&&r.routeData.match.url!==e.pathname||(!a&&this.props.routeInfo.prevRouteLastPathname&&(a=this.context.findViewItemByPathname(this.props.routeInfo.prevRouteLastPathname,this.id)),cL(r.ionPageElement)&&a!==void 0&&!cL(a.ionPageElement)))return;this.transitionPage(e,r,a)}else a&&!d&&!r&&a.ionPageElement&&(a.ionPageElement.classList.add("ion-page-hidden"),a.ionPageElement.setAttribute("aria-hidden","true"));this.forceUpdate()}}registerIonPage(e,n){const i=this.context.findViewItemByRouteInfo(n,this.id);if(i){const r=i.ionPageElement;if(i.ionPageElement=e,i.ionRoute=!0,r===e)return}this.handlePageTransition(n)}async setupRouterOutlet(e){const n=()=>{const a=BI();if(!(a&&a.get("swipeBackEnabled",e.mode==="ios")))return!1;const{routeInfo:o}=this.props,f=this.prevProps&&this.prevProps.routeInfo.pathname===o.pushedByRoute?this.prevProps.routeInfo:{pathname:o.pushedByRoute||""},g=this.context.findViewItemByRouteInfo(f,this.id,!1);return!!g&&g.mount&&g.routeData.match.path!==o.pathname},i=async()=>{const{routeInfo:a}=this.props,d=this.prevProps&&this.prevProps.routeInfo.pathname===a.pushedByRoute?this.prevProps.routeInfo:{pathname:a.pushedByRoute||""},o=this.context.findViewItemByRouteInfo(d,this.id,!1),f=this.context.findViewItemByRouteInfo(a,this.id,!1);return o&&f&&await this.transitionPage(a,o,f,"back",!0),Promise.resolve()},r=a=>{if(a)this.skipTransition=!0,this.context.goBack();else{const{routeInfo:d}=this.props,o=this.prevProps&&this.prevProps.routeInfo.pathname===d.pushedByRoute?this.prevProps.routeInfo:{pathname:d.pushedByRoute||""},f=this.context.findViewItemByRouteInfo(o,this.id,!1),g=this.context.findViewItemByRouteInfo(d,this.id,!1);if(f!==g&&(f==null?void 0:f.ionPageElement)!==void 0){const{ionPageElement:_}=f;_.setAttribute("aria-hidden","true"),_.classList.add("ion-page-hidden")}}};e.swipeHandler={canStart:n,onStart:i,onEnd:r}}async transitionPage(e,n,i,r,a=!1){const d=async(_,w)=>{const T=this.skipTransition;T?this.skipTransition=!1:(_.classList.add("ion-page"),_.classList.add("ion-page-invisible")),await o.commit(_,w,{duration:T||g===void 0?0:void 0,direction:g,showGoBack:!!e.pushedByRoute,progressAnimation:a,animationBuilder:e.routeAnimation})},o=this.routerOutletElement,f=e.routeDirection==="none"||e.routeDirection==="root"?void 0:e.routeDirection,g=r!=null?r:f;if(n&&n.ionPageElement&&this.routerOutletElement)if(i&&i.ionPageElement&&n===i)if(FJ(i.reactElement,e.pathname,!0)){const w=LJ(i.ionPageElement.outerHTML);w&&(this.routerOutletElement.appendChild(w),await d(n.ionPageElement,w),this.routerOutletElement.removeChild(w))}else await d(n.ionPageElement,void 0);else await d(n.ionPageElement,i==null?void 0:i.ionPageElement),i&&i.ionPageElement&&!a&&(i.ionPageElement.classList.add("ion-page-hidden"),i.ionPageElement.setAttribute("aria-hidden","true"))}render(){const{children:e}=this.props,n=We.Children.only(e);this.ionRouterOutlet=n;const i=this.context.getChildrenToRender(this.id,this.ionRouterOutlet,this.props.routeInfo,()=>{this.forceUpdate()});return We.createElement(FI.Provider,{value:this.stackContextValue},We.cloneElement(n,{ref:r=>{n.props.setRef&&n.props.setRef(r),n.props.forwardedRef&&(n.props.forwardedRef.current=r),this.routerOutletElement=r;const{ref:a}=n;typeof a=="function"&&a(r)}},i))}static get contextType(){return p5}}function BJ(t,e){let n;return We.Children.forEach(t,i=>{const r={exact:i.props.exact,path:i.props.path||i.props.from,component:i.props.component};xh(e.pathname,r)&&(n=i)}),n||(We.Children.forEach(t,i=>{i.props.path||i.props.from||(n=i)}),n)}function FJ(t,e,n){const i={exact:n?!0:t.props.exact,path:t.props.path||t.props.from,component:t.props.component};return xh(e,i)}class NJ extends We.PureComponent{constructor(e){super(e),this.exitViewFromOtherOutletHandlers=[],this.locationHistory=new MJ,this.viewStack=new RJ,this.routeMangerContextState={canGoBack:()=>this.locationHistory.canGoBack(),clearOutlet:this.viewStack.clear,findViewItemByPathname:this.viewStack.findViewItemByPathname,getChildrenToRender:this.viewStack.getChildrenToRender,goBack:()=>this.handleNavigateBack(),createViewItem:this.viewStack.createViewItem,findViewItemByRouteInfo:this.viewStack.findViewItemByRouteInfo,findLeavingViewItemByRouteInfo:this.viewStack.findLeavingViewItemByRouteInfo,addViewItem:this.viewStack.add,unMountViewItem:this.viewStack.remove};const n={id:Tx("routeInfo"),pathname:this.props.location.pathname,search:this.props.location.search};this.locationHistory.add(n),this.handleChangeTab=this.handleChangeTab.bind(this),this.handleResetTab=this.handleResetTab.bind(this),this.handleNativeBack=this.handleNativeBack.bind(this),this.handleNavigate=this.handleNavigate.bind(this),this.handleNavigateBack=this.handleNavigateBack.bind(this),this.props.registerHistoryListener(this.handleHistoryChange.bind(this)),this.handleSetCurrentTab=this.handleSetCurrentTab.bind(this),this.state={routeInfo:n}}handleChangeTab(e,n,i){if(!n)return;const r=this.locationHistory.getCurrentRouteInfoForTab(e),[a,d]=n.split("?");r?(this.incomingRouteParams=Object.assign(Object.assign({},r),{routeAction:"push",routeDirection:"none"}),r.pathname===a?(this.incomingRouteParams.routeOptions=i,this.props.history.push(r.pathname+(r.search||""))):(this.incomingRouteParams.pathname=a,this.incomingRouteParams.search=d?"?"+d:void 0,this.incomingRouteParams.routeOptions=i,this.props.history.push(a+(d?"?"+d:"")))):this.handleNavigate(a,"push","none",void 0,i,e)}handleHistoryChange(e,n){var i,r,a;let d;if(this.incomingRouteParams?this.incomingRouteParams.routeAction==="replace"?d=this.locationHistory.previous():d=this.locationHistory.current():d=this.locationHistory.current(),d.pathname+d.search!==e.pathname){if(!this.incomingRouteParams){if(n==="REPLACE"&&(this.incomingRouteParams={routeAction:"replace",routeDirection:"none",tab:this.currentTab}),n==="POP"){const g=this.locationHistory.current();if(g&&g.pushedByRoute){const _=this.locationHistory.findLastLocation(g);this.incomingRouteParams=Object.assign(Object.assign({},_),{routeAction:"pop",routeDirection:"back"})}else this.incomingRouteParams={routeAction:"pop",routeDirection:"none",tab:this.currentTab}}this.incomingRouteParams||(this.incomingRouteParams={routeAction:"push",routeDirection:((i=e.state)===null||i===void 0?void 0:i.direction)||"forward",routeOptions:(r=e.state)===null||r===void 0?void 0:r.routerOptions,tab:this.currentTab})}let f;if(!((a=this.incomingRouteParams)===null||a===void 0)&&a.id)f=Object.assign(Object.assign({},this.incomingRouteParams),{lastPathname:d.pathname}),this.locationHistory.add(f);else{const g=this.incomingRouteParams.routeAction==="push"&&this.incomingRouteParams.routeDirection==="forward";if(f=Object.assign(Object.assign({id:Tx("routeInfo")},this.incomingRouteParams),{lastPathname:d.pathname,pathname:e.pathname,search:e.search,params:this.props.match.params,prevRouteLastPathname:d.lastPathname}),g)f.tab=d.tab,f.pushedByRoute=d.pathname;else if(f.routeAction==="pop"){const _=this.locationHistory.findLastLocation(f);f.pushedByRoute=_==null?void 0:_.pushedByRoute}else if(f.routeAction==="push"&&f.tab!==d.tab){const _=this.locationHistory.getCurrentRouteInfoForTab(f.tab);f.pushedByRoute=_==null?void 0:_.pushedByRoute}else if(f.routeAction==="replace"){const _=this.locationHistory.current(),w=_==null?void 0:_.pushedByRoute,T=w!==void 0&&w!==f.pathname?w:f.pushedByRoute;f.lastPathname=(_==null?void 0:_.pathname)||f.lastPathname,f.prevRouteLastPathname=_==null?void 0:_.lastPathname,f.pushedByRoute=T,f.routeDirection=(_==null?void 0:_.routeDirection)||f.routeDirection,f.routeAnimation=(_==null?void 0:_.routeAnimation)||f.routeAnimation}this.locationHistory.add(f)}this.setState({routeInfo:f})}this.incomingRouteParams=void 0}handleNativeBack(){const e=this.props.history;(e.goBack||e.back)()}handleNavigate(e,n,i,r,a,d){this.incomingRouteParams=Object.assign(this.incomingRouteParams||{},{routeAction:n,routeDirection:i,routeOptions:a,routeAnimation:r,tab:d}),n==="push"?this.props.history.push(e):this.props.history.replace(e)}handleNavigateBack(e="/",n){const i=BI();e=e||i&&i.get("backButtonDefaultHref");const r=this.locationHistory.current();if(r&&r.pushedByRoute){const a=this.locationHistory.findLastLocation(r);if(a)if(this.incomingRouteParams=Object.assign(Object.assign({},a),{routeAction:"pop",routeDirection:"back",routeAnimation:n||r.routeAnimation}),r.lastPathname===r.pushedByRoute||a.pathname===r.pushedByRoute&&r.tab===""&&a.tab===""){const d=this.props.history;(d.goBack||d.back)()}else this.handleNavigate(a.pathname+(a.search||""),"pop","back");else this.handleNavigate(e,"pop","back")}else this.handleNavigate(e,"pop","back")}handleResetTab(e,n,i){const r=this.locationHistory.getFirstRouteInfoForTab(e);if(r){const a=Object.assign({},r);a.pathname=n,a.routeOptions=i,this.incomingRouteParams=Object.assign(Object.assign({},a),{routeAction:"pop",routeDirection:"back"}),this.props.history.push(a.pathname+(a.search||""))}}handleSetCurrentTab(e){this.currentTab=e;const n=Object.assign({},this.locationHistory.current());n.tab!==e&&(n.tab=e,this.locationHistory.update(n))}render(){return We.createElement(p5.Provider,{value:this.routeMangerContextState},We.createElement(PJ,{ionRoute:DJ,ionRedirect:{},stackManager:zJ,routeInfo:this.state.routeInfo,onNativeBack:this.handleNativeBack,onNavigateBack:this.handleNavigateBack,onNavigate:this.handleNavigate,onSetCurrentTab:this.handleSetCurrentTab,onChangeTab:this.handleChangeTab,onResetTab:this.handleResetTab,locationHistory:this.locationHistory},this.props.children))}}const F1=w7(NJ);F1.displayName="IonRouter";class $J extends We.Component{constructor(e){super(e);const{history:n}=e,i=or(e,["history"]);this.history=n||MG(i),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,n){const i=e.location||e,r=e.action||n;this.historyListenHandler&&this.historyListenHandler(i,r)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:n}=e,i=or(e,["children"]);return We.createElement(Fv,Object.assign({history:this.history},i),We.createElement(F1,{registerHistoryListener:this.registerHistoryListener},n))}}class Mfe extends We.Component{constructor(e){super(e),this.history=e.history,this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,n){const i=e.location||e,r=e.action||n;this.historyListenHandler&&this.historyListenHandler(i,r)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:n}=e,i=or(e,["children"]);return We.createElement(Fv,Object.assign({},i),We.createElement(F1,{registerHistoryListener:this.registerHistoryListener},n))}}class Pfe extends We.Component{constructor(e){super(e);const{history:n}=e,i=or(e,["history"]);this.history=n||DG(i),this.history.listen(this.handleHistoryChange.bind(this)),this.registerHistoryListener=this.registerHistoryListener.bind(this)}handleHistoryChange(e,n){const i=e.location||e,r=e.action||n;this.historyListenHandler&&this.historyListenHandler(i,r)}registerHistoryListener(e){this.historyListenHandler=e}render(){const e=this.props,{children:n}=e,i=or(e,["children"]);return We.createElement(Fv,Object.assign({history:this.history},i),We.createElement(F1,{registerHistoryListener:this.registerHistoryListener},n))}}const jJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M256 112v288M400 256H112' class='ionicon-fill-none ionicon-stroke-width'/></svg>",VJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='48' d='M244 400L100 256l144-144M120 256h292' class='ionicon-fill-none'/></svg>",UJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M350.54 148.68l-26.62-42.06C318.31 100.08 310.62 96 302 96h-92c-8.62 0-16.31 4.08-21.92 10.62l-26.62 42.06C155.85 155.23 148.62 160 140 160H80a32 32 0 00-32 32v192a32 32 0 0032 32h352a32 32 0 0032-32V192a32 32 0 00-32-32h-59c-8.65 0-16.85-4.77-22.46-11.32z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/><circle cx='256' cy='272' r='80' stroke-miterlimit='10' class='ionicon-fill-none ionicon-stroke-width'/><path stroke-linecap='round' stroke-linejoin='round' d='M124 158v-22h-24v22' class='ionicon-fill-none ionicon-stroke-width'/></svg>",jI="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M368 368L144 144M368 144L144 368' class='ionicon-fill-none ionicon-stroke-width'/></svg>",qJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M256 464c-114.69 0-208-93.31-208-208S141.31 48 256 48s208 93.31 208 208-93.31 208-208 208z'/></svg>",WJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-miterlimit='10' d='M432 400L96 64' class='ionicon-fill-none ionicon-stroke-width'/><path d='M400 240v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 00368 208v32a111.58 111.58 0 01-2.45 23.31 4.05 4.05 0 001.07 3.69l21.82 21.81a2 2 0 003.29-.72A143.27 143.27 0 00400 240zM256 352a112.36 112.36 0 01-112-112v-31.55c0-8.61-6.62-16-15.23-16.43A16 16 0 00112 208v32c0 74 56.1 135.12 128 143.11V432h-47.55c-8.61 0-16 6.62-16.43 15.23A16 16 0 00192 464h127.55c8.61 0 16-6.62 16.43-15.23A16 16 0 00320 432h-48v-48.89a143.08 143.08 0 0052-16.22 4 4 0 00.91-6.35L307 342.63a4 4 0 00-4.51-.78A110.78 110.78 0 01256 352zM256 80a47.18 47.18 0 0148 48v74.72a4 4 0 001.17 2.82L332.59 233a2 2 0 003.41-1.42V128.91C336 85 301 48.6 257.14 48a79.66 79.66 0 00-68.47 36.57 4 4 0 00.54 5l19.54 19.54a2 2 0 003.25-.63A47.44 47.44 0 01256 80z'/><path d='M207.27 242.9L179.41 215a2 2 0 00-3.41 1.42V239a80.89 80.89 0 0023.45 56.9 78.55 78.55 0 0077.8 21.19 2 2 0 00.86-3.35l-24.91-24.91a4.08 4.08 0 00-2.42-1.15c-21.65-2.52-39.48-20.44-42.37-42.43a4 4 0 00-1.14-2.35z'/></svg>",GJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M192 448h128M384 208v32c0 70.4-57.6 128-128 128h0c-70.4 0-128-57.6-128-128v-32M256 368v80' class='ionicon-fill-none ionicon-stroke-width'/><path d='M256 64a63.68 63.68 0 00-64 64v111c0 35.2 29 65 64 65s64-29 64-65V128c0-36-28-64-64-64z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",HJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M258.9 48C141.92 46.42 46.42 141.92 48 258.9c1.56 112.19 92.91 203.54 205.1 205.1 117 1.6 212.48-93.9 210.88-210.88C462.44 140.91 371.09 49.56 258.9 48zm126.42 327.25a4 4 0 01-6.14-.32 124.27 124.27 0 00-32.35-29.59C321.37 329 289.11 320 256 320s-65.37 9-90.83 25.34a124.24 124.24 0 00-32.35 29.58 4 4 0 01-6.14.32A175.32 175.32 0 0180 259c-1.63-97.31 78.22-178.76 175.57-179S432 158.81 432 256a175.32 175.32 0 01-46.68 119.25z'/><path d='M256 144c-19.72 0-37.55 7.39-50.22 20.82s-19 32-17.57 51.93C191.11 256 221.52 288 256 288s64.83-32 67.79-71.24c1.48-19.74-4.8-38.14-17.68-51.82C293.39 151.44 275.59 144 256 144z'/></svg>",ZJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M336 448h56a56 56 0 0056-56v-56M448 176v-56a56 56 0 00-56-56h-56M176 448h-56a56 56 0 01-56-56v-56M64 176v-56a56 56 0 0156-56h56' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",XJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M476.59 227.05l-.16-.07L49.35 49.84A23.56 23.56 0 0027.14 52 24.65 24.65 0 0016 72.59v113.29a24 24 0 0019.52 23.57l232.93 43.07a4 4 0 010 7.86L35.53 303.45A24 24 0 0016 327v113.31A23.57 23.57 0 0026.59 460a23.94 23.94 0 0013.22 4 24.55 24.55 0 009.52-1.93L476.4 285.94l.19-.09a32 32 0 000-58.8z'/></svg>",KJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M470.3 271.15L43.16 447.31a7.83 7.83 0 01-11.16-7V327a8 8 0 016.51-7.86l247.62-47c17.36-3.29 17.36-28.15 0-31.44l-247.63-47a8 8 0 01-6.5-7.85V72.59c0-5.74 5.88-10.26 11.16-8L470.3 241.76a16 16 0 010 29.39z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",YJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M416 464H96a48.05 48.05 0 01-48-48V96a48.05 48.05 0 0148-48h320a48.05 48.05 0 0148 48v320a48.05 48.05 0 01-48 48z'/></svg>",VI="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M394 480a16 16 0 01-9.39-3L256 383.76 127.39 477a16 16 0 01-24.55-18.08L153 310.35 23 221.2a16 16 0 019-29.2h160.38l48.4-148.95a16 16 0 0130.44 0l48.4 149H480a16 16 0 019.05 29.2L359 310.35l50.13 148.53A16 16 0 01394 480z'/></svg>",m5="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M480 208H308L256 48l-52 160H32l140 96-54 160 138-100 138 100-54-160z' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",JJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><rect x='96' y='96' width='320' height='320' rx='24' ry='24' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",QJ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M464 464H48a16 16 0 01-14.07-23.62l208-384a16 16 0 0128.14 0l208 384A16 16 0 01464 464z'/></svg>",eQ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-linejoin='round' d='M374.79 308.78L457.5 367a16 16 0 0022.5-14.62V159.62A16 16 0 00457.5 145l-82.71 58.22A16 16 0 00368 216.3v79.4a16 16 0 006.79 13.08z' class='ionicon-fill-none ionicon-stroke-width'/><path stroke-linecap='round' stroke-miterlimit='10' d='M50.19 140.57A51.94 51.94 0 0032 180v152a52.15 52.15 0 0052 52h184a51.6 51.6 0 0022-4.9M208 128h60.48A51.68 51.68 0 01320 179.52V248M416 416L80 80' class='ionicon-fill-none ionicon-stroke-width'/></svg>",tQ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M374.79 308.78L457.5 367a16 16 0 0022.5-14.62V159.62A16 16 0 00457.5 145l-82.71 58.22A16 16 0 00368 216.3v79.4a16 16 0 006.79 13.08z' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/><path d='M268 384H84a52.15 52.15 0 01-52-52V180a52.15 52.15 0 0152-52h184.48A51.68 51.68 0 01320 179.52V332a52.15 52.15 0 01-52 52z' stroke-miterlimit='10' class='ionicon-fill-none ionicon-stroke-width'/></svg>",nQ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M126 192H56a8 8 0 00-8 8v112a8 8 0 008 8h69.65a15.93 15.93 0 0110.14 3.54l91.47 74.89A8 8 0 00240 392V120a8 8 0 00-12.74-6.43l-91.47 74.89A15 15 0 01126 192zM320 320c9.74-19.38 16-40.84 16-64 0-23.48-6-44.42-16-64M368 368c19.48-33.92 32-64.06 32-112s-12-77.74-32-112M416 416c30-46 48-91.43 48-160s-18-113-48-160' stroke-linecap='round' stroke-linejoin='round' class='ionicon-fill-none ionicon-stroke-width'/></svg>",iQ="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path stroke-linecap='round' stroke-miterlimit='10' d='M416 432L64 80' class='ionicon-fill-none ionicon-stroke-width'/><path d='M224 136.92v33.8a4 4 0 001.17 2.82l24 24a4 4 0 006.83-2.82v-74.15a24.53 24.53 0 00-12.67-21.72 23.91 23.91 0 00-25.55 1.83 8.27 8.27 0 00-.66.51l-31.94 26.15a4 4 0 00-.29 5.92l17.05 17.06a4 4 0 005.37.26zM224 375.08l-78.07-63.92a32 32 0 00-20.28-7.16H64v-96h50.72a4 4 0 002.82-6.83l-24-24a4 4 0 00-2.82-1.17H56a24 24 0 00-24 24v112a24 24 0 0024 24h69.76l91.36 74.8a8.27 8.27 0 00.66.51 23.93 23.93 0 0025.85 1.69A24.49 24.49 0 00256 391.45v-50.17a4 4 0 00-1.17-2.82l-24-24a4 4 0 00-6.83 2.82zM125.82 336zM352 256c0-24.56-5.81-47.88-17.75-71.27a16 16 0 00-28.5 14.54C315.34 218.06 320 236.62 320 256q0 4-.31 8.13a8 8 0 002.32 6.25l19.66 19.67a4 4 0 006.75-2A146.89 146.89 0 00352 256zM416 256c0-51.19-13.08-83.89-34.18-120.06a16 16 0 00-27.64 16.12C373.07 184.44 384 211.83 384 256c0 23.83-3.29 42.88-9.37 60.65a8 8 0 001.9 8.26l16.77 16.76a4 4 0 006.52-1.27C410.09 315.88 416 289.91 416 256z'/><path d='M480 256c0-74.26-20.19-121.11-50.51-168.61a16 16 0 10-27 17.22C429.82 147.38 448 189.5 448 256c0 47.45-8.9 82.12-23.59 113a4 4 0 00.77 4.55L443 391.39a4 4 0 006.4-1C470.88 348.22 480 307 480 256z'/></svg>";const rQ=()=>Ae(hc,{children:Ae(da,{fullscreen:!0})});var g5={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(uB,function(){var n,i,r;function a(o,f){if(!n)n=f;else if(!i)i=f;else{var g="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",_={};n(_),r=f(_),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(r.workerUrl=window.URL.createObjectURL(new Blob([g],{type:"text/javascript"})))}}a(["exports"],function(o){var f=typeof self<"u"?self:{},g="2.15.0";let _;const w={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(_==null){const l=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):l}catch(s){_=l}}return _},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!w.API_URL)return null;try{const l=new URL(w.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch(l){return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},T={supported:!1,testSupport:function(l){!z&&D&&(G?V(l):A=l)}};let A,D,z=!1,G=!1;function V(l){const s=l.createTexture();l.bindTexture(l.TEXTURE_2D,s);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,D),l.isContextLost())return;T.supported=!0}catch(c){}l.deleteTexture(s),z=!0}f.document&&(D=f.document.createElement("img"),D.onload=function(){A&&V(A),A=null,G=!0},D.onerror=function(){z=!0,A=null},D.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const N="01";function q(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var K=se;function se(l,s,c,h){this.cx=3*l,this.bx=3*(c-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(h-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=s,this.p2x=c,this.p2y=h}se.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,s){if(s===void 0&&(s=1e-6),l<0)return 0;if(l>1)return 1;for(var c=l,h=0;h<8;h++){var m=this.sampleCurveX(c)-l;if(Math.abs(m)<s)return c;var v=this.sampleCurveDerivativeX(c);if(Math.abs(v)<1e-6)break;c-=m/v}var x=0,E=1;for(c=l,h=0;h<20&&(m=this.sampleCurveX(c),!(Math.abs(m-l)<s));h++)l>m?x=c:E=c,c=.5*(E-x)+x;return c},solve:function(l,s){return this.sampleCurveY(this.solveCurveX(l,s))}};var ie=q(K),Q=J;function J(l,s){this.x=l,this.y=s}J.prototype={clone:function(){return new J(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,s){return this.clone()._rotateAround(l,s)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var s=l.x-this.x,c=l.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,s){return Math.atan2(this.x*s-this.y*l,this.x*l+this.y*s)},_matMult:function(l){var s=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=s,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var s=Math.cos(l),c=Math.sin(l),h=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=h,this},_rotateAround:function(l,s){var c=Math.cos(l),h=Math.sin(l),m=s.y+h*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-h*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},J.convert=function(l){return l instanceof J?l:Array.isArray(l)?new J(l[0],l[1]):l};var te=q(Q);const me=Math.PI/180,Fe=180/Math.PI;function tt(l){return l*me}function At(l){return l*Fe}const _t=[[0,0],[1,0],[1,1],[0,1]];function xt(l){if(l<=0)return 0;if(l>=1)return 1;const s=l*l,c=s*l;return 4*(l<.5?c:3*(l-s)+c-.75)}function lt(l,s,c,h){const m=new ie(l,s,c,h);return function(v){return m.solve(v)}}const zt=lt(.25,.1,.25,1);function ze(l,s,c){return Math.min(c,Math.max(s,l))}function ot(l,s,c){return(c=ze((c-l)/(s-l),0,1))*c*(3-2*c)}function Be(l,s,c){const h=c-s,m=((l-s)%h+h)%h+s;return m===s?c:m}function ft(l,s,c){if(!l.length)return c(null,[]);let h=l.length;const m=new Array(l.length);let v=null;l.forEach((x,E)=>{s(x,(C,I)=>{C&&(v=C),m[E]=I,--h==0&&c(v,m)})})}function gt(l){const s=[];for(const c in l)s.push(l[c]);return s}function Nt(l,...s){for(const c of s)for(const h in c)l[h]=c[h];return l}let en=1;function Xt(){return en++}function wt(){return function l(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()}function Zt(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function Fn(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)}function Ci(l,s){l.forEach(c=>{s[c]&&(s[c]=s[c].bind(s))})}function Vi(l,s){return l.indexOf(s,l.length-s.length)!==-1}function gn(l,s,c){const h={};for(const m in l)h[m]=s.call(c||this,l[m],m,l);return h}function sr(l,s,c){const h={};for(const m in l)s.call(c||this,l[m],m,l)&&(h[m]=l[m]);return h}function fi(l){return Array.isArray(l)?l.map(fi):typeof l=="object"&&l?gn(l,fi):l}const wo={};function ni(l){wo[l]||(typeof console<"u"&&console.warn(l),wo[l]=!0)}function Ur(l,s,c){return(c.y-l.y)*(s.x-l.x)>(s.y-l.y)*(c.x-l.x)}function Hs(l){let s=0;for(let c,h,m=0,v=l.length,x=v-1;m<v;x=m++)c=l[m],h=l[x],s+=(h.x-c.x)*(c.y+h.y);return s}function jo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ce(l){const s={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,h,m,v)=>{const x=m||v;return s[h]=!x||x.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}let Ee=null;function Oe(l){if(Ee==null){const s=l.navigator?l.navigator.userAgent:null;Ee=!!l.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return Ee}function pe(l){try{const s=f[l];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch(s){return!1}}function Xe(l,s){return[l[4*s],l[4*s+1],l[4*s+2],l[4*s+3]]}const Qe="mapbox-tiles";let $e=500,Ot=50,mt,De;function Ke(){try{return f.caches}catch(l){}}function Lt(){Ke()&&!mt&&(mt=f.caches.open(Qe))}function mn(l){const s=l.indexOf("?");if(s<0)return l;const c=function(m){const v=m.indexOf("?");return v>0?m.slice(v+1).split("&"):[]}(l),h=c.filter(m=>{const v=m.split("=");return v[0]==="language"||v[0]==="worldview"});return h.length?`${l.slice(0,s)}?${h.join("&")}`:l.slice(0,s)}let An=1/0;const Xi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Xi);class yt extends Error{constructor(s,c,h){c===401&&je(h)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=c,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const En=jo()?()=>self.worker&&self.worker.referrer:()=>(f.location.protocol==="blob:"?f.parent:f).location.href,xi=function(l,s){if(!(/^file:/.test(c=l.url)||/^file:/.test(En())&&!/^\w+:/.test(c))){if(f.fetch&&f.Request&&f.AbortController&&f.Request.prototype.hasOwnProperty("signal"))return function(h,m){const v=new f.AbortController,x=new f.Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:En(),referrerPolicy:h.referrerPolicy,signal:v.signal});let E=!1,C=!1;const I=(O=x.url).indexOf("sku=")>0&&je(O);var O;h.type==="json"&&x.headers.set("Accept","application/json");const L=(j,U,X)=>{if(C)return;if(j&&j.message!=="SecurityError"&&ni(j.toString()),U&&X)return B(U);const re=Date.now();f.fetch(x).then(he=>{if(he.ok){const xe=I?he.clone():null;return B(he,xe,re)}return m(new yt(he.statusText,he.status,h.url))}).catch(he=>{he.name!=="AbortError"&&m(new Error(`${he.message} ${h.url}`))})},B=(j,U,X)=>{(h.type==="arrayBuffer"?j.arrayBuffer():h.type==="json"?j.json():j.text()).then(re=>{C||(U&&X&&function(he,xe,fe){if(Lt(),!mt)return;const be={status:xe.status,statusText:xe.statusText,headers:new f.Headers};xe.headers.forEach((He,Ue)=>be.headers.set(Ue,He));const Se=ce(xe.headers.get("Cache-Control")||"");if(Se["no-store"])return;Se["max-age"]&&be.headers.set("Expires",new Date(fe+1e3*Se["max-age"]).toUTCString());const we=be.headers.get("Expires");we&&(new Date(we).getTime()-fe<42e4||function(He,Ue){if(De===void 0)try{new Response(new ReadableStream),De=!0}catch(at){De=!1}De?Ue(He.body):He.blob().then(Ue)}(xe,He=>{const Ue=new f.Response(He,be);Lt(),mt&&mt.then(at=>at.put(mn(he.url),Ue)).catch(at=>ni(at.message))}))}(x,U,X),E=!0,m(null,re,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(re=>{C||m(new Error(re.message))})};return I?function(j,U){if(Lt(),!mt)return U(null);const X=mn(j.url);mt.then(re=>{re.match(X).then(he=>{const xe=function(fe){if(!fe)return!1;const be=new Date(fe.headers.get("Expires")||0),Se=ce(fe.headers.get("Cache-Control")||"");return be>Date.now()&&!Se["no-cache"]}(he);re.delete(X),xe&&re.put(X,he.clone()),U(null,he,xe)}).catch(U)}).catch(U)}(x,L):L(null,null),{cancel:()=>{C=!0,E||v.abort()}}}(l,s);if(jo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,s,void 0,!0)}var c;return function(h,m){const v=new f.XMLHttpRequest;v.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const x in h.headers)v.setRequestHeader(x,h.headers[x]);return h.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=h.credentials==="include",v.onerror=()=>{m(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let x=v.response;if(h.type==="json")try{x=JSON.parse(v.response)}catch(E){return m(E)}m(null,x,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else m(new yt(v.statusText,v.status,h.url))},v.send(h.body),{cancel:()=>v.abort()}}(l,s)},fo=function(l,s){return xi(Nt(l,{type:"arrayBuffer"}),s)};function nl(l){const s=f.document.createElement("a");return s.href=l,s.protocol===f.document.location.protocol&&s.host===f.document.location.host}const _e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Y,ee;Y=[],ee=0;const ve=function(l,s){if(T.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),ee>=w.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:l,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return Y.push(v),v}ee++;let c=!1;const h=()=>{if(!c)for(c=!0,ee--;Y.length&&ee<w.MAX_PARALLEL_IMAGE_REQUESTS;){const v=Y.shift(),{requestParameters:x,callback:E,cancelled:C}=v;C||(v.cancel=ve(x,E).cancel)}},m=fo(l,(v,x,E,C)=>{h(),v?s(v):x&&(f.createImageBitmap?function(I,O){const L=new f.Blob([new Uint8Array(I)],{type:"image/png"});f.createImageBitmap(L).then(B=>{O(null,B)}).catch(B=>{O(new Error(`Could not load image because of ${B.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(I,O)=>s(I,O,E,C)):function(I,O){const L=new f.Image,B=f.URL;L.onload=()=>{O(null,L),B.revokeObjectURL(L.src),L.onload=null,f.requestAnimationFrame(()=>{L.src=_e})},L.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new f.Blob([new Uint8Array(I)],{type:"image/png"});L.src=I.byteLength?B.createObjectURL(j):_e}(x,(I,O)=>s(I,O,E,C)))});return{cancel:()=>{m.cancel(),h()}}},ke="NO_ACCESS_TOKEN";function Pe(l){return l.indexOf("mapbox:")===0}function je(l){return w.API_URL_REGEX.test(l)}function Ne(l){return w.API_CDN_URL_REGEX.test(l)}function Me(l){return w.API_STYLE_REGEX.test(l)&&!Ze(l)}function Ze(l){return w.API_SPRITE_REGEX.test(l)}const Mt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Bt(l){const s=l.match(Mt);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function kt(l){const s=l.params.length?`?${l.params.join("&")}`:"";return`${l.protocol}://${l.authority}${l.path}${s}`}const yn="mapbox.eventData";function In(l){if(!l)return null;const s=l.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(decodeURIComponent(f.atob(s[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(c){return null}}class _n{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const c=In(w.ACCESS_TOKEN);let h="";return h=c&&c.u?f.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(m,v)=>String.fromCharCode(+("0x"+v)))):w.ACCESS_TOKEN||"",s?`${yn}.${s}:${h}`:`${yn}:${h}`}fetchEventData(){const s=pe("localStorage"),c=this.getStorageKey(),h=this.getStorageKey("uuid");if(s)try{const m=f.localStorage.getItem(c);m&&(this.eventData=JSON.parse(m));const v=f.localStorage.getItem(h);v&&(this.anonId=v)}catch(m){ni("Unable to read from LocalStorage")}}saveEventData(){const s=pe("localStorage"),c=this.getStorageKey(),h=this.getStorageKey("uuid");if(s)try{f.localStorage.setItem(h,this.anonId),Object.keys(this.eventData).length>=1&&f.localStorage.setItem(c,JSON.stringify(this.eventData))}catch(m){ni("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,c,h,m){if(!w.EVENTS_URL)return;const v=Bt(w.EVENTS_URL);v.params.push(`access_token=${m||w.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(s).toISOString()},E=c?Nt(x,c):x,C={url:kt(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=function(I,O){return xi(Nt(I,{method:"POST"}),O)}(C,I=>{this.pendingRequest=null,h(I),this.saveEventData(),this.processRequests(m)})}queueRequest(s,c){this.queue.push(s),this.processRequests(c)}}const pn=new class extends _n{constructor(l){super("appUserTurnstile"),this._customAccessToken=l}postTurnstileEvent(l,s){w.EVENTS_URL&&w.ACCESS_TOKEN&&Array.isArray(l)&&l.some(c=>Pe(c)||je(c))&&this.queueRequest(Date.now(),s)}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=In(w.ACCESS_TOKEN),c=s?s.u:w.ACCESS_TOKEN;let h=c!==this.eventData.tokenU;Fn(this.anonId)||(this.anonId=wt(),h=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),x=new Date(m),E=(m-this.eventData.lastSuccess)/864e5;h=h||E>=1||E<-1||v.getDate()!==x.getDate()}else h=!0;h?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:N,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=m,this.eventData.tokenU=c)},l):this.processRequests()}},Ln=pn.postTurnstileEvent.bind(pn),wi=new class extends _n{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(l,s,c,h){this.skuToken=s,this.errorCb=h,w.EVENTS_URL&&(c||w.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(ke)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),Fn(this.anonId)||(this.anonId=wt()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:N,skuToken:this.skuToken,userId:this.anonId},h=>{h?this.errorCb(h):s&&(this.success[s]=!0)},l))}},Ui=wi.postMapLoadEvent.bind(wi),Ar=new class extends _n{constructor(){super("gljs.performance")}postPerformanceEvent(l,s){w.EVENTS_URL&&(l||w.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},l)}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:c}=this.queue.shift(),h=function(m){const v=f.performance.getEntriesByType("resource"),x=f.performance.getEntriesByType("mark"),E=function(B){const j={};if(B){for(const U in B)if(U!=="other")for(const X of B[U]){const re=`${U}ResolveRangeMin`,he=`${U}ResolveRangeMax`,xe=`${U}RequestCount`,fe=`${U}RequestCachedCount`;j[re]=Math.min(j[re]||1/0,X.startTime),j[he]=Math.max(j[he]||-1/0,X.responseEnd);const be=Se=>{j[Se]===void 0&&(j[Se]=0),++j[Se]};X.transferSize!==void 0&&X.transferSize===0&&be(fe),be(xe)}}return j}(function(B,j){const U={};if(B)for(const X of B){const re=j(X);U[re]===void 0&&(U[re]=[]),U[re].push(X)}return U}(v,qh)),C=f.devicePixelRatio,I=f.navigator.connection||f.navigator.mozConnection||f.navigator.webkitConnection,O={counters:[],metadata:[],attributes:[]},L=(B,j,U)=>{U!=null&&B.push({name:j,value:U.toString()})};for(const B in E)L(O.counters,B,E[B]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(L(O.counters,"interactionRangeMin",m.interactionRange[0]),L(O.counters,"interactionRangeMax",m.interactionRange[1])),x)for(const B of Object.keys(il)){const j=il[B],U=x.find(X=>X.name===j);U&&L(O.counters,j,U.startTime)}return L(O.counters,"visibilityHidden",m.visibilityHidden),L(O.attributes,"style",function(B){if(B)for(const j of B){const U=j.name.split("?")[0];if(Me(U)){const X=U.split("/").slice(-2);if(X.length===2)return`mapbox://styles/${X[0]}/${X[1]}`}}}(v)),L(O.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),L(O.attributes,"fogEnabled",m.fogEnabled?"true":"false"),L(O.attributes,"projection",m.projection),L(O.attributes,"zoom",m.zoom),L(O.metadata,"devicePixelRatio",C),L(O.metadata,"connectionEffectiveType",I?I.effectiveType:void 0),L(O.metadata,"navigatorUserAgent",f.navigator.userAgent),L(O.metadata,"screenWidth",f.screen.width),L(O.metadata,"screenHeight",f.screen.height),L(O.metadata,"windowWidth",f.innerWidth),L(O.metadata,"windowHeight",f.innerHeight),L(O.metadata,"mapWidth",m.width/C),L(O.metadata,"mapHeight",m.height/C),L(O.metadata,"webglRenderer",m.renderer),L(O.metadata,"webglVendor",m.vendor),L(O.metadata,"sdkVersion",g),L(O.metadata,"sdkIdentifier","mapbox-gl-js"),O}(c);for(const m of h.metadata);for(const m of h.counters);for(const m of h.attributes);this.postEvent(s,h,()=>{},l)}},Ki=Ar.postPerformanceEvent.bind(Ar),ns=new class extends _n{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(l,s,c,h){if(!w.API_URL||!w.SESSION_PATH)return;const m=Bt(w.API_URL+w.SESSION_PATH);m.params.push(`sku=${s||""}`),m.params.push(`access_token=${h||w.ACCESS_TOKEN||""}`);const v={url:kt(m),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(x,E){return xi(Nt(x,{method:"GET"}),E)}(v,x=>{this.pendingRequest=null,c(x),this.saveEventData(),this.processRequests(h)})}getSessionAPI(l,s,c,h){this.skuToken=s,this.errorCb=h,w.SESSION_PATH&&w.API_URL&&(c||w.ACCESS_TOKEN?this.queueRequest({id:l,timestamp:Date.now()},c):this.errorCb(new Error(ke)))}processRequests(l){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||this.getSession(c,this.skuToken,h=>{h?this.errorCb(h):s&&(this.success[s]=!0)},l)}},Yi=ns.getSessionAPI.bind(ns),qr=new Set,il={create:"create",load:"load",fullLoad:"fullLoad"},Cm={mark(l){f.performance.mark(l)},measure(l,s,c){f.performance.measure(l,s,c)}};function qh(l){const s=l.name.split("?")[0];return Ne(s)&&s.includes("mapbox-gl.js")?"javascript":Ne(s)&&s.includes("mapbox-gl.css")?"css":function(c){return w.API_FONTS_REGEX.test(c)}(s)?"fontRange":Ze(s)?"sprite":Me(s)?"style":function(c){return w.API_TILEJSON_REGEX.test(c)}(s)?"tilejson":"other"}const jn=f.performance;function nd(l){const s=l?l.url.toString():void 0;return jn.getEntriesByName(s)}let rl,Wh,id,nt;const $t={now:()=>id!==void 0?id:f.performance.now(),setNow(l){id=l},restoreNow(){id=void 0},frame(l){const s=f.requestAnimationFrame(l);return{cancel:()=>f.cancelAnimationFrame(s)}},getImageData(l,s=0){const{width:c,height:h}=l;nt||(nt=f.document.createElement("canvas"));const m=nt.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>nt.width||h>nt.height)&&(nt.width=c,nt.height=h),m.clearRect(-s,-s,c+2*s,h+2*s),m.drawImage(l,0,0,c,h),m.getImageData(-s,-s,c+2*s,h+2*s)},resolveURL:l=>(rl||(rl=f.document.createElement("a")),rl.href=l,rl.href),get devicePixelRatio(){return f.devicePixelRatio},get prefersReducedMotion(){return!!f.matchMedia&&(Wh==null&&(Wh=f.matchMedia("(prefers-reduced-motion: reduce)")),Wh.matches)}};function an(l,s,c){c[l]&&c[l].indexOf(s)!==-1||(c[l]=c[l]||[],c[l].push(s))}function qi(l,s,c){if(c&&c[l]){const h=c[l].indexOf(s);h!==-1&&c[l].splice(h,1)}}class Li{constructor(s,c={}){Nt(this,c),this.type=s}}class Ji extends Li{constructor(s,c={}){super("error",Nt({error:s},c))}}class Vo{on(s,c){return this._listeners=this._listeners||{},an(s,c,this._listeners),this}off(s,c){return qi(s,c,this._listeners),qi(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},an(s,c,this._oneTimeListeners),this):new Promise(h=>this.once(s,h))}fire(s,c){typeof s=="string"&&(s=new Li(s,c||{}));const h=s.type;if(this.listens(h)){s.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const E of m)E.call(this,s);const v=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const E of v)qi(h,E,this._oneTimeListeners),E.call(this,s);const x=this._eventedParent;x&&(Nt(s,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(s))}else s instanceof Ji&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var st=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function va(l,...s){for(const c of s)for(const h in c)l[h]=c[h];return l}function ar(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Dr(l){if(Array.isArray(l))return l.map(Dr);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const s={};for(const c in l)s[c]=Dr(l[c]);return s}return ar(l)}class Kv extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}var Zs=Kv;class Im{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[h,m]of c)this.bindings[h]=m}concat(s){return new Im(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var Yv=Im;const Sc={kind:"null"},Gt={kind:"number"},zn={kind:"string"},Pn={kind:"boolean"},Uo={kind:"color"},ks={kind:"object"},On={kind:"value"},qo={kind:"collator"},rd={kind:"formatted"},Bl={kind:"resolvedImage"};function is(l,s){return{kind:"array",itemType:l,N:s}}function Ii(l){if(l.kind==="array"){const s=Ii(l.itemType);return typeof l.N=="number"?`array<${s}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${s}>`}return l.kind}const Jv=[Sc,Gt,zn,Pn,Uo,rd,ks,is(On),Bl];function ba(l,s){if(s.kind==="error")return null;if(l.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!ba(l.itemType,s.itemType))&&(typeof l.N!="number"||l.N===s.N))return null}else{if(l.kind===s.kind)return null;if(l.kind==="value"){for(const c of Jv)if(!ba(c,s))return null}}return`Expected ${Ii(l)} but found ${Ii(s)} instead.`}function od(l,s){return s.some(c=>c.kind===l.kind)}function sd(l,s){return s.some(c=>c==="null"?l===null:c==="array"?Array.isArray(l):c==="object"?l&&!Array.isArray(l)&&typeof l=="object":c===typeof l)}var Am,Qv={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ad(l){return(l=Math.round(l))<0?0:l>255?255:l}function ld(l){return ad(l[l.length-1]==="%"?parseFloat(l)/100*255:parseInt(l))}function Gh(l){return(s=l[l.length-1]==="%"?parseFloat(l)/100:parseFloat(l))<0?0:s>1?1:s;var s}function Ec(l,s,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?l+(s-l)*c*6:2*c<1?s:3*c<2?l+(s-l)*(2/3-c)*6:l}try{Am={}.parseCSSColor=function(l){var s,c=l.replace(/ /g,"").toLowerCase();if(c in Qv)return Qv[c].slice();if(c[0]==="#")return c.length===4?(s=parseInt(c.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:c.length===7&&(s=parseInt(c.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var h=c.indexOf("("),m=c.indexOf(")");if(h!==-1&&m+1===c.length){var v=c.substr(0,h),x=c.substr(h+1,m-(h+1)).split(","),E=1;switch(v){case"rgba":if(x.length!==4)return null;E=Gh(x.pop());case"rgb":return x.length!==3?null:[ld(x[0]),ld(x[1]),ld(x[2]),E];case"hsla":if(x.length!==4)return null;E=Gh(x.pop());case"hsl":if(x.length!==3)return null;var C=(parseFloat(x[0])%360+360)%360/360,I=Gh(x[1]),O=Gh(x[2]),L=O<=.5?O*(I+1):O+I-O*I,B=2*O-L;return[ad(255*Ec(B,L,C+1/3)),ad(255*Ec(B,L,C)),ad(255*Ec(B,L,C-1/3)),E];default:return null}}return null}}catch(l){}class So{constructor(s,c,h,m=1){this.r=s,this.g=c,this.b=h,this.a=m}static parse(s){if(!s)return;if(s instanceof So)return s;if(typeof s!="string")return;const c=Am(s);return c?new So(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[s,c,h,m]=this.toArray();return`rgba(${Math.round(s)},${Math.round(c)},${Math.round(h)},${m})`}toArray(){const{r:s,g:c,b:h,a:m}=this;return m===0?[0,0,0,0]:[255*s/m,255*c/m,255*h/m,m]}toArray01(){const{r:s,g:c,b:h,a:m}=this;return m===0?[0,0,0,0]:[s/m,c/m,h/m,m]}toArray01PremultipliedAlpha(){const{r:s,g:c,b:h,a:m}=this;return[s,c,h,m]}}So.black=new So(0,0,0,1),So.white=new So(1,1,1,1),So.transparent=new So(0,0,0,0),So.red=new So(1,0,0,1),So.blue=new So(0,0,1,1);var Qi=So;class Mm{constructor(s,c,h){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Pm{constructor(s,c,h,m,v){this.text=s.normalize?s.normalize():s,this.image=c,this.scale=h,this.fontStack=m,this.textColor=v}}class Eo{constructor(s){this.sections=s}static fromString(s){return new Eo([new Pm(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.name.length!==0)}static factory(s){return s instanceof Eo?s:Eo.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const c of this.sections){if(c.image){s.push(["image",c.image.name]);continue}s.push(c.text);const h={};c.fontStack&&(h["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(h["font-scale"]=c.scale),c.textColor&&(h["text-color"]=["rgba"].concat(c.textColor.toArray())),s.push(h)}return s}}class rs{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new rs({name:s,available:!1}):null}serialize(){return["image",this.name]}}function e0(l,s,c,h){return typeof l=="number"&&l>=0&&l<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof c=="number"&&c>=0&&c<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[l,s,c,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[l,s,c,h]:[l,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function cd(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Qi||l instanceof Mm||l instanceof Eo||l instanceof rs)return!0;if(Array.isArray(l)){for(const s of l)if(!cd(s))return!1;return!0}if(typeof l=="object"){for(const s in l)if(!cd(l[s]))return!1;return!0}return!1}function Wi(l){if(l===null)return Sc;if(typeof l=="string")return zn;if(typeof l=="boolean")return Pn;if(typeof l=="number")return Gt;if(l instanceof Qi)return Uo;if(l instanceof Mm)return qo;if(l instanceof Eo)return rd;if(l instanceof rs)return Bl;if(Array.isArray(l)){const s=l.length;let c;for(const h of l){const m=Wi(h);if(c){if(c===m)continue;c=On;break}c=m}return is(c||On,s)}return ks}function ud(l){const s=typeof l;return l===null?"":s==="string"||s==="number"||s==="boolean"?String(l):l instanceof Qi||l instanceof Eo||l instanceof rs?l.toString():JSON.stringify(l)}class Om{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(s.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!cd(s[1]))return c.error("invalid value");const h=s[1];let m=Wi(h);const v=c.expectedType;return m.kind!=="array"||m.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(m=v),new Om(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Qi?["rgba"].concat(this.value.toArray()):this.value instanceof Eo?this.value.serialize():this.value}}var Fl=Om,Wr=class{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}};const Dm={string:zn,number:Gt,boolean:Pn,object:ks};class Rm{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let h,m=1;const v=s[0];if(v==="array"){let E,C;if(s.length>2){const I=s[1];if(typeof I!="string"||!(I in Dm)||I==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);E=Dm[I],m++}else E=On;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);C=s[2],m++}h=is(E,C)}else h=Dm[v];const x=[];for(;m<s.length;m++){const E=c.parse(s[m],m,On);if(!E)return null;x.push(E)}return new Rm(h,x)}evaluate(s){for(let c=0;c<this.args.length;c++){const h=this.args[c].evaluate(s);if(!ba(this.type,Wi(h)))return h;if(c===this.args.length-1)throw new Wr(`Expected value to be of type ${Ii(this.type)}, but found ${Ii(Wi(h))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,c=[s.kind];if(s.kind==="array"){const h=s.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){c.push(h.kind);const m=s.N;(typeof m=="number"||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(h=>h.serialize()))}}var _a=Rm;class ol{constructor(s){this.type=rd,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const h=s[1];if(!Array.isArray(h)&&typeof h=="object")return c.error("First argument must be an image or text section.");const m=[];let v=!1;for(let x=1;x<=s.length-1;++x){const E=s[x];if(v&&typeof E=="object"&&!Array.isArray(E)){v=!1;let C=null;if(E["font-scale"]&&(C=c.parse(E["font-scale"],1,Gt),!C))return null;let I=null;if(E["text-font"]&&(I=c.parse(E["text-font"],1,is(zn)),!I))return null;let O=null;if(E["text-color"]&&(O=c.parse(E["text-color"],1,Uo),!O))return null;const L=m[m.length-1];L.scale=C,L.font=I,L.textColor=O}else{const C=c.parse(s[x],1,On);if(!C)return null;const I=C.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,m.push({content:C,scale:null,font:null,textColor:null})}}return new ol(m)}evaluate(s){return new Eo(this.sections.map(c=>{const h=c.content.evaluate(s);return Wi(h)===Bl?new Pm("",h,null,null,null):new Pm(ud(h),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const c of this.sections){s.push(c.content.serialize());const h={};c.scale&&(h["font-scale"]=c.scale.serialize()),c.font&&(h["text-font"]=c.font.serialize()),c.textColor&&(h["text-color"]=c.textColor.serialize()),s.push(h)}return s}}class Hh{constructor(s){this.type=Bl,this.input=s}static parse(s,c){if(s.length!==2)return c.error("Expected two arguments.");const h=c.parse(s[1],1,zn);return h?new Hh(h):c.error("No image name provided.")}evaluate(s){const c=this.input.evaluate(s),h=rs.fromString(c);return h&&s.availableImages&&(h.available=s.availableImages.indexOf(c)>-1),h}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Sw={"to-boolean":Pn,"to-color":Uo,"to-number":Gt,"to-string":zn};class Lm{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const h=s[0];if((h==="to-boolean"||h==="to-string")&&s.length!==2)return c.error("Expected one argument.");const m=Sw[h],v=[];for(let x=1;x<s.length;x++){const E=c.parse(s[x],x,On);if(!E)return null;v.push(E)}return new Lm(m,v)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let c,h;for(const m of this.args){if(c=m.evaluate(s),h=null,c instanceof Qi)return c;if(typeof c=="string"){const v=s.parseColor(c);if(v)return v}else if(Array.isArray(c)&&(h=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:e0(c[0],c[1],c[2],c[3]),!h))return new Qi(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new Wr(h||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const h of this.args){if(c=h.evaluate(s),c===null)return 0;const m=Number(c);if(!isNaN(m))return m}throw new Wr(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?Eo.fromString(ud(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?rs.fromString(ud(this.args[0].evaluate(s))):ud(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ol([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Hh(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(c=>{s.push(c.serialize())}),s}}var kc=Lm;const Xs=["Unknown","Point","LineString","Polygon"];var zm=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Xs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const l=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-l[0])+this.featureDistanceData.bearing[1]*(h*s-l[1])}return 0}parseColor(l){let s=this._parseColorCache[l];return s||(s=this._parseColorCache[l]=Qi.parse(l)),s}};class Nl{constructor(s,c,h,m){this.name=s,this.type=c,this._evaluate=h,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,c){const h=s[0],m=Nl.definitions[h];if(!m)return c.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=x.filter(([I])=>!Array.isArray(I)||I.length===s.length-1);let C=null;for(const[I,O]of E){C=new Vm(c.registry,c.path,null,c.scope);const L=[];let B=!1;for(let j=1;j<s.length;j++){const U=s[j],X=Array.isArray(I)?I[j-1]:I.type,re=C.parse(U,1+L.length,X);if(!re){B=!0;break}L.push(re)}if(!B)if(Array.isArray(I)&&I.length!==L.length)C.error(`Expected ${I.length} arguments, but found ${L.length} instead.`);else{for(let j=0;j<L.length;j++){const U=Array.isArray(I)?I[j]:I.type,X=L[j];C.concat(j+1).checkSubtype(U,X.type)}if(C.errors.length===0)return new Nl(h,v,O,L)}}if(E.length===1)c.errors.push(...C.errors);else{const I=(E.length?E:x).map(([L])=>{return B=L,Array.isArray(B)?`(${B.map(Ii).join(", ")})`:`(${Ii(B.type)}...)`;var B}).join(" | "),O=[];for(let L=1;L<s.length;L++){const B=c.parse(s[L],1+O.length);if(!B)return null;O.push(Ii(B.type))}c.error(`Expected arguments of type ${I}, but found (${O.join(", ")}) instead.`)}return null}static register(s,c){Nl.definitions=c;for(const h in c)s[h]=Nl}}var xa=Nl;class dd{constructor(s,c,h){this.type=qo,this.locale=h,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(s.length!==2)return c.error("Expected one argument.");const h=s[1];if(typeof h!="object"||Array.isArray(h))return c.error("Collator options argument must be an object.");const m=c.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Pn);if(!m)return null;const v=c.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Pn);if(!v)return null;let x=null;return h.locale&&(x=c.parse(h.locale,1,zn),!x)?null:new dd(m,v,x)}evaluate(s){return new Mm(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const wa=8192;function Zh(l,s){l[0]=Math.min(l[0],s[0]),l[1]=Math.min(l[1],s[1]),l[2]=Math.max(l[2],s[0]),l[3]=Math.max(l[3],s[1])}function Tc(l,s){return!(l[0]<=s[0]||l[2]>=s[2]||l[1]<=s[1]||l[3]>=s[3])}function hd(l,s){const c=(180+l[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(c*m*wa),Math.round(h*m*wa)]}function t0(l,s,c){const h=l[0]-s[0],m=l[1]-s[1],v=l[0]-c[0],x=l[1]-c[1];return h*x-v*m==0&&h*v<=0&&m*x<=0}function Xh(l,s){let c=!1;for(let x=0,E=s.length;x<E;x++){const C=s[x];for(let I=0,O=C.length;I<O-1;I++){if(t0(l,C[I],C[I+1]))return!1;(m=C[I])[1]>(h=l)[1]!=(v=C[I+1])[1]>h[1]&&h[0]<(v[0]-m[0])*(h[1]-m[1])/(v[1]-m[1])+m[0]&&(c=!c)}}var h,m,v;return c}function Bm(l,s){for(let c=0;c<s.length;c++)if(Xh(l,s[c]))return!0;return!1}function Fm(l,s,c,h){const m=h[0]-c[0],v=h[1]-c[1],x=(l[0]-c[0])*v-m*(l[1]-c[1]),E=(s[0]-c[0])*v-m*(s[1]-c[1]);return x>0&&E<0||x<0&&E>0}function Cc(l,s,c){for(const I of c)for(let O=0;O<I.length-1;++O)if((E=[(x=I[O+1])[0]-(v=I[O])[0],x[1]-v[1]])[0]*(C=[(m=s)[0]-(h=l)[0],m[1]-h[1]])[1]-E[1]*C[0]!=0&&Fm(h,m,v,x)&&Fm(v,x,h,m))return!0;var h,m,v,x,E,C;return!1}function Kn(l,s){for(let c=0;c<l.length;++c)if(!Xh(l[c],s))return!1;for(let c=0;c<l.length-1;++c)if(Cc(l[c],l[c+1],s))return!1;return!0}function Ew(l,s){for(let c=0;c<s.length;c++)if(Kn(l,s[c]))return!0;return!1}function Nm(l,s,c){const h=[];for(let m=0;m<l.length;m++){const v=[];for(let x=0;x<l[m].length;x++){const E=hd(l[m][x],c);Zh(s,E),v.push(E)}h.push(v)}return h}function n0(l,s,c){const h=[];for(let m=0;m<l.length;m++){const v=Nm(l[m],s,c);h.push(v)}return h}function $m(l,s,c,h){if(l[0]<c[0]||l[0]>c[2]){const m=.5*h;let v=l[0]-c[0]>m?-h:c[0]-l[0]>m?h:0;v===0&&(v=l[0]-c[2]>m?-h:c[2]-l[0]>m?h:0),l[0]+=v}Zh(s,l)}function i0(l,s,c,h){const m=Math.pow(2,h.z)*wa,v=[h.x*wa,h.y*wa],x=[];if(!l)return x;for(const E of l)for(const C of E){const I=[C.x+v[0],C.y+v[1]];$m(I,s,c,m),x.push(I)}return x}function jm(l,s,c,h){const m=Math.pow(2,h.z)*wa,v=[h.x*wa,h.y*wa],x=[];if(!l)return x;for(const C of l){const I=[];for(const O of C){const L=[O.x+v[0],O.y+v[1]];Zh(s,L),I.push(L)}x.push(I)}if(s[2]-s[0]<=m/2){(E=s)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const C of x)for(const I of C)$m(I,s,c,m)}var E;return x}class Ic{constructor(s,c){this.type=Pn,this.geojson=s,this.geometries=c}static parse(s,c){if(s.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(cd(s[1])){const h=s[1];if(h.type==="FeatureCollection")for(let m=0;m<h.features.length;++m){const v=h.features[m].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Ic(h,h.features[m].geometry)}else if(h.type==="Feature"){const m=h.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ic(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Ic(h,h)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(c,h){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const E=Nm(h.coordinates,v,x),C=i0(c.geometry(),m,v,x);if(!Tc(m,v))return!1;for(const I of C)if(!Xh(I,E))return!1}if(h.type==="MultiPolygon"){const E=n0(h.coordinates,v,x),C=i0(c.geometry(),m,v,x);if(!Tc(m,v))return!1;for(const I of C)if(!Bm(I,E))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(c,h){const m=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(h.type==="Polygon"){const E=Nm(h.coordinates,v,x),C=jm(c.geometry(),m,v,x);if(!Tc(m,v))return!1;for(const I of C)if(!Kn(I,E))return!1}if(h.type==="MultiPolygon"){const E=n0(h.coordinates,v,x),C=jm(c.geometry(),m,v,x);if(!Tc(m,v))return!1;for(const I of C)if(!Ew(I,E))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Kh=Ic;function Ac(l){if(l instanceof xa&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Kh)return!1;let s=!0;return l.eachChild(c=>{s&&!Ac(c)&&(s=!1)}),s}function Sa(l){if(l instanceof xa&&l.name==="feature-state")return!1;let s=!0;return l.eachChild(c=>{s&&!Sa(c)&&(s=!1)}),s}function $l(l,s){if(l instanceof xa&&s.indexOf(l.name)>=0)return!1;let c=!0;return l.eachChild(h=>{c&&!$l(h,s)&&(c=!1)}),c}class Yh{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(s.length!==2||typeof s[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const h=s[1];return c.scope.has(h)?new Yh(h,c.scope.get(h)):c.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var r0=Yh;class fd{constructor(s,c=[],h,m=new Yv,v=[]){this.registry=s,this.path=c,this.key=c.map(x=>`[${x}]`).join(""),this.scope=m,this.errors=v,this.expectedType=h}parse(s,c,h,m,v={}){return c?this.concat(c,h,m)._parse(s,v):this._parse(s,v)}_parse(s,c){function h(m,v,x){return x==="assert"?new _a(v,[m]):x==="coerce"?new kc(v,[m]):m}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[m];if(v){let x=v.parse(s,this);if(!x)return null;if(this.expectedType){const E=this.expectedType,C=x.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||C.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string"){if(this.checkSubtype(E,C))return null}else x=h(x,E,c.typeAnnotation||"coerce");else x=h(x,E,c.typeAnnotation||"assert")}if(!(x instanceof Fl)&&x.type.kind!=="resolvedImage"&&Um(x)){const E=new zm;try{x=new Fl(x.type,x.evaluate(E))}catch(C){return this.error(C.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,h){const m=typeof s=="number"?this.path.concat(s):this.path,v=h?this.scope.concat(h):this.scope;return new fd(this.registry,m,c||null,v,this.errors)}error(s,...c){const h=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new Zs(h,s))}checkSubtype(s,c){const h=ba(s,c);return h&&this.error(h),h}}var Vm=fd;function Um(l){if(l instanceof r0)return Um(l.boundExpression);if(l instanceof xa&&l.name==="error"||l instanceof dd||l instanceof Kh)return!1;const s=l instanceof kc||l instanceof _a;let c=!0;return l.eachChild(h=>{c=s?c&&Um(h):c&&h instanceof Fl}),!!c&&Ac(l)&&$l(l,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Jh(l,s){const c=l.length-1;let h,m,v=0,x=c,E=0;for(;v<=x;)if(E=Math.floor((v+x)/2),h=l[E],m=l[E+1],h<=s){if(E===c||s<m)return E;v=E+1}else{if(!(h>s))throw new Wr("Input is not a number.");x=E-1}return 0}class Qh{constructor(s,c,h){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[m,v]of h)this.labels.push(m),this.outputs.push(v)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const h=c.parse(s[1],1,Gt);if(!h)return null;const m=[];let v=null;c.expectedType&&c.expectedType.kind!=="value"&&(v=c.expectedType);for(let x=1;x<s.length;x+=2){const E=x===1?-1/0:s[x],C=s[x+1],I=x,O=x+1;if(typeof E!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(m.length&&m[m.length-1][0]>=E)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=c.parse(C,O,v);if(!L)return null;v=v||L.type,m.push([E,L])}return new Qh(v,h,m)}evaluate(s){const c=this.labels,h=this.outputs;if(c.length===1)return h[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return h[0].evaluate(s);const v=c.length;return m>=c[v-1]?h[v-1].evaluate(s):h[Jh(c,m)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&s.push(this.labels[c]),s.push(this.outputs[c].serialize());return s}}var qm=Qh;function Vn(l,s,c){return l*(1-c)+s*c}var pd=Object.freeze({__proto__:null,array:function(l,s,c){return l.map((h,m)=>Vn(h,s[m],c))},color:function(l,s,c){return new Qi(Vn(l.r,s.r,c),Vn(l.g,s.g,c),Vn(l.b,s.b,c),Vn(l.a,s.a,c))},number:Vn});const o0=.95047,Wm=1.08883,s0=4/29,jl=6/29,Gm=3*jl*jl,kw=jl*jl*jl,Tw=Math.PI/180,Cw=180/Math.PI;function Hm(l){return l>kw?Math.pow(l,1/3):l/Gm+s0}function Zm(l){return l>jl?l*l*l:Gm*(l-s0)}function Xm(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function ef(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function a0(l){const s=ef(l.r),c=ef(l.g),h=ef(l.b),m=Hm((.4124564*s+.3575761*c+.1804375*h)/o0),v=Hm((.2126729*s+.7151522*c+.072175*h)/1);return{l:116*v-16,a:500*(m-v),b:200*(v-Hm((.0193339*s+.119192*c+.9503041*h)/Wm)),alpha:l.a}}function l0(l){let s=(l.l+16)/116,c=isNaN(l.a)?s:s+l.a/500,h=isNaN(l.b)?s:s-l.b/200;return s=1*Zm(s),c=o0*Zm(c),h=Wm*Zm(h),new Qi(Xm(3.2404542*c-1.5371385*s-.4985314*h),Xm(-.969266*c+1.8760108*s+.041556*h),Xm(.0556434*c-.2040259*s+1.0572252*h),l.alpha)}function Iw(l,s,c){const h=s-l;return l+c*(h>180||h<-180?h-360*Math.round(h/360):h)}const md={forward:a0,reverse:l0,interpolate:function(l,s,c){return{l:Vn(l.l,s.l,c),a:Vn(l.a,s.a,c),b:Vn(l.b,s.b,c),alpha:Vn(l.alpha,s.alpha,c)}}},Mc={forward:function(l){const{l:s,a:c,b:h}=a0(l),m=Math.atan2(h,c)*Cw;return{h:m<0?m+360:m,c:Math.sqrt(c*c+h*h),l:s,alpha:l.a}},reverse:function(l){const s=l.h*Tw,c=l.c;return l0({l:l.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:l.alpha})},interpolate:function(l,s,c){return{h:Iw(l.h,s.h,c),c:Vn(l.c,s.c,c),l:Vn(l.l,s.l,c),alpha:Vn(l.alpha,s.alpha,c)}}};var Km=Object.freeze({__proto__:null,hcl:Mc,lab:md});class gd{constructor(s,c,h,m,v){this.type=s,this.operator=c,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[x,E]of v)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(s,c,h,m){let v=0;if(s.name==="exponential")v=Ym(c,s.base,h,m);else if(s.name==="linear")v=Ym(c,1,h,m);else if(s.name==="cubic-bezier"){const x=s.controlPoints;v=new ie(x[0],x[1],x[2],x[3]).solve(Ym(c,1,h,m))}return v}static parse(s,c){let[h,m,v,...x]=s;if(!Array.isArray(m)||m.length===0)return c.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const I=m[1];if(typeof I!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:I}}else{if(m[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const I=m.slice(1);if(I.length!==4||I.some(O=>typeof O!="number"||O<0||O>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:I}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(v=c.parse(v,2,Gt),!v)return null;const E=[];let C=null;h==="interpolate-hcl"||h==="interpolate-lab"?C=Uo:c.expectedType&&c.expectedType.kind!=="value"&&(C=c.expectedType);for(let I=0;I<x.length;I+=2){const O=x[I],L=x[I+1],B=I+3,j=I+4;if(typeof O!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(E.length&&E[E.length-1][0]>=O)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const U=c.parse(L,j,C);if(!U)return null;C=C||U.type,E.push([O,U])}return C.kind==="number"||C.kind==="color"||C.kind==="array"&&C.itemType.kind==="number"&&typeof C.N=="number"?new gd(C,h,m,v,E):c.error(`Type ${Ii(C)} is not interpolatable.`)}evaluate(s){const c=this.labels,h=this.outputs;if(c.length===1)return h[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return h[0].evaluate(s);const v=c.length;if(m>=c[v-1])return h[v-1].evaluate(s);const x=Jh(c,m),E=gd.interpolationFactor(this.interpolation,m,c[x],c[x+1]),C=h[x].evaluate(s),I=h[x+1].evaluate(s);return this.operator==="interpolate"?pd[this.type.kind.toLowerCase()](C,I,E):this.operator==="interpolate-hcl"?Mc.reverse(Mc.interpolate(Mc.forward(C),Mc.forward(I),E)):md.reverse(md.interpolate(md.forward(C),md.forward(I),E))}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,s,this.input.serialize()];for(let h=0;h<this.labels.length;h++)c.push(this.labels[h],this.outputs[h].serialize());return c}}function Ym(l,s,c,h){const m=h-c,v=l-c;return m===0?0:s===1?v/m:(Math.pow(s,v)-1)/(Math.pow(s,m)-1)}var Ks=gd;class tf{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let h=null;const m=c.expectedType;m&&m.kind!=="value"&&(h=m);const v=[];for(const E of s.slice(1)){const C=c.parse(E,1+v.length,h,void 0,{typeAnnotation:"omit"});if(!C)return null;h=h||C.type,v.push(C)}const x=m&&v.some(E=>ba(m,E.type));return new tf(x?On:h,v)}evaluate(s){let c,h=null,m=0;for(const v of this.args){if(m++,h=v.evaluate(s),h&&h instanceof rs&&!h.available&&(c||(c=h),h=null,m===this.args.length))return c;if(h!==null)break}return h}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var Jm=tf;class nf{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const h=[];for(let v=1;v<s.length-1;v+=2){const x=s[v];if(typeof x!="string")return c.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return c.error("Variable names must contain only alphanumeric characters or '_'.",v);const E=c.parse(s[v+1],v+1);if(!E)return null;h.push([x,E])}const m=c.parse(s[s.length-1],s.length-1,c.expectedType,h);return m?new nf(h,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[c,h]of this.bindings)s.push(c,h.serialize());return s.push(this.result.serialize()),s}}var c0=nf;class Qm{constructor(s,c,h){this.type=s,this.index=c,this.input=h}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,Gt),m=c.parse(s[2],2,is(c.expectedType||On));return h&&m?new Qm(m.type.itemType,h,m):null}evaluate(s){const c=this.index.evaluate(s),h=this.input.evaluate(s);if(c<0)throw new Wr(`Array index out of bounds: ${c} < 0.`);if(c>=h.length)throw new Wr(`Array index out of bounds: ${c} > ${h.length-1}.`);if(c!==Math.floor(c))throw new Wr(`Array index must be an integer, but found ${c} instead.`);return h[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Aw=Qm;class eg{constructor(s,c){this.type=Pn,this.needle=s,this.haystack=c}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,On),m=c.parse(s[2],2,On);return h&&m?od(h.type,[Pn,zn,Gt,Sc,On])?new eg(h,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(h.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),h=this.haystack.evaluate(s);if(h==null)return!1;if(!sd(c,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(Wi(c))} instead.`);if(!sd(h,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${Ii(Wi(h))} instead.`);return h.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var rf=eg;class yd{constructor(s,c,h){this.type=Gt,this.needle=s,this.haystack=c,this.fromIndex=h}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,On),m=c.parse(s[2],2,On);if(!h||!m)return null;if(!od(h.type,[Pn,zn,Gt,Sc,On]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(h.type)} instead`);if(s.length===4){const v=c.parse(s[3],3,Gt);return v?new yd(h,m,v):null}return new yd(h,m)}evaluate(s){const c=this.needle.evaluate(s),h=this.haystack.evaluate(s);if(!sd(c,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(Wi(c))} instead.`);if(!sd(h,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${Ii(Wi(h))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(s);return h.indexOf(c,m)}return h.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var u0=yd;class tg{constructor(s,c,h,m,v,x){this.inputType=s,this.type=c,this.input=h,this.cases=m,this.outputs=v,this.otherwise=x}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let h,m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);const v={},x=[];for(let I=2;I<s.length-1;I+=2){let O=s[I];const L=s[I+1];Array.isArray(O)||(O=[O]);const B=c.concat(I);if(O.length===0)return B.error("Expected at least one branch label.");for(const U of O){if(typeof U!="number"&&typeof U!="string")return B.error("Branch labels must be numbers or strings.");if(typeof U=="number"&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof U=="number"&&Math.floor(U)!==U)return B.error("Numeric branch labels must be integer values.");if(h){if(B.checkSubtype(h,Wi(U)))return null}else h=Wi(U);if(v[String(U)]!==void 0)return B.error("Branch labels must be unique.");v[String(U)]=x.length}const j=c.parse(L,I,m);if(!j)return null;m=m||j.type,x.push(j)}const E=c.parse(s[1],1,On);if(!E)return null;const C=c.parse(s[s.length-1],s.length-1,m);return C?E.type.kind!=="value"&&c.concat(1).checkSubtype(h,E.type)?null:new tg(h,m,E,v,x,C):null}evaluate(s){const c=this.input.evaluate(s);return(Wi(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),h=[],m={};for(const x of c){const E=m[this.cases[x]];E===void 0?(m[this.cases[x]]=h.length,h.push([this.cases[x],[x]])):h[E][1].push(x)}const v=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,E]of h)s.push(E.length===1?v(E[0]):E.map(v)),s.push(this.outputs[x].serialize());return s.push(this.otherwise.serialize()),s}}var Mw=tg;class ng{constructor(s,c,h){this.type=s,this.branches=c,this.otherwise=h}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let h;c.expectedType&&c.expectedType.kind!=="value"&&(h=c.expectedType);const m=[];for(let x=1;x<s.length-1;x+=2){const E=c.parse(s[x],x,Pn);if(!E)return null;const C=c.parse(s[x+1],x+1,h);if(!C)return null;m.push([E,C]),h=h||C.type}const v=c.parse(s[s.length-1],s.length-1,h);return v?new ng(h,m,v):null}evaluate(s){for(const[c,h]of this.branches)if(c.evaluate(s))return h.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,h]of this.branches)s(c),s(h);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var d0=ng;class vd{constructor(s,c,h,m){this.type=s,this.input=c,this.beginIndex=h,this.endIndex=m}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const h=c.parse(s[1],1,On),m=c.parse(s[2],2,Gt);if(!h||!m)return null;if(!od(h.type,[is(On),zn,On]))return c.error(`Expected first argument to be of type array or string, but found ${Ii(h.type)} instead`);if(s.length===4){const v=c.parse(s[3],3,Gt);return v?new vd(h.type,h,m,v):null}return new vd(h.type,h,m)}evaluate(s){const c=this.input.evaluate(s),h=this.beginIndex.evaluate(s);if(!sd(c,["string","array"]))throw new Wr(`Expected first argument to be of type array or string, but found ${Ii(Wi(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(s);return c.slice(h,m)}return c.slice(h)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var h0=vd;function of(l,s){return l==="=="||l==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function f0(l,s,c,h){return h.compare(s,c)===0}function Pc(l,s,c){const h=l!=="=="&&l!=="!=";return class y5{constructor(v,x,E){this.type=Pn,this.lhs=v,this.rhs=x,this.collator=E,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const E=v[0];let C=x.parse(v[1],1,On);if(!C)return null;if(!of(E,C.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${Ii(C.type)}'.`);let I=x.parse(v[2],2,On);if(!I)return null;if(!of(E,I.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${Ii(I.type)}'.`);if(C.type.kind!==I.type.kind&&C.type.kind!=="value"&&I.type.kind!=="value")return x.error(`Cannot compare types '${Ii(C.type)}' and '${Ii(I.type)}'.`);h&&(C.type.kind==="value"&&I.type.kind!=="value"?C=new _a(I.type,[C]):C.type.kind!=="value"&&I.type.kind==="value"&&(I=new _a(C.type,[I])));let O=null;if(v.length===4){if(C.type.kind!=="string"&&I.type.kind!=="string"&&C.type.kind!=="value"&&I.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(O=x.parse(v[3],3,qo),!O)return null}return new y5(C,I,O)}evaluate(v){const x=this.lhs.evaluate(v),E=this.rhs.evaluate(v);if(h&&this.hasUntypedArgument){const C=Wi(x),I=Wi(E);if(C.kind!==I.kind||C.kind!=="string"&&C.kind!=="number")throw new Wr(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${C.kind}, ${I.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const C=Wi(x),I=Wi(E);if(C.kind!=="string"||I.kind!=="string")return s(v,x,E)}return this.collator?c(v,x,E,this.collator.evaluate(v)):s(v,x,E)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[l];return this.eachChild(x=>{v.push(x.serialize())}),v}}}const Pw=Pc("==",function(l,s,c){return s===c},f0),Ow=Pc("!=",function(l,s,c){return s!==c},function(l,s,c,h){return!f0(0,s,c,h)}),Dw=Pc("<",function(l,s,c){return s<c},function(l,s,c,h){return h.compare(s,c)<0}),Rw=Pc(">",function(l,s,c){return s>c},function(l,s,c,h){return h.compare(s,c)>0}),Lw=Pc("<=",function(l,s,c){return s<=c},function(l,s,c,h){return h.compare(s,c)<=0}),p0=Pc(">=",function(l,s,c){return s>=c},function(l,s,c,h){return h.compare(s,c)>=0});class sf{constructor(s,c,h,m,v,x){this.type=zn,this.number=s,this.locale=c,this.currency=h,this.unit=m,this.minFractionDigits=v,this.maxFractionDigits=x}static parse(s,c){if(s.length!==3)return c.error("Expected two arguments.");const h=c.parse(s[1],1,Gt);if(!h)return null;const m=s[2];if(typeof m!="object"||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let v=null;if(m.locale&&(v=c.parse(m.locale,1,zn),!v))return null;let x=null;if(m.currency&&(x=c.parse(m.currency,1,zn),!x))return null;let E=null;if(m.unit&&(E=c.parse(m.unit,1,zn),!E))return null;let C=null;if(m["min-fraction-digits"]&&(C=c.parse(m["min-fraction-digits"],1,Gt),!C))return null;let I=null;return m["max-fraction-digits"]&&(I=c.parse(m["max-fraction-digits"],1,Gt),!I)?null:new sf(h,v,x,E,C,I)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class Oc{constructor(s){this.type=Gt,this.input=s}static parse(s,c){if(s.length!==2)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const h=c.parse(s[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Ii(h.type)} instead.`):new Oc(h):null}evaluate(s){const c=this.input.evaluate(s);if(typeof c=="string"||Array.isArray(c))return c.length;throw new Wr(`Expected value to be of type string or array, but found ${Ii(Wi(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(c=>{s.push(c.serialize())}),s}}const m0={"==":Pw,"!=":Ow,">":Rw,"<":Dw,">=":p0,"<=":Lw,array:_a,at:Aw,boolean:_a,case:d0,coalesce:Jm,collator:dd,format:ol,image:Hh,in:rf,"index-of":u0,interpolate:Ks,"interpolate-hcl":Ks,"interpolate-lab":Ks,length:Oc,let:c0,literal:Fl,match:Mw,number:_a,"number-format":sf,object:_a,slice:h0,step:qm,string:_a,"to-boolean":kc,"to-color":kc,"to-number":kc,"to-string":kc,var:r0,within:Kh};function g0(l,[s,c,h,m]){s=s.evaluate(l),c=c.evaluate(l),h=h.evaluate(l);const v=m?m.evaluate(l):1,x=e0(s,c,h,v);if(x)throw new Wr(x);return new Qi(s/255*v,c/255*v,h/255*v,v)}function Ea(l,s){return l in s}function af(l,s){const c=s[l];return c===void 0?null:c}function ss(l){return{type:l}}xa.register(m0,{error:[{kind:"error"},[zn],(l,[s])=>{throw new Wr(s.evaluate(l))}],typeof:[zn,[On],(l,[s])=>Ii(Wi(s.evaluate(l)))],"to-rgba":[is(Gt,4),[Uo],(l,[s])=>s.evaluate(l).toArray()],rgb:[Uo,[Gt,Gt,Gt],g0],rgba:[Uo,[Gt,Gt,Gt,Gt],g0],has:{type:Pn,overloads:[[[zn],(l,[s])=>Ea(s.evaluate(l),l.properties())],[[zn,ks],(l,[s,c])=>Ea(s.evaluate(l),c.evaluate(l))]]},get:{type:On,overloads:[[[zn],(l,[s])=>af(s.evaluate(l),l.properties())],[[zn,ks],(l,[s,c])=>af(s.evaluate(l),c.evaluate(l))]]},"feature-state":[On,[zn],(l,[s])=>af(s.evaluate(l),l.featureState||{})],properties:[ks,[],l=>l.properties()],"geometry-type":[zn,[],l=>l.geometryType()],id:[On,[],l=>l.id()],zoom:[Gt,[],l=>l.globals.zoom],pitch:[Gt,[],l=>l.globals.pitch||0],"distance-from-center":[Gt,[],l=>l.distanceFromCenter()],"heatmap-density":[Gt,[],l=>l.globals.heatmapDensity||0],"line-progress":[Gt,[],l=>l.globals.lineProgress||0],"sky-radial-progress":[Gt,[],l=>l.globals.skyRadialProgress||0],accumulated:[On,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[Gt,ss(Gt),(l,s)=>{let c=0;for(const h of s)c+=h.evaluate(l);return c}],"*":[Gt,ss(Gt),(l,s)=>{let c=1;for(const h of s)c*=h.evaluate(l);return c}],"-":{type:Gt,overloads:[[[Gt,Gt],(l,[s,c])=>s.evaluate(l)-c.evaluate(l)],[[Gt],(l,[s])=>-s.evaluate(l)]]},"/":[Gt,[Gt,Gt],(l,[s,c])=>s.evaluate(l)/c.evaluate(l)],"%":[Gt,[Gt,Gt],(l,[s,c])=>s.evaluate(l)%c.evaluate(l)],ln2:[Gt,[],()=>Math.LN2],pi:[Gt,[],()=>Math.PI],e:[Gt,[],()=>Math.E],"^":[Gt,[Gt,Gt],(l,[s,c])=>Math.pow(s.evaluate(l),c.evaluate(l))],sqrt:[Gt,[Gt],(l,[s])=>Math.sqrt(s.evaluate(l))],log10:[Gt,[Gt],(l,[s])=>Math.log(s.evaluate(l))/Math.LN10],ln:[Gt,[Gt],(l,[s])=>Math.log(s.evaluate(l))],log2:[Gt,[Gt],(l,[s])=>Math.log(s.evaluate(l))/Math.LN2],sin:[Gt,[Gt],(l,[s])=>Math.sin(s.evaluate(l))],cos:[Gt,[Gt],(l,[s])=>Math.cos(s.evaluate(l))],tan:[Gt,[Gt],(l,[s])=>Math.tan(s.evaluate(l))],asin:[Gt,[Gt],(l,[s])=>Math.asin(s.evaluate(l))],acos:[Gt,[Gt],(l,[s])=>Math.acos(s.evaluate(l))],atan:[Gt,[Gt],(l,[s])=>Math.atan(s.evaluate(l))],min:[Gt,ss(Gt),(l,s)=>Math.min(...s.map(c=>c.evaluate(l)))],max:[Gt,ss(Gt),(l,s)=>Math.max(...s.map(c=>c.evaluate(l)))],abs:[Gt,[Gt],(l,[s])=>Math.abs(s.evaluate(l))],round:[Gt,[Gt],(l,[s])=>{const c=s.evaluate(l);return c<0?-Math.round(-c):Math.round(c)}],floor:[Gt,[Gt],(l,[s])=>Math.floor(s.evaluate(l))],ceil:[Gt,[Gt],(l,[s])=>Math.ceil(s.evaluate(l))],"filter-==":[Pn,[zn,On],(l,[s,c])=>l.properties()[s.value]===c.value],"filter-id-==":[Pn,[On],(l,[s])=>l.id()===s.value],"filter-type-==":[Pn,[zn],(l,[s])=>l.geometryType()===s.value],"filter-<":[Pn,[zn,On],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h<m}],"filter-id-<":[Pn,[On],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c<h}],"filter->":[Pn,[zn,On],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h>m}],"filter-id->":[Pn,[On],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c>h}],"filter-<=":[Pn,[zn,On],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[Pn,[On],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c<=h}],"filter->=":[Pn,[zn,On],(l,[s,c])=>{const h=l.properties()[s.value],m=c.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[Pn,[On],(l,[s])=>{const c=l.id(),h=s.value;return typeof c==typeof h&&c>=h}],"filter-has":[Pn,[On],(l,[s])=>s.value in l.properties()],"filter-has-id":[Pn,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[Pn,[is(zn)],(l,[s])=>s.value.indexOf(l.geometryType())>=0],"filter-id-in":[Pn,[is(On)],(l,[s])=>s.value.indexOf(l.id())>=0],"filter-in-small":[Pn,[zn,is(On)],(l,[s,c])=>c.value.indexOf(l.properties()[s.value])>=0],"filter-in-large":[Pn,[zn,is(On)],(l,[s,c])=>function(h,m,v,x){for(;v<=x;){const E=v+x>>1;if(m[E]===h)return!0;m[E]>h?x=E-1:v=E+1}return!1}(l.properties()[s.value],c.value,0,c.value.length-1)],all:{type:Pn,overloads:[[[Pn,Pn],(l,[s,c])=>s.evaluate(l)&&c.evaluate(l)],[ss(Pn),(l,s)=>{for(const c of s)if(!c.evaluate(l))return!1;return!0}]]},any:{type:Pn,overloads:[[[Pn,Pn],(l,[s,c])=>s.evaluate(l)||c.evaluate(l)],[ss(Pn),(l,s)=>{for(const c of s)if(c.evaluate(l))return!0;return!1}]]},"!":[Pn,[Pn],(l,[s])=>!s.evaluate(l)],"is-supported-script":[Pn,[zn],(l,[s])=>{const c=l.globals&&l.globals.isSupportedScript;return!c||c(s.evaluate(l))}],upcase:[zn,[zn],(l,[s])=>s.evaluate(l).toUpperCase()],downcase:[zn,[zn],(l,[s])=>s.evaluate(l).toLowerCase()],concat:[zn,ss(On),(l,s)=>s.map(c=>ud(c.evaluate(l))).join("")],"resolved-locale":[zn,[qo],(l,[s])=>s.evaluate(l).resolvedLocale()]});var bd=m0;function y0(l){return{result:"success",value:l}}function Vl(l){return{result:"error",value:l}}function Dc(l){return l["property-type"]==="data-driven"}function lf(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function cf(l){return!!l.expression&&l.expression.interpolated}function Un(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function _d(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function v0(l){return l}function uf(l,s){const c=s.type==="color",h=l.stops&&typeof l.stops[0][0]=="object",m=h||!(h||l.property!==void 0),v=l.type||(cf(s)?"exponential":"interval");if(c&&((l=va({},l)).stops&&(l.stops=l.stops.map(I=>[I[0],Qi.parse(I[1])])),l.default=Qi.parse(l.default?l.default:s.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!Km[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let x,E,C;if(v==="exponential")x=ka;else if(v==="interval")x=df;else if(v==="categorical"){x=b0,E=Object.create(null);for(const I of l.stops)E[I[0]]=I[1];C=typeof l.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);x=_0}if(h){const I={},O=[];for(let j=0;j<l.stops.length;j++){const U=l.stops[j],X=U[0].zoom;I[X]===void 0&&(I[X]={zoom:X,type:l.type,property:l.property,default:l.default,stops:[]},O.push(X)),I[X].stops.push([U[0].value,U[1]])}const L=[];for(const j of O)L.push([I[j].zoom,uf(I[j],s)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Ks.interpolationFactor.bind(void 0,B),zoomStops:L.map(j=>j[0]),evaluate:({zoom:j},U)=>ka({stops:L,base:l.base},s,j).evaluate(j,U)}}if(m){const I=v==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Ks.interpolationFactor.bind(void 0,I),zoomStops:l.stops.map(O=>O[0]),evaluate:({zoom:O})=>x(l,s,O,E,C)}}return{kind:"source",evaluate(I,O){const L=O&&O.properties?O.properties[l.property]:void 0;return L===void 0?Rc(l.default,s.default):x(l,s,L,E,C)}}}function Rc(l,s,c){return l!==void 0?l:s!==void 0?s:c!==void 0?c:void 0}function b0(l,s,c,h,m){return Rc(typeof c===m?h[c]:void 0,l.default,s.default)}function df(l,s,c){if(Un(c)!=="number")return Rc(l.default,s.default);const h=l.stops.length;if(h===1||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[h-1][0])return l.stops[h-1][1];const m=Jh(l.stops.map(v=>v[0]),c);return l.stops[m][1]}function ka(l,s,c){const h=l.base!==void 0?l.base:1;if(Un(c)!=="number")return Rc(l.default,s.default);const m=l.stops.length;if(m===1||c<=l.stops[0][0])return l.stops[0][1];if(c>=l.stops[m-1][0])return l.stops[m-1][1];const v=Jh(l.stops.map(O=>O[0]),c),x=function(O,L,B,j){const U=j-B,X=O-B;return U===0?0:L===1?X/U:(Math.pow(L,X)-1)/(Math.pow(L,U)-1)}(c,h,l.stops[v][0],l.stops[v+1][0]),E=l.stops[v][1],C=l.stops[v+1][1];let I=pd[s.type]||v0;if(l.colorSpace&&l.colorSpace!=="rgb"){const O=Km[l.colorSpace];I=(L,B)=>O.reverse(O.interpolate(O.forward(L),O.forward(B),x))}return typeof E.evaluate=="function"?{evaluate(...O){const L=E.evaluate.apply(void 0,O),B=C.evaluate.apply(void 0,O);if(L!==void 0&&B!==void 0)return I(L,B,x)}}:I(E,C,x)}function _0(l,s,c){return s.type==="color"?c=Qi.parse(c):s.type==="formatted"?c=Eo.fromString(c.toString()):s.type==="resolvedImage"?c=rs.fromString(c.toString()):Un(c)===s.type||s.type==="enum"&&s.values[c]||(c=void 0),Rc(c,l.default,s.default)}class hf{constructor(s,c){this.expression=s,this._warningHistory={},this._evaluator=new zm,this._defaultValue=c?function(h){return h.type==="color"&&(_d(h.default)||Array.isArray(h.default))?new Qi(0,0,0,0):h.type==="color"?Qi.parse(h.default)||null:h.default===void 0?null:h.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null}evaluateWithoutErrorHandling(s,c,h,m,v,x,E,C){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=h,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(s,c,h,m,v,x,E,C){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=C||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new Wr(`Expected value to be one of ${Object.keys(this._enumValues).map(O=>JSON.stringify(O)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function Lc(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in bd}function zc(l,s){const c=new Vm(bd,[],s?function(m){const v={color:Uo,string:zn,number:Gt,enum:zn,boolean:Pn,formatted:rd,resolvedImage:Bl};return m.type==="array"?is(v[m.value]||On,m.length):v[m.type]}(s):void 0),h=c.parse(l,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?y0(new hf(h,s)):Vl(c.errors)}class ig{constructor(s,c){this.kind=s,this._styleExpression=c,this.isStateDependent=s!=="constant"&&!Sa(c.expression)}evaluateWithoutErrorHandling(s,c,h,m,v,x){return this._styleExpression.evaluateWithoutErrorHandling(s,c,h,m,v,x)}evaluate(s,c,h,m,v,x){return this._styleExpression.evaluate(s,c,h,m,v,x)}}class xd{constructor(s,c,h,m){this.kind=s,this.zoomStops=h,this._styleExpression=c,this.isStateDependent=s!=="camera"&&!Sa(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,c,h,m,v,x){return this._styleExpression.evaluateWithoutErrorHandling(s,c,h,m,v,x)}evaluate(s,c,h,m,v,x){return this._styleExpression.evaluate(s,c,h,m,v,x)}interpolationFactor(s,c,h){return this.interpolationType?Ks.interpolationFactor(this.interpolationType,s,c,h):0}}function wd(l,s){if((l=zc(l,s)).result==="error")return l;const c=l.value.expression,h=Ac(c);if(!h&&!Dc(s))return Vl([new Zs("","data expressions not supported")]);const m=$l(c,["zoom","pitch","distance-from-center"]);if(!m&&!lf(s))return Vl([new Zs("","zoom expressions not supported")]);const v=pf(c);return v||m?v instanceof Zs?Vl([v]):v instanceof Ks&&!cf(s)?Vl([new Zs("",'"interpolate" expressions cannot be used with this property')]):y0(v?new xd(h?"camera":"composite",l.value,v.labels,v instanceof Ks?v.interpolation:void 0):new ig(h?"constant":"source",l.value)):Vl([new Zs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ff{constructor(s,c){this._parameters=s,this._specification=c,va(this,uf(this._parameters,this._specification))}static deserialize(s){return new ff(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function pf(l){let s=null;if(l instanceof c0)s=pf(l.result);else if(l instanceof Jm){for(const c of l.args)if(s=pf(c),s)break}else(l instanceof qm||l instanceof Ks)&&l.input instanceof xa&&l.input.name==="zoom"&&(s=l);return s instanceof Zs||l.eachChild(c=>{const h=pf(c);h instanceof Zs?s=h:!s&&h?s=new Zs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&h&&s!==h&&(s=new Zs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class Ht{constructor(s,c,h,m){this.message=(s?`${s}: `:"")+h,m&&(this.identifier=m),c!=null&&c.__line__&&(this.line=c.__line__)}}function Ts(l){const s=l.key,c=l.value,h=l.valueSpec||{},m=l.objectElementValidators||{},v=l.style,x=l.styleSpec;let E=[];const C=Un(c);if(C!=="object")return[new Ht(s,c,`object expected, ${C} found`)];for(const I in c){const O=I.split(".")[0];let L;m[O]?L=m[O]:h[O]?L=Jr:m["*"]?L=m["*"]:h["*"]&&(L=Jr),L?E=E.concat(L({key:(s&&`${s}.`)+I,value:c[I],valueSpec:h[O]||h["*"],style:v,styleSpec:x,object:c,objectKey:I},c)):E.push(new Ht(s,c[I],`unknown property "${I}"`))}for(const I in h)m[I]||h[I].required&&h[I].default===void 0&&c[I]===void 0&&E.push(new Ht(s,c,`missing required property "${I}"`));return E}function x0(l){const s=l.value,c=l.valueSpec,h=l.style,m=l.styleSpec,v=l.key,x=l.arrayElementValidator||Jr;if(Un(s)!=="array")return[new Ht(v,s,`array expected, ${Un(s)} found`)];if(c.length&&s.length!==c.length)return[new Ht(v,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new Ht(v,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let E={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};m.$version<7&&(E.function=c.function),Un(c.value)==="object"&&(E=c.value);let C=[];for(let I=0;I<s.length;I++)C=C.concat(x({array:s,arrayIndex:I,value:s[I],valueSpec:E,style:h,styleSpec:m,key:`${v}[${I}]`}));return C}function Sd(l){const s=l.key,c=l.value,h=l.valueSpec;let m=Un(c);if(m==="number"&&c!=c&&(m="NaN"),m!=="number")return[new Ht(s,c,`number expected, ${m} found`)];if("minimum"in h){let v=h.minimum;if(Un(h.minimum)==="array"&&(v=h.minimum[l.arrayIndex]),c<v)return[new Ht(s,c,`${c} is less than the minimum value ${v}`)]}if("maximum"in h){let v=h.maximum;if(Un(h.maximum)==="array"&&(v=h.maximum[l.arrayIndex]),c>v)return[new Ht(s,c,`${c} is greater than the maximum value ${v}`)]}return[]}function Ed(l){const s=l.valueSpec,c=ar(l.value.type);let h,m,v,x={};const E=c!=="categorical"&&l.value.property===void 0,C=!E,I=Un(l.value.stops)==="array"&&Un(l.value.stops[0])==="array"&&Un(l.value.stops[0][0])==="object",O=Ts({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(j){if(c==="identity")return[new Ht(j.key,j.value,'identity function may not have a "stops" property')];let U=[];const X=j.value;return U=U.concat(x0({key:j.key,value:X,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:L})),Un(X)==="array"&&X.length===0&&U.push(new Ht(j.key,X,"array must have at least one stop")),U},default:function(j){return Jr({key:j.key,value:j.value,valueSpec:s,style:j.style,styleSpec:j.styleSpec})}}});return c==="identity"&&E&&O.push(new Ht(l.key,l.value,'missing required property "property"')),c==="identity"||l.value.stops||O.push(new Ht(l.key,l.value,'missing required property "stops"')),c==="exponential"&&l.valueSpec.expression&&!cf(l.valueSpec)&&O.push(new Ht(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(C&&!Dc(l.valueSpec)?O.push(new Ht(l.key,l.value,"property functions not supported")):E&&!lf(l.valueSpec)&&O.push(new Ht(l.key,l.value,"zoom functions not supported"))),c!=="categorical"&&!I||l.value.property!==void 0||O.push(new Ht(l.key,l.value,'"property" property is required')),O;function L(j){let U=[];const X=j.value,re=j.key;if(Un(X)!=="array")return[new Ht(re,X,`array expected, ${Un(X)} found`)];if(X.length!==2)return[new Ht(re,X,`array length 2 expected, length ${X.length} found`)];if(I){if(Un(X[0])!=="object")return[new Ht(re,X,`object expected, ${Un(X[0])} found`)];if(X[0].zoom===void 0)return[new Ht(re,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new Ht(re,X,"object stop key must have value")];const he=ar(X[0].zoom);if(typeof he!="number")return[new Ht(re,X[0].zoom,"stop zoom values must be numbers")];if(v&&v>he)return[new Ht(re,X[0].zoom,"stop zoom values must appear in ascending order")];he!==v&&(v=he,m=void 0,x={}),U=U.concat(Ts({key:`${re}[0]`,value:X[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:Sd,value:B}}))}else U=U.concat(B({key:`${re}[0]`,value:X[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},X));return Lc(Dr(X[1]))?U.concat([new Ht(`${re}[1]`,X[1],"expressions are not allowed in function stops.")]):U.concat(Jr({key:`${re}[1]`,value:X[1],valueSpec:s,style:j.style,styleSpec:j.styleSpec}))}function B(j,U){const X=Un(j.value),re=ar(j.value),he=j.value!==null?j.value:U;if(h){if(X!==h)return[new Ht(j.key,he,`${X} stop domain type must match previous stop domain type ${h}`)]}else h=X;if(X!=="number"&&X!=="string"&&X!=="boolean"&&typeof re!="number"&&typeof re!="string"&&typeof re!="boolean")return[new Ht(j.key,he,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&c!=="categorical"){let xe=`number expected, ${X} found`;return Dc(s)&&c===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ht(j.key,he,xe)]}return c!=="categorical"||X!=="number"||typeof re=="number"&&isFinite(re)&&Math.floor(re)===re?c!=="categorical"&&X==="number"&&typeof re=="number"&&typeof m=="number"&&m!==void 0&&re<m?[new Ht(j.key,he,"stop domain values must appear in ascending order")]:(m=re,c==="categorical"&&re in x?[new Ht(j.key,he,"stop domain values must be unique")]:(x[re]=!0,[])):[new Ht(j.key,he,`integer expected, found ${String(re)}`)]}}function Rr(l){const s=(l.expressionContext==="property"?wd:zc)(Dr(l.value),l.valueSpec);if(s.result==="error")return s.value.map(h=>new Ht(`${l.key}${h.key}`,l.value,h.message));const c=s.value.expression||s.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!c.outputDefined())return[new Ht(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!Sa(c))return[new Ht(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter")return kd(c,l);if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!$l(c,["zoom","feature-state"]))return[new Ht(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!Ac(c))return[new Ht(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function kd(l,s){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const m of s.valueSpec.expression.parameters)c.delete(m);if(c.size===0)return[];const h=[];return l instanceof xa&&c.has(l.name)?[new Ht(s.key,s.value,`["${l.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(l.eachChild(m=>{h.push(...kd(m,s))}),h)}function mf(l){const s=l.key,c=l.value,h=l.valueSpec,m=[];return Array.isArray(h.values)?h.values.indexOf(ar(c))===-1&&m.push(new Ht(s,c,`expected one of [${h.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(h.values).indexOf(ar(c))===-1&&m.push(new Ht(s,c,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function rg(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const s of l.slice(1))if(!rg(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function gf(l,s="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};rg(l)||(l=Fc(l));const c=l;let h=!0;try{h=function(I){if(!Bc(I))return I;let O=Dr(I);return yf(O),O=w0(O),O}(c)}catch(I){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(c,null,2)}
        `)}const m=st[`filter_${s}`],v=zc(h,m);let x=null;if(v.result==="error")throw new Error(v.value.map(I=>`${I.key}: ${I.message}`).join(", "));x=(I,O,L)=>v.value.evaluate(I,O,{},L);let E=null,C=null;if(h!==c){const I=zc(c,m);if(I.result==="error")throw new Error(I.value.map(O=>`${O.key}: ${O.message}`).join(", "));E=(O,L,B,j,U)=>I.value.evaluate(O,L,{},B,void 0,void 0,j,U),C=!Ac(I.value.expression)}return{filter:x,dynamicFilter:E||void 0,needGeometry:S0(h),needFeature:!!C}}function w0(l){if(!Array.isArray(l))return l;const s=function(c){if(og.has(c[0])){for(let h=1;h<c.length;h++)if(Bc(c[h]))return!0}return c}(l);return s===!0?s:s.map(c=>w0(c))}function yf(l){let s=!1;const c=[];if(l[0]==="case"){for(let h=1;h<l.length-1;h+=2)s=s||Bc(l[h]),c.push(l[h+1]);c.push(l[l.length-1])}else if(l[0]==="match"){s=s||Bc(l[1]);for(let h=2;h<l.length-1;h+=2)c.push(l[h+1]);c.push(l[l.length-1])}else if(l[0]==="step"){s=s||Bc(l[1]);for(let h=1;h<l.length-1;h+=2)c.push(l[h+1])}s&&(l.length=0,l.push("any",...c));for(let h=1;h<l.length;h++)yf(l[h])}function Bc(l){if(!Array.isArray(l))return!1;if((s=l[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let c=1;c<l.length;c++)if(Bc(l[c]))return!0;return!1}const og=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function zw(l,s){return l<s?-1:l>s?1:0}function S0(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(let s=1;s<l.length;s++)if(S0(l[s]))return!0;return!1}function Fc(l){if(!l)return!0;const s=l[0];return l.length<=1?s!=="any":s==="=="?sg(l[1],l[2],"=="):s==="!="?vf(sg(l[1],l[2],"==")):s==="<"||s===">"||s==="<="||s===">="?sg(l[1],l[2],s):s==="any"?(c=l.slice(1),["any"].concat(c.map(Fc))):s==="all"?["all"].concat(l.slice(1).map(Fc)):s==="none"?["all"].concat(l.slice(1).map(Fc).map(vf)):s==="in"?ag(l[1],l.slice(2)):s==="!in"?vf(ag(l[1],l.slice(2))):s==="has"?lg(l[1]):s==="!has"?vf(lg(l[1])):s!=="within"||l;var c}function sg(l,s,c){switch(l){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,l,s]}}function ag(l,s){if(s.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",l,["literal",s.sort(zw)]]:["filter-in-small",l,["literal",s]]}}function lg(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function vf(l){return["!",l]}function Td(l){return rg(Dr(l.value))?Rr(va({},l,{expressionContext:"filter",valueSpec:l.styleSpec[`filter_${l.layerType||"fill"}`]})):Cd(l)}function Cd(l){const s=l.value,c=l.key;if(Un(s)!=="array")return[new Ht(c,s,`array expected, ${Un(s)} found`)];const h=l.styleSpec;let m,v=[];if(s.length<1)return[new Ht(c,s,"filter array must have at least 1 element")];switch(v=v.concat(mf({key:`${c}[0]`,value:s[0],valueSpec:h.filter_operator,style:l.style,styleSpec:l.styleSpec})),ar(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&ar(s[1])==="$type"&&v.push(new Ht(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&v.push(new Ht(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=Un(s[1]),m!=="string"&&v.push(new Ht(`${c}[1]`,s[1],`string expected, ${m} found`)));for(let x=2;x<s.length;x++)m=Un(s[x]),ar(s[1])==="$type"?v=v.concat(mf({key:`${c}[${x}]`,value:s[x],valueSpec:h.geometry_type,style:l.style,styleSpec:l.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&v.push(new Ht(`${c}[${x}]`,s[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<s.length;x++)v=v.concat(Cd({key:`${c}[${x}]`,value:s[x],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":m=Un(s[1]),s.length!==2?v.push(new Ht(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):m!=="string"&&v.push(new Ht(`${c}[1]`,s[1],`string expected, ${m} found`));break;case"within":m=Un(s[1]),s.length!==2?v.push(new Ht(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):m!=="object"&&v.push(new Ht(`${c}[1]`,s[1],`object expected, ${m} found`))}return v}function cg(l,s){const c=l.key,h=l.style,m=l.styleSpec,v=l.value,x=l.objectKey,E=m[`${s}_${l.layerType}`];if(!E)return[];const C=x.match(/^(.*)-transition$/);if(s==="paint"&&C&&E[C[1]]&&E[C[1]].transition)return Jr({key:c,value:v,valueSpec:m.transition,style:h,styleSpec:m});const I=l.valueSpec||E[x];if(!I)return[new Ht(c,v,`unknown property "${x}"`)];let O;if(Un(v)==="string"&&Dc(I)&&!I.tokens&&(O=/^{([^}]+)}$/.exec(v))){const B=`\`{ "type": "identity", "property": ${O?JSON.stringify(O[1]):'"_"'} }\``;return[new Ht(c,v,`"${x}" does not support interpolation syntax
Use an identity property function instead: ${B}.`)]}const L=[];return l.layerType==="symbol"&&(x==="text-field"&&h&&!h.glyphs&&L.push(new Ht(c,v,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&_d(Dr(v))&&ar(v.type)==="identity"&&L.push(new Ht(c,v,'"text-font" does not support identity functions'))),L.concat(Jr({key:l.key,value:v,valueSpec:I,style:h,styleSpec:m,expressionContext:"property",propertyType:s,propertyKey:x}))}function E0(l){return cg(l,"paint")}function ug(l){return cg(l,"layout")}function k0(l){let s=[];const c=l.value,h=l.key,m=l.style,v=l.styleSpec;c.type||c.ref||s.push(new Ht(h,c,'either "type" or "ref" is required'));let x=ar(c.type);const E=ar(c.ref);if(c.id){const C=ar(c.id);for(let I=0;I<l.arrayIndex;I++){const O=m.layers[I];ar(O.id)===C&&s.push(new Ht(h,c.id,`duplicate layer id "${c.id}", previously used at line ${O.id.__line__}`))}}if("ref"in c){let C;["type","source","source-layer","filter","layout"].forEach(I=>{I in c&&s.push(new Ht(h,c[I],`"${I}" is prohibited for ref layers`))}),m.layers.forEach(I=>{ar(I.id)===E&&(C=I)}),C?C.ref?s.push(new Ht(h,c.ref,"ref cannot reference another ref layer")):x=ar(C.type):typeof E=="string"&&s.push(new Ht(h,c.ref,`ref layer "${E}" not found`))}else if(x!=="background"&&x!=="sky")if(c.source){const C=m.sources&&m.sources[c.source],I=C&&ar(C.type);C?I==="vector"&&x==="raster"?s.push(new Ht(h,c.source,`layer "${c.id}" requires a raster source`)):I==="raster"&&x!=="raster"?s.push(new Ht(h,c.source,`layer "${c.id}" requires a vector source`)):I!=="vector"||c["source-layer"]?I==="raster-dem"&&x!=="hillshade"?s.push(new Ht(h,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||I==="geojson"&&C.lineMetrics||s.push(new Ht(h,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Ht(h,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new Ht(h,c.source,`source "${c.source}" not found`))}else s.push(new Ht(h,c,'missing required property "source"'));return s=s.concat(Ts({key:h,value:c,valueSpec:v.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Jr({key:`${h}.type`,value:c.type,valueSpec:v.layer.type,style:l.style,styleSpec:l.styleSpec,object:c,objectKey:"type"}),filter:C=>Td(va({layerType:x},C)),layout:C=>Ts({layer:c,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":I=>ug(va({layerType:x},I))}}),paint:C=>Ts({layer:c,key:C.key,value:C.value,valueSpec:{},style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":I=>E0(va({layerType:x},I))}})}})),s}function sl(l){const s=l.value,c=l.key,h=Un(s);return h!=="string"?[new Ht(c,s,`string expected, ${h} found`)]:[]}const T0={promoteId:function({key:l,value:s}){if(Un(s)==="string")return sl({key:l,value:s});{const c=[];for(const h in s)c.push(...sl({key:`${l}.${h}`,value:s[h]}));return c}}};function C0(l){const s=l.value,c=l.key,h=l.styleSpec,m=l.style;if(!s.type)return[new Ht(c,s,'"type" is required')];const v=ar(s.type);let x;switch(v){case"vector":case"raster":case"raster-dem":return x=Ts({key:c,value:s,valueSpec:h[`source_${v.replace("-","_")}`],style:l.style,styleSpec:h,objectElementValidators:T0}),x;case"geojson":if(x=Ts({key:c,value:s,valueSpec:h.source_geojson,style:m,styleSpec:h,objectElementValidators:T0}),s.cluster)for(const E in s.clusterProperties){const[C,I]=s.clusterProperties[E],O=typeof C=="string"?[C,["accumulated"],["get",E]]:C;x.push(...Rr({key:`${c}.${E}.map`,value:I,expressionContext:"cluster-map"})),x.push(...Rr({key:`${c}.${E}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return x;case"video":return Ts({key:c,value:s,valueSpec:h.source_video,style:m,styleSpec:h});case"image":return Ts({key:c,value:s,valueSpec:h.source_image,style:m,styleSpec:h});case"canvas":return[new Ht(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return mf({key:`${c}.type`,value:s.type,valueSpec:{values:Bw(h)},style:m,styleSpec:h})}}function Bw(l){return l.source.reduce((s,c)=>{const h=l[c];return h.type.type==="enum"&&(s=s.concat(Object.keys(h.type.values))),s},[])}function I0(l){const s=l.value,c=l.styleSpec,h=c.light,m=l.style;let v=[];const x=Un(s);if(s===void 0)return v;if(x!=="object")return v=v.concat([new Ht("light",s,`object expected, ${x} found`)]),v;for(const E in s){const C=E.match(/^(.*)-transition$/);v=v.concat(C&&h[C[1]]&&h[C[1]].transition?Jr({key:E,value:s[E],valueSpec:c.transition,style:m,styleSpec:c}):h[E]?Jr({key:E,value:s[E],valueSpec:h[E],style:m,styleSpec:c}):[new Ht(E,s[E],`unknown property "${E}"`)])}return v}function dg(l){const s=l.value,c=l.key,h=l.style,m=l.styleSpec,v=m.terrain;let x=[];const E=Un(s);if(s===void 0)return x;if(E!=="object")return x=x.concat([new Ht("terrain",s,`object expected, ${E} found`)]),x;for(const C in s){const I=C.match(/^(.*)-transition$/);x=x.concat(I&&v[I[1]]&&v[I[1]].transition?Jr({key:C,value:s[C],valueSpec:m.transition,style:h,styleSpec:m}):v[C]?Jr({key:C,value:s[C],valueSpec:v[C],style:h,styleSpec:m}):[new Ht(C,s[C],`unknown property "${C}"`)])}if(s.source){const C=h.sources&&h.sources[s.source],I=C&&ar(C.type);C?I!=="raster-dem"&&x.push(new Ht(c,s.source,`terrain cannot be used with a source of type ${String(I)}, it only be used with a "raster-dem" source type`)):x.push(new Ht(c,s.source,`source "${s.source}" not found`))}else x.push(new Ht(c,s,'terrain is missing required property "source"'));return x}function A0(l){const s=l.value,c=l.style,h=l.styleSpec,m=h.fog;let v=[];const x=Un(s);if(s===void 0)return v;if(x!=="object")return v=v.concat([new Ht("fog",s,`object expected, ${x} found`)]),v;for(const E in s){const C=E.match(/^(.*)-transition$/);v=v.concat(C&&m[C[1]]&&m[C[1]].transition?Jr({key:E,value:s[E],valueSpec:h.transition,style:c,styleSpec:h}):m[E]?Jr({key:E,value:s[E],valueSpec:m[E],style:c,styleSpec:h}):[new Ht(E,s[E],`unknown property "${E}"`)])}return v}const M0={"*":()=>[],array:x0,boolean:function(l){const s=l.value,c=l.key,h=Un(s);return h!=="boolean"?[new Ht(c,s,`boolean expected, ${h} found`)]:[]},number:Sd,color:function(l){const s=l.key,c=l.value,h=Un(c);return h!=="string"?[new Ht(s,c,`color expected, ${h} found`)]:Am(c)===null?[new Ht(s,c,`color expected, "${c}" found`)]:[]},enum:mf,filter:Td,function:Ed,layer:k0,object:Ts,source:C0,light:I0,terrain:dg,fog:A0,string:sl,formatted:function(l){return sl(l).length===0?[]:Rr(l)},resolvedImage:function(l){return sl(l).length===0?[]:Rr(l)},projection:function(l){const s=l.value,c=l.styleSpec,h=c.projection,m=l.style;let v=[];const x=Un(s);if(x==="object")for(const E in s)v=v.concat(Jr({key:E,value:s[E],valueSpec:h[E],style:m,styleSpec:c}));else x!=="string"&&(v=v.concat([new Ht("projection",s,`object or string expected, ${x} found`)]));return v}};function Jr(l){const s=l.value,c=l.valueSpec,h=l.styleSpec;return c.expression&&_d(ar(s))?Ed(l):c.expression&&Lc(Dr(s))?Rr(l):c.type&&M0[c.type]?M0[c.type](l):Ts(va({},l,{valueSpec:c.type?h[c.type]:c}))}function Fw(l){const s=l.value,c=l.key,h=sl(l);return h.length||(s.indexOf("{fontstack}")===-1&&h.push(new Ht(c,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&h.push(new Ht(c,s,'"glyphs" url must include a "{range}" token'))),h}function P0(l,s=st){return as(Jr({key:"",value:l,valueSpec:s.$root,styleSpec:s,style:l,objectElementValidators:{glyphs:Fw,"*":()=>[]}}))}const Nw=l=>as(E0(l)),$w=l=>as(ug(l));function as(l){return l.slice().sort((s,c)=>s.line&&c.line?s.line-c.line:0)}function O0(l,s){let c=!1;if(s&&s.length)for(const h of s)l.fire(new Ji(new Error(h.message))),c=!0;return c}var jw=Ys,Cs=3;function Ys(l,s,c){var h=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var m=new Int32Array(this.arrayBuffer);l=m[0],this.d=(s=m[1])+2*(c=m[2]);for(var v=0;v<this.d*this.d;v++){var x=m[Cs+v],E=m[Cs+v+1];h.push(x===E?null:m.subarray(x,E))}var C=m[Cs+h.length+1];this.keys=m.subarray(m[Cs+h.length],C),this.bboxes=m.subarray(C),this.insert=this._insertReadonly}else{this.d=s+2*c;for(var I=0;I<this.d*this.d;I++)h.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=l,this.padding=c,this.scale=s/l,this.uid=0;var O=c/s*l;this.min=-O,this.max=l+O}Ys.prototype.insert=function(l,s,c,h,m){this._forEachCell(s,c,h,m,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(m)},Ys.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ys.prototype._insertCell=function(l,s,c,h,m,v){this.cells[m].push(v)},Ys.prototype.query=function(l,s,c,h,m){var v=this.min,x=this.max;if(l<=v&&s<=v&&x<=c&&x<=h&&!m)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(l,s,c,h,this._queryCell,E,{},m),E},Ys.prototype._queryCell=function(l,s,c,h,m,v,x,E){var C=this.cells[m];if(C!==null)for(var I=this.keys,O=this.bboxes,L=0;L<C.length;L++){var B=C[L];if(x[B]===void 0){var j=4*B;(E?E(O[j+0],O[j+1],O[j+2],O[j+3]):l<=O[j+2]&&s<=O[j+3]&&c>=O[j+0]&&h>=O[j+1])?(x[B]=!0,v.push(I[B])):x[B]=!1}}},Ys.prototype._forEachCell=function(l,s,c,h,m,v,x,E){for(var C=this._convertToCellCoord(l),I=this._convertToCellCoord(s),O=this._convertToCellCoord(c),L=this._convertToCellCoord(h),B=C;B<=O;B++)for(var j=I;j<=L;j++){var U=this.d*j+B;if((!E||E(this._convertFromCellCoord(B),this._convertFromCellCoord(j),this._convertFromCellCoord(B+1),this._convertFromCellCoord(j+1)))&&m.call(this,l,s,c,h,U,v,x,E))return}},Ys.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},Ys.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},Ys.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,s=Cs+this.cells.length+1+1,c=0,h=0;h<this.cells.length;h++)c+=this.cells[h].length;var m=new Int32Array(s+c+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var v=s,x=0;x<l.length;x++){var E=l[x];m[Cs+x]=v,m.set(E,v),v+=E.length}return m[Cs+l.length]=v,m.set(this.keys,v),m[Cs+l.length+1]=v+=this.keys.length,m.set(this.bboxes,v),v+=this.bboxes.length,m.buffer};var Ul=q(jw);const bf={};function Kt(l,s,c={}){Object.defineProperty(l,"_classRegistryKey",{value:s,writeable:!1}),bf[s]={klass:l,omit:c.omit||[]}}Kt(Object,"Object"),Ul.serialize=function(l,s){const c=l.toArrayBuffer();return s&&s.push(c),{buffer:c}},Ul.deserialize=function(l){return new Ul(l.buffer)},Object.defineProperty(Ul,"name",{value:"Grid"}),Kt(Ul,"Grid"),Kt(Qi,"Color"),Kt(Error,"Error"),Kt(yt,"AJAXError"),Kt(rs,"ResolvedImage"),Kt(ff,"StylePropertyFunction"),Kt(hf,"StyleExpression",{omit:["_evaluator"]}),Kt(xd,"ZoomDependentExpression"),Kt(ig,"ZoomConstantExpression"),Kt(xa,"CompoundExpression",{omit:["_evaluate"]});for(const l in bd)bf[bd[l]._classRegistryKey]||Kt(bd[l],`Expression${l}`);function hg(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function fg(l){return f.ImageBitmap&&l instanceof f.ImageBitmap}function Nc(l,s){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(hg(l)||fg(l))return s&&s.push(l),l;if(ArrayBuffer.isView(l)){const c=l;return s&&s.push(c.buffer),c}if(l instanceof f.ImageData)return s&&s.push(l.data.buffer),l;if(Array.isArray(l)){const c=[];for(const h of l)c.push(Nc(h,s));return c}if(typeof l=="object"){const c=l.constructor,h=c._classRegistryKey;if(!h)throw new Error(`can't serialize object of unregistered class ${h}`);const m=c.serialize?c.serialize(l,s):{};if(!c.serialize){for(const v in l)l.hasOwnProperty(v)&&(bf[h].omit.indexOf(v)>=0||(m[v]=Nc(l[v],s)));l instanceof Error&&(m.message=l.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(m.$name=h),m}throw new Error("can't serialize object of type "+typeof l)}function ql(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||hg(l)||fg(l)||ArrayBuffer.isView(l)||l instanceof f.ImageData)return l;if(Array.isArray(l))return l.map(ql);if(typeof l=="object"){const s=l.$name||"Object",{klass:c}=bf[s];if(!c)throw new Error(`can't deserialize unregistered class ${s}`);if(c.deserialize)return c.deserialize(l);const h=Object.create(c.prototype);for(const m of Object.keys(l))m!=="$name"&&(h[m]=ql(l[m]));return h}throw new Error("can't deserialize object of type "+typeof l)}const Wt={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function pg(l){for(const s of l)if(mg(s.charCodeAt(0)))return!0;return!1}function Vw(l){for(const s of l)if(!D0(s.charCodeAt(0)))return!1;return!0}function D0(l){return!(Wt.Arabic(l)||Wt["Arabic Supplement"](l)||Wt["Arabic Extended-A"](l)||Wt["Arabic Presentation Forms-A"](l)||Wt["Arabic Presentation Forms-B"](l))}function mg(l){return!(l!==746&&l!==747&&(l<4352||!(Wt["Bopomofo Extended"](l)||Wt.Bopomofo(l)||Wt["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||Wt["CJK Compatibility Ideographs"](l)||Wt["CJK Compatibility"](l)||Wt["CJK Radicals Supplement"](l)||Wt["CJK Strokes"](l)||!(!Wt["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||Wt["CJK Unified Ideographs Extension A"](l)||Wt["CJK Unified Ideographs"](l)||Wt["Enclosed CJK Letters and Months"](l)||Wt["Hangul Compatibility Jamo"](l)||Wt["Hangul Jamo Extended-A"](l)||Wt["Hangul Jamo Extended-B"](l)||Wt["Hangul Jamo"](l)||Wt["Hangul Syllables"](l)||Wt.Hiragana(l)||Wt["Ideographic Description Characters"](l)||Wt.Kanbun(l)||Wt["Kangxi Radicals"](l)||Wt["Katakana Phonetic Extensions"](l)||Wt.Katakana(l)&&l!==12540||!(!Wt["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!Wt["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||Wt["Unified Canadian Aboriginal Syllabics"](l)||Wt["Unified Canadian Aboriginal Syllabics Extended"](l)||Wt["Vertical Forms"](l)||Wt["Yijing Hexagram Symbols"](l)||Wt["Yi Syllables"](l)||Wt["Yi Radicals"](l))))}function R0(l){return!(mg(l)||function(s){return!!(Wt["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Wt["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Wt["Letterlike Symbols"](s)||Wt["Number Forms"](s)||Wt["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Wt["Control Pictures"](s)&&s!==9251||Wt["Optical Character Recognition"](s)||Wt["Enclosed Alphanumerics"](s)||Wt["Geometric Shapes"](s)||Wt["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Wt["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Wt["CJK Symbols and Punctuation"](s)||Wt.Katakana(s)||Wt["Private Use Area"](s)||Wt["CJK Compatibility Forms"](s)||Wt["Small Form Variants"](s)||Wt["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(l))}function L0(l){return l>=1424&&l<=2303||Wt["Arabic Presentation Forms-A"](l)||Wt["Arabic Presentation Forms-B"](l)}function Uw(l,s){return!(!s&&L0(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||Wt.Khmer(l))}function qw(l){for(const s of l)if(L0(s.charCodeAt(0)))return!0;return!1}const gg="deferred",yg="loading",vg="loaded";let $c=null,y="unavailable",u=null;const p=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(y="error"),$c&&$c(l)};function b(){S.fire(new Li("pluginStateChange",{pluginStatus:y,pluginURL:u}))}const S=new Vo,k=function(){return y},M=function(){if(y!==gg||!u)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");y=yg,b(),u&&fo({url:u},l=>{l?p(l):(y=vg,b())})},P={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>y===vg||P.applyArabicShaping!=null,isLoading:()=>y===yg,setState(l){y=l.pluginStatus,u=l.pluginURL},isParsed:()=>P.applyArabicShaping!=null&&P.processBidirectionalText!=null&&P.processStyledBidirectionalText!=null,getPluginURL:()=>u};class R{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(c,h){for(const m of c)if(!Uw(m.charCodeAt(0),h))return!1;return!0}(s,P.isLoaded())}}class ${constructor(s,c){this.property=s,this.value=c,this.expression=function(h,m){if(_d(h))return new ff(h,m);if(Lc(h)){const v=wd(h,m);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=h;return typeof h=="string"&&m.type==="color"&&(v=Qi.parse(h)),{kind:"constant",evaluate:()=>v}}}(c===void 0?s.specification.default:c,s.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,c,h){return this.property.possiblyEvaluate(this,s,c,h)}}class F{constructor(s){this.property=s,this.value=new $(s,void 0)}transitioned(s,c){return new ne(this.property,this.value,c,Nt({},s.transition,this.transition),s.now)}untransitioned(){return new ne(this.property,this.value,null,{},0)}}class H{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return fi(this._values[s].value.value)}setValue(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new F(this._values[s].property)),this._values[s].value=new $(this._values[s].property,c===null?void 0:fi(c))}getTransition(s){return fi(this._values[s].transition)}setTransition(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new F(this._values[s].property)),this._values[s].transition=fi(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const h=this.getValue(c);h!==void 0&&(s[c]=h);const m=this.getTransition(c);m!==void 0&&(s[`${c}-transition`]=m)}return s}transitioned(s,c){const h=new ae(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(s,c._values[m]);return h}untransitioned(){const s=new ae(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class ne{constructor(s,c,h,m,v){const x=m.delay||0,E=m.duration||0;v=v||0,this.property=s,this.value=c,this.begin=v+x,this.end=this.begin+E,s.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(s,c,h){const m=s.now||0,v=this.value.possiblyEvaluate(s,c,h),x=this.prior;if(x){if(m>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(m<this.begin)return x.possiblyEvaluate(s,c,h);{const E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(s,c,h),v,xt(E))}}return v}}class ae{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,h){const m=new de(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(s,c,h);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class ue{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return fi(this._values[s].value)}setValue(s,c){this._values[s]=new $(this._values[s].property,c===null?void 0:fi(c))}serialize(){const s={};for(const c of Object.keys(this._values)){const h=this.getValue(c);h!==void 0&&(s[c]=h)}return s}possiblyEvaluate(s,c,h){const m=new de(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].possiblyEvaluate(s,c,h);return m}}class le{constructor(s,c,h){this.property=s,this.value=c,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,c,h,m){return this.property.evaluate(this.value,this.parameters,s,c,h,m)}}class de{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Z{constructor(s){this.specification=s}possiblyEvaluate(s,c){return s.expression.evaluate(c)}interpolate(s,c,h){const m=pd[this.specification.type];return m?m(s,c,h):s}}class oe{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,h,m){return new le(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(c,null,{},h,m)}:s.expression,c)}interpolate(s,c,h){if(s.value.kind!=="constant"||c.value.kind!=="constant")return s;if(s.value.value===void 0||c.value.value===void 0)return new le(this,{kind:"constant",value:void 0},s.parameters);const m=pd[this.specification.type];return m?new le(this,{kind:"constant",value:m(s.value.value,c.value.value,h)},s.parameters):s}evaluate(s,c,h,m,v,x){return s.kind==="constant"?s.value:s.evaluate(c,h,m,v,x)}}class ge{constructor(s){this.specification=s}possiblyEvaluate(s,c,h,m){return!!s.expression.evaluate(c,null,{},h,m)}interpolate(){return!1}}class ye{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new R(0,{});for(const h in s){const m=s[h];m.specification.overridable&&this.overridableProperties.push(h);const v=this.defaultPropertyValues[h]=new $(m,void 0),x=this.defaultTransitionablePropertyValues[h]=new F(m);this.defaultTransitioningPropertyValues[h]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=v.possiblyEvaluate(c)}}}function Te(l,s){return 256*(l=ze(Math.floor(l),0,255))+ze(Math.floor(s),0,255)}Kt(oe,"DataDrivenProperty"),Kt(Z,"DataConstantProperty"),Kt(ge,"ColorRampProperty");const Ie={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ce{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Le{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Re(l,s=1){let c=0,h=0;return{members:l.map(m=>{const v=Ie[m.type].BYTES_PER_ELEMENT,x=c=Ge(c,Math.max(s,v)),E=m.components||1;return h=Math.max(h,v),c+=v*E,{name:m.name,type:m.type,components:E,offset:x}}),size:Ge(c,Math.max(h,s)),alignment:s}}function Ge(l,s){return Math.ceil(l/s)*s}class St extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const h=this.length;return this.resize(h+1),this.emplace(h,s,c)}emplace(s,c,h){const m=2*s;return this.int16[m+0]=c,this.int16[m+1]=h,s}}St.prototype.bytesPerElement=4,Kt(St,"StructArrayLayout2i4");class Ve extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,h)}emplace(s,c,h,m){const v=3*s;return this.int16[v+0]=c,this.int16[v+1]=h,this.int16[v+2]=m,s}}Ve.prototype.bytesPerElement=6,Kt(Ve,"StructArrayLayout3i6");class ut extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,h,m)}emplace(s,c,h,m,v){const x=4*s;return this.int16[x+0]=c,this.int16[x+1]=h,this.int16[x+2]=m,this.int16[x+3]=v,s}}ut.prototype.bytesPerElement=8,Kt(ut,"StructArrayLayout4i8");class Ye extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x,E){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,h,m,v,x,E)}emplace(s,c,h,m,v,x,E,C){const I=6*s,O=12*s,L=3*s;return this.int16[I+0]=c,this.int16[I+1]=h,this.uint8[O+4]=m,this.uint8[O+5]=v,this.uint8[O+6]=x,this.uint8[O+7]=E,this.float32[L+2]=C,s}}Ye.prototype.bytesPerElement=12,Kt(Ye,"StructArrayLayout2i4ub1f12");class bt extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,h,m)}emplace(s,c,h,m,v){const x=4*s;return this.float32[x+0]=c,this.float32[x+1]=h,this.float32[x+2]=m,this.float32[x+3]=v,s}}bt.prototype.bytesPerElement=16,Kt(bt,"StructArrayLayout4f16");class qe extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,h,m,v)}emplace(s,c,h,m,v,x){const E=6*s,C=3*s;return this.uint16[E+0]=c,this.uint16[E+1]=h,this.uint16[E+2]=m,this.uint16[E+3]=v,this.float32[C+2]=x,s}}qe.prototype.bytesPerElement=12,Kt(qe,"StructArrayLayout4ui1f12");class ct extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,h,m)}emplace(s,c,h,m,v){const x=4*s;return this.uint16[x+0]=c,this.uint16[x+1]=h,this.uint16[x+2]=m,this.uint16[x+3]=v,s}}ct.prototype.bytesPerElement=8,Kt(ct,"StructArrayLayout4ui8");class Tt extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,h,m,v,x)}emplace(s,c,h,m,v,x,E){const C=6*s;return this.int16[C+0]=c,this.int16[C+1]=h,this.int16[C+2]=m,this.int16[C+3]=v,this.int16[C+4]=x,this.int16[C+5]=E,s}}Tt.prototype.bytesPerElement=12,Kt(Tt,"StructArrayLayout6i12");class pt extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x,E,C,I,O,L,B){const j=this.length;return this.resize(j+1),this.emplace(j,s,c,h,m,v,x,E,C,I,O,L,B)}emplace(s,c,h,m,v,x,E,C,I,O,L,B,j){const U=12*s;return this.int16[U+0]=c,this.int16[U+1]=h,this.int16[U+2]=m,this.int16[U+3]=v,this.uint16[U+4]=x,this.uint16[U+5]=E,this.uint16[U+6]=C,this.uint16[U+7]=I,this.int16[U+8]=O,this.int16[U+9]=L,this.int16[U+10]=B,this.int16[U+11]=j,s}}pt.prototype.bytesPerElement=24,Kt(pt,"StructArrayLayout4i4ui4i24");class It extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,h,m,v,x)}emplace(s,c,h,m,v,x,E){const C=10*s,I=5*s;return this.int16[C+0]=c,this.int16[C+1]=h,this.int16[C+2]=m,this.float32[I+2]=v,this.float32[I+3]=x,this.float32[I+4]=E,s}}It.prototype.bytesPerElement=20,Kt(It,"StructArrayLayout3i3f20");class rn extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}rn.prototype.bytesPerElement=4,Kt(rn,"StructArrayLayout1ul4");class vn extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x,E,C,I,O,L,B,j){const U=this.length;return this.resize(U+1),this.emplace(U,s,c,h,m,v,x,E,C,I,O,L,B,j)}emplace(s,c,h,m,v,x,E,C,I,O,L,B,j,U){const X=20*s,re=10*s;return this.int16[X+0]=c,this.int16[X+1]=h,this.int16[X+2]=m,this.int16[X+3]=v,this.int16[X+4]=x,this.float32[re+3]=E,this.float32[re+4]=C,this.float32[re+5]=I,this.float32[re+6]=O,this.int16[X+14]=L,this.uint32[re+8]=B,this.uint16[X+18]=j,this.uint16[X+19]=U,s}}vn.prototype.bytesPerElement=40,Kt(vn,"StructArrayLayout5i4f1i1ul2ui40");class Yt extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x,E){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,h,m,v,x,E)}emplace(s,c,h,m,v,x,E,C){const I=8*s;return this.int16[I+0]=c,this.int16[I+1]=h,this.int16[I+2]=m,this.int16[I+4]=v,this.int16[I+5]=x,this.int16[I+6]=E,this.int16[I+7]=C,s}}Yt.prototype.bytesPerElement=16,Kt(Yt,"StructArrayLayout3i2i2i16");class un extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,h,m,v)}emplace(s,c,h,m,v,x){const E=4*s,C=8*s;return this.float32[E+0]=c,this.float32[E+1]=h,this.float32[E+2]=m,this.int16[C+6]=v,this.int16[C+7]=x,s}}un.prototype.bytesPerElement=16,Kt(un,"StructArrayLayout2f1f2i16");class Dn extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,h,m)}emplace(s,c,h,m,v){const x=12*s,E=3*s;return this.uint8[x+0]=c,this.uint8[x+1]=h,this.float32[E+1]=m,this.float32[E+2]=v,s}}Dn.prototype.bytesPerElement=12,Kt(Dn,"StructArrayLayout2ub2f12");class Mn extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,h)}emplace(s,c,h,m){const v=3*s;return this.float32[v+0]=c,this.float32[v+1]=h,this.float32[v+2]=m,s}}Mn.prototype.bytesPerElement=12,Kt(Mn,"StructArrayLayout3f12");class tn extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,h)}emplace(s,c,h,m){const v=3*s;return this.uint16[v+0]=c,this.uint16[v+1]=h,this.uint16[v+2]=m,s}}tn.prototype.bytesPerElement=6,Kt(tn,"StructArrayLayout3ui6");class Qn extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x,E,C,I,O,L,B,j,U,X,re,he,xe,fe,be,Se){const we=this.length;return this.resize(we+1),this.emplace(we,s,c,h,m,v,x,E,C,I,O,L,B,j,U,X,re,he,xe,fe,be,Se)}emplace(s,c,h,m,v,x,E,C,I,O,L,B,j,U,X,re,he,xe,fe,be,Se,we){const He=30*s,Ue=15*s,at=60*s;return this.int16[He+0]=c,this.int16[He+1]=h,this.int16[He+2]=m,this.float32[Ue+2]=v,this.float32[Ue+3]=x,this.uint16[He+8]=E,this.uint16[He+9]=C,this.uint32[Ue+5]=I,this.uint32[Ue+6]=O,this.uint32[Ue+7]=L,this.uint16[He+16]=B,this.uint16[He+17]=j,this.uint16[He+18]=U,this.float32[Ue+10]=X,this.float32[Ue+11]=re,this.uint8[at+48]=he,this.uint8[at+49]=xe,this.uint8[at+50]=fe,this.uint32[Ue+13]=be,this.int16[He+28]=Se,this.uint8[at+58]=we,s}}Qn.prototype.bytesPerElement=60,Kt(Qn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class oi extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v,x,E,C,I,O,L,B,j,U,X,re,he,xe,fe,be,Se,we,He,Ue,at,Et,Je,dt,ht,vt){const Pt=this.length;return this.resize(Pt+1),this.emplace(Pt,s,c,h,m,v,x,E,C,I,O,L,B,j,U,X,re,he,xe,fe,be,Se,we,He,Ue,at,Et,Je,dt,ht,vt)}emplace(s,c,h,m,v,x,E,C,I,O,L,B,j,U,X,re,he,xe,fe,be,Se,we,He,Ue,at,Et,Je,dt,ht,vt,Pt){const it=38*s,Vt=19*s;return this.int16[it+0]=c,this.int16[it+1]=h,this.int16[it+2]=m,this.float32[Vt+2]=v,this.float32[Vt+3]=x,this.int16[it+8]=E,this.int16[it+9]=C,this.int16[it+10]=I,this.int16[it+11]=O,this.int16[it+12]=L,this.int16[it+13]=B,this.uint16[it+14]=j,this.uint16[it+15]=U,this.uint16[it+16]=X,this.uint16[it+17]=re,this.uint16[it+18]=he,this.uint16[it+19]=xe,this.uint16[it+20]=fe,this.uint16[it+21]=be,this.uint16[it+22]=Se,this.uint16[it+23]=we,this.uint16[it+24]=He,this.uint16[it+25]=Ue,this.uint16[it+26]=at,this.uint16[it+27]=Et,this.uint16[it+28]=Je,this.uint32[Vt+15]=dt,this.float32[Vt+16]=ht,this.float32[Vt+17]=vt,this.float32[Vt+18]=Pt,s}}oi.prototype.bytesPerElement=76,Kt(oi,"StructArrayLayout3i2f6i15ui1ul3f76");class si extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}si.prototype.bytesPerElement=4,Kt(si,"StructArrayLayout1f4");class ai extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,h,m,v){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,h,m,v)}emplace(s,c,h,m,v,x){const E=5*s;return this.float32[E+0]=c,this.float32[E+1]=h,this.float32[E+2]=m,this.float32[E+3]=v,this.float32[E+4]=x,s}}ai.prototype.bytesPerElement=20,Kt(ai,"StructArrayLayout5f20");class Qr extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,h,m){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,h,m)}emplace(s,c,h,m,v){const x=6*s;return this.uint32[3*s+0]=c,this.uint16[x+2]=h,this.uint16[x+3]=m,this.uint16[x+4]=v,s}}Qr.prototype.bytesPerElement=12,Kt(Qr,"StructArrayLayout1ul3ui12");class Lr extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const h=this.length;return this.resize(h+1),this.emplace(h,s,c)}emplace(s,c,h){const m=2*s;return this.uint16[m+0]=c,this.uint16[m+1]=h,s}}Lr.prototype.bytesPerElement=4,Kt(Lr,"StructArrayLayout2ui4");class ls extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}ls.prototype.bytesPerElement=2,Kt(ls,"StructArrayLayout1ui2");class Js extends Le{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const h=this.length;return this.resize(h+1),this.emplace(h,s,c)}emplace(s,c,h){const m=2*s;return this.float32[m+0]=c,this.float32[m+1]=h,s}}Js.prototype.bytesPerElement=8,Kt(Js,"StructArrayLayout2f8");class Ai extends Ce{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ai.prototype.size=40;class li extends vn{get(s){return new Ai(this,s)}}Kt(li,"CollisionBoxArray");class Gn extends Ce{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}Gn.prototype.size=60;class lr extends Qn{get(s){return new Gn(this,s)}}Kt(lr,"PlacedSymbolArray");class po extends Ce{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}po.prototype.size=76;class Si extends oi{get(s){return new po(this,s)}}Kt(Si,"SymbolInstanceArray");class ko extends si{getoffsetX(s){return this.float32[1*s+0]}}Kt(ko,"GlyphOffsetArray");class _f extends St{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Kt(_f,"SymbolLineVertexArray");class Wl extends Ce{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Wl.prototype.size=12;class Id extends Qr{get(s){return new Wl(this,s)}}Kt(Id,"FeatureIndexArray");class Ta extends Lr{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Kt(Ta,"FillExtrusionCentroidArray");const al=Re([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Gl=Re([{name:"a_dash",components:4,type:"Uint16"}]);var xf={exports:{}},Ad={exports:{}};Ad.exports=function(l,s){var c,h,m,v,x,E,C,I;for(h=l.length-(c=3&l.length),m=s,x=3432918353,E=461845907,I=0;I<h;)C=255&l.charCodeAt(I)|(255&l.charCodeAt(++I))<<8|(255&l.charCodeAt(++I))<<16|(255&l.charCodeAt(++I))<<24,++I,m=27492+(65535&(v=5*(65535&(m=(m^=C=(65535&(C=(C=(65535&C)*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*E+(((C>>>16)*E&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(C=0,c){case 3:C^=(255&l.charCodeAt(I+2))<<16;case 2:C^=(255&l.charCodeAt(I+1))<<8;case 1:m^=C=(65535&(C=(C=(65535&(C^=255&l.charCodeAt(I)))*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*E+(((C>>>16)*E&65535)<<16)&4294967295}return m^=l.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var bg=Ad.exports,YA={exports:{}};YA.exports=function(l,s){for(var c,h=l.length,m=s^h,v=0;h>=4;)c=1540483477*(65535&(c=255&l.charCodeAt(v)|(255&l.charCodeAt(++v))<<8|(255&l.charCodeAt(++v))<<16|(255&l.charCodeAt(++v))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),h-=4,++v;switch(h){case 3:m^=(255&l.charCodeAt(v+2))<<16;case 2:m^=(255&l.charCodeAt(v+1))<<8;case 1:m=1540483477*(65535&(m^=255&l.charCodeAt(v)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var JA=bg,gV=YA.exports;xf.exports=JA,xf.exports.murmur3=JA,xf.exports.murmur2=gV;var Ww=q(xf.exports);class z0{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,c,h,m){this.ids.push(QA(s)),this.positions.push(c,h,m)}getPositions(s){const c=QA(s);let h=0,m=this.ids.length-1;for(;h<m;){const x=h+m>>1;this.ids[x]>=c?m=x:h=x+1}const v=[];for(;this.ids[h]===c;)v.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return v}static serialize(s,c){const h=new Float64Array(s.ids),m=new Uint32Array(s.positions);return Gw(h,m,0,h.length-1),c&&c.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(s){const c=new z0;return c.ids=s.ids,c.positions=s.positions,c.indexed=!0,c}}function QA(l){const s=+l;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:Ww(String(l))}function Gw(l,s,c,h){for(;c<h;){const m=l[c+h>>1];let v=c-1,x=h+1;for(;;){do v++;while(l[v]<m);do x--;while(l[x]>m);if(v>=x)break;B0(l,v,x),B0(s,3*v,3*x),B0(s,3*v+1,3*x+1),B0(s,3*v+2,3*x+2)}x-c<h-x?(Gw(l,s,c,x),c=x+1):(Gw(l,s,x+1,h),h=x)}}function B0(l,s,c){const h=l[s];l[s]=l[c],l[c]=h}Kt(z0,"FeaturePositionMap");class Hl{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,c),this.initialized=!0),!!this.location}}class F0 extends Hl{constructor(s){super(s),this.current=0}set(s,c,h){this.fetchUniformLocation(s,c)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class eM extends Hl{constructor(s){super(s),this.current=[0,0,0,0]}set(s,c,h){this.fetchUniformLocation(s,c)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class tM extends Hl{constructor(s){super(s),this.current=Qi.transparent}set(s,c,h){this.fetchUniformLocation(s,c)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const yV=new Float32Array(16),vV=new Float32Array(9),bV=new Float32Array(4);function Hw(l){return[Te(255*l.r,255*l.g),Te(255*l.b,255*l.a)]}class _g{constructor(s,c,h){this.value=s,this.uniformNames=c.map(m=>`u_${m}`),this.type=h}setUniform(s,c,h,m,v){c.set(s,v,m.constantOr(this.value))}getBinding(s,c){return this.type==="color"?new tM(s):new F0(s)}}class wf{constructor(s,c){this.uniformNames=c.map(h=>`u_${h}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,c,h,m,v){const x=v==="u_pattern"||v==="u_dash"?this.pattern:v==="u_pixel_ratio"?this.pixelRatio:null;x&&c.set(s,v,x)}getBinding(s,c){return c==="u_pattern"||c==="u_dash"?new eM(s):new F0(s)}}class Zl{constructor(s,c,h,m){this.expression=s,this.type=h,this.maxValue=0,this.paintVertexAttributes=c.map(v=>({name:`a_${v}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(s,c,h,m,v,x){const E=this.paintVertexArray.length,C=this.expression.evaluate(new R(0),c,{},v,m,x);this.paintVertexArray.resize(s),this._setPaintValue(E,s,C)}updatePaintArray(s,c,h,m,v){const x=this.expression.evaluate({zoom:0},h,m,void 0,v);this._setPaintValue(s,c,x)}_setPaintValue(s,c,h){if(this.type==="color"){const m=Hw(h);for(let v=s;v<c;v++)this.paintVertexArray.emplace(v,m[0],m[1])}else{for(let m=s;m<c;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ca{constructor(s,c,h,m,v,x){this.expression=s,this.uniformNames=c.map(E=>`u_${E}_t`),this.type=h,this.useIntegerZoom=m,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=c.map(E=>({name:`a_${E}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(s,c,h,m,v,x){const E=this.expression.evaluate(new R(this.zoom),c,{},v,m,x),C=this.expression.evaluate(new R(this.zoom+1),c,{},v,m,x),I=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(I,s,E,C)}updatePaintArray(s,c,h,m,v){const x=this.expression.evaluate({zoom:this.zoom},h,m,void 0,v),E=this.expression.evaluate({zoom:this.zoom+1},h,m,void 0,v);this._setPaintValue(s,c,x,E)}_setPaintValue(s,c,h,m){if(this.type==="color"){const v=Hw(h),x=Hw(m);for(let E=s;E<c;E++)this.paintVertexArray.emplace(E,v[0],v[1],x[0],x[1])}else{for(let v=s;v<c;v++)this.paintVertexArray.emplace(v,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c,h,m,v){const x=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,E=ze(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);c.set(s,v,E)}getBinding(s,c){return new F0(s)}}class jc{constructor(s,c,h,m,v){this.expression=s,this.layerId=v,this.paintVertexAttributes=(h==="array"?Gl:al).members;for(let x=0;x<c.length;++x);this.paintVertexArray=new m}populatePaintArray(s,c,h){const m=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(m,s,c.patterns&&c.patterns[this.layerId],h)}updatePaintArray(s,c,h,m,v,x){this._setPaintValues(s,c,h.patterns&&h.patterns[this.layerId],x)}_setPaintValues(s,c,h,m){if(!m||!h)return;const v=m[h];if(!v)return;const{tl:x,br:E,pixelRatio:C}=v;for(let I=s;I<c;I++)this.paintVertexArray.emplace(I,x[0],x[1],E[0],E[1],C)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Vc{constructor(s,c,h=()=>!0){this.binders={},this._buffers=[];const m=[];for(const v in s.paint._values){if(!h(v))continue;const x=s.paint.get(v);if(!(x instanceof le&&Dc(x.property.specification)))continue;const E=xV(v,s.type),C=x.value,I=x.property.specification.type,O=!!x.property.useIntegerZoom,L=v==="line-dasharray"||v.endsWith("pattern"),B=v==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant";if(C.kind!=="constant"||B)if(C.kind==="source"||B||L){const j=nM(v,I,"source");this.binders[v]=L?new jc(C,E,I,j,s.id):new Zl(C,E,I,j),m.push(`/a_${v}`)}else{const j=nM(v,I,"composite");this.binders[v]=new Ca(C,E,I,O,c,j),m.push(`/z_${v}`)}else this.binders[v]=L?new wf(C.value,E):new _g(C.value,E,I),m.push(`/u_${v}`)}this.cacheKey=m.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof Zl||c instanceof Ca?c.maxValue:0}populatePaintArrays(s,c,h,m,v,x){for(const E in this.binders){const C=this.binders[E];(C instanceof Zl||C instanceof Ca||C instanceof jc)&&C.populatePaintArray(s,c,h,m,v,x)}}setConstantPatternPositions(s){for(const c in this.binders){const h=this.binders[c];h instanceof wf&&h.setConstantPatternPositions(s)}}updatePaintArrays(s,c,h,m,v,x){let E=!1;for(const C in s){const I=c.getPositions(C);for(const O of I){const L=h.feature(O.index);for(const B in this.binders){const j=this.binders[B];if((j instanceof Zl||j instanceof Ca||j instanceof jc)&&j.expression.isStateDependent===!0){const U=m.paint.get(B);j.expression=U.value,j.updatePaintArray(O.start,O.end,L,s[C],v,x),E=!0}}}}return E}defines(){const s=[];for(const c in this.binders){const h=this.binders[c];(h instanceof _g||h instanceof wf)&&s.push(...h.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof Zl||h instanceof Ca||h instanceof jc)for(let m=0;m<h.paintVertexAttributes.length;m++)s.push(h.paintVertexAttributes[m].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const h=this.binders[c];if(h instanceof _g||h instanceof wf||h instanceof Ca)for(const m of h.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const c=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof _g||m instanceof wf||m instanceof Ca)for(const v of m.uniformNames)c.push({name:v,property:h,binding:m.getBinding(s,v)})}return c}setUniforms(s,c,h,m,v){for(const{name:x,property:E,binding:C}of h)this.binders[E].setUniform(s,C,v,m.get(E),x)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Zl||c instanceof Ca||c instanceof jc)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(s){for(const c in this.binders){const h=this.binders[c];(h instanceof Zl||h instanceof Ca||h instanceof jc)&&h.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof Zl||c instanceof Ca||c instanceof jc)&&c.destroy()}}}class Md{constructor(s,c,h=()=>!0){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new Vc(m,c,h);this.needsUpload=!1,this._featureMap=new z0,this._bufferOffset=0}populatePaintArrays(s,c,h,m,v,x,E){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(s,c,m,v,x,E);c.id!==void 0&&this._featureMap.add(c.id,h,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,h,m,v){for(const x of h)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,c,x,m,v)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const _V={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function xV(l,s){return _V[l]||[l.replace(`${s}-`,"").replace(/-/g,"_")]}const wV={"line-pattern":{source:qe,composite:qe},"fill-pattern":{source:qe,composite:qe},"fill-extrusion-pattern":{source:qe,composite:qe},"line-dasharray":{source:ct,composite:ct}},SV={color:{source:Js,composite:bt},number:{source:si,composite:Js}};function nM(l,s,c){const h=wV[l];return h&&h[c]||SV[s][c]}Kt(_g,"ConstantBinder"),Kt(wf,"PatternConstantBinder"),Kt(Zl,"SourceExpressionBinder"),Kt(jc,"PatternCompositeBinder"),Kt(Ca,"CompositeExpressionBinder"),Kt(Vc,"ProgramConfiguration",{omit:["_buffers"]}),Kt(Md,"ProgramConfigurationSet");const iM="-transition";class Ia extends Vo{constructor(s,c){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,s.type!=="custom"&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&s.type!=="sky"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),c.layout&&(this._unevaluatedLayout=new ue(c.layout)),c.paint)){this._transitionablePaint=new H(c.paint);for(const h in s.paint)this.setPaintProperty(h,s.paint[h],{validate:!1});for(const h in s.layout)this.setLayoutProperty(h,s.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new de(c.paint)}}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c,h={}){c!=null&&this._validate($w,`layers.${this.id}.layout.${s}`,s,c,h)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,c):this.visibility=c)}getPaintProperty(s){return Vi(s,iM)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c,h={}){if(c!=null&&this._validate(Nw,`layers.${this.id}.paint.${s}`,s,c,h))return!1;if(Vi(s,iM))return this._transitionablePaint.setTransition(s.slice(0,-11),c||void 0),!1;{const m=this._transitionablePaint._values[s],v=m.value.isDataDriven(),x=m.value;this._transitionablePaint.setValue(s,c),this._handleSpecialPaintPropertyUpdate(s);const E=this._transitionablePaint._values[s].value,C=E.isDataDriven(),I=Vi(s,"pattern")||s==="line-dasharray";return C||v||I||this._handleOverridablePaintPropertyUpdate(s,x,E)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,c,h){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),sr(s,(c,h)=>!(c===void 0||h==="layout"&&!Object.keys(c).length||h==="paint"&&!Object.keys(c).length))}_validate(s,c,h,m,v={}){return(!v||v.validate!==!1)&&O0(this,s.call(P0,{key:c,layerType:this.type,objectKey:h,value:m,styleSpec:st,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof le&&Dc(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=gf(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const EV=Re([{name:"a_pos",components:2,type:"Int16"}],4),kV=Re([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class cr{constructor(s=[]){this.segments=s}prepareSegment(s,c,h,m){let v=this.segments[this.segments.length-1];return s>cr.MAX_VERTEX_ARRAY_LENGTH&&ni(`Max vertices per segment is ${cr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!v||v.vertexLength+s>cr.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==m)&&(v={vertexOffset:c.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},m!==void 0&&(v.sortKey=m),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,h,m){return new cr([{vertexOffset:s,primitiveOffset:c,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}cr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Kt(cr,"SegmentVector");var ln=8192;class Uc{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof ci?new ci(s.lng,s.lat):ci.convert(s),this}setSouthWest(s){return this._sw=s instanceof ci?new ci(s.lng,s.lat):ci.convert(s),this}extend(s){const c=this._sw,h=this._ne;let m,v;if(s instanceof ci)m=s,v=s;else{if(!(s instanceof Uc))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(Uc.convert(s)):this.extend(ci.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(ci.convert(s)):this;if(m=s._sw,v=s._ne,!m||!v)return this}return c||h?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),h.lng=Math.max(v.lng,h.lng),h.lat=Math.max(v.lat,h.lat)):(this._sw=new ci(m.lng,m.lat),this._ne=new ci(v.lng,v.lat)),this}getCenter(){return new ci((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ci(this.getWest(),this.getNorth())}getSouthEast(){return new ci(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:h}=ci.convert(s);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&m}static convert(s){return!s||s instanceof Uc?s:new Uc(s)}}var N0=1e-6,cs=typeof Float32Array<"u"?Float32Array:Array;function rM(){var l=new cs(9);return cs!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function oM(l,s,c){var h=s[0],m=s[1],v=s[2],x=s[3],E=s[4],C=s[5],I=s[6],O=s[7],L=s[8],B=c[0],j=c[1],U=c[2],X=c[3],re=c[4],he=c[5],xe=c[6],fe=c[7],be=c[8];return l[0]=B*h+j*x+U*I,l[1]=B*m+j*E+U*O,l[2]=B*v+j*C+U*L,l[3]=X*h+re*x+he*I,l[4]=X*m+re*E+he*O,l[5]=X*v+re*C+he*L,l[6]=xe*h+fe*x+be*I,l[7]=xe*m+fe*E+be*O,l[8]=xe*v+fe*C+be*L,l}function Aa(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Zw(l,s){var c=s[0],h=s[1],m=s[2],v=s[3],x=s[4],E=s[5],C=s[6],I=s[7],O=s[8],L=s[9],B=s[10],j=s[11],U=s[12],X=s[13],re=s[14],he=s[15],xe=c*E-h*x,fe=c*C-m*x,be=c*I-v*x,Se=h*C-m*E,we=h*I-v*E,He=m*I-v*C,Ue=O*X-L*U,at=O*re-B*U,Et=O*he-j*U,Je=L*re-B*X,dt=L*he-j*X,ht=B*he-j*re,vt=xe*ht-fe*dt+be*Je+Se*Et-we*at+He*Ue;return vt?(l[0]=(E*ht-C*dt+I*Je)*(vt=1/vt),l[1]=(m*dt-h*ht-v*Je)*vt,l[2]=(X*He-re*we+he*Se)*vt,l[3]=(B*we-L*He-j*Se)*vt,l[4]=(C*Et-x*ht-I*at)*vt,l[5]=(c*ht-m*Et+v*at)*vt,l[6]=(re*be-U*He-he*fe)*vt,l[7]=(O*He-B*be+j*fe)*vt,l[8]=(x*dt-E*Et+I*Ue)*vt,l[9]=(h*Et-c*dt-v*Ue)*vt,l[10]=(U*we-X*be+he*xe)*vt,l[11]=(L*be-O*we-j*xe)*vt,l[12]=(E*at-x*Je-C*Ue)*vt,l[13]=(c*Je-h*at+m*Ue)*vt,l[14]=(X*fe-U*Se-re*xe)*vt,l[15]=(O*Se-L*fe+B*xe)*vt,l):null}function Pd(l,s,c){var h=s[0],m=s[1],v=s[2],x=s[3],E=s[4],C=s[5],I=s[6],O=s[7],L=s[8],B=s[9],j=s[10],U=s[11],X=s[12],re=s[13],he=s[14],xe=s[15],fe=c[0],be=c[1],Se=c[2],we=c[3];return l[0]=fe*h+be*E+Se*L+we*X,l[1]=fe*m+be*C+Se*B+we*re,l[2]=fe*v+be*I+Se*j+we*he,l[3]=fe*x+be*O+Se*U+we*xe,l[4]=(fe=c[4])*h+(be=c[5])*E+(Se=c[6])*L+(we=c[7])*X,l[5]=fe*m+be*C+Se*B+we*re,l[6]=fe*v+be*I+Se*j+we*he,l[7]=fe*x+be*O+Se*U+we*xe,l[8]=(fe=c[8])*h+(be=c[9])*E+(Se=c[10])*L+(we=c[11])*X,l[9]=fe*m+be*C+Se*B+we*re,l[10]=fe*v+be*I+Se*j+we*he,l[11]=fe*x+be*O+Se*U+we*xe,l[12]=(fe=c[12])*h+(be=c[13])*E+(Se=c[14])*L+(we=c[15])*X,l[13]=fe*m+be*C+Se*B+we*re,l[14]=fe*v+be*I+Se*j+we*he,l[15]=fe*x+be*O+Se*U+we*xe,l}function xg(l,s,c){var h,m,v,x,E,C,I,O,L,B,j,U,X=c[0],re=c[1],he=c[2];return s===l?(l[12]=s[0]*X+s[4]*re+s[8]*he+s[12],l[13]=s[1]*X+s[5]*re+s[9]*he+s[13],l[14]=s[2]*X+s[6]*re+s[10]*he+s[14],l[15]=s[3]*X+s[7]*re+s[11]*he+s[15]):(m=s[1],v=s[2],x=s[3],E=s[4],C=s[5],I=s[6],O=s[7],L=s[8],B=s[9],j=s[10],U=s[11],l[0]=h=s[0],l[1]=m,l[2]=v,l[3]=x,l[4]=E,l[5]=C,l[6]=I,l[7]=O,l[8]=L,l[9]=B,l[10]=j,l[11]=U,l[12]=h*X+E*re+L*he+s[12],l[13]=m*X+C*re+B*he+s[13],l[14]=v*X+I*re+j*he+s[14],l[15]=x*X+O*re+U*he+s[15]),l}function Od(l,s,c){var h=c[0],m=c[1],v=c[2];return l[0]=s[0]*h,l[1]=s[1]*h,l[2]=s[2]*h,l[3]=s[3]*h,l[4]=s[4]*m,l[5]=s[5]*m,l[6]=s[6]*m,l[7]=s[7]*m,l[8]=s[8]*v,l[9]=s[9]*v,l[10]=s[10]*v,l[11]=s[11]*v,l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15],l}function Xw(l,s,c){var h=Math.sin(c),m=Math.cos(c),v=s[4],x=s[5],E=s[6],C=s[7],I=s[8],O=s[9],L=s[10],B=s[11];return s!==l&&(l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[3],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[4]=v*m+I*h,l[5]=x*m+O*h,l[6]=E*m+L*h,l[7]=C*m+B*h,l[8]=I*m-v*h,l[9]=O*m-x*h,l[10]=L*m-E*h,l[11]=B*m-C*h,l}function $0(l,s,c){var h=Math.sin(c),m=Math.cos(c),v=s[0],x=s[1],E=s[2],C=s[3],I=s[8],O=s[9],L=s[10],B=s[11];return s!==l&&(l[4]=s[4],l[5]=s[5],l[6]=s[6],l[7]=s[7],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[0]=v*m-I*h,l[1]=x*m-O*h,l[2]=E*m-L*h,l[3]=C*m-B*h,l[8]=v*h+I*m,l[9]=x*h+O*m,l[10]=E*h+L*m,l[11]=C*h+B*m,l}function sM(l,s){return l[0]=s[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=s[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=s[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function aM(l,s,c){var h,m,v,x=c[0],E=c[1],C=c[2],I=Math.hypot(x,E,C);return I<N0?null:(x*=I=1/I,E*=I,C*=I,h=Math.sin(s),m=Math.cos(s),l[0]=x*x*(v=1-m)+m,l[1]=E*x*v+C*h,l[2]=C*x*v-E*h,l[3]=0,l[4]=x*E*v-C*h,l[5]=E*E*v+m,l[6]=C*E*v+x*h,l[7]=0,l[8]=x*C*v+E*h,l[9]=E*C*v-x*h,l[10]=C*C*v+m,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l)}Math.hypot||(Math.hypot=function(){for(var l=0,s=arguments.length;s--;)l+=arguments[s]*arguments[s];return Math.sqrt(l)});var TV=Pd;function Kw(){var l=new cs(3);return cs!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function lM(l){var s=new cs(3);return s[0]=l[0],s[1]=l[1],s[2]=l[2],s}function wg(l){return Math.hypot(l[0],l[1],l[2])}function Sf(l,s,c){var h=new cs(3);return h[0]=l,h[1]=s,h[2]=c,h}function Xl(l,s,c){return l[0]=s[0]+c[0],l[1]=s[1]+c[1],l[2]=s[2]+c[2],l}function Yw(l,s,c){return l[0]=s[0]-c[0],l[1]=s[1]-c[1],l[2]=s[2]-c[2],l}function cM(l,s,c){return l[0]=s[0]*c[0],l[1]=s[1]*c[1],l[2]=s[2]*c[2],l}function Sg(l,s,c){return l[0]=Math.min(s[0],c[0]),l[1]=Math.min(s[1],c[1]),l[2]=Math.min(s[2],c[2]),l}function Eg(l,s,c){return l[0]=Math.max(s[0],c[0]),l[1]=Math.max(s[1],c[1]),l[2]=Math.max(s[2],c[2]),l}function Is(l,s,c){return l[0]=s[0]*c,l[1]=s[1]*c,l[2]=s[2]*c,l}function kg(l,s,c,h){return l[0]=s[0]+c[0]*h,l[1]=s[1]+c[1]*h,l[2]=s[2]+c[2]*h,l}function To(l,s){var c=s[0],h=s[1],m=s[2],v=c*c+h*h+m*m;return v>0&&(v=1/Math.sqrt(v)),l[0]=s[0]*v,l[1]=s[1]*v,l[2]=s[2]*v,l}function Qs(l,s){return l[0]*s[0]+l[1]*s[1]+l[2]*s[2]}function Jw(l,s,c){var h=s[0],m=s[1],v=s[2],x=c[0],E=c[1],C=c[2];return l[0]=m*C-v*E,l[1]=v*x-h*C,l[2]=h*E-m*x,l}function er(l,s,c){var h=s[0],m=s[1],v=s[2],x=c[3]*h+c[7]*m+c[11]*v+c[15];return l[0]=(c[0]*h+c[4]*m+c[8]*v+c[12])/(x=x||1),l[1]=(c[1]*h+c[5]*m+c[9]*v+c[13])/x,l[2]=(c[2]*h+c[6]*m+c[10]*v+c[14])/x,l}function uM(l,s,c){var h=c[0],m=c[1],v=c[2],x=s[0],E=s[1],C=s[2],I=m*C-v*E,O=v*x-h*C,L=h*E-m*x,B=m*L-v*O,j=v*I-h*L,U=h*O-m*I,X=2*c[3];return O*=X,L*=X,j*=2,U*=2,l[0]=x+(I*=X)+(B*=2),l[1]=E+O+j,l[2]=C+L+U,l}var Tg,Ma=Yw,CV=cM,IV=wg;function dM(l,s,c){return l[0]=s[0]*c,l[1]=s[1]*c,l[2]=s[2]*c,l[3]=s[3]*c,l}function hM(l,s){var c=s[0],h=s[1],m=s[2],v=s[3],x=c*c+h*h+m*m+v*v;return x>0&&(x=1/Math.sqrt(x)),l[0]=c*x,l[1]=h*x,l[2]=m*x,l[3]=v*x,l}function Dd(l,s,c){var h=s[0],m=s[1],v=s[2],x=s[3];return l[0]=c[0]*h+c[4]*m+c[8]*v+c[12]*x,l[1]=c[1]*h+c[5]*m+c[9]*v+c[13]*x,l[2]=c[2]*h+c[6]*m+c[10]*v+c[14]*x,l[3]=c[3]*h+c[7]*m+c[11]*v+c[15]*x,l}function fM(){var l=new cs(4);return cs!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function pM(l){return l[0]=0,l[1]=0,l[2]=0,l[3]=1,l}function mM(l,s,c){c*=.5;var h=s[0],m=s[1],v=s[2],x=s[3],E=Math.sin(c),C=Math.cos(c);return l[0]=h*C+x*E,l[1]=m*C+v*E,l[2]=v*C-m*E,l[3]=x*C-h*E,l}function gM(l,s,c){c*=.5;var h=s[0],m=s[1],v=s[2],x=s[3],E=Math.sin(c),C=Math.cos(c);return l[0]=h*C-v*E,l[1]=m*C+x*E,l[2]=v*C+h*E,l[3]=x*C-m*E,l}Kw(),Tg=new cs(4),cs!=Float32Array&&(Tg[0]=0,Tg[1]=0,Tg[2]=0,Tg[3]=0);var AV=hM;Kw(),Sf(1,0,0),Sf(0,1,0),fM(),fM(),rM();const MV=Re([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:yM}=MV,vM=Re([{name:"a_pos_3",components:3,type:"Int16"}]);var Cg=Re([{name:"a_pos",type:"Int16",components:2}]);class Qw{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,h){const m=Qs(c,this.dir);if(Math.abs(m)<1e-6)return!1;const v=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1]+(s[2]-this.pos[2])*c[2])/m;return h[0]=this.pos[0]+this.dir[0]*v,h[1]=this.pos[1]+this.dir[1]*v,h[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(s,c,h){if(function(j,U){var X=j[0],re=j[1],he=j[2],xe=U[0],fe=U[1],be=U[2];return Math.abs(X-xe)<=N0*Math.max(1,Math.abs(X),Math.abs(xe))&&Math.abs(re-fe)<=N0*Math.max(1,Math.abs(re),Math.abs(fe))&&Math.abs(he-be)<=N0*Math.max(1,Math.abs(he),Math.abs(be))}(this.pos,s)||c===0)return h[0]=h[1]=h[2]=0,!1;const[m,v,x]=this.dir,E=this.pos[0]-s[0],C=this.pos[1]-s[1],I=this.pos[2]-s[2],O=m*m+v*v+x*x,L=2*(E*m+C*v+I*x),B=L*L-4*O*(E*E+C*C+I*I-c*c);if(B<0){const j=Math.max(-L/2,0),U=E+m*j,X=C+v*j,re=I+x*j,he=Math.hypot(U,X,re);return h[0]=U*c/he,h[1]=X*c/he,h[2]=re*c/he,!1}{const j=(-L-Math.sqrt(B))/(2*O);if(j<0){const U=Math.hypot(E,C,I);return h[0]=E*c/U,h[1]=C*c/U,h[2]=I*c/U,!1}return h[0]=E+m*j,h[1]=C+v*j,h[2]=I+x*j,!0}}}class eS{constructor(s,c,h,m,v){this.TL=s,this.TR=c,this.BR=h,this.BL=m,this.horizon=v}static fromInvProjectionMatrix(s,c,h){const m=[-1,1,1],v=[1,1,1],x=[1,-1,1],E=[-1,-1,1],C=er(m,m,s),I=er(v,v,s),O=er(x,x,s),L=er(E,E,s);return new eS(C,I,O,L,c/h)}}class tS{constructor(s,c){this.points=s,this.planes=c}static fromInvProjectionMatrix(s,c,h,m){const v=Math.pow(2,h),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const I=Dd([],C,s),O=1/I[3]/c*v;return function(L,B,j){return L[0]=B[0]*j[0],L[1]=B[1]*j[1],L[2]=B[2]*j[2],L[3]=B[3]*j[3],L}(I,I,[O,O,m?1/I[3]:O,O])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const I=To([],Jw([],Ma([],x[C[0]],x[C[1]]),Ma([],x[C[2]],x[C[1]]))),O=-Qs(I,x[C[1]]);return I.concat(O)});return new tS(x,E)}}class Co{static fromPoints(s){const c=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const m of s)Sg(c,c,m),Eg(h,h,m);return new Co(c,h)}static applyTransform(s,c){const h=s.getCorners();for(let m=0;m<h.length;++m)er(h[m],h[m],c);return Co.fromPoints(h)}constructor(s,c){this.min=s,this.max=c,this.center=Is([],Xl([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],h=lM(this.min),m=lM(this.max);for(let v=0;v<c.length;v++)h[v]=c[v]?this.min[v]:this.center[v],m[v]=c[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new Co(h,m)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,c=this.max;return[[s[0],s[1],s[2]],[c[0],s[1],s[2]],[c[0],c[1],s[2]],[s[0],c[1],s[2]],[s[0],s[1],c[2]],[c[0],s[1],c[2]],[c[0],c[1],c[2]],[s[0],c[1],c[2]]]}intersects(s){const c=this.getCorners();let h=!0;for(let m=0;m<s.planes.length;m++){const v=s.planes[m];let x=0;for(let E=0;E<c.length;E++)x+=Qs(v,c[E])+v[3]>=0;if(x===0)return 0;x!==c.length&&(h=!1)}if(h)return 2;for(let m=0;m<3;m++){let v=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let E=0;E<s.points.length;E++){const C=s.points[E][m]-this.min[m];v=Math.min(v,C),x=Math.max(x,C)}if(x<0||v>this.max[m]-this.min[m])return 0}return 1}}const nS=5,bM=6,ll=ln/Math.PI/2,PV=16383,Rd=64,Ig=[Rd,32,16],ea=-ll,ta=ll,OV=[new Co([ea,ea,ea],[ta,ta,ta]),new Co([ea,ea,ea],[0,0,ta]),new Co([0,ea,ea],[ta,0,ta]),new Co([ea,0,ea],[0,ta,ta]),new Co([0,0,ea],[ta,ta,ta])];function j0(l){return l*ll/Pg}function _M(l,s,c,h=!0){const m=Is([],l._camera.position,l.worldSize),v=[s,c,1,1];Dd(v,v,l.pixelMatrixInverse),dM(v,v,1/v[3]);const x=To([],Ma([],v,m)),E=l.globeMatrix,C=[E[12],E[13],E[14]],I=Ma([],C,m),O=wg(I),L=To([],I),B=l.worldSize/(2*Math.PI),j=Qs(L,x),U=Math.asin(B/O);if(U<Math.acos(j)){if(!h)return null;const Et=[],Je=[];Is(Et,x,O/j),To(Je,Ma(Je,Et,I)),To(x,Xl(x,I,Is(x,Je,Math.tan(U)*O)))}const X=[];new Qw(m,x).closestPointOnSphere(C,B,X);const re=To([],Xe(E,0)),he=To([],Xe(E,1)),xe=To([],Xe(E,2)),fe=Qs(re,X),be=Qs(he,X),Se=Qs(xe,X),we=At(Math.asin(-be/B));let He=At(Math.atan2(fe,Se));He=l.center.lng+function(Et,Je){const dt=(Je-Et+180)%360-180;return dt<-180?dt+360:dt}(l.center.lng,He);const Ue=ul(He),at=ze(dl(we),0,1);return new Cf(Ue,at)}class DV{constructor(s,c,h){this.a=Ma([],s,h),this.b=Ma([],c,h),this.center=h;const m=To([],this.a),v=To([],this.b);this.angle=Math.acos(Qs(m,v))}}function iS(l,s){if(l.angle===0)return null;let c;return c=l.a[s]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[s]/l.a[s]/Math.sin(l.angle)-1/Math.tan(l.angle)),c<0||c>1?null:function(h,m,v,x){const E=Math.sin(v);return h*(Math.sin((1-x)*v)/E)+m*(Math.sin(x*v)/E)}(l.a[s],l.b[s],l.angle,ze(c,0,1))+l.center[s]}function cl(l){if(l.z<=1)return OV[l.z+2*l.y+l.x];const s=rS(V0(l));return Co.fromPoints(s)}function Ld(l,s,c){return Is(l,l,1-c),kg(l,l,s,c)}function xM(l,s){const c=Tf(s.zoom);if(c===0)return cl(l);const h=V0(l),m=rS(h),v=ul(h.getWest())*s.worldSize,x=ul(h.getEast())*s.worldSize,E=dl(h.getNorth())*s.worldSize,C=dl(h.getSouth())*s.worldSize,I=[v,E,0],O=[x,E,0],L=[v,C,0],B=[x,C,0],j=Zw([],s.globeMatrix);return er(I,I,j),er(O,O,j),er(L,L,j),er(B,B,j),m[0]=Ld(m[0],L,c),m[1]=Ld(m[1],B,c),m[2]=Ld(m[2],O,c),m[3]=Ld(m[3],I,c),Co.fromPoints(m)}function wM(l,s,c){for(const h of l)er(h,h,s),Is(h,h,c)}function RV(l,s,c){const h=s/l.worldSize,m=l.globeMatrix;if(c.z<=1){const Ue=cl(c).getCorners();return wM(Ue,m,h),Co.fromPoints(Ue)}const v=V0(c),x=rS(v);wM(x,m,h);const E=Number.MAX_VALUE,C=[-E,-E,-E],I=[E,E,E];if(v.contains(l.center)){for(const Et of x)Sg(I,I,Et),Eg(C,C,Et);C[2]=0;const Ue=l.point,at=[Ue.x*h,Ue.y*h,0];return Sg(I,I,at),Eg(C,C,at),new Co(I,C)}const O=[m[12]*h,m[13]*h,m[14]*h],L=v.getCenter(),B=ze(l.center.lat,-to,to),j=ze(L.lat,-to,to),U=ul(l.center.lng),X=dl(B);let re=U-ul(L.lng);const he=X-dl(j);re>.5?re-=1:re<-.5&&(re+=1);let xe=0;Math.abs(re)>Math.abs(he)?xe=re>=0?1:3:(xe=he>=0?0:2,kg(O,O,[m[4]*h,m[5]*h,m[6]*h],-Math.sin(tt(he>=0?v.getSouth():v.getNorth()))*ll));const fe=x[xe],be=x[(xe+1)%4],Se=new DV(fe,be,O),we=[iS(Se,0)||fe[0],iS(Se,1)||fe[1],iS(Se,2)||fe[2]],He=Tf(l.zoom);if(He>0){const Ue=function({x:Et,y:Je,z:dt},ht,vt,Pt,it){const Vt=1/(1<<dt);let Jt=Et*Vt,qt=Jt+Vt,xn=Je*Vt,Dt=xn+Vt,on=0;const wn=(Jt+qt)/2-Pt;return wn>.5?on=-1:wn<-.5&&(on=1),Jt=((Jt+on)*ht-(Pt*=ht))*vt+Pt,qt=((qt+on)*ht-Pt)*vt+Pt,xn=(xn*ht-(it*=ht))*vt+it,Dt=(Dt*ht-it)*vt+it,[[Jt,Dt,0],[qt,Dt,0],[qt,xn,0],[Jt,xn,0]]}(c,s,l._pixelsPerMercatorPixel,U,X);for(let Et=0;Et<x.length;Et++)Ld(x[Et],Ue[Et],He);const at=Xl([],Ue[xe],Ue[(xe+1)%4]);Is(at,at,.5),Ld(we,at,He)}for(const Ue of x)Sg(I,I,Ue),Eg(C,C,Ue);return I[2]=Math.min(fe[2],be[2]),Sg(I,I,we),Eg(C,C,we),new Co(I,C)}function V0({x:l,y:s,z:c}){const h=1/(1<<c),m=new ci(As(l*h),eo((s+1)*h)),v=new ci(As((l+1)*h),eo(s*h));return new Uc(m,v)}function rS(l){const s=tt(l.getNorth()),c=tt(l.getSouth()),h=Math.cos(s),m=Math.cos(c),v=Math.sin(s),x=Math.sin(c),E=l.getWest(),C=l.getEast();return[Ef(m,x,E),Ef(m,x,C),Ef(h,v,C),Ef(h,v,E)]}function Ef(l,s,c,h=ll){return c=tt(c),[l*Math.sin(c)*h,-s*h,l*Math.cos(c)*h]}function kf(l,s,c){return Ef(Math.cos(tt(l)),Math.sin(tt(l)),s,c)}function Ag(l,s,c,h){const m=1<<c.z,v=(l/ln+c.x)/m;return kf(eo((s/ln+c.y)/m),As(v),h)}function U0({min:l,max:s}){return PV/Math.max(s[0]-l[0],s[1]-l[1],s[2]-l[2])}const SM=new Float64Array(16);function Mg(l){const s=U0(l),c=sM(SM,[s,s,s]);return xg(c,c,((h=[])[0]=-(m=l.min)[0],h[1]=-m[1],h[2]=-m[2],h));var h,m}function oS(l){const s=(h=l.min,(c=SM)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=h[0],c[13]=h[1],c[14]=h[2],c[15]=1,c);var c,h;const m=1/U0(l);return Od(s,s,[m,m,m])}function EM(l,s,c,h,m){const v=function(C){const I=ln/(2*Math.PI);return C/(2*Math.PI)/I}(c),x=[l,s,-c/(2*Math.PI)],E=Aa(new Float64Array(16));return xg(E,E,x),Od(E,E,[v,v,v]),Xw(E,E,tt(-m)),$0(E,E,tt(-h)),E}function Tf(l){return ot(nS,bM,l)}function kM(l,s){const c=kf(s.lat,s.lng),h=function(U){const X=kf(U._center.lat,U._center.lng);let re=Jw([],Sf(0,1,0),X);const he=aM([],-U.angle,X);re=er(re,re,he),aM(he,-U._pitch,re);const xe=To([],X);return Is(xe,xe,j0(U.cameraToCenterDistance/U.pixelsPerMeter)),er(xe,xe,he),Xl([],X,xe)}(l);return x=(m=Yw([],h,c))[0],E=m[1],C=m[2],I=(v=c)[0],O=v[1],L=v[2],j=(B=Math.sqrt(x*x+E*E+C*C)*Math.sqrt(I*I+O*O+L*L))&&Qs(m,v)/B,Math.acos(Math.min(Math.max(j,-1),1));var m,v,x,E,C,I,O,L,B,j}function sS(l,s){return kM(l,s)>Math.PI/2*1.01}const TM=tt(85),LV=Math.cos(TM),zV=Math.sin(TM),Pg=63710088e-1,CM=2*Math.PI*Pg;class qc{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new qc(Be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,h=this.lat*c,m=s.lat*c,v=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((s.lng-this.lng)*c);return Pg*Math.acos(Math.min(v,1))}toBounds(s=0){const c=360*s/40075017,h=c/Math.cos(Math.PI/180*this.lat);return new Uc(new qc(this.lng-h,this.lat-c),new qc(this.lng+h,this.lat+c))}toEcef(s){const c=j0(s);return kf(this.lat,this.lng,ll+c)}static convert(s){if(s instanceof qc)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new qc(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new qc(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var ci=qc;function aS(l){return CM*Math.cos(l*Math.PI/180)}function ul(l){return(180+l)/360}function dl(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function Pa(l,s){return l/aS(s)}function As(l){return 360*l-180}function eo(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function IM(l,s){return l*aS(eo(s))}const to=85.051129;function AM(l){return 1/Math.cos(l*Math.PI/180)}class Cf{constructor(s,c,h=0){this.x=+s,this.y=+c,this.z=+h}static fromLngLat(s,c=0){const h=ci.convert(s);return new Cf(ul(h.lng),dl(h.lat),Pa(c,h.lat))}toLngLat(){return new ci(As(this.x),eo(this.y))}toAltitude(){return IM(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/CM*AM(eo(this.y))}}function lS(l,s,c,h,m,v,x,E,C){const I=(s+h)/2,O=(c+m)/2,L=new te(I,O);E(L),function(B,j,U,X,re,he){const xe=U-re,fe=X-he;return Math.abs((X-j)*xe-(U-B)*fe)/Math.hypot(xe,fe)}(L.x,L.y,v.x,v.y,x.x,x.y)>=C?(lS(l,s,c,I,O,v,L,E,C),lS(l,I,O,h,m,L,x,E,C)):l.push(x)}function MM(l,s,c){let h=l[0],m=h.x,v=h.y;s(h);const x=[h];for(let E=1;E<l.length;E++){const C=l[E],{x:I,y:O}=C;s(C),lS(x,m,v,I,O,h,C,s,c),m=I,v=O,h=C}return x}function cS(l,s,c,h){if(h(s,c)){const m=s.add(c)._mult(.5);cS(l,s,m,h),cS(l,m,c,h)}else l.push(c)}function BV(l,s){let c=l[0];const h=[c];for(let m=1;m<l.length;m++){const v=l[m];cS(h,c,v,s),c=v}return h}const uS=Math.pow(2,14)-1,PM=-uS-1;function FV(l,s){const c=Math.round(l.x*s),h=Math.round(l.y*s);return l.x=ze(c,PM,uS),l.y=ze(h,PM,uS),(c<l.x||c>l.x+1||h<l.y||h>l.y+1)&&ni("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function Kl(l,s,c){const h=l.loadGeometry(),m=l.extent,v=ln/m;if(s&&c&&c.projection.isReprojectedInTileSpace){const x=1<<s.z,{scale:E,x:C,y:I,projection:O}=c,L=B=>{const j=As((s.x+B.x/m)/x),U=eo((s.y+B.y/m)/x),X=O.project(j,U);B.x=(X.x*E-C)*m,B.y=(X.y*E-I)*m};for(let B=0;B<h.length;B++)if(l.type!==1)h[B]=MM(h[B],L,1);else{const j=[];for(const U of h[B])U.x<0||U.x>=m||U.y<0||U.y>=m||(L(U),j.push(U));h[B]=j}}for(const x of h)for(const E of x)FV(E,v);return h}function zd(l,s){return{type:l.type,id:l.id,properties:l.properties,geometry:s?Kl(l):[]}}function q0(l,s,c,h,m){l.emplaceBack(2*s+(h+1)/2,2*c+(m+1)/2)}function W0(l,s,c){l.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}class dS{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new St,this.indexArray=new tn,this.segments=new cr,this.programConfigurations=new Md(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,h,m){const v=this.layers[0],x=[];let E=null;v.type==="circle"&&(E=v.layout.get("circle-sort-key"));for(const{feature:I,id:O,index:L,sourceLayerIndex:B}of s){const j=this.layers[0]._featureFilter.needGeometry,U=zd(I,j);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),U,h))continue;const X=E?E.evaluate(U,{},h):void 0,re={id:O,properties:I.properties,type:I.type,sourceLayerIndex:B,index:L,geometry:j?U.geometry:Kl(I,h,m),patterns:{},sortKey:X};x.push(re)}E&&x.sort((I,O)=>I.sortKey-O.sortKey);let C=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new Tt,C=m.projection);for(const I of x){const{geometry:O,index:L,sourceLayerIndex:B}=I,j=s[L].feature;this.addFeature(I,O,L,c.availableImages,h,C),c.featureIndex.insert(j,O,L,B,this.index)}}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,EV.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,kV.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,c,h,m,v,x){for(const E of c)for(const C of E){const I=C.x,O=C.y;if(I<0||I>=ln||O<0||O>=ln)continue;if(x){const j=x.projectTilePoint(I,O,v),U=x.upVector(v,I,O),X=this.globeExtVertexArray;W0(X,j,U),W0(X,j,U),W0(X,j,U),W0(X,j,U)}const L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),B=L.vertexLength;q0(this.layoutVertexArray,I,O,-1,-1),q0(this.layoutVertexArray,I,O,1,-1),q0(this.layoutVertexArray,I,O,1,1),q0(this.layoutVertexArray,I,O,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+2,B+3),L.vertexLength+=4,L.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,{},m,v)}}function OM(l,s){for(let c=0;c<l.length;c++)if(Bd(s,l[c]))return!0;for(let c=0;c<s.length;c++)if(Bd(l,s[c]))return!0;return!!hS(l,s)}function NV(l,s,c){return!!Bd(l,s)||!!fS(s,l,c)}function DM(l,s){if(l.length===1)return LM(s,l[0]);for(let c=0;c<s.length;c++){const h=s[c];for(let m=0;m<h.length;m++)if(Bd(l,h[m]))return!0}for(let c=0;c<l.length;c++)if(LM(s,l[c]))return!0;for(let c=0;c<s.length;c++)if(hS(l,s[c]))return!0;return!1}function $V(l,s,c){if(l.length>1){if(hS(l,s))return!0;for(let h=0;h<s.length;h++)if(fS(s[h],l,c))return!0}for(let h=0;h<l.length;h++)if(fS(l[h],s,c))return!0;return!1}function hS(l,s){if(l.length===0||s.length===0)return!1;for(let c=0;c<l.length-1;c++){const h=l[c],m=l[c+1];for(let v=0;v<s.length-1;v++)if(jV(h,m,s[v],s[v+1]))return!0}return!1}function jV(l,s,c,h){return Ur(l,c,h)!==Ur(s,c,h)&&Ur(l,s,c)!==Ur(l,s,h)}function fS(l,s,c){const h=c*c;if(s.length===1)return l.distSqr(s[0])<h;for(let m=1;m<s.length;m++)if(RM(l,s[m-1],s[m])<h)return!0;return!1}function RM(l,s,c){const h=s.distSqr(c);if(h===0)return l.distSqr(s);const m=((l.x-s.x)*(c.x-s.x)+(l.y-s.y)*(c.y-s.y))/h;return l.distSqr(m<0?s:m>1?c:c.sub(s)._mult(m)._add(s))}function LM(l,s){let c,h,m,v=!1;for(let x=0;x<l.length;x++){c=l[x];for(let E=0,C=c.length-1;E<c.length;C=E++)h=c[E],m=c[C],h.y>s.y!=m.y>s.y&&s.x<(m.x-h.x)*(s.y-h.y)/(m.y-h.y)+h.x&&(v=!v)}return v}function Bd(l,s){let c=!1;for(let h=0,m=l.length-1;h<l.length;m=h++){const v=l[h],x=l[m];v.y>s.y!=x.y>s.y&&s.x<(x.x-v.x)*(s.y-v.y)/(x.y-v.y)+v.x&&(c=!c)}return c}function zM(l,s,c,h,m){for(const x of l)if(s<=x.x&&c<=x.y&&h>=x.x&&m>=x.y)return!0;const v=[new te(s,c),new te(s,m),new te(h,m),new te(h,c)];if(l.length>2){for(const x of v)if(Bd(l,x))return!0}for(let x=0;x<l.length-1;x++)if(VV(l[x],l[x+1],v))return!0;return!1}function VV(l,s,c){const h=c[0],m=c[2];if(l.x<h.x&&s.x<h.x||l.x>m.x&&s.x>m.x||l.y<h.y&&s.y<h.y||l.y>m.y&&s.y>m.y)return!1;const v=Ur(l,s,c[0]);return v!==Ur(l,s,c[1])||v!==Ur(l,s,c[2])||v!==Ur(l,s,c[3])}function If(l,s,c){const h=s.paint.get(l).value;return h.kind==="constant"?h.value:c.programConfigurations.get(s.id).getMaxValue(l)}function G0(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function BM(l,s,c,h,m){if(!s[0]&&!s[1])return l;const v=te.convert(s)._mult(m);c==="viewport"&&v._rotate(-h);const x=[];for(let E=0;E<l.length;E++)x.push(l[E].sub(v));return x}function FM(l,s,c,h){const m=te.convert(l)._mult(h);return s==="viewport"&&m._rotate(-c),m}Kt(dS,"CircleBucket",{omit:["layers"]});const UV=new ye({"circle-sort-key":new oe(st.layout_circle["circle-sort-key"])});var qV={paint:new ye({"circle-radius":new oe(st.paint_circle["circle-radius"]),"circle-color":new oe(st.paint_circle["circle-color"]),"circle-blur":new oe(st.paint_circle["circle-blur"]),"circle-opacity":new oe(st.paint_circle["circle-opacity"]),"circle-translate":new Z(st.paint_circle["circle-translate"]),"circle-translate-anchor":new Z(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Z(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Z(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new oe(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new oe(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new oe(st.paint_circle["circle-stroke-opacity"])}),layout:UV};function NM(l,s,c,h,m,v,x,E,C){if(v&&l.queryGeometry.isAboveHorizon)return!1;v&&(C*=l.pixelToTileUnitsFactor);const I=l.tileID.canonical,O=c.projection.upVectorScale(I,c.center.lat,c.worldSize).metersToTile;for(const L of s)for(const B of L){const j=B.add(E),U=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(j.x,j.y,!0):0,X=c.projection.projectTilePoint(j.x,j.y,I);if(U>0){const fe=c.projection.upVector(I,j.x,j.y);X.x+=fe[0]*O*U,X.y+=fe[1]*O*U,X.z+=fe[2]*O*U}const re=v?j:WV(X.x,X.y,X.z,h),he=v?l.tilespaceRays.map(fe=>HV(fe,U)):l.queryGeometry.screenGeometry,xe=Dd([],[X.x,X.y,X.z,1],h);if(!x&&v?C*=xe[3]/c.cameraToCenterDistance:x&&!v&&(C*=c.cameraToCenterDistance/xe[3]),v){const fe=eo((B.y/ln+I.y)/(1<<I.z));C/=c.projection.pixelsPerMeter(fe,1)/Pa(1,fe)}if(NV(he,re,C))return!0}return!1}function WV(l,s,c,h){const m=Dd([],[l,s,c,1],h);return new te(m[0]/m[3],m[1]/m[3])}const $M=Sf(0,0,0),GV=Sf(0,0,1);function HV(l,s){const c=Kw();return $M[2]=s,l.intersectsPlane($M,GV,c),new te(c[0],c[1])}class jM extends dS{}function VM(l,{width:s,height:c},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*c*h)throw new RangeError("mismatched image size")}else m=new Uint8Array(s*c*h);return l.width=s,l.height=c,l.data=m,l}function UM(l,s,c){const{width:h,height:m}=s;h===l.width&&m===l.height||(pS(l,s,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,h),height:Math.min(l.height,m)},c),l.width=h,l.height=m,l.data=s.data)}function pS(l,s,c,h,m,v){if(m.width===0||m.height===0)return s;if(m.width>l.width||m.height>l.height||c.x>l.width-m.width||c.y>l.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||h.x>s.width-m.width||h.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=l.data,E=s.data;for(let C=0;C<m.height;C++){const I=((c.y+C)*l.width+c.x)*v,O=((h.y+C)*s.width+h.x)*v;for(let L=0;L<m.width*v;L++)E[O+L]=x[I+L]}return s}Kt(jM,"HeatmapBucket",{omit:["layers"]});class Yl{constructor(s,c){VM(this,s,1,c)}resize(s){UM(this,new Yl(s),1)}clone(){return new Yl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,h,m,v){pS(s,c,h,m,v,1)}}class us{constructor(s,c){VM(this,s,4,c)}resize(s){UM(this,new us(s),4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new us({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,h,m,v){pS(s,c,h,m,v,4)}}Kt(Yl,"AlphaImage"),Kt(us,"RGBAImage");var ZV={paint:new ye({"heatmap-radius":new oe(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new oe(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Z(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ge(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Z(st.paint_heatmap["heatmap-opacity"])})};function mS(l){const s={},c=l.resolution||256,h=l.clips?l.clips.length:1,m=l.image||new us({width:c,height:h}),v=(x,E,C)=>{s[l.evaluationKey]=C;const I=l.expression.evaluate(s);m.data[x+E+0]=Math.floor(255*I.r/I.a),m.data[x+E+1]=Math.floor(255*I.g/I.a),m.data[x+E+2]=Math.floor(255*I.b/I.a),m.data[x+E+3]=Math.floor(255*I.a)};if(l.clips)for(let x=0,E=0;x<h;++x,E+=4*c)for(let C=0,I=0;C<c;C++,I+=4){const O=C/(c-1),{start:L,end:B}=l.clips[x];v(E,I,L*(1-O)+B*O)}else for(let x=0,E=0;x<c;x++,E+=4)v(0,E,x/(c-1));return m}var XV={paint:new ye({"hillshade-illumination-direction":new Z(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Z(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Z(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Z(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Z(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Z(st.paint_hillshade["hillshade-accent-color"])})};const KV=Re([{name:"a_pos",components:2,type:"Int16"}],4),{members:YV}=KV;var gS={exports:{}};function H0(l,s,c){c=c||2;var h,m,v,x,E,C,I,O=s&&s.length,L=O?s[0]*c:l.length,B=qM(l,0,L,c,!0),j=[];if(!B||B.next===B.prev)return j;if(O&&(B=function(X,re,he,xe){var fe,be,Se,we=[];for(fe=0,be=re.length;fe<be;fe++)(Se=qM(X,re[fe]*xe,fe<be-1?re[fe+1]*xe:X.length,xe,!1))===Se.next&&(Se.steiner=!0),we.push(oU(Se));for(we.sort(nU),fe=0;fe<we.length;fe++)he=iU(we[fe],he);return he}(l,s,B,c)),l.length>80*c){h=v=l[0],m=x=l[1];for(var U=c;U<L;U+=c)(E=l[U])<h&&(h=E),(C=l[U+1])<m&&(m=C),E>v&&(v=E),C>x&&(x=C);I=(I=Math.max(v-h,x-m))!==0?32767/I:0}return Og(B,j,c,h,m,I,0),j}function qM(l,s,c,h,m){var v,x;if(m===bS(l,s,c,h)>0)for(v=s;v<c;v+=h)x=HM(v,l[v],l[v+1],x);else for(v=c-h;v>=s;v-=h)x=HM(v,l[v],l[v+1],x);return x&&Z0(x,x.next)&&(Rg(x),x=x.next),x}function Fd(l,s){if(!l)return l;s||(s=l);var c,h=l;do if(c=!1,h.steiner||!Z0(h,h.next)&&ur(h.prev,h,h.next)!==0)h=h.next;else{if(Rg(h),(h=s=h.prev)===h.next)break;c=!0}while(c||h!==s);return s}function Og(l,s,c,h,m,v,x){if(l){!x&&v&&function(O,L,B,j){var U=O;do U.z===0&&(U.z=yS(U.x,U.y,L,B,j)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==O);U.prevZ.nextZ=null,U.prevZ=null,function(X){var re,he,xe,fe,be,Se,we,He,Ue=1;do{for(he=X,X=null,be=null,Se=0;he;){for(Se++,xe=he,we=0,re=0;re<Ue&&(we++,xe=xe.nextZ);re++);for(He=Ue;we>0||He>0&&xe;)we!==0&&(He===0||!xe||he.z<=xe.z)?(fe=he,he=he.nextZ,we--):(fe=xe,xe=xe.nextZ,He--),be?be.nextZ=fe:X=fe,fe.prevZ=be,be=fe;he=xe}be.nextZ=null,Ue*=2}while(Se>1)}(U)}(l,h,m,v);for(var E,C,I=l;l.prev!==l.next;)if(E=l.prev,C=l.next,v?QV(l,h,m,v):JV(l))s.push(E.i/c|0),s.push(l.i/c|0),s.push(C.i/c|0),Rg(l),l=C.next,I=C.next;else if((l=C)===I){x?x===1?Og(l=eU(Fd(l),s,c),s,c,h,m,v,2):x===2&&tU(l,s,c,h,m,v):Og(Fd(l),s,c,h,m,v,1);break}}}function JV(l){var s=l.prev,c=l,h=l.next;if(ur(s,c,h)>=0)return!1;for(var m=s.x,v=c.x,x=h.x,E=s.y,C=c.y,I=h.y,O=m<v?m<x?m:x:v<x?v:x,L=E<C?E<I?E:I:C<I?C:I,B=m>v?m>x?m:x:v>x?v:x,j=E>C?E>I?E:I:C>I?C:I,U=h.next;U!==s;){if(U.x>=O&&U.x<=B&&U.y>=L&&U.y<=j&&Af(m,E,v,C,x,I,U.x,U.y)&&ur(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function QV(l,s,c,h){var m=l.prev,v=l,x=l.next;if(ur(m,v,x)>=0)return!1;for(var E=m.x,C=v.x,I=x.x,O=m.y,L=v.y,B=x.y,j=E<C?E<I?E:I:C<I?C:I,U=O<L?O<B?O:B:L<B?L:B,X=E>C?E>I?E:I:C>I?C:I,re=O>L?O>B?O:B:L>B?L:B,he=yS(j,U,s,c,h),xe=yS(X,re,s,c,h),fe=l.prevZ,be=l.nextZ;fe&&fe.z>=he&&be&&be.z<=xe;){if(fe.x>=j&&fe.x<=X&&fe.y>=U&&fe.y<=re&&fe!==m&&fe!==x&&Af(E,O,C,L,I,B,fe.x,fe.y)&&ur(fe.prev,fe,fe.next)>=0||(fe=fe.prevZ,be.x>=j&&be.x<=X&&be.y>=U&&be.y<=re&&be!==m&&be!==x&&Af(E,O,C,L,I,B,be.x,be.y)&&ur(be.prev,be,be.next)>=0))return!1;be=be.nextZ}for(;fe&&fe.z>=he;){if(fe.x>=j&&fe.x<=X&&fe.y>=U&&fe.y<=re&&fe!==m&&fe!==x&&Af(E,O,C,L,I,B,fe.x,fe.y)&&ur(fe.prev,fe,fe.next)>=0)return!1;fe=fe.prevZ}for(;be&&be.z<=xe;){if(be.x>=j&&be.x<=X&&be.y>=U&&be.y<=re&&be!==m&&be!==x&&Af(E,O,C,L,I,B,be.x,be.y)&&ur(be.prev,be,be.next)>=0)return!1;be=be.nextZ}return!0}function eU(l,s,c){var h=l;do{var m=h.prev,v=h.next.next;!Z0(m,v)&&WM(m,h,h.next,v)&&Dg(m,v)&&Dg(v,m)&&(s.push(m.i/c|0),s.push(h.i/c|0),s.push(v.i/c|0),Rg(h),Rg(h.next),h=l=v),h=h.next}while(h!==l);return Fd(h)}function tU(l,s,c,h,m,v){var x=l;do{for(var E=x.next.next;E!==x.prev;){if(x.i!==E.i&&sU(x,E)){var C=GM(x,E);return x=Fd(x,x.next),C=Fd(C,C.next),Og(x,s,c,h,m,v,0),void Og(C,s,c,h,m,v,0)}E=E.next}x=x.next}while(x!==l)}function nU(l,s){return l.x-s.x}function iU(l,s){var c=function(m,v){var x,E=v,C=m.x,I=m.y,O=-1/0;do{if(I<=E.y&&I>=E.next.y&&E.next.y!==E.y){var L=E.x+(I-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(L<=C&&L>O&&(O=L,x=E.x<E.next.x?E:E.next,L===C))return x}E=E.next}while(E!==v);if(!x)return null;var B,j=x,U=x.x,X=x.y,re=1/0;E=x;do C>=E.x&&E.x>=U&&C!==E.x&&Af(I<X?C:O,I,U,X,I<X?O:C,I,E.x,E.y)&&(B=Math.abs(I-E.y)/(C-E.x),Dg(E,m)&&(B<re||B===re&&(E.x>x.x||E.x===x.x&&rU(x,E)))&&(x=E,re=B)),E=E.next;while(E!==j);return x}(l,s);if(!c)return s;var h=GM(c,l);return Fd(h,h.next),Fd(c,c.next)}function rU(l,s){return ur(l.prev,l,s.prev)<0&&ur(s.next,l,l.next)<0}function yS(l,s,c,h,m){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-c)*m|0)|l<<8))|l<<4))|l<<2))|l<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-h)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function oU(l){var s=l,c=l;do(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next;while(s!==l);return c}function Af(l,s,c,h,m,v,x,E){return(m-x)*(s-E)>=(l-x)*(v-E)&&(l-x)*(h-E)>=(c-x)*(s-E)&&(c-x)*(v-E)>=(m-x)*(h-E)}function sU(l,s){return l.next.i!==s.i&&l.prev.i!==s.i&&!function(c,h){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==h.i&&m.next.i!==h.i&&WM(m,m.next,c,h))return!0;m=m.next}while(m!==c);return!1}(l,s)&&(Dg(l,s)&&Dg(s,l)&&function(c,h){var m=c,v=!1,x=(c.x+h.x)/2,E=(c.y+h.y)/2;do m.y>E!=m.next.y>E&&m.next.y!==m.y&&x<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(v=!v),m=m.next;while(m!==c);return v}(l,s)&&(ur(l.prev,l,s.prev)||ur(l,s.prev,s))||Z0(l,s)&&ur(l.prev,l,l.next)>0&&ur(s.prev,s,s.next)>0)}function ur(l,s,c){return(s.y-l.y)*(c.x-s.x)-(s.x-l.x)*(c.y-s.y)}function Z0(l,s){return l.x===s.x&&l.y===s.y}function WM(l,s,c,h){var m=K0(ur(l,s,c)),v=K0(ur(l,s,h)),x=K0(ur(c,h,l)),E=K0(ur(c,h,s));return m!==v&&x!==E||!(m!==0||!X0(l,c,s))||!(v!==0||!X0(l,h,s))||!(x!==0||!X0(c,l,h))||!(E!==0||!X0(c,s,h))}function X0(l,s,c){return s.x<=Math.max(l.x,c.x)&&s.x>=Math.min(l.x,c.x)&&s.y<=Math.max(l.y,c.y)&&s.y>=Math.min(l.y,c.y)}function K0(l){return l>0?1:l<0?-1:0}function Dg(l,s){return ur(l.prev,l,l.next)<0?ur(l,s,l.next)>=0&&ur(l,l.prev,s)>=0:ur(l,s,l.prev)<0||ur(l,l.next,s)<0}function GM(l,s){var c=new vS(l.i,l.x,l.y),h=new vS(s.i,s.x,s.y),m=l.next,v=s.prev;return l.next=s,s.prev=l,c.next=m,m.prev=c,h.next=c,c.prev=h,v.next=h,h.prev=v,h}function HM(l,s,c,h){var m=new vS(l,s,c);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function Rg(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function vS(l,s,c){this.i=l,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function bS(l,s,c,h){for(var m=0,v=s,x=c-h;v<c;v+=h)m+=(l[x]-l[v])*(l[v+1]+l[x+1]),x=v;return m}gS.exports=H0,gS.exports.default=H0,H0.deviation=function(l,s,c,h){var m=s&&s.length,v=Math.abs(bS(l,0,m?s[0]*c:l.length,c));if(m)for(var x=0,E=s.length;x<E;x++)v-=Math.abs(bS(l,s[x]*c,x<E-1?s[x+1]*c:l.length,c));var C=0;for(x=0;x<h.length;x+=3){var I=h[x]*c,O=h[x+1]*c,L=h[x+2]*c;C+=Math.abs((l[I]-l[L])*(l[O+1]-l[I+1])-(l[I]-l[O])*(l[L+1]-l[I+1]))}return v===0&&C===0?0:Math.abs((C-v)/v)},H0.flatten=function(l){for(var s=l[0][0].length,c={vertices:[],holes:[],dimensions:s},h=0,m=0;m<l.length;m++){for(var v=0;v<l[m].length;v++)for(var x=0;x<s;x++)c.vertices.push(l[m][v][x]);m>0&&c.holes.push(h+=l[m-1].length)}return c};var _S=q(gS.exports);function aU(l,s,c,h,m){ZM(l,s,c||0,h||l.length-1,m||lU)}function ZM(l,s,c,h,m){for(;h>c;){if(h-c>600){var v=h-c+1,x=s-c+1,E=Math.log(v),C=.5*Math.exp(2*E/3),I=.5*Math.sqrt(E*C*(v-C)/v)*(x-v/2<0?-1:1);ZM(l,s,Math.max(c,Math.floor(s-x*C/v+I)),Math.min(h,Math.floor(s+(v-x)*C/v+I)),m)}var O=l[s],L=c,B=h;for(Lg(l,c,s),m(l[h],O)>0&&Lg(l,c,h);L<B;){for(Lg(l,L,B),L++,B--;m(l[L],O)<0;)L++;for(;m(l[B],O)>0;)B--}m(l[c],O)===0?Lg(l,c,B):Lg(l,++B,h),B<=s&&(c=B+1),s<=B&&(h=B-1)}}function Lg(l,s,c){var h=l[s];l[s]=l[c],l[c]=h}function lU(l,s){return l<s?-1:l>s?1:0}function xS(l,s){const c=l.length;if(c<=1)return[l];const h=[];let m,v;for(let x=0;x<c;x++){const E=Hs(l[x]);E!==0&&(l[x].area=Math.abs(E),v===void 0&&(v=E<0),v===E<0?(m&&h.push(m),m=[l[x]]):m.push(l[x]))}if(m&&h.push(m),s>1)for(let x=0;x<h.length;x++)h[x].length<=s||(aU(h[x],s,1,h[x].length-1,cU),h[x]=h[x].slice(0,s));return h}function cU(l,s){return s.area-l.area}function wS(l,s,c){const h=c.patternDependencies;let m=!1;for(const v of s){const x=v.paint.get(`${l}-pattern`);x.isConstant()||(m=!0);const E=x.constantOr(null);E&&(m=!0,h[E]=!0)}return m}function SS(l,s,c,h,m){const v=m.patternDependencies;for(const x of s){const E=x.paint.get(`${l}-pattern`).value;if(E.kind!=="constant"){let C=E.evaluate({zoom:h},c,{},m.availableImages);C=C&&C.name?C.name:C,v[C]=!0,c.patterns[x.id]=C}}return c}class Y0{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new St,this.indexArray=new tn,this.indexArray2=new Lr,this.programConfigurations=new Md(s.layers,s.zoom),this.segments=new cr,this.segments2=new cr,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection}populate(s,c,h,m){this.hasPattern=wS("fill",this.layers,c);const v=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:E,id:C,index:I,sourceLayerIndex:O}of s){const L=this.layers[0]._featureFilter.needGeometry,B=zd(E,L);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),B,h))continue;const j=v?v.evaluate(B,{},h,c.availableImages):void 0,U={id:C,properties:E.properties,type:E.type,sourceLayerIndex:O,index:I,geometry:L?B.geometry:Kl(E,h,m),patterns:{},sortKey:j};x.push(U)}v&&x.sort((E,C)=>E.sortKey-C.sortKey);for(const E of x){const{geometry:C,index:I,sourceLayerIndex:O}=E;if(this.hasPattern){const L=SS("fill",this.layers,E,this.zoom,c);this.patternFeatures.push(L)}else this.addFeature(E,C,I,h,{},c.availableImages);c.featureIndex.insert(s[I].feature,C,I,O,this.index)}}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}addFeatures(s,c,h,m,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,YV),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,h,m,v,x=[]){for(const E of xS(c,500)){let C=0;for(const U of E)C+=U.length;const I=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),O=I.vertexLength,L=[],B=[];for(const U of E){if(U.length===0)continue;U!==E[0]&&B.push(L.length/2);const X=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),re=X.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(re+U.length-1,re),L.push(U[0].x),L.push(U[0].y);for(let he=1;he<U.length;he++)this.layoutVertexArray.emplaceBack(U[he].x,U[he].y),this.indexArray2.emplaceBack(re+he-1,re+he),L.push(U[he].x),L.push(U[he].y);X.vertexLength+=U.length,X.primitiveLength+=U.length}const j=_S(L,B);for(let U=0;U<j.length;U+=3)this.indexArray.emplaceBack(O+j[U],O+j[U+1],O+j[U+2]);I.vertexLength+=C,I.primitiveLength+=j.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,v,x,m)}}Kt(Y0,"FillBucket",{omit:["layers","patternFeatures"]});const uU=new ye({"fill-sort-key":new oe(st.layout_fill["fill-sort-key"])});var dU={paint:new ye({"fill-antialias":new Z(st.paint_fill["fill-antialias"]),"fill-opacity":new oe(st.paint_fill["fill-opacity"]),"fill-color":new oe(st.paint_fill["fill-color"]),"fill-outline-color":new oe(st.paint_fill["fill-outline-color"]),"fill-translate":new Z(st.paint_fill["fill-translate"]),"fill-translate-anchor":new Z(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new oe(st.paint_fill["fill-pattern"])}),layout:uU};const hU=Re([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),fU=Re([{name:"a_centroid_pos",components:2,type:"Uint16"}]),pU=Re([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:mU}=hU;var J0={},gU=Q,XM=Mf;function Mf(l,s,c,h,m){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=h,this._values=m,l.readFields(yU,this,s)}function yU(l,s,c){l==1?s.id=c.readVarint():l==2?function(h,m){for(var v=h.readVarint()+h.pos;h.pos<v;){var x=m._keys[h.readVarint()],E=m._values[h.readVarint()];m.properties[x]=E}}(c,s):l==3?s.type=c.readVarint():l==4&&(s._geometry=c.pos)}function vU(l){for(var s,c,h=0,m=0,v=l.length,x=v-1;m<v;x=m++)h+=((c=l[x]).x-(s=l[m]).x)*(s.y+c.y);return h}Mf.types=["Unknown","Point","LineString","Polygon"],Mf.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var s,c=l.readVarint()+l.pos,h=1,m=0,v=0,x=0,E=[];l.pos<c;){if(m<=0){var C=l.readVarint();h=7&C,m=C>>3}if(m--,h===1||h===2)v+=l.readSVarint(),x+=l.readSVarint(),h===1&&(s&&E.push(s),s=[]),s.push(new gU(v,x));else{if(h!==7)throw new Error("unknown command "+h);s&&s.push(s[0].clone())}}return s&&E.push(s),E},Mf.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var s=l.readVarint()+l.pos,c=1,h=0,m=0,v=0,x=1/0,E=-1/0,C=1/0,I=-1/0;l.pos<s;){if(h<=0){var O=l.readVarint();c=7&O,h=O>>3}if(h--,c===1||c===2)(m+=l.readSVarint())<x&&(x=m),m>E&&(E=m),(v+=l.readSVarint())<C&&(C=v),v>I&&(I=v);else if(c!==7)throw new Error("unknown command "+c)}return[x,C,E,I]},Mf.prototype.toGeoJSON=function(l,s,c){var h,m,v=this.extent*Math.pow(2,c),x=this.extent*l,E=this.extent*s,C=this.loadGeometry(),I=Mf.types[this.type];function O(j){for(var U=0;U<j.length;U++){var X=j[U];j[U]=[360*(X.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(X.y+E)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(h=0;h<C.length;h++)L[h]=C[h][0];O(C=L);break;case 2:for(h=0;h<C.length;h++)O(C[h]);break;case 3:for(C=function(j){var U=j.length;if(U<=1)return[j];for(var X,re,he=[],xe=0;xe<U;xe++){var fe=vU(j[xe]);fe!==0&&(re===void 0&&(re=fe<0),re===fe<0?(X&&he.push(X),X=[j[xe]]):X.push(j[xe]))}return X&&he.push(X),he}(C),h=0;h<C.length;h++)for(m=0;m<C[h].length;m++)O(C[h][m])}C.length===1?C=C[0]:I="Multi"+I;var B={type:"Feature",geometry:{type:I,coordinates:C},properties:this.properties};return"id"in this&&(B.id=this.id),B};var bU=XM,KM=YM;function YM(l,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(_U,this,s),this.length=this._features.length}function _U(l,s,c){l===15?s.version=c.readVarint():l===1?s.name=c.readString():l===5?s.extent=c.readVarint():l===2?s._features.push(c.pos):l===3?s._keys.push(c.readString()):l===4&&s._values.push(function(h){for(var m=null,v=h.readVarint()+h.pos;h.pos<v;){var x=h.readVarint()>>3;m=x===1?h.readString():x===2?h.readFloat():x===3?h.readDouble():x===4?h.readVarint64():x===5?h.readVarint():x===6?h.readSVarint():x===7?h.readBoolean():null}return m}(c))}YM.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var s=this._pbf.readVarint()+this._pbf.pos;return new bU(this._pbf,s,this.extent,this._keys,this._values)};var xU=KM;function wU(l,s,c){if(l===3){var h=new xU(c,c.readVarint()+c.pos);h.length&&(s[h.name]=h)}}var ES=J0.VectorTile=function(l,s){this.layers=l.readFields(wU,{},s)},Q0=J0.VectorTileFeature=XM;function eb(l,s,c,h){const m=[],v=h===0?(x,E,C,I,O,L)=>{x.push(new te(L,C+(L-E)/(I-E)*(O-C)))}:(x,E,C,I,O,L)=>{x.push(new te(E+(L-C)/(O-C)*(I-E),L))};for(const x of l){const E=[];for(const C of x){if(C.length<=2)continue;const I=[];for(let B=0;B<C.length-1;B++){const j=C[B].x,U=C[B].y,X=C[B+1].x,re=C[B+1].y,he=h===0?j:U,xe=h===0?X:re;he<s?xe>s&&v(I,j,U,X,re,s):he>c?xe<c&&v(I,j,U,X,re,c):I.push(C[B]),xe<s&&he>=s&&v(I,j,U,X,re,s),xe>c&&he<=c&&v(I,j,U,X,re,c)}let O=C[C.length-1];const L=h===0?O.x:O.y;L>=s&&L<=c&&I.push(O),I.length&&(O=I[I.length-1],I[0].x===O.x&&I[0].y===O.y||I.push(I[0]),E.push(I))}E.length&&m.push(E)}return m}J0.VectorTileLayer=KM;const SU=Q0.types,EU=Math.pow(2,13);function zg(l,s,c,h,m,v,x,E){l.emplaceBack((s<<1)+x,(c<<1)+v,(Math.floor(h*EU)<<1)+m,Math.round(E))}function Bg(l,s,c){l.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}class JM{constructor(){this.acc=new te(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new te(s.x,s.y),this.max=new te(s.x,s.y))}append(s,c){this.currentPolyCount.edges++,this.acc._add(s);const h=this.min,m=this.max;s.x<h.x?h.x=s.x:s.x>m.x&&(m.x=s.x),s.y<h.y?h.y=s.y:s.y>m.y&&(m.y=s.y),((s.x===0||s.x===ln)&&s.x===c.x)!=((s.y===0||s.y===ln)&&s.y===c.y)&&this.processBorderOverlap(s,c),c.x<0!=s.x<0&&this.addBorderIntersection(0,Vn(c.y,s.y,(0-c.x)/(s.x-c.x))),c.x>ln!=s.x>ln&&this.addBorderIntersection(1,Vn(c.y,s.y,(ln-c.x)/(s.x-c.x))),c.y<0!=s.y<0&&this.addBorderIntersection(2,Vn(c.x,s.x,(0-c.y)/(s.y-c.y))),c.y>ln!=s.y>ln&&this.addBorderIntersection(3,Vn(c.x,s.x,(ln-c.y)/(s.y-c.y)))}addBorderIntersection(s,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[s];c<h[0]&&(h[0]=c),c>h[1]&&(h[1]=c)}processBorderOverlap(s,c){if(s.x===c.x){if(s.y===c.y)return;const h=s.x===0?0:1;this.addBorderIntersection(h,c.y),this.addBorderIntersection(h,s.y)}else{const h=s.y===0?2:3;this.addBorderIntersection(h,c.x),this.addBorderIntersection(h,s.x)}}centroid(){const s=this.polyCount.reduce((c,h)=>c+h.edges,0);return s!==0?this.acc.div(s)._round():new te(0,0)}span(){return new te(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,c)=>s+ +(c[0]!==Number.MAX_VALUE),0)}}class Fg{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new ut,this.centroidVertexArray=new Ta,this.indexArray=new tn,this.programConfigurations=new Md(s.layers,s.zoom),this.segments=new cr,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=s.enableTerrain}populate(s,c,h,m){this.features=[],this.hasPattern=wS("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(v){const x=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*x/(x*x+1)/ln/(1<<v.z)}(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:x,index:E,sourceLayerIndex:C}of s){const I=this.layers[0]._featureFilter.needGeometry,O=zd(v,I);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),O,h))continue;const L={id:x,sourceLayerIndex:C,index:E,geometry:I?O.geometry:Kl(v,h,m),properties:v.properties,type:v.type,patterns:{}},B=this.layoutVertexArray.length;this.hasPattern?this.features.push(SS("fill-extrusion",this.layers,L,this.zoom,c)):this.addFeature(L,L.geometry,E,h,{},c.availableImages,m),c.featureIndex.insert(v,L.geometry,E,C,this.index,B)}this.sortBorders()}addFeatures(s,c,h,m,v){for(const x of this.features){const{geometry:E}=x;this.addFeature(x,E,x.index,c,h,m,v)}this.sortBorders()}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,mU),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,pU.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,fU.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,h,m,v,x,E){const C=[new te(0,0),new te(ln,ln)],I=E.projection,O=I.name==="globe",L=this.enableTerrain&&!O?new JM:null,B=SU[s.type]==="Polygon";O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Tt);const j=xS(c,500);for(let he=j.length-1;he>=0;he--){const xe=j[he];(xe.length===0||(U=xe[0]).every(fe=>fe.x<=0)||U.every(fe=>fe.x>=ln)||U.every(fe=>fe.y<=0)||U.every(fe=>fe.y>=ln))&&j.splice(he,1)}var U;let X;if(O)X=oP(j,C,m);else{X=[];for(const he of j)X.push({polygon:he,bounds:C})}const re=B?this.edgeRadius:0;for(const{polygon:he,bounds:xe}of X){let fe=0,be=0;for(const we of he)B&&!we[0].equals(we[we.length-1])&&we.push(we[0]),be+=B?we.length-1:we.length;const Se=this.segments.prepareSegment((B?5:4)*be,this.layoutVertexArray,this.indexArray);if(B){const we=[],He=[];fe=Se.vertexLength;for(const at of he){let Et,Je;at.length&&at!==he[0]&&He.push(we.length/2),Et=at[1].sub(at[0])._perp()._unit();for(let dt=1;dt<at.length;dt++){const ht=at[dt],vt=at[dt===at.length-1?1:dt+1];let{x:Pt,y:it}=ht;if(re){Je=vt.sub(ht)._perp()._unit();const Vt=Et.add(Je)._unit(),Jt=re*Math.min(4,1/(Et.x*Vt.x+Et.y*Vt.y));Pt+=Jt*Vt.x,it+=Jt*Vt.y,Et=Je}zg(this.layoutVertexArray,Pt,it,0,0,1,1,0),Se.vertexLength++,we.push(ht.x,ht.y),O&&Bg(this.layoutVertexExtArray,I.projectTilePoint(Pt,it,m),I.upVector(m,Pt,it))}}const Ue=_S(we,He);for(let at=0;at<Ue.length;at+=3)this.indexArray.emplaceBack(fe+Ue[at],fe+Ue[at+2],fe+Ue[at+1]),Se.primitiveLength++}for(const we of he){L&&we.length&&L.startRing(we[0]);let He,Ue,at,Et=we.length>4&&nP(we[we.length-2],we[0],we[1]),Je=re?kU(we[we.length-2],we[0],we[1],re):0;Ue=we[1].sub(we[0])._perp()._unit();let dt=!0;for(let ht=1,vt=0;ht<we.length;ht++){let Pt=we[ht-1],it=we[ht];const Vt=we[ht===we.length-1?1:ht+1];if(L&&B&&L.currentPolyCount.top++,tP(it,Pt,xe)){re&&(Ue=Vt.sub(it)._perp()._unit(),dt=!dt);continue}L&&L.append(it,Pt);const Jt=it.sub(Pt)._perp(),qt=Jt.x/(Math.abs(Jt.x)+Math.abs(Jt.y)),xn=Jt.y>0?1:0,Dt=Pt.dist(it);if(vt+Dt>32768&&(vt=0),re){at=Vt.sub(it)._perp()._unit();let Sn=eP(Pt,it,Vt,QM(Ue,at),re);isNaN(Sn)&&(Sn=0);const fn=it.sub(Pt)._unit();Pt=Pt.add(fn.mult(Je))._round(),it=it.add(fn.mult(-Sn))._round(),Je=Sn,Ue=at}const on=Se.vertexLength,wn=we.length>4&&nP(Pt,it,Vt);let qn=iP(vt,Et,dt);if(zg(this.layoutVertexArray,Pt.x,Pt.y,qt,xn,0,0,qn),zg(this.layoutVertexArray,Pt.x,Pt.y,qt,xn,0,1,qn),vt+=Dt,qn=iP(vt,wn,!dt),Et=wn,zg(this.layoutVertexArray,it.x,it.y,qt,xn,0,0,qn),zg(this.layoutVertexArray,it.x,it.y,qt,xn,0,1,qn),Se.vertexLength+=4,this.indexArray.emplaceBack(on+0,on+1,on+2),this.indexArray.emplaceBack(on+1,on+3,on+2),Se.primitiveLength+=2,re){const Sn=fe+(ht===1?we.length-2:ht-2),fn=ht===1?fe:Sn+1;if(this.indexArray.emplaceBack(on+1,Sn,on+3),this.indexArray.emplaceBack(Sn,fn,on+3),Se.primitiveLength+=2,He===void 0&&(He=on),!tP(Vt,we[ht],xe)){const bi=ht===we.length-1?He:Se.vertexLength;this.indexArray.emplaceBack(on+2,on+3,bi),this.indexArray.emplaceBack(on+3,bi+1,bi),this.indexArray.emplaceBack(on+3,fn,bi+1),Se.primitiveLength+=3}dt=!dt}if(O){const Sn=this.layoutVertexExtArray,fn=I.projectTilePoint(Pt.x,Pt.y,m),bi=I.projectTilePoint(it.x,it.y,m),kn=I.upVector(m,Pt.x,Pt.y),Tn=I.upVector(m,it.x,it.y);Bg(Sn,fn,kn),Bg(Sn,fn,kn),Bg(Sn,bi,Tn),Bg(Sn,bi,Tn)}}B&&(fe+=we.length-1)}}if(L&&L.polyCount.length>0){if(L.borders){L.vertexArrayOffset=this.centroidVertexArray.length;const he=L.borders,xe=this.featuresOnBorder.push(L)-1;for(let fe=0;fe<4;fe++)he[fe][0]!==Number.MAX_VALUE&&this.borders[fe].push(xe)}this.encodeCentroid(L.borders?void 0:L.centroid(),L)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,v,x,m)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((c,h)=>this.featuresOnBorder[c].borders[s][0]-this.featuresOnBorder[h].borders[s][0])}encodeCentroid(s,c,h=!0){let m,v;if(s)if(s.y!==0){const E=c.span()._mult(this.tileToMeter);m=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(E.x/10)),v=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else m=Math.ceil(7*(s.x+450)),v=0;else m=0,v=+h;let x=h?this.centroidVertexArray.length:c.vertexArrayOffset;for(const E of c.polyCount){h&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let C=0;C<E.top;C++)this.centroidVertexArray.emplace(x++,m,v);for(let C=0;C<2*E.edges;C++)this.centroidVertexArray.emplace(x++,0,v),this.centroidVertexArray.emplace(x++,m,v)}}}function QM(l,s){const c=l.add(s)._unit();return l.x*c.x+l.y*c.y}function kU(l,s,c,h){const m=s.sub(l)._perp()._unit(),v=c.sub(s)._perp()._unit();return eP(l,s,c,QM(m,v),h)}function eP(l,s,c,h,m){const v=Math.sqrt(1-h*h);return Math.min(l.dist(s)/3,s.dist(c)/3,m*v/h)}function tP(l,s,c){return l.x<c[0].x&&s.x<c[0].x||l.x>c[1].x&&s.x>c[1].x||l.y<c[0].y&&s.y<c[0].y||l.y>c[1].y&&s.y>c[1].y}function nP(l,s,c){if(l.x<0||l.x>=ln||s.x<0||s.x>=ln||c.x<0||c.x>=ln)return!1;const h=c.sub(s),m=h.perp(),v=l.sub(s);return(h.x*v.x+h.y*v.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(v.x*v.x+v.y*v.y))>-.866&&m.x*v.x+m.y*v.y<0}function iP(l,s,c){const h=s?2|l:-3&l;return c?1|h:-2&h}function rP(){const l=Math.PI/32,s=Math.tan(l),c=Pg;return c*Math.sqrt(1+2*s*s)-c}function oP(l,s,c){const h=1<<c.z,m=As(c.x/h),v=As((c.x+1)/h),x=eo(c.y/h),E=eo((c.y+1)/h);return function(C,I,O,L,B=0,j){const U=[];if(!C.length||!O||!L)return U;const X=(we,He)=>{for(const Ue of we)U.push({polygon:Ue,bounds:He})},re=Math.ceil(Math.log2(O)),he=Math.ceil(Math.log2(L)),xe=re-he,fe=[];for(let we=0;we<Math.abs(xe);we++)fe.push(xe>0?0:1);for(let we=0;we<Math.min(re,he);we++)fe.push(0),fe.push(1);let be=C;if(be=eb(be,I[0].y-B,I[1].y+B,1),be=eb(be,I[0].x-B,I[1].x+B,0),!be.length)return U;const Se=[];for(fe.length?Se.push({polygons:be,bounds:I,depth:0}):X(be,I);Se.length;){const we=Se.pop(),He=we.depth,Ue=fe[He],at=we.bounds[0],Et=we.bounds[1],Je=Ue===0?at.x:at.y,dt=Ue===0?Et.x:Et.y,ht=j?j(Ue,Je,dt):.5*(Je+dt),vt=eb(we.polygons,Je-B,ht+B,Ue),Pt=eb(we.polygons,ht-B,dt+B,Ue);if(vt.length){const it=[at,new te(Ue===0?ht:Et.x,Ue===1?ht:Et.y)];fe.length>He+1?Se.push({polygons:vt,bounds:it,depth:He+1}):X(vt,it)}if(Pt.length){const it=[new te(Ue===0?ht:at.x,Ue===1?ht:at.y),Et];fe.length>He+1?Se.push({polygons:Pt,bounds:it,depth:He+1}):X(Pt,it)}}return U}(l,s,Math.ceil((v-m)/11.25),Math.ceil((x-E)/11.25),1,(C,I,O)=>{if(C===0)return .5*(I+O);{const L=eo((c.y+I/ln)/h);return(dl(.5*(eo((c.y+O/ln)/h)+L))*h-c.y)*ln}})}Kt(Fg,"FillExtrusionBucket",{omit:["layers","features"]}),Kt(JM,"PartMetadata");const TU=new ye({"fill-extrusion-edge-radius":new Z(st["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var CU={paint:new ye({"fill-extrusion-opacity":new Z(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new oe(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Z(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Z(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new oe(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new oe(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new oe(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Z(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Z(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Z(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Z(st["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:TU};function sP(l,s,c){var h=2*Math.PI*6378137/256/Math.pow(2,c);return[l*h-2*Math.PI*6378137/2,s*h-2*Math.PI*6378137/2]}class tb{constructor(s,c,h){this.z=s,this.x=c,this.y=h,this.key=Ng(0,s,s,c,h)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c){const h=function(v,x,E){var C=sP(256*v,256*(x=Math.pow(2,E)-x-1),E),I=sP(256*(v+1),256*(x+1),E);return C[0]+","+C[1]+","+I[0]+","+I[1]}(this.x,this.y,this.z),m=function(v,x,E){let C,I="";for(let O=v;O>0;O--)C=1<<O-1,I+=(x&C?1:0)+(E&C?2:0);return I}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class aP{constructor(s,c){this.wrap=s,this.canonical=c,this.key=Ng(s,c.z,c.z,c.x,c.y)}}class Io{constructor(s,c,h,m,v){this.overscaledZ=s,this.wrap=c,this.canonical=new tb(h,+m,+v),this.key=c===0&&s===h?this.canonical.key:Ng(c,s,h,m,v)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const c=this.canonical.z-s;return s>this.canonical.z?new Io(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Io(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c=!0){if(this.overscaledZ===s&&c)return this.key;if(s>this.canonical.z)return Ng(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-s;return Ng(this.wrap*+c,s,s,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new Io(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new Io(c,this.wrap,c,h,m),new Io(c,this.wrap,c,h+1,m),new Io(c,this.wrap,c,h,m+1),new Io(c,this.wrap,c,h+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Io(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Io(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new aP(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ng(l,s,c,h,m){const v=1<<Math.min(c,22);let x=v*(m%v)+h%v;return l&&c<22&&(x+=v*v*((l<0?-2*l-1:2*l)%(1<<2*(22-c)))),16*(32*x+c)+(s-c)}Kt(tb,"CanonicalTileID"),Kt(Io,"OverscaledTileID",{omit:["projMatrix"]});class Pf extends te{constructor(s,c,h){super(s,c),this.z=h}}function $g(l,s){return l.x*s.x+l.y*s.y}function lP(l,s){if(l.length===1){let c=0;const h=s[c++];let m;for(;!m||h.equals(m);)if(m=s[c++],!m)return 1/0;for(;c<s.length;c++){const v=s[c],x=l[0],E=m.sub(h),C=v.sub(h),I=x.sub(h),O=$g(E,E),L=$g(E,C),B=$g(C,C),j=$g(I,E),U=$g(I,C),X=O*B-L*L,re=(B*j-L*U)/X,he=(O*U-L*j)/X,xe=h.z*(1-re-he)+m.z*re+v.z*he;if(isFinite(xe))return xe}return 1/0}{let c=1/0;for(const h of s)c=Math.min(c,h.z);return c}}function cP(l,s,c,h,m,v,x,E){const C=x*m.getElevationAt(l,s,!0,!0),I=v[0]!==0,O=I?v[1]===0?x*(v[0]/7-450):x*function(L,B,j){const U=Math.floor(B[0]/8),X=Math.floor(B[1]/8),re=10*(B[0]-8*U),he=10*(B[1]-8*X),xe=L.getElevationAt(U,X,!0,!0),fe=L.getMeterToDEM(j),be=Math.floor(.5*(re*fe-1)),Se=Math.floor(.5*(he*fe-1)),we=L.tileCoordToPixel(U,X),He=2*be+1,Ue=2*Se+1,at=function(Pt,it,Vt,Jt,qt){return[Pt.getElevationAtPixel(it,Vt,!0),Pt.getElevationAtPixel(it+qt,Vt,!0),Pt.getElevationAtPixel(it,Vt+qt,!0),Pt.getElevationAtPixel(it+Jt,Vt+qt,!0)]}(L,we.x-be,we.y-Se,He,Ue),Et=Math.abs(at[0]-at[1]),Je=Math.abs(at[2]-at[3]),dt=Math.abs(at[0]-at[2])+Math.abs(at[1]-at[3]),ht=Math.min(.25,.5*fe*(Et+Je)/He),vt=Math.min(.25,.5*fe*dt/Ue);return xe+Math.max(ht*re,vt*he)}(m,v,E):C;return{base:C+(c===0)?-1:c,top:I?Math.max(O+h,C+c+2):C+h}}const IU=Re([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:AU}=IU,MU=Re([{name:"a_packed",components:4,type:"Float32"}]),{members:PU}=MU,OU=Q0.types,DU=Math.cos(Math.PI/180*37.5);class nb{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Ye,this.layoutVertexArray2=new bt,this.indexArray=new tn,this.programConfigurations=new Md(s.layers,s.zoom),this.segments=new cr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,h,m){this.hasPattern=wS("line",this.layers,c);const v=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:O,id:L,index:B,sourceLayerIndex:j}of s){const U=this.layers[0]._featureFilter.needGeometry,X=zd(O,U);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),X,h))continue;const re=v?v.evaluate(X,{},h):void 0,he={id:L,properties:O.properties,type:O.type,sourceLayerIndex:j,index:B,geometry:U?X.geometry:Kl(O,h,m),patterns:{},sortKey:re};x.push(he)}v&&x.sort((O,L)=>O.sortKey-L.sortKey);const{lineAtlas:E,featureIndex:C}=c,I=this.addConstantDashes(E);for(const O of x){const{geometry:L,index:B,sourceLayerIndex:j}=O;if(I&&this.addFeatureDashes(O,E),this.hasPattern){const U=SS("line",this.layers,O,this.zoom,c);this.patternFeatures.push(U)}else this.addFeature(O,L,B,h,E.positions,c.availableImages);C.insert(s[B].feature,L,B,j,this.index)}}addConstantDashes(s){let c=!1;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,v=h.layout.get("line-cap").value;if(m.kind!=="constant"||v.kind!=="constant")c=!0;else{const x=v.value,E=m.value;if(!E)continue;s.addDash(E,x)}}return c}addFeatureDashes(s,c){const h=this.zoom;for(const m of this.layers){const v=m.paint.get("line-dasharray").value,x=m.layout.get("line-cap").value;if(v.kind==="constant"&&x.kind==="constant")continue;let E,C;if(v.kind==="constant"){if(E=v.value,!E)continue}else E=v.evaluate({zoom:h},s);C=x.kind==="constant"?x.value:x.evaluate({zoom:h},s),c.addDash(E,C),s.patterns[m.id]=c.getKey(E,C)}}update(s,c,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,h,m)}addFeatures(s,c,h,m,v){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,h,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,PU)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,AU),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,h,m,v,x){const E=this.layers[0].layout,C=E.get("line-join").evaluate(s,{}),I=E.get("line-cap").evaluate(s,{}),O=E.get("line-miter-limit"),L=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const B of c)this.addLine(B,s,C,I,O,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,h,v,x,m)}addLine(s,c,h,m,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let he=0;he<s.length-1;he++)this.totalDistance+=s[he].dist(s[he+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=OU[c.type]==="Polygon";let C=s.length;for(;C>=2&&s[C-1].equals(s[C-2]);)C--;let I=0;for(;I<C-1&&s[I].equals(s[I+1]);)I++;if(C<(E?3:2))return;h==="bevel"&&(v=1.05);const O=this.overscaling<=16?15*ln/(512*this.overscaling):0,L=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let B,j,U,X,re;this.e1=this.e2=-1,E&&(B=s[C-2],re=s[I].sub(B)._unit()._perp());for(let he=I;he<C;he++){if(U=he===C-1?E?s[I+1]:void 0:s[he+1],U&&s[he].equals(U))continue;re&&(X=re),B&&(j=B),B=s[he],re=U?U.sub(B)._unit()._perp():X,X=X||re;let xe=X.add(re);xe.x===0&&xe.y===0||xe._unit();const fe=X.x*re.x+X.y*re.y,be=xe.x*re.x+xe.y*re.y,Se=be!==0?1/be:1/0,we=2*Math.sqrt(2-2*be),He=be<DU&&j&&U,Ue=X.x*re.y-X.y*re.x>0;if(He&&he>I){const Je=B.dist(j);if(Je>2*O){const dt=B.sub(B.sub(j)._mult(O/Je)._round());this.updateDistance(j,dt),this.addCurrentVertex(dt,X,0,0,L),j=dt}}const at=j&&U;let Et=at?h:E?"butt":m;if(at&&Et==="round"&&(Se<x?Et="miter":Se<=2&&(Et="fakeround")),Et==="miter"&&Se>v&&(Et="bevel"),Et==="bevel"&&(Se>2&&(Et="flipbevel"),Se<v&&(Et="miter")),j&&this.updateDistance(j,B),Et==="miter")xe._mult(Se),this.addCurrentVertex(B,xe,0,0,L);else if(Et==="flipbevel"){if(Se>100)xe=re.mult(-1);else{const Je=Se*X.add(re).mag()/X.sub(re).mag();xe._perp()._mult(Je*(Ue?-1:1))}this.addCurrentVertex(B,xe,0,0,L),this.addCurrentVertex(B,xe.mult(-1),0,0,L)}else if(Et==="bevel"||Et==="fakeround"){const Je=-Math.sqrt(Se*Se-1),dt=Ue?Je:0,ht=Ue?0:Je;if(j&&this.addCurrentVertex(B,X,dt,ht,L),Et==="fakeround"){const vt=Math.round(180*we/Math.PI/20);for(let Pt=1;Pt<vt;Pt++){let it=Pt/vt;if(it!==.5){const Jt=it-.5;it+=it*Jt*(it-1)*((1.0904+fe*(fe*(3.55645-1.43519*fe)-3.2452))*Jt*Jt+(.848013+fe*(.215638*fe-1.06021)))}const Vt=re.sub(X)._mult(it)._add(X)._unit()._mult(Ue?-1:1);this.addHalfVertex(B,Vt.x,Vt.y,!1,Ue,0,L)}}U&&this.addCurrentVertex(B,re,-dt,-ht,L)}else if(Et==="butt")this.addCurrentVertex(B,xe,0,0,L);else if(Et==="square"){const Je=j?1:-1;j||this.addCurrentVertex(B,xe,Je,Je,L),this.addCurrentVertex(B,xe,0,0,L),j&&this.addCurrentVertex(B,xe,Je,Je,L)}else Et==="round"&&(j&&(this.addCurrentVertex(B,X,0,0,L),this.addCurrentVertex(B,X,1,1,L,!0)),U&&(this.addCurrentVertex(B,re,-1,-1,L,!0),this.addCurrentVertex(B,re,0,0,L)));if(He&&he<C-1){const Je=B.dist(U);if(Je>2*O){const dt=B.add(U.sub(B)._mult(O/Je)._round());this.updateDistance(B,dt),this.addCurrentVertex(dt,re,0,0,L),B=dt}}}}addCurrentVertex(s,c,h,m,v,x=!1){const E=c.y*m-c.x,C=-c.y-c.x*m;this.addHalfVertex(s,c.x+c.y*h,c.y-c.x*h,x,!1,h,v),this.addHalfVertex(s,E,C,x,!0,-m,v)}addHalfVertex({x:s,y:c},h,m,v,x,E,C){this.layoutVertexArray.emplaceBack((s<<1)+(v?1:0),(c<<1)+(x?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const I=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),C.primitiveLength++),x?this.e2=I:this.e1=I}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,c){this.distance+=s.dist(c),this.updateScaledDistance()}}Kt(nb,"LineBucket",{omit:["layers","patternFeatures"]});const RU=new ye({"line-cap":new oe(st.layout_line["line-cap"]),"line-join":new oe(st.layout_line["line-join"]),"line-miter-limit":new Z(st.layout_line["line-miter-limit"]),"line-round-limit":new Z(st.layout_line["line-round-limit"]),"line-sort-key":new oe(st.layout_line["line-sort-key"])});var uP={paint:new ye({"line-opacity":new oe(st.paint_line["line-opacity"]),"line-color":new oe(st.paint_line["line-color"]),"line-translate":new Z(st.paint_line["line-translate"]),"line-translate-anchor":new Z(st.paint_line["line-translate-anchor"]),"line-width":new oe(st.paint_line["line-width"]),"line-gap-width":new oe(st.paint_line["line-gap-width"]),"line-offset":new oe(st.paint_line["line-offset"]),"line-blur":new oe(st.paint_line["line-blur"]),"line-dasharray":new oe(st.paint_line["line-dasharray"]),"line-pattern":new oe(st.paint_line["line-pattern"]),"line-gradient":new ge(st.paint_line["line-gradient"]),"line-trim-offset":new Z(st.paint_line["line-trim-offset"])}),layout:RU};const dP=new class extends oe{possiblyEvaluate(l,s){return s=new R(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(l,s)}evaluate(l,s,c,h){return s=Nt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(l,s,c,h)}}(uP.paint.properties["line-width"].specification);function hP(l,s){return s>0?s+2*l:l}dP.useIntegerZoom=!0;const LU=Re([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),zU=Re([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),BU=Re([{name:"a_projected_pos",components:4,type:"Float32"}],4);Re([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const FU=Re([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),NU=Re([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Re([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const fP=Re([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$U=Re([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Re([{name:"triangle",components:3,type:"Uint16"}]),Re([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Re([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Re([{type:"Float32",name:"offsetX"}]),Re([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Gr=24;const Oa=128;function kS(l,s){const{expression:c}=s;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new R(l+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:m}=c;let v=0;for(;v<h.length&&h[v]<=l;)v++;v=Math.max(0,v-1);let x=v;for(;x<h.length&&h[x]<l+1;)x++;x=Math.min(h.length-1,x);const E=h[v],C=h[x];return c.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:C,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:C,minSize:c.evaluate(new R(E)),maxSize:c.evaluate(new R(C)),interpolationType:m}}}function ib(l,{uSize:s,uSizeT:c},{lowerSize:h,upperSize:m}){return l.kind==="source"?h/Oa:l.kind==="composite"?Vn(h/Oa,m/Oa,c):s}function Of(l,s){let c=0,h=0;if(l.kind==="constant")h=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:m,minZoom:v,maxZoom:x}=l,E=m?ze(Ks.interpolationFactor(m,s,v,x),0,1):0;l.kind==="camera"?h=Vn(l.minSize,l.maxSize,E):c=E}return{uSizeT:c,uSize:h}}var jU=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Oa,evaluateSizeForFeature:ib,evaluateSizeForZoom:Of,getSizeData:kS});function VU(l,s,c){return l.sections.forEach(h=>{h.text=function(m,v,x){const E=v.layout.get("text-transform").evaluate(x,{});return E==="uppercase"?m=m.toLocaleUpperCase():E==="lowercase"&&(m=m.toLocaleLowerCase()),P.applyArabicShaping&&(m=P.applyArabicShaping(m)),m}(h.text,s,c)}),l}const jg={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function UU(l){return l==="︶"||l==="﹈"||l==="︸"||l==="﹄"||l==="﹂"||l==="︾"||l==="︼"||l==="︺"||l==="︘"||l==="﹀"||l==="︐"||l==="︓"||l==="︔"||l==="｀"||l==="￣"||l==="︑"||l==="︒"}function qU(l){return l==="︵"||l==="﹇"||l==="︷"||l==="﹃"||l==="﹁"||l==="︽"||l==="︻"||l==="︹"||l==="︗"||l==="︿"}var pP=pi,mP=function(l,s,c,h,m){var v,x,E=8*m-h-1,C=(1<<E)-1,I=C>>1,O=-7,L=c?m-1:0,B=c?-1:1,j=l[s+L];for(L+=B,v=j&(1<<-O)-1,j>>=-O,O+=E;O>0;v=256*v+l[s+L],L+=B,O-=8);for(x=v&(1<<-O)-1,v>>=-O,O+=h;O>0;x=256*x+l[s+L],L+=B,O-=8);if(v===0)v=1-I;else{if(v===C)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,h),v-=I}return(j?-1:1)*x*Math.pow(2,v-h)},gP=function(l,s,c,h,m,v){var x,E,C,I=8*v-m-1,O=(1<<I)-1,L=O>>1,B=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=h?0:v-1,U=h?1:-1,X=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(E=isNaN(s)?1:0,x=O):(x=Math.floor(Math.log(s)/Math.LN2),s*(C=Math.pow(2,-x))<1&&(x--,C*=2),(s+=x+L>=1?B/C:B*Math.pow(2,1-L))*C>=2&&(x++,C/=2),x+L>=O?(E=0,x=O):x+L>=1?(E=(s*C-1)*Math.pow(2,m),x+=L):(E=s*Math.pow(2,L-1)*Math.pow(2,m),x=0));m>=8;l[c+j]=255&E,j+=U,E/=256,m-=8);for(x=x<<m|E,I+=m;I>0;l[c+j]=255&x,j+=U,x/=256,I-=8);l[c+j-U]|=128*X};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function pi(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}pi.Varint=0,pi.Fixed64=1,pi.Bytes=2,pi.Fixed32=5;var TS=4294967296,yP=1/TS,vP=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Jl(l){return l.type===pi.Bytes?l.readVarint()+l.pos:l.pos+1}function Df(l,s,c){return c?4294967296*s+(l>>>0):4294967296*(s>>>0)+(l>>>0)}function bP(l,s,c){var h=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(h);for(var m=c.pos-1;m>=l;m--)c.buf[m+h]=c.buf[m]}function WU(l,s){for(var c=0;c<l.length;c++)s.writeVarint(l[c])}function GU(l,s){for(var c=0;c<l.length;c++)s.writeSVarint(l[c])}function HU(l,s){for(var c=0;c<l.length;c++)s.writeFloat(l[c])}function ZU(l,s){for(var c=0;c<l.length;c++)s.writeDouble(l[c])}function XU(l,s){for(var c=0;c<l.length;c++)s.writeBoolean(l[c])}function KU(l,s){for(var c=0;c<l.length;c++)s.writeFixed32(l[c])}function YU(l,s){for(var c=0;c<l.length;c++)s.writeSFixed32(l[c])}function JU(l,s){for(var c=0;c<l.length;c++)s.writeFixed64(l[c])}function QU(l,s){for(var c=0;c<l.length;c++)s.writeSFixed64(l[c])}function rb(l,s){return(l[s]|l[s+1]<<8|l[s+2]<<16)+16777216*l[s+3]}function Rf(l,s,c){l[c]=s,l[c+1]=s>>>8,l[c+2]=s>>>16,l[c+3]=s>>>24}function _P(l,s){return(l[s]|l[s+1]<<8|l[s+2]<<16)+(l[s+3]<<24)}pi.prototype={destroy:function(){this.buf=null},readFields:function(l,s,c){for(c=c||this.length;this.pos<c;){var h=this.readVarint(),m=h>>3,v=this.pos;this.type=7&h,l(m,s,this),this.pos===v&&this.skip(h)}return s},readMessage:function(l,s){return this.readFields(l,s,this.readVarint()+this.pos)},readFixed32:function(){var l=rb(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=_P(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=rb(this.buf,this.pos)+rb(this.buf,this.pos+4)*TS;return this.pos+=8,l},readSFixed64:function(){var l=rb(this.buf,this.pos)+_P(this.buf,this.pos+4)*TS;return this.pos+=8,l},readFloat:function(){var l=mP(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=mP(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var s,c,h=this.buf;return s=127&(c=h[this.pos++]),c<128?s:(s|=(127&(c=h[this.pos++]))<<7,c<128?s:(s|=(127&(c=h[this.pos++]))<<14,c<128?s:(s|=(127&(c=h[this.pos++]))<<21,c<128?s:function(m,v,x){var E,C,I=x.buf;if(E=(112&(C=I[x.pos++]))>>4,C<128||(E|=(127&(C=I[x.pos++]))<<3,C<128)||(E|=(127&(C=I[x.pos++]))<<10,C<128)||(E|=(127&(C=I[x.pos++]))<<17,C<128)||(E|=(127&(C=I[x.pos++]))<<24,C<128)||(E|=(1&(C=I[x.pos++]))<<31,C<128))return Df(m,E,v);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=h[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,s=this.pos;return this.pos=l,l-s>=12&&vP?function(c,h,m){return vP.decode(c.subarray(h,m))}(this.buf,s,l):function(c,h,m){for(var v="",x=h;x<m;){var E,C,I,O=c[x],L=null,B=O>239?4:O>223?3:O>191?2:1;if(x+B>m)break;B===1?O<128&&(L=O):B===2?(192&(E=c[x+1]))==128&&(L=(31&O)<<6|63&E)<=127&&(L=null):B===3?(C=c[x+2],(192&(E=c[x+1]))==128&&(192&C)==128&&((L=(15&O)<<12|(63&E)<<6|63&C)<=2047||L>=55296&&L<=57343)&&(L=null)):B===4&&(C=c[x+2],I=c[x+3],(192&(E=c[x+1]))==128&&(192&C)==128&&(192&I)==128&&((L=(15&O)<<18|(63&E)<<12|(63&C)<<6|63&I)<=65535||L>=1114112)&&(L=null)),L===null?(L=65533,B=1):L>65535&&(L-=65536,v+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),v+=String.fromCharCode(L),x+=B}return v}(this.buf,s,l)},readBytes:function(){var l=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,l);return this.pos=l,s},readPackedVarint:function(l,s){if(this.type!==pi.Bytes)return l.push(this.readVarint(s));var c=Jl(this);for(l=l||[];this.pos<c;)l.push(this.readVarint(s));return l},readPackedSVarint:function(l){if(this.type!==pi.Bytes)return l.push(this.readSVarint());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==pi.Bytes)return l.push(this.readBoolean());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==pi.Bytes)return l.push(this.readFloat());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==pi.Bytes)return l.push(this.readDouble());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==pi.Bytes)return l.push(this.readFixed32());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==pi.Bytes)return l.push(this.readSFixed32());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==pi.Bytes)return l.push(this.readFixed64());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==pi.Bytes)return l.push(this.readSFixed64());var s=Jl(this);for(l=l||[];this.pos<s;)l.push(this.readSFixed64());return l},skip:function(l){var s=7&l;if(s===pi.Varint)for(;this.buf[this.pos++]>127;);else if(s===pi.Bytes)this.pos=this.readVarint()+this.pos;else if(s===pi.Fixed32)this.pos+=4;else{if(s!==pi.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(l,s){this.writeVarint(l<<3|s)},realloc:function(l){for(var s=this.length||16;s<this.pos+l;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),Rf(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),Rf(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),Rf(this.buf,-1&l,this.pos),Rf(this.buf,Math.floor(l*yP),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),Rf(this.buf,-1&l,this.pos),Rf(this.buf,Math.floor(l*yP),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(s,c){var h,m;if(s>=0?(h=s%4294967296|0,m=s/4294967296|0):(m=~(-s/4294967296),4294967295^(h=~(-s%4294967296))?h=h+1|0:(h=0,m=m+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(v,x,E){E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,v>>>=7,E.buf[E.pos++]=127&v|128,E.buf[E.pos]=127&(v>>>=7)}(h,0,c),function(v,x){var E=(7&v)<<4;x.buf[x.pos++]|=E|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(m,c)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var s=this.pos;this.pos=function(h,m,v){for(var x,E,C=0;C<m.length;C++){if((x=m.charCodeAt(C))>55295&&x<57344){if(!E){x>56319||C+1===m.length?(h[v++]=239,h[v++]=191,h[v++]=189):E=x;continue}if(x<56320){h[v++]=239,h[v++]=191,h[v++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(h[v++]=239,h[v++]=191,h[v++]=189,E=null);x<128?h[v++]=x:(x<2048?h[v++]=x>>6|192:(x<65536?h[v++]=x>>12|224:(h[v++]=x>>18|240,h[v++]=x>>12&63|128),h[v++]=x>>6&63|128),h[v++]=63&x|128)}return v}(this.buf,l,this.pos);var c=this.pos-s;c>=128&&bP(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(l){this.realloc(4),gP(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),gP(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var s=l.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=l[c]},writeRawMessage:function(l,s){this.pos++;var c=this.pos;l(s,this);var h=this.pos-c;h>=128&&bP(c,h,this),this.pos=c-1,this.writeVarint(h),this.pos+=h},writeMessage:function(l,s,c){this.writeTag(l,pi.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(l,s){s.length&&this.writeMessage(l,WU,s)},writePackedSVarint:function(l,s){s.length&&this.writeMessage(l,GU,s)},writePackedBoolean:function(l,s){s.length&&this.writeMessage(l,XU,s)},writePackedFloat:function(l,s){s.length&&this.writeMessage(l,HU,s)},writePackedDouble:function(l,s){s.length&&this.writeMessage(l,ZU,s)},writePackedFixed32:function(l,s){s.length&&this.writeMessage(l,KU,s)},writePackedSFixed32:function(l,s){s.length&&this.writeMessage(l,YU,s)},writePackedFixed64:function(l,s){s.length&&this.writeMessage(l,JU,s)},writePackedSFixed64:function(l,s){s.length&&this.writeMessage(l,QU,s)},writeBytesField:function(l,s){this.writeTag(l,pi.Bytes),this.writeBytes(s)},writeFixed32Field:function(l,s){this.writeTag(l,pi.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(l,s){this.writeTag(l,pi.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(l,s){this.writeTag(l,pi.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(l,s){this.writeTag(l,pi.Fixed64),this.writeSFixed64(s)},writeVarintField:function(l,s){this.writeTag(l,pi.Varint),this.writeVarint(s)},writeSVarintField:function(l,s){this.writeTag(l,pi.Varint),this.writeSVarint(s)},writeStringField:function(l,s){this.writeTag(l,pi.Bytes),this.writeString(s)},writeFloatField:function(l,s){this.writeTag(l,pi.Fixed32),this.writeFloat(s)},writeDoubleField:function(l,s){this.writeTag(l,pi.Fixed64),this.writeDouble(s)},writeBooleanField:function(l,s){this.writeVarintField(l,!!s)}};var ob=q(pP);const CS=3;function e8(l,s,c){s.glyphs=[],l===1&&c.readMessage(t8,s)}function t8(l,s,c){if(l===3){const{id:h,bitmap:m,width:v,height:x,left:E,top:C,advance:I}=c.readMessage(n8,{});s.glyphs.push({id:h,bitmap:new Yl({width:v+2*CS,height:x+2*CS},m),metrics:{width:v,height:x,left:E,top:C,advance:I}})}else l===4?s.ascender=c.readSVarint():l===5&&(s.descender=c.readSVarint())}function n8(l,s,c){l===1?s.id=c.readVarint():l===2?s.bitmap=c.readBytes():l===3?s.width=c.readVarint():l===4?s.height=c.readVarint():l===5?s.left=c.readSVarint():l===6?s.top=c.readSVarint():l===7&&(s.advance=c.readVarint())}const xP=CS;function IS(l){let s=0,c=0;for(const x of l)s+=x.w*x.h,c=Math.max(c,x.w);l.sort((x,E)=>E.h-x.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let m=0,v=0;for(const x of l)for(let E=h.length-1;E>=0;E--){const C=h[E];if(!(x.w>C.w||x.h>C.h)){if(x.x=C.x,x.y=C.y,v=Math.max(v,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===C.w&&x.h===C.h){const I=h.pop();E<h.length&&(h[E]=I)}else x.h===C.h?(C.x+=x.w,C.w-=x.w):x.w===C.w?(C.y+=x.h,C.h-=x.h):(h.push({x:C.x+x.w,y:C.y,w:C.w-x.w,h:x.h}),C.y+=x.h,C.h-=x.h);break}}return{w:m,h:v,fill:s/(m*v)||0}}const Wo=1;class AS{constructor(s,{pixelRatio:c,version:h,stretchX:m,stretchY:v,content:x}){this.paddedRect=s,this.pixelRatio=c,this.stretchX=m,this.stretchY=v,this.content=x,this.version=h}get tl(){return[this.paddedRect.x+Wo,this.paddedRect.y+Wo]}get br(){return[this.paddedRect.x+this.paddedRect.w-Wo,this.paddedRect.y+this.paddedRect.h-Wo]}get displaySize(){return[(this.paddedRect.w-2*Wo)/this.pixelRatio,(this.paddedRect.h-2*Wo)/this.pixelRatio]}}class wP{constructor(s,c){const h={},m={};this.haveRenderCallbacks=[];const v=[];this.addImages(s,h,v),this.addImages(c,m,v);const{w:x,h:E}=IS(v),C=new us({width:x||1,height:E||1});for(const I in s){const O=s[I],L=h[I].paddedRect;us.copy(O.data,C,{x:0,y:0},{x:L.x+Wo,y:L.y+Wo},O.data)}for(const I in c){const O=c[I],L=m[I].paddedRect,B=L.x+Wo,j=L.y+Wo,U=O.data.width,X=O.data.height;us.copy(O.data,C,{x:0,y:0},{x:B,y:j},O.data),us.copy(O.data,C,{x:0,y:X-1},{x:B,y:j-1},{width:U,height:1}),us.copy(O.data,C,{x:0,y:0},{x:B,y:j+X},{width:U,height:1}),us.copy(O.data,C,{x:U-1,y:0},{x:B-1,y:j},{width:1,height:X}),us.copy(O.data,C,{x:0,y:0},{x:B+U,y:j},{width:1,height:X})}this.image=C,this.iconPositions=h,this.patternPositions=m}addImages(s,c,h){for(const m in s){const v=s[m],x={x:0,y:0,w:v.data.width+2*Wo,h:v.data.height+2*Wo};h.push(x),c[m]=new AS(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>s.hasImage(h)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in s.updatedImages)this.patchUpdatedImage(this.iconPositions[h],s.getImage(h),c),this.patchUpdatedImage(this.patternPositions[h],s.getImage(h),c)}patchUpdatedImage(s,c,h){if(!s||!c||s.version===c.version)return;s.version=c.version;const[m,v]=s.tl;h.update(c.data,void 0,{x:m,y:v})}}Kt(AS,"ImagePosition"),Kt(wP,"ImageAtlas");const Ms={horizontal:1,vertical:2,horizontalOnly:3},SP=-17;class Vg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,c){const h=new Vg;return h.scale=s||1,h.fontStack=c,h}static forImage(s){const c=new Vg;return c.imageName=s,c}}class Lf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const h=new Lf;for(let m=0;m<s.sections.length;m++){const v=s.sections[m];v.image?h.addImageSection(v):h.addTextSection(v,c)}return h}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(c,h){let m="";for(let v=0;v<c.length;v++){const x=c.charCodeAt(v+1)||null,E=c.charCodeAt(v-1)||null;m+=!h&&(x&&R0(x)&&!jg[c[v+1]]||E&&R0(E)&&!jg[c[v-1]])||!jg[c[v]]?c[v]:jg[c[v]]}return m}(this.text,s)}trim(){let s=0;for(let h=0;h<this.text.length&&sb[this.text.charCodeAt(h)];h++)s++;let c=this.text.length;for(let h=this.text.length-1;h>=0&&h>=s&&sb[this.text.charCodeAt(h)];h--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const h=new Lf;return h.text=this.text.substring(s,c),h.sectionIndex=this.sectionIndex.slice(s,c),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(Vg.forText(s.scale,s.fontStack||c));const h=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(h)}addImageSection(s){const c=s.image?s.image.name:"";if(c.length===0)return void ni("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Vg.forImage(c)),this.sectionIndex.push(this.sections.length-1)):ni("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function MS(l,s,c,h,m,v,x,E,C,I,O,L,B,j,U){const X=Lf.fromFeature(l,m);L===Ms.vertical&&X.verticalizePunctuation(B);let re=[];const he=function(we,He,Ue,at,Et,Je){if(!we)return[];const dt=[],ht=function(Vt,Jt,qt,xn,Dt,on){let wn=0;for(let qn=0;qn<Vt.length();qn++){const Sn=Vt.getSection(qn);wn+=EP(Vt.getCharCode(qn),Sn,xn,Dt,Jt,on)}return wn/Math.max(1,Math.ceil(wn/qt))}(we,He,Ue,at,Et,Je),vt=we.text.indexOf("​")>=0;let Pt=0;for(let Vt=0;Vt<we.length();Vt++){const Jt=we.getSection(Vt),qt=we.getCharCode(Vt);if(sb[qt]||(Pt+=EP(qt,Jt,at,Et,He,Je)),Vt<we.length()-1){const xn=!((it=qt)<11904||!(Wt["Bopomofo Extended"](it)||Wt.Bopomofo(it)||Wt["CJK Compatibility Forms"](it)||Wt["CJK Compatibility Ideographs"](it)||Wt["CJK Compatibility"](it)||Wt["CJK Radicals Supplement"](it)||Wt["CJK Strokes"](it)||Wt["CJK Symbols and Punctuation"](it)||Wt["CJK Unified Ideographs Extension A"](it)||Wt["CJK Unified Ideographs"](it)||Wt["Enclosed CJK Letters and Months"](it)||Wt["Halfwidth and Fullwidth Forms"](it)||Wt.Hiragana(it)||Wt["Ideographic Description Characters"](it)||Wt["Kangxi Radicals"](it)||Wt["Katakana Phonetic Extensions"](it)||Wt.Katakana(it)||Wt["Vertical Forms"](it)||Wt["Yi Radicals"](it)||Wt["Yi Syllables"](it)));(i8[qt]||xn||Jt.imageName)&&dt.push(TP(Vt+1,Pt,ht,dt,r8(qt,we.getCharCode(Vt+1),xn&&vt),!1))}}var it;return CP(TP(we.length(),Pt,ht,dt,0,!0))}(X,I,v,s,h,j),{processBidirectionalText:xe,processStyledBidirectionalText:fe}=P;if(xe&&X.sections.length===1){const we=xe(X.toString(),he);for(const He of we){const Ue=new Lf;Ue.text=He,Ue.sections=X.sections;for(let at=0;at<He.length;at++)Ue.sectionIndex.push(0);re.push(Ue)}}else if(fe){const we=fe(X.text,X.sectionIndex,he);for(const He of we){const Ue=new Lf;Ue.text=He[0],Ue.sectionIndex=He[1],Ue.sections=X.sections,re.push(Ue)}}else re=function(we,He){const Ue=[],at=we.text;let Et=0;for(const Je of He)Ue.push(we.substring(Et,Je)),Et=Je;return Et<at.length&&Ue.push(we.substring(Et,at.length)),Ue}(X,he);const be=[],Se={positionedLines:be,text:X.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:L,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(we,He,Ue,at,Et,Je,dt,ht,vt,Pt,it,Vt){let Jt=0,qt=0,xn=0;const Dt=ht==="right"?1:ht==="left"?0:.5;let on=!1;for(const kn of Et){const Tn=kn.getSections();for(const ui of Tn){if(ui.imageName)continue;const mi=He[ui.fontStack];if(mi&&(on=mi.ascender!==void 0&&mi.descender!==void 0,!on))break}if(!on)break}let wn=0;for(const kn of Et){kn.trim();const Tn=kn.getMaxScale(),ui=(Tn-1)*Gr,mi={positionedGlyphs:[],lineOffset:0};we.positionedLines[wn]=mi;const gi=mi.positionedGlyphs;let di=0;if(!kn.length()){qt+=Je,++wn;continue}let zi=0,Gi=0;for(let hi=0;hi<kn.length();hi++){const Sr=kn.getSection(hi),hr=kn.getSectionIndex(hi),Fi=kn.getCharCode(hi);let Hn=Sr.scale,fr=null,yi=null,Ao=null,pr=Gr,Hr=0;const zr=!(vt===Ms.horizontal||!it&&!mg(Fi)||it&&(sb[Fi]||(qn=Fi,Wt.Arabic(qn)||Wt["Arabic Supplement"](qn)||Wt["Arabic Extended-A"](qn)||Wt["Arabic Presentation Forms-A"](qn)||Wt["Arabic Presentation Forms-B"](qn))));if(Sr.imageName){const Mo=at[Sr.imageName];if(!Mo)continue;Ao=Sr.imageName,we.iconsInText=we.iconsInText||!0,yi=Mo.paddedRect;const Br=Mo.displaySize;Hn=Hn*Gr/Vt,fr={width:Br[0],height:Br[1],left:Wo,top:-xP,advance:zr?Br[1]:Br[0],localGlyph:!1},Hr=on?-fr.height*Hn:SP+Tn*Gr-Br[1]*Hn,pr=fr.advance;const La=(zr?Br[0]:Br[1])*Hn-Gr*Tn;La>0&&La>di&&(di=La)}else{const Mo=Ue[Sr.fontStack];if(!Mo)continue;Mo[Fi]&&(yi=Mo[Fi]);const Br=He[Sr.fontStack];if(!Br)continue;const La=Br.glyphs[Fi];if(!La)continue;if(fr=La.metrics,pr=Fi!==8203?Gr:0,on){const Vf=Br.ascender!==void 0?Math.abs(Br.ascender):0,Jg=Br.descender!==void 0?Math.abs(Br.descender):0,Qg=(Vf+Jg)*Hn;zi<Qg&&(zi=Qg,Gi=(Vf-Jg)/2*Hn),Hr=-Vf*Hn}else Hr=SP+(Tn-Hn)*Gr}zr?(we.verticalizable=!0,gi.push({glyph:Fi,imageName:Ao,x:Jt,y:qt+Hr,vertical:zr,scale:Hn,localGlyph:fr.localGlyph,fontStack:Sr.fontStack,sectionIndex:hr,metrics:fr,rect:yi}),Jt+=pr*Hn+Pt):(gi.push({glyph:Fi,imageName:Ao,x:Jt,y:qt+Hr,vertical:zr,scale:Hn,localGlyph:fr.localGlyph,fontStack:Sr.fontStack,sectionIndex:hr,metrics:fr,rect:yi}),Jt+=fr.advance*Hn+Pt)}gi.length!==0&&(xn=Math.max(Jt-Pt,xn),on?IP(gi,Dt,di,Gi,Je*Tn/2):IP(gi,Dt,di,0,Je/2)),Jt=0;const dr=Je*Tn+di;mi.lineOffset=Math.max(di,ui),qt+=dr,++wn}var qn;const Sn=qt,{horizontalAlign:fn,verticalAlign:bi}=PS(dt);(function(kn,Tn,ui,mi,gi,di){const zi=(Tn-ui)*gi,Gi=-di*mi;for(const dr of kn)for(const hi of dr.positionedGlyphs)hi.x+=zi,hi.y+=Gi})(we.positionedLines,Dt,fn,bi,xn,Sn),we.top+=-bi*Sn,we.bottom=we.top+Sn,we.left+=-fn*xn,we.right=we.left+xn,we.hasBaseline=on}(Se,s,c,h,re,x,E,C,L,I,B,U),!function(we){for(const He of we)if(He.positionedGlyphs.length!==0)return!1;return!0}(be)&&Se}const sb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},i8={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function EP(l,s,c,h,m,v){if(s.imageName){const x=h[s.imageName];return x?x.displaySize[0]*s.scale*Gr/v+m:0}{const x=c[s.fontStack],E=x&&x.glyphs[l];return E?E.metrics.advance*s.scale+m:0}}function kP(l,s,c,h){const m=Math.pow(l-s,2);return h?l<s?m/2:2*m:m+Math.abs(c)*c}function r8(l,s,c){let h=0;return l===10&&(h-=1e4),c&&(h+=150),l!==40&&l!==65288||(h+=50),s!==41&&s!==65289||(h+=50),h}function TP(l,s,c,h,m,v){let x=null,E=kP(s,c,m,v);for(const C of h){const I=kP(s-C.x,c,m,v)+C.badness;I<=E&&(x=C,E=I)}return{index:l,x:s,priorBreak:x,badness:E}}function CP(l){return l?CP(l.priorBreak).concat(l.index):[]}function PS(l){let s=.5,c=.5;switch(l){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function IP(l,s,c,h,m){if(!(s||c||h||m))return;const v=l.length-1,x=l[v],E=(x.x+x.metrics.advance*x.scale)*s;for(let C=0;C<=v;C++)l[C].x-=E,l[C].y+=c+h+m}function o8(l,s,c){const{horizontalAlign:h,verticalAlign:m}=PS(c),v=s[0]-l.displaySize[0]*h,x=s[1]-l.displaySize[1]*m;return{image:l,top:x,bottom:x+l.displaySize[1],left:v,right:v+l.displaySize[0]}}function AP(l,s,c,h,m,v){const x=l.image;let E;if(x.content){const re=x.content,he=x.pixelRatio||1;E=[re[0]/he,re[1]/he,x.displaySize[0]-re[2]/he,x.displaySize[1]-re[3]/he]}const C=s.left*v,I=s.right*v;let O,L,B,j;c==="width"||c==="both"?(j=m[0]+C-h[3],L=m[0]+I+h[1]):(j=m[0]+(C+I-x.displaySize[0])/2,L=j+x.displaySize[0]);const U=s.top*v,X=s.bottom*v;return c==="height"||c==="both"?(O=m[1]+U-h[0],B=m[1]+X+h[2]):(O=m[1]+(U+X-x.displaySize[1])/2,B=O+x.displaySize[1]),{image:x,top:O,right:L,bottom:B,left:j,collisionPadding:E}}class Ql extends te{constructor(s,c,h,m,v){super(s,c),this.angle=m,this.z=h,v!==void 0&&(this.segment=v)}clone(){return new Ql(this.x,this.y,this.z,this.angle,this.segment)}}function MP(l,s,c,h,m){if(s.segment===void 0)return!0;let v=s,x=s.segment+1,E=0;for(;E>-c/2;){if(x--,x<0)return!1;E-=l[x].dist(v),v=l[x]}E+=l[x].dist(l[x+1]),x++;const C=[];let I=0;for(;E<c/2;){const O=l[x],L=l[x+1];if(!L)return!1;let B=l[x-1].angleTo(O)-O.angleTo(L);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:E,angleDelta:B}),I+=B;E-C[0].distance>h;)I-=C.shift().angleDelta;if(I>m)return!1;x++,E+=O.dist(L)}return!0}function PP(l){let s=0;for(let c=0;c<l.length-1;c++)s+=l[c].dist(l[c+1]);return s}function OP(l,s,c){return l?.6*s*c:0}function DP(l,s){return Math.max(l?l.right-l.left:0,s?s.right-s.left:0)}function s8(l,s,c,h,m,v){const x=OP(c,m,v),E=DP(c,h)*v;let C=0;const I=PP(l)/2;for(let O=0;O<l.length-1;O++){const L=l[O],B=l[O+1],j=L.dist(B);if(C+j>I){const U=(I-C)/j,X=Vn(L.x,B.x,U),re=Vn(L.y,B.y,U),he=new Ql(X,re,0,B.angleTo(L),O);return!x||MP(l,he,E,x,s)?he:void 0}C+=j}}function a8(l,s,c,h,m,v,x,E,C){const I=OP(h,v,x),O=DP(h,m),L=O*x,B=l[0].x===0||l[0].x===C||l[0].y===0||l[0].y===C;return s-L<s/4&&(s=L+s/4),RP(l,B?s/2*E%s:(O/2+2*v)*x*E%s,s,I,c,L,B,!1,C)}function RP(l,s,c,h,m,v,x,E,C){const I=v/2,O=PP(l);let L=0,B=s-c,j=[];for(let U=0;U<l.length-1;U++){const X=l[U],re=l[U+1],he=X.dist(re),xe=re.angleTo(X);for(;B+c<L+he;){B+=c;const fe=(B-L)/he,be=Vn(X.x,re.x,fe),Se=Vn(X.y,re.y,fe);if(be>=0&&be<C&&Se>=0&&Se<C&&B-I>=0&&B+I<=O){const we=new Ql(be,Se,0,xe,U);we._round(),h&&!MP(l,we,v,h,m)||j.push(we)}}L+=he}return E||j.length||x||(j=RP(l,L/2,c,h,m,v,x,!0,C)),j}function LP(l,s,c,h,m){const v=[];for(let x=0;x<l.length;x++){const E=l[x];let C;for(let I=0;I<E.length-1;I++){let O=E[I],L=E[I+1];O.x<s&&L.x<s||(O.x<s?O=new te(s,O.y+(s-O.x)/(L.x-O.x)*(L.y-O.y))._round():L.x<s&&(L=new te(s,O.y+(s-O.x)/(L.x-O.x)*(L.y-O.y))._round()),O.y<c&&L.y<c||(O.y<c?O=new te(O.x+(c-O.y)/(L.y-O.y)*(L.x-O.x),c)._round():L.y<c&&(L=new te(O.x+(c-O.y)/(L.y-O.y)*(L.x-O.x),c)._round()),O.x>=h&&L.x>=h||(O.x>=h?O=new te(h,O.y+(h-O.x)/(L.x-O.x)*(L.y-O.y))._round():L.x>=h&&(L=new te(h,O.y+(h-O.x)/(L.x-O.x)*(L.y-O.y))._round()),O.y>=m&&L.y>=m||(O.y>=m?O=new te(O.x+(m-O.y)/(L.y-O.y)*(L.x-O.x),m)._round():L.y>=m&&(L=new te(O.x+(m-O.y)/(L.y-O.y)*(L.x-O.x),m)._round()),C&&O.equals(C[C.length-1])||(C=[O],v.push(C)),C.push(L)))))}}return v}Kt(Ql,"Anchor");const Ug=1e20;function zP(l,s,c,h,m,v,x,E,C){for(let I=s;I<s+h;I++)BP(l,c*v+I,v,m,x,E,C);for(let I=c;I<c+m;I++)BP(l,I*v+s,1,h,x,E,C)}function BP(l,s,c,h,m,v,x){v[0]=0,x[0]=-Ug,x[1]=Ug,m[0]=l[s];for(let E=1,C=0,I=0;E<h;E++){m[E]=l[s+E*c];const O=E*E;do{const L=v[C];I=(m[E]-m[L]+O-L*L)/(E-L)/2}while(I<=x[C]&&--C>-1);C++,v[C]=E,x[C]=I,x[C+1]=Ug}for(let E=0,C=0;E<h;E++){for(;x[C+1]<E;)C++;const I=v[C],O=E-I;l[s+E*c]=m[I]+O*O}}const Da=2,OS={none:0,ideographs:1,all:2};class zf{constructor(s,c,h){this.requestManager=s,this.localGlyphMode=c,this.localFontFamily=h,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,c){const h=[];for(const m in s)for(const v of s[m])h.push({stack:m,id:v});ft(h,({stack:m,id:v},x)=>{let E=this.entries[m];E||(E=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let C=E.glyphs[v];if(C!==void 0)return void x(null,{stack:m,id:v,glyph:C});if(C=this._tinySDF(E,m,v),C)return E.glyphs[v]=C,void x(null,{stack:m,id:v,glyph:C});const I=Math.floor(v/256);if(256*I>65535)return void x(new Error("glyphs > 65535 not supported"));if(E.ranges[I])return void x(null,{stack:m,id:v,glyph:C});let O=E.requests[I];O||(O=E.requests[I]=[],zf.loadGlyphRange(m,I,this.url,this.requestManager,(L,B)=>{if(B){E.ascender=B.ascender,E.descender=B.descender;for(const j in B.glyphs)this._doesCharSupportLocalGlyph(+j)||(E.glyphs[+j]=B.glyphs[+j]);E.ranges[I]=!0}for(const j of O)j(L,B);delete E.requests[I]})),O.push((L,B)=>{L?x(L):B&&x(null,{stack:m,id:v,glyph:B.glyphs[v]||null})})},(m,v)=>{if(m)c(m);else if(v){const x={};for(const{stack:E,id:C,glyph:I}of v)x[E]===void 0&&(x[E]={}),x[E].glyphs===void 0&&(x[E].glyphs={}),x[E].glyphs[C]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics},x[E].ascender=this.entries[E].ascender,x[E].descender=this.entries[E].descender;c(null,x)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==OS.none&&(this.localGlyphMode===OS.all?!!this.localFontFamily:!!this.localFontFamily&&(Wt["CJK Unified Ideographs"](s)||Wt["Hangul Syllables"](s)||Wt.Hiragana(s)||Wt.Katakana(s)||Wt["CJK Symbols and Punctuation"](s)))}_tinySDF(s,c,h){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(h))return;let v=s.tinySDF;if(!v){let X="400";/bold/i.test(c)?X="900":/medium/i.test(c)?X="500":/light/i.test(c)&&(X="200"),v=s.tinySDF=new zf.TinySDF({fontFamily:m,fontWeight:X,fontSize:24*Da,buffer:3*Da,radius:8*Da}),v.fontWeight=X}if(this.localGlyphs[v.fontWeight][h])return this.localGlyphs[v.fontWeight][h];const x=String.fromCharCode(h),{data:E,width:C,height:I,glyphWidth:O,glyphHeight:L,glyphLeft:B,glyphTop:j,glyphAdvance:U}=v.draw(x);return this.localGlyphs[v.fontWeight][h]={id:h,bitmap:new Yl({width:C,height:I},E),metrics:{width:O/Da,height:L/Da,left:B/Da,top:j/Da-27,advance:U/Da,localGlyph:!0}}}}zf.loadGlyphRange=function(l,s,c,h,m){const v=256*s,x=v+255,E=h.transformRequest(h.normalizeGlyphsURL(c).replace("{fontstack}",l).replace("{range}",`${v}-${x}`),Xi.Glyphs);fo(E,(C,I)=>{if(C)m(C);else if(I){const O={},L=function(B){return new ob(B).readFields(e8,{})}(I);for(const B of L.glyphs)O[B.id]=B;m(null,{glyphs:O,ascender:L.ascender,descender:L.descender})}})},zf.TinySDF=class{constructor({fontSize:l=24,buffer:s=3,radius:c=8,cutoff:h=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:x="normal"}={}){this.buffer=s,this.cutoff=h,this.radius=c;const E=this.size=l+4*s,C=this._createCanvas(E),I=this.ctx=C.getContext("2d",{willReadFrequently:!0});I.font=`${x} ${v} ${l}px ${m}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(l){const s=document.createElement("canvas");return s.width=s.height=l,s}draw(l){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:h,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(l),x=Math.ceil(c),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),C=Math.min(this.size-this.buffer,x+Math.ceil(h)),I=E+2*this.buffer,O=C+2*this.buffer,L=Math.max(I*O,0),B=new Uint8ClampedArray(L),j={data:B,width:I,height:O,glyphWidth:E,glyphHeight:C,glyphTop:x,glyphLeft:0,glyphAdvance:s};if(E===0||C===0)return j;const{ctx:U,buffer:X,gridInner:re,gridOuter:he}=this;U.clearRect(X,X,E,C),U.fillText(l,X,X+x);const xe=U.getImageData(X,X,E,C);he.fill(Ug,0,L),re.fill(0,0,L);for(let fe=0;fe<C;fe++)for(let be=0;be<E;be++){const Se=xe.data[4*(fe*E+be)+3]/255;if(Se===0)continue;const we=(fe+X)*I+be+X;if(Se===1)he[we]=0,re[we]=Ug;else{const He=.5-Se;he[we]=He>0?He*He:0,re[we]=He<0?He*He:0}}zP(he,0,0,I,O,I,this.f,this.v,this.z),zP(re,X,X,E,C,I,this.f,this.v,this.z);for(let fe=0;fe<L;fe++){const be=Math.sqrt(he[fe])-Math.sqrt(re[fe]);B[fe]=Math.round(255-255*(be/this.radius+this.cutoff))}return j}};const Bf=Wo;function FP(l,s,c,h){const m=[],v=l.image,x=v.pixelRatio,E=v.paddedRect.w-2*Bf,C=v.paddedRect.h-2*Bf,I=l.right-l.left,O=l.bottom-l.top,L=v.stretchX||[[0,E]],B=v.stretchY||[[0,C]],j=(Je,dt)=>Je+dt[1]-dt[0],U=L.reduce(j,0),X=B.reduce(j,0),re=E-U,he=C-X;let xe=0,fe=U,be=0,Se=X,we=0,He=re,Ue=0,at=he;if(v.content&&h){const Je=v.content;xe=ab(L,0,Je[0]),be=ab(B,0,Je[1]),fe=ab(L,Je[0],Je[2]),Se=ab(B,Je[1],Je[3]),we=Je[0]-xe,Ue=Je[1]-be,He=Je[2]-Je[0]-fe,at=Je[3]-Je[1]-Se}const Et=(Je,dt,ht,vt)=>{const Pt=lb(Je.stretch-xe,fe,I,l.left),it=cb(Je.fixed-we,He,Je.stretch,U),Vt=lb(dt.stretch-be,Se,O,l.top),Jt=cb(dt.fixed-Ue,at,dt.stretch,X),qt=lb(ht.stretch-xe,fe,I,l.left),xn=cb(ht.fixed-we,He,ht.stretch,U),Dt=lb(vt.stretch-be,Se,O,l.top),on=cb(vt.fixed-Ue,at,vt.stretch,X),wn=new te(Pt,Vt),qn=new te(qt,Vt),Sn=new te(qt,Dt),fn=new te(Pt,Dt),bi=new te(it/x,Jt/x),kn=new te(xn/x,on/x),Tn=s*Math.PI/180;if(Tn){const gi=Math.sin(Tn),di=Math.cos(Tn),zi=[di,-gi,gi,di];wn._matMult(zi),qn._matMult(zi),fn._matMult(zi),Sn._matMult(zi)}const ui=Je.stretch+Je.fixed,mi=dt.stretch+dt.fixed;return{tl:wn,tr:qn,bl:fn,br:Sn,tex:{x:v.paddedRect.x+Bf+ui,y:v.paddedRect.y+Bf+mi,w:ht.stretch+ht.fixed-ui,h:vt.stretch+vt.fixed-mi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:bi,pixelOffsetBR:kn,minFontScaleX:He/x/I,minFontScaleY:at/x/O,isSDF:c}};if(h&&(v.stretchX||v.stretchY)){const Je=NP(L,re,U),dt=NP(B,he,X);for(let ht=0;ht<Je.length-1;ht++){const vt=Je[ht],Pt=Je[ht+1];for(let it=0;it<dt.length-1;it++)m.push(Et(vt,dt[it],Pt,dt[it+1]))}}else m.push(Et({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:C+1}));return m}function ab(l,s,c){let h=0;for(const m of l)h+=Math.max(s,Math.min(c,m[1]))-Math.max(s,Math.min(c,m[0]));return h}function NP(l,s,c){const h=[{fixed:-Bf,stretch:0}];for(const[m,v]of l){const x=h[h.length-1];h.push({fixed:m-x.stretch,stretch:x.stretch}),h.push({fixed:m-x.stretch,stretch:x.stretch+(v-m)})}return h.push({fixed:s+Bf,stretch:c}),h}function lb(l,s,c,h){return l/s*c+h}function cb(l,s,c,h){return l-s*c/h}function l8(l,s,c,h){const m=s+l.positionedLines[h].lineOffset;return h===0?c+m/2:c+(m+(s+l.positionedLines[h-1].lineOffset))/2}class c8{constructor(s=[],c=u8){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:h}=this,m=c[s];for(;s>0;){const v=s-1>>1,x=c[v];if(h(m,x)>=0)break;c[s]=x,s=v}c[s]=m}_down(s){const{data:c,compare:h}=this,m=this.length>>1,v=c[s];for(;s<m;){let x=1+(s<<1),E=c[x];const C=x+1;if(C<this.length&&h(c[C],E)<0&&(x=C,E=c[C]),h(E,v)>=0)break;c[s]=E,s=x}c[s]=v}}function u8(l,s){return l<s?-1:l>s?1:0}function d8(l,s=1,c=!1){let h=1/0,m=1/0,v=-1/0,x=-1/0;const E=l[0];for(let j=0;j<E.length;j++){const U=E[j];(!j||U.x<h)&&(h=U.x),(!j||U.y<m)&&(m=U.y),(!j||U.x>v)&&(v=U.x),(!j||U.y>x)&&(x=U.y)}const C=Math.min(v-h,x-m);let I=C/2;const O=new c8([],h8);if(C===0)return new te(h,m);for(let j=h;j<v;j+=C)for(let U=m;U<x;U+=C)O.push(new Ff(j+I,U+I,I,l));let L=function(j){let U=0,X=0,re=0;const he=j[0];for(let xe=0,fe=he.length,be=fe-1;xe<fe;be=xe++){const Se=he[xe],we=he[be],He=Se.x*we.y-we.x*Se.y;X+=(Se.x+we.x)*He,re+=(Se.y+we.y)*He,U+=3*He}return new Ff(X/U,re/U,0,j)}(l),B=O.length;for(;O.length;){const j=O.pop();(j.d>L.d||!L.d)&&(L=j,c&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,B)),j.max-L.d<=s||(I=j.h/2,O.push(new Ff(j.p.x-I,j.p.y-I,I,l)),O.push(new Ff(j.p.x+I,j.p.y-I,I,l)),O.push(new Ff(j.p.x-I,j.p.y+I,I,l)),O.push(new Ff(j.p.x+I,j.p.y+I,I,l)),B+=4)}return c&&(console.log(`num probes: ${B}`),console.log(`best distance: ${L.d}`)),L.p}function h8(l,s){return s.max-l.max}class Ff{constructor(s,c,h,m){this.p=new te(s,c),this.h=h,this.d=function(v,x){let E=!1,C=1/0;for(let I=0;I<x.length;I++){const O=x[I];for(let L=0,B=O.length,j=B-1;L<B;j=L++){const U=O[L],X=O[j];U.y>v.y!=X.y>v.y&&v.x<(X.x-U.x)*(v.y-U.y)/(X.y-U.y)+U.x&&(E=!E),C=Math.min(C,RM(v,U,X))}}return(E?1:-1)*Math.sqrt(C)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const Nf=7,DS=Number.POSITIVE_INFINITY,f8=Math.sqrt(2);function $P(l,[s,c]){let h=0,m=0;if(c===DS){s<0&&(s=0);const v=s/f8;switch(l){case"top-right":case"top-left":m=v-Nf;break;case"bottom-right":case"bottom-left":m=-v+Nf;break;case"bottom":m=-s+Nf;break;case"top":m=s-Nf}switch(l){case"top-right":case"bottom-right":h=-v;break;case"top-left":case"bottom-left":h=v;break;case"left":h=s;break;case"right":h=-s}}else{switch(s=Math.abs(s),c=Math.abs(c),l){case"top-right":case"top-left":case"top":m=c-Nf;break;case"bottom-right":case"bottom-left":case"bottom":m=-c+Nf}switch(l){case"top-right":case"bottom-right":case"right":h=-s;break;case"top-left":case"bottom-left":case"left":h=s}}return[h,m]}function p8(l,s,c,h,m,v,x,E,C,I){l.createArrays(),l.tilePixelRatio=ln/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const O=l.layers[0].layout,L=l.layers[0]._unevaluatedLayout._values,B={};if(l.textSizeData.kind==="composite"){const{minZoom:X,maxZoom:re}=l.textSizeData;B.compositeTextSizes=[L["text-size"].possiblyEvaluate(new R(X),E),L["text-size"].possiblyEvaluate(new R(re),E)]}if(l.iconSizeData.kind==="composite"){const{minZoom:X,maxZoom:re}=l.iconSizeData;B.compositeIconSizes=[L["icon-size"].possiblyEvaluate(new R(X),E),L["icon-size"].possiblyEvaluate(new R(re),E)]}B.layoutTextSize=L["text-size"].possiblyEvaluate(new R(C+1),E),B.layoutIconSize=L["icon-size"].possiblyEvaluate(new R(C+1),E),B.textMaxSize=L["text-size"].possiblyEvaluate(new R(18),E);const j=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",U=O.get("text-size");for(const X of l.features){const re=O.get("text-font").evaluate(X,{},E).join(","),he=U.evaluate(X,{},E),xe=B.layoutTextSize.evaluate(X,{},E),fe=(B.layoutIconSize.evaluate(X,{},E),{horizontal:{},vertical:void 0}),be=X.text;let Se,we=[0,0];if(be){const at=be.toString(),Et=O.get("text-letter-spacing").evaluate(X,{},E)*Gr,Je=O.get("text-line-height").evaluate(X,{},E)*Gr,dt=Vw(at)?Et:0,ht=O.get("text-anchor").evaluate(X,{},E),vt=O.get("text-variable-anchor");if(!vt){const qt=O.get("text-radial-offset").evaluate(X,{},E);we=qt?$P(ht,[qt*Gr,DS]):O.get("text-offset").evaluate(X,{},E).map(xn=>xn*Gr)}let Pt=j?"center":O.get("text-justify").evaluate(X,{},E);const it=O.get("symbol-placement")==="point",Vt=it?O.get("text-max-width").evaluate(X,{},E)*Gr:1/0,Jt=qt=>{l.allowVerticalPlacement&&pg(at)&&(fe.vertical=MS(be,s,c,m,re,Vt,Je,ht,qt,dt,we,Ms.vertical,!0,xe,he))};if(!j&&vt){const qt=Pt==="auto"?vt.map(Dt=>RS(Dt)):[Pt];let xn=!1;for(let Dt=0;Dt<qt.length;Dt++){const on=qt[Dt];if(!fe.horizontal[on])if(xn)fe.horizontal[on]=fe.horizontal[0];else{const wn=MS(be,s,c,m,re,Vt,Je,"center",on,dt,we,Ms.horizontal,!1,xe,he);wn&&(fe.horizontal[on]=wn,xn=wn.positionedLines.length===1)}}Jt("left")}else{if(Pt==="auto"&&(Pt=RS(ht)),it||O.get("text-writing-mode").indexOf("horizontal")>=0||!pg(at)){const qt=MS(be,s,c,m,re,Vt,Je,ht,Pt,dt,we,Ms.horizontal,!1,xe,he);qt&&(fe.horizontal[Pt]=qt)}Jt(it?"left":Pt)}}let He=!1;if(X.icon&&X.icon.name){const at=h[X.icon.name];at&&(Se=o8(m[X.icon.name],O.get("icon-offset").evaluate(X,{},E),O.get("icon-anchor").evaluate(X,{},E)),He=at.sdf,l.sdfIcons===void 0?l.sdfIcons=at.sdf:l.sdfIcons!==at.sdf&&ni("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(at.pixelRatio!==l.pixelRatio||O.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const Ue=VP(fe.horizontal)||fe.vertical;l.iconsInText||(l.iconsInText=!!Ue&&Ue.iconsInText),(Ue||Se)&&m8(l,X,fe,Se,h,B,xe,0,we,He,x,E,I)}v&&l.generateCollisionDebugBuffers(C,l.collisionBoxArray)}function RS(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function m8(l,s,c,h,m,v,x,E,C,I,O,L,B){let j=v.textMaxSize.evaluate(s,{},L);j===void 0&&(j=x);const U=l.layers[0].layout,X=U.get("icon-offset").evaluate(s,{},L),re=VP(c.horizontal)||c.vertical,he=B.name==="globe",xe=Gr,fe=x/xe,be=l.tilePixelRatio*j/xe,Se=(ht=l.overscaling,l.zoom>18&&ht>2&&(ht>>=1),Math.max(ln/(512*ht),1)*U.get("symbol-spacing")),we=U.get("text-padding")*l.tilePixelRatio,He=U.get("icon-padding")*l.tilePixelRatio,Ue=tt(U.get("text-max-angle")),at=U.get("text-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Et=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Je=U.get("symbol-placement"),dt=Se/2;var ht;const vt=U.get("icon-text-fit");let Pt;h&&vt!=="none"&&(l.allowVerticalPlacement&&c.vertical&&(Pt=AP(h,c.vertical,vt,U.get("icon-text-fit-padding"),X,fe)),re&&(h=AP(h,re,vt,U.get("icon-text-fit-padding"),X,fe)));const it=(Vt,Jt,qt)=>{if(Jt.x<0||Jt.x>=ln||Jt.y<0||Jt.y>=ln)return;let xn=null;if(he){const{x:Dt,y:on,z:wn}=B.projectTilePoint(Jt.x,Jt.y,qt);xn={anchor:new Ql(Dt,on,wn,0,void 0),up:B.upVector(qt,Jt.x,Jt.y)}}(function(Dt,on,wn,qn,Sn,fn,bi,kn,Tn,ui,mi,gi,di,zi,Gi,dr,hi,Sr,hr,Fi,Hn,fr,yi,Ao,pr){const Hr=Dt.addToLineVertexArray(on,qn);let zr,Mo,Br,La,Vf,Jg,Qg,xO=0,wO=0,SO=0,EO=0,XS=-1,KS=-1;const ml={};let kO=Ww("");const jd=wn?wn.anchor:on;let YS=0,JS=0;if(Tn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[YS,JS]=Tn.layout.get("text-offset").evaluate(Hn,{},pr).map(ds=>ds*Gr):(YS=Tn.layout.get("text-radial-offset").evaluate(Hn,{},pr)*Gr,JS=DS),Dt.allowVerticalPlacement&&Sn.vertical){const ds=Sn.vertical;if(Gi)Jg=LS(ds),kn&&(Qg=LS(kn));else{const hs=Tn.layout.get("text-rotate").evaluate(Hn,{},pr)+90;Br=ub(ui,jd,on,mi,gi,di,ds,zi,hs,dr),kn&&(La=ub(ui,jd,on,mi,gi,di,kn,Sr,hs))}}if(fn){const ds=Tn.layout.get("icon-rotate").evaluate(Hn,{},pr),hs=Tn.layout.get("icon-text-fit")!=="none",ey=FP(fn,ds,yi,hs),eE=kn?FP(kn,ds,yi,hs):void 0;Mo=ub(ui,jd,on,mi,gi,di,fn,Sr,ds),xO=4*ey.length;const TO=Dt.iconSizeData;let Vd=null;TO.kind==="source"?(Vd=[Oa*Tn.layout.get("icon-size").evaluate(Hn,{},pr)],Vd[0]>Wc&&ni(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${qg}. Reduce your "icon-size".`)):TO.kind==="composite"&&(Vd=[Oa*fr.compositeIconSizes[0].evaluate(Hn,{},pr),Oa*fr.compositeIconSizes[1].evaluate(Hn,{},pr)],(Vd[0]>Wc||Vd[1]>Wc)&&ni(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${qg}. Reduce your "icon-size".`)),Dt.addSymbols(Dt.icon,ey,Vd,Fi,hr,Hn,!1,wn,on,Hr.lineStartIndex,Hr.lineLength,-1,Ao,pr),XS=Dt.icon.placedSymbolArray.length-1,eE&&(wO=4*eE.length,Dt.addSymbols(Dt.icon,eE,Vd,Fi,hr,Hn,Ms.vertical,wn,on,Hr.lineStartIndex,Hr.lineLength,-1,Ao,pr),KS=Dt.icon.placedSymbolArray.length-1)}for(const ds in Sn.horizontal){const hs=Sn.horizontal[ds];zr||(kO=Ww(hs.text),Gi?Vf=LS(hs):zr=ub(ui,jd,on,mi,gi,di,hs,zi,Tn.layout.get("text-rotate").evaluate(Hn,{},pr),dr));const ey=hs.positionedLines.length===1;if(SO+=jP(Dt,wn,on,hs,bi,Tn,Gi,Hn,dr,Hr,Sn.vertical?Ms.horizontal:Ms.horizontalOnly,ey?Object.keys(Sn.horizontal):[ds],ml,XS,fr,Ao,pr),ey)break}Sn.vertical&&(EO+=jP(Dt,wn,on,Sn.vertical,bi,Tn,Gi,Hn,dr,Hr,Ms.vertical,["vertical"],ml,KS,fr,Ao,pr));let Yc=-1;const QS=(ds,hs)=>ds?Math.max(ds,hs):hs;Yc=QS(Vf,Yc),Yc=QS(Jg,Yc),Yc=QS(Qg,Yc);const U8=Yc>-1?1:0;Dt.glyphOffsetArray.length>=Hc.MAX_GLYPHS&&ni("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Hn.sortKey!==void 0&&Dt.addToSortKeyRanges(Dt.symbolInstances.length,Hn.sortKey),Dt.symbolInstances.emplaceBack(jd.x,jd.y,jd.z,on.x,on.y,ml.right>=0?ml.right:-1,ml.center>=0?ml.center:-1,ml.left>=0?ml.left:-1,ml.vertical>=0?ml.vertical:-1,XS,KS,kO,zr!==void 0?zr:Dt.collisionBoxArray.length,zr!==void 0?zr+1:Dt.collisionBoxArray.length,Br!==void 0?Br:Dt.collisionBoxArray.length,Br!==void 0?Br+1:Dt.collisionBoxArray.length,Mo!==void 0?Mo:Dt.collisionBoxArray.length,Mo!==void 0?Mo+1:Dt.collisionBoxArray.length,La||Dt.collisionBoxArray.length,La?La+1:Dt.collisionBoxArray.length,mi,SO,EO,xO,wO,U8,0,YS,JS,Yc)})(l,Jt,xn,Vt,c,h,m,Pt,l.layers[0],l.collisionBoxArray,s.index,s.sourceLayerIndex,l.index,we,at,C,0,He,Et,X,s,v,I,O,L)};if(Je==="line")for(const Vt of LP(s.geometry,0,0,ln,ln)){const Jt=a8(Vt,Se,Ue,c.vertical||re,h,xe,be,l.overscaling,ln);for(const qt of Jt)re&&g8(l,re.text,dt,qt)||it(Vt,qt,L)}else if(Je==="line-center"){for(const Vt of s.geometry)if(Vt.length>1){const Jt=s8(Vt,Ue,c.vertical||re,h,xe,be);Jt&&it(Vt,Jt,L)}}else if(s.type==="Polygon")for(const Vt of xS(s.geometry,0)){const Jt=d8(Vt,16);it(Vt[0],new Ql(Jt.x,Jt.y,0,0,void 0),L)}else if(s.type==="LineString")for(const Vt of s.geometry)it(Vt,new Ql(Vt[0].x,Vt[0].y,0,0,void 0),L);else if(s.type==="Point")for(const Vt of s.geometry)for(const Jt of Vt)it([Jt],new Ql(Jt.x,Jt.y,0,0,void 0),L)}const qg=255,Wc=qg*Oa;function jP(l,s,c,h,m,v,x,E,C,I,O,L,B,j,U,X,re){const he=function(be,Se,we,He,Ue,at,Et,Je){const dt=[];if(Se.positionedLines.length===0)return dt;const ht=He.layout.get("text-rotate").evaluate(at,{})*Math.PI/180,vt=function(qt){const xn=qt[0],Dt=qt[1],on=xn*Dt;return on>0?[xn,-Dt]:on<0?[-xn,Dt]:xn===0?[Dt,xn]:[Dt,-xn]}(we);let Pt=Math.abs(Se.top-Se.bottom);for(const qt of Se.positionedLines)Pt-=qt.lineOffset;const it=Se.positionedLines.length,Vt=Pt/it;let Jt=Se.top-we[1];for(let qt=0;qt<it;++qt){const xn=Se.positionedLines[qt];Jt=l8(Se,Vt,Jt,qt);for(const Dt of xn.positionedGlyphs){if(!Dt.rect)continue;const on=Dt.rect||{};let wn=xP+1,qn=!0,Sn=1,fn=0;if(Dt.imageName){const yi=Et[Dt.imageName];if(!yi)continue;if(yi.sdf){ni("SDF images are not supported in formatted text and will be ignored.");continue}qn=!1,Sn=yi.pixelRatio,wn=Wo/Sn}const bi=(Ue||Je)&&Dt.vertical,kn=Dt.metrics.advance*Dt.scale/2,Tn=Dt.metrics,ui=Dt.rect;if(ui===null)continue;Je&&Se.verticalizable&&(fn=Dt.imageName?kn-Dt.metrics.width*Dt.scale/2:0);const mi=Ue?[Dt.x+kn,Dt.y]:[0,0];let gi=[0,0],di=[0,0],zi=!1;Ue||(bi?(di=[Dt.x+kn+vt[0],Dt.y+vt[1]-fn],zi=!0):gi=[Dt.x+kn+we[0],Dt.y+we[1]-fn]);const Gi=ui.w*Dt.scale/(Sn*(Dt.localGlyph?Da:1)),dr=ui.h*Dt.scale/(Sn*(Dt.localGlyph?Da:1));let hi,Sr,hr,Fi;if(bi){const yi=Dt.y-Jt,Ao=new te(-kn,kn-yi),pr=-Math.PI/2,Hr=new te(...di);hi=new te(-kn+gi[0],gi[1]),hi._rotateAround(pr,Ao)._add(Hr),hi.x+=-yi+kn,hi.y-=(Tn.left-wn)*Dt.scale;const zr=Dt.imageName?Tn.advance*Dt.scale:Gr*Dt.scale,Mo=String.fromCharCode(Dt.glyph);UU(Mo)?hi.x+=(1-wn)*Dt.scale:qU(Mo)?hi.x+=zr-Tn.height*Dt.scale+(-wn-1)*Dt.scale:hi.x+=Dt.imageName||Tn.width+2*wn===ui.w&&Tn.height+2*wn===ui.h?(zr-dr)/2:(zr-(Tn.height+2*wn)*Dt.scale)/2,Sr=new te(hi.x,hi.y-Gi),hr=new te(hi.x+dr,hi.y),Fi=new te(hi.x+dr,hi.y-Gi)}else{const yi=(Tn.left-wn)*Dt.scale-kn+gi[0],Ao=(-Tn.top-wn)*Dt.scale+gi[1],pr=yi+Gi,Hr=Ao+dr;hi=new te(yi,Ao),Sr=new te(pr,Ao),hr=new te(yi,Hr),Fi=new te(pr,Hr)}if(ht){let yi;yi=Ue?new te(0,0):zi?new te(vt[0],vt[1]):new te(we[0],we[1]),hi._rotateAround(ht,yi),Sr._rotateAround(ht,yi),hr._rotateAround(ht,yi),Fi._rotateAround(ht,yi)}const Hn=new te(0,0),fr=new te(0,0);dt.push({tl:hi,tr:Sr,bl:hr,br:Fi,tex:on,writingMode:Se.writingMode,glyphOffset:mi,sectionIndex:Dt.sectionIndex,isSDF:qn,pixelOffsetTL:Hn,pixelOffsetBR:fr,minFontScaleX:0,minFontScaleY:0})}}return dt}(0,h,C,v,x,E,m,l.allowVerticalPlacement),xe=l.textSizeData;let fe=null;xe.kind==="source"?(fe=[Oa*v.layout.get("text-size").evaluate(E,{},re)],fe[0]>Wc&&ni(`${l.layerIds[0]}: Value for "text-size" is >= ${qg}. Reduce your "text-size".`)):xe.kind==="composite"&&(fe=[Oa*U.compositeTextSizes[0].evaluate(E,{},re),Oa*U.compositeTextSizes[1].evaluate(E,{},re)],(fe[0]>Wc||fe[1]>Wc)&&ni(`${l.layerIds[0]}: Value for "text-size" is >= ${qg}. Reduce your "text-size".`)),l.addSymbols(l.text,he,fe,C,x,E,O,s,c,I.lineStartIndex,I.lineLength,j,X,re);for(const be of L)B[be]=l.text.placedSymbolArray.length-1;return 4*he.length}function VP(l){for(const s in l)return l[s];return null}function ub(l,s,c,h,m,v,x,E,C,I){let O=x.top,L=x.bottom,B=x.left,j=x.right;const U=x.collisionPadding;if(U&&(B-=U[0],O-=U[1],j+=U[2],L+=U[3]),C){const X=new te(B,O),re=new te(j,O),he=new te(B,L),xe=new te(j,L),fe=tt(C);let be=new te(0,0);I&&(be=new te(I[0],I[1])),X._rotateAround(fe,be),re._rotateAround(fe,be),he._rotateAround(fe,be),xe._rotateAround(fe,be),B=Math.min(X.x,re.x,he.x,xe.x),j=Math.max(X.x,re.x,he.x,xe.x),O=Math.min(X.y,re.y,he.y,xe.y),L=Math.max(X.y,re.y,he.y,xe.y)}return l.emplaceBack(s.x,s.y,s.z,c.x,c.y,B,O,j,L,E,h,m,v),l.length-1}function LS(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const s=l.bottom-l.top;return s>0?Math.max(10,s):null}function g8(l,s,c,h){const m=l.compareText;if(s in m){const v=m[s];for(let x=v.length-1;x>=0;x--)if(h.dist(v[x])<c)return!0}else m[s]=[];return m[s].push(h),!1}function UP(l,s){const c=l.fovAboveCenter,h=l.elevation?l.elevation.getMinElevationBelowMSL()*s:0,m=(l._camera.position[2]*l.worldSize-h)/Math.cos(l._pitch),v=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-l._pitch-c,.01)),x=Math.sin(l._pitch)*v+m;return Math.min(1.01*x,m*(1/l._horizonShift))}function Nd(l,s){if(!s.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:s};const c=Math.pow(2,-l.z),h=l.x*c,m=(l.x+1)*c,v=l.y*c,x=(l.y+1)*c,E=As(h),C=As(m),I=eo(v),O=eo(x),L=s.project(E,I),B=s.project(C,I),j=s.project(C,O),U=s.project(E,O);let X=Math.min(L.x,B.x,j.x,U.x),re=Math.min(L.y,B.y,j.y,U.y),he=Math.max(L.x,B.x,j.x,U.x),xe=Math.max(L.y,B.y,j.y,U.y);const fe=c/16;function be(we,He,Ue,at,Et,Je){const dt=(Ue+Et)/2,ht=(at+Je)/2,vt=s.project(As(dt),eo(ht)),Pt=Math.max(0,X-vt.x,re-vt.y,vt.x-he,vt.y-xe);X=Math.min(X,vt.x),he=Math.max(he,vt.x),re=Math.min(re,vt.y),xe=Math.max(xe,vt.y),Pt>fe&&(be(we,vt,Ue,at,dt,ht),be(vt,He,dt,ht,Et,Je))}be(L,B,h,v,m,v),be(B,j,m,v,m,x),be(j,U,m,x,h,x),be(U,L,h,x,h,v),X-=fe,re-=fe,he+=fe,xe+=fe;const Se=1/Math.max(he-X,xe-re);return{scale:Se,x:X*Se,y:re*Se,x2:he*Se,y2:xe*Se,projection:s}}const y8=Aa(new Float32Array(16));class Gc{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,c){return{x:0,y:0,z:0}}unproject(s,c){return new ci(0,0)}projectTilePoint(s,c,h){return{x:s,y:c,z:0}}locationPoint(s,c,h=!0){return s._coordinatePoint(s.locationCoordinate(c),h)}pixelsPerMeter(s,c){return Pa(1,s)*c}pixelSpaceConversion(s,c,h){return 1}farthestPixelDistance(s){return UP(s,s.pixelsPerMeter)}pointCoordinate(s,c,h,m){const v=s.horizonLineFromTop(!1),x=new te(c,Math.max(v,h));return s.rayIntersectionCoordinate(s.pointRayIntersection(x,m))}pointCoordinate3D(s,c,h){const m=new te(c,h);if(s.elevation)return s.elevation.pointCoordinate(m);{const v=this.pointCoordinate(s,m.x,m.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(s,c){if(s.elevation)return!this.pointCoordinate3D(s,c.x,c.y);const h=s.horizonLineFromTop();return c.y<h}createInversionMatrix(s,c){return y8}createTileMatrix(s,c,h){let m,v,x;const E=h.canonical,C=Aa(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=Nd(E,this);m=1,v=I.x+h.wrap*I.scale,x=I.y,Od(C,C,[m/I.scale,m/I.scale,s.pixelsPerMeter/c])}else m=c/s.zoomScale(E.z),v=(E.x+Math.pow(2,E.z)*h.wrap)*m,x=E.y*m;return xg(C,C,[v,x,0]),Od(C,C,[m/ln,m/ln,1]),C}upVector(s,c,h){return[0,0,1]}upVectorScale(s,c,h){return{metersToTile:1}}}class v8 extends Gc{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[c,h]=this.parallels=s.parallels||[29.5,45.5],m=Math.sin(tt(c));this.n=(m+Math.sin(tt(h)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(s,c){const{n:h,c:m,r0:v}=this,x=tt(s-this.center[0]),E=tt(c),C=Math.sqrt(m-2*h*Math.sin(E))/h;return{x:C*Math.sin(x*h),y:C*Math.cos(x*h)-v,z:0}}unproject(s,c){const{n:h,c:m,r0:v}=this,x=v+c;let E=Math.atan2(s,Math.abs(x))*Math.sign(x);x*h<0&&(E-=Math.PI*Math.sign(s)*Math.sign(x));const C=tt(this.center[0])*h;E=Be(E,-Math.PI-C,Math.PI-C);const I=ze(At(E/h)+this.center[0],-180,180),O=Math.asin(ze((m-(s*s+x*x)*h*h)/(2*h),-1,1)),L=ze(At(O),-to,to);return new ci(I,L)}}const Wg=1.340264,Gg=-.081106,Hg=893e-6,Zg=.003796,db=Math.sqrt(3)/2;class b8 extends Gc{project(s,c){c=c/180*Math.PI,s=s/180*Math.PI;const h=Math.asin(db*Math.sin(c)),m=h*h,v=m*m*m;return{x:.5*(s*Math.cos(h)/(db*(Wg+3*Gg*m+v*(7*Hg+9*Zg*m)))/Math.PI+.5),y:1-.5*(h*(Wg+Gg*m+v*(Hg+Zg*m))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,m=h*h,v=m*m*m;for(let O,L,B,j=0;j<12&&(L=h*(Wg+Gg*m+v*(Hg+Zg*m))-c,B=Wg+3*Gg*m+v*(7*Hg+9*Zg*m),O=L/B,h=ze(h-O,-Math.PI/3,Math.PI/3),m=h*h,v=m*m*m,!(Math.abs(O)<1e-12));++j);const x=db*s*(Wg+3*Gg*m+v*(7*Hg+9*Zg*m))/Math.cos(h),E=Math.asin(Math.sin(h)/db),C=ze(180*x/Math.PI,-180,180),I=ze(180*E/Math.PI,-to,to);return new ci(C,I)}}class _8 extends Gc{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){return{x:.5+s/360,y:.5-c/360,z:0}}unproject(s,c){const h=360*(s-.5),m=ze(360*(.5-c),-to,to);return new ci(h,m)}}const $f=Math.PI/2;function hb(l){return Math.tan(($f+l)/2)}class x8 extends Gc{constructor(s){super(s),this.center=s.center||[0,30];const[c,h]=this.parallels=s.parallels||[30,30];let m=tt(c),v=tt(h);this.southernCenter=m+v<0,this.southernCenter&&(m=-m,v=-v);const x=Math.cos(m),E=hb(m);this.n=m===v?Math.sin(m):Math.log(x/Math.cos(v))/Math.log(hb(v)/E),this.f=x*Math.pow(hb(m),this.n)/this.n}project(s,c){c=tt(c),this.southernCenter&&(c=-c),s=tt(s-this.center[0]);const h=1e-6,{n:m,f:v}=this;v>0?c<-$f+h&&(c=-$f+h):c>$f-h&&(c=$f-h);const x=v/Math.pow(hb(c),m);let E=x*Math.sin(m*s),C=v-x*Math.cos(m*s);return E=.5*(E/Math.PI+.5),C=.5*(C/Math.PI+.5),{x:E,y:this.southernCenter?C:1-C,z:0}}unproject(s,c){s=(2*s-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:h,f:m}=this,v=m-c,x=Math.sign(v),E=Math.sign(h)*Math.sqrt(s*s+v*v);let C=Math.atan2(s,Math.abs(v))*x;v*h<0&&(C-=Math.PI*Math.sign(s)*x);const I=ze(At(C/h)+this.center[0],-180,180),O=ze(At(2*Math.atan(Math.pow(m/E,1/h))-$f),-to,to);return new ci(I,this.southernCenter?-O:O)}}class qP extends Gc{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,c){return{x:ul(s),y:dl(c),z:0}}unproject(s,c){const h=As(s),m=eo(c);return new ci(h,m)}}const WP=tt(to);class w8 extends Gc{project(s,c){const h=(c=tt(c))*c,m=h*h;return{x:.5*((s=tt(s))*(.8707-.131979*h+m*(m*(.003971*h-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+h*(.015085+m*(.028874*h-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let h=c=(2*(1-c)-1)*Math.PI,m=25,v=0,x=h*h;do{x=h*h;const I=x*x;v=(h*(1.007226+x*(.015085+I*(.028874*x-.044475-.005916*I)))-c)/(1.007226+x*(.045255+I*(.259866*x-.311325-.005916*11*I))),h=ze(h-v,-WP,WP)}while(Math.abs(v)>1e-6&&--m>0);x=h*h;const E=ze(At(s/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),C=At(h);return new ci(E,C)}}const GP=tt(to);class S8 extends Gc{project(s,c){c=tt(c),s=tt(s);const h=Math.cos(c),m=2/Math.PI,v=Math.acos(h*Math.cos(s/2)),x=Math.sin(v)/v,E=.5*(s*m+2*h*Math.sin(s/2)/x)||0,C=.5*(c+Math.sin(c)/x)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(s,c){let h=s=(2*s-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,v=25;const x=1e-6;let E=0,C=0;do{const I=Math.cos(m),O=Math.sin(m),L=2*O*I,B=O*O,j=I*I,U=Math.cos(h/2),X=Math.sin(h/2),re=2*U*X,he=X*X,xe=1-j*U*U,fe=xe?1/xe:0,be=xe?Math.acos(I*U)*Math.sqrt(1/xe):0,Se=.5*(2*be*I*X+2*h/Math.PI)-s,we=.5*(be*O+m)-c,He=.5*fe*(j*he+be*I*U*B)+1/Math.PI,Ue=fe*(re*L/4-be*O*X),at=.125*fe*(L*X-be*O*j*re),Et=.5*fe*(B*U+be*he*I)+.5,Je=Ue*at-Et*He;E=(we*Ue-Se*Et)/Je,C=(Se*at-we*He)/Je,h=ze(h-E,-Math.PI,Math.PI),m=ze(m-C,-GP,GP)}while((Math.abs(E)>x||Math.abs(C)>x)&&--v>0);return new ci(At(h),At(m))}}class HP extends Gc{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(tt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){const{scale:h,cosPhi:m}=this;return{x:tt(s)*m*h+.5,y:-Math.sin(tt(c))/m*h+.5,z:0}}unproject(s,c){const{scale:h,cosPhi:m}=this,v=-(c-.5)/h,x=ze(At((s-.5)/h)/m,-180,180),E=Math.asin(ze(v*m,-1,1)),C=ze(At(E),-to,to);return new ci(x,C)}}class E8 extends qP{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,c,h){const m=Ag(s,c,h);return er(m,m,Mg(cl(h))),{x:m[0],y:m[1],z:m[2]}}locationPoint(s,c){const h=kf(c.lat,c.lng),m=To([],h),v=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(c),s._centerAltitude):s._centerAltitude;kg(h,h,m,Pa(1,0)*ln*v);const x=Aa(new Float64Array(16));return Pd(x,s.pixelMatrix,s.globeMatrix),er(h,h,x),new te(h[0],h[1])}pixelsPerMeter(s,c){return Pa(1,0)*c}pixelSpaceConversion(s,c,h){const m=Pa(1,s)*c,v=Vn(Pa(1,45)*c,m,h);return this.pixelsPerMeter(s,c)/v}createTileMatrix(s,c,h){const m=oS(cl(h.canonical));return Pd(new Float64Array(16),s.globeMatrix,m)}createInversionMatrix(s,c){const{center:h}=s,m=Mg(cl(c));return $0(m,m,tt(h.lng)),Xw(m,m,tt(h.lat)),Od(m,m,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(s,c,h,m){return _M(s,c,h,!0)||new Cf(0,0)}pointCoordinate3D(s,c,h){const m=this.pointCoordinate(s,c,h,0);return[m.x,m.y,m.z]}isPointAboveHorizon(s,c){return!_M(s,c.x,c.y,!1)}farthestPixelDistance(s){const c=function(m,v){const x=m.cameraToCenterDistance,E=m._centerAltitude*v,C=m._camera,I=m._camera.forward(),O=Xl([],Is([],I,-x),[0,0,E]),L=m.worldSize/(2*Math.PI),B=[0,0,-L],j=m.width/m.height,U=Math.tan(m.fovAboveCenter),X=Is([],C.up(),U),re=Is([],C.right(),U*j),he=To([],Xl([],Xl([],I,X),re)),xe=[];let fe;if(new Qw(O,he).closestPointOnSphere(B,L,xe)){const be=Xl([],xe,B),Se=Ma([],be,O);fe=Math.cos(m.fovAboveCenter)*wg(Se)}else{const be=Ma([],O,B),Se=Ma([],B,O);To(Se,Se);const we=wg(be)-L;fe=Math.sqrt(we*(we+2*L));const He=Math.acos(fe/(L+we))-Math.acos(Qs(I,Se));fe*=Math.cos(He)}return 1.01*fe}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),h=Tf(s.zoom);if(h>0){const m=UP(s,Pa(1,s.center.lat)*s.worldSize),v=s.worldSize/(2*Math.PI),x=Math.max(s.width,s.height)/s.worldSize*Math.PI;return Vn(c,m+v*(1-Math.cos(x)),Math.pow(h,10))}return c}upVector(s,c,h){return Ag(c,h,s,1)}upVectorScale(s){return{metersToTile:j0(U0(cl(s)))}}}function ZP(l){const s=l.parallels,c=!!s&&Math.abs(s[0]+s[1])<.01;switch(l.name){case"mercator":return new qP(l);case"equirectangular":return new _8(l);case"naturalEarth":return new w8(l);case"equalEarth":return new b8(l);case"winkelTripel":return new S8(l);case"albers":return c?new HP(l):new v8(l);case"lambertConformalConic":return c?new HP(l):new x8(l);case"globe":return new E8(l)}throw new Error(`Invalid projection name: ${l.name}`)}const k8=Q0.types,T8=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fb(l,s,c,h,m,v,x,E,C,I,O,L,B){const j=E?Math.min(Wc,Math.round(E[0])):0,U=E?Math.min(Wc,Math.round(E[1])):0;l.emplaceBack(s,c,Math.round(32*h),Math.round(32*m),v,x,(j<<1)+(C?1:0),U,16*I,16*O,256*L,256*B)}function pb(l,s,c,h,m,v,x){l.emplaceBack(s,c,h,m,v,x)}function mb(l,s,c,h,m){l.emplaceBack(s,c,h,m),l.emplaceBack(s,c,h,m),l.emplaceBack(s,c,h,m),l.emplaceBack(s,c,h,m)}function C8(l){for(const s of l.sections)if(qw(s.text))return!0;return!1}class zS{constructor(s){this.layoutVertexArray=new pt,this.indexArray=new tn,this.programConfigurations=s,this.segments=new cr,this.dynamicLayoutVertexArray=new bt,this.opacityVertexArray=new rn,this.placedSymbolArray=new lr,this.globeExtVertexArray=new It}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(s,c,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,LU.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,BU.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,T8,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,zU.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Kt(zS,"SymbolBuffers");class BS{constructor(s,c,h){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new h,this.segments=new cr,this.collisionVertexArray=new Dn,this.collisionVertexArrayExt=new Mn}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,FU.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,NU.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Kt(BS,"CollisionBuffers");class Hc{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(x=>x.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Aa([]),this.placementViewportMatrix=Aa([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=kS(this.zoom,c["text-size"]),this.iconSizeData=kS(this.zoom,c["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),v=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(x=>Ms[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new zS(new Md(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new zS(new Md(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new ko,this.lineVertexArray=new _f,this.symbolInstances=new Si}calculateGlyphDependencies(s,c,h,m,v){for(let x=0;x<s.length;x++)if(c[s.charCodeAt(x)]=!0,m&&v){const E=jg[s.charAt(x)];E&&(c[E.charCodeAt(0)]=!0)}}populate(s,c,h,m){const v=this.layers[0],x=v.layout,E=this.projection.name==="globe",C=x.get("text-font"),I=x.get("text-field"),O=x.get("icon-image"),L=(I.value.kind!=="constant"||I.value.value instanceof Eo&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),B=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,j=x.get("symbol-sort-key");if(this.features=[],!L&&!B)return;const U=c.iconDependencies,X=c.glyphDependencies,re=c.availableImages,he=new R(this.zoom);for(const{feature:xe,id:fe,index:be,sourceLayerIndex:Se}of s){const we=v._featureFilter.needGeometry,He=zd(xe,we);if(!v._featureFilter.filter(he,He,h))continue;if(we||(He.geometry=Kl(xe,h,m)),E&&xe.type!==1&&h.z<=5){const Je=He.geometry,dt=.98078528056,ht=(vt,Pt)=>Qs(Ag(vt.x,vt.y,h,1),Ag(Pt.x,Pt.y,h,1))<dt;for(let vt=0;vt<Je.length;vt++)Je[vt]=BV(Je[vt],ht)}let Ue,at;if(L){const Je=v.getValueAndResolveTokens("text-field",He,h,re),dt=Eo.factory(Je);C8(dt)&&(this.hasRTLText=!0),(!this.hasRTLText||k()==="unavailable"||this.hasRTLText&&P.isParsed())&&(Ue=VU(dt,v,He))}if(B){const Je=v.getValueAndResolveTokens("icon-image",He,h,re);at=Je instanceof rs?Je:rs.fromString(Je)}if(!Ue&&!at)continue;const Et=this.sortFeaturesByKey?j.evaluate(He,{},h):void 0;if(this.features.push({id:fe,text:Ue,icon:at,index:be,sourceLayerIndex:Se,geometry:He.geometry,properties:xe.properties,type:k8[xe.type],sortKey:Et}),at&&(U[at.name]=!0),Ue){const Je=C.evaluate(He,{},h).join(","),dt=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ms.vertical)>=0;for(const ht of Ue.sections)if(ht.image)U[ht.image.name]=!0;else{const vt=pg(Ue.toString()),Pt=ht.fontStack||Je,it=X[Pt]=X[Pt]||{};this.calculateGlyphDependencies(ht.text,it,dt,this.allowVerticalPlacement,vt)}}}x.get("symbol-placement")==="line"&&(this.features=function(xe){const fe={},be={},Se=[];let we=0;function He(Je){Se.push(xe[Je]),we++}function Ue(Je,dt,ht){const vt=be[Je];return delete be[Je],be[dt]=vt,Se[vt].geometry[0].pop(),Se[vt].geometry[0]=Se[vt].geometry[0].concat(ht[0]),vt}function at(Je,dt,ht){const vt=fe[dt];return delete fe[dt],fe[Je]=vt,Se[vt].geometry[0].shift(),Se[vt].geometry[0]=ht[0].concat(Se[vt].geometry[0]),vt}function Et(Je,dt,ht){const vt=ht?dt[0][dt[0].length-1]:dt[0][0];return`${Je}:${vt.x}:${vt.y}`}for(let Je=0;Je<xe.length;Je++){const dt=xe[Je],ht=dt.geometry,vt=dt.text?dt.text.toString():null;if(!vt){He(Je);continue}const Pt=Et(vt,ht),it=Et(vt,ht,!0);if(Pt in be&&it in fe&&be[Pt]!==fe[it]){const Vt=at(Pt,it,ht),Jt=Ue(Pt,it,Se[Vt].geometry);delete fe[Pt],delete be[it],be[Et(vt,Se[Jt].geometry,!0)]=Jt,Se[Vt].geometry=null}else Pt in be?Ue(Pt,it,ht):it in fe?at(Pt,it,ht):(He(Je),fe[Pt]=we-1,be[it]=we-1)}return Se.filter(Je=>Je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((xe,fe)=>xe.sortKey-fe.sortKey)}update(s,c,h,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,c,this.layers,h,m),this.icon.programConfigurations.updatePaintArrays(s,c,this.layers,h,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=ZP(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const h=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:m,y:v}of c)this.lineVertexArray.emplaceBack(m,v);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(s,c,h,m,v,x,E,C,I,O,L,B,j,U){const X=s.indexArray,re=s.layoutVertexArray,he=s.globeExtVertexArray,xe=s.segments.prepareSegment(4*c.length,re,X,this.canOverlap?x.sortKey:void 0),fe=this.glyphOffsetArray.length,be=xe.vertexLength,Se=this.allowVerticalPlacement&&E===Ms.vertical?Math.PI/2:0,we=x.text&&x.text.sections;for(let Ue=0;Ue<c.length;Ue++){const{tl:at,tr:Et,bl:Je,br:dt,tex:ht,pixelOffsetTL:vt,pixelOffsetBR:Pt,minFontScaleX:it,minFontScaleY:Vt,glyphOffset:Jt,isSDF:qt,sectionIndex:xn}=c[Ue],Dt=xe.vertexLength,on=Jt[1];if(fb(re,I.x,I.y,at.x,on+at.y,ht.x,ht.y,h,qt,vt.x,vt.y,it,Vt),fb(re,I.x,I.y,Et.x,on+Et.y,ht.x+ht.w,ht.y,h,qt,Pt.x,vt.y,it,Vt),fb(re,I.x,I.y,Je.x,on+Je.y,ht.x,ht.y+ht.h,h,qt,vt.x,Pt.y,it,Vt),fb(re,I.x,I.y,dt.x,on+dt.y,ht.x+ht.w,ht.y+ht.h,h,qt,Pt.x,Pt.y,it,Vt),C){const{x:wn,y:qn,z:Sn}=C.anchor,[fn,bi,kn]=C.up;pb(he,wn,qn,Sn,fn,bi,kn),pb(he,wn,qn,Sn,fn,bi,kn),pb(he,wn,qn,Sn,fn,bi,kn),pb(he,wn,qn,Sn,fn,bi,kn),mb(s.dynamicLayoutVertexArray,wn,qn,Sn,Se)}else mb(s.dynamicLayoutVertexArray,I.x,I.y,I.z,Se);X.emplaceBack(Dt,Dt+1,Dt+2),X.emplaceBack(Dt+1,Dt+2,Dt+3),xe.vertexLength+=4,xe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Jt[0]),Ue!==c.length-1&&xn===c[Ue+1].sectionIndex||s.programConfigurations.populatePaintArrays(re.length,x,x.index,{},j,U,we&&we[xn])}const He=C?C.anchor:I;s.placedSymbolArray.emplaceBack(He.x,He.y,He.z,I.x,I.y,fe,this.glyphOffsetArray.length-fe,be,O,L,I.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],E,0,!1,0,B,0)}_commitLayoutVertex(s,c,h,m,v,x,E){s.emplaceBack(c,h,m,v,x,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(s,c,h,m,v,x,E){const C=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),I=C.vertexLength,O=E.tileAnchorX,L=E.tileAnchorY;for(let j=0;j<4;j++)h.collisionVertexArray.emplaceBack(0,0,0,0);h.collisionVertexArrayExt.emplaceBack(c,-s.padding,-s.padding),h.collisionVertexArrayExt.emplaceBack(c,s.padding,-s.padding),h.collisionVertexArrayExt.emplaceBack(c,s.padding,s.padding),h.collisionVertexArrayExt.emplaceBack(c,-s.padding,s.padding),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,O,L,new te(s.x1,s.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,O,L,new te(s.x2,s.y1)),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,O,L,new te(s.x2,s.y2)),this._commitLayoutVertex(h.layoutVertexArray,m,v,x,O,L,new te(s.x1,s.y2)),C.vertexLength+=4;const B=h.indexArray;B.emplaceBack(I,I+1),B.emplaceBack(I+1,I+2),B.emplaceBack(I+2,I+3),B.emplaceBack(I+3,I),C.primitiveLength+=4}_addTextDebugCollisionBoxes(s,c,h,m,v,x){for(let E=m;E<v;E++){const C=h.get(E),I=this.getSymbolInstanceTextSize(s,x,c,E);this._addCollisionDebugVertices(C,I,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(s,c,h,m,v,x){for(let E=m;E<v;E++){const C=h.get(E),I=this.getSymbolInstanceIconSize(s,c,x.placedIconSymbolIndex);this._addCollisionDebugVertices(C,I,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,x)}}generateCollisionDebugBuffers(s,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new BS(Yt,fP.members,Lr),this.iconCollisionBox=new BS(Yt,fP.members,Lr);const h=Of(this.iconSizeData,s),m=Of(this.textSizeData,s);for(let v=0;v<this.symbolInstances.length;v++){const x=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(m,s,c,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(m,s,c,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,s,c,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(h,s,c,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(s,c,h,m){const v=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),x=ib(this.textSizeData,s,v)/Gr;return this.tilePixelRatio*x}getSymbolInstanceIconSize(s,c,h){const m=this.icon.placedSymbolArray.get(h),v=ib(this.iconSizeData,s,m);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(s,c,h){s.emplaceBack(c,-h,-h),s.emplaceBack(c,h,-h),s.emplaceBack(c,h,h),s.emplaceBack(c,-h,h)}_updateTextDebugCollisionBoxes(s,c,h,m,v,x){for(let E=m;E<v;E++){const C=h.get(E),I=this.getSymbolInstanceTextSize(s,x,c,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,I,C.padding)}}_updateIconDebugCollisionBoxes(s,c,h,m,v,x){for(let E=m;E<v;E++){const C=h.get(E),I=this.getSymbolInstanceIconSize(s,c,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,I,C.padding)}}updateCollisionDebugBuffers(s,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=Of(this.iconSizeData,s),m=Of(this.textSizeData,s);for(let v=0;v<this.symbolInstances.length;v++){const x=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(m,s,c,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(m,s,c,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(h,s,c,x.iconBoxStartIndex,x.iconBoxEndIndex,x.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(h,s,c,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,c,h,m,v,x,E,C,I){const O={};if(c<h){const{x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be,featureIndex:Se}=s.get(c);O.textBox={x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be},O.textFeatureIndex=Se}if(m<v){const{x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be,featureIndex:Se}=s.get(m);O.verticalTextBox={x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be},O.verticalTextFeatureIndex=Se}if(x<E){const{x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be,featureIndex:Se}=s.get(x);O.iconBox={x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be},O.iconFeatureIndex=Se}if(C<I){const{x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be,featureIndex:Se}=s.get(C);O.verticalIconBox={x1:L,y1:B,x2:j,y2:U,padding:X,projectedAnchorX:re,projectedAnchorY:he,projectedAnchorZ:xe,tileAnchorX:fe,tileAnchorY:be},O.verticalIconFeatureIndex=Se}return O}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const h=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,c){const h=s.placedSymbolArray.get(c),m=h.vertexStartIndex+4*h.numGlyphs;for(let v=h.vertexStartIndex;v<m;v+=4)s.indexArray.emplaceBack(v,v+1,v+2),s.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(s),h=Math.cos(s),m=[],v=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const C=this.symbolInstances.get(E);m.push(0|Math.round(c*C.tileAnchorX+h*C.tileAnchorY)),v.push(C.featureIndex)}return x.sort((E,C)=>m[E]-m[C]||v[C]-v[E]),x}addToSortKeyRanges(s,c){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===c?h.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const h=this.symbolInstances.get(c);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:I}=h;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&v!==m&&this.addIndicesForPlacedSymbol(this.text,v),x>=0&&x!==v&&x!==m&&this.addIndicesForPlacedSymbol(this.text,x),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Kt(Hc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Hc.MAX_GLYPHS=65535,Hc.addDynamicAttributes=mb;const I8=new ye({"symbol-placement":new Z(st.layout_symbol["symbol-placement"]),"symbol-spacing":new Z(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Z(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new oe(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Z(st.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Z(st.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Z(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new Z(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Z(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new oe(st.layout_symbol["icon-size"]),"icon-text-fit":new Z(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Z(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new oe(st.layout_symbol["icon-image"]),"icon-rotate":new oe(st.layout_symbol["icon-rotate"]),"icon-padding":new Z(st.layout_symbol["icon-padding"]),"icon-keep-upright":new Z(st.layout_symbol["icon-keep-upright"]),"icon-offset":new oe(st.layout_symbol["icon-offset"]),"icon-anchor":new oe(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Z(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Z(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Z(st.layout_symbol["text-rotation-alignment"]),"text-field":new oe(st.layout_symbol["text-field"]),"text-font":new oe(st.layout_symbol["text-font"]),"text-size":new oe(st.layout_symbol["text-size"]),"text-max-width":new oe(st.layout_symbol["text-max-width"]),"text-line-height":new oe(st.layout_symbol["text-line-height"]),"text-letter-spacing":new oe(st.layout_symbol["text-letter-spacing"]),"text-justify":new oe(st.layout_symbol["text-justify"]),"text-radial-offset":new oe(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Z(st.layout_symbol["text-variable-anchor"]),"text-anchor":new oe(st.layout_symbol["text-anchor"]),"text-max-angle":new Z(st.layout_symbol["text-max-angle"]),"text-writing-mode":new Z(st.layout_symbol["text-writing-mode"]),"text-rotate":new oe(st.layout_symbol["text-rotate"]),"text-padding":new Z(st.layout_symbol["text-padding"]),"text-keep-upright":new Z(st.layout_symbol["text-keep-upright"]),"text-transform":new oe(st.layout_symbol["text-transform"]),"text-offset":new oe(st.layout_symbol["text-offset"]),"text-allow-overlap":new Z(st.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Z(st.layout_symbol["text-ignore-placement"]),"text-optional":new Z(st.layout_symbol["text-optional"])});var FS={paint:new ye({"icon-opacity":new oe(st.paint_symbol["icon-opacity"]),"icon-color":new oe(st.paint_symbol["icon-color"]),"icon-halo-color":new oe(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new oe(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new oe(st.paint_symbol["icon-halo-blur"]),"icon-translate":new Z(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new Z(st.paint_symbol["icon-translate-anchor"]),"text-opacity":new oe(st.paint_symbol["text-opacity"]),"text-color":new oe(st.paint_symbol["text-color"],{runtimeType:Uo,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new oe(st.paint_symbol["text-halo-color"]),"text-halo-width":new oe(st.paint_symbol["text-halo-width"]),"text-halo-blur":new oe(st.paint_symbol["text-halo-blur"]),"text-translate":new Z(st.paint_symbol["text-translate"]),"text-translate-anchor":new Z(st.paint_symbol["text-translate-anchor"])}),layout:I8};class XP{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Sc,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Kt(XP,"FormatSectionOverride",{omit:["defaultValue"]});class gb extends Ia{constructor(s){super(s,FS)}recalculate(s,c){super.recalculate(s,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const v of h)m.indexOf(v)<0&&m.push(v);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,c,h,m){const v=this.layout.get(s).evaluate(c,{},h,m),x=this._unevaluatedLayout._values[s];return x.isDataDriven()||Lc(x.value)||!v?v:function(E,C){return C.replace(/{([^{}]+)}/g,(I,O)=>O in E?String(E[O]):"")}(c.properties,v)}createBucket(s){return new Hc(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of FS.paint.overridableProperties){if(!gb.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),h=new XP(c),m=new hf(h,c.property.specification);let v=null;v=c.value.kind==="constant"||c.value.kind==="source"?new ig("source",m):new xd("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[s]=new le(c.property,v,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,h){return!(!this.layout||c.isDataDriven()||h.isDataDriven())&&gb.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const h=s.get("text-field"),m=FS.paint.properties[c];let v=!1;const x=E=>{for(const C of E)if(m.overrides&&m.overrides.hasOverride(C))return void(v=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Eo)x(h.value.value.sections);else if(h.value.kind==="source"){const E=I=>{v||(I instanceof Fl&&Wi(I.value)===rd?x(I.value.sections):I instanceof ol?x(I.sections):I.eachChild(E))},C=h.value;C._styleExpression&&E(C._styleExpression.expression)}return v}getProgramConfiguration(s){return new Vc(this,s)}}var A8={paint:new ye({"background-color":new Z(st.paint_background["background-color"]),"background-pattern":new Z(st.paint_background["background-pattern"]),"background-opacity":new Z(st.paint_background["background-opacity"])})},M8={paint:new ye({"raster-opacity":new Z(st.paint_raster["raster-opacity"]),"raster-hue-rotate":new Z(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Z(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Z(st.paint_raster["raster-brightness-max"]),"raster-saturation":new Z(st.paint_raster["raster-saturation"]),"raster-contrast":new Z(st.paint_raster["raster-contrast"]),"raster-resampling":new Z(st.paint_raster["raster-resampling"]),"raster-fade-duration":new Z(st.paint_raster["raster-fade-duration"])})};class P8 extends Ia{constructor(s){super(s,{}),this.implementation=s}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var O8={paint:new ye({"sky-type":new Z(st.paint_sky["sky-type"]),"sky-atmosphere-sun":new Z(st.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Z(st.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Z(st.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Z(st.paint_sky["sky-gradient-radius"]),"sky-gradient":new ge(st.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Z(st.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Z(st.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Z(st.paint_sky["sky-opacity"])})};function NS(l,s,c){const h=[0,0,1],m=pM([]);return gM(m,m,c?-tt(l)+Math.PI:tt(l)),mM(m,m,-tt(s)),uM(h,h,m),To(h,h)}const D8={circle:class extends Ia{constructor(l){super(l,qV)}createBucket(l){return new dS(l)}queryRadius(l){const s=l;return If("circle-radius",this,s)+If("circle-stroke-width",this,s)+G0(this.paint.get("circle-translate"))}queryIntersectsFeature(l,s,c,h,m,v,x,E){const C=FM(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,l.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c);return NM(l,h,v,x,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",C,I)}getProgramIds(){return["circle"]}getProgramConfiguration(l){return new Vc(this,l)}},heatmap:class extends Ia{createBucket(l){return new jM(l)}constructor(l){super(l,ZV),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return If("heatmap-radius",this,l)}queryIntersectsFeature(l,s,c,h,m,v,x,E){const C=this.paint.get("heatmap-radius").evaluate(s,c);return NM(l,h,v,x,E,!0,!0,new te(0,0),C)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(l){return new Vc(this,l)}},hillshade:class extends Ia{constructor(l){super(l,XV)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ia{constructor(l){super(l,dU)}getProgramIds(){const l=this.paint.get("fill-pattern"),s=l&&l.constantOr(1),c=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(l){return new Vc(this,l)}recalculate(l,s){super.recalculate(l,s);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new Y0(l)}queryRadius(){return G0(this.paint.get("fill-translate"))}queryIntersectsFeature(l,s,c,h,m,v){return!l.queryGeometry.isAboveHorizon&&DM(BM(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,l.pixelToTileUnitsFactor),h)}isTileClipped(){return!0}},"fill-extrusion":class extends Ia{constructor(l){super(l,CU)}createBucket(l){return new Fg(l)}queryRadius(){return G0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(l){return new Vc(this,l)}queryIntersectsFeature(l,s,c,h,m,v,x,E,C){const I=FM(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,l.pixelToTileUnitsFactor),O=this.paint.get("fill-extrusion-height").evaluate(s,c),L=this.paint.get("fill-extrusion-base").evaluate(s,c),B=[0,0],j=E&&v.elevation,U=v.elevation?v.elevation.exaggeration():1,X=l.tile.getBucket(this);if(j&&X instanceof Fg){const be=X.centroidVertexArray,Se=C+1;Se<be.length&&(B[0]=be.geta_centroid_pos0(Se),B[1]=be.geta_centroid_pos1(Se))}if(B[0]===0&&B[1]===1)return!1;v.projection.name==="globe"&&(h=oP([h],[new te(0,0),new te(ln,ln)],l.tileID.canonical).map(be=>be.polygon).flat());const re=j?E:null,[he,xe]=function(be,Se,we,He,Ue,at,Et,Je,dt,ht,vt){return be.projection.name==="globe"?function(Pt,it,Vt,Jt,qt,xn,Dt,on,wn,qn,Sn){const fn=[],bi=[],kn=Pt.projection.upVectorScale(Sn,Pt.center.lat,Pt.worldSize).metersToTile,Tn=[0,0,0,1],ui=[0,0,0,1],mi=(di,zi,Gi,dr)=>{di[0]=zi,di[1]=Gi,di[2]=dr,di[3]=1},gi=rP();Vt>0&&(Vt+=gi),Jt+=gi;for(const di of it){const zi=[],Gi=[];for(const dr of di){const hi=dr.x+qt.x,Sr=dr.y+qt.y,hr=Pt.projection.projectTilePoint(hi,Sr,Sn),Fi=Pt.projection.upVector(Sn,dr.x,dr.y);let Hn=Vt,fr=Jt;if(Dt){const yi=cP(hi,Sr,Vt,Jt,Dt,on,wn,qn);Hn+=yi.base,fr+=yi.top}Vt!==0?mi(Tn,hr.x+Fi[0]*kn*Hn,hr.y+Fi[1]*kn*Hn,hr.z+Fi[2]*kn*Hn):mi(Tn,hr.x,hr.y,hr.z),mi(ui,hr.x+Fi[0]*kn*fr,hr.y+Fi[1]*kn*fr,hr.z+Fi[2]*kn*fr),er(Tn,Tn,xn),er(ui,ui,xn),zi.push(new Pf(Tn[0],Tn[1],Tn[2])),Gi.push(new Pf(ui[0],ui[1],ui[2]))}fn.push(zi),bi.push(Gi)}return[fn,bi]}(be,Se,we,He,Ue,at,Et,Je,dt,ht,vt):Et?function(Pt,it,Vt,Jt,qt,xn,Dt,on,wn){const qn=[],Sn=[],fn=[0,0,0,1];for(const bi of Pt){const kn=[],Tn=[];for(const ui of bi){const mi=ui.x+Jt.x,gi=ui.y+Jt.y,di=cP(mi,gi,it,Vt,xn,Dt,on,wn);fn[0]=mi,fn[1]=gi,fn[2]=di.base,fn[3]=1,Dd(fn,fn,qt),fn[3]=Math.max(fn[3],1e-5);const zi=new Pf(fn[0]/fn[3],fn[1]/fn[3],fn[2]/fn[3]);fn[0]=mi,fn[1]=gi,fn[2]=di.top,fn[3]=1,Dd(fn,fn,qt),fn[3]=Math.max(fn[3],1e-5);const Gi=new Pf(fn[0]/fn[3],fn[1]/fn[3],fn[2]/fn[3]);kn.push(zi),Tn.push(Gi)}qn.push(kn),Sn.push(Tn)}return[qn,Sn]}(Se,we,He,Ue,at,Et,Je,dt,ht):function(Pt,it,Vt,Jt,qt){const xn=[],Dt=[],on=qt[8]*it,wn=qt[9]*it,qn=qt[10]*it,Sn=qt[11]*it,fn=qt[8]*Vt,bi=qt[9]*Vt,kn=qt[10]*Vt,Tn=qt[11]*Vt;for(const ui of Pt){const mi=[],gi=[];for(const di of ui){const zi=di.x+Jt.x,Gi=di.y+Jt.y,dr=qt[0]*zi+qt[4]*Gi+qt[12],hi=qt[1]*zi+qt[5]*Gi+qt[13],Sr=qt[2]*zi+qt[6]*Gi+qt[14],hr=qt[3]*zi+qt[7]*Gi+qt[15],Fi=dr+on,Hn=hi+wn,fr=Sr+qn,yi=Math.max(hr+Sn,1e-5),Ao=dr+fn,pr=hi+bi,Hr=Sr+kn,zr=Math.max(hr+Tn,1e-5);mi.push(new Pf(Fi/yi,Hn/yi,fr/yi)),gi.push(new Pf(Ao/zr,pr/zr,Hr/zr))}xn.push(mi),Dt.push(gi)}return[xn,Dt]}(Se,we,He,Ue,at)}(v,h,L,O,I,x,re,B,U,v.center.lat,l.tileID.canonical),fe=l.queryGeometry;return function(be,Se,we){let He=1/0;DM(we,Se)&&(He=lP(we,Se[0]));for(let Ue=0;Ue<Se.length;Ue++){const at=Se[Ue],Et=be[Ue];for(let Je=0;Je<at.length-1;Je++){const dt=at[Je],ht=[dt,at[Je+1],Et[Je+1],Et[Je],dt];OM(we,ht)&&(He=Math.min(He,lP(we,ht)))}}return He!==1/0&&He}(he,xe,fe.isPointQuery()?fe.screenBounds:fe.screenGeometry)}},line:class extends Ia{constructor(l){super(l,uP),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof qm,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,s){super.recalculate(l,s),this.paint._values["line-floorwidth"]=dP.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new nb(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(l){return new Vc(this,l)}queryRadius(l){const s=l,c=hP(If("line-width",this,s),If("line-gap-width",this,s)),h=If("line-offset",this,s);return c/2+Math.abs(h)+G0(this.paint.get("line-translate"))}queryIntersectsFeature(l,s,c,h,m,v){if(l.queryGeometry.isAboveHorizon)return!1;const x=BM(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,l.pixelToTileUnitsFactor),E=l.pixelToTileUnitsFactor/2*hP(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),C=this.paint.get("line-offset").evaluate(s,c);return C&&(h=function(I,O){const L=[],B=new te(0,0);for(let j=0;j<I.length;j++){const U=I[j],X=[];for(let re=0;re<U.length;re++){const he=U[re],xe=U[re+1],fe=re===0?B:he.sub(U[re-1])._unit()._perp(),be=re===U.length-1?B:xe.sub(he)._unit()._perp(),Se=fe._add(be)._unit();Se._mult(1/(Se.x*be.x+Se.y*be.y)),X.push(Se._mult(O)._add(he))}L.push(X)}return L}(h,C*l.pixelToTileUnitsFactor)),function(I,O,L){for(let B=0;B<O.length;B++){const j=O[B];if(I.length>=3){for(let U=0;U<j.length;U++)if(Bd(I,j[U]))return!0}if($V(I,j,L))return!0}return!1}(x,h,E)}isTileClipped(){return!0}},symbol:gb,background:class extends Ia{constructor(l){super(l,A8)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ia{constructor(l){super(l,M8)}getProgramIds(){return["raster"]}},sky:class extends Ia{constructor(l){super(l,O8),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=mS({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(l,s){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),m=!h,v=l.style.light,x=v.properties.get("position");return m&&v.properties.get("anchor")==="viewport"&&ni("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?NS(x.azimuthal,90-x.polar,s):NS(h[0],90-h[1],s)}const c=this.paint.get("sky-gradient-center");return NS(c[0],90-c[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}}};class Xg{constructor(s,c,h,m){this.context=s,this.format=h,this.texture=s.gl.createTexture(),this.update(c,m)}update(s,c,h){const{width:m,height:v}=s,{context:x}=this,{gl:E}=x,{HTMLImageElement:C,HTMLCanvasElement:I,HTMLVideoElement:O,ImageData:L,ImageBitmap:B}=f;if(E.bindTexture(E.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!c||c.premultiply!==!1)),h||this.size&&this.size[0]===m&&this.size[1]===v){const{x:j,y:U}=h||{x:0,y:0};s instanceof C||s instanceof I||s instanceof O||s instanceof L||B&&s instanceof B?E.texSubImage2D(E.TEXTURE_2D,0,j,U,E.RGBA,E.UNSIGNED_BYTE,s):E.texSubImage2D(E.TEXTURE_2D,0,j,U,m,v,E.RGBA,E.UNSIGNED_BYTE,s.data)}else this.size=[m,v],s instanceof C||s instanceof I||s instanceof O||s instanceof L||B&&s instanceof B?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,s):E.texImage2D(E.TEXTURE_2D,0,this.format,m,v,0,this.format,E.UNSIGNED_BYTE,s.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(s,c){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?s===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:s),this.filter=s),c!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class R8{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class L8{constructor(){this.tasks={},this.taskQueue=[],Ci(["process"],this),this.invoker=new R8(this.process),this.nextId=0}add(s,c){const h=this.nextId++,m=function({type:v,isSymbolTile:x,zoom:E}){return E=E||0,v==="message"?0:v!=="maybePrepare"||x?v!=="parseTile"||x?v==="parseTile"&&x?300-E:v==="maybePrepare"&&x?400-E:500:200-E:100-E}(c);if(m===0){jo();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[h]={fn:s,metadata:c,priority:m,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){jo();try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const c=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let s=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const v=this.tasks[this.taskQueue[m]];v.priority<c&&(c=v.priority,s=m)}if(s===null)return null;const h=this.taskQueue[s];return this.taskQueue.splice(s,1),h}remove(){this.invoker.remove()}}class KP{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const h=s[c];this._stringToNumber[h]=c,this._numberToString[c]=h}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const z8=["tile","layer","source","sourceLayer","state"];class YP{constructor(s,c,h,m,v){this.type="Feature",this._vectorTileFeature=s,this._z=c,this._x=h,this._y=m,this.properties=s.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(s.id=this.id);for(const c of z8)this[c]!==void 0&&(s[c]=this[c]);return s}}const na=32,hl=33,Zc=new Uint16Array(8184);for(let l=0;l<2046;l++){let s=l+2,c=0,h=0,m=0,v=0,x=0,E=0;for(1&s?m=v=x=na:c=h=E=na;(s>>=1)>1;){const I=c+m>>1,O=h+v>>1;1&s?(m=c,v=h,c=x,h=E):(c=m,h=v,m=x,v=E),x=I,E=O}const C=4*l;Zc[C+0]=c,Zc[C+1]=h,Zc[C+2]=m,Zc[C+3]=v}const fl=new Uint16Array(2178),Xc=new Uint8Array(1089),yb=new Uint16Array(1089);function JP(l){return l===0?-.03125:l===32?.03125:0}var QP=Re([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const eO={type:2,extent:ln,loadGeometry:()=>[[new te(0,0),new te(ln+1,0),new te(ln+1,ln+1),new te(0,ln+1),new te(0,0)]]};class $S{constructor(s,c,h,m,v){this.tileID=s,this.uid=Xt(),this.uses=0,this.tileSize=c,this.tileZoom=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(s){const c=s+this.timeAdded;c<$t.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Nd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,c,h){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(m,v){const x={};if(!v)return x;for(const E of m){const C=E.layerIds.map(I=>v.getLayer(I)).filter(Boolean);if(C.length!==0){E.layers=C,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(I=>C.filter(O=>O.id===I)[0]));for(const I of C)x[I.id]=E}}return x}(s.buckets,c.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof Hc){if(this.hasSymbolBuckets=!0,!h)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof Hc&&v.hasRTLText){this.hasRTLText=!0,P.isLoading()||P.isLoaded()||k()!=="deferred"||M();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(m).queryRadius(v))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new li}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const h in this.buckets){const m=this.buckets[h];m.uploadPending()&&m.upload(s)}const c=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xg(s,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xg(s,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Xg(s,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,c,h,m,v,x,E,C){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:E,transform:x,params:v,tileTransform:this.tileTransform},s,c,h):{}}querySourceFeatures(s,c){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const m=h.loadVTLayers(),v=c?c.sourceLayer:"",x=m._geojsonTileLayer||m[v];if(!x)return;const E=gf(c&&c.filter),{z:C,x:I,y:O}=this.tileID.canonical,L={z:C,x:I,y:O};for(let B=0;B<x.length;B++){const j=x.feature(B);if(E.needGeometry){const re=zd(j,!0);if(!E.filter(new R(this.tileID.overscaledZ),re,this.tileID.canonical))continue}else if(!E.filter(new R(this.tileID.overscaledZ),j))continue;const U=h.getId(j,v),X=new YP(j,C,I,O,U);X.tile=L,s.push(X)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const c=this.expirationTime;if(s.cacheControl){const h=ce(s.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const h=Date.now();let m=!1;if(this.expirationTime>h)m=!1;else if(c)if(this.expirationTime<c)m=!0;else{const v=this.expirationTime-c;v?this.expirationTime=h+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0||!c)return;const h=this.latestFeatureIndex.loadVTLayers(),m=c.style.listImages();for(const v in this.buckets){if(!c.style.hasLayer(v))continue;const x=this.buckets[v],E=x.layers[0].sourceLayer||"_geojsonTileLayer",C=h[E],I=s[E];if(!C||!I||Object.keys(I).length===0)continue;if(x.update(I,C,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof nb||x instanceof Y0){const L=c.style._getSourceCache(x.layers[0].source);c._terrain&&c._terrain.enabled&&L&&x.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(L.id,this.tileID)}const O=c&&c.style&&c.style.getLayer(v);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<$t.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=$t.now()+s}setTexture(s,c){const h=c.context,m=h.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new Xg(h,s,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE))}setDependencies(s,c){const h={};for(const m of c)h[m]=!0;this.dependencies[s]=h}hasDependency(s,c){for(const h of s){const m=this.dependencies[h];if(m){for(const v of c)if(m[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const h=Kl(eO,this.tileID.canonical,this.tileTransform)[0],m=new St,v=new ls;for(let x=0;x<h.length;x++){const{x:E,y:C}=h[x];m.emplaceBack(E,C),v.emplaceBack(x)}v.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(v),this._tileDebugBuffer=s.createVertexBuffer(m,Cg.members),this._tileDebugSegments=cr.simpleSegment(0,0,m.length,v.length)}_makeTileBoundsBuffers(s,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const h=Kl(eO,this.tileID.canonical,this.tileTransform)[0];let m,v;if(this.isRaster){const x=function(E,C){const I=Nd(E,C),O=Math.pow(2,E.z);for(let re=0;re<hl;re++)for(let he=0;he<hl;he++){const xe=As((E.x+(he+JP(he))/na)/O),fe=eo((E.y+(re+JP(re))/na)/O),be=C.project(xe,fe),Se=re*hl+he;fl[2*Se+0]=Math.round((be.x*I.scale-I.x)*ln),fl[2*Se+1]=Math.round((be.y*I.scale-I.y)*ln)}Xc.fill(0),yb.fill(0);for(let re=2045;re>=0;re--){const he=4*re,xe=Zc[he+0],fe=Zc[he+1],be=Zc[he+2],Se=Zc[he+3],we=xe+be>>1,He=fe+Se>>1,Ue=we+He-fe,at=He+xe-we,Et=fe*hl+xe,Je=Se*hl+be,dt=He*hl+we,ht=Math.hypot((fl[2*Et+0]+fl[2*Je+0])/2-fl[2*dt+0],(fl[2*Et+1]+fl[2*Je+1])/2-fl[2*dt+1])>=16;Xc[dt]=Xc[dt]||(ht?1:0),re<1022&&(Xc[dt]=Xc[dt]||Xc[(fe+at>>1)*hl+(xe+Ue>>1)]||Xc[(Se+at>>1)*hl+(be+Ue>>1)])}const L=new ut,B=new tn;let j=0;function U(re,he){const xe=he*hl+re;return yb[xe]===0&&(L.emplaceBack(fl[2*xe+0],fl[2*xe+1],re*ln/na,he*ln/na),yb[xe]=++j),yb[xe]-1}function X(re,he,xe,fe,be,Se){const we=re+xe>>1,He=he+fe>>1;if(Math.abs(re-be)+Math.abs(he-Se)>1&&Xc[He*hl+we])X(be,Se,re,he,we,He),X(xe,fe,be,Se,we,He);else{const Ue=U(re,he),at=U(xe,fe),Et=U(be,Se);B.emplaceBack(Ue,at,Et)}}return X(0,0,na,na,na,0),X(na,na,0,0,0,na),{vertices:L,indices:B}}(this.tileID.canonical,c);m=x.vertices,v=x.indices}else{m=new ut,v=new tn;for(const{x:E,y:C}of h)m.emplaceBack(E,C,0,0);const x=_S(m.int16,void 0,4);for(let E=0;E<x.length;E+=3)v.emplaceBack(x[E],x[E+1],x[E+2])}this._tileBoundsBuffer=s.createVertexBuffer(m,QP.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(v),this._tileBoundsSegments=cr.simpleSegment(0,0,m.length,v.length)}_makeGlobeTileDebugBuffers(s,c){const h=c.projection;if(!h||h.name!=="globe"||c.freezeTileCoverage)return;const m=this.tileID.canonical,v=Mg(xM(m,c)),x=Tf(c.zoom);let E;x>0&&(E=Zw(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,m,c,v,E,x),this._makeGlobeTileDebugTextBuffer(s,m,c,v,E,x)}_globePoint(s,c,h,m,v,x,E){let C=Ag(s,c,h);if(x){const I=1<<h.z,O=ul(m.center.lng),L=dl(m.center.lat),B=(h.x+.5)/I-O;let j=0;B>.5?j=-1:B<-.5&&(j=1);let U=(s/ln+h.x)/I+j,X=(c/ln+h.y)/I;U=(U-O)*m._pixelsPerMercatorPixel+O,X=(X-L)*m._pixelsPerMercatorPixel+L;const re=[U*m.worldSize,X*m.worldSize,0];er(re,re,x),C=Ld(C,re,E)}return er(C,C,v)}_makeGlobeTileDebugBorderBuffer(s,c,h,m,v,x){const E=new St,C=new ls,I=new Ve,O=(B,j,U,X,re)=>{const he=(U-B)/(re-1),xe=(X-j)/(re-1),fe=E.length;for(let be=0;be<re;be++){const Se=B+be*he,we=j+be*xe;E.emplaceBack(Se,we);const He=this._globePoint(Se,we,c,h,m,v,x);I.emplaceBack(He[0],He[1],He[2]),C.emplaceBack(fe+be)}},L=ln;O(0,0,L,0,16),O(L,0,L,L,16),O(L,L,0,L,16),O(0,L,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(C),this._tileDebugBuffer=s.createVertexBuffer(E,Cg.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(I,vM.members),this._tileDebugSegments=cr.simpleSegment(0,0,E.length,C.length)}_makeGlobeTileDebugTextBuffer(s,c,h,m,v,x){const E=ln/4,C=new St,I=new tn,O=new Ve,L=25;I.reserve(32),C.reserve(L),O.reserve(L);const B=(j,U)=>L*j+U;for(let j=0;j<L;j++){const U=j*E;for(let X=0;X<L;X++){const re=X*E;C.emplaceBack(re,U);const he=this._globePoint(re,U,c,h,m,v,x);O.emplaceBack(he[0],he[1],he[2])}}for(let j=0;j<4;j++)for(let U=0;U<4;U++){const X=B(j,U),re=B(j,U+1),he=B(j+1,U),xe=B(j+1,U+1);I.emplaceBack(X,re,he),I.emplaceBack(he,re,xe)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(I),this._tileDebugTextBuffer=s.createVertexBuffer(C,Cg.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(O,vM.members),this._tileDebugTextSegments=cr.simpleSegment(0,0,L,32)}}class B8{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,h){const m=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][m]=this.stateChanges[s][m]||{},Nt(this.stateChanges[s][m],h),this.deletedStates[s]===null){this.deletedStates[s]={};for(const v in this.state[s])v!==m&&(this.deletedStates[s][v]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][m]===null){this.deletedStates[s][m]={};for(const v in this.state[s][m])h[v]||(this.deletedStates[s][m][v]=null)}else for(const v in h)this.deletedStates[s]&&this.deletedStates[s][m]&&this.deletedStates[s][m][v]===null&&delete this.deletedStates[s][m][v]}removeFeatureState(s,c,h){if(this.deletedStates[s]===null)return;const m=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},h&&c!==void 0)this.deletedStates[s][m]!==null&&(this.deletedStates[s][m]=this.deletedStates[s][m]||{},this.deletedStates[s][m][h]=null);else if(c!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][m])for(h in this.deletedStates[s][m]={},this.stateChanges[s][m])this.deletedStates[s][m][h]=null;else this.deletedStates[s][m]=null;else this.deletedStates[s]=null}getState(s,c){const h=String(c),m=Nt({},(this.state[s]||{})[h],(this.stateChanges[s]||{})[h]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const v=this.deletedStates[s][c];if(v===null)return{};for(const x in v)delete m[x]}return m}initializeTileState(s,c){s.setFeatureState(this.state,c)}coalesceChanges(s,c){const h={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const x in this.stateChanges[m])this.state[m][x]||(this.state[m][x]={}),Nt(this.state[m][x],this.stateChanges[m][x]),v[x]=this.state[m][x];h[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const x in this.state[m])v[x]={},this.state[m][x]={};else for(const x in this.deletedStates[m]){if(this.deletedStates[m][x]===null)this.state[m][x]={};else if(this.state[m][x])for(const E of Object.keys(this.deletedStates[m][x]))delete this.state[m][x][E];v[x]=this.state[m][x]}h[m]=h[m]||{},Nt(h[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const m in s)s[m].setFeatureState(h,c)}}class tO{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,c){const h=this.toIdx(s,c);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(s,c){return this.leaves[this.toIdx(s,c)]}toIdx(s,c){return c*this.size+s}}function nO(l,s,c,h){let m=0,v=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(h[x])<1e-15){if(c[x]<l[x]||c[x]>s[x])return null}else{const E=1/h[x];let C=(l[x]-c[x])*E,I=(s[x]-c[x])*E;if(C>I){const O=C;C=I,I=O}if(C>m&&(m=C),I<v&&(v=I),m>v)return null}return m}function iO(l,s,c,h,m,v,x,E,C,I,O){const L=h-l,B=m-s,j=v-c,U=x-l,X=E-s,re=C-c,he=O[1]*re-O[2]*X,xe=O[2]*U-O[0]*re,fe=O[0]*X-O[1]*U,be=L*he+B*xe+j*fe;if(Math.abs(be)<1e-15)return null;const Se=1/be,we=I[0]-l,He=I[1]-s,Ue=I[2]-c,at=(we*he+He*xe+Ue*fe)*Se;if(at<0||at>1)return null;const Et=He*j-Ue*B,Je=Ue*L-we*j,dt=we*B-He*L,ht=(O[0]*Et+O[1]*Je+O[2]*dt)*Se;return ht<0||at+ht>1?null:(U*Et+X*Je+re*dt)*Se}function rO(l,s,c){return(l-s)/(c-s)}function oO(l,s,c,h,m,v,x,E,C){const I=1<<c,O=v-h,L=x-m,B=(l+1)/I*O+h,j=(s+0)/I*L+m,U=(s+1)/I*L+m;E[0]=(l+0)/I*O+h,E[1]=j,C[0]=B,C[1]=U}class sO{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(v){const x=Math.ceil(Math.log2(v.dim/8)),E=[];let C=Math.ceil(Math.pow(2,x));const I=1/C,O=(j,U,X,re,he)=>{const xe=re?1:0,fe=(j+1)*X-xe,be=U*X,Se=(U+1)*X-xe;he[0]=j*X,he[1]=be,he[2]=fe,he[3]=Se};let L=new tO(C);const B=[];for(let j=0;j<C*C;j++){O(j%C,Math.floor(j/C),I,!1,B);const U=Kc(B[0],B[1],v),X=Kc(B[2],B[1],v),re=Kc(B[2],B[3],v),he=Kc(B[0],B[3],v);L.minimums.push(Math.min(U,X,re,he)),L.maximums.push(Math.max(U,X,re,he)),L.leaves.push(1)}for(E.push(L),C/=2;C>=1;C/=2){const j=E[E.length-1];L=new tO(C);for(let U=0;U<C*C;U++){O(U%C,Math.floor(U/C),2,!0,B);const X=j.getElevation(B[0],B[1]),re=j.getElevation(B[2],B[1]),he=j.getElevation(B[2],B[3]),xe=j.getElevation(B[0],B[3]),fe=j.isLeaf(B[0],B[1]),be=j.isLeaf(B[2],B[1]),Se=j.isLeaf(B[2],B[3]),we=j.isLeaf(B[0],B[3]),He=Math.min(X.min,re.min,he.min,xe.min),Ue=Math.max(X.max,re.max,he.max,xe.max),at=fe&&be&&Se&&we;L.maximums.push(Ue),L.minimums.push(He),L.leaves.push(Ue-He<=5&&at?1:0)}E.push(L)}return E}(this.dem),h=c.length-1,m=c[h];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,h,0)}raycastRoot(s,c,h,m,v,x,E=1){return nO([s,c,-100],[h,m,this.maximums[0]*E],v,x)}raycast(s,c,h,m,v,x,E=1){if(!this.nodeCount)return null;const C=this.raycastRoot(s,c,h,m,v,x,E);if(C==null)return null;const I=[],O=[],L=[],B=[],j=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;j.length>0;){const{idx:U,t:X,nodex:re,nodey:he,depth:xe}=j.pop();if(this.leaves[U]){oO(re,he,xe,s,c,h,m,L,B);const be=1<<xe,Se=(re+0)/be,we=(re+1)/be,He=(he+0)/be,Ue=(he+1)/be,at=Kc(Se,He,this.dem)*E,Et=Kc(we,He,this.dem)*E,Je=Kc(we,Ue,this.dem)*E,dt=Kc(Se,Ue,this.dem)*E,ht=iO(L[0],L[1],at,B[0],L[1],Et,B[0],B[1],Je,v,x),vt=iO(B[0],B[1],Je,L[0],B[1],dt,L[0],L[1],at,v,x),Pt=Math.min(ht!==null?ht:Number.MAX_VALUE,vt!==null?vt:Number.MAX_VALUE);if(Pt!==Number.MAX_VALUE)return Pt;{const it=kg([],v,x,X);if(aO(at,Et,dt,Je,rO(it[0],L[0],B[0]),rO(it[1],L[1],B[1]))>=it[2])return X}continue}let fe=0;for(let be=0;be<this._siblingOffset.length;be++){oO((re<<1)+this._siblingOffset[be][0],(he<<1)+this._siblingOffset[be][1],xe+1,s,c,h,m,L,B),L[2]=-100,B[2]=this.maximums[this.childOffsets[U]+be]*E;const Se=nO(L,B,v,x);if(Se!=null){const we=Se;I[be]=we;let He=!1;for(let Ue=0;Ue<fe&&!He;Ue++)we>=I[O[Ue]]&&(O.splice(Ue,0,be),He=!0);He||(O[fe]=be),fe++}}for(let be=0;be<fe;be++){const Se=O[be];j.push({idx:this.childOffsets[U]+Se,t:I[Se],nodex:(re<<1)+this._siblingOffset[Se][0],nodey:(he<<1)+this._siblingOffset[Se][1],depth:xe+1})}}return null}_addNode(s,c,h){return this.minimums.push(s),this.maximums.push(c),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(s,c,h,m,v){if(s[m].isLeaf(c,h)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const x=m-1,E=s[x];let C=0,I=0;for(let O=0;O<this._siblingOffset.length;O++){const L=2*c+this._siblingOffset[O][0],B=2*h+this._siblingOffset[O][1],j=E.getElevation(L,B),U=E.isLeaf(L,B),X=this._addNode(j.min,j.max,U);U&&(C|=1<<O),I||(I=X)}for(let O=0;O<this._siblingOffset.length;O++)C&1<<O||this._construct(s,2*c+this._siblingOffset[O][0],2*h+this._siblingOffset[O][1],x,I+O)}}function aO(l,s,c,h,m,v){return Vn(Vn(l,c,v),Vn(s,h,v),m)}function Kc(l,s,c){const h=c.dim,m=ze(l*h-.5,0,h-1),v=ze(s*h-.5,0,h-1),x=Math.floor(m),E=Math.floor(v),C=Math.min(x+1,h-1),I=Math.min(E+1,h-1);return aO(c.get(x,E),c.get(C,E),c.get(x,I),c.get(C,I),m-x,v-E)}const lO={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function F8(l,s,c){return(256*l*256+256*s+c)/10-1e4}function N8(l,s,c){return 256*l+s+c/256-32768}class vb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,c,h,m=!1,v=!1){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return ni(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const x=this.dim=c.height-2,E=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=h||"mapbox",this.borderReady=m,!m){for(let C=0;C<x;C++)E[this._idx(-1,C)]=E[this._idx(0,C)],E[this._idx(x,C)]=E[this._idx(x-1,C)],E[this._idx(C,-1)]=E[this._idx(C,0)],E[this._idx(C,x)]=E[this._idx(C,x-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(x,-1)]=E[this._idx(x-1,0)],E[this._idx(-1,x)]=E[this._idx(0,x-1)],E[this._idx(x,x)]=E[this._idx(x-1,x-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new sO(this)}get(s,c,h=!1){h&&(s=ze(s,-1,this.dim),c=ze(c,-1,this.dim));const m=4*this._idx(s,c);return(this.encoding==="terrarium"?N8:F8)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(s){return lO[s]}get unpackVector(){return lO[this.encoding]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}static pack(s,c){const h=[0,0,0,0],m=vb.getUnpackVector(c);let v=Math.floor((s+m[3])/m[2]);return h[2]=v%256,v=Math.floor(v/256),h[1]=v%256,v=Math.floor(v/256),h[0]=v,h}getPixels(){return new us({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,c,h){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,v=c*this.dim+this.dim,x=h*this.dim,E=h*this.dim+this.dim;switch(c){case-1:m=v-1;break;case 1:v=m+1}switch(h){case-1:x=E-1;break;case 1:E=x+1}const C=-c*this.dim,I=-h*this.dim;for(let O=x;O<E;O++)for(let L=m;L<v;L++){const B=4*this._idx(L,O),j=4*this._idx(L+C,O+I);this.pixels[B+0]=s.pixels[j+0],this.pixels[B+1]=s.pixels[j+1],this.pixels[B+2]=s.pixels[j+2],this.pixels[B+3]=s.pixels[j+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Kt(vb,"DEMData"),Kt(sO,"DemMinMaxQuadTree",{omit:["dem"]});class $8{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(const s in this.data)for(const c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,h){const m=s.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:c,timeout:void 0};if(h!==void 0&&(v.timeout=setTimeout(()=>{this.remove(s,v)},h)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){const c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;const h=s.wrapped().key,m=c===void 0?0:this.data[h].indexOf(c),v=this.data[h][m];return this.data[h].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(v.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){const c=[];for(const h in this.data)for(const m of this.data[h])s(m.value)||c.push(m);for(const h of c)this.remove(h.value.tileID,h)}}class jf{constructor(s,c,h){this.func=s,this.mask=c,this.range=h}}jf.ReadOnly=!1,jf.ReadWrite=!0,jf.disabled=new jf(519,jf.ReadOnly,[0,1]);const jS=7680;class VS{constructor(s,c,h,m,v,x){this.test=s,this.ref=c,this.mask=h,this.fail=m,this.depthFail=v,this.pass=x}}VS.disabled=new VS({func:519,mask:0},0,0,jS,jS,jS);class pl{constructor(s,c,h){this.blendFunction=s,this.blendColor=c,this.mask=h}}pl.Replace=[1,0],pl.disabled=new pl(pl.Replace,Qi.transparent,[!1,!1,!1,!1]),pl.unblended=new pl(pl.Replace,Qi.transparent,[!0,!0,!0,!0]),pl.alphaBlended=new pl([1,771],Qi.transparent,[!0,!0,!0,!0]);const US=1029,qS=2305;class Ra{constructor(s,c,h){this.enable=s,this.mode=c,this.frontFace=h}}Ra.disabled=new Ra(!1,US,qS),Ra.backCCW=new Ra(!0,US,qS),Ra.backCW=new Ra(!0,US,2304),Ra.frontCW=new Ra(!0,1028,2304),Ra.frontCCW=new Ra(!0,1028,qS);class $d extends Vo{constructor(s,c,h){super(),this.id=s,this._onlySymbols=h,c.on("data",m=>{m.dataType==="source"&&m.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&m.dataType==="source"&&m.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new $8(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new B8,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const c=this._tiles[s];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,c){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const h=this._tiles[c];h.upload(s),h.prepare(this.map.style.imageManager)}}getIds(){return gt(this._tiles).map(s=>s.tileID).sort(cO).map(s=>s.key)}getRenderableIds(s){const c=[];for(const h in this._tiles)this._isIdRenderable(+h,s)&&c.push(this._tiles[h]);return s?c.sort((h,m)=>{const v=h.tileID,x=m.tileID,E=new te(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),C=new te(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-x.overscaledZ||C.y-E.y||C.x-E.x}).map(h=>h.tileID.key):c.map(h=>h.tileID).sort(cO).map(h=>h.key)}hasRenderableParent(s){const c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,c){const h=this._tiles[s];h&&(h.state!=="loading"&&(h.state=c),this._loadTile(h,this._tileLoaded.bind(this,h,s,c)))}_tileLoaded(s,c,h,m){if(m)if(s.state="errored",m.status!==404)this._source.fire(new Ji(m,{tile:s}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=$t.now(),h==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new Li("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const c=this.getRenderableIds();for(let m=0;m<c.length;m++){const v=c[m];if(s.neighboringTiles&&s.neighboringTiles[v]){const x=this.getTileByID(v);h(s,x),h(x,s)}}function h(m,v){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let x=v.tileID.canonical.x-m.tileID.canonical.x;const E=v.tileID.canonical.y-m.tileID.canonical.y,C=Math.pow(2,m.tileID.canonical.z),I=v.tileID.key;x===0&&E===0||Math.abs(E)>1||(Math.abs(x)>1&&(Math.abs(x+C)===1?x+=C:Math.abs(x-C)===1&&(x-=C)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,x,E),m.neighboringTiles&&m.neighboringTiles[I]&&(m.neighboringTiles[I].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,h,m){for(const v in this._tiles){let x=this._tiles[v];if(m[v]||!x.hasData()||x.tileID.overscaledZ<=c||x.tileID.overscaledZ>h)continue;let E=x.tileID;for(;x&&x.tileID.overscaledZ>c+1;){const I=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[I.key],x&&x.hasData()&&(E=I)}let C=E;for(;C.overscaledZ>c;)if(C=C.scaledTo(C.overscaledZ-1),s[C.key]){m[E.key]=E;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){const h=this._loadedParentTiles[s.key];return h&&h.tileID.overscaledZ>=c?h:null}for(let h=s.overscaledZ-1;h>=c;h--){const m=s.scaledTo(h),v=this._getLoadedTile(m);if(v)return v}}_getLoadedTile(s){const c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,c){c=c||this._source.tileSize;const h=Math.ceil(s.width/c)+1,m=Math.ceil(s.height/c)+1,v=Math.floor(h*m*5),x=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(E)}handleWrapJump(s){const c=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,c){const h={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+c),h[v.tileID.key]=v}this._tiles=h;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(s,c,h){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!h)return;let m;this.updateCacheSize(s,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new Io(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(m=s.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!h,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(E=>this._source.hasTile(E)))):m=[];const v=this._updateRetainedTiles(m);if(uO(this._source.type)&&m.length!==0){const E={},C={},I=Object.keys(v);for(const L of I){const B=v[L],j=this._tiles[L];if(!j||j.fadeEndTime&&j.fadeEndTime<=$t.now())continue;const U=this.findLoadedParent(B,Math.max(B.overscaledZ-$d.maxOverzooming,this._source.minzoom));U&&(this._addTile(U.tileID),E[U.tileID.key]=U.tileID),C[L]=B}const O=m[m.length-1].overscaledZ;for(const L in this._tiles){const B=this._tiles[L];if(v[L]||!B.hasData())continue;let j=B.tileID;for(;j.overscaledZ>O;){j=j.scaledTo(j.overscaledZ-1);const U=this._tiles[j.key];if(U&&U.hasData()&&C[j.key]){v[L]=B.tileID;break}}}for(const L in E)v[L]||(this._coveredTiles[L]=!0,v[L]=E[L])}for(const E in v)this._tiles[E].clearFadeHold();const x=function(E,C){const I=[];for(const O in E)O in C||I.push(O);return I}(this._tiles,v);for(const E of x){const C=this._tiles[E];C.hasSymbolBuckets&&!C.holdingForFade()?C.setHoldDuration(this.map._fadeDuration):C.hasSymbolBuckets&&!C.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const c={};if(s.length===0)return c;const h={},m=s.reduce((I,O)=>Math.min(I,O.overscaledZ),1/0),v=s[0].overscaledZ,x=Math.max(v-$d.maxOverzooming,this._source.minzoom),E=Math.max(v+$d.maxUnderzooming,this._source.minzoom),C={};for(const I of s){const O=this._addTile(I);c[I.key]=I,O.hasData()||m<this._source.maxzoom&&(C[I.key]=I)}this._retainLoadedChildren(C,m,E,c);for(const I of s){let O=this._tiles[I.key];if(O.hasData())continue;if(I.canonical.z>=this._source.maxzoom){const B=I.children(this._source.maxzoom)[0],j=this.getTile(B);if(j&&j.hasData()){c[B.key]=B;continue}}else{const B=I.children(this._source.maxzoom);if(c[B[0].key]&&c[B[1].key]&&c[B[2].key]&&c[B[3].key])continue}let L=O.wasRequested();for(let B=I.overscaledZ-1;B>=x;--B){const j=I.scaledTo(B);if(h[j.key]||(h[j.key]=!0,O=this.getTile(j),!O&&L&&(O=this._addTile(j)),O&&(c[j.key]=j,L=O.wasRequested(),O.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const c=[];let h,m=this._tiles[s].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){h=this._loadedParentTiles[m.key];break}c.push(m.key);const v=m.scaledTo(m.overscaledZ-1);if(h=this._getLoadedTile(v),h)break;m=v}for(const v of c)this._loadedParentTiles[v]=h}}_addTile(s){let c=this._tiles[s.key];if(c)return c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));const h=!!c;if(!h){const m=this.map?this.map.painter:null;c=new $S(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))}return c?(c.uses++,this._tiles[s.key]=c,h||this._source.fire(new Li("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const h=c.getExpiryTimeout();h&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},h))}_removeTile(s){const c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,c,h){const m=[],v=this.transform;if(!v)return m;const x=v.projection.name==="globe",E=ul(v.center.lng);for(const C in this._tiles){const I=this._tiles[C];if(h&&I.clearQueryDebugViz(),I.holdingForFade())continue;let O;if(x){const L=I.tileID.canonical;if(L.z===0){const B=[Math.abs(ze(E,...Kg(L,-1))-E),Math.abs(ze(E,...Kg(L,1))-E)];O=[0,2*B.indexOf(Math.min(...B))-1]}else{const B=[Math.abs(ze(E,...Kg(L,-1))-E),Math.abs(ze(E,...Kg(L,0))-E),Math.abs(ze(E,...Kg(L,1))-E)];O=[B.indexOf(Math.min(...B))-1]}}else O=[0];for(const L of O){const B=s.containsTile(I,v,c,L);B&&m.push(B)}}return m}getVisibleCoordinates(s){const c=this.getRenderableIds(s).map(h=>this._tiles[h].tileID);for(const h of c)h.projMatrix=this.transform.calculateProjMatrix(h.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(uO(this._source.type))for(const s in this._tiles){const c=this._tiles[s];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=$t.now())return!0}return!1}setFeatureState(s,c,h){this._state.updateState(s=s||"_geojsonTileLayer",c,h)}removeFeatureState(s,c,h){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,h)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,h){const m=this._tiles[s];m&&m.setDependencies(c,h)}reloadTilesForDependencies(s,c){for(const h in this._tiles)this._tiles[h].hasDependency(s,c)&&this._reloadTile(+h,"reloading");this._cache.filter(h=>!h.hasDependency(s,c))}_preloadTiles(s,c){if(!this._sourceLoaded){const E=()=>{this._sourceLoaded&&(this._source.off("data",E),this._preloadTiles(s,c))};return void this._source.on("data",E)}const h=new Map,m=Array.isArray(s)?s:[s],v=this.map.painter.terrain,x=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const E of m){const C=E.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const I of C)h.set(I.key,I);this.usedForTerrain&&E.updateElevation(!1)}ft(Array.from(h.values()),(E,C)=>{const I=new $S(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(I,O=>{this._source.type==="raster-dem"&&I.dem&&this._backfillDEM(I),C(O,I)})},c)}}function cO(l,s){const c=Math.abs(2*l.wrap)-+(l.wrap<0),h=Math.abs(2*s.wrap)-+(s.wrap<0);return l.overscaledZ-s.overscaledZ||h-c||s.canonical.y-l.canonical.y||s.canonical.x-l.canonical.x}function uO(l){return l==="raster"||l==="image"||l==="video"||l==="custom"}function Kg(l,s){const c=1<<l.z;return[l.x/c+s,(l.x+1)/c+s]}$d.maxOverzooming=10,$d.maxUnderzooming=3;class bb{constructor(s,c,h){this._demTile=s,this._dem=this._demTile.dem,this._scale=c,this._offset=h}static create(s,c,h){const m=h||s.findDEMTileFor(c);if(!m||!m.dem)return;const v=m.dem,x=m.tileID,E=1<<c.canonical.z-x.canonical.z;return new bb(m,m.tileSize/ln/E,[(c.canonical.x/E-x.canonical.x)*v.dim,(c.canonical.y/E-x.canonical.y)*v.dim])}tileCoordToPixel(s,c){const h=c*this._scale+this._offset[1],m=Math.floor(s*this._scale+this._offset[0]),v=Math.floor(h);return new te(m,v)}getElevationAt(s,c,h,m){const v=s*this._scale+this._offset[0],x=c*this._scale+this._offset[1],E=Math.floor(v),C=Math.floor(x),I=this._dem;return m=!!m,h?Vn(Vn(I.get(E,C,m),I.get(E,C+1,m),x-C),Vn(I.get(E+1,C,m),I.get(E+1,C+1,m),x-C),v-E):I.get(E,C,m)}getElevationAtPixel(s,c,h){return this._dem.get(s,c,!!h)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Pa(1,s)*this._dem.stride}}class dO{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Ul(ln,16,0),this.featureIndexArray=new Id,this.promoteId=c}insert(s,c,h,m,v,x=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,v,x);const C=this.grid;for(let I=0;I<c.length;I++){const O=c[I],L=[1/0,1/0,-1/0,-1/0];for(let B=0;B<O.length;B++){const j=O[B];L[0]=Math.min(L[0],j.x),L[1]=Math.min(L[1],j.y),L[2]=Math.max(L[2],j.x),L[3]=Math.max(L[3],j.y)}L[0]<ln&&L[1]<ln&&L[2]>=0&&L[3]>=0&&C.insert(E,L[0],L[1],L[2],L[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new ES(new ob(this.rawTileData)).layers,this.sourceLayerCoder=new KP(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,c,h,m){this.loadVTLayers();const v=s.params||{},x=gf(v.filter),E=s.tileResult,C=s.transform,I=E.bufferedTilespaceBounds,O=this.grid.query(I.min.x,I.min.y,I.max.x,I.max.y,(U,X,re,he)=>zM(E.bufferedTilespaceGeometry,U,X,re,he));O.sort(j8);let L=null;C.elevation&&O.length>0&&(L=bb.create(C.elevation,this.tileID));const B={};let j;for(let U=0;U<O.length;U++){const X=O[U];if(X===j)continue;j=X;const re=this.featureIndexArray.get(X);let he=null;this.loadMatchingFeature(B,re,x,v.layers,v.availableImages,c,h,m,(xe,fe,be,Se=0)=>(he||(he=Kl(xe,this.tileID.canonical,s.tileTransform)),fe.queryIntersectsFeature(E,xe,be,he,this.z,s.transform,s.pixelPosMatrix,L,Se)))}return B}loadMatchingFeature(s,c,h,m,v,x,E,C,I){const{featureIndex:O,bucketIndex:L,sourceLayerIndex:B,layoutVertexArrayOffset:j}=c,U=this.bucketLayerIDs[L];if(m&&!function(xe,fe){for(let be=0;be<xe.length;be++)if(fe.indexOf(xe[be])>=0)return!0;return!1}(m,U))return;const X=this.sourceLayerCoder.decode(B),re=this.vtLayers[X].feature(O);if(h.needGeometry){const xe=zd(re,!0);if(!h.filter(new R(this.tileID.overscaledZ),xe,this.tileID.canonical))return}else if(!h.filter(new R(this.tileID.overscaledZ),re))return;const he=this.getId(re,X);for(let xe=0;xe<U.length;xe++){const fe=U[xe];if(m&&m.indexOf(fe)<0)continue;const be=x[fe];if(!be)continue;let Se={};he!==void 0&&C&&(Se=C.getState(be.sourceLayer||"_geojsonTileLayer",he));const we=Nt({},E[fe]);we.paint=hO(we.paint,be.paint,re,Se,v),we.layout=hO(we.layout,be.layout,re,Se,v);const He=!I||I(re,be,Se,j);if(!He)continue;const Ue=new YP(re,this.z,this.x,this.y,he);Ue.layer=we;let at=s[fe];at===void 0&&(at=s[fe]=[]),at.push({featureIndex:O,feature:Ue,intersectionZ:He})}}lookupSymbolFeatures(s,c,h,m,v,x,E,C){const I={};this.loadVTLayers();const O=gf(v);for(const L of s)this.loadMatchingFeature(I,{bucketIndex:h,sourceLayerIndex:m,featureIndex:L,layoutVertexArrayOffset:0},O,x,E,C,c);return I}loadFeature(s){const{featureIndex:c,sourceLayerIndex:h}=s;this.loadVTLayers();const m=this.sourceLayerCoder.decode(h),v=this.vtFeatures[m];if(v[c])return v[c];const x=this.vtLayers[m].feature(c);return v[c]=x,x}hasLayer(s){for(const c of this.bucketLayerIDs)for(const h of c)if(s===h)return!0;return!1}getId(s,c){let h=s.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[c];m!=null&&(h=s.properties[m]),typeof h=="boolean"&&(h=Number(h))}return h}}function hO(l,s,c,h,m){return gn(l,(v,x)=>{const E=s instanceof de?s.get(x):null;return E&&E.evaluate?E.evaluate(c,h,m):E})}function j8(l,s){return s-l}Kt(dO,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class fO{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.image=new Yl({width:s,height:c}),this.positions={},this.uploaded=!1}getDash(s,c){const h=this.getKey(s,c);return this.positions[h]}trim(){const s=this.width,c=this.height=Zt(this.nextRow);this.image.resize({width:s,height:c})}getKey(s,c){return s.join(",")+c}getDashRanges(s,c,h){const m=[];let v=s.length%2==1?-s[s.length-1]*h:0,x=s[0]*h,E=!0;m.push({left:v,right:x,isDash:E,zeroLength:s[0]===0});let C=s[0];for(let I=1;I<s.length;I++){E=!E;const O=s[I];v=C*h,C+=O,x=C*h,m.push({left:v,right:x,isDash:E,zeroLength:O===0})}return m}addRoundDash(s,c,h){const m=c/2;for(let v=-h;v<=h;v++){const x=this.width*(this.nextRow+h+v);let E=0,C=s[E];for(let I=0;I<this.width;I++){I/C.right>1&&(C=s[++E]);const O=Math.abs(I-C.left),L=Math.abs(I-C.right),B=Math.min(O,L);let j;const U=v/h*(m+1);if(C.isDash){const X=m-Math.abs(U);j=Math.sqrt(B*B+X*X)}else j=m-Math.sqrt(B*B+U*U);this.image.data[x+I]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(s,c){for(let C=s.length-1;C>=0;--C){const I=s[C],O=s[C+1];I.zeroLength?s.splice(C,1):O&&O.isDash===I.isDash&&(O.left=I.left,s.splice(C,1))}const h=s[0],m=s[s.length-1];h.isDash===m.isDash&&(h.left=m.left-this.width,m.right=h.right+this.width);const v=this.width*this.nextRow;let x=0,E=s[x];for(let C=0;C<this.width;C++){C/E.right>1&&(E=s[++x]);const I=Math.abs(C-E.left),O=Math.abs(C-E.right),L=Math.min(I,O);this.image.data[v+C]=Math.max(0,Math.min(255,(E.isDash?L:-L)+c+128))}}addDash(s,c){const h=this.getKey(s,c);if(this.positions[h])return this.positions[h];const m=c==="round",v=m?7:0,x=2*v+1;if(this.nextRow+x>this.height)return ni("LineAtlas out of space"),null;s.length===0&&s.push(1);let E=0;for(let O=0;O<s.length;O++)s[O]<0&&(ni("Negative value is found in line dasharray, replacing values with 0"),s[O]=0),E+=s[O];if(E!==0){const O=this.width/E,L=this.getDashRanges(s,this.width,O);m?this.addRoundDash(L,O,v):this.addRegularDash(L,c==="square"?.5*O:0)}const C=this.nextRow+v;this.nextRow+=x;const I={tl:[C,v],br:[E,0]};return this.positions[h]=I,I}}Kt(fO,"LineAtlas");const pO=1*Da;class mO{constructor(s){const c={},h=[];for(const E in s){const C=s[E],I=c[E]={};for(const O in C.glyphs){const L=C.glyphs[+O];if(!L||L.bitmap.width===0||L.bitmap.height===0)continue;const B=L.metrics.localGlyph?pO:1,j={x:0,y:0,w:L.bitmap.width+2*B,h:L.bitmap.height+2*B};h.push(j),I[O]=j}}const{w:m,h:v}=IS(h),x=new Yl({width:m||1,height:v||1});for(const E in s){const C=s[E];for(const I in C.glyphs){const O=C.glyphs[+I];if(!O||O.bitmap.width===0||O.bitmap.height===0)continue;const L=c[E][I],B=O.metrics.localGlyph?pO:1;Yl.copy(O.bitmap,x,{x:0,y:0},{x:L.x+B,y:L.y+B},O.bitmap)}}this.image=x,this.positions=c}}Kt(mO,"GlyphAtlas");class V8{constructor(s){this.tileID=new Io(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=Nd(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,c,h,m,v){this.status="parsing",this.data=s,this.collisionBoxArray=new li;const x=new KP(Object.keys(s.layers).sort()),E=new dO(this.tileID,this.promoteId);E.bucketLayerIDs=[];const C={},I=new fO(256,256),O={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:I,availableImages:h},L=c.familiesBySource[this.source];for(const Se in L){const we=s.layers[Se];if(!we)continue;let He=!1,Ue=!1;for(const Je of L[Se])Je[0].type==="symbol"?He=!0:Ue=!0;if(this.isSymbolTile===!0&&!He||this.isSymbolTile===!1&&!Ue)continue;we.version===1&&ni(`Vector tile source "${this.source}" layer "${Se}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const at=x.encode(Se),Et=[];for(let Je=0;Je<we.length;Je++){const dt=we.feature(Je),ht=E.getId(dt,Se);Et.push({feature:dt,id:ht,index:Je,sourceLayerIndex:at})}for(const Je of L[Se]){const dt=Je[0];this.isSymbolTile!==void 0&&dt.type==="symbol"!==this.isSymbolTile||dt.minzoom&&this.zoom<Math.floor(dt.minzoom)||dt.maxzoom&&this.zoom>=dt.maxzoom||dt.visibility!=="none"&&(WS(Je,this.zoom,h),(C[dt.id]=dt.createBucket({index:E.bucketLayerIDs.length,layers:Je,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:at,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:h})).populate(Et,O,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(Je.map(ht=>ht.id)))}}let B,j,U,X;I.trim();const re={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},he=()=>{if(B)return v(B);if(j&&U&&X){const Se=new mO(j),we=new wP(U,X);for(const He in C){const Ue=C[He];Ue instanceof Hc?(WS(Ue.layers,this.zoom,h),p8(Ue,j,Se.positions,U,we.iconPositions,this.showCollisionBoxes,h,this.tileID.canonical,this.tileZoom,this.projection)):Ue.hasPattern&&(Ue instanceof nb||Ue instanceof Y0||Ue instanceof Fg)&&(WS(Ue.layers,this.zoom,h),Ue.addFeatures(O,this.tileID.canonical,we.patternPositions,h,this.tileTransform))}this.status="done",v(null,{buckets:gt(C).filter(He=>!He.isEmpty()),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Se.image,lineAtlas:I,imageAtlas:we,glyphMap:this.returnDependencies?j:null,iconMap:this.returnDependencies?U:null,glyphPositions:this.returnDependencies?Se.positions:null})}},xe=gn(O.glyphDependencies,Se=>Object.keys(Se).map(Number));Object.keys(xe).length?m.send("getGlyphs",{uid:this.uid,stacks:xe},(Se,we)=>{B||(B=Se,j=we,he())},void 0,!1,re):j={};const fe=Object.keys(O.iconDependencies);fe.length?m.send("getImages",{icons:fe,source:this.source,tileID:this.tileID,type:"icons"},(Se,we)=>{B||(B=Se,U=we,he())},void 0,!1,re):U={};const be=Object.keys(O.patternDependencies);be.length?m.send("getImages",{icons:be,source:this.source,tileID:this.tileID,type:"patterns"},(Se,we)=>{B||(B=Se,X=we,he())},void 0,!1,re):X={},he()}}function WS(l,s,c){const h=new R(s);for(const m of l)m.recalculate(h,c)}class gO{constructor(s){this.entries={},this.scheduler=s}request(s,c,h,m){const v=this.entries[s]=this.entries[s]||{callbacks:[]};if(v.result){const[x,E]=v.result;return this.scheduler?this.scheduler.add(()=>{m(x,E)},c):m(x,E),()=>{}}return v.callbacks.push(m),v.cancel||(v.cancel=h((x,E)=>{v.result=[x,E];for(const C of v.callbacks)this.scheduler?this.scheduler.add(()=>{C(x,E)},c):C(x,E);setTimeout(()=>delete this.entries[s],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(x=>x!==m),v.callbacks.length||(v.cancel(),delete this.entries[s]))}}}function yO(l,s,c){const h=JSON.stringify(l.request);return l.data&&(this.deduped.entries[h]={result:[null,l.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},m=>{const v=fo(l.request,(x,E,C,I)=>{x?m(x):E&&m(null,{vectorTile:c?void 0:new ES(new ob(E)),rawData:E,cacheControl:C,expires:I})});return()=>{v.cancel(),m()}},s)}const vO=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class GS{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,h]=new Uint8Array(s,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const v=vO[15&h];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(s,2,1),[E]=new Uint32Array(s,4,1);return new GS(E,x,v,s)}constructor(s,c=64,h=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=h,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const v=vO.indexOf(this.ArrayType),x=2*s*this.ArrayType.BYTES_PER_ELEMENT,E=s*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-E%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+C,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+x+E+C),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+C,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=s,this.coords[this._pos++]=c,h}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return HS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:E}=this,C=[0,v.length-1,0],I=[];for(;C.length;){const O=C.pop()||0,L=C.pop()||0,B=C.pop()||0;if(L-B<=E){for(let re=B;re<=L;re++){const he=x[2*re],xe=x[2*re+1];he>=s&&he<=h&&xe>=c&&xe<=m&&I.push(v[re])}continue}const j=B+L>>1,U=x[2*j],X=x[2*j+1];U>=s&&U<=h&&X>=c&&X<=m&&I.push(v[j]),(O===0?s<=U:c<=X)&&(C.push(B),C.push(j-1),C.push(1-O)),(O===0?h>=U:m>=X)&&(C.push(j+1),C.push(L),C.push(1-O))}return I}within(s,c,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:v,nodeSize:x}=this,E=[0,m.length-1,0],C=[],I=h*h;for(;E.length;){const O=E.pop()||0,L=E.pop()||0,B=E.pop()||0;if(L-B<=x){for(let re=B;re<=L;re++)_O(v[2*re],v[2*re+1],s,c)<=I&&C.push(m[re]);continue}const j=B+L>>1,U=v[2*j],X=v[2*j+1];_O(U,X,s,c)<=I&&C.push(m[j]),(O===0?s-h<=U:c-h<=X)&&(E.push(B),E.push(j-1),E.push(1-O)),(O===0?s+h>=U:c+h>=X)&&(E.push(j+1),E.push(L),E.push(1-O))}return C}}function HS(l,s,c,h,m,v){if(m-h<=c)return;const x=h+m>>1;bO(l,s,x,h,m,v),HS(l,s,c,h,x-1,1-v),HS(l,s,c,x+1,m,1-v)}function bO(l,s,c,h,m,v){for(;m>h;){if(m-h>600){const I=m-h+1,O=c-h+1,L=Math.log(I),B=.5*Math.exp(2*L/3),j=.5*Math.sqrt(L*B*(I-B)/I)*(O-I/2<0?-1:1);bO(l,s,c,Math.max(h,Math.floor(c-O*B/I+j)),Math.min(m,Math.floor(c+(I-O)*B/I+j)),v)}const x=s[2*c+v];let E=h,C=m;for(Yg(l,s,h,c),s[2*m+v]>x&&Yg(l,s,h,m);E<C;){for(Yg(l,s,E,C),E++,C--;s[2*E+v]<x;)E++;for(;s[2*C+v]>x;)C--}s[2*h+v]===x?Yg(l,s,h,C):(C++,Yg(l,s,C,m)),C<=c&&(h=C+1),c<=C&&(m=C-1)}}function Yg(l,s,c,h){ZS(l,c,h),ZS(s,2*c,2*h),ZS(s,2*c+1,2*h+1)}function ZS(l,s,c){const h=l[s];l[s]=l[c],l[c]=h}function _O(l,s,c,h){const m=l-c,v=s-h;return m*m+v*v}o.ARRAY_TYPE=cs,o.AUTH_ERR_MSG=ke,o.Aabb=Co,o.Actor=class{constructor(l,s,c){this.target=l,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},Ci(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=jo()?l:f,this.scheduler=new L8}send(l,s,c,h,m=!1,v){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=v,this.callbacks[x]=c);const E=Oe(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:l,hasCallback:!!c,targetMapId:h,mustQueue:m,sourceMapId:this.mapId,data:Nc(s,E)},E),{cancel:()=>{c&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(l){const s=l.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const h=this.cancelCallbacks[c];delete this.cancelCallbacks[c],h&&h.cancel()}else if(s.mustQueue||jo()){const h=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,s),h&&h.metadata||{type:"message"})}else this.processTask(c,s)}processTask(l,s){if(s.type==="<response>"){const c=this.callbacks[l];delete this.callbacks[l],c&&(s.error?c(ql(s.error)):c(null,ql(s.data)))}else{const c=Oe(this.globalScope)?void 0:[],h=s.hasCallback?(v,x)=>{delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:v?Nc(v):null,data:Nc(x,c)},c)}:v=>{},m=ql(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,m,h);else if(this.parent.getWorkerSource){const v=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,v[0],m.source)[v[1]](m,h)}else h(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=tb,o.Color=Qi,o.ColorMode=pl,o.CullFaceMode=Ra,o.DEMData=vb,o.DataConstantProperty=Z,o.DedupedRequest=gO,o.DepthMode=jf,o.EXTENT=ln,o.Elevation=class{isDataAvailableAtPoint(l){const s=this._source();if(this.isUsingMockSource()||!s||l.y<0||l.y>1)return!1;const c=s.getSource().maxzoom,h=1<<c,m=Math.floor(l.x),v=Math.floor((l.x-m)*h),x=Math.floor(l.y*h),E=this.findDEMTileFor(new Io(c,m,c,v,x));return!(!E||!E.dem)}getAtPointOrZero(l,s=0){return this.getAtPoint(l,s)||0}getAtPoint(l,s,c=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const h=this._source();if(!h||l.y<0||l.y>1)return s;const m=h.getSource().maxzoom,v=1<<m,x=Math.floor(l.x),E=l.x-x,C=new Io(m,x,m,Math.floor(E*v),Math.floor(l.y*v)),I=this.findDEMTileFor(C);if(!I||!I.dem)return s;const O=I.dem,L=1<<I.tileID.canonical.z,B=(E*L-I.tileID.canonical.x)*O.dim,j=(l.y*L-I.tileID.canonical.y)*O.dim,U=Math.floor(B),X=Math.floor(j);return(c?this.exaggeration():1)*Vn(Vn(O.get(U,X),O.get(U,X+1),j-X),Vn(O.get(U+1,X),O.get(U+1,X+1),j-X),B-U)}getAtTileOffset(l,s,c){const h=1<<l.canonical.z;return this.getAtPointOrZero(new Cf(l.wrap+(l.canonical.x+s/ln)/h,(l.canonical.y+c/ln)/h))}getAtTileOffsetFunc(l,s,c,h){return m=>{const v=this.getAtTileOffset(l,m.x,m.y),x=h.upVector(l.canonical,m.x,m.y);return Is(x,x,v*h.upVectorScale(l.canonical,s,c).metersToTile),x}}getForTilePoints(l,s,c,h){if(this.isUsingMockSource())return!1;const m=bb.create(this,l,h);return!!m&&(s.forEach(v=>{v[2]=this.exaggeration()*m.getElevationAt(v[0],v[1],c)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(l);if(!s||!s.dem)return null;const c=s.dem.tree,h=s.tileID,m=1<<l.canonical.z-h.canonical.z;let v=l.canonical.x/m-h.canonical.x,x=l.canonical.y/m-h.canonical.y,E=0;for(let C=0;C<l.canonical.z-h.canonical.z&&!c.leaves[E];C++){v*=2,x*=2;const I=2*Math.floor(x)+Math.floor(v);E=c.childOffsets[E]+I,v%=1,x%=1}return{min:this.exaggeration()*c.minimums[E],max:this.exaggeration()*c.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,s,c){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=Ji,o.EvaluationParameters=R,o.Event=Li,o.Evented=Vo,o.FillExtrusionBucket=Fg,o.Frustum=tS,o.FrustumCorners=eS,o.GLOBE_RADIUS=ll,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=bM,o.GLOBE_ZOOM_THRESHOLD_MIN=nS,o.GlobeSharedBuffers=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const l of this._wireframeSegments)l.destroy()}}_fillGridMeshWithLods(l,s){const c=new St,h=new tn,m=[],v=l+1+2,x=s[0]+1,E=s[0]+1+(1+s.length),C=(I,O,L)=>{let B=I===v-1?I-2:I===0?I:I-1;return B+=L?24575:0,[B,O]};for(let I=0;I<v;++I)c.emplaceBack(...C(I,0,!0));for(let I=0;I<x;++I)for(let O=0;O<v;++O)c.emplaceBack(...C(O,I,(O===0||O===v-1)&&!0));for(let I=0;I<s.length;++I){const O=s[I];for(let L=0;L<v;++L)c.emplaceBack(...C(L,O,!0))}for(let I=0;I<s.length;++I){const O=h.length,L=s[I]+1+2,B=new tn;for(let X=0;X<L-1;X++){const re=X===L-2,he=re?v*(E-s.length+I-X):v;for(let xe=0;xe<v-1;xe++){const fe=X*v+xe;X===0||re||xe===0||xe===v-2?(B.emplaceBack(fe+1,fe,fe+he),B.emplaceBack(fe+he,fe+he+1,fe+1)):(h.emplaceBack(fe+1,fe,fe+he),h.emplaceBack(fe+he,fe+he+1,fe+1))}}const j=cr.simpleSegment(0,O,c.length,h.length-O);for(let X=0;X<B.uint16.length;X+=3)h.emplaceBack(B.uint16[X],B.uint16[X+1],B.uint16[X+2]);const U=cr.simpleSegment(0,O,c.length,h.length-O);m.push({withoutSkirts:j,withSkirts:U})}return{vertices:c,indices:h,segments:m}}_createGrid(l){const s=this._fillGridMeshWithLods(Rd,Ig);this._gridSegments=s.segments,this._gridBuffer=l.createVertexBuffer(s.vertices,Cg.members),this._gridIndexBuffer=l.createIndexBuffer(s.indices,!0)}_createPoles(l){const s=new tn;for(let m=0;m<=Rd;m++)s.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=l.createIndexBuffer(s,!0);const c=new ai,h=new ai;this._poleSegments=[];for(let m=0,v=0;m<nS;m++){const x=360/(1<<m);c.emplaceBack(0,-ll,0,.5,0),h.emplaceBack(0,-ll,0,.5,1);for(let E=0;E<=Rd;E++){const C=E/Rd,I=Vn(0,x,C),[O,L,B]=Ef(LV,zV,I,ll);c.emplaceBack(O,L,B,C,0),h.emplaceBack(O,L,B,C,1)}this._poleSegments.push(cr.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(c,yM,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(h,yM,!1)}getGridBuffers(l,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}getWirefameBuffers(l,s){if(!this._wireframeSegments){const c=new Lr,h=Rd,m=h+1+2,v=1;this._wireframeSegments=[];for(let x=0,E=0;x<Ig.length;x++){const C=Ig[x];for(let O=v;O<C+v;O++)for(let L=v;L<h+v;L++){const B=O*m+L;c.emplaceBack(B,B+1),c.emplaceBack(B,B+m),c.emplaceBack(B,B+m+1)}const I=C*h*3;this._wireframeSegments.push(cr.simpleSegment(0,E,(C+1)*m,I)),E+=I}this._wireframeIndexBuffer=l.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},o.GlyphManager=zf,o.ImagePosition=AS,o.KDBush=GS,o.LivePerformanceUtils=Cm,o.LngLat=ci,o.LngLatBounds=Uc,o.LocalGlyphMode=OS,o.MAX_MERCATOR_LATITUDE=to,o.MercatorCoordinate=Cf,o.ONE_EM=Gr,o.OverscaledTileID=Io,o.PerformanceMarkers=il,o.Point=te,o.Properties=ye,o.RGBAImage=us,o.Ray=Qw,o.RequestManager=class{constructor(l,s,c){this._transformRequestFn=l,this._customAccessToken=s,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const l=function(){let s="";for(let c=0;c<10;c++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",N,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=l.token,this._skuTokenExpiresAt=l.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(l,s){return this._transformRequestFn&&this._transformRequestFn(l,s)||{url:l}}normalizeStyleURL(l,s){if(!Pe(l))return l;const c=Bt(l);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeGlyphsURL(l,s){if(!Pe(l))return l;const c=Bt(l);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeSourceURL(l,s,c,h){if(!Pe(l))return l;const m=Bt(l);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),c&&m.params.push(`language=${c}`),h&&m.params.push(`worldview=${h}`),this._makeAPIURL(m,this._customAccessToken||s)}normalizeSpriteURL(l,s,c,h){const m=Bt(l);return Pe(l)?(m.path=`/styles/v1${m.path}/sprite${s}${c}`,this._makeAPIURL(m,this._customAccessToken||h)):(m.path+=`${s}${c}`,kt(m))}normalizeTileURL(l,s,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),l&&!Pe(l))return l;const h=Bt(l);h.path=h.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||c&&h.authority!=="raster"&&c===512?"@2x":""}${T.supported?".webp":"$1"}`),h.authority==="raster"?h.path=`/${w.RASTER_URL_PREFIX}${h.path}`:(h.path=h.path.replace(/^.+\/v4\//,"/"),h.path=`/${w.TILE_URL_VERSION}${h.path}`);const m=this._customAccessToken||function(v){for(const x of v){const E=x.match(/^access_token=(.*)$/);if(E)return E[1]}return null}(h.params)||w.ACCESS_TOKEN;return w.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&h.params.push(`sku=${this._skuToken}`),this._makeAPIURL(h,m)}canonicalizeTileURL(l,s){const c=Bt(l);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return l;let h="mapbox://";c.path.match(/^\/raster\/v1\//)?h+=`raster/${c.path.replace(`/${w.RASTER_URL_PREFIX}/`,"")}`:h+=`tiles/${c.path.replace(`/${w.TILE_URL_VERSION}/`,"")}`;let m=c.params;return s&&(m=m.filter(v=>!v.match(/^access_token=/))),m.length&&(h+=`?${m.join("&")}`),h}canonicalizeTileset(l,s){const c=!!s&&Pe(s),h=[];for(const m of l.tiles||[])je(m)?h.push(this.canonicalizeTileURL(m,c)):h.push(m);return h}_makeAPIURL(l,s){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",h=Bt(w.API_URL);if(l.protocol=h.protocol,l.authority=h.authority,l.protocol==="http"){const m=l.params.indexOf("secure");m>=0&&l.params.splice(m,1)}if(h.path!=="/"&&(l.path=`${h.path}${l.path}`),!w.REQUIRE_ACCESS_TOKEN)return kt(l);if(s=s||w.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return l.params=l.params.filter(m=>m.indexOf("access_token")===-1),l.params.push(`access_token=${s||""}`),kt(l)}},o.ResourceType=Xi,o.SegmentVector=cr,o.SourceCache=$d,o.StencilMode=VS,o.StructArrayLayout1ui2=ls,o.StructArrayLayout2f1f2i16=un,o.StructArrayLayout2i4=St,o.StructArrayLayout2ui4=Lr,o.StructArrayLayout3f12=Mn,o.StructArrayLayout3ui6=tn,o.StructArrayLayout4i8=ut,o.StructArrayLayout5f20=ai,o.Texture=Xg,o.Tile=$S,o.Transitionable=H,o.Uniform1f=F0,o.Uniform1i=class extends Hl{constructor(l){super(l),this.current=0}set(l,s,c){this.fetchUniformLocation(l,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},o.Uniform2f=class extends Hl{constructor(l){super(l),this.current=[0,0]}set(l,s,c){this.fetchUniformLocation(l,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},o.Uniform3f=class extends Hl{constructor(l){super(l),this.current=[0,0,0]}set(l,s,c){this.fetchUniformLocation(l,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},o.Uniform4f=eM,o.UniformColor=tM,o.UniformMatrix2f=class extends Hl{constructor(l){super(l),this.current=bV}set(l,s,c){if(this.fetchUniformLocation(l,s)){for(let h=0;h<4;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}},o.UniformMatrix3f=class extends Hl{constructor(l){super(l),this.current=vV}set(l,s,c){if(this.fetchUniformLocation(l,s)){for(let h=0;h<9;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},o.UniformMatrix4f=class extends Hl{constructor(l){super(l),this.current=yV}set(l,s,c){if(this.fetchUniformLocation(l,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let h=1;h<16;h++)if(c[h]!==this.current[h]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},o.UnwrappedTileID=aP,o.ValidationError=Ht,o.VectorTileFeature=Q0,o.VectorTileWorkerSource=class extends Vo{constructor(l,s,c,h,m){super(),this.actor=l,this.layerIndex=s,this.availableImages=c,this.loadVectorData=m||yO,this.loading={},this.loaded={},this.deduped=new gO(l.scheduler),this.isSpriteLoaded=h,this.scheduler=l.scheduler}loadTile(l,s){const c=l.uid,h=l&&l.request,m=h&&h.collectResourceTiming,v=this.loading[c]=new V8(l);v.abort=this.loadVectorData(l,(x,E)=>{const C=!this.loading[c];if(delete this.loading[c],C||x||!E)return v.status="done",C||(this.loaded[c]=v),s(x);const I=E.rawData,O={};E.expires&&(O.expires=E.expires),E.cacheControl&&(O.cacheControl=E.cacheControl),v.vectorTile=E.vectorTile||new ES(new ob(I));const L=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,(B,j)=>{if(B||!j)return s(B);const U={};if(m){const X=nd(h);X.length>0&&(U.resourceTiming=JSON.parse(JSON.stringify(X)))}s(null,Nt({rawTileData:I.slice(0)},j,O,U))})};this.isSpriteLoaded?L():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(L,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom}):L()}),this.loaded=this.loaded||{},this.loaded[c]=v})}reloadTile(l,s){const c=this.loaded,h=l.uid,m=this;if(c&&c[h]){const v=c[h];v.showCollisionBoxes=l.showCollisionBoxes,v.enableTerrain=!!l.enableTerrain,v.projection=l.projection,v.tileTransform=Nd(l.tileID.canonical,l.projection);const x=(E,C)=>{const I=v.reloadCallback;I&&(delete v.reloadCallback,v.parse(v.vectorTile,m.layerIndex,this.availableImages,m.actor,I)),s(E,C)};v.status==="parsing"?v.reloadCallback=x:v.status==="done"&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(l,s){const c=l.uid,h=this.loading[c];h&&(h.abort&&h.abort(),delete this.loading[c]),s()}removeTile(l,s){const c=this.loaded,h=l.uid;c&&c[h]&&delete c[h],s()}},o.WritingMode=Ms,o.ZoomDependentExpression=xd,o.add=Xl,o.addDynamicAttributes=mb,o.adjoint=function(l,s){var c=s[0],h=s[1],m=s[2],v=s[3],x=s[4],E=s[5],C=s[6],I=s[7],O=s[8];return l[0]=x*O-E*I,l[1]=m*I-h*O,l[2]=h*E-m*x,l[3]=E*C-v*O,l[4]=c*O-m*C,l[5]=m*v-c*E,l[6]=v*I-x*C,l[7]=h*C-c*I,l[8]=c*x-h*v,l},o.asyncAll=ft,o.bezier=lt,o.bindAll=Ci,o.boundsAttributes=QP,o.bufferConvexPolygon=function(l,s){const c=[];for(let h=0;h<l.length;h++){const m=Be(h-1,-1,l.length-1),v=Be(h+1,-1,l.length-1),x=l[h],E=l[v],C=l[m].sub(x).unit(),I=E.sub(x).unit(),O=I.angleWithSep(C.x,C.y),L=C.add(I).unit().mult(-1*s/Math.sin(O/2));c.push(x.add(L))}return c},o.cacheEntryPossiblyAdded=function(l){An++,An>Ot&&(l.getActor().send("enforceCacheSizeLimit",$e),An=0)},o.calculateGlobeLabelMatrix=function(l,s){const{x:c,y:h}=l.point,m=EM(c,h,l.worldSize/l._pixelsPerMercatorPixel,0,0);return Pd(m,m,oS(cl(s)))},o.calculateGlobeMatrix=function(l){const{x:s,y:c}=l.point,{lng:h,lat:m}=l._center;return EM(s,c,l.worldSize,h,m)},o.calculateGlobeMercatorMatrix=function(l){const s=l.pixelsPerMeter,c=s/Pa(1,l.center.lat),h=Aa(new Float64Array(16));return xg(h,h,[l.point.x,l.point.y,0]),Od(h,h,[c,c,s]),Float32Array.from(h)},o.circumferenceAtLatitude=aS,o.clamp=ze,o.clearTileCache=function(l){if(!Ke())return;const s=f.caches.delete(Qe);l&&s.catch(l).then(()=>l())},o.clipLine=LP,o.clone=function(l){var s=new cs(16);return s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],s},o.clone$1=fi,o.collisionCircleLayout=$U,o.config=w,o.conjugate=function(l,s){return l[0]=-s[0],l[1]=-s[1],l[2]=-s[2],l[3]=s[3],l},o.create=function(){var l=new cs(16);return cs!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},o.create$1=rM,o.createExpression=zc,o.createLayout=Re,o.createStyleLayer=function(l){return l.type==="custom"?new P8(l):new D8[l.type](l)},o.cross=Jw,o.degToRad=tt,o.distance=function(l,s){return Math.hypot(s[0]-l[0],s[1]-l[1],s[2]-l[2])},o.div=function(l,s,c){return l[0]=s[0]/c[0],l[1]=s[1]/c[1],l[2]=s[2]/c[2],l},o.dot=Qs,o.earthRadius=Pg,o.ease=zt,o.easeCubicInOut=xt,o.ecefToLatLng=function([l,s,c]){const h=Math.hypot(l,s,c),m=Math.atan2(l,c),v=.5*Math.PI-Math.acos(-s/h);return new ci(At(m),At(v))},o.emitValidationErrors=O0,o.endsWith=Vi,o.enforceCacheSizeLimit=function(l){Lt(),mt&&mt.then(s=>{s.keys().then(c=>{for(let h=0;h<c.length-l;h++)s.delete(c[h])})})},o.evaluateSizeForFeature=ib,o.evaluateSizeForZoom=Of,o.evaluateVariableOffset=$P,o.evented=S,o.exactEquals=function(l,s){return l[0]===s[0]&&l[1]===s[1]&&l[2]===s[2]&&l[3]===s[3]},o.exactEquals$1=function(l,s){return l[0]===s[0]&&l[1]===s[1]&&l[2]===s[2]},o.exported=$t,o.exported$1=T,o.extend=Nt,o.extend$1=va,o.fillExtrusionHeightLift=rP,o.filterObject=sr,o.fromMat4=function(l,s){return l[0]=s[0],l[1]=s[1],l[2]=s[2],l[3]=s[4],l[4]=s[5],l[5]=s[6],l[6]=s[8],l[7]=s[9],l[8]=s[10],l},o.fromQuat=function(l,s){var c=s[0],h=s[1],m=s[2],v=s[3],x=c+c,E=h+h,C=m+m,I=c*x,O=h*x,L=h*E,B=m*x,j=m*E,U=m*C,X=v*x,re=v*E,he=v*C;return l[0]=1-L-U,l[1]=O+he,l[2]=B-re,l[3]=0,l[4]=O-he,l[5]=1-I-U,l[6]=j+X,l[7]=0,l[8]=B+re,l[9]=j-X,l[10]=1-I-L,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},o.fromRotation=function(l,s){var c=Math.sin(s),h=Math.cos(s);return l[0]=h,l[1]=c,l[2]=0,l[3]=-c,l[4]=h,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},o.fromScaling=sM,o.furthestTileCorner=function(l){const s=Math.round((l+45+360)%360/90)%4;return _t[s]},o.getAABBPointSquareDist=function(l,s,c){let h=0;for(let m=0;m<2;++m){const v=c?c[m]:0;l[m]>v&&(h+=(l[m]-v)*(l[m]-v)),s[m]<v&&(h+=(v-s[m])*(v-s[m]))}return h},o.getAnchorAlignment=PS,o.getAnchorJustification=RS,o.getBounds=function(l){let s=1/0,c=1/0,h=-1/0,m=-1/0;for(const v of l)s=Math.min(s,v.x),c=Math.min(c,v.y),h=Math.max(h,v.x),m=Math.max(m,v.y);return{min:new te(s,c),max:new te(h,m)}},o.getColumn=Xe,o.getDefaultExportFromCjs=q,o.getGridMatrix=function(l,s,c,h){const m=s.getNorth(),v=s.getSouth(),x=s.getWest(),E=s.getEast(),C=1<<l.z,I=E-x,O=m-v,L=I/Rd,B=-O/Ig[c],j=[0,L,0,B,0,0,m,x,0];if(l.z>0){const U=180/h;oM(j,j,[U/I+1,0,0,0,U/O+1,0,-.5*U/L,.5*U/B,1])}return j[2]=C,j[5]=l.x,j[8]=l.y,j},o.getImage=ve,o.getJSON=function(l,s){return xi(Nt(l,{type:"json"}),s)},o.getLatitudinalLod=function(l){const s=to-5;l=ze(l,-s,s)/s*90;const c=Math.pow(Math.abs(Math.sin(tt(l))),3);return Math.round(c*(Ig.length-1))},o.getMapSessionAPI=Yi,o.getPerformanceMeasurement=nd,o.getProjection=ZP,o.getRTLTextPluginStatus=k,o.getReferrer=En,o.getTilePoint=function(l,{x:s,y:c},h=0){return new te(((s-h)*l.scale-l.x)*ln,(c*l.scale-l.y)*ln)},o.getTileVec3=function(l,s,c=0){return Sf(((s.x-c)*l.scale-l.x)*ln,(s.y*l.scale-l.y)*ln,IM(s.z,s.y))},o.getVideo=function(l,s){const c=f.document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let h=0;h<l.length;h++){const m=f.document.createElement("source");nl(l[h])||(c.crossOrigin="Anonymous"),m.src=l[h],c.appendChild(m)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(l){const s=[0,0,0],c=Aa(new Float64Array(16));return Pd(c,l.pixelMatrix,l.globeMatrix),er(s,s,c),new te(s[0],s[1])},o.globeDenormalizeECEF=oS,o.globeECEFOrigin=function(l,s){const c=[0,0,0];return er(c,c,Mg(cl(s.canonical))),er(c,c,l),c},o.globeMetersToEcef=j0,o.globeNormalizeECEF=Mg,o.globePixelsToTileUnits=function(l,s){return ln/(512*Math.pow(2,l))*U0(cl(s))},o.globePoleMatrixForTile=function(l,s,c){const h=Aa(new Float64Array(16)),m=(s/(1<<l)-.5)*Math.PI*2;return $0(h,c.globeMatrix,m),Float32Array.from(h)},o.globeTileBounds=cl,o.globeTiltAtLngLat=kM,o.globeToMercatorTransition=Tf,o.globeUseCustomAntiAliasing=function(l,s,c){const h=Tf(c.zoom),m=l.style.map._antialias,v=!!s.extStandardDerivatives,x=s.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return h===0&&!m&&!x&&v},o.identity=Aa,o.identity$1=pM,o.invert=Zw,o.isFullscreen=function(){return!!f.document.fullscreenElement||!!f.document.webkitFullscreenElement},o.isLngLatBehindGlobe=sS,o.isMapAuthenticated=function(l){return qr.has(l)},o.isMapboxURL=Pe,o.isSafariWithAntialiasingBug=function(l){const s=l.navigator?l.navigator.userAgent:null;return!!Oe(l)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=eo,o.latLngToECEF=kf,o.len=IV,o.length=wg,o.length$1=function(l){return Math.hypot(l[0],l[1],l[2],l[3])},o.lngFromMercatorX=As,o.loadVectorTile=yO,o.makeRequest=xi,o.mapValue=function(l,s,c,h,m){return ze((l-s)/(c-s)*(m-h)+h,h,m)},o.mercatorScale=AM,o.mercatorXfromLng=ul,o.mercatorYfromLat=dl,o.mercatorZfromAltitude=Pa,o.mul=TV,o.mul$1=CV,o.multiply=Pd,o.multiply$1=oM,o.multiply$2=cM,o.nextPowerOfTwo=Zt,o.normalize=To,o.normalize$1=AV,o.normalize$2=hM,o.number=Vn,o.ortho=function(l,s,c,h,m,v,x){var E=1/(s-c),C=1/(h-m),I=1/(v-x);return l[0]=-2*E,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*C,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*I,l[11]=0,l[12]=(s+c)*E,l[13]=(m+h)*C,l[14]=(x+v)*I,l[15]=1,l},o.pbf=pP,o.perspective=function(l,s,c,h,m){var v,x=1/Math.tan(s/2);return l[0]=x/c,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=x,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,m!=null&&m!==1/0?(l[10]=(m+h)*(v=1/(h-m)),l[14]=2*m*h*v):(l[10]=-1,l[14]=-2*h),l},o.pick=function(l,s){const c={};for(let h=0;h<s.length;h++){const m=s[h];m in l&&(c[m]=l[m])}return c},o.plugin=P,o.pointGeometry=Q,o.polesInViewport=function(l){const s=Aa(new Float64Array(16));Pd(s,l.pixelMatrix,l.globeMatrix);const c=[0,ea,0],h=[0,ta,0];return er(c,c,s),er(h,h,s),[c[0]>0&&c[0]<=l.width&&c[1]>0&&c[1]<=l.height&&!sS(l,new ci(l.center.lat,90)),h[0]>0&&h[0]<=l.width&&h[1]>0&&h[1]<=l.height&&!sS(l,new ci(l.center.lat,-90))]},o.polygonContainsPoint=Bd,o.polygonIntersectsBox=zM,o.polygonIntersectsPolygon=OM,o.polygonizeBounds=function(l,s,c=0,h=!0){const m=new te(c,c),v=l.sub(m),x=s.add(m),E=[v,new te(x.x,v.y),x,new te(v.x,x.y)];return h&&E.push(v.clone()),E},o.posAttributes=Cg,o.postMapLoadEvent=Ui,o.postPerformanceEvent=Ki,o.postTurnstileEvent=Ln,o.potpack=IS,o.prevPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},o.radToDeg=At,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(l){return l({pluginStatus:y,pluginURL:u}),S.on("pluginStateChange",l),l},o.removeAuthState=function(l){qr.delete(l)},o.renderColorRamp=mS,o.resample=MM,o.rotateX=Xw,o.rotateX$1=mM,o.rotateY=$0,o.rotateY$1=gM,o.rotateZ=function(l,s,c){var h=Math.sin(c),m=Math.cos(c),v=s[0],x=s[1],E=s[2],C=s[3],I=s[4],O=s[5],L=s[6],B=s[7];return s!==l&&(l[8]=s[8],l[9]=s[9],l[10]=s[10],l[11]=s[11],l[12]=s[12],l[13]=s[13],l[14]=s[14],l[15]=s[15]),l[0]=v*m+I*h,l[1]=x*m+O*h,l[2]=E*m+L*h,l[3]=C*m+B*h,l[4]=I*m-v*h,l[5]=O*m-x*h,l[6]=L*m-E*h,l[7]=B*m-C*h,l},o.rotateZ$1=function(l,s,c){c*=.5;var h=s[0],m=s[1],v=s[2],x=s[3],E=Math.sin(c),C=Math.cos(c);return l[0]=h*C+m*E,l[1]=m*C-h*E,l[2]=v*C+x*E,l[3]=x*C-v*E,l},o.scale=Od,o.scale$1=dM,o.scale$2=Is,o.scaleAndAdd=kg,o.set=function(l,s,c,h){return l[0]=s,l[1]=c,l[2]=h,l},o.setCacheLimits=function(l,s){$e=l,Ot=s},o.setColumn=function(l,s,c){l[4*s+0]=c[0],l[4*s+1]=c[1],l[4*s+2]=c[2],l[4*s+3]=c[3]},o.setRTLTextPlugin=function(l,s,c=!1){if(y===gg||y===yg||y===vg)throw new Error("setRTLTextPlugin cannot be called multiple times.");u=$t.resolveURL(l),y=gg,$c=s,b(),c||M()},o.smoothstep=ot,o.spec=st,o.squaredLength=function(l){var s=l[0],c=l[1],h=l[2];return s*s+c*c+h*h},o.storeAuthState=function(l,s){s?qr.add(l):qr.delete(l)},o.sub=Ma,o.subtract=Yw,o.symbolSize=jU,o.tileAABB=function(l,s,c,h,m,v,x,E,C){if(C.name==="globe")return RV(l,s,new tb(c,h,m));const I=Nd({z:c,x:h,y:m},C);return new Co([(v+I.x/I.scale)*s,s*(I.y/I.scale),x],[(v+I.x2/I.scale)*s,s*(I.y2/I.scale),E])},o.tileCornersToBounds=V0,o.tileTransform=Nd,o.transformMat3=function(l,s,c){var h=s[0],m=s[1],v=s[2];return l[0]=h*c[0]+m*c[3]+v*c[6],l[1]=h*c[1]+m*c[4]+v*c[7],l[2]=h*c[2]+m*c[5]+v*c[8],l},o.transformMat4=er,o.transformMat4$1=Dd,o.transformQuat=uM,o.transitionTileAABBinECEF=xM,o.translate=xg,o.transpose=function(l,s){if(l===s){var c=s[1],h=s[2],m=s[5];l[1]=s[3],l[2]=s[6],l[3]=c,l[5]=s[7],l[6]=h,l[7]=m}else l[0]=s[0],l[1]=s[3],l[2]=s[6],l[3]=s[1],l[4]=s[4],l[5]=s[7],l[6]=s[2],l[7]=s[5],l[8]=s[8];return l},o.triggerPluginCompletionEvent=p,o.uniqueId=Xt,o.updateGlobeVertexNormal=function(l,s,c,h,m){const v=5*s+2;l.float32[v+0]=c,l.float32[v+1]=h,l.float32[v+2]=m},o.validateCustomStyleLayer=function(l){const s=[],c=l.id;return c===void 0&&s.push({message:`layers.${c}: missing required property "id"`}),l.render===void 0&&s.push({message:`layers.${c}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},o.validateFilter=l=>as(Td(l)),o.validateFog=l=>as(A0(l)),o.validateLayer=l=>as(k0(l)),o.validateLight=l=>as(I0(l)),o.validateSource=l=>as(C0(l)),o.validateStyle=P0,o.validateTerrain=l=>as(dg(l)),o.values=gt,o.vectorTile=J0,o.version=g,o.warnOnce=ni,o.window=f,o.wrap=Be}),a(["./shared"],function(o){function f(_e){if(typeof _e=="number"||typeof _e=="boolean"||typeof _e=="string"||_e==null)return JSON.stringify(_e);if(Array.isArray(_e)){let ee="[";for(const ve of _e)ee+=`${f(ve)},`;return`${ee}]`}let Y="{";for(const ee of Object.keys(_e).sort())Y+=`${ee}:${f(_e[ee])},`;return`${Y}}`}function g(_e){let Y="";for(const ee of o.refProperties)Y+=`/${f(_e[ee])}`;return Y}class _{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,ee){for(const ke of Y)this._layerConfigs[ke.id]=ke,(this._layers[ke.id]=o.createStyleLayer(ke)).compileFilter(),this.keyCache[ke.id]&&delete this.keyCache[ke.id];for(const ke of ee)delete this.keyCache[ke],delete this._layerConfigs[ke],delete this._layers[ke];this.familiesBySource={};const ve=function(ke,Pe){const je={};for(let Me=0;Me<ke.length;Me++){const Ze=Pe&&Pe[ke[Me].id]||g(ke[Me]);Pe&&(Pe[ke[Me].id]=Ze);let Mt=je[Ze];Mt||(Mt=je[Ze]=[]),Mt.push(ke[Me])}const Ne=[];for(const Me in je)Ne.push(je[Me]);return Ne}(o.values(this._layerConfigs),this.keyCache);for(const ke of ve){const Pe=ke.map(Bt=>this._layers[Bt.id]),je=Pe[0];if(je.visibility==="none")continue;const Ne=je.source||"";let Me=this.familiesBySource[Ne];Me||(Me=this.familiesBySource[Ne]={});const Ze=je.sourceLayer||"_geojsonTileLayer";let Mt=Me[Ze];Mt||(Mt=Me[Ze]=[]),Mt.push(Pe)}}}class w{loadTile(Y,ee){const{uid:ve,encoding:ke,rawImageData:Pe,padding:je,buildQuadTree:Ne}=Y,Me=o.window.ImageBitmap&&Pe instanceof o.window.ImageBitmap?this.getImageData(Pe,je):Pe;ee(null,new o.DEMData(ve,Me,ke,je<1,Ne))}getImageData(Y,ee){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const ve=this.offscreenCanvasContext.getImageData(-ee,-ee,Y.width+2*ee,Y.height+2*ee);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ve}}function T(_e,Y){if(_e.length!==0){A(_e[0],Y);for(var ee=1;ee<_e.length;ee++)A(_e[ee],!Y)}}function A(_e,Y){for(var ee=0,ve=0,ke=0,Pe=_e.length,je=Pe-1;ke<Pe;je=ke++){var Ne=(_e[ke][0]-_e[je][0])*(_e[je][1]+_e[ke][1]),Me=ee+Ne;ve+=Math.abs(ee)>=Math.abs(Ne)?ee-Me+Ne:Ne-Me+ee,ee=Me}ee+ve>=0!=!!Y&&_e.reverse()}var D=o.getDefaultExportFromCjs(function _e(Y,ee){var ve,ke=Y&&Y.type;if(ke==="FeatureCollection")for(ve=0;ve<Y.features.length;ve++)_e(Y.features[ve],ee);else if(ke==="GeometryCollection")for(ve=0;ve<Y.geometries.length;ve++)_e(Y.geometries[ve],ee);else if(ke==="Feature")_e(Y.geometry,ee);else if(ke==="Polygon")T(Y.coordinates,ee);else if(ke==="MultiPolygon")for(ve=0;ve<Y.coordinates.length;ve++)T(Y.coordinates[ve],ee);return Y});const z=o.VectorTileFeature.prototype.toGeoJSON;var G={exports:{}},V=o.pointGeometry,N=o.vectorTile.VectorTileFeature,q=K;function K(_e,Y){this.options=Y||{},this.features=_e,this.length=_e.length}function se(_e,Y){this.id=typeof _e.id=="number"?_e.id:void 0,this.type=_e.type,this.rawGeometry=_e.type===1?[_e.geometry]:_e.geometry,this.properties=_e.tags,this.extent=Y||4096}K.prototype.feature=function(_e){return new se(this.features[_e],this.options.extent)},se.prototype.loadGeometry=function(){var _e=this.rawGeometry;this.geometry=[];for(var Y=0;Y<_e.length;Y++){for(var ee=_e[Y],ve=[],ke=0;ke<ee.length;ke++)ve.push(new V(ee[ke][0],ee[ke][1]));this.geometry.push(ve)}return this.geometry},se.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _e=this.geometry,Y=1/0,ee=-1/0,ve=1/0,ke=-1/0,Pe=0;Pe<_e.length;Pe++)for(var je=_e[Pe],Ne=0;Ne<je.length;Ne++){var Me=je[Ne];Y=Math.min(Y,Me.x),ee=Math.max(ee,Me.x),ve=Math.min(ve,Me.y),ke=Math.max(ke,Me.y)}return[Y,ve,ee,ke]},se.prototype.toGeoJSON=N.prototype.toGeoJSON;var ie=o.pbf,Q=q;function J(_e){var Y=new ie;return function(ee,ve){for(var ke in ee.layers)ve.writeMessage(3,te,ee.layers[ke])}(_e,Y),Y.finish()}function te(_e,Y){var ee;Y.writeVarintField(15,_e.version||1),Y.writeStringField(1,_e.name||""),Y.writeVarintField(5,_e.extent||4096);var ve={keys:[],values:[],keycache:{},valuecache:{}};for(ee=0;ee<_e.length;ee++)ve.feature=_e.feature(ee),Y.writeMessage(2,me,ve);var ke=ve.keys;for(ee=0;ee<ke.length;ee++)Y.writeStringField(3,ke[ee]);var Pe=ve.values;for(ee=0;ee<Pe.length;ee++)Y.writeMessage(4,xt,Pe[ee])}function me(_e,Y){var ee=_e.feature;ee.id!==void 0&&Y.writeVarintField(1,ee.id),Y.writeMessage(2,Fe,_e),Y.writeVarintField(3,ee.type),Y.writeMessage(4,_t,ee)}function Fe(_e,Y){var ee=_e.feature,ve=_e.keys,ke=_e.values,Pe=_e.keycache,je=_e.valuecache;for(var Ne in ee.properties){var Me=ee.properties[Ne],Ze=Pe[Ne];if(Me!==null){Ze===void 0&&(ve.push(Ne),Pe[Ne]=Ze=ve.length-1),Y.writeVarint(Ze);var Mt=typeof Me;Mt!=="string"&&Mt!=="boolean"&&Mt!=="number"&&(Me=JSON.stringify(Me));var Bt=Mt+":"+Me,kt=je[Bt];kt===void 0&&(ke.push(Me),je[Bt]=kt=ke.length-1),Y.writeVarint(kt)}}}function tt(_e,Y){return(Y<<3)+(7&_e)}function At(_e){return _e<<1^_e>>31}function _t(_e,Y){for(var ee=_e.loadGeometry(),ve=_e.type,ke=0,Pe=0,je=ee.length,Ne=0;Ne<je;Ne++){var Me=ee[Ne],Ze=1;ve===1&&(Ze=Me.length),Y.writeVarint(tt(1,Ze));for(var Mt=ve===3?Me.length-1:Me.length,Bt=0;Bt<Mt;Bt++){Bt===1&&ve!==1&&Y.writeVarint(tt(2,Mt-1));var kt=Me[Bt].x-ke,yn=Me[Bt].y-Pe;Y.writeVarint(At(kt)),Y.writeVarint(At(yn)),ke+=kt,Pe+=yn}ve===3&&Y.writeVarint(tt(7,1))}}function xt(_e,Y){var ee=typeof _e;ee==="string"?Y.writeStringField(1,_e):ee==="boolean"?Y.writeBooleanField(7,_e):ee==="number"&&(_e%1!=0?Y.writeDoubleField(3,_e):_e<0?Y.writeSVarintField(6,_e):Y.writeVarintField(5,_e))}G.exports=J,G.exports.fromVectorTileJs=J,G.exports.fromGeojsonVt=function(_e,Y){Y=Y||{};var ee={};for(var ve in _e)ee[ve]=new Q(_e[ve].features,Y),ee[ve].name=ve,ee[ve].version=Y.version,ee[ve].extent=Y.extent;return J({layers:ee})},G.exports.GeoJSONWrapper=Q;var lt=o.getDefaultExportFromCjs(G.exports);const zt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:_e=>_e},ze=Math.fround||(ot=new Float32Array(1),_e=>(ot[0]=+_e,ot[0]));var ot;const Be=3,ft=5,gt=6;class Nt{constructor(Y){this.options=Object.assign(Object.create(zt),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:ee,minZoom:ve,maxZoom:ke}=this.options;ee&&console.time("total time");const Pe=`prepare ${Y.length} points`;ee&&console.time(Pe),this.points=Y;const je=[];for(let Me=0;Me<Y.length;Me++){const Ze=Y[Me];if(!Ze.geometry)continue;const[Mt,Bt]=Ze.geometry.coordinates,kt=ze(wt(Mt)),yn=ze(Zt(Bt));je.push(kt,yn,1/0,Me,-1,1),this.options.reduce&&je.push(0)}let Ne=this.trees[ke+1]=this._createTree(je);ee&&console.timeEnd(Pe);for(let Me=ke;Me>=ve;Me--){const Ze=+Date.now();Ne=this.trees[Me]=this._createTree(this._cluster(Ne,Me)),ee&&console.log("z%d: %d clusters in %dms",Me,Ne.numItems,+Date.now()-Ze)}return ee&&console.timeEnd("total time"),this}getClusters(Y,ee){let ve=((Y[0]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,Y[1]));let Pe=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)ve=-180,Pe=180;else if(ve>Pe){const Bt=this.getClusters([ve,ke,180,je],ee),kt=this.getClusters([-180,ke,Pe,je],ee);return Bt.concat(kt)}const Ne=this.trees[this._limitZoom(ee)],Me=Ne.range(wt(ve),Zt(je),wt(Pe),Zt(ke)),Ze=Ne.data,Mt=[];for(const Bt of Me){const kt=this.stride*Bt;Mt.push(Ze[kt+ft]>1?en(Ze,kt,this.clusterProps):this.points[Ze[kt+Be]])}return Mt}getChildren(Y){const ee=this._getOriginId(Y),ve=this._getOriginZoom(Y),ke="No cluster with the specified id.",Pe=this.trees[ve];if(!Pe)throw new Error(ke);const je=Pe.data;if(ee*this.stride>=je.length)throw new Error(ke);const Ne=this.options.radius/(this.options.extent*Math.pow(2,ve-1)),Me=Pe.within(je[ee*this.stride],je[ee*this.stride+1],Ne),Ze=[];for(const Mt of Me){const Bt=Mt*this.stride;je[Bt+4]===Y&&Ze.push(je[Bt+ft]>1?en(je,Bt,this.clusterProps):this.points[je[Bt+Be]])}if(Ze.length===0)throw new Error(ke);return Ze}getLeaves(Y,ee,ve){const ke=[];return this._appendLeaves(ke,Y,ee=ee||10,ve=ve||0,0),ke}getTile(Y,ee,ve){const ke=this.trees[this._limitZoom(Y)],Pe=Math.pow(2,Y),{extent:je,radius:Ne}=this.options,Me=Ne/je,Ze=(ve-Me)/Pe,Mt=(ve+1+Me)/Pe,Bt={features:[]};return this._addTileFeatures(ke.range((ee-Me)/Pe,Ze,(ee+1+Me)/Pe,Mt),ke.data,ee,ve,Pe,Bt),ee===0&&this._addTileFeatures(ke.range(1-Me/Pe,Ze,1,Mt),ke.data,Pe,ve,Pe,Bt),ee===Pe-1&&this._addTileFeatures(ke.range(0,Ze,Me/Pe,Mt),ke.data,-1,ve,Pe,Bt),Bt.features.length?Bt:null}getClusterExpansionZoom(Y){let ee=this._getOriginZoom(Y)-1;for(;ee<=this.options.maxZoom;){const ve=this.getChildren(Y);if(ee++,ve.length!==1)break;Y=ve[0].properties.cluster_id}return ee}_appendLeaves(Y,ee,ve,ke,Pe){const je=this.getChildren(ee);for(const Ne of je){const Me=Ne.properties;if(Me&&Me.cluster?Pe+Me.point_count<=ke?Pe+=Me.point_count:Pe=this._appendLeaves(Y,Me.cluster_id,ve,ke,Pe):Pe<ke?Pe++:Y.push(Ne),Y.length===ve)break}return Pe}_createTree(Y){const ee=new o.KDBush(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ve=0;ve<Y.length;ve+=this.stride)ee.add(Y[ve],Y[ve+1]);return ee.finish(),ee.data=Y,ee}_addTileFeatures(Y,ee,ve,ke,Pe,je){for(const Ne of Y){const Me=Ne*this.stride,Ze=ee[Me+ft]>1;let Mt,Bt,kt;if(Ze)Mt=Xt(ee,Me,this.clusterProps),Bt=ee[Me],kt=ee[Me+1];else{const _n=this.points[ee[Me+Be]];Mt=_n.properties;const[pn,Ln]=_n.geometry.coordinates;Bt=wt(pn),kt=Zt(Ln)}const yn={type:1,geometry:[[Math.round(this.options.extent*(Bt*Pe-ve)),Math.round(this.options.extent*(kt*Pe-ke))]],tags:Mt};let In;In=Ze||this.options.generateId?ee[Me+Be]:this.points[ee[Me+Be]].id,In!==void 0&&(yn.id=In),je.features.push(yn)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,ee){const{radius:ve,extent:ke,reduce:Pe,minPoints:je}=this.options,Ne=ve/(ke*Math.pow(2,ee)),Me=Y.data,Ze=[],Mt=this.stride;for(let Bt=0;Bt<Me.length;Bt+=Mt){if(Me[Bt+2]<=ee)continue;Me[Bt+2]=ee;const kt=Me[Bt],yn=Me[Bt+1],In=Y.within(Me[Bt],Me[Bt+1],Ne),_n=Me[Bt+ft];let pn=_n;for(const Ln of In){const wi=Ln*Mt;Me[wi+2]>ee&&(pn+=Me[wi+ft])}if(pn>_n&&pn>=je){let Ln,wi=kt*_n,Ui=yn*_n,Ar=-1;const Ki=((Bt/Mt|0)<<5)+(ee+1)+this.points.length;for(const ns of In){const Yi=ns*Mt;if(Me[Yi+2]<=ee)continue;Me[Yi+2]=ee;const qr=Me[Yi+ft];wi+=Me[Yi]*qr,Ui+=Me[Yi+1]*qr,Me[Yi+4]=Ki,Pe&&(Ln||(Ln=this._map(Me,Bt,!0),Ar=this.clusterProps.length,this.clusterProps.push(Ln)),Pe(Ln,this._map(Me,Yi)))}Me[Bt+4]=Ki,Ze.push(wi/pn,Ui/pn,1/0,Ki,-1,pn),Pe&&Ze.push(Ar)}else{for(let Ln=0;Ln<Mt;Ln++)Ze.push(Me[Bt+Ln]);if(pn>1)for(const Ln of In){const wi=Ln*Mt;if(!(Me[wi+2]<=ee)){Me[wi+2]=ee;for(let Ui=0;Ui<Mt;Ui++)Ze.push(Me[wi+Ui])}}}}return Ze}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,ee,ve){if(Y[ee+ft]>1){const je=this.clusterProps[Y[ee+gt]];return ve?Object.assign({},je):je}const ke=this.points[Y[ee+Be]].properties,Pe=this.options.map(ke);return ve&&Pe===ke?Object.assign({},Pe):Pe}}function en(_e,Y,ee){return{type:"Feature",id:_e[Y+Be],properties:Xt(_e,Y,ee),geometry:{type:"Point",coordinates:[(ve=_e[Y],360*(ve-.5)),Fn(_e[Y+1])]}};var ve}function Xt(_e,Y,ee){const ve=_e[Y+ft],ke=ve>=1e4?`${Math.round(ve/1e3)}k`:ve>=1e3?Math.round(ve/100)/10+"k":ve,Pe=_e[Y+gt],je=Pe===-1?{}:Object.assign({},ee[Pe]);return Object.assign(je,{cluster:!0,cluster_id:_e[Y+Be],point_count:ve,point_count_abbreviated:ke})}function wt(_e){return _e/360+.5}function Zt(_e){const Y=Math.sin(_e*Math.PI/180),ee=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ee<0?0:ee>1?1:ee}function Fn(_e){const Y=(180-360*_e)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Ci(_e,Y,ee,ve){for(var ke,Pe=ve,je=ee-Y>>1,Ne=ee-Y,Me=_e[Y],Ze=_e[Y+1],Mt=_e[ee],Bt=_e[ee+1],kt=Y+3;kt<ee;kt+=3){var yn=Vi(_e[kt],_e[kt+1],Me,Ze,Mt,Bt);if(yn>Pe)ke=kt,Pe=yn;else if(yn===Pe){var In=Math.abs(kt-je);In<Ne&&(ke=kt,Ne=In)}}Pe>ve&&(ke-Y>3&&Ci(_e,Y,ke,ve),_e[ke+2]=Pe,ee-ke>3&&Ci(_e,ke,ee,ve))}function Vi(_e,Y,ee,ve,ke,Pe){var je=ke-ee,Ne=Pe-ve;if(je!==0||Ne!==0){var Me=((_e-ee)*je+(Y-ve)*Ne)/(je*je+Ne*Ne);Me>1?(ee=ke,ve=Pe):Me>0&&(ee+=je*Me,ve+=Ne*Me)}return(je=_e-ee)*je+(Ne=Y-ve)*Ne}function gn(_e,Y,ee,ve){var ke={id:_e===void 0?null:_e,type:Y,geometry:ee,tags:ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Pe){var je=Pe.geometry,Ne=Pe.type;if(Ne==="Point"||Ne==="MultiPoint"||Ne==="LineString")sr(Pe,je);else if(Ne==="Polygon"||Ne==="MultiLineString")for(var Me=0;Me<je.length;Me++)sr(Pe,je[Me]);else if(Ne==="MultiPolygon")for(Me=0;Me<je.length;Me++)for(var Ze=0;Ze<je[Me].length;Ze++)sr(Pe,je[Me][Ze])}(ke),ke}function sr(_e,Y){for(var ee=0;ee<Y.length;ee+=3)_e.minX=Math.min(_e.minX,Y[ee]),_e.minY=Math.min(_e.minY,Y[ee+1]),_e.maxX=Math.max(_e.maxX,Y[ee]),_e.maxY=Math.max(_e.maxY,Y[ee+1])}function fi(_e,Y,ee,ve){if(Y.geometry){var ke=Y.geometry.coordinates,Pe=Y.geometry.type,je=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2),Ne=[],Me=Y.id;if(ee.promoteId?Me=Y.properties[ee.promoteId]:ee.generateId&&(Me=ve||0),Pe==="Point")wo(ke,Ne);else if(Pe==="MultiPoint")for(var Ze=0;Ze<ke.length;Ze++)wo(ke[Ze],Ne);else if(Pe==="LineString")ni(ke,Ne,je,!1);else if(Pe==="MultiLineString"){if(ee.lineMetrics){for(Ze=0;Ze<ke.length;Ze++)ni(ke[Ze],Ne=[],je,!1),_e.push(gn(Me,"LineString",Ne,Y.properties));return}Ur(ke,Ne,je,!1)}else if(Pe==="Polygon")Ur(ke,Ne,je,!0);else{if(Pe!=="MultiPolygon"){if(Pe==="GeometryCollection"){for(Ze=0;Ze<Y.geometry.geometries.length;Ze++)fi(_e,{id:Me,geometry:Y.geometry.geometries[Ze],properties:Y.properties},ee,ve);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ze=0;Ze<ke.length;Ze++){var Mt=[];Ur(ke[Ze],Mt,je,!0),Ne.push(Mt)}}_e.push(gn(Me,Pe,Ne,Y.properties))}}function wo(_e,Y){Y.push(Hs(_e[0])),Y.push(jo(_e[1])),Y.push(0)}function ni(_e,Y,ee,ve){for(var ke,Pe,je=0,Ne=0;Ne<_e.length;Ne++){var Me=Hs(_e[Ne][0]),Ze=jo(_e[Ne][1]);Y.push(Me),Y.push(Ze),Y.push(0),Ne>0&&(je+=ve?(ke*Ze-Me*Pe)/2:Math.sqrt(Math.pow(Me-ke,2)+Math.pow(Ze-Pe,2))),ke=Me,Pe=Ze}var Mt=Y.length-3;Y[2]=1,Ci(Y,0,Mt,ee),Y[Mt+2]=1,Y.size=Math.abs(je),Y.start=0,Y.end=Y.size}function Ur(_e,Y,ee,ve){for(var ke=0;ke<_e.length;ke++){var Pe=[];ni(_e[ke],Pe,ee,ve),Y.push(Pe)}}function Hs(_e){return _e/360+.5}function jo(_e){var Y=Math.sin(_e*Math.PI/180),ee=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ee<0?0:ee>1?1:ee}function ce(_e,Y,ee,ve,ke,Pe,je,Ne){if(ve/=Y,Pe>=(ee/=Y)&&je<ve)return _e;if(je<ee||Pe>=ve)return null;for(var Me=[],Ze=0;Ze<_e.length;Ze++){var Mt=_e[Ze],Bt=Mt.geometry,kt=Mt.type,yn=ke===0?Mt.minX:Mt.minY,In=ke===0?Mt.maxX:Mt.maxY;if(yn>=ee&&In<ve)Me.push(Mt);else if(!(In<ee||yn>=ve)){var _n=[];if(kt==="Point"||kt==="MultiPoint")Ee(Bt,_n,ee,ve,ke);else if(kt==="LineString")Oe(Bt,_n,ee,ve,ke,!1,Ne.lineMetrics);else if(kt==="MultiLineString")Xe(Bt,_n,ee,ve,ke,!1);else if(kt==="Polygon")Xe(Bt,_n,ee,ve,ke,!0);else if(kt==="MultiPolygon")for(var pn=0;pn<Bt.length;pn++){var Ln=[];Xe(Bt[pn],Ln,ee,ve,ke,!0),Ln.length&&_n.push(Ln)}if(_n.length){if(Ne.lineMetrics&&kt==="LineString"){for(pn=0;pn<_n.length;pn++)Me.push(gn(Mt.id,kt,_n[pn],Mt.tags));continue}kt!=="LineString"&&kt!=="MultiLineString"||(_n.length===1?(kt="LineString",_n=_n[0]):kt="MultiLineString"),kt!=="Point"&&kt!=="MultiPoint"||(kt=_n.length===3?"Point":"MultiPoint"),Me.push(gn(Mt.id,kt,_n,Mt.tags))}}}return Me.length?Me:null}function Ee(_e,Y,ee,ve,ke){for(var Pe=0;Pe<_e.length;Pe+=3){var je=_e[Pe+ke];je>=ee&&je<=ve&&(Y.push(_e[Pe]),Y.push(_e[Pe+1]),Y.push(_e[Pe+2]))}}function Oe(_e,Y,ee,ve,ke,Pe,je){for(var Ne,Me,Ze=pe(_e),Mt=ke===0?$e:Ot,Bt=_e.start,kt=0;kt<_e.length-3;kt+=3){var yn=_e[kt],In=_e[kt+1],_n=_e[kt+2],pn=_e[kt+3],Ln=_e[kt+4],wi=ke===0?yn:In,Ui=ke===0?pn:Ln,Ar=!1;je&&(Ne=Math.sqrt(Math.pow(yn-pn,2)+Math.pow(In-Ln,2))),wi<ee?Ui>ee&&(Me=Mt(Ze,yn,In,pn,Ln,ee),je&&(Ze.start=Bt+Ne*Me)):wi>ve?Ui<ve&&(Me=Mt(Ze,yn,In,pn,Ln,ve),je&&(Ze.start=Bt+Ne*Me)):Qe(Ze,yn,In,_n),Ui<ee&&wi>=ee&&(Me=Mt(Ze,yn,In,pn,Ln,ee),Ar=!0),Ui>ve&&wi<=ve&&(Me=Mt(Ze,yn,In,pn,Ln,ve),Ar=!0),!Pe&&Ar&&(je&&(Ze.end=Bt+Ne*Me),Y.push(Ze),Ze=pe(_e)),je&&(Bt+=Ne)}var Ki=_e.length-3;yn=_e[Ki],In=_e[Ki+1],_n=_e[Ki+2],(wi=ke===0?yn:In)>=ee&&wi<=ve&&Qe(Ze,yn,In,_n),Ki=Ze.length-3,Pe&&Ki>=3&&(Ze[Ki]!==Ze[0]||Ze[Ki+1]!==Ze[1])&&Qe(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&Y.push(Ze)}function pe(_e){var Y=[];return Y.size=_e.size,Y.start=_e.start,Y.end=_e.end,Y}function Xe(_e,Y,ee,ve,ke,Pe){for(var je=0;je<_e.length;je++)Oe(_e[je],Y,ee,ve,ke,Pe,!1)}function Qe(_e,Y,ee,ve){_e.push(Y),_e.push(ee),_e.push(ve)}function $e(_e,Y,ee,ve,ke,Pe){var je=(Pe-Y)/(ve-Y);return _e.push(Pe),_e.push(ee+(ke-ee)*je),_e.push(1),je}function Ot(_e,Y,ee,ve,ke,Pe){var je=(Pe-ee)/(ke-ee);return _e.push(Y+(ve-Y)*je),_e.push(Pe),_e.push(1),je}function mt(_e,Y){for(var ee=[],ve=0;ve<_e.length;ve++){var ke,Pe=_e[ve],je=Pe.type;if(je==="Point"||je==="MultiPoint"||je==="LineString")ke=De(Pe.geometry,Y);else if(je==="MultiLineString"||je==="Polygon"){ke=[];for(var Ne=0;Ne<Pe.geometry.length;Ne++)ke.push(De(Pe.geometry[Ne],Y))}else if(je==="MultiPolygon")for(ke=[],Ne=0;Ne<Pe.geometry.length;Ne++){for(var Me=[],Ze=0;Ze<Pe.geometry[Ne].length;Ze++)Me.push(De(Pe.geometry[Ne][Ze],Y));ke.push(Me)}ee.push(gn(Pe.id,je,ke,Pe.tags))}return ee}function De(_e,Y){var ee=[];ee.size=_e.size,_e.start!==void 0&&(ee.start=_e.start,ee.end=_e.end);for(var ve=0;ve<_e.length;ve+=3)ee.push(_e[ve]+Y,_e[ve+1],_e[ve+2]);return ee}function Ke(_e,Y){if(_e.transformed)return _e;var ee,ve,ke,Pe=1<<_e.z,je=_e.x,Ne=_e.y;for(ee=0;ee<_e.features.length;ee++){var Me=_e.features[ee],Ze=Me.geometry,Mt=Me.type;if(Me.geometry=[],Mt===1)for(ve=0;ve<Ze.length;ve+=2)Me.geometry.push(Lt(Ze[ve],Ze[ve+1],Y,Pe,je,Ne));else for(ve=0;ve<Ze.length;ve++){var Bt=[];for(ke=0;ke<Ze[ve].length;ke+=2)Bt.push(Lt(Ze[ve][ke],Ze[ve][ke+1],Y,Pe,je,Ne));Me.geometry.push(Bt)}}return _e.transformed=!0,_e}function Lt(_e,Y,ee,ve,ke,Pe){return[Math.round(ee*(_e*ve-ke)),Math.round(ee*(Y*ve-Pe))]}function mn(_e,Y,ee,ve,ke){for(var Pe=Y===ke.maxZoom?0:ke.tolerance/((1<<Y)*ke.extent),je={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ee,y:ve,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ne=0;Ne<_e.length;Ne++){je.numFeatures++,An(je,_e[Ne],Pe,ke);var Me=_e[Ne].minX,Ze=_e[Ne].minY,Mt=_e[Ne].maxX,Bt=_e[Ne].maxY;Me<je.minX&&(je.minX=Me),Ze<je.minY&&(je.minY=Ze),Mt>je.maxX&&(je.maxX=Mt),Bt>je.maxY&&(je.maxY=Bt)}return je}function An(_e,Y,ee,ve){var ke=Y.geometry,Pe=Y.type,je=[];if(Pe==="Point"||Pe==="MultiPoint")for(var Ne=0;Ne<ke.length;Ne+=3)je.push(ke[Ne]),je.push(ke[Ne+1]),_e.numPoints++,_e.numSimplified++;else if(Pe==="LineString")Xi(je,ke,_e,ee,!1,!1);else if(Pe==="MultiLineString"||Pe==="Polygon")for(Ne=0;Ne<ke.length;Ne++)Xi(je,ke[Ne],_e,ee,Pe==="Polygon",Ne===0);else if(Pe==="MultiPolygon")for(var Me=0;Me<ke.length;Me++){var Ze=ke[Me];for(Ne=0;Ne<Ze.length;Ne++)Xi(je,Ze[Ne],_e,ee,!0,Ne===0)}if(je.length){var Mt=Y.tags||null;if(Pe==="LineString"&&ve.lineMetrics){for(var Bt in Mt={},Y.tags)Mt[Bt]=Y.tags[Bt];Mt.mapbox_clip_start=ke.start/ke.size,Mt.mapbox_clip_end=ke.end/ke.size}var kt={geometry:je,type:Pe==="Polygon"||Pe==="MultiPolygon"?3:Pe==="LineString"||Pe==="MultiLineString"?2:1,tags:Mt};Y.id!==null&&(kt.id=Y.id),_e.features.push(kt)}}function Xi(_e,Y,ee,ve,ke,Pe){var je=ve*ve;if(ve>0&&Y.size<(ke?je:ve))ee.numPoints+=Y.length/3;else{for(var Ne=[],Me=0;Me<Y.length;Me+=3)(ve===0||Y[Me+2]>je)&&(ee.numSimplified++,Ne.push(Y[Me]),Ne.push(Y[Me+1])),ee.numPoints++;ke&&function(Ze,Mt){for(var Bt=0,kt=0,yn=Ze.length,In=yn-2;kt<yn;In=kt,kt+=2)Bt+=(Ze[kt]-Ze[In])*(Ze[kt+1]+Ze[In+1]);if(Bt>0===Mt)for(kt=0,yn=Ze.length;kt<yn/2;kt+=2){var _n=Ze[kt],pn=Ze[kt+1];Ze[kt]=Ze[yn-2-kt],Ze[kt+1]=Ze[yn-1-kt],Ze[yn-2-kt]=_n,Ze[yn-1-kt]=pn}}(Ne,Pe),_e.push(Ne)}}function yt(_e,Y){var ee=(Y=this.options=function(ke,Pe){for(var je in Pe)ke[je]=Pe[je];return ke}(Object.create(this.options),Y)).debug;if(ee&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var ve=function(ke,Pe){var je=[];if(ke.type==="FeatureCollection")for(var Ne=0;Ne<ke.features.length;Ne++)fi(je,ke.features[Ne],Pe,Ne);else fi(je,ke.type==="Feature"?ke:{geometry:ke},Pe);return je}(_e,Y);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ve=function(ke,Pe){var je=Pe.buffer/Pe.extent,Ne=ke,Me=ce(ke,1,-1-je,je,0,-1,2,Pe),Ze=ce(ke,1,1-je,2+je,0,-1,2,Pe);return(Me||Ze)&&(Ne=ce(ke,1,-je,1+je,0,-1,2,Pe)||[],Me&&(Ne=mt(Me,1).concat(Ne)),Ze&&(Ne=Ne.concat(mt(Ze,-1)))),Ne}(ve,Y),ve.length&&this.splitTile(ve,0,0,0),ee&&(ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function En(_e,Y,ee){return 32*((1<<_e)*ee+Y)+_e}function xi(_e,Y){const ee=_e.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const ve=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!ve)return Y(null,null);const ke=new class{constructor(je){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=je.length,this._features=je}feature(je){return new class{constructor(Ne){this._feature=Ne,this.extent=o.EXTENT,this.type=Ne.type,this.properties=Ne.tags,"id"in Ne&&!isNaN(Ne.id)&&(this.id=parseInt(Ne.id,10))}loadGeometry(){if(this._feature.type===1){const Ne=[];for(const Me of this._feature.geometry)Ne.push([new o.Point(Me[0],Me[1])]);return Ne}{const Ne=[];for(const Me of this._feature.geometry){const Ze=[];for(const Mt of Me)Ze.push(new o.Point(Mt[0],Mt[1]));Ne.push(Ze)}return Ne}}toGeoJSON(Ne,Me,Ze){return z.call(this,Ne,Me,Ze)}}(this._features[je])}}(ve.features);let Pe=lt(ke);Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),Y(null,{vectorTile:ke,rawData:Pe.buffer})}yt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},yt.prototype.splitTile=function(_e,Y,ee,ve,ke,Pe,je){for(var Ne=[_e,Y,ee,ve],Me=this.options,Ze=Me.debug;Ne.length;){ve=Ne.pop(),ee=Ne.pop(),Y=Ne.pop(),_e=Ne.pop();var Mt=1<<Y,Bt=En(Y,ee,ve),kt=this.tiles[Bt];if(!kt&&(Ze>1&&console.time("creation"),kt=this.tiles[Bt]=mn(_e,Y,ee,ve,Me),this.tileCoords.push({z:Y,x:ee,y:ve}),Ze)){Ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,ee,ve,kt.numFeatures,kt.numPoints,kt.numSimplified),console.timeEnd("creation"));var yn="z"+Y;this.stats[yn]=(this.stats[yn]||0)+1,this.total++}if(kt.source=_e,ke){if(Y===Me.maxZoom||Y===ke)continue;var In=1<<ke-Y;if(ee!==Math.floor(Pe/In)||ve!==Math.floor(je/In))continue}else if(Y===Me.indexMaxZoom||kt.numPoints<=Me.indexMaxPoints)continue;if(kt.source=null,_e.length!==0){Ze>1&&console.time("clipping");var _n,pn,Ln,wi,Ui,Ar,Ki=.5*Me.buffer/Me.extent,ns=.5-Ki,Yi=.5+Ki,qr=1+Ki;_n=pn=Ln=wi=null,Ui=ce(_e,Mt,ee-Ki,ee+Yi,0,kt.minX,kt.maxX,Me),Ar=ce(_e,Mt,ee+ns,ee+qr,0,kt.minX,kt.maxX,Me),_e=null,Ui&&(_n=ce(Ui,Mt,ve-Ki,ve+Yi,1,kt.minY,kt.maxY,Me),pn=ce(Ui,Mt,ve+ns,ve+qr,1,kt.minY,kt.maxY,Me),Ui=null),Ar&&(Ln=ce(Ar,Mt,ve-Ki,ve+Yi,1,kt.minY,kt.maxY,Me),wi=ce(Ar,Mt,ve+ns,ve+qr,1,kt.minY,kt.maxY,Me),Ar=null),Ze>1&&console.timeEnd("clipping"),Ne.push(_n||[],Y+1,2*ee,2*ve),Ne.push(pn||[],Y+1,2*ee,2*ve+1),Ne.push(Ln||[],Y+1,2*ee+1,2*ve),Ne.push(wi||[],Y+1,2*ee+1,2*ve+1)}}},yt.prototype.getTile=function(_e,Y,ee){var ve=this.options,ke=ve.extent,Pe=ve.debug;if(_e<0||_e>24)return null;var je=1<<_e,Ne=En(_e,Y=(Y%je+je)%je,ee);if(this.tiles[Ne])return Ke(this.tiles[Ne],ke);Pe>1&&console.log("drilling down to z%d-%d-%d",_e,Y,ee);for(var Me,Ze=_e,Mt=Y,Bt=ee;!Me&&Ze>0;)Ze--,Mt=Math.floor(Mt/2),Bt=Math.floor(Bt/2),Me=this.tiles[En(Ze,Mt,Bt)];return Me&&Me.source?(Pe>1&&console.log("found parent tile z%d-%d-%d",Ze,Mt,Bt),Pe>1&&console.time("drilling down"),this.splitTile(Me.source,Ze,Mt,Bt,_e,Y,ee),Pe>1&&console.timeEnd("drilling down"),this.tiles[Ne]?Ke(this.tiles[Ne],ke):null):null};class fo extends o.VectorTileWorkerSource{constructor(Y,ee,ve,ke,Pe){super(Y,ee,ve,ke,xi),Pe&&(this.loadGeoJSON=Pe)}loadData(Y,ee){const ve=Y&&Y.request,ke=ve&&ve.collectResourceTiming;this.loadGeoJSON(Y,(Pe,je)=>{if(Pe||!je)return ee(Pe);if(typeof je!="object")return ee(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{D(je,!0);try{if(Y.filter){const Me=o.createExpression(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Me.result==="error")throw new Error(Me.value.map(Mt=>`${Mt.key}: ${Mt.message}`).join(", "));je={type:"FeatureCollection",features:je.features.filter(Mt=>Me.value.evaluate({zoom:0},Mt))}}this._geoJSONIndex=Y.cluster?new Nt(function({superclusterOptions:Me,clusterProperties:Ze}){if(!Ze||!Me)return Me;const Mt={},Bt={},kt={accumulated:null,zoom:0},yn={properties:null},In=Object.keys(Ze);for(const _n of In){const[pn,Ln]=Ze[_n],wi=o.createExpression(Ln),Ui=o.createExpression(typeof pn=="string"?[pn,["accumulated"],["get",_n]]:pn);Mt[_n]=wi.value,Bt[_n]=Ui.value}return Me.map=_n=>{yn.properties=_n;const pn={};for(const Ln of In)pn[Ln]=Mt[Ln].evaluate(kt,yn);return pn},Me.reduce=(_n,pn)=>{yn.properties=pn;for(const Ln of In)kt.accumulated=_n[Ln],_n[Ln]=Bt[Ln].evaluate(kt,yn)},Me}(Y)).load(je.features):function(Me,Ze){return new yt(Me,Ze)}(je,Y.geojsonVtOptions)}catch(Me){return ee(Me)}this.loaded={};const Ne={};if(ke){const Me=o.getPerformanceMeasurement(ve);Me&&(Ne.resourceTiming={},Ne.resourceTiming[Y.source]=JSON.parse(JSON.stringify(Me)))}ee(null,Ne)}})}reloadTile(Y,ee){const ve=this.loaded;return ve&&ve[Y.uid]?super.reloadTile(Y,ee):this.loadTile(Y,ee)}loadGeoJSON(Y,ee){if(Y.request)o.getJSON(Y.request,ee);else{if(typeof Y.data!="string")return ee(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return ee(null,JSON.parse(Y.data))}catch(ve){return ee(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,ee){try{ee(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(ve){ee(ve)}}getClusterChildren(Y,ee){try{ee(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(ve){ee(ve)}}getClusterLeaves(Y,ee){try{ee(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(ve){ee(ve)}}}class nl{constructor(Y){this.self=Y,this.actor=new o.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:fo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ee,ve)=>{if(this.workerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.workerSourceTypes[ee]=ve},this.self.registerRTLTextPlugin=ee=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=ee.applyArabicShaping,o.plugin.processBidirectionalText=ee.processBidirectionalText,o.plugin.processStyledBidirectionalText=ee.processStyledBidirectionalText}}clearCaches(Y,ee,ve){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],ve()}checkIfReady(Y,ee,ve){ve()}setReferrer(Y,ee){this.referrer=ee}spriteLoaded(Y,ee){this.isSpriteLoaded[Y]=ee;for(const ve in this.workerSources[Y]){const ke=this.workerSources[Y][ve];for(const Pe in ke)ke[Pe]instanceof o.VectorTileWorkerSource&&(ke[Pe].isSpriteLoaded=ee,ke[Pe].fire(new o.Event("isSpriteLoaded")))}}setImages(Y,ee,ve){this.availableImages[Y]=ee;for(const ke in this.workerSources[Y]){const Pe=this.workerSources[Y][ke];for(const je in Pe)Pe[je].availableImages=ee}ve()}enableTerrain(Y,ee,ve){this.terrain=ee,ve()}setProjection(Y,ee){this.projections[Y]=o.getProjection(ee)}setLayers(Y,ee,ve){this.getLayerIndex(Y).replace(ee),ve()}updateLayers(Y,ee,ve){this.getLayerIndex(Y).update(ee.layers,ee.removedIds),ve()}loadTile(Y,ee,ve){const ke=this.enableTerrain?o.extend({enableTerrain:this.terrain},ee):ee;ke.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ee.type,ee.source).loadTile(ke,ve)}loadDEMTile(Y,ee,ve){const ke=this.enableTerrain?o.extend({buildQuadTree:this.terrain},ee):ee;this.getDEMWorkerSource(Y,ee.source).loadTile(ke,ve)}reloadTile(Y,ee,ve){const ke=this.enableTerrain?o.extend({enableTerrain:this.terrain},ee):ee;ke.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ee.type,ee.source).reloadTile(ke,ve)}abortTile(Y,ee,ve){this.getWorkerSource(Y,ee.type,ee.source).abortTile(ee,ve)}removeTile(Y,ee,ve){this.getWorkerSource(Y,ee.type,ee.source).removeTile(ee,ve)}removeSource(Y,ee,ve){if(!this.workerSources[Y]||!this.workerSources[Y][ee.type]||!this.workerSources[Y][ee.type][ee.source])return;const ke=this.workerSources[Y][ee.type][ee.source];delete this.workerSources[Y][ee.type][ee.source],ke.removeSource!==void 0?ke.removeSource(ee,ve):ve()}loadWorkerSource(Y,ee,ve){try{this.self.importScripts(ee.url),ve()}catch(ke){ve(ke.toString())}}syncRTLPluginState(Y,ee,ve){try{o.plugin.setState(ee);const ke=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&ke!=null){this.self.importScripts(ke);const Pe=o.plugin.isParsed();ve(Pe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ke}`),Pe)}}catch(ke){ve(ke.toString())}}getAvailableImages(Y){let ee=this.availableImages[Y];return ee||(ee=[]),ee}getLayerIndex(Y){let ee=this.layerIndexes[Y];return ee||(ee=this.layerIndexes[Y]=new _),ee}getWorkerSource(Y,ee,ve){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][ee]||(this.workerSources[Y][ee]={}),!this.workerSources[Y][ee][ve]){const ke={send:(Pe,je,Ne,Me,Ze,Mt)=>{this.actor.send(Pe,je,Ne,Y,Ze,Mt)},scheduler:this.actor.scheduler};this.workerSources[Y][ee][ve]=new this.workerSourceTypes[ee](ke,this.getLayerIndex(Y),this.getAvailableImages(Y),this.isSpriteLoaded[Y])}return this.workerSources[Y][ee][ve]}getDEMWorkerSource(Y,ee){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][ee]||(this.demWorkerSources[Y][ee]=new w),this.demWorkerSources[Y][ee]}enforceCacheSizeLimit(Y,ee){o.enforceCacheSizeLimit(ee)}getWorkerPerformanceMetrics(Y,ee,ve){ve(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new nl(self)),nl}),a(["./shared"],function(o){function f(y,u){if(Array.isArray(y)){if(!Array.isArray(u)||y.length!==u.length)return!1;for(let p=0;p<y.length;p++)if(!f(y[p],u[p]))return!1;return!0}if(typeof y=="object"&&y!==null&&u!==null){if(typeof u!="object"||Object.keys(y).length!==Object.keys(u).length)return!1;for(const p in y)if(!f(y[p],u[p]))return!1;return!0}return y===u}var g=_;function _(y){return!function(u){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,S,k=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(k);try{S=new Worker(M),b=!0}catch(P){b=!1}return S&&S.terminate(),URL.revokeObjectURL(M),b}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var b=document.createElement("canvas");b.width=b.height=1;var S=b.getContext("2d");if(!S)return!1;var k=S.getImageData(0,0,1,1);return k&&k.width===b.width}()?(w[p=u&&u.failIfMajorPerformanceCaveat]===void 0&&(w[p]=function(b){var S,k=function(M){var P=document.createElement("canvas"),R=Object.create(_.webGLContextAttributes);return R.failIfMajorPerformanceCaveat=M,P.getContext("webgl",R)||P.getContext("experimental-webgl",R)}(b);if(!k)return!1;try{S=k.createShader(k.VERTEX_SHADER)}catch(M){return!1}return!(!S||k.isContextLost())&&(k.shaderSource(S,"void main() {}"),k.compileShader(S),k.getShaderParameter(S,k.COMPILE_STATUS)===!0)}(p)),w[p]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var p}(y)}var w={};function T(y,u,p){const b=o.window.document.createElement(y);return u!==void 0&&(b.className=u),p&&p.appendChild(b),b}function A(y,u,p){const b=o.window.document.createElementNS("http://www.w3.org/2000/svg",y);for(const S of Object.keys(u))b.setAttributeNS(null,S,u[S]);return p&&p.appendChild(b),b}_.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const D=o.window.document&&o.window.document.documentElement.style,z=D&&D.userSelect!==void 0?"userSelect":"WebkitUserSelect";let G;function V(){D&&z&&(G=D[z],D[z]="none")}function N(){D&&z&&(D[z]=G)}function q(y){y.preventDefault(),y.stopPropagation(),o.window.removeEventListener("click",q,!0)}function K(){o.window.addEventListener("click",q,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",q,!0)},0)}function se(y,u){const p=y.getBoundingClientRect();return J(y,p,u)}function ie(y,u){const p=y.getBoundingClientRect(),b=[];for(let S=0;S<u.length;S++)b.push(J(y,p,u[S]));return b}function Q(y){return o.window.InstallTrigger!==void 0&&y.button===2&&y.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button}function J(y,u,p){const b=y.offsetWidth===u.width?1:y.offsetWidth/u.width;return new o.Point((p.clientX-u.left)*b,(p.clientY-u.top)*b)}function te(y,u){var p=u[0],b=u[1],S=u[2],k=u[3],M=p*k-S*b;return M?(y[0]=k*(M=1/M),y[1]=-b*M,y[2]=-S*M,y[3]=p*M,y):null}function me(y){const{userImage:u}=y;return!!(u&&u.render&&u.render())&&(y.data.replace(new Uint8Array(u.data.buffer)),!0)}class Fe extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:p,callback:b}of this.requestors)this._notify(p,b);this.requestors=[]}}hasImage(u){return!!this.getImage(u)}getImage(u){return this.images[u]}addImage(u,p){this._validate(u,p)&&(this.images[u]=p)}_validate(u,p){let b=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${u}" has invalid "stretchX" value`))),b=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${u}" has invalid "stretchY" value`))),b=!1),this._validateContent(p.content,p)||(this.fire(new o.ErrorEvent(new Error(`Image "${u}" has invalid "content" value`))),b=!1),b}_validateStretch(u,p){if(!u)return!0;let b=0;for(const S of u){if(S[0]<b||S[1]<S[0]||p<S[1])return!1;b=S[1]}return!0}_validateContent(u,p){return!(u&&(u.length!==4||u[0]<0||p.data.width<u[0]||u[1]<0||p.data.height<u[1]||u[2]<0||p.data.width<u[2]||u[3]<0||p.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,p){p.version=this.images[u].version+1,this.images[u]=p,this.updatedImages[u]=!0}removeImage(u){const p=this.images[u];delete this.images[u],delete this.patterns[u],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u,p){let b=!0;if(!this.isLoaded())for(const S of u)this.images[S]||(b=!1);this.isLoaded()||b?this._notify(u,p):this.requestors.push({ids:u,callback:p})}_notify(u,p){const b={};for(const S of u){this.images[S]||this.fire(new o.Event("styleimagemissing",{id:S}));const k=this.images[S];k?b[S]={data:k.data.clone(),pixelRatio:k.pixelRatio,sdf:k.sdf,version:k.version,stretchX:k.stretchX,stretchY:k.stretchY,content:k.content,hasRenderCallback:!!(k.userImage&&k.userImage.render)}:o.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,b)}getPixelSize(){const{width:u,height:p}=this.atlasImage;return{width:u,height:p}}getPattern(u){const p=this.patterns[u],b=this.getImage(u);if(!b)return null;if(p&&p.position.version===b.version)return p.position;if(p)p.position.version=b.version;else{const S={w:b.data.width+2,h:b.data.height+2,x:0,y:0},k=new o.ImagePosition(S,b);this.patterns[u]={bin:S,position:k}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const p=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(u,this.atlasImage,p.RGBA),this.atlasTexture&&this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const k in this.patterns)u.push(this.patterns[k].bin);const{w:p,h:b}=o.potpack(u),S=this.atlasImage;S.resize({width:p||1,height:b||1});for(const k in this.patterns){const{bin:M}=this.patterns[k],P=M.x+1,R=M.y+1,$=this.images[k].data,F=$.width,H=$.height;o.RGBAImage.copy($,S,{x:0,y:0},{x:P,y:R},{width:F,height:H}),o.RGBAImage.copy($,S,{x:0,y:H-1},{x:P,y:R-1},{width:F,height:1}),o.RGBAImage.copy($,S,{x:0,y:0},{x:P,y:R+H},{width:F,height:1}),o.RGBAImage.copy($,S,{x:F-1,y:0},{x:P-1,y:R},{width:1,height:H}),o.RGBAImage.copy($,S,{x:0,y:0},{x:P+F,y:R},{width:1,height:H})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const p of u){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const b=this.images[p];me(b)&&this.updateImage(p,b)}}}const tt=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(y,u){return function([p,b,S]){const k=o.degToRad(b+90),M=o.degToRad(S);return{x:p*Math.cos(k)*Math.sin(M),y:p*Math.sin(k)*Math.sin(M),z:p*Math.cos(M),azimuthal:b,polar:S}}(y.expression.evaluate(u))}interpolate(y,u,p){return{x:o.number(y.x,u.x,p),y:o.number(y.y,u.y,p),z:o.number(y.z,u.z,p),azimuthal:o.number(y.azimuthal,u.azimuthal,p),polar:o.number(y.polar,u.polar,p)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)});class At extends o.Evented{constructor(u){super(),this._transitionable=new o.Transitionable(tt),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,p={}){if(!this._validate(o.validateLight,u,p))for(const b in u){const S=u[b];o.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-11),S):this._transitionable.setValue(b,S)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,b){return(!b||b.validate!==!1)&&o.emitValidationErrors(this,u.call(o.validateStyle,o.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const _t=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)});let xt=class extends o.Evented{constructor(y,u){super(),this._transitionable=new o.Transitionable(_t),this.set(y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(y){for(const u in y){const p=y[u];o.endsWith(u,"-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}updateTransitions(y){this._transitioning=this._transitionable.transitioned(y,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(y){this.properties=this._transitioning.possiblyEvaluate(y)}};function lt(y,u,p,b){const S=o.smoothstep(45,65,p),[k,M]=zt(y,b),P=o.length(u);let R=1-Math.min(1,Math.exp((P-k)/(M-k)*-6));return R*=R*R,R=Math.min(1,1.00747*R),R*S*y.alpha}function zt(y,u){const p=.5/Math.tan(.5*u);return[y.range[0]+p,y.range[1]+p]}const ze=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])});class ot extends o.Evented{constructor(u,p){super(),this._transitionable=new o.Transitionable(ze),this.set(u),this._transitioning=this._transitionable.untransitioned(),this._transform=p}get state(){const u=this._transform,p=u.projection.name==="globe",b=o.globeToMercatorTransition(u.zoom),S=this.properties.get("range"),k=[.5,3];return{range:p?[o.number(k[0],S[0],b),o.number(k[1],S[1],b)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,p={}){if(!this._validate(o.validateFog,u,p)){for(const b of Object.keys(o.spec.fog))u&&u[b]===void 0&&(u[b]=o.spec.fog[b].default);for(const b in u){const S=u[b];o.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-11),S):this._transitionable.setValue(b,S)}}}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const p=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,u))*p.a}getOpacityAtLatLng(u,p){return this._transform.projection.supportsFog?function(b,S,k){const M=o.MercatorCoordinate.fromLngLat(S),P=k.elevation?k.elevation.getAtPointOrZero(M):0,R=[M.x,M.y,P];return o.transformMat4(R,R,k.mercatorFogMatrix),lt(b,R,k.pitch,k._fov)}(this.state,u,p):0}getFovAdjustedRange(u){return this._transform.projection.supportsFog?zt(this.state,u):[0,1]}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,b){return(!b||b.validate!==!1)&&o.emitValidationErrors(this,u.call(o.validateStyle,o.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Be{constructor(u,p){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const b=this.workerPool.acquire(this.id);for(let S=0;S<b.length;S++){const k=new Be.Actor(b[S],p,this.id);k.name=`Worker ${S}`,this.actors.push(k)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(u,p,b){o.asyncAll(this.actors,(S,k)=>{S.send(u,p,k)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(u=>{u.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ft(y,u,p){return u*(o.EXTENT/(y.tileSize*Math.pow(2,p-y.tileID.overscaledZ)))}Be.Actor=o.Actor;class gt{constructor(u,p,b,S){this.screenBounds=u,this.cameraPoint=p,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=b,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(u,p){let b,S;if(u instanceof o.Point||typeof u[0]=="number"){const k=o.Point.convert(u);b=[k],S=p.isPointAboveHorizon(k)}else{const k=o.Point.convert(u[0]),M=o.Point.convert(u[1]);b=[k,M],S=o.polygonizeBounds(k,M).every(P=>p.isPointAboveHorizon(P))}return new gt(b,p.getCameraPoint(),S,p)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(u){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const p=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],S=o.polygonizeBounds(p,b,0,!1);return this.cameraPoint.y>b.y&&(this.cameraPoint.x>p.x&&this.cameraPoint.x<b.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=b.x?S[2]=this.cameraPoint:this.cameraPoint.x<=p.x&&(S[3]=this.cameraPoint)),o.bufferConvexPolygon(S,u)}bufferedCameraGeometryGlobe(u){const p=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new o.Point(1,1)):this.screenBounds[1],S=o.polygonizeBounds(p,b,u),k=this.cameraPoint.clone();switch(3*((k.y>p.y)+(k.y>b.y))+((k.x>p.x)+(k.x>b.x))){case 0:S[0]=k,S[4]=k.clone();break;case 1:S.splice(1,0,k);break;case 2:S[1]=k;break;case 3:S.splice(4,0,k);break;case 5:S.splice(2,0,k);break;case 6:S[3]=k;break;case 7:S.splice(3,0,k);break;case 8:S[2]=k}return S}containsTile(u,p,b,S=0){const k=u.queryPadding/p._pixelsPerMercatorPixel+1,M=b?this._bufferedCameraMercator(k,p):this._bufferedScreenMercator(k,p);let P=u.tileID.wrap+(M.unwrapped?S:0);const R=M.polygon.map(de=>o.getTilePoint(u.tileTransform,de,P));if(!o.polygonIntersectsBox(R,0,0,o.EXTENT,o.EXTENT))return;P=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const $=this.screenGeometryMercator.polygon.map(de=>o.getTileVec3(u.tileTransform,de,P)),F=$.map(de=>new o.Point(de[0],de[1])),H=p.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),ne=o.getTileVec3(u.tileTransform,H,P),ae=$.map(de=>{const Z=o.sub(de,de,ne);return o.normalize(Z,Z),new o.Ray(ne,Z)}),ue=ft(u,1,p.zoom)*p._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:ae,bufferedTilespaceGeometry:R,bufferedTilespaceBounds:(le=o.getBounds(R),le.min.x=o.clamp(le.min.x,0,o.EXTENT),le.min.y=o.clamp(le.min.y,0,o.EXTENT),le.max.x=o.clamp(le.max.x,0,o.EXTENT),le.max.y=o.clamp(le.max.y,0,o.EXTENT),le),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:ue};var le}_bufferedScreenMercator(u,p){const b=Xt(u);if(this._screenRaycastCache[b])return this._screenRaycastCache[b];{let S;return S=p.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(u),p):{polygon:this.bufferedScreenGeometry(u).map(k=>p.pointCoordinate3D(k)),unwrapped:!0},this._screenRaycastCache[b]=S,S}}_bufferedCameraMercator(u,p){const b=Xt(u);if(this._cameraRaycastCache[b])return this._cameraRaycastCache[b];{let S;return S=p.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),p):{polygon:this.bufferedCameraGeometry(u).map(k=>p.pointCoordinate3D(k)),unwrapped:!0},this._cameraRaycastCache[b]=S,S}}_projectAndResample(u,p){const b=function(k,M){const P=o.multiply([],M.pixelMatrix,M.globeMatrix),R=[0,-o.GLOBE_RADIUS,0,1],$=[0,o.GLOBE_RADIUS,0,1],F=[0,0,0,1];o.transformMat4$1(R,R,P),o.transformMat4$1($,$,P),o.transformMat4$1(F,F,P);const H=new o.Point(R[0]/R[3],R[1]/R[3]),ne=new o.Point($[0]/$[3],$[1]/$[3]),ae=o.polygonContainsPoint(k,H)&&R[3]<F[3],ue=o.polygonContainsPoint(k,ne)&&$[3]<F[3];if(!ae&&!ue)return null;const le=function(Ce,Le,Re){for(let Ge=1;Ge<Ce.length;Ge++){const St=en(Le.pointCoordinate3D(Ce[Ge-1]).x),Ve=en(Le.pointCoordinate3D(Ce[Ge]).x);if(Re<0){if(St<Ve)return{idx:Ge,t:-St/(Ve-1-St)}}else if(Ve<St)return{idx:Ge,t:(1-St)/(Ve+1-St)}}return null}(k,M,ae?-1:1);if(!le)return null;const{idx:de,t:Z}=le;let oe=de>1?Nt(k.slice(0,de),M):[],ge=de<k.length?Nt(k.slice(de),M):[];oe=oe.map(Ce=>new o.Point(en(Ce.x),Ce.y)),ge=ge.map(Ce=>new o.Point(en(Ce.x),Ce.y));const ye=[...oe];ye.length===0&&ye.push(ge[ge.length-1]);const Te=o.number(ye[ye.length-1].y,(ge.length===0?oe[0]:ge[0]).y,Z);let Ie;return Ie=ae?[new o.Point(0,Te),new o.Point(0,0),new o.Point(1,0),new o.Point(1,Te)]:[new o.Point(1,Te),new o.Point(1,1),new o.Point(0,1),new o.Point(0,Te)],ye.push(...Ie),ge.length===0?ye.push(oe[0]):ye.push(...ge),{polygon:ye.map(Ce=>new o.MercatorCoordinate(Ce.x,Ce.y)),unwrapped:!1}}(u,p);if(b)return b;const S=function(k,M){let P=!1,R=-1/0,$=0;for(let H=0;H<k.length-1;H++)k[H].x>R&&(R=k[H].x,$=H);for(let H=0;H<k.length-1;H++){const ne=($+H)%(k.length-1),ae=k[ne],ue=k[ne+1];Math.abs(ae.x-ue.x)>.5&&(ae.x<ue.x?(ae.x+=1,ne===0&&(k[k.length-1].x+=1)):(ue.x+=1,ne+1===k.length-1&&(k[0].x+=1)),P=!0)}const F=o.mercatorXfromLng(M.center.lng);return P&&F<Math.abs(F-1)&&k.forEach(H=>{H.x-=1}),{polygon:k,unwrapped:P}}(Nt(u,p).map(k=>new o.Point(en(k.x),k.y)),p);return{polygon:S.polygon.map(k=>new o.MercatorCoordinate(k.x,k.y)),unwrapped:S.unwrapped}}}function Nt(y,u){return o.resample(y,p=>{const b=u.pointCoordinate3D(p);p.x=b.x,p.y=b.y},1/256)}function en(y){return y<0?1+y%1:y%1}function Xt(y){return 100*y|0}function wt(y,u,p,b,S){const k=function(M,P){if(M)return S(M);if(P){y.url&&P.tiles&&y.tiles&&delete y.tiles;const R=o.pick(o.extend(P,y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(R.vectorLayers=P.vector_layers,R.vectorLayerIds=R.vectorLayers.map($=>$.id)),R.tiles=u.canonicalizeTileset(R,y.url),S(null,R)}};return y.url?o.getJSON(u.transformRequest(u.normalizeSourceURL(y.url,null,p,b),o.ResourceType.Source),k):o.exported.frame(()=>k(null,y))}class Zt{constructor(u,p,b){this.bounds=o.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=p||0,this.maxzoom=b||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const p=Math.pow(2,u.z),b=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*p),S=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*p),k=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*p),M=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*p);return u.x>=b&&u.x<k&&u.y>=S&&u.y<M}}class Fn{constructor(u,p,b){this.context=u;const S=u.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ci={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Vi{constructor(u,p,b,S){this.length=p.length,this.attributes=b,this.itemSize=p.bytesPerElement,this.dynamicDraw=S,this.context=u;const k=u.gl;this.buffer=k.createBuffer(),u.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,p){for(let b=0;b<this.attributes.length;b++){const S=p.attributes[this.attributes[b].name];S!==void 0&&u.enableVertexAttribArray(S)}}setVertexAttribPointers(u,p,b){for(let S=0;S<this.attributes.length;S++){const k=this.attributes[S],M=p.attributes[k.name];M!==void 0&&u.vertexAttribPointer(M,k.components,u[Ci[k.type]],!1,this.itemSize,k.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class gn{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class sr extends gn{getDefault(){return o.Color.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class fi extends gn{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class wo extends gn{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class ni extends gn{getDefault(){return[!0,!0,!0,!0]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Ur extends gn{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class Hs extends gn{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class jo extends gn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const p=this.current;(u.func!==p.func||u.ref!==p.ref||u.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class ce extends gn{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class Ee extends gn{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=u,this.dirty=!1}}class Oe extends gn{getDefault(){return[0,1]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class pe extends gn{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=u,this.dirty=!1}}class Xe extends gn{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class Qe extends gn{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.BLEND):p.disable(p.BLEND),this.current=u,this.dirty=!1}}class $e extends gn{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class Ot extends gn{getDefault(){return o.Color.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class mt extends gn{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class De extends gn{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=u,this.dirty=!1}}class Ke extends gn{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class Lt extends gn{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}let mn,An=class extends gn{getDefault(){return null}set(y){(y!==this.current||this.dirty)&&(this.gl.useProgram(y),this.current=y,this.dirty=!1)}};class Xi extends gn{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class yt extends gn{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class En extends gn{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class xi extends gn{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class fo extends gn{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class nl extends gn{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class _e extends gn{getDefault(){return null}set(u){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Y extends gn{constructor(u){super(u),this.vao=u.extVertexArrayObject}getDefault(){return null}set(u){this.vao&&(u!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(u),this.current=u,this.dirty=!1)}}class ee extends gn{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class ve extends gn{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class ke extends gn{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Pe extends gn{constructor(u,p){super(u),this.context=u,this.parent=p}getDefault(){return null}}class je extends Pe{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Ne extends Pe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,this.attachment(),p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Me extends Ne{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ze{constructor(u,p,b,S){this.context=u,this.width=p,this.height=b;const k=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new je(u,k),S&&(this.depthAttachment=new Ne(u,k))}destroy(){const u=this.context.gl,p=this.colorAttachment.get();if(p&&u.deleteTexture(p),this.depthAttachment){const b=this.depthAttachment.get();b&&u.deleteRenderbuffer(b)}u.deleteFramebuffer(this.framebuffer)}}class Mt{constructor(u,p=!1){if(this.gl=u,this.isWebGL2=p,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),p){const b=u;this.extVertexArrayObject={createVertexArrayOES:b.createVertexArray.bind(u),deleteVertexArrayOES:b.deleteVertexArray.bind(u),bindVertexArrayOES:b.bindVertexArray.bind(u)}}this.clearColor=new sr(this),this.clearDepth=new fi(this),this.clearStencil=new wo(this),this.colorMask=new ni(this),this.depthMask=new Ur(this),this.stencilMask=new Hs(this),this.stencilFunc=new jo(this),this.stencilOp=new ce(this),this.stencilTest=new Ee(this),this.depthRange=new Oe(this),this.depthTest=new pe(this),this.depthFunc=new Xe(this),this.blend=new Qe(this),this.blendFunc=new $e(this),this.blendColor=new Ot(this),this.blendEquation=new mt(this),this.cullFace=new De(this),this.cullFaceSide=new Ke(this),this.frontFace=new Lt(this),this.program=new An(this),this.activeTexture=new Xi(this),this.viewport=new yt(this),this.bindFramebuffer=new En(this),this.bindRenderbuffer=new xi(this),this.bindTexture=new fo(this),this.bindVertexBuffer=new nl(this),this.bindElementBuffer=new _e(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Y(this),this.pixelStoreUnpack=new ee(this),this.pixelStoreUnpackPremultiplyAlpha=new ve(this),this.pixelStoreUnpackFlipY=new ke(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),p||(this.extTextureHalfFloat=u.getExtension("OES_texture_half_float")),(p||this.extTextureHalfFloat&&u.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=p||u.getExtension("OES_standard_derivatives"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,p){return new Fn(this,u,p)}createVertexBuffer(u,p,b){return new Vi(this,u,p,b)}createRenderbuffer(u,p,b){const S=this.gl,k=S.createRenderbuffer();return this.bindRenderbuffer.set(k),S.renderbufferStorage(S.RENDERBUFFER,u,p,b),this.bindRenderbuffer.set(null),k}createFramebuffer(u,p,b){return new Ze(this,u,p,b)}clear({color:u,depth:p,stencil:b}){const S=this.gl;let k=0;u&&(k|=S.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(k|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),b!==void 0&&(k|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),S.clear(k)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){f(u.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Bt extends o.Evented{constructor(u,p,b,S){if(super(),this.id=u,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(p,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(u){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const p=Array.isArray(this.map._language)?this.map._language.join():this.map._language,b=this.map._worldview;this._tileJSONRequest=wt(this._options,this.map._requestManager,p,b,(S,k)=>{this._tileJSONRequest=null,this._loaded=!0,S?(p&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${p}`),b&&b.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${b}`),this.fire(new o.ErrorEvent(S))):k&&(o.extend(this,k),k.bounds&&(this.tileBounds=new Zt(k.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(k.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(S)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(u,p){const b=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(b,o.ResourceType.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,u.actor&&u.state!=="expired")u.state==="loading"?u.reloadCallback=p:u.request=u.actor.send("reloadTile",S,k.bind(this));else if(u.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",S,k.bind(this),void 0,!0);else{const M=o.loadVectorTile.call({deduped:this._deduped},S,(P,R)=>{P||!R?k.call(this,P):(S.data={cacheControl:R.cacheControl,expires:R.expires,rawData:R.rawData.slice(0)},u.actor&&u.actor.send("loadTile",S,k.bind(this),void 0,!0))},!0);u.request={cancel:M}}function k(M,P){return delete u.request,u.aborted?p(null):M&&M.status!==404?p(M):(P&&P.resourceTiming&&(u.resourceTiming=P.resourceTiming),this.map._refreshExpiredTiles&&P&&u.setExpiryData(P),u.loadVectorData(P,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id})}unloadTile(u){u.unloadVectorData(),u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class kt extends o.Evented{constructor(u,p,b,S){super(),this.id=u,this.dispatcher=b,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},p),o.extend(this,o.pick(p,["url","scheme","tileSize"]))}load(u){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=wt(this._options,this.map._requestManager,null,null,(p,b)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new o.ErrorEvent(p)):b&&(o.extend(this,b),b.bounds&&(this.tileBounds=new Zt(b.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(b.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(p)})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,p){const b=o.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),b,this.tileSize);u.request=o.getImage(this.map._requestManager.transformRequest(S,o.ResourceType.Tile),(k,M,P,R)=>(delete u.request,u.aborted?(u.state="unloaded",p(null)):k?(u.state="errored",p(k)):M?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:P,expires:R}),u.setTexture(M,this.map.painter),u.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void p(null)):p(null)))}static loadTileData(u,p,b){u.setTexture(p,b)}static unloadTileData(u,p){u.texture&&p.saveTileTexture(u.texture)}abortTile(u,p){u.request&&(u.request.cancel(),delete u.request),p()}unloadTile(u,p){u.texture&&this.map.painter.saveTileTexture(u.texture),p()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function yn(y,u,p,b,S,k,M,P){const R=[y,p,S,u,b,k,1,1,1],$=[M,P,1],F=o.adjoint([],R),[H,ne,ae]=o.transformMat3($,$,o.transpose(F,F));return o.multiply$1(R,[H,0,0,0,ne,0,0,0,ae],R)}class In extends o.Evented{constructor(u,p,b,S){super(),this.id=u,this.dispatcher=b,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=p,this._dirty=!1}load(u,p){this._loaded=p||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(b,S)=>{if(this._imageRequest=null,this._loaded=!0,b)this.fire(new o.ErrorEvent(b));else if(S){const{HTMLImageElement:k}=o.window;this.image=S instanceof k?o.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,u&&(this.coordinates=u),this._finishLoading()}})}loaded(){return this._loaded}updateImage(u){return this.image&&u.url?(this._imageRequest&&u.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=u.url,this.load(u.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(u){this.coordinates=u,this._boundsArray=void 0;const p=u.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(b){let S=1/0,k=1/0,M=-1/0,P=-1/0;for(const H of b)S=Math.min(S,H.x),k=Math.min(k,H.y),M=Math.max(M,H.x),P=Math.max(P,H.y);const R=Math.max(M-S,P-k),$=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),F=Math.pow(2,$);return new o.CanonicalTileID($,Math.floor((S+M)/2*F),Math.floor((k+P)/2*F))}(p),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(u){for(const R in this.tiles){const $=this.tiles[R];$.state!=="loaded"&&($.state="loaded",$.texture=this.texture)}if(this._boundsArray)return;const p=o.tileTransform(this.tileID,this.map.transform.projection),[b,S,k,M]=this.coordinates.map(R=>{const $=p.projection.project(R[0],R[1]);return o.getTilePoint(p,$)._round()});this.perspectiveTransform=function(R,$,F,H,ne,ae,ue,le,de,Z){const oe=yn(0,0,R,0,0,$,R,$),ge=yn(F,H,ne,ae,ue,le,de,Z);return o.multiply$1(ge,o.adjoint(oe,oe),ge),[ge[6]/ge[8]*R/o.EXTENT,ge[7]/ge[8]*$/o.EXTENT]}(this.width,this.height,b.x,b.y,S.x,S.y,M.x,M.y,k.x,k.y);const P=this._boundsArray=new o.StructArrayLayout4i8;P.emplaceBack(b.x,b.y,0,0),P.emplaceBack(S.x,S.y,o.EXTENT,0),P.emplaceBack(M.x,M.y,0,o.EXTENT),P.emplaceBack(k.x,k.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=u.createVertexBuffer(P,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const u=this.map.painter.context,p=u.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(u,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(u)}loadTile(u,p){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={},p(null)):(u.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const _n={vector:Bt,raster:kt,"raster-dem":class extends kt{constructor(y,u,p,b){super(y,u,p,b),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(y,u){const p=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function b(S,k){S&&(y.state="errored",u(S)),k&&(y.dem=k,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",u(null))}y.request=o.getImage(this.map._requestManager.transformRequest(p,o.ResourceType.Tile),(function(S,k,M,P){if(delete y.request,y.aborted)y.state="unloaded",u(null);else if(S)y.state="errored",u(S);else if(k){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:M,expires:P});const R=o.window.ImageBitmap&&k instanceof o.window.ImageBitmap&&(mn==null&&(mn=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),mn),$=1-(k.width-o.prevPowerOfTwo(k.width))/2;$<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const F=R?k:o.exported.getImageData(k,$),H={uid:y.uid,coord:y.tileID,source:this.id,rawImageData:F,encoding:this.encoding,padding:$};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadDEMTile",H,b.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(y){const u=y.canonical,p=Math.pow(2,u.z),b=(u.x-1+p)%p,S=u.x===0?y.wrap-1:y.wrap,k=(u.x+1+p)%p,M=u.x+1===p?y.wrap+1:y.wrap,P={};return P[new o.OverscaledTileID(y.overscaledZ,S,u.z,b,u.y).key]={backfilled:!1},P[new o.OverscaledTileID(y.overscaledZ,M,u.z,k,u.y).key]={backfilled:!1},u.y>0&&(P[new o.OverscaledTileID(y.overscaledZ,S,u.z,b,u.y-1).key]={backfilled:!1},P[new o.OverscaledTileID(y.overscaledZ,y.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},P[new o.OverscaledTileID(y.overscaledZ,M,u.z,k,u.y-1).key]={backfilled:!1}),u.y+1<p&&(P[new o.OverscaledTileID(y.overscaledZ,S,u.z,b,u.y+1).key]={backfilled:!1},P[new o.OverscaledTileID(y.overscaledZ,y.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},P[new o.OverscaledTileID(y.overscaledZ,M,u.z,k,u.y+1).key]={backfilled:!1}),P}unloadTile(y){y.demTexture&&this.map.painter.saveTileTexture(y.demTexture),y.fbo&&(y.fbo.destroy(),delete y.fbo),y.dem&&delete y.dem,delete y.neighboringTiles,y.state="unloaded"}},geojson:class extends o.Evented{constructor(y,u,p,b){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(b),this._data=u.data,this._options=o.extend({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const S=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*S,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*S,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:o.EXTENT,radius:(u.clusterRadius!==void 0?u.clusterRadius:50)*S,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}getClusterExpansionZoom(y,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id},u),this}getClusterChildren(y,u){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id},u),this}getClusterLeaves(y,u,p,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:y,limit:u,offset:p},b),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const y=o.extend({},this.workerOptions),u=this._data;typeof u=="string"?(y.request=this.map._requestManager.transformRequest(o.exported.resolveURL(u),o.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,y,(p,b)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new o.ErrorEvent(p));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(S.resourceTiming=b.resourceTiming[this.id]),this.fire(new o.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(y,u){const p=y.actor?"reloadTile":"loadTile";y.actor=this.actor,y.request=this.actor.send(p,{type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(b,S)=>(delete y.request,y.unloadVectorData(),y.aborted?u(null):b?u(b):(y.loadVectorData(S,this.map.painter,p==="reloadTile"),u(null))),void 0,p==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y){y.unloadVectorData(),this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends In{constructor(y,u,p,b){super(y,u,p,b),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const u of y.urls)this.urls.push(this.map._requestManager.transformRequest(u,o.ResourceType.Source).url);o.getVideo(this.urls,(u,p)=>{this._loaded=!0,u?this.fire(new o.ErrorEvent(u)):p&&(this.video=p,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const u=this.video.seekable;y<u.start(0)||y>u.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,u=y.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(y,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:In,canvas:class extends In{constructor(y,u,p,b){super(y,u,p,b),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(k=>typeof k!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${y}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${y}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context;this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(u,this.canvas,u.gl.RGBA,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends o.Evented{constructor(y,u,p,b){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=p,this._implementation=u,this.setEventedParent(b),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Zt(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this._map=y,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:u,y:p,z:b}=y.canonical;return this._implementation.hasTile({x:u,y:p,z:b})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,u){const{x:p,y:b,z:S}=y.tileID.canonical,k=new o.window.AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:p,y:b,z:S},{signal:k.signal})).then((function(M){return delete y.request,y.aborted?(y.state="unloaded",u(null)):M===void 0?(y.state="errored",u(null)):M===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",u(null)):function(P){return P instanceof o.window.ImageData||P instanceof o.window.HTMLCanvasElement||P instanceof o.window.ImageBitmap||P instanceof o.window.HTMLImageElement}(M)?(this.loadTileData(y,M),y.state="loaded",void u(null)):(y.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(M=>{M.code!==20&&(y.state="errored",u(M))}),y.request.cancel=()=>k.abort()}loadTileData(y,u){kt.loadTileData(y,u,this._map.painter)}unloadTileData(y){kt.unloadTileData(y,this._map.painter)}unloadTile(y,u){if(this.unloadTileData(y),this._implementation.unloadTile){const{x:p,y:b,z:S}=y.tileID.canonical;this._implementation.unloadTile({x:p,y:b,z:S})}u()}abortTile(y,u){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),u()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},pn=function(y,u,p,b){const S=new _n[u.type](y,u,p,b);if(S.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${S.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],S),S};function Ln(y,u){const p=o.identity([]);return o.scale(p,p,[.5*y.width,.5*-y.height,1]),o.translate(p,p,[1,-1,0]),o.multiply(p,p,y.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(p)}function wi(y,u,p,b,S,k,M,P=!1){const R=y.tilesIn(b,M,P);R.sort(Ar);const $=[];for(const H of R)$.push({wrappedTileID:H.tile.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(u,p,y._state,H,S,k,Ln(y.transform,H.tile.tileID),P)});const F=function(H){const ne={},ae={};for(const ue of H){const le=ue.queryResults,de=ue.wrappedTileID,Z=ae[de]=ae[de]||{};for(const oe in le){const ge=le[oe],ye=Z[oe]=Z[oe]||{},Te=ne[oe]=ne[oe]||[];for(const Ie of ge)ye[Ie.featureIndex]||(ye[Ie.featureIndex]=!0,Te.push(Ie))}}return ne}($);for(const H in F)F[H].forEach(ne=>{const ae=ne.feature,ue=ae.layer;ue&&ue.type!=="background"&&ue.type!=="sky"&&(ae.source=ue.source,ue["source-layer"]&&(ae.sourceLayer=ue["source-layer"]),ae.state=ae.id!==void 0?y.getFeatureState(ue["source-layer"],ae.id):{})});return F}function Ui(y,u){const p=y.getRenderableIds().map(k=>y.getTileByID(k)),b=[],S={};for(let k=0;k<p.length;k++){const M=p[k],P=M.tileID.canonical.key;S[P]||(S[P]=!0,M.querySourceFeatures(b,u))}return b}function Ar(y,u){const p=y.tileID,b=u.tileID;return p.overscaledZ-b.overscaledZ||p.canonical.y-b.canonical.y||p.wrap-b.wrap||p.canonical.x-b.canonical.x}function Ki(){return $c.workerClass!=null?new $c.workerClass:new o.window.Worker($c.workerUrl)}const ns="mapboxgl_preloaded_worker_pool";class Yi{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<Yi.workerCount;)this.workers.push(new Ki);return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ns]}numActive(){return Object.keys(this.active).length}}let qr;function il(){return qr||(qr=new Yi),qr}function Cm(y,u){const p={};for(const b in y)b!=="ref"&&(p[b]=y[b]);return o.refProperties.forEach(b=>{b in u&&(p[b]=u[b])}),p}function qh(y){y=y.slice();const u=Object.create(null);for(let p=0;p<y.length;p++)u[y[p].id]=y[p];for(let p=0;p<y.length;p++)"ref"in y[p]&&(y[p]=Cm(y[p],u[y[p].ref]));return y}Yi.workerCount=2;const jn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function nd(y,u,p){p.push({command:jn.addSource,args:[y,u[y]]})}function rl(y,u,p){u.push({command:jn.removeSource,args:[y]}),p[y]=!0}function Wh(y,u,p,b){rl(y,p,b),nd(y,u,p)}function id(y,u,p){let b;for(b in y[p])if(y[p].hasOwnProperty(b)&&b!=="data"&&!f(y[p][b],u[p][b]))return!1;for(b in u[p])if(u[p].hasOwnProperty(b)&&b!=="data"&&!f(y[p][b],u[p][b]))return!1;return!0}function nt(y,u,p,b,S,k){let M;for(M in u=u||{},y=y||{})y.hasOwnProperty(M)&&(f(y[M],u[M])||p.push({command:k,args:[b,M,u[M],S]}));for(M in u)u.hasOwnProperty(M)&&!y.hasOwnProperty(M)&&(f(y[M],u[M])||p.push({command:k,args:[b,M,u[M],S]}))}function $t(y){return y.id}function an(y,u){return y[u.id]=u,y}class qi{constructor(u,p){this.reset(u,p)}reset(u,p){this.points=u||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=o.clamp(u,0,1);let p=1,b=this._distances[p];const S=u*this.paddedLength+this.padding;for(;b<S&&p<this._distances.length;)b=this._distances[++p];const k=p-1,M=this._distances[k],P=b-M,R=P>0?(S-M)/P:0;return this.points[k].mult(1-R).add(this.points[p].mult(R))}}class Li{constructor(u,p,b){const S=this.boxCells=[],k=this.circleCells=[];this.xCellCount=Math.ceil(u/b),this.yCellCount=Math.ceil(p/b);for(let M=0;M<this.xCellCount*this.yCellCount;M++)S.push([]),k.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=p,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,p,b,S,k){this._forEachCell(p,b,S,k,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(S),this.bboxes.push(k)}insertCircle(u,p,b,S){this._forEachCell(p-S,b-S,p+S,b+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(p),this.circles.push(b),this.circles.push(S)}_insertBoxCell(u,p,b,S,k,M){this.boxCells[k].push(M)}_insertCircleCell(u,p,b,S,k,M){this.circleCells[k].push(M)}_query(u,p,b,S,k,M){if(b<0||u>this.width||S<0||p>this.height)return!k&&[];const P=[];if(u<=0&&p<=0&&this.width<=b&&this.height<=S){if(k)return!0;for(let R=0;R<this.boxKeys.length;R++)P.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const $=this.circles[3*R],F=this.circles[3*R+1],H=this.circles[3*R+2];P.push({key:this.circleKeys[R],x1:$-H,y1:F-H,x2:$+H,y2:F+H})}return M?P.filter(M):P}return this._forEachCell(u,p,b,S,this._queryCell,P,{hitTest:k,seenUids:{box:{},circle:{}}},M),k?P.length>0:P}_queryCircle(u,p,b,S,k){const M=u-b,P=u+b,R=p-b,$=p+b;if(P<0||M>this.width||$<0||R>this.height)return!S&&[];const F=[];return this._forEachCell(M,R,P,$,this._queryCellCircle,F,{hitTest:S,circle:{x:u,y:p,radius:b},seenUids:{box:{},circle:{}}},k),S?F.length>0:F}query(u,p,b,S,k){return this._query(u,p,b,S,!1,k)}hitTest(u,p,b,S,k){return this._query(u,p,b,S,!0,k)}hitTestCircle(u,p,b,S){return this._queryCircle(u,p,b,!0,S)}_queryCell(u,p,b,S,k,M,P,R){const $=P.seenUids,F=this.boxCells[k];if(F!==null){const ne=this.bboxes;for(const ae of F)if(!$.box[ae]){$.box[ae]=!0;const ue=4*ae;if(u<=ne[ue+2]&&p<=ne[ue+3]&&b>=ne[ue+0]&&S>=ne[ue+1]&&(!R||R(this.boxKeys[ae]))){if(P.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[ae],x1:ne[ue],y1:ne[ue+1],x2:ne[ue+2],y2:ne[ue+3]})}}}const H=this.circleCells[k];if(H!==null){const ne=this.circles;for(const ae of H)if(!$.circle[ae]){$.circle[ae]=!0;const ue=3*ae;if(this._circleAndRectCollide(ne[ue],ne[ue+1],ne[ue+2],u,p,b,S)&&(!R||R(this.circleKeys[ae]))){if(P.hitTest)return M.push(!0),!0;{const le=ne[ue],de=ne[ue+1],Z=ne[ue+2];M.push({key:this.circleKeys[ae],x1:le-Z,y1:de-Z,x2:le+Z,y2:de+Z})}}}}}_queryCellCircle(u,p,b,S,k,M,P,R){const $=P.circle,F=P.seenUids,H=this.boxCells[k];if(H!==null){const ae=this.bboxes;for(const ue of H)if(!F.box[ue]){F.box[ue]=!0;const le=4*ue;if(this._circleAndRectCollide($.x,$.y,$.radius,ae[le+0],ae[le+1],ae[le+2],ae[le+3])&&(!R||R(this.boxKeys[ue])))return M.push(!0),!0}}const ne=this.circleCells[k];if(ne!==null){const ae=this.circles;for(const ue of ne)if(!F.circle[ue]){F.circle[ue]=!0;const le=3*ue;if(this._circlesCollide(ae[le],ae[le+1],ae[le+2],$.x,$.y,$.radius)&&(!R||R(this.circleKeys[ue])))return M.push(!0),!0}}}_forEachCell(u,p,b,S,k,M,P,R){const $=this._convertToXCellCoord(u),F=this._convertToYCellCoord(p),H=this._convertToXCellCoord(b),ne=this._convertToYCellCoord(S);for(let ae=$;ae<=H;ae++)for(let ue=F;ue<=ne;ue++)if(k.call(this,u,p,b,S,this.xCellCount*ue+ae,M,P,R))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,p,b,S,k,M){const P=S-u,R=k-p,$=b+M;return $*$>P*P+R*R}_circleAndRectCollide(u,p,b,S,k,M,P){const R=(M-S)/2,$=Math.abs(u-(S+R));if($>R+b)return!1;const F=(P-k)/2,H=Math.abs(p-(k+F));if(H>F+b)return!1;if($<=R||H<=F)return!0;const ne=$-R,ae=H-F;return ne*ne+ae*ae<=b*b}}const Ji={unknown:0,flipRequired:1,flipNotRequired:2},Vo=Math.tan(85*Math.PI/180);function st(y,u,p,b,S,k,M){const P=o.create();if(p)if(k.name==="globe"){const R=o.calculateGlobeLabelMatrix(S,u);o.multiply(P,P,R)}else{const R=te([],M);P[0]=R[0],P[1]=R[1],P[4]=R[2],P[5]=R[3],b||o.rotateZ(P,P,S.angle)}else o.multiply(P,S.labelPlaneMatrix,y);return P}function va(y,u,p,b,S,k,M){const P=st(y,u,p,b,S,k,M);return k.name==="globe"&&p||(P[2]=P[6]=P[10]=P[14]=0),P}function ar(y,u,p,b,S,k,M){if(p){if(k.name==="globe"){const P=st(y,u,p,b,S,k,M);return o.invert(P,P),o.multiply(P,y,P),P}{const P=o.clone(y),R=o.identity([]);return R[0]=M[0],R[1]=M[1],R[4]=M[2],R[5]=M[3],o.multiply(P,P,R),b||o.rotateZ(P,P,-S.angle),P}}return S.glCoordMatrix}function Dr(y,u,p,b){const S=[y,u,p,1];p?o.transformMat4$1(S,S,b):On(S,S,b);const k=S[3];return S[0]/=k,S[1]/=k,S[2]/=k,S}function Kv(y,u){return Math.min(.5+y/u*.5,1.5)}function Zs(y,u){const p=y[0]/y[3],b=y[1]/y[3];return p>=-u[0]&&p<=u[0]&&b>=-u[1]&&b<=u[1]}function Im(y,u,p,b,S,k,M,P,R,$){const F=p.transform,H=b?y.textSizeData:y.iconSizeData,ne=o.evaluateSizeForZoom(H,p.transform.zoom),ae=F.projection.name==="globe",ue=[256/p.width*2+1,256/p.height*2+1],le=b?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;le.clear();let de=null;ae&&(de=b?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const Z=y.lineVertexArray,oe=b?y.text.placedSymbolArray:y.icon.placedSymbolArray,ge=p.transform.width/p.transform.height;let ye,Te=!1;for(let Ie=0;Ie<oe.length;Ie++){const Ce=oe.get(Ie),{numGlyphs:Le,writingMode:Re}=Ce;if(Re!==o.WritingMode.vertical||Te||ye===o.WritingMode.horizontal||(Te=!0),ye=Re,(Ce.hidden||Re===o.WritingMode.vertical)&&!Te){ks(Le,le);continue}Te=!1;const Ge=new o.Point(Ce.tileAnchorX,Ce.tileAnchorY);let{x:St,y:Ve,z:ut}=F.projection.projectTilePoint(Ge.x,Ge.y,$.canonical);if(R){const[vn,Yt,un]=R(Ge);St+=vn,Ve+=Yt,ut+=un}const Ye=[St,Ve,ut,1];if(o.transformMat4$1(Ye,Ye,u),!Zs(Ye,ue)){ks(Le,le);continue}const bt=Kv(p.transform.cameraToCenterDistance,Ye[3]),qe=o.evaluateSizeForFeature(H,ne,Ce),ct=M?qe/bt:qe*bt,Tt=Dr(St,Ve,ut,S);if(Tt[3]<=0){ks(Le,le);continue}let pt={};const It=M?null:R,rn=Gt(Ce,ct,!1,P,u,S,k,y.glyphOffsetArray,Z,le,de,Tt,Ge,pt,ge,It,F.projection,$,M);Te=rn.useVertical,It&&rn.needsFlipping&&(pt={}),(rn.notEnoughRoom||Te||rn.needsFlipping&&Gt(Ce,ct,!0,P,u,S,k,y.glyphOffsetArray,Z,le,de,Tt,Ge,pt,ge,It,F.projection,$,M).notEnoughRoom)&&ks(Le,le)}b?(y.text.dynamicLayoutVertexBuffer.updateData(le),de&&y.text.globeExtVertexBuffer.updateData(de)):(y.icon.dynamicLayoutVertexBuffer.updateData(le),de&&y.icon.globeExtVertexBuffer.updateData(de))}function Yv(y,u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le){const{lineStartIndex:de,glyphStartIndex:Z,segment:oe}=P,ge=Z+P.numGlyphs,ye=de+P.lineLength,Te=u.getoffsetX(Z),Ie=u.getoffsetX(ge-1),Ce=Uo(y*Te,p,b,S,k,M,oe,de,ye,R,$,F,H,ne,!0,ae,ue,le);if(!Ce)return null;const Le=Uo(y*Ie,p,b,S,k,M,oe,de,ye,R,$,F,H,ne,!0,ae,ue,le);return Le?{first:Ce,last:Le}:null}function Sc(y,u,p,b){return y===o.WritingMode.horizontal&&Math.abs(b)>Math.abs(p)?{useVertical:!0}:y===o.WritingMode.vertical?b>0?{needsFlipping:!0}:null:u!==Ji.unknown&&function(S,k){return S===0||Math.abs(k/S)>Vo}(p,b)?u===Ji.flipRequired?{needsFlipping:!0}:null:p<0?{needsFlipping:!0}:null}function Gt(y,u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le,de,Z,oe){const ge=u/24,ye=y.lineOffsetX*ge,Te=y.lineOffsetY*ge,{lineStartIndex:Ie,glyphStartIndex:Ce,numGlyphs:Le,segment:Re,writingMode:Ge,flipState:St}=y,Ve=Ie+y.lineLength,ut=Ye=>{if(F){const[Tt,pt,It]=Ye.up,rn=$.length;o.updateGlobeVertexNormal(F,rn+0,Tt,pt,It),o.updateGlobeVertexNormal(F,rn+1,Tt,pt,It),o.updateGlobeVertexNormal(F,rn+2,Tt,pt,It),o.updateGlobeVertexNormal(F,rn+3,Tt,pt,It)}const[bt,qe,ct]=Ye.point;o.addDynamicAttributes($,bt,qe,ct,Ye.angle)};if(Le>1){const Ye=Yv(ge,P,ye,Te,p,H,ne,y,R,k,ae,le,!1,de,Z,oe);if(!Ye)return{notEnoughRoom:!0};if(b&&!p){let[bt,qe,ct]=Ye.first.point,[Tt,pt,It]=Ye.last.point;[bt,qe]=Dr(bt,qe,ct,M),[Tt,pt]=Dr(Tt,pt,It,M);const rn=Sc(Ge,St,(Tt-bt)*ue,pt-qe);if(y.flipState=rn&&rn.needsFlipping?Ji.flipRequired:Ji.flipNotRequired,rn)return rn}ut(Ye.first);for(let bt=Ce+1;bt<Ce+Le-1;bt++){const qe=Uo(ge*P.getoffsetX(bt),ye,Te,p,H,ne,Re,Ie,Ve,R,k,ae,le,!1,!1,de,Z,oe);if(!qe)return $.length-=4*(bt-Ce),{notEnoughRoom:!0};ut(qe)}ut(Ye.last)}else{if(b&&!p){const bt=Dr(ne.x,ne.y,0,S),qe=Ie+Re+1,ct=new o.Point(R.getx(qe),R.gety(qe)),Tt=Dr(ct.x,ct.y,0,S),pt=Tt[3]>0?Tt:Pn(ne,ct,bt,1,S,void 0,de,Z.canonical),It=Sc(Ge,St,(pt[0]-bt[0])*ue,pt[1]-bt[1]);if(y.flipState=It&&It.needsFlipping?Ji.flipRequired:Ji.flipNotRequired,It)return It}const Ye=Uo(ge*P.getoffsetX(Ce),ye,Te,p,H,ne,Re,Ie,Ve,R,k,ae,le,!1,!1,de,Z,oe);if(!Ye)return{notEnoughRoom:!0};ut(Ye)}return{}}function zn(y,u,p,b,S){const{x:k,y:M,z:P}=b.projectTilePoint(y.x,y.y,u);if(!S)return Dr(k,M,P,p);const[R,$,F]=S(y);return Dr(k+R,M+$,P+F,p)}function Pn(y,u,p,b,S,k,M,P){const R=zn(y.sub(u)._unit()._add(y),P,S,M,k);return o.sub(R,p,R),o.normalize(R,R),o.scaleAndAdd(R,p,R,b)}function Uo(y,u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le,de,Z){const oe=b?y-u:y+u;let ge=oe>0?1:-1,ye=0;b&&(ge*=-1,ye=Math.PI),ge<0&&(ye+=Math.PI);let Te=P+M+(ge>0?0:1)|0,Ie=S,Ce=S,Le=0,Re=0;const Ge=Math.abs(oe),St=[],Ve=[];let ut=k,Ye=ut;const bt=()=>Pn(Ye,ut,Ce,Ge-Le+1,F,ne,le,de.canonical);for(;Le+Re<=Ge;){if(Te+=ge,Te<P||Te>=R)return null;if(Ce=Ie,Ye=ut,St.push(Ce),ae&&Ve.push(Ye),ut=new o.Point($.getx(Te),$.gety(Te)),Ie=H[Te],!Ie){const un=zn(ut,de.canonical,F,le,ne);Ie=un[3]>0?H[Te]=un:bt()}Le+=Re,Re=o.distance(Ce,Ie)}ue&&ne&&(H[Te]&&(Ie=bt(),Re=o.distance(Ce,Ie)),H[Te]=Ie);const qe=(Ge-Le)/Re,ct=ut.sub(Ye)._mult(qe)._add(Ye),Tt=o.sub([],Ie,Ce),pt=o.scaleAndAdd([],Ce,Tt,qe);let It=[0,0,1],rn=Tt[0],vn=Tt[1];if(Z&&(It=le.upVector(de.canonical,ct.x,ct.y),It[0]!==0||It[1]!==0||It[2]!==1)){const un=[It[2],0,-It[0]],Dn=o.cross([],It,un);o.normalize(un,un),o.normalize(Dn,Dn),rn=o.dot(Tt,un),vn=o.dot(Tt,Dn)}if(p){const un=o.cross([],It,Tt);o.normalize(un,un),o.scaleAndAdd(pt,pt,un,p*ge)}const Yt=ye+Math.atan2(vn,rn);return St.push(pt),ae&&Ve.push(ct),{point:pt,angle:Yt,path:St,tilePath:Ve,up:It}}function ks(y,u){const p=u.length,b=p+4*y;u.resize(b),u.float32.fill(-1/0,4*p,4*b)}function On(y,u,p){const b=u[0],S=u[1];return y[0]=p[0]*b+p[4]*S+p[12],y[1]=p[1]*b+p[5]*S+p[13],y[3]=p[3]*b+p[7]*S+p[15],y}const qo=100;class rd{constructor(u,p,b=new Li(u.width+200,u.height+200,25),S=new Li(u.width+200,u.height+200,25)){this.transform=u,this.grid=b,this.ignoredGrid=S,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+qo,this.screenBottomBoundary=u.height+qo,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=p}placeCollisionBox(u,p,b,S,k,M,P,R){let $=b.projectedAnchorX,F=b.projectedAnchorY,H=b.projectedAnchorZ;const ne=b.elevation,ae=b.tileID,ue=u.getProjection();if(ne&&ae){const[Ie,Ce,Le]=ue.upVector(ae.canonical,b.tileAnchorX,b.tileAnchorY),Re=ue.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;$+=Ie*ne*Re,F+=Ce*ne*Re,H+=Le*ne*Re}const le=this.projectAndGetPerspectiveRatio(P,$,F,H,b.tileID,ue.name==="globe"||!!ne||this.transform.pitch>0,ue),de=M*le.perspectiveRatio,Z=(b.x1*p+S.x-b.padding)*de+le.point.x,oe=(b.y1*p+S.y-b.padding)*de+le.point.y,ge=(b.x2*p+S.x+b.padding)*de+le.point.x,ye=(b.y2*p+S.y+b.padding)*de+le.point.y,Te=le.perspectiveRatio<=.55||le.occluded;return!this.isInsideGrid(Z,oe,ge,ye)||!k&&this.grid.hitTest(Z,oe,ge,ye,R)||Te?{box:[],offscreen:!1,occluded:le.occluded}:{box:[Z,oe,ge,ye],offscreen:this.isOffscreen(Z,oe,ge,ye),occluded:!1}}placeCollisionCircles(u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le){const de=[],Z=this.transform.elevation,oe=u.getProjection(),ge=Z?Z.getAtTileOffsetFunc(le,this.transform.center.lat,this.transform.worldSize,oe):null,ye=new o.Point(b.tileAnchorX,b.tileAnchorY);let{x:Te,y:Ie,z:Ce}=oe.projectTilePoint(ye.x,ye.y,le.canonical);if(ge){const[ct,Tt,pt]=ge(ye);Te+=ct,Ie+=Tt,Ce+=pt}const Le=oe.name==="globe",Re=this.projectAndGetPerspectiveRatio(P,Te,Ie,Ce,le,Le||!!Z||this.transform.pitch>0,oe),{perspectiveRatio:Ge}=Re,St=(H?M/Ge:M*Ge)/o.ONE_EM,Ve=Dr(Te,Ie,Ce,R),ut=Re.signedDistanceFromCamera>0?Yv(St,k,b.lineOffsetX*St,b.lineOffsetY*St,!1,Ve,ye,b,S,R,{},Z&&!H?ge:null,H&&!!Z,oe,le,H):null;let Ye=!1,bt=!1,qe=!0;if(ut&&!Re.occluded){const ct=.5*ae*Ge+ue,Tt=new o.Point(-100,-100),pt=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),It=new qi,{first:rn,last:vn}=ut,Yt=rn.path.length;let un=[];for(let tn=Yt-1;tn>=1;tn--)un.push(rn.path[tn]);for(let tn=1;tn<vn.path.length;tn++)un.push(vn.path[tn]);const Dn=2.5*ct;$&&(un=un.map(([tn,Qn,oi],si)=>(ge&&!Le&&(oi=ge(si<Yt-1?rn.tilePath[Yt-1-si]:vn.tilePath[si-Yt+2])[2]),Dr(tn,Qn,oi,$))),un.some(tn=>tn[3]<=0)&&(un=[]));let Mn=[];if(un.length>0){let tn=1/0,Qn=-1/0,oi=1/0,si=-1/0;for(const ai of un)tn=Math.min(tn,ai[0]),oi=Math.min(oi,ai[1]),Qn=Math.max(Qn,ai[0]),si=Math.max(si,ai[1]);Qn>=Tt.x&&tn<=pt.x&&si>=Tt.y&&oi<=pt.y&&(Mn=[un.map(ai=>new o.Point(ai[0],ai[1]))],(tn<Tt.x||Qn>pt.x||oi<Tt.y||si>pt.y)&&(Mn=o.clipLine(Mn,Tt.x,Tt.y,pt.x,pt.y)))}for(const tn of Mn){It.reset(tn,.25*ct);let Qn=0;Qn=It.length<=.5*ct?1:Math.ceil(It.paddedLength/Dn)+1;for(let oi=0;oi<Qn;oi++){const si=oi/Math.max(Qn-1,1),ai=It.lerp(si),Qr=ai.x+qo,Lr=ai.y+qo;de.push(Qr,Lr,ct,0);const ls=Qr-ct,Js=Lr-ct,Ai=Qr+ct,li=Lr+ct;if(qe=qe&&this.isOffscreen(ls,Js,Ai,li),bt=bt||this.isInsideGrid(ls,Js,Ai,li),!p&&this.grid.hitTestCircle(Qr,Lr,ct,ne)&&(Ye=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Ye,occluded:!1}}}}return{circles:!F&&Ye||!bt?[]:de,offscreen:qe,collisionDetected:Ye,occluded:Re.occluded}}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[];let b=1/0,S=1/0,k=-1/0,M=-1/0;for(const F of u){const H=new o.Point(F.x+qo,F.y+qo);b=Math.min(b,H.x),S=Math.min(S,H.y),k=Math.max(k,H.x),M=Math.max(M,H.y),p.push(H)}const P=this.grid.query(b,S,k,M).concat(this.ignoredGrid.query(b,S,k,M)),R={},$={};for(const F of P){const H=F.key;if(R[H.bucketInstanceId]===void 0&&(R[H.bucketInstanceId]={}),R[H.bucketInstanceId][H.featureIndex])continue;const ne=[new o.Point(F.x1,F.y1),new o.Point(F.x2,F.y1),new o.Point(F.x2,F.y2),new o.Point(F.x1,F.y2)];o.polygonIntersectsPolygon(p,ne)&&(R[H.bucketInstanceId][H.featureIndex]=!0,$[H.bucketInstanceId]===void 0&&($[H.bucketInstanceId]=[]),$[H.bucketInstanceId].push(H.featureIndex))}return $}insertCollisionBox(u,p,b,S,k){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:S,collisionGroupID:k},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,p,b,S,k){const M=p?this.ignoredGrid:this.grid,P={bucketInstanceId:b,featureIndex:S,collisionGroupID:k};for(let R=0;R<u.length;R+=4)M.insertCircle(P,u[R],u[R+1],u[R+2])}projectAndGetPerspectiveRatio(u,p,b,S,k,M,P){const R=[p,b,S,1];let $=!1;S||this.transform.pitch>0?(o.transformMat4$1(R,R,u),this.fogState&&k&&P.name!=="globe"&&($=function(ne,ae,ue,le,de,Z){const oe=Z.calculateFogTileMatrix(de),ge=[ae,ue,le];return o.transformMat4(ge,ge,oe),lt(ne,ge,Z.pitch,Z._fov)}(this.fogState,p,b,S,k.toUnwrapped(),this.transform)>.9)):On(R,R,u);const F=R[3];return{point:new o.Point((R[0]/F+1)/2*this.transform.width+qo,(-R[1]/F+1)/2*this.transform.height+qo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/F*.5,1.5),signedDistanceFromCamera:F,occluded:M&&R[2]>F||$}}isOffscreen(u,p,b,S){return b<qo||u>=this.screenRightBoundary||S<qo||p>this.screenBottomBoundary}isInsideGrid(u,p,b,S){return b>=0&&u<this.gridRightBoundary&&S>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const u=o.identity([]);return o.translate(u,u,[-100,-100,0]),u}}function Bl(y,u,p){const b=u.createTileMatrix(y,y.worldSize,p.toUnwrapped());return o.multiply(new Float32Array(16),y.projMatrix,b)}function is(y,u,p){if(u.projection.name===p.projection.name)return y.projMatrix;const b=p.clone();return b.setProjection(u.projection),Bl(b,u.getProjection(),y)}function Ii(y,u,p){return u.name===p.projection.name?y.projMatrix:Bl(p,u,y)}class Jv{constructor(u,p,b,S){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?p:-p))):S&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class ba{constructor(u,p,b,S,k,M=!1){this.text=new Jv(u?u.text:null,p,b,k),this.icon=new Jv(u?u.icon:null,p,S,k),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class od{constructor(u,p,b,S=!1){this.text=u,this.icon=p,this.skipFade=b,this.clipped=S}}class sd{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Am{constructor(u,p,b,S,k){this.bucketInstanceId=u,this.featureIndex=p,this.sourceLayerIndex=b,this.bucketIndex=S,this.tileID=k}}class Qv{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const p=++this.maxGroupID;this.collisionGroups[u]={ID:p,predicate:b=>b.collisionGroupID===p}}return this.collisionGroups[u]}}function ad(y,u,p,b,S){const{horizontalAlign:k,verticalAlign:M}=o.getAnchorAlignment(y),P=-(k-.5)*u,R=-(M-.5)*p,$=o.evaluateVariableOffset(y,b);return new o.Point(P+$[0]*S,R+$[1]*S)}function ld(y,u,p,b,S){const k=new o.Point(y,u);return p&&k._rotate(b?S:-S),k}class Gh{constructor(u,p,b,S,k){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new rd(this.transform,k),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Qv(b),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,p,b,S){const k=b.getBucket(p),M=b.latestFeatureIndex;if(!k||!M||p.id!==k.layerIds[0])return;const P=k.layers[0].layout,R=b.collisionBoxArray,$=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),F=b.tileSize/o.EXTENT,H=b.tileID.toUnwrapped();this.transform.setProjection(k.projection);const ne=(ae=b.tileID,ue=k.getProjection(),le=this.transform,ue.name===this.projection?le.calculateProjMatrix(ae.toUnwrapped()):Bl(le,ue,ae));var ae,ue,le;const de=P.get("text-pitch-alignment")==="map",Z=P.get("text-rotation-alignment")==="map";p.compileFilter();const oe=p.dynamicFilter(),ge=p.dynamicFilterNeedsFeature(),ye=this.transform.calculatePixelsToTileUnitsMatrix(b),Te=va(ne,b.tileID.canonical,de,Z,this.transform,k.getProjection(),ye);let Ie=null;if(de){const Re=ar(ne,b.tileID.canonical,de,Z,this.transform,k.getProjection(),ye);Ie=o.multiply([],this.transform.labelPlaneMatrix,Re)}let Ce=null;oe&&b.latestFeatureIndex&&(Ce={unwrappedTileID:H,dynamicFilter:oe,dynamicFilterNeedsFeature:ge,featureIndex:b.latestFeatureIndex}),this.retainedQueryData[k.bucketInstanceId]=new Am(k.bucketInstanceId,M,k.sourceLayerIndex,k.index,b.tileID);const Le={bucket:k,layout:P,posMatrix:ne,textLabelPlaneMatrix:Te,labelToScreenMatrix:Ie,clippingData:Ce,scale:$,textPixelRatio:F,holdingForFade:b.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(k.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(k.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(k.sourceID)};if(S)for(const Re of k.sortKeyRanges){const{sortKey:Ge,symbolInstanceStart:St,symbolInstanceEnd:Ve}=Re;u.push({sortKey:Ge,symbolInstanceStart:St,symbolInstanceEnd:Ve,parameters:Le})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:Le})}attemptAnchorPlacement(u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le,de,Z,oe){const{textOffset0:ge,textOffset1:ye,crossTileID:Te}=ne,Ie=[ge,ye],Ce=ad(u,b,S,Ie,k),Le=this.collisionIndex.placeCollisionBox(ue,k,p,ld(Ce.x,Ce.y,M,P,this.transform.angle),H,R,$,F.predicate);if(de){const Re=ue.getSymbolInstanceIconSize(oe,this.transform.zoom,ne.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ue,Re,de,ld(Ce.x,Ce.y,M,P,this.transform.angle),H,R,$,F.predicate).box.length===0)return}if(Le.box.length>0){let Re;return this.prevPlacement&&this.prevPlacement.variableOffsets[Te]&&this.prevPlacement.placements[Te]&&this.prevPlacement.placements[Te].text&&(Re=this.prevPlacement.variableOffsets[Te].anchor),this.variableOffsets[Te]={textOffset:Ie,width:b,height:S,anchor:u,textScale:k,prevAnchor:Re},this.markUsedJustification(ue,u,ne,le),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,le,ne),this.placedOrientations[Te]=le),{shift:Ce,placedGlyphBoxes:Le}}}placeLayerBucketPart(u,p,b,S){const{bucket:k,layout:M,posMatrix:P,textLabelPlaneMatrix:R,labelToScreenMatrix:$,clippingData:F,textPixelRatio:H,holdingForFade:ne,collisionBoxArray:ae,partiallyEvaluatedTextSize:ue,partiallyEvaluatedIconSize:le,collisionGroup:de}=u.parameters,Z=M.get("text-optional"),oe=M.get("icon-optional"),ge=M.get("text-allow-overlap"),ye=M.get("icon-allow-overlap"),Te=M.get("text-rotation-alignment")==="map",Ie=M.get("text-pitch-alignment")==="map",Ce=M.get("icon-text-fit")!=="none",Le=M.get("symbol-z-order")==="viewport-y";this.transform.setProjection(k.projection);let Re=ge&&(ye||!k.hasIconData()||oe),Ge=ye&&(ge||!k.hasTextData()||Z);!k.collisionArrays&&ae&&k.deserializeCollisionBoxes(ae),b&&S&&k.updateCollisionDebugBuffers(this.transform.zoom,ae);const St=(Ve,ut,Ye)=>{const{crossTileID:bt,numVerticalGlyphVertices:qe}=Ve;if(F){const Ai={zoom:this.transform.zoom,pitch:this.transform.pitch};let li=null;if(F.dynamicFilterNeedsFeature){const Gn=this.retainedQueryData[k.bucketInstanceId];li=F.featureIndex.loadFeature({featureIndex:Ve.featureIndex,bucketIndex:Gn.bucketIndex,sourceLayerIndex:Gn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,F.dynamicFilter)(Ai,li,this.retainedQueryData[k.bucketInstanceId].tileID.canonical,new o.Point(Ve.tileAnchorX,Ve.tileAnchorY),this.transform.calculateDistanceTileData(F.unwrappedTileID)))return this.placements[bt]=new od(!1,!1,!1,!0),void p.add(bt)}if(p.has(bt))return;if(ne)return void(this.placements[bt]=new od(!1,!1,!1));let ct=!1,Tt=!1,pt=!0,It=!1,rn=!1,vn=null,Yt={box:null,offscreen:null,occluded:null},un={box:null,offscreen:null,occluded:null},Dn=null,Mn=null,tn=null,Qn=0,oi=0,si=0;Ye.textFeatureIndex?Qn=Ye.textFeatureIndex:Ve.useRuntimeCollisionCircles&&(Qn=Ve.featureIndex),Ye.verticalTextFeatureIndex&&(oi=Ye.verticalTextFeatureIndex);const ai=Ai=>{Ai.tileID=this.retainedQueryData[k.bucketInstanceId].tileID;const li=this.transform.elevation;(li||Ai.elevation)&&(Ai.elevation=li?li.getAtTileOffset(Ai.tileID,Ai.tileAnchorX,Ai.tileAnchorY):0)},Qr=Ye.textBox;if(Qr){ai(Qr);const Ai=Gn=>{let lr=o.WritingMode.horizontal;if(k.allowVerticalPlacement&&!Gn&&this.prevPlacement){const po=this.prevPlacement.placedOrientations[bt];po&&(this.placedOrientations[bt]=po,lr=po,this.markUsedOrientation(k,lr,Ve))}return lr},li=(Gn,lr)=>{if(k.allowVerticalPlacement&&qe>0&&Ye.verticalTextBox){for(const po of k.writingModes)if(po===o.WritingMode.vertical?(Yt=lr(),un=Yt):Yt=Gn(),Yt&&Yt.box&&Yt.box.length)break}else Yt=Gn()};if(M.get("text-variable-anchor")){let Gn=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[bt]){const Si=this.prevPlacement.variableOffsets[bt];Gn.indexOf(Si.anchor)>0&&(Gn=Gn.filter(ko=>ko!==Si.anchor),Gn.unshift(Si.anchor))}const lr=(Si,ko,_f)=>{const Wl=k.getSymbolInstanceTextSize(ue,Ve,this.transform.zoom,ut),Id=(Si.x2-Si.x1)*Wl+2*Si.padding,Ta=(Si.y2-Si.y1)*Wl+2*Si.padding,al=Ce&&!ye?ko:null;al&&ai(al);let Gl={box:[],offscreen:!1,occluded:!1};const xf=ge?2*Gn.length:Gn.length;for(let Ad=0;Ad<xf;++Ad){const bg=this.attemptAnchorPlacement(Gn[Ad%Gn.length],Si,Id,Ta,Wl,Te,Ie,H,P,de,Ad>=Gn.length,Ve,ut,k,_f,al,ue,le);if(bg&&(Gl=bg.placedGlyphBoxes,Gl&&Gl.box&&Gl.box.length)){ct=!0,vn=bg.shift;break}}return Gl};li(()=>lr(Qr,Ye.iconBox,o.WritingMode.horizontal),()=>{const Si=Ye.verticalTextBox;return Si&&ai(Si),k.allowVerticalPlacement&&!(Yt&&Yt.box&&Yt.box.length)&&qe>0&&Si?lr(Si,Ye.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Yt&&(ct=Yt.box,pt=Yt.offscreen,It=Yt.occluded);const po=Ai(!(!Yt||!Yt.box));if(!ct&&this.prevPlacement){const Si=this.prevPlacement.variableOffsets[bt];Si&&(this.variableOffsets[bt]=Si,this.markUsedJustification(k,Si.anchor,Ve,po))}}else{const Gn=(lr,po)=>{const Si=k.getSymbolInstanceTextSize(ue,Ve,this.transform.zoom,ut),ko=this.collisionIndex.placeCollisionBox(k,Si,lr,new o.Point(0,0),ge,H,P,de.predicate);return ko&&ko.box&&ko.box.length&&(this.markUsedOrientation(k,po,Ve),this.placedOrientations[bt]=po),ko};li(()=>Gn(Qr,o.WritingMode.horizontal),()=>{const lr=Ye.verticalTextBox;return k.allowVerticalPlacement&&qe>0&&lr?(ai(lr),Gn(lr,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Ai(!!(Yt&&Yt.box&&Yt.box.length))}}if(Dn=Yt,ct=Dn&&Dn.box&&Dn.box.length>0,pt=Dn&&Dn.offscreen,It=Dn&&Dn.occluded,Ve.useRuntimeCollisionCircles){const Ai=k.text.placedSymbolArray.get(Ve.centerJustifiedTextSymbolIndex>=0?Ve.centerJustifiedTextSymbolIndex:Ve.verticalPlacedTextSymbolIndex),li=o.evaluateSizeForFeature(k.textSizeData,ue,Ai),Gn=M.get("text-padding");Mn=this.collisionIndex.placeCollisionCircles(k,ge,Ai,k.lineVertexArray,k.glyphOffsetArray,li,P,R,$,b,Ie,de.predicate,Ve.collisionCircleDiameter*li/o.ONE_EM,Gn,this.retainedQueryData[k.bucketInstanceId].tileID),ct=ge||Mn.circles.length>0&&!Mn.collisionDetected,pt=pt&&Mn.offscreen,It=Mn.occluded}if(Ye.iconFeatureIndex&&(si=Ye.iconFeatureIndex),Ye.iconBox){const Ai=li=>{ai(li);const Gn=Ce&&vn?ld(vn.x,vn.y,Te,Ie,this.transform.angle):new o.Point(0,0),lr=k.getSymbolInstanceIconSize(le,this.transform.zoom,Ve.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(k,lr,li,Gn,ye,H,P,de.predicate)};un&&un.box&&un.box.length&&Ye.verticalIconBox?(tn=Ai(Ye.verticalIconBox),Tt=tn.box.length>0):(tn=Ai(Ye.iconBox),Tt=tn.box.length>0),pt=pt&&tn.offscreen,rn=tn.occluded}const Lr=Z||Ve.numHorizontalGlyphVertices===0&&qe===0,ls=oe||Ve.numIconVertices===0;if(Lr||ls?ls?Lr||(Tt=Tt&&ct):ct=Tt&&ct:Tt=ct=Tt&&ct,ct&&Dn&&Dn.box&&this.collisionIndex.insertCollisionBox(Dn.box,M.get("text-ignore-placement"),k.bucketInstanceId,un&&un.box&&oi?oi:Qn,de.ID),Tt&&tn&&this.collisionIndex.insertCollisionBox(tn.box,M.get("icon-ignore-placement"),k.bucketInstanceId,si,de.ID),Mn&&(ct&&this.collisionIndex.insertCollisionCircles(Mn.circles,M.get("text-ignore-placement"),k.bucketInstanceId,Qn,de.ID),b)){const Ai=k.bucketInstanceId;let li=this.collisionCircleArrays[Ai];li===void 0&&(li=this.collisionCircleArrays[Ai]=new sd);for(let Gn=0;Gn<Mn.circles.length;Gn+=4)li.circles.push(Mn.circles[Gn+0]),li.circles.push(Mn.circles[Gn+1]),li.circles.push(Mn.circles[Gn+2]),li.circles.push(Mn.collisionDetected?1:0)}const Js=k.projection.name!=="globe";Re=Re&&(Js||!It),Ge=Ge&&(Js||!rn),this.placements[bt]=new od(ct||Re,Tt||Ge,pt||k.justReloaded),p.add(bt)};if(Le){const Ve=k.getSortedSymbolIndexes(this.transform.angle);for(let ut=Ve.length-1;ut>=0;--ut){const Ye=Ve[ut];St(k.symbolInstances.get(Ye),Ye,k.collisionArrays[Ye])}}else for(let Ve=u.symbolInstanceStart;Ve<u.symbolInstanceEnd;Ve++)St(k.symbolInstances.get(Ve),Ve,k.collisionArrays[Ve]);if(b&&k.bucketInstanceId in this.collisionCircleArrays){const Ve=this.collisionCircleArrays[k.bucketInstanceId];o.invert(Ve.invProjMatrix,P),Ve.viewportMatrix=this.collisionIndex.getViewportMatrix()}k.justReloaded=!1}markUsedJustification(u,p,b,S){const{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:R,crossTileID:$}=b,F=o.getAnchorJustification(p),H=S===o.WritingMode.vertical?R:F==="left"?k:F==="center"?M:F==="right"?P:-1;k>=0&&(u.text.placedSymbolArray.get(k).crossTileID=H>=0&&k!==H?0:$),M>=0&&(u.text.placedSymbolArray.get(M).crossTileID=H>=0&&M!==H?0:$),P>=0&&(u.text.placedSymbolArray.get(P).crossTileID=H>=0&&P!==H?0:$),R>=0&&(u.text.placedSymbolArray.get(R).crossTileID=H>=0&&R!==H?0:$)}markUsedOrientation(u,p,b){const S=p===o.WritingMode.horizontal||p===o.WritingMode.horizontalOnly?p:0,k=p===o.WritingMode.vertical?p:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:$}=b,F=u.text.placedSymbolArray;M>=0&&(F.get(M).placedOrientation=S),P>=0&&(F.get(P).placedOrientation=S),R>=0&&(F.get(R).placedOrientation=S),$>=0&&(F.get($).placedOrientation=k)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let b=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const S=p?p.symbolFadeChange(u):1,k=p?p.opacities:{},M=p?p.variableOffsets:{},P=p?p.placedOrientations:{};for(const R in this.placements){const $=this.placements[R],F=k[R];F?(this.opacities[R]=new ba(F,S,$.text,$.icon,null,$.clipped),b=b||$.text!==F.text.placed||$.icon!==F.icon.placed):(this.opacities[R]=new ba(null,S,$.text,$.icon,$.skipFade,$.clipped),b=b||$.text||$.icon)}for(const R in k){const $=k[R];if(!this.opacities[R]){const F=new ba($,S,!1,!1);F.isHidden()||(this.opacities[R]=F,b=b||$.text.placed||$.icon.placed)}}for(const R in M)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=M[R]);for(const R in P)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=P[R]);b?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:u)}updateLayerOpacities(u,p){const b=new Set;for(const S of p){const k=S.getBucket(u);k&&S.latestFeatureIndex&&u.id===k.layerIds[0]&&this.updateBucketOpacities(k,b,S.collisionBoxArray)}}updateBucketOpacities(u,p,b){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const S=u.layers[0].layout,k=!!u.layers[0].dynamicFilter(),M=new ba(null,0,!1,!1,!0),P=S.get("text-allow-overlap"),R=S.get("icon-allow-overlap"),$=S.get("text-variable-anchor"),F=S.get("text-rotation-alignment")==="map",H=S.get("text-pitch-alignment")==="map",ne=S.get("icon-text-fit")!=="none",ae=new ba(null,0,P&&(R||!u.hasIconData()||S.get("icon-optional")),R&&(P||!u.hasTextData()||S.get("text-optional")),!0);!u.collisionArrays&&b&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(b);const ue=(de,Z,oe)=>{for(let ge=0;ge<Z/4;ge++)de.opacityVertexArray.emplaceBack(oe)};let le=0;for(let de=0;de<u.symbolInstances.length;de++){const Z=u.symbolInstances.get(de),{numHorizontalGlyphVertices:oe,numVerticalGlyphVertices:ge,crossTileID:ye,numIconVertices:Te}=Z,Ie=p.has(ye);let Ce=this.opacities[ye];Ie?Ce=M:Ce||(Ce=ae,this.opacities[ye]=Ce),p.add(ye);const Le=oe>0||ge>0,Re=Te>0,Ge=this.placedOrientations[ye],St=Ge===o.WritingMode.vertical,Ve=Ge===o.WritingMode.horizontal||Ge===o.WritingMode.horizontalOnly;if(!Le&&!Re||Ce.isHidden()||le++,Le){const ut=cd(Ce.text);ue(u.text,oe,St?Wi:ut),ue(u.text,ge,Ve?Wi:ut);const Ye=Ce.text.isHidden(),{leftJustifiedTextSymbolIndex:bt,centerJustifiedTextSymbolIndex:qe,rightJustifiedTextSymbolIndex:ct,verticalPlacedTextSymbolIndex:Tt}=Z,pt=u.text.placedSymbolArray,It=Ye||St?1:0;bt>=0&&(pt.get(bt).hidden=It),qe>=0&&(pt.get(qe).hidden=It),ct>=0&&(pt.get(ct).hidden=It),Tt>=0&&(pt.get(Tt).hidden=Ye||Ve?1:0);const rn=this.variableOffsets[ye];rn&&this.markUsedJustification(u,rn.anchor,Z,Ge);const vn=this.placedOrientations[ye];vn&&(this.markUsedJustification(u,"left",Z,vn),this.markUsedOrientation(u,vn,Z))}if(Re){const ut=cd(Ce.icon),{placedIconSymbolIndex:Ye,verticalPlacedIconSymbolIndex:bt}=Z,qe=u.icon.placedSymbolArray,ct=Ce.icon.isHidden()?1:0;Ye>=0&&(ue(u.icon,Te,St?Wi:ut),qe.get(Ye).hidden=ct),bt>=0&&(ue(u.icon,Z.numVerticalIconVertices,Ve?Wi:ut),qe.get(bt).hidden=ct)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const ut=u.collisionArrays[de];if(ut){let Ye=new o.Point(0,0),bt=!0;if(ut.textBox||ut.verticalTextBox){if($){const ct=this.variableOffsets[ye];ct?(Ye=ad(ct.anchor,ct.width,ct.height,ct.textOffset,ct.textScale),F&&Ye._rotate(H?this.transform.angle:-this.transform.angle)):bt=!1}k&&(bt=!Ce.clipped),ut.textBox&&Ec(u.textCollisionBox.collisionVertexArray,Ce.text.placed,!bt||St,Ye.x,Ye.y),ut.verticalTextBox&&Ec(u.textCollisionBox.collisionVertexArray,Ce.text.placed,!bt||Ve,Ye.x,Ye.y)}const qe=bt&&!!(!Ve&&ut.verticalIconBox);ut.iconBox&&Ec(u.iconCollisionBox.collisionVertexArray,Ce.icon.placed,qe,ne?Ye.x:0,ne?Ye.y:0),ut.verticalIconBox&&Ec(u.iconCollisionBox.collisionVertexArray,Ce.icon.placed,!qe,ne?Ye.x:0,ne?Ye.y:0)}}}if(u.fullyClipped=le===0,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const de=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=de.invProjMatrix,u.placementViewportMatrix=de.viewportMatrix,u.collisionCircleArray=de.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,p){const b=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*b>u}setStale(){this.stale=!0}}function Ec(y,u,p,b,S){y.emplaceBack(u?1:0,p?1:0,b||0,S||0),y.emplaceBack(u?1:0,p?1:0,b||0,S||0),y.emplaceBack(u?1:0,p?1:0,b||0,S||0),y.emplaceBack(u?1:0,p?1:0,b||0,S||0)}const So=Math.pow(2,25),Qi=Math.pow(2,24),Mm=Math.pow(2,17),Pm=Math.pow(2,16),Eo=Math.pow(2,9),rs=Math.pow(2,8),e0=Math.pow(2,1);function cd(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const u=y.placed?1:0,p=Math.floor(127*y.opacity);return p*So+u*Qi+p*Mm+u*Pm+p*Eo+u*rs+p*e0+u}const Wi=0;class ud{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&u.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(u,p,b,S,k){const M=this._bucketParts;for(;this._currentTileIndex<u.length;)if(p.getBucketParts(M,S,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,k())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((P,R)=>P.sortKey-R.sortKey));this._currentPartIndex<M.length;){const P=M[this._currentPartIndex];if(p.placeLayerBucketPart(P,this._seenCrossTileIDs,b,P.symbolInstanceStart===0),this._currentPartIndex++,k())return!0}return!1}}class Om{constructor(u,p,b,S,k,M,P,R){this.placement=new Gh(u,k,M,P,R),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(u,p,b){const S=o.exported.now(),k=()=>{const M=o.exported.now()-S;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=p[u[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(M.type==="symbol"&&(!M.minzoom||M.minzoom<=P)&&(!M.maxzoom||M.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new ud(M)),this._inProgressLayer.continuePlacement(b[M.source],this.placement,this._showCollisionBoxes,M,k))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const Fl=512/o.EXTENT/2;class Wr{constructor(u,p,b){this.tileID=u,this.bucketInstanceId=b,this.index=new o.KDBush(p.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=u.canonical.x*o.EXTENT,k=u.canonical.y*o.EXTENT;for(let M=0;M<p.length;M++){const{key:P,crossTileID:R,tileAnchorX:$,tileAnchorY:F}=p.get(M),H=Math.floor((S+$)*Fl),ne=Math.floor((k+F)*Fl);this.index.add(H,ne),this.keys.push(P),this.crossTileIDs.push(R)}this.index.finish()}findMatches(u,p,b){const S=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),k=Fl/Math.pow(2,p.canonical.z-this.tileID.canonical.z),M=p.canonical.x*o.EXTENT,P=p.canonical.y*o.EXTENT;for(let R=0;R<u.length;R++){const $=u.get(R);if($.crossTileID)continue;const{key:F,tileAnchorX:H,tileAnchorY:ne}=$,ae=Math.floor((M+H)*k),ue=Math.floor((P+ne)*k),le=this.index.range(ae-S,ue-S,ae+S,ue+S);for(const de of le){const Z=this.crossTileIDs[de];if(this.keys[de]===F&&!b.has(Z)){b.add(Z),$.crossTileID=Z;break}}}}}class Dm{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Rm{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const p=Math.round((u-this.lng)/360);if(p!==0)for(const b in this.indexes){const S=this.indexes[b],k={};for(const M in S){const P=S[M];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+p),k[P.tileID.key]=P}this.indexes[b]=k}this.lng=u}addBucket(u,p,b){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let k=0;k<p.symbolInstances.length;k++)p.symbolInstances.get(k).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]=new Set);const S=this.usedCrossTileIDs[u.overscaledZ];for(const k in this.indexes){const M=this.indexes[k];if(Number(k)>u.overscaledZ)for(const P in M){const R=M[P];R.tileID.isChildOf(u)&&R.findMatches(p.symbolInstances,u,S)}else{const P=M[u.scaledTo(Number(k)).key];P&&P.findMatches(p.symbolInstances,u,S)}}for(let k=0;k<p.symbolInstances.length;k++){const M=p.symbolInstances.get(k);M.crossTileID||(M.crossTileID=b.generate(),S.add(M.crossTileID))}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new Wr(u,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(u,p){for(const b of p.crossTileIDs)this.usedCrossTileIDs[u].delete(b)}removeStaleBuckets(u){let p=!1;for(const b in this.indexes){const S=this.indexes[b];for(const k in S)u[S[k].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,S[k]),delete S[k],p=!0)}return p}}class _a{constructor(){this.layerIndexes={},this.crossTileIDs=new Dm,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,p,b,S){let k=this.layerIndexes[u.id];k===void 0&&(k=this.layerIndexes[u.id]=new Rm);let M=!1;const P={};S.name!=="globe"&&k.handleWrapJump(b);for(const R of p){const $=R.getBucket(u);$&&u.id===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),k.addBucket(R.tileID,$,this.crossTileIDs)&&(M=!0),P[$.bucketInstanceId]=!0)}return k.removeStaleBuckets(P)&&(M=!0),M}pruneUnusedLayers(u){const p={};u.forEach(b=>{p[b]=!0});for(const b in this.layerIndexes)p[b]||delete this.layerIndexes[b]}}const ol=(y,u)=>o.emitValidationErrors(y,u&&u.filter(p=>p.identifier!=="source.canvas")),Hh=o.pick(jn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Sw=o.pick(jn,["setCenter","setZoom","setBearing","setPitch"]),Lm={version:8,layers:[],sources:{}},kc={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Xs extends o.Evented{constructor(u,p={}){super(),this.map=u,this.dispatcher=new Be(il(),this),this.imageManager=new Fe,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(u._requestManager,p.localFontFamily?o.LocalGlyphMode.all:p.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,p.localFontFamily||p.localIdeographFontFamily),this.crossTileSymbolIndex=new _a,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const b=this;this._rtlTextPluginCallback=Xs.registerForPluginStateChange(S=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(k,M)=>{if(o.triggerPluginCompletionEvent(k),M&&M.every(P=>P))for(const P in b._sourceCaches){const R=b._sourceCaches[P],$=R.getSource().type;$!=="vector"&&$!=="geojson"||R.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const k=this.getSource(S.sourceId);if(k&&k.vectorLayerIds)for(const M in this._layers){const P=this._layers[M];P.source===k.id&&this._validateLayer(P)}})}loadURL(u,p={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const b=typeof p.validate=="boolean"?p.validate:!o.isMapboxURL(u);u=this.map._requestManager.normalizeStyleURL(u,p.accessToken);const S=this.map._requestManager.transformRequest(u,o.ResourceType.Style);this._request=o.getJSON(S,(k,M)=>{this._request=null,k?this.fire(new o.ErrorEvent(k)):M&&this._load(M,b)})}loadJSON(u,p={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(u,p.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Lm,!1)}_updateLayerCount(u,p){const b=p?1:-1;u.is3D()&&(this._num3DLayers+=b),u.type==="circle"&&(this._numCircleLayers+=b),u.type==="symbol"&&(this._numSymbolLayers+=b)}_load(u,p){if(p&&ol(this,o.validateStyle(u)))return;this._loaded=!0,this.stylesheet=o.clone$1(u),this._updateMapProjection();for(const S in u.sources)this.addSource(S,u.sources[S],{validate:!1});this._changed=!1,u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(u.glyphs);const b=qh(this.stylesheet.layers);this._order=b.map(S=>S.id),this._layers={},this._serializedLayers={};for(const S of b){const k=o.createStyleLayer(S);k.setEventedParent(this,{layer:{id:k.id}}),this._layers[k.id]=k,this._serializedLayers[k.id]=k.serialize(),this._updateLayerCount(k,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new At(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(u){this._spriteRequest=function(p,b,S){let k,M,P;const R=o.exported.devicePixelRatio>1?"@2x":"";let $=o.getJSON(b.transformRequest(b.normalizeSpriteURL(p,R,".json"),o.ResourceType.SpriteJSON),(ne,ae)=>{$=null,P||(P=ne,k=ae,H())}),F=o.getImage(b.transformRequest(b.normalizeSpriteURL(p,R,".png"),o.ResourceType.SpriteImage),(ne,ae)=>{F=null,P||(P=ne,M=ae,H())});function H(){if(P)S(P);else if(k&&M){const ne=o.exported.getImageData(M),ae={};for(const ue in k){const{width:le,height:de,x:Z,y:oe,sdf:ge,pixelRatio:ye,stretchX:Te,stretchY:Ie,content:Ce}=k[ue],Le=new o.RGBAImage({width:le,height:de});o.RGBAImage.copy(ne,Le,{x:Z,y:oe},{x:0,y:0},{width:le,height:de}),ae[ue]={data:Le,pixelRatio:ye,sdf:ge,stretchX:Te,stretchY:Ie,content:Ce}}S(null,ae)}}return{cancel(){$&&($.cancel(),$=null),F&&(F.cancel(),F=null)}}}(u,this.map._requestManager,(p,b)=>{if(this._spriteRequest=null,p)this.fire(new o.ErrorEvent(p));else if(b)for(const S in b)this.imageManager.addImage(S,b[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(u){const p=this.getSource(u.source);if(!p)return;const b=u.sourceLayer;b&&(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(b)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${p.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(u){const p=[];for(const b of u){const S=this._layers[b];S.type!=="custom"&&p.push(S.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(u){return!!this.terrain&&(typeof u.isLayerDraped=="function"?u.isLayerDraped():kc[u.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(u){if(!this._loaded)return;const p=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),k=Object.keys(this._removedLayers);(S.length||k.length)&&this._updateWorkerLayers(S,k);for(const M in this._updatedSources){const P=this._updatedSources[M];P==="reload"?this._reloadSource(M):P==="clear"&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(u);this.light.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._resetUpdates()}const b={};for(const S in this._sourceCaches){const k=this._sourceCaches[S];b[S]=k.used,k.used=!1}for(const S of this._order){const k=this._layers[S];if(k.recalculate(u,this._availableImages),!k.isHidden(u.zoom)){const P=this._getLayerSourceCache(k);P&&(P.used=!0)}const M=this.map.painter;if(M){const P=k.getProgramIds();if(!P)continue;const R=k.getProgramConfiguration(u.zoom);for(const $ of P)M.useProgram($,R)}}for(const S in b){const k=this._sourceCaches[S];b[S]!==k.used&&k.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:k.getSource().id}))}this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const p in this._sourceCaches)this._sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateWorkerLayers(u,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(u),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(u){if(this._checkLoaded(),ol(this,o.validateStyle(u)))return!1;(u=o.clone$1(u)).layers=qh(u.layers);const p=function(S,k){if(!S)return[{command:jn.setStyle,args:[k]}];let M=[];try{if(!f(S.version,k.version))return[{command:jn.setStyle,args:[k]}];f(S.center,k.center)||M.push({command:jn.setCenter,args:[k.center]}),f(S.zoom,k.zoom)||M.push({command:jn.setZoom,args:[k.zoom]}),f(S.bearing,k.bearing)||M.push({command:jn.setBearing,args:[k.bearing]}),f(S.pitch,k.pitch)||M.push({command:jn.setPitch,args:[k.pitch]}),f(S.sprite,k.sprite)||M.push({command:jn.setSprite,args:[k.sprite]}),f(S.glyphs,k.glyphs)||M.push({command:jn.setGlyphs,args:[k.glyphs]}),f(S.transition,k.transition)||M.push({command:jn.setTransition,args:[k.transition]}),f(S.light,k.light)||M.push({command:jn.setLight,args:[k.light]}),f(S.fog,k.fog)||M.push({command:jn.setFog,args:[k.fog]}),f(S.projection,k.projection)||M.push({command:jn.setProjection,args:[k.projection]});const P={},R=[];(function(H,ne,ae,ue){let le;for(le in ne=ne||{},H=H||{})H.hasOwnProperty(le)&&(ne.hasOwnProperty(le)||rl(le,ae,ue));for(le in ne){if(!ne.hasOwnProperty(le))continue;const de=ne[le];H.hasOwnProperty(le)?f(H[le],de)||(H[le].type==="geojson"&&de.type==="geojson"&&id(H,ne,le)?ae.push({command:jn.setGeoJSONSourceData,args:[le,de.data]}):Wh(le,ne,ae,ue)):nd(le,ne,ae)}})(S.sources,k.sources,R,P);const $=[];S.layers&&S.layers.forEach(H=>{H.source&&P[H.source]?M.push({command:jn.removeLayer,args:[H.id]}):$.push(H)});let F=S.terrain;F&&P[F.source]&&(M.push({command:jn.setTerrain,args:[void 0]}),F=void 0),M=M.concat(R),f(F,k.terrain)||M.push({command:jn.setTerrain,args:[k.terrain]}),function(H,ne,ae){ne=ne||[];const ue=(H=H||[]).map($t),le=ne.map($t),de=H.reduce(an,{}),Z=ne.reduce(an,{}),oe=ue.slice(),ge=Object.create(null);let ye,Te,Ie,Ce,Le,Re,Ge;for(ye=0,Te=0;ye<ue.length;ye++)Ie=ue[ye],Z.hasOwnProperty(Ie)?Te++:(ae.push({command:jn.removeLayer,args:[Ie]}),oe.splice(oe.indexOf(Ie,Te),1));for(ye=0,Te=0;ye<le.length;ye++)Ie=le[le.length-1-ye],oe[oe.length-1-ye]!==Ie&&(de.hasOwnProperty(Ie)?(ae.push({command:jn.removeLayer,args:[Ie]}),oe.splice(oe.lastIndexOf(Ie,oe.length-Te),1)):Te++,Re=oe[oe.length-ye],ae.push({command:jn.addLayer,args:[Z[Ie],Re]}),oe.splice(oe.length-ye,0,Ie),ge[Ie]=!0);for(ye=0;ye<le.length;ye++)if(Ie=le[ye],Ce=de[Ie],Le=Z[Ie],!ge[Ie]&&!f(Ce,Le))if(f(Ce.source,Le.source)&&f(Ce["source-layer"],Le["source-layer"])&&f(Ce.type,Le.type)){for(Ge in nt(Ce.layout,Le.layout,ae,Ie,null,jn.setLayoutProperty),nt(Ce.paint,Le.paint,ae,Ie,null,jn.setPaintProperty),f(Ce.filter,Le.filter)||ae.push({command:jn.setFilter,args:[Ie,Le.filter]}),f(Ce.minzoom,Le.minzoom)&&f(Ce.maxzoom,Le.maxzoom)||ae.push({command:jn.setLayerZoomRange,args:[Ie,Le.minzoom,Le.maxzoom]}),Ce)Ce.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?nt(Ce[Ge],Le[Ge],ae,Ie,Ge.slice(6),jn.setPaintProperty):f(Ce[Ge],Le[Ge])||ae.push({command:jn.setLayerProperty,args:[Ie,Ge,Le[Ge]]}));for(Ge in Le)Le.hasOwnProperty(Ge)&&!Ce.hasOwnProperty(Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?nt(Ce[Ge],Le[Ge],ae,Ie,Ge.slice(6),jn.setPaintProperty):f(Ce[Ge],Le[Ge])||ae.push({command:jn.setLayerProperty,args:[Ie,Ge,Le[Ge]]}))}else ae.push({command:jn.removeLayer,args:[Ie]}),Re=oe[oe.lastIndexOf(Ie)+1],ae.push({command:jn.addLayer,args:[Le,Re]})}($,k.layers,M)}catch(P){console.warn("Unable to compute style diff:",P),M=[{command:jn.setStyle,args:[k]}]}return M}(this.serialize(),u).filter(S=>!(S.command in Sw));if(p.length===0)return!1;const b=p.filter(S=>!(S.command in Hh));if(b.length>0)throw new Error(`Unimplemented: ${b.map(S=>S.command).join(", ")}.`);return p.forEach(S=>{S.command!=="setTransition"&&S.command!=="setProjection"&&this[S.command].apply(this,S.args)}),this.stylesheet=u,this._updateMapProjection(),!0}addImage(u,p){return this.getImage(u)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,p),this._afterImageUpdated(u),this)}updateImage(u,p){this.imageManager.updateImage(u,p)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u),this._afterImageUpdated(u),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(u,p,b={}){if(this._checkLoaded(),this.getSource(u)!==void 0)throw new Error("There is already a source with this ID");if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(o.validateSource,`sources.${u}`,p,null,b))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const S=pn(u,p,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u),source:S.serialize(),sourceId:u}));const k=M=>{const P=(M?"symbol:":"other:")+u,R=this._sourceCaches[P]=new o.SourceCache(P,S,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[u]=R,R.style=this,R.onAdd(this.map)};k(!1),p.type!=="vector"&&p.type!=="geojson"||k(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(u){this._checkLoaded();const p=this.getSource(u);if(!p)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===u)return this.fire(new o.ErrorEvent(new Error(`Source "${u}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===u)return this.fire(new o.ErrorEvent(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const b=this._getSourceCaches(u);for(const S of b)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],p.setEventedParent(null),p.onRemove&&p.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(u,p){this._checkLoaded(),this.getSource(u).setData(p),this._changed=!0}getSource(u){const p=this._getSourceCache(u);return p&&p.getSource()}_getSources(){const u=[];for(const p in this._otherSourceCaches){const b=this._getSourceCache(p);b&&u.push(b.getSource())}return u}addLayer(u,p,b={}){this._checkLoaded();const S=u.id;if(this.getLayer(S))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let k;if(u.type==="custom"){if(ol(this,o.validateCustomStyleLayer(u)))return;k=o.createStyleLayer(u)}else{if(typeof u.source=="object"&&(this.addSource(S,u.source),u=o.clone$1(u),u=o.extend(u,{source:S})),this._validate(o.validateLayer,`layers.${S}`,u,{arrayIndex:-1},b))return;k=o.createStyleLayer(u),this._validateLayer(k),k.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[k.id]=k.serialize(),this._updateLayerCount(k,!0)}const M=p?this._order.indexOf(p):this._order.length;if(p&&M===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`)));this._order.splice(M,0,S),this._layerOrderChanged=!0,this._layers[S]=k;const P=this._getLayerSourceCache(k);if(this._removedLayers[S]&&k.source&&P&&k.type!=="custom"){const R=this._removedLayers[S];delete this._removedLayers[S],R.type!==k.type?this._updatedSources[k.source]="clear":(this._updatedSources[k.source]="reload",P.pause())}this._updateLayer(k),k.onAdd&&k.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(u,p){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new o.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===p)return;const b=this._order.indexOf(u);this._order.splice(b,1);const S=p?this._order.indexOf(p):this._order.length;p&&S===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`))):(this._order.splice(S,0,u),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(u){this._checkLoaded();const p=this._layers[u];if(!p)return void this.fire(new o.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be removed.`)));p.setEventedParent(null),this._updateLayerCount(p,!1);const b=this._order.indexOf(u);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=p,delete this._layers[u],delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],p.onRemove&&p.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(u){return this._layers[u]}hasLayer(u){return u in this._layers}hasLayerType(u){for(const p in this._layers)if(this._layers[p].type===u)return!0;return!1}setLayerZoomRange(u,p,b){this._checkLoaded();const S=this.getLayer(u);S?S.minzoom===p&&S.maxzoom===b||(p!=null&&(S.minzoom=p),b!=null&&(S.maxzoom=b),this._updateLayer(S)):this.fire(new o.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(u,p,b={}){this._checkLoaded();const S=this.getLayer(u);if(S){if(!f(S.filter,p))return p==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(o.validateFilter,`layers.${S.id}.filter`,p,{layerType:S.type},b)||(S.filter=o.clone$1(p),this._updateLayer(S)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be filtered.`)))}getFilter(u){const p=this.getLayer(u);return p&&o.clone$1(p.filter)}setLayoutProperty(u,p,b,S={}){this._checkLoaded();const k=this.getLayer(u);k?f(k.getLayoutProperty(p),b)||(k.setLayoutProperty(p,b,S),this._updateLayer(k)):this.fire(new o.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(u,p){const b=this.getLayer(u);if(b)return b.getLayoutProperty(p);this.fire(new o.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style.`)))}setPaintProperty(u,p,b,S={}){this._checkLoaded();const k=this.getLayer(u);k?f(k.getPaintProperty(p),b)||(k.setPaintProperty(p,b,S)&&this._updateLayer(k),this._changed=!0,this._updatedPaintProps[u]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(u,p){const b=this.getLayer(u);return b&&b.getPaintProperty(p)}setFeatureState(u,p){this._checkLoaded();const b=u.source,S=u.sourceLayer,k=this.getSource(b);if(!k)return void this.fire(new o.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const M=k.type;if(M==="geojson"&&S)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(M==="vector"&&!S)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));u.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const P=this._getSourceCaches(b);for(const R of P)R.setFeatureState(S,u.id,p)}removeFeatureState(u,p){this._checkLoaded();const b=u.source,S=this.getSource(b);if(!S)return void this.fire(new o.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const k=S.type,M=k==="vector"?u.sourceLayer:void 0;if(k==="vector"&&!M)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(p&&typeof u.id!="string"&&typeof u.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const P=this._getSourceCaches(b);for(const R of P)R.removeFeatureState(M,u.id,p)}getFeatureState(u){this._checkLoaded();const p=u.source,b=u.sourceLayer,S=this.getSource(p);if(S){if(S.type!=="vector"||b)return u.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(p)[0].getFeatureState(b,u.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const u={};for(const p in this._sourceCaches){const b=this._sourceCaches[p].getSource();u[b.id]||(u[b.id]=b.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:u,layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateLayer(u){this._updatedLayers[u.id]=!0;const p=this._getLayerSourceCache(u);u.source&&!this._updatedSources[u.source]&&p&&p.getSource().type!=="raster"&&(this._updatedSources[u.source]="reload",p.pause()),this._changed=!0,u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const p=M=>this._layers[M].type==="fill-extrusion",b={},S=[];for(let M=this._order.length-1;M>=0;M--){const P=this._order[M];if(p(P)){b[P]=M;for(const R of u){const $=R[P];if($)for(const F of $)S.push(F)}}}S.sort((M,P)=>P.intersectionZ-M.intersectionZ);const k=[];for(let M=this._order.length-1;M>=0;M--){const P=this._order[M];if(p(P))for(let R=S.length-1;R>=0;R--){const $=S[R].feature;if(b[$.layer.id]<M)break;k.push($),S.pop()}else for(const R of u){const $=R[P];if($)for(const F of $)k.push(F.feature)}}return k}queryRenderedFeatures(u,p,b){p&&p.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",p.filter,null,p);const S={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const R of p.layers){const $=this._layers[R];if(!$)return this.fire(new o.ErrorEvent(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];S[$.source]=!0}}const k=[];p.availableImages=this._availableImages;const M=p&&p.layers?p.layers.some(R=>{const $=this.getLayer(R);return $&&$.is3D()}):this.has3DLayers(),P=gt.createFromScreenPoints(u,b);for(const R in this._sourceCaches){const $=this._sourceCaches[R].getSource().id;p.layers&&!S[$]||k.push(wi(this._sourceCaches[R],this._layers,this._serializedLayers,P,p,b,M,!!this.map._showQueryGeometry))}return this.placement&&k.push(function(R,$,F,H,ne,ae,ue){const le={},de=ae.queryRenderedSymbols(H),Z=[];for(const oe of Object.keys(de).map(Number))Z.push(ue[oe]);Z.sort(Ar);for(const oe of Z){const ge=oe.featureIndex.lookupSymbolFeatures(de[oe.bucketInstanceId],$,oe.bucketIndex,oe.sourceLayerIndex,ne.filter,ne.layers,ne.availableImages,R);for(const ye in ge){const Te=le[ye]=le[ye]||[],Ie=ge[ye];Ie.sort((Ce,Le)=>{const Re=oe.featureSortOrder;if(Re){const Ge=Re.indexOf(Ce.featureIndex);return Re.indexOf(Le.featureIndex)-Ge}return Le.featureIndex-Ce.featureIndex});for(const Ce of Ie)Te.push(Ce)}}for(const oe in le)le[oe].forEach(ge=>{const ye=ge.feature,Te=F(R[oe]);if(!Te)return;const Ie=Te.getFeatureState(ye.layer["source-layer"],ye.id);ye.source=ye.layer.source,ye.layer["source-layer"]&&(ye.sourceLayer=ye.layer["source-layer"]),ye.state=Ie});return le}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),P.screenGeometry,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(k)}querySourceFeatures(u,p){p&&p.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",p.filter,null,p);const b=this._getSourceCaches(u);let S=[];for(const k of b)S=S.concat(Ui(k,p));return S}addSourceType(u,p,b){return Xs.getSourceType(u)?b(new Error(`A source type called "${u}" already exists.`)):(Xs.setSourceType(u,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:p.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(u,p={}){this._checkLoaded();const b=this.light.getLight();let S=!1;for(const M in u)if(!f(u[M],b[M])){S=!0;break}if(!S)return;const k=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(u,p),this.light.updateTransitions(k)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(u,p=1){if(this._checkLoaded(),!u)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let b=u;if(p===1){if(typeof b.source=="object"){const S="terrain-dem-src";this.addSource(S,b.source),b=o.clone$1(b),b=o.extend(b,{source:S})}if(this._validate(o.validateTerrain,"terrain",b))return}if(!this.terrain||this.terrain&&p!==this.terrain.drapeRenderMode){if(!b)return;this._createTerrain(b,p)}else{const S=this.terrain,k=S.get();for(const M of Object.keys(o.spec.terrain))!b.hasOwnProperty(M)&&o.spec.terrain[M].default&&(b[M]=o.spec.terrain[M].default);for(const M in b)if(!f(b[M],k[M])){S.set(b),this.stylesheet.terrain=b;const P=this._setTransitionParameters({duration:0});S.updateTransitions(P);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const p=this.fog=new ot(u,this.map.transform);this.stylesheet.fog=u;const b=this._setTransitionParameters({duration:0});p.updateTransitions(b)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const p=this.fog,b=p.get();Object.keys(u).length===0&&p.set(u);for(const S in u)if(!f(u[S],b[S])){p.set(u),this.stylesheet.fog=u;const k=this._setTransitionParameters({duration:0});p.updateTransitions(k);break}}else this._createFog(u);this._markersNeedUpdate=!0}_setTransitionParameters(u){return{now:o.exported.now(),transition:o.extend(u,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const u=this._order.filter(b=>this.isLayerDraped(this._layers[b])),p=this._order.filter(b=>!this.isLayerDraped(this._layers[b]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...p)}_createTerrain(u,p){const b=this.terrain=new xt(u,p);this.stylesheet.terrain=u,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});b.updateTransitions(S)}_force3DLayerUpdate(){for(const u in this._layers){const p=this._layers[u];p.type==="fill-extrusion"&&this._updateLayer(p)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const p=this._layers[u];p.type==="symbol"&&this._updateLayer(p)}}_validate(u,p,b,S,k={}){return(!k||k.validate!==!1)&&ol(this,u.call(o.validateStyle,o.extend({key:p,style:this.serialize(),value:b,styleSpec:o.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this._sourceCaches)this._sourceCaches[u].clearTiles(),this._sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(u){const p=this._getSourceCaches(u);for(const b of p)b.clearTiles()}_reloadSource(u){const p=this._getSourceCaches(u);for(const b of p)b.resume(),b.reload()}_reloadSources(){for(const u of this._getSources())u.reload&&u.reload()}_updateSources(u){for(const p in this._sourceCaches)this._sourceCaches[p].update(u)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const p=this._sourceCaches[u];p.resume(),p.reload()}}_updatePlacement(u,p,b,S,k=!1){let M=!1,P=!1;const R={};for(const $ of this._order){const F=this._layers[$];if(F.type!=="symbol")continue;if(!R[F.source]){const ne=this._getLayerSourceCache(F);if(!ne)continue;R[F.source]=ne.getRenderableIds(!0).map(ae=>ne.getTileByID(ae)).sort((ae,ue)=>ue.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(ue.tileID)?-1:1))}const H=this.crossTileSymbolIndex.addLayer(F,R[F.source],u.center.lng,u.projection);M=M||H}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),k=k||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(k||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),u.zoom))&&(this.pauseablePlacement=new Om(u,this._order,k,p,b,S,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),P=!0),M&&this.pauseablePlacement.placement.setStale()),P||M)for(const $ of this._order){const F=this._layers[$];F.type==="symbol"&&this.placement.updateLayerOpacities(F,R[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}getImages(u,p,b){this.imageManager.getImages(p.icons,b),this._updateTilesForChangedImages();const S=k=>{k&&k.setDependencies(p.tileID.key,p.type,p.icons)};S(this._otherSourceCaches[p.source]),S(this._symbolSourceCaches[p.source])}getGlyphs(u,p,b){this.glyphManager.getGlyphs(p.stacks,b)}getResource(u,p,b){return o.makeRequest(p,b)}_getSourceCache(u){return this._otherSourceCaches[u]}_getLayerSourceCache(u){return u.type==="symbol"?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}_getSourceCaches(u){const p=[];return this._otherSourceCaches[u]&&p.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&p.push(this._symbolSourceCaches[u]),p}_isSourceCacheLoaded(u){const p=this._getSourceCaches(u);return p.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${u}'`))),!1):p.every(b=>b.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Xs.getSourceType=function(y){return _n[y]},Xs.setSourceType=function(y,u){_n[y]=u},Xs.registerForPluginStateChange=o.registerForPluginStateChange;var zm=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Nl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",xa=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,dd=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,wa=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Zh={},Tc={};const hd=[];Cc(zm,hd),Cc(xa,hd),Cc(dd,hd),Cc(wa,hd),Zh=Kn("",xa),Tc=Kn(wa,dd);const t0=Kn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Xh=zm,Bm=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Fm={background:Kn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Kn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Kn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Kn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Kn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Kn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Kn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Kn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Kn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Kn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Kn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Kn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Kn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Kn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Kn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Kn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Kn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Kn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Kn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Kn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Kn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Kn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Kn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Kn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Kn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Nl),skyboxGradient:Kn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Nl),skyboxCapture:Kn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Kn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Kn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Cc(y,u){const p=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let b of p)if(b=b.trim(),b[0]==="#"&&b.includes("if")&&!b.includes("endif")){b=b.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=b.split(" ");for(const k of S)u.includes(k)||u.push(k)}}function Kn(y,u){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=u.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},k=[...hd];return Cc(y,k),Cc(u,k),{fragmentSource:y=y.replace(p,(M,P,R,$,F)=>(S[F]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${R} ${$} ${F};
#else
uniform ${R} ${$} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${R} ${$} ${F} = u_${F};
#endif
`)),vertexSource:u=u.replace(p,(M,P,R,$,F)=>{const H=$==="float"?"vec2":"vec4",ne=F.match(/color/)?"color":H;return S[F]?P==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${R} ${H} a_${F};
varying ${R} ${$} ${F};
#else
uniform ${R} ${$} u_${F};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${R} ${$} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${ne}(a_${F}, u_${F}_t);
#else
    ${R} ${$} ${F} = u_${F};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${R} ${H} a_${F};
#else
uniform ${R} ${$} u_${F};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${R} ${$} ${F} = a_${F};
#else
    ${R} ${$} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${R} ${$} ${F} = unpack_mix_${ne}(a_${F}, u_${F}_t);
#else
    ${R} ${$} ${F} = u_${F};
#endif
`}),staticAttributes:b,usedDefines:k}}class Ew{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,p,b,S,k,M,P){this.context=u;let R=this.boundPaintVertexBuffers.length!==S.length;for(let F=0;!R&&F<S.length;F++)this.boundPaintVertexBuffers[F]!==S[F]&&(R=!0);let $=this.boundDynamicVertexBuffers.length!==P.length;for(let F=0;!$&&F<P.length;F++)this.boundDynamicVertexBuffers[F]!==P[F]&&($=!0);if(!u.extVertexArrayObject||!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==b||R||$||this.boundIndexBuffer!==k||this.boundVertexOffset!==M)this.freshBind(p,b,S,k,M,P);else{u.bindVertexArrayOES.set(this.vao);for(const F of P)F&&F.bind();k&&k.dynamicDraw&&k.bind()}}freshBind(u,p,b,S,k,M){let P;const R=u.numAttributes,$=this.context,F=$.gl;if($.extVertexArrayObject)this.vao&&this.destroy(),this.vao=$.extVertexArrayObject.createVertexArrayOES(),$.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=u,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=S,this.boundVertexOffset=k,this.boundDynamicVertexBuffers=M;else{P=$.currentNumAttributes||0;for(let H=R;H<P;H++)F.disableVertexAttribArray(H)}p.enableAttributes(F,u),p.bind(),p.setVertexAttribPointers(F,u,k);for(const H of b)H.enableAttributes(F,u),H.bind(),H.setVertexAttribPointers(F,u,k);for(const H of M)H&&(H.enableAttributes(F,u),H.bind(),H.setVertexAttribPointers(F,u,k));S&&S.bind(),$.currentNumAttributes=R}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Nm(y,u){const p=Math.pow(2,u.canonical.z),b=u.canonical.y;return[new o.MercatorCoordinate(0,b/p).toLngLat().lat,new o.MercatorCoordinate(0,(b+1)/p).toLngLat().lat]}function n0(y,u,p,b,S,k,M){const P=y.context,R=P.gl,$=p.fbo;if(!$)return;y.prepareDrawTile();const F=y.useProgram("hillshade");P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,$.colorAttachment.get());const H=((le,de,Z,oe)=>{const ge=Z.paint.get("hillshade-shadow-color"),ye=Z.paint.get("hillshade-highlight-color"),Te=Z.paint.get("hillshade-accent-color");let Ie=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ie-=le.transform.angle);const Ce=!le.options.moving;return{u_matrix:oe||le.transform.calculateProjMatrix(de.tileID.toUnwrapped(),Ce),u_image:0,u_latrange:Nm(0,de.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),Ie],u_shadow:ge,u_highlight:ye,u_accent:Te}})(y,p,b,y.terrain?u.projMatrix:null);y.prepareDrawProgram(P,F,u.toUnwrapped());const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:ae,tileBoundsSegments:ue}=y.getTileBoundsBuffers(p);F.draw(P,R.TRIANGLES,S,k,M,o.CullFaceMode.disabled,H,b.id,ne,ae,ue)}function $m(y,u,p){if(!u.needsDEMTextureUpload)return;const b=y.context,S=b.gl;b.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||y.getTileTexture(p.stride);const k=p.getPixels();u.demTexture?u.demTexture.update(k,{premultiply:!1}):u.demTexture=new o.Texture(b,k,S.RGBA,{premultiply:!1}),u.needsDEMTextureUpload=!1}function i0(y,u,p,b,S,k){const M=y.context,P=M.gl;if(!u.dem)return;const R=u.dem;if(M.activeTexture.set(P.TEXTURE1),$m(y,u,R),!u.demTexture)return;u.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);const $=R.dim;M.activeTexture.set(P.TEXTURE0);let F=u.fbo;if(!F){const ue=new o.Texture(M,{width:$,height:$,data:null},P.RGBA);ue.bind(P.LINEAR,P.CLAMP_TO_EDGE),F=u.fbo=M.createFramebuffer($,$,!0),F.colorAttachment.set(ue.texture)}M.bindFramebuffer.set(F.framebuffer),M.viewport.set([0,0,$,$]);const{tileBoundsBuffer:H,tileBoundsIndexBuffer:ne,tileBoundsSegments:ae}=y.getMercatorTileBoundsBuffers();y.useProgram("hillshadePrepare").draw(M,P.TRIANGLES,b,S,k,o.CullFaceMode.disabled,((ue,le)=>{const de=le.stride,Z=o.create();return o.ortho(Z,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(Z,Z,[0,-o.EXTENT,0]),{u_matrix:Z,u_image:1,u_dimension:[de,de],u_zoom:ue.overscaledZ,u_unpack:le.unpackVector}})(u.tileID,R),p.id,H,ne,ae),u.needsHillshadePrepare=!1}const jm=y=>({u_matrix:new o.UniformMatrix4f(y),u_image0:new o.Uniform1i(y),u_skirt_height:new o.Uniform1f(y)}),Ic=(y,u)=>({u_matrix:y,u_image0:0,u_skirt_height:u}),Kh=(y,u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(b),u_merc_matrix:p,u_zoom_transition:S,u_merc_center:k,u_image0:0,u_frustum_tl:M,u_frustum_tr:P,u_frustum_br:R,u_frustum_bl:$,u_globe_pos:F,u_globe_radius:H,u_viewport:ne,u_grid_matrix:ue?Float32Array.from(ue):new Float32Array(9),u_skirt_height:ae});function Ac(y,u){return y!=null&&u!=null&&!(!y.hasData()||!u.hasData())&&y.demTexture!=null&&u.demTexture!=null&&y.tileID.key!==u.tileID.key}const Sa=new class{constructor(){this.operations={}}newMorphing(y,u,p,b,S){if(y in this.operations){const k=this.operations[y];k.to.tileID.key!==p.tileID.key&&(k.queued=p)}else this.operations[y]={startTime:b,phase:0,duration:S,from:u,to:p,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const u=this.operations[y];return{from:u.from,to:u.to,phase:u.phase}}update(y){for(const u in this.operations){const p=this.operations[u];for(p.phase=(y-p.startTime)/p.duration;p.phase>=1||!this._validOp(p);)if(!this._nextOp(p,y)){delete this.operations[u];break}}}_nextOp(y,u){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=u,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},$l={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Yh(y){return 6*Math.pow(1.5,22-y)}function r0(y,u){const p=1<<y.z;return!u&&(y.x===0||y.x===p-1)||y.y===0||y.y===p-1}const fd=y=>({u_matrix:y});function Vm(y,u,p,b,S){if(S>0){const k=o.exported.now(),M=(k-y.timeAdded)/S,P=u?(k-u.timeAdded)/S:-1,R=p.getSource(),$=b.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),F=!u||Math.abs(u.tileID.overscaledZ-$)>Math.abs(y.tileID.overscaledZ-$),H=F&&y.refreshedUponExpiration?1:o.clamp(F?M:1-P,0,1);return y.refreshedUponExpiration&&M>=1&&(y.refreshedUponExpiration=!1),u?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}class Um extends o.SourceCache{constructor(u){const p={type:"raster-dem",maxzoom:u.transform.maxZoom},b=new Be(il(),null),S=pn("mock-dem",p,b,u.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,p){u.state="loaded",p(null)}}class Jh extends o.SourceCache{constructor(u){const p=pn("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new Be(il(),null),u.style);super("proxy",p,!1),p.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,p,b){if(u.freezeTileCoverage)return;this.transform=u;const S=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((k,M)=>{if(k[M.key]="",!this._tiles[M.key]){const P=new o.Tile(M,this._source.tileSize*M.overscaleFactor(),u.tileZoom);P.state="loaded",this._tiles[M.key]=P}return k},{});for(const k in this._tiles)k in S||(this.freeFBO(k),this._tiles[k].unloadVectorData(),delete this._tiles[k])}freeFBO(u){const p=this.proxyCachedFBO[u];if(p!==void 0){const b=Object.values(p);this.renderCachePool.push(...b),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Qh extends o.OverscaledTileID{constructor(u,p,b){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=p,this.projMatrix=b}}class qm extends o.Elevation{constructor(u,p){super(),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[b,S,k]=function(R){const $=new o.StructArrayLayout2i4,F=new o.StructArrayLayout3ui6,H=131;$.reserve(17161),F.reserve(33800);const ne=o.EXTENT/128,ae=o.EXTENT+ne/2,ue=ae+ne;for(let de=-ne;de<ue;de+=ne)for(let Z=-ne;Z<ue;Z+=ne){const oe=Z<0||Z>ae||de<0||de>ae?24575:0,ge=o.clamp(Math.round(Z),0,o.EXTENT),ye=o.clamp(Math.round(de),0,o.EXTENT);$.emplaceBack(ge+oe,ye)}const le=(de,Z)=>{const oe=Z*H+de;F.emplaceBack(oe+1,oe,oe+H),F.emplaceBack(oe+H,oe+H+1,oe+1)};for(let de=1;de<129;de++)for(let Z=1;Z<129;Z++)le(Z,de);return[0,129].forEach(de=>{for(let Z=0;Z<130;Z++)le(Z,de),le(de,Z)}),[$,F,32768]}(),M=u.context;this.gridBuffer=M.createVertexBuffer(b,o.posAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(S),this.gridSegments=o.SegmentVector.simpleSegment(0,0,b.length,S.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,b.length,k),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Jh(p.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const P=M.gl;this._overlapStencilMode=new o.StencilMode({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=p,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Um(p.map)}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),u.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=u,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(u,p,b){if(u&&u.terrain){this._style!==u&&(this.style=u),this.enabled=!0;const S=u.terrain.properties;this.sourceCache=u.terrain.drapeRenderMode===0?this._mockSourceCache:u._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const k=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(p,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,k(),this._initializing=!0),k(),p.updateElevation(!0,b),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(p),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const u=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||u.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${u.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${u.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(u){u.coord&&u.dataType==="source"?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):u.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._sourceCaches)this._style._sourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const p=this.proxySourceCache,b=this.painter.transform;this._initializing&&(this._initializing=b._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(b.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=p.getIds().map(R=>{const $=p.getTileByID(R).tileID;return $.projMatrix=b.calculateProjMatrix($.toUnwrapped()),$});(function(R,$){const F=$.transform.pointCoordinate($.transform.getCameraPoint()),H=new o.Point(F.x,F.y);R.sort((ne,ae)=>{if(ae.overscaledZ-ne.overscaledZ)return ae.overscaledZ-ne.overscaledZ;const ue=new o.Point(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),le=new o.Point(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),de=H.mult(1<<ne.canonical.z);return de.x-=.5,de.y-=.5,de.distSqr(ue)-de.distSqr(le)})})(S,this.painter),this._previousZoom=b.zoom;const k=this.proxyToSource||{};this.proxyToSource={},S.forEach(R=>{this.proxyToSource[R.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const R in M){const $=M[R];if(!$.used||($!==this.sourceCache&&this.resetTileLookupCache($.id),this._setupProxiedCoordsForOrtho($,u[R],k),$.usedForTerrain))continue;const F=u[R];$.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[p.id]=S.map(R=>new Qh(R,R.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(k),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const P={};this._visibleDemTiles=[];for(const R of this.proxyCoords){const $=this.terrainTileForTile[R.key];if(!$)continue;const F=$.tileID.key;F in P||(this._visibleDemTiles.push($),P[F]=F)}}_assignTerrainTiles(u){this._initializing||u.forEach(p=>{if(this.terrainTileForTile[p.key])return;const b=this._findTileCoveringTileID(p,this.sourceCache);b&&(this.terrainTileForTile[p.key]=b)})}_prepareDEMTextures(){const u=this.painter.context,p=u.gl;for(const b in this.terrainTileForTile){const S=this.terrainTileForTile[b],k=S.dem;!k||S.demTexture&&!S.needsDEMTextureUpload||(u.activeTexture.set(p.TEXTURE1),$m(this.painter,S,k))}}_prepareDemTileUniforms(u,p,b,S){if(!p||p.demTexture==null)return!1;const k=u.tileID.canonical,M=Math.pow(2,p.tileID.canonical.z-k.z),P=S||"";return b[`u_dem_tl${P}`]=[k.x*M%1,k.y*M%1],b[`u_dem_scale${P}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const u=this.painter.context,p=u.gl;if(!this._emptyDepthBufferTexture){const b=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(u,b,p.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let u=0;const p=this._visibleDemTiles.reduce((b,S)=>{if(!S.dem)return b;const k=S.dem.tree.minimums[0];return k>0&&u++,b+k},0);return u?p/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,p=u.gl;u.activeTexture.set(p.TEXTURE2);const b=this._getLoadedAreaMinimum(),S=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(b,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let k=this._emptyDEMTexture;return k?k.update(S,{premultiply:!1}):k=this._emptyDEMTexture=new o.Texture(u,S,p.RGBA,{premultiply:!1}),k}setupElevationDraw(u,p,b){const S=this.painter.context,k=S.gl,M=(P=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(P),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var P;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();let R=null,$=null,F=1;if(b&&b.morphing&&this._useVertexMorphing){const H=b.morphing.srcDemTile,ne=b.morphing.dstDemTile;F=b.morphing.phase,H&&ne&&(this._prepareDemTileUniforms(u,H,M,"_prev")&&($=H),this._prepareDemTileUniforms(u,ne,M)&&(R=ne))}if($&&R?(S.activeTexture.set(k.TEXTURE2),R.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE,k.NEAREST),S.activeTexture.set(k.TEXTURE4),$.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE,k.NEAREST),M.u_dem_lerp=F):(R=this.terrainTileForTile[u.tileID.key],S.activeTexture.set(k.TEXTURE2),(this._prepareDemTileUniforms(u,R,M)?R.demTexture:this.emptyDEMTexture).bind(k.NEAREST,k.CLAMP_TO_EDGE)),S.activeTexture.set(k.TEXTURE3),b&&b.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),b&&b.useMeterToDem&&R){const H=(1<<R.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=H}if(b&&b.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=b.labelPlaneMatrixInv),p.setTerrainUniformValues(S,M),this.painter.transform.projection.name==="globe"){const H=this.globeUniformValues(this.painter.transform,u.tileID.canonical,b&&b.useDenormalizedUpVectorScale);p.setGlobeUniformValues(S,H)}}globeUniformValues(u,p,b){const S=u.projection;return{u_tile_tl_up:S.upVector(p,0,0),u_tile_tr_up:S.upVector(p,o.EXTENT,0),u_tile_br_up:S.upVector(p,o.EXTENT,o.EXTENT),u_tile_bl_up:S.upVector(p,0,o.EXTENT),u_tile_up_scale:b?o.globeMetersToEcef(1):S.upVectorScale(p,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const p=this.painter,b=this.painter.context;u.length!==0&&(b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height]),p.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,k,M,P,R){if(S.transform.projection.name==="globe")(function($,F,H,ne,ae){const ue=$.context,le=ue.gl;let de,Z;const oe=$.options.showTerrainWireframe?2:0,ge=$.transform,ye=o.globeUseCustomAntiAliasing($,ue,ge),Te=(bt,qe)=>{if(Z===bt)return;const ct=[$l[bt],"PROJECTION_GLOBE_VIEW"];ye&&ct.push("CUSTOM_ANTIALIASING"),qe&&ct.push($l[oe]),de=$.useProgram("globeRaster",null,ct),Z=bt},Ie=$.colorModeForRenderPass(),Ce=new o.DepthMode(le.LEQUAL,o.DepthMode.ReadWrite,$.depthRangeFor3D);Sa.update(ae);const Le=o.calculateGlobeMercatorMatrix(ge),Re=[o.mercatorXfromLng(ge.center.lng),o.mercatorYfromLat(ge.center.lat)],Ge=oe?[!1,!0]:[!1],St=$.globeSharedBuffers,Ve=[ge.width*o.exported.devicePixelRatio,ge.height*o.exported.devicePixelRatio],ut=Float32Array.from(ge.globeMatrix),Ye={useDenormalizedUpVectorScale:!0};if(Ge.forEach(bt=>{const qe=$.transform,ct=Yh(qe.zoom)*F.exaggeration();Z=-1;const Tt=bt?le.LINES:le.TRIANGLES;for(const pt of ne){const It=H.getTile(pt),rn=o.StencilMode.disabled,vn=F.prevTerrainTileForTile[pt.key],Yt=F.terrainTileForTile[pt.key];Ac(vn,Yt)&&Sa.newMorphing(pt.key,vn,Yt,ae,250),ue.activeTexture.set(le.TEXTURE0),It.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const un=Sa.getMorphValuesForProxy(pt.key),Dn=un?1:0;un&&o.extend$1(Ye,{morphing:{srcDemTile:un.from,dstDemTile:un.to,phase:o.easeCubicInOut(un.phase)}});const Mn=o.tileCornersToBounds(pt.canonical),tn=o.getLatitudinalLod(Mn.getCenter().lat),Qn=o.getGridMatrix(pt.canonical,Mn,tn,qe.worldSize/qe._pixelsPerMercatorPixel),oi=o.globeNormalizeECEF(o.globeTileBounds(pt.canonical)),si=Kh(qe.projMatrix,ut,Le,oi,o.globeToMercatorTransition(qe.zoom),Re,qe.frustumCorners.TL,qe.frustumCorners.TR,qe.frustumCorners.BR,qe.frustumCorners.BL,qe.globeCenterInViewSpace,qe.globeRadius,Ve,ct,Qn);if(Te(Dn,bt),F.setupElevationDraw(It,de,Ye),$.prepareDrawProgram(ue,de,pt.toUnwrapped()),St){const[ai,Qr,Lr]=bt?St.getWirefameBuffers($.context,tn):St.getGridBuffers(tn,ct!==0);de.draw(ue,Tt,Ce,rn,Ie,o.CullFaceMode.backCCW,si,"globe_raster",ai,Qr,Lr)}}}),St){const bt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ye&&bt.push("CUSTOM_ANTIALIASING"),de=$.useProgram("globeRaster",null,bt);for(const qe of ne){const{x:ct,y:Tt,z:pt}=qe.canonical,It=Tt===0,rn=Tt===(1<<pt)-1,[vn,Yt,un,Dn]=St.getPoleBuffers(pt);if(Dn&&(It||rn)){const Mn=H.getTile(qe);ue.activeTexture.set(le.TEXTURE0),Mn.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE);let tn=o.globePoleMatrixForTile(pt,ct,ge);const Qn=o.globeNormalizeECEF(o.globeTileBounds(qe.canonical)),oi=(si,ai)=>si.draw(ue,le.TRIANGLES,Ce,o.StencilMode.disabled,Ie,o.CullFaceMode.disabled,Kh(ge.projMatrix,tn,tn,Qn,0,Re,ge.frustumCorners.TL,ge.frustumCorners.TR,ge.frustumCorners.BR,ge.frustumCorners.BL,ge.globeCenterInViewSpace,ge.globeRadius,Ve,0),"globe_pole_raster",ai,un,Dn);F.setupElevationDraw(Mn,de,Ye),$.prepareDrawProgram(ue,de,qe.toUnwrapped()),It&&oi(de,vn),rn&&(tn=o.scale(o.create(),tn,[1,-1,1]),oi(de,Yt))}}}})(S,k,M,P,R);else{const $=S.context,F=$.gl;let H,ne;const ae=S.options.showTerrainWireframe?2:0,ue=(ge,ye)=>{if(ne===ge)return;const Te=[$l[ge]];ye&&Te.push($l[ae]),H=S.useProgram("terrainRaster",null,Te),ne=ge},le=S.colorModeForRenderPass(),de=new o.DepthMode(F.LEQUAL,o.DepthMode.ReadWrite,S.depthRangeFor3D);Sa.update(R);const Z=S.transform,oe=Yh(Z.zoom)*k.exaggeration();(ae?[!1,!0]:[!1]).forEach(ge=>{ne=-1;const ye=ge?F.LINES:F.TRIANGLES,[Te,Ie]=ge?k.getWirefameBuffer():[k.gridIndexBuffer,k.gridSegments];for(const Ce of P){const Le=M.getTile(Ce),Re=o.StencilMode.disabled,Ge=k.prevTerrainTileForTile[Ce.key],St=k.terrainTileForTile[Ce.key];Ac(Ge,St)&&Sa.newMorphing(Ce.key,Ge,St,R,250),$.activeTexture.set(F.TEXTURE0),Le.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);const Ve=Sa.getMorphValuesForProxy(Ce.key),ut=Ve?1:0;let Ye;Ve&&(Ye={morphing:{srcDemTile:Ve.from,dstDemTile:Ve.to,phase:o.easeCubicInOut(Ve.phase)}});const bt=Ic(Ce.projMatrix,r0(Ce.canonical,Z.renderWorldCopies)?oe/10:oe);ue(ut,ge),k.setupElevationDraw(Le,H,Ye),S.prepareDrawProgram($,H,Ce.toUnwrapped()),H.draw($,ye,de,Re,le,o.CullFaceMode.backCCW,bt,"terrain_raster",k.gridBuffer,Te,Ie)}})}}(p,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,p.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(this._drapedRenderBatches.length===0)return u+1;this.renderingToTexture=!0;const p=this.painter,b=this.painter.context,S=this.proxySourceCache,k=this.proxiedCoords[S.id],M=this._drapedRenderBatches.shift(),P=[],R=p.style.order;let $=0;for(const F of k){const H=S.getTileByID(F.proxyTileKey),ne=S.proxyCachedFBO[F.key]?S.proxyCachedFBO[F.key][u]:void 0,ae=ne!==void 0?S.renderCache[ne]:this.pool[$++],ue=ne!==void 0;if(H.texture=ae.tex,ue&&!ae.dirty){P.push(H.tileID);continue}let le;b.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(b.clear({color:o.Color.transparent,stencil:0}),ae.dirty=!1);for(let de=M.start;de<=M.end;++de){const Z=p.style._layers[R[de]];if(Z.isHidden(p.transform.zoom))continue;const oe=p.style._getLayerSourceCache(Z),ge=oe?this.proxyToSource[F.key][oe.id]:[F];if(!ge)continue;const ye=ge;b.viewport.set([0,0,ae.fb.width,ae.fb.height]),le!==(oe?oe.id:null)&&(this._setupStencil(ae,ge,Z,oe),le=oe?oe.id:null),p.renderLayer(p,oe,Z,ye)}this.renderedToTile?(ae.dirty=!0,P.push(H.tileID)):ue||--$,$===5&&($=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,b.bindFramebuffer.set(null),b.viewport.set([0,0,p.width,p.height]),M.end+1}postRender(){}renderCacheEfficiency(u){const p=u.order.length;if(p===0)return{efficiency:100};let b,S=0,k=0,M=!1;for(let P=0;P<p;++P){const R=u._layers[u.order[P]];this._style.isLayerDraped(R)?(M&&++S,++k):M||(M=!0,b=R.id)}return k===0?{efficiency:100}:{efficiency:100*(1-S/k),firstUndrapedLayer:b}}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(p=>p.dem).forEach(p=>{u=Math.min(u,p.dem.tree.minimums[0])}),u===0?u:(u-30)*this._exaggeration}raycast(u,p,b){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(k=>k.dem).map(k=>{const M=k.tileID,P=1<<M.overscaledZ,{x:R,y:$}=M.canonical,F=R/P,H=(R+1)/P,ne=$/P,ae=($+1)/P;return{minx:F,miny:ne,maxx:H,maxy:ae,t:k.dem.tree.raycastRoot(F,ne,H,ae,u,p,b),tile:k}});S.sort((k,M)=>(k.t!==null?k.t:Number.MAX_VALUE)-(M.t!==null?M.t:Number.MAX_VALUE));for(const k of S){if(k.t==null)return null;const M=k.tile.dem.tree.raycast(k.minx,k.miny,k.maxx,k.maxy,u,p,b);if(M!=null)return M}return null}_createFBO(){const u=this.painter.context,p=u.gl,b=this.drapeBufferSize;u.activeTexture.set(p.TEXTURE0);const S=new o.Texture(u,{width:b[0],height:b[1],data:null},p.RGBA);S.bind(p.LINEAR,p.CLAMP_TO_EDGE);const k=u.createFramebuffer(b[0],b[1],!1);return k.colorAttachment.set(S.texture),k.depthAttachment=new Me(u,k.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,b[0],b[1]),this._stencilRef=0,k.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):k.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&!u.extTextureFilterAnisotropicForceOff&&p.texParameterf(p.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:k,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const p=this._style._layers[u],b=p.isHidden(this.painter.transform.zoom);return p.type==="custom"?!b&&p.shouldRedrape():!b&&p.hasTransition()})}_clearLineLayersFromRenderCache(){let u=!1;for(const b of this._style._getSources())if(b instanceof Bt){u=!0;break}if(!u)return;const p={};for(let b=0;b<this._style.order.length;++b){const S=this._style._layers[this._style.order[b]],k=this._style._getLayerSourceCache(S);if(k&&!p[k.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof o.ZoomDependentExpression){p[k.id]=!0;for(const M of this.proxyCoords){const P=this.proxyToSource[M.key][k.id];if(P)for(const R of P)this._clearRenderCacheForTile(k.id,R)}}}}_clearRasterLayersFromRenderCache(){let u=!1;for(const b in this._style._sourceCaches)if(this._style._sourceCaches[b]._source instanceof kt){u=!0;break}if(!u)return;const p={};for(let b=0;b<this._style.order.length;++b){const S=this._style._layers[this._style.order[b]],k=this._style._getLayerSourceCache(S);if(!k||p[k.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const M=S.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const R=this.proxyToSource[P.key][k.id];if(R)for(const $ of R){const F=Vm(k.getTile($),k.findLoadedParent($,0),k,this.painter.transform,M);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(k.id,$)}}}}_setupDrapedRenderBatches(){const u=this._style.order,p=u.length;if(p===0)return;const b=[];let S,k=0,M=this._style._layers[u[k]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++k<p;)M=this._style._layers[u[k]];for(;k<p;++k){const P=this._style._layers[u[k]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?S===void 0&&(S=k):S!==void 0&&(b.push({start:S,end:k-1}),S=void 0))}S!==void 0&&b.push({start:S,end:k-1}),this._drapedRenderBatches=b}_setupRenderCache(u){const p=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,p.renderCache.length>p.renderCachePool.length){const M=Object.values(p.proxyCachedFBO);p.proxyCachedFBO={};for(let P=0;P<M.length;++P){const R=Object.values(M[P]);p.renderCachePool.push(...R)}}return}this._clearRasterLayersFromRenderCache();const b=this.proxyCoords,S=this._tilesDirty;for(let M=b.length-1;M>=0;M--){const P=b[M];if(p.getTileByID(P.key),p.proxyCachedFBO[P.key]!==void 0){const R=u[P.key],$=this.proxyToSource[P.key];let F=0;for(const H in $){const ne=$[H],ae=R[H];if(!ae||ae.length!==ne.length||ne.some((ue,le)=>ue!==ae[le]||S[H]&&S[H].hasOwnProperty(ue.key))){F=-1;break}++F}for(const H in p.proxyCachedFBO[P.key])p.renderCache[p.proxyCachedFBO[P.key][H]].dirty=F<0||F!==Object.values(R).length}}const k=[...this._drapedRenderBatches];k.sort((M,P)=>P.end-P.start-(M.end-M.start));for(const M of k)for(const P of b){if(p.proxyCachedFBO[P.key])continue;let R=p.renderCachePool.pop();R===void 0&&p.renderCache.length<50&&(R=p.renderCache.length,p.renderCache.push(this._createFBO())),R!==void 0&&(p.proxyCachedFBO[P.key]={},p.proxyCachedFBO[P.key][M.start]=R,p.renderCache[R].dirty=!0)}this._tilesDirty={}}_setupStencil(u,p,b,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const k=this.painter.context,M=k.gl;if(p.length<=1)return void(this._overlapStencilType=!1);let P;if(b.isTileClipped())P=p.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(p[0].overscaledZ>p[p.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(k.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,b.isTileClipped()&&this._renderTileClippingMasks(p,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(u,p){const b=this.painter,S=this.painter.context,k=S.gl;b._tileClippingMaskIDs={},S.setColorMode(o.ColorMode.disabled),S.setDepthMode(o.DepthMode.disabled);const M=b.useProgram("clippingMask");for(const P of u){const R=b._tileClippingMaskIDs[P.key]=--p;M.draw(S,k.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:k.ALWAYS,mask:0},R,255,k.KEEP,k.KEEP,k.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,fd(P.projMatrix),"$clipping",b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}pointCoordinate(u){const p=this.painter.transform;if(u.x<0||u.x>p.width||u.y<0||u.y>p.height)return null;const b=[u.x,u.y,1,1];o.transformMat4$1(b,b,p.pixelMatrixInverse),o.scale$1(b,b,1/b[3]),b[0]/=p.worldSize,b[1]/=p.worldSize;const S=p._camera.position,k=o.mercatorZfromAltitude(1,p.center.lat),M=[S[0],S[1],S[2]/k,0],P=o.subtract([],b.slice(0,3),M);o.normalize(P,P);const R=this.raycast(M,P,this._exaggeration);return R!==null&&R?(o.scaleAndAdd(M,M,P,R),M[3]=M[2],M[2]*=k,M):null}drawDepth(){const u=this.painter,p=u.context,b=this.proxySourceCache,S=Math.ceil(u.width),k=Math.ceil(u.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===k||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=p.gl,P=p.createFramebuffer(S,k,!0);p.activeTexture.set(M.TEXTURE0);const R=new o.Texture(p,{width:S,height:k,data:null},M.RGBA);R.bind(M.NEAREST,M.CLAMP_TO_EDGE),P.colorAttachment.set(R.texture);const $=p.createRenderbuffer(p.gl.DEPTH_COMPONENT16,S,k);P.depthAttachment.set($),this._depthFBO=P,this._depthTexture=R}p.bindFramebuffer.set(this._depthFBO.framebuffer),p.viewport.set([0,0,S,k]),function(M,P,R,$){if(M.transform.projection.name==="globe")return;const F=M.context,H=F.gl;F.clear({depth:1});const ne=M.useProgram("terrainDepth"),ae=new o.DepthMode(H.LESS,o.DepthMode.ReadWrite,M.depthRangeFor3D);for(const ue of $){const le=R.getTile(ue),de=Ic(ue.projMatrix,0);P.setupElevationDraw(le,ne),ne.draw(F,H.TRIANGLES,ae,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,de,"terrain_depth",P.gridBuffer,P.gridIndexBuffer,P.gridNoSkirtSegments)}}(u,this,b,this.proxyCoords)}_setupProxiedCoordsForOrtho(u,p,b){if(u.getSource()instanceof In)return this._setupProxiedCoordsForImageSource(u,p,b);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const S=this.proxiedCoords[u.id]=[],k=this.proxyCoords;for(let P=0;P<k.length;P++){const R=k[P],$=this._findTileCoveringTileID(R,u);if($){const F=this._createProxiedId(R,$,b[R.key]&&b[R.key][u.id]);S.push(F),this.proxyToSource[R.key][u.id]=[F]}}let M=!1;for(let P=0;P<p.length;P++){const R=u.getTile(p[P]);if(!R||!R.hasData())continue;const $=this._findTileCoveringTileID(R.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==R.tileID.canonical.z){const F=this.proxyToSource[$.tileID.key][u.id],H=this._createProxiedId($.tileID,R,b[$.tileID.key]&&b[$.tileID.key][u.id]);F?F.splice(F.length-1,0,H):this.proxyToSource[$.tileID.key][u.id]=[H],S.push(H),M=!0}}this._sourceTilesOverlap[u.id]=M}_setupProxiedCoordsForImageSource(u,p,b){if(!u.getSource().loaded())return;const S=this.proxiedCoords[u.id]=[],k=this.proxyCoords,M=u.getSource(),P=new o.Point(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),R=M.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((F,H)=>(F.min.x=Math.min(F.min.x,H.x-P.x),F.min.y=Math.min(F.min.y,H.y-P.y),F.max.x=Math.max(F.max.x,H.x-P.x),F.max.y=Math.max(F.max.y,H.y-P.y),F),{min:new o.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(F,H)=>{const ne=F.wrap+F.canonical.x/(1<<F.canonical.z),ae=F.canonical.y/(1<<F.canonical.z),ue=o.EXTENT/(1<<F.canonical.z),le=H.wrap+H.canonical.x/(1<<H.canonical.z),de=H.canonical.y/(1<<H.canonical.z);return ne+ue<le+R.min.x||ne>le+R.max.x||ae+ue<de+R.min.y||ae>de+R.max.y};for(let F=0;F<k.length;F++){const H=k[F];for(let ne=0;ne<p.length;ne++){const ae=u.getTile(p[ne]);if(!ae||!ae.hasData()||$(H,ae.tileID))continue;const ue=this._createProxiedId(H,ae,b[H.key]&&b[H.key][u.id]),le=this.proxyToSource[H.key][u.id];le?le.push(ue):this.proxyToSource[H.key][u.id]=[ue],S.push(ue)}}}_createProxiedId(u,p,b){let S=this.orthoMatrix;if(b){const k=b.find(M=>M.key===p.tileID.key);if(k)return k}if(p.tileID.key!==u.key){const k=u.canonical.z-p.tileID.canonical.z;let M,P,R;S=o.create();const $=p.tileID.wrap-u.wrap<<u.overscaledZ;k>0?(M=o.EXTENT>>k,P=M*((p.tileID.canonical.x<<k)-u.canonical.x+$),R=M*((p.tileID.canonical.y<<k)-u.canonical.y)):(M=o.EXTENT<<-k,P=o.EXTENT*(p.tileID.canonical.x-(u.canonical.x+$<<-k)),R=o.EXTENT*(p.tileID.canonical.y-(u.canonical.y<<-k))),o.ortho(S,0,M,0,M,0,1),o.translate(S,S,[P,R,0])}return new Qh(p.tileID,u.key,S)}_findTileCoveringTileID(u,p){let b=p.getTile(u);if(b&&b.hasData())return b;const S=this._findCoveringTileCache[p.id],k=S[u.key];if(b=k?p.getTileByID(k):null,b&&b.hasData()||k===null)return b;let M=b?b.tileID:u,P=M.overscaledZ;const R=p.getSource().minzoom,$=[];if(!k){const H=p.getSource().maxzoom;if(u.canonical.z>=H){const ne=u.canonical.z-H;p.getSource().reparseOverscaled?(P=Math.max(u.canonical.z+2,p.transform.tileZoom),M=new o.OverscaledTileID(P,u.wrap,H,u.canonical.x>>ne,u.canonical.y>>ne)):ne!==0&&(P=H,M=new o.OverscaledTileID(P,u.wrap,H,u.canonical.x>>ne,u.canonical.y>>ne))}M.key!==u.key&&($.push(M.key),b=p.getTile(M))}const F=H=>{$.forEach(ne=>{S[ne]=H}),$.length=0};for(P-=1;P>=R&&(!b||!b.hasData());P--){b&&F(b.tileID.key);const H=M.calculateScaledKey(P);if(b=p.getTileByID(H),b&&b.hasData())break;const ne=S[H];if(ne===null)break;ne===void 0?$.push(H):b=p.getTileByID(ne)}return F(b?b.tileID.key:null),b&&b.hasData()?b:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,p){let b=this._tilesDirty[u];b||(b=this._tilesDirty[u]={}),b[p.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const u=function(p){let b=0;const S=new o.StructArrayLayout2ui4,k=131;for(let M=1;M<129;M++){for(let P=1;P<129;P++)b=M*k+P,S.emplaceBack(b,b+1),S.emplaceBack(b,b+k),S.emplaceBack(b+1,b+k),M===128&&S.emplaceBack(b+k,b+k+1);S.emplaceBack(b+1,b+1+k)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(u),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,u.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Vn{static cacheKey(u,p,b,S){let k=`${p}${S?S.cacheKey:""}`;for(const M of b)u.usedDefines.includes(M)&&(k+=`/${M}`);return k}constructor(u,p,b,S,k,M){const P=u.gl;this.program=P.createProgram();const R=function(Z){const oe=[];for(let ge=0;ge<Z.length;ge++){if(Z[ge]===null)continue;const ye=Z[ge].split(" ");oe.push(ye.pop())}return oe}(b.staticAttributes),$=S?S.getBinderAttributes():[],F=R.concat($);let H=S?S.defines():[];H=H.concat(M.map(Z=>`#define ${Z}`));const ne=u.isWebGL2?`#version 300 es
`:"",ae=ne+H.concat(u.extStandardDerivatives&&ne.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Bm):Bm,Bm,Xh,t0.fragmentSource,Tc.fragmentSource,b.fragmentSource).join(`
`),ue=ne+H.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Xh,t0.vertexSource,Tc.vertexSource,Zh.vertexSource,b.vertexSource).join(`
`),le=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(le,ae),P.compileShader(le),P.attachShader(this.program,le);const de=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(de,ue),P.compileShader(de),P.attachShader(this.program,de),this.attributes={},this.numAttributes=F.length;for(let Z=0;Z<this.numAttributes;Z++)F[Z]&&(P.bindAttribLocation(this.program,Z,F[Z]),this.attributes[F[Z]]=Z);P.linkProgram(this.program),P.deleteShader(de),P.deleteShader(le),this.fixedUniforms=k(u),this.binderUniforms=S?S.getUniforms(u):[],M.includes("TERRAIN")&&(this.terrainUniforms=(Z=>({u_dem:new o.Uniform1i(Z),u_dem_prev:new o.Uniform1i(Z),u_dem_unpack:new o.Uniform4f(Z),u_dem_tl:new o.Uniform2f(Z),u_dem_scale:new o.Uniform1f(Z),u_dem_tl_prev:new o.Uniform2f(Z),u_dem_scale_prev:new o.Uniform1f(Z),u_dem_size:new o.Uniform1f(Z),u_dem_lerp:new o.Uniform1f(Z),u_exaggeration:new o.Uniform1f(Z),u_depth:new o.Uniform1i(Z),u_depth_size_inv:new o.Uniform2f(Z),u_meter_to_dem:new o.Uniform1f(Z),u_label_plane_matrix_inv:new o.UniformMatrix4f(Z)}))(u)),M.includes("GLOBE")&&(this.globeUniforms=(Z=>({u_tile_tl_up:new o.Uniform3f(Z),u_tile_tr_up:new o.Uniform3f(Z),u_tile_br_up:new o.Uniform3f(Z),u_tile_bl_up:new o.Uniform3f(Z),u_tile_up_scale:new o.Uniform1f(Z)}))(u)),M.includes("FOG")&&(this.fogUniforms=(Z=>({u_fog_matrix:new o.UniformMatrix4f(Z),u_fog_range:new o.Uniform2f(Z),u_fog_color:new o.Uniform4f(Z),u_fog_horizon_blend:new o.Uniform1f(Z),u_fog_temporal_offset:new o.Uniform1f(Z),u_frustum_tl:new o.Uniform3f(Z),u_frustum_tr:new o.Uniform3f(Z),u_frustum_br:new o.Uniform3f(Z),u_frustum_bl:new o.Uniform3f(Z),u_globe_pos:new o.Uniform3f(Z),u_globe_radius:new o.Uniform1f(Z),u_globe_transition:new o.Uniform1f(Z),u_is_globe:new o.Uniform1i(Z),u_viewport:new o.Uniform2f(Z)}))(u))}}setTerrainUniformValues(u,p){if(!this.terrainUniforms)return;const b=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in p)b[S]&&b[S].set(this.program,S,p[S])}}setGlobeUniformValues(u,p){if(!this.globeUniforms)return;const b=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in p)b[S]&&b[S].set(this.program,S,p[S])}}setFogUniformValues(u,p){if(!this.fogUniforms)return;const b=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const S in p)b[S].set(this.program,S,p[S])}}draw(u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le){const de=u.gl;if(this.failedToCreate)return;u.program.set(this.program),u.setDepthMode(b),u.setStencilMode(S),u.setColorMode(k),u.setCullFace(M);for(const oe of Object.keys(this.fixedUniforms))this.fixedUniforms[oe].set(this.program,oe,P[oe]);ue&&ue.setUniforms(this.program,u,this.binderUniforms,ne,{zoom:ae});const Z={[de.LINES]:2,[de.TRIANGLES]:3,[de.LINE_STRIP]:1}[p];for(const oe of H.get()){const ge=oe.vaos||(oe.vaos={});(ge[R]||(ge[R]=new Ew)).bind(u,this,$,ue?ue.getPaintVertexBuffers():[],F,oe.vertexOffset,le||[]),de.drawElements(p,oe.primitiveLength*Z,de.UNSIGNED_SHORT,oe.primitiveOffset*Z*2)}}}function pd(y,u){const p=Math.pow(2,u.tileID.overscaledZ),b=u.tileSize*Math.pow(2,y.transform.tileZoom)/p,S=b*(u.tileID.canonical.x+u.tileID.wrap*p),k=b*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_tile_units_to_pixels:1/ft(u,1,y.transform.tileZoom),u_pixel_coord_upper:[S>>16,k>>16],u_pixel_coord_lower:[65535&S,65535&k]}}const o0=o.create(),Wm=(y,u,p,b,S,k,M,P,R,$,F)=>{const H=u.style.light,ne=H.properties.get("position"),ae=[ne.x,ne.y,ne.z],ue=o.create$1();H.properties.get("anchor")==="viewport"&&(o.fromRotation(ue,-u.transform.angle),o.transformMat3(ae,ae,ue));const le=H.properties.get("color"),de=u.transform,Z={u_matrix:y,u_lightpos:ae,u_lightintensity:H.properties.get("intensity"),u_lightcolor:[le.r,le.g,le.b],u_vertical_gradient:+p,u_opacity:b,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:o0,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:k};return de.projection.name==="globe"&&(Z.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],Z.u_zoom_transition=R,Z.u_inv_rot_matrix=F,Z.u_merc_center=$,Z.u_up_dir=de.projection.upVector(new o.CanonicalTileID(0,0,0),$[0]*o.EXTENT,$[1]*o.EXTENT),Z.u_height_lift=P),Z},s0=(y,u,p,b,S,k,M,P,R,$,F,H)=>{const ne=Wm(y,u,p,b,S,k,M,R,$,F,H),ae={u_height_factor:-Math.pow(2,M.overscaledZ)/P.tileSize/8};return o.extend(ne,pd(u,P),ae)},jl=y=>({u_matrix:y}),Gm=(y,u,p)=>o.extend(jl(y),pd(u,p)),kw=(y,u)=>({u_matrix:y,u_world:u}),Tw=(y,u,p,b)=>o.extend(Gm(y,u,p),{u_world:b}),Cw=o.create(),Hm=(y,u,p,b,S,k)=>{const M=y.transform,P=M.projection.name==="globe";let R;if(k.paint.get("circle-pitch-alignment")==="map")if(P){const F=o.globePixelsToTileUnits(M.zoom,u.canonical)*M._pixelsPerMercatorPixel;R=Float32Array.from([F,0,0,F])}else R=M.calculatePixelsToTileUnitsMatrix(p);else R=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const $={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:y.translatePosMatrix(u.projMatrix,p,k.paint.get("circle-translate"),k.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:R,u_inv_rot_matrix:Cw,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){$.u_inv_rot_matrix=b,$.u_merc_center=S,$.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],$.u_zoom_transition=o.globeToMercatorTransition(M.zoom);const F=S[0]*o.EXTENT,H=S[1]*o.EXTENT;$.u_up_dir=M.projection.upVector(new o.CanonicalTileID(0,0,0),F,H)}return $},Zm=y=>{const u=[];return y.paint.get("circle-pitch-alignment")==="map"&&u.push("PITCH_WITH_MAP"),y.paint.get("circle-pitch-scale")==="map"&&u.push("SCALE_WITH_MAP"),u},Xm=(y,u,p,b)=>{const S=o.EXTENT/p.tileSize;return{u_matrix:y,u_camera_to_center_distance:u.getCameraToCenterDistance(b),u_extrude_scale:[u.pixelsToGLUnits[0]/S,u.pixelsToGLUnits[1]/S]}},ef=(y,u,p=1)=>({u_matrix:y,u_color:u,u_overlay:0,u_overlay_scale:p}),a0=o.create(),l0=(y,u,p,b,S,k,M)=>{const P=y.transform,R=P.projection.name==="globe",$=R?o.globePixelsToTileUnits(P.zoom,u.canonical)*P._pixelsPerMercatorPixel:ft(p,1,k),F={u_matrix:u.projMatrix,u_extrude_scale:$,u_intensity:M,u_inv_rot_matrix:a0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){F.u_inv_rot_matrix=b,F.u_merc_center=S,F.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],F.u_zoom_transition=o.globeToMercatorTransition(P.zoom);const H=S[0]*o.EXTENT,ne=S[1]*o.EXTENT;F.u_up_dir=P.projection.upVector(new o.CanonicalTileID(0,0,0),H,ne)}return F},Iw=(y,u,p,b,S,k,M)=>{const P=y.transform,R=P.calculatePixelsToTileUnitsMatrix(u);return{u_matrix:Km(y,u,p,b),u_pixels_to_tile_units:R,u_device_pixel_ratio:k,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:gd(p)?u.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Mc(u,y.transform),u_alpha_discard_threshold:0,u_trim_offset:M}},md=(y,u,p,b,S)=>{const k=y.transform;return{u_matrix:Km(y,u,p,b),u_texsize:u.imageAtlasTexture.size,u_pixels_to_tile_units:k.calculatePixelsToTileUnitsMatrix(u),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:Mc(u,k),u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Mc(y,u){return 1/ft(y,1,u.tileZoom)}function Km(y,u,p,b){return y.translatePosMatrix(b||u.tileID.projMatrix,u,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}function gd(y){const u=y.paint.get("line-dasharray").value;return u.value||u.kind!=="constant"}const Ym=(y,u,p,b,S,k)=>{return{u_matrix:y,u_tl_parent:u,u_scale_parent:p,u_fade_t:b.mix,u_opacity:b.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(P=S.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(M=S.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:Ks(S.paint.get("raster-hue-rotate")),u_perspective_transform:k};var M,P};function Ks(y){y*=Math.PI/180;const u=Math.sin(y),p=Math.cos(y);return[(2*p+1)/3,(-Math.sqrt(3)*u-p+1)/3,(Math.sqrt(3)*u-p+1)/3]}const tf=o.create(),Jm=(y,u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le)=>{const de=S.transform,Z={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:de.cameraToCenterDistance,u_rotate_symbol:+p,u_aspect_ratio:de.width/de.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:k,u_label_plane_matrix:M,u_coord_matrix:P,u_is_text:+R,u_pitch_with_map:+b,u_texsize:$,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:tf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:tf,u_up_vector:[0,-1,0]};return le.name==="globe"&&(Z.u_tile_id=[F.canonical.x,F.canonical.y,1<<F.canonical.z],Z.u_zoom_transition=H,Z.u_inv_rot_matrix=ae,Z.u_merc_center=ne,Z.u_camera_forward=de._camera.forward(),Z.u_ecef_origin=o.globeECEFOrigin(de.globeMatrix,F.toUnwrapped()),Z.u_tile_matrix=Float32Array.from(de.globeMatrix),Z.u_up_vector=ue),Z},nf=(y,u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le,de)=>o.extend(Jm(y,u,p,b,S,k,M,P,R,$,H,ne,ae,ue,le,de),{u_gamma_scale:b?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+F}),c0=(y,u,p,b,S,k,M,P,R,$,F,H,ne,ae,ue,le)=>o.extend(nf(y,u,p,b,S,k,M,P,!0,R,!0,F,H,ne,ae,ue,le),{u_texsize_icon:$,u_texture_icon:1}),Qm=(y,u,p)=>({u_matrix:y,u_opacity:u,u_color:p}),Aw=(y,u,p,b,S)=>o.extend(function(k,M,P){const R=M.imageManager.getPattern(k.toString()),{width:$,height:F}=M.imageManager.getPixelSize(),H=Math.pow(2,P.tileID.overscaledZ),ne=P.tileSize*Math.pow(2,M.transform.tileZoom)/H,ae=ne*(P.tileID.canonical.x+P.tileID.wrap*H),ue=ne*P.tileID.canonical.y;return{u_image:0,u_pattern_tl:R.tl,u_pattern_br:R.br,u_texsize:[$,F],u_pattern_size:R.displaySize,u_tile_units_to_pixels:1/ft(P,1,M.transform.tileZoom),u_pixel_coord_upper:[ae>>16,ue>>16],u_pixel_coord_lower:[65535&ae,65535&ue]}}(b,p,S),{u_matrix:y,u_opacity:u}),eg={fillExtrusion:y=>({u_matrix:new o.UniformMatrix4f(y),u_lightpos:new o.Uniform3f(y),u_lightintensity:new o.Uniform1f(y),u_lightcolor:new o.Uniform3f(y),u_vertical_gradient:new o.Uniform1f(y),u_opacity:new o.Uniform1f(y),u_edge_radius:new o.Uniform1f(y),u_ao:new o.Uniform2f(y),u_tile_id:new o.Uniform3f(y),u_zoom_transition:new o.Uniform1f(y),u_inv_rot_matrix:new o.UniformMatrix4f(y),u_merc_center:new o.Uniform2f(y),u_up_dir:new o.Uniform3f(y),u_height_lift:new o.Uniform1f(y)}),fillExtrusionPattern:y=>({u_matrix:new o.UniformMatrix4f(y),u_lightpos:new o.Uniform3f(y),u_lightintensity:new o.Uniform1f(y),u_lightcolor:new o.Uniform3f(y),u_vertical_gradient:new o.Uniform1f(y),u_height_factor:new o.Uniform1f(y),u_edge_radius:new o.Uniform1f(y),u_ao:new o.Uniform2f(y),u_tile_id:new o.Uniform3f(y),u_zoom_transition:new o.Uniform1f(y),u_inv_rot_matrix:new o.UniformMatrix4f(y),u_merc_center:new o.Uniform2f(y),u_up_dir:new o.Uniform3f(y),u_height_lift:new o.Uniform1f(y),u_image:new o.Uniform1i(y),u_texsize:new o.Uniform2f(y),u_pixel_coord_upper:new o.Uniform2f(y),u_pixel_coord_lower:new o.Uniform2f(y),u_tile_units_to_pixels:new o.Uniform1f(y),u_opacity:new o.Uniform1f(y)}),fill:y=>({u_matrix:new o.UniformMatrix4f(y)}),fillPattern:y=>({u_matrix:new o.UniformMatrix4f(y),u_image:new o.Uniform1i(y),u_texsize:new o.Uniform2f(y),u_pixel_coord_upper:new o.Uniform2f(y),u_pixel_coord_lower:new o.Uniform2f(y),u_tile_units_to_pixels:new o.Uniform1f(y)}),fillOutline:y=>({u_matrix:new o.UniformMatrix4f(y),u_world:new o.Uniform2f(y)}),fillOutlinePattern:y=>({u_matrix:new o.UniformMatrix4f(y),u_world:new o.Uniform2f(y),u_image:new o.Uniform1i(y),u_texsize:new o.Uniform2f(y),u_pixel_coord_upper:new o.Uniform2f(y),u_pixel_coord_lower:new o.Uniform2f(y),u_tile_units_to_pixels:new o.Uniform1f(y)}),circle:y=>({u_camera_to_center_distance:new o.Uniform1f(y),u_extrude_scale:new o.UniformMatrix2f(y),u_device_pixel_ratio:new o.Uniform1f(y),u_matrix:new o.UniformMatrix4f(y),u_inv_rot_matrix:new o.UniformMatrix4f(y),u_merc_center:new o.Uniform2f(y),u_tile_id:new o.Uniform3f(y),u_zoom_transition:new o.Uniform1f(y),u_up_dir:new o.Uniform3f(y)}),collisionBox:y=>({u_matrix:new o.UniformMatrix4f(y),u_camera_to_center_distance:new o.Uniform1f(y),u_extrude_scale:new o.Uniform2f(y)}),collisionCircle:y=>({u_matrix:new o.UniformMatrix4f(y),u_inv_matrix:new o.UniformMatrix4f(y),u_camera_to_center_distance:new o.Uniform1f(y),u_viewport_size:new o.Uniform2f(y)}),debug:y=>({u_color:new o.UniformColor(y),u_matrix:new o.UniformMatrix4f(y),u_overlay:new o.Uniform1i(y),u_overlay_scale:new o.Uniform1f(y)}),clippingMask:y=>({u_matrix:new o.UniformMatrix4f(y)}),heatmap:y=>({u_extrude_scale:new o.Uniform1f(y),u_intensity:new o.Uniform1f(y),u_matrix:new o.UniformMatrix4f(y),u_inv_rot_matrix:new o.UniformMatrix4f(y),u_merc_center:new o.Uniform2f(y),u_tile_id:new o.Uniform3f(y),u_zoom_transition:new o.Uniform1f(y),u_up_dir:new o.Uniform3f(y)}),heatmapTexture:y=>({u_image:new o.Uniform1i(y),u_color_ramp:new o.Uniform1i(y),u_opacity:new o.Uniform1f(y)}),hillshade:y=>({u_matrix:new o.UniformMatrix4f(y),u_image:new o.Uniform1i(y),u_latrange:new o.Uniform2f(y),u_light:new o.Uniform2f(y),u_shadow:new o.UniformColor(y),u_highlight:new o.UniformColor(y),u_accent:new o.UniformColor(y)}),hillshadePrepare:y=>({u_matrix:new o.UniformMatrix4f(y),u_image:new o.Uniform1i(y),u_dimension:new o.Uniform2f(y),u_zoom:new o.Uniform1f(y),u_unpack:new o.Uniform4f(y)}),line:y=>({u_matrix:new o.UniformMatrix4f(y),u_pixels_to_tile_units:new o.UniformMatrix2f(y),u_device_pixel_ratio:new o.Uniform1f(y),u_units_to_pixels:new o.Uniform2f(y),u_dash_image:new o.Uniform1i(y),u_gradient_image:new o.Uniform1i(y),u_image_height:new o.Uniform1f(y),u_texsize:new o.Uniform2f(y),u_tile_units_to_pixels:new o.Uniform1f(y),u_alpha_discard_threshold:new o.Uniform1f(y),u_trim_offset:new o.Uniform2f(y)}),linePattern:y=>({u_matrix:new o.UniformMatrix4f(y),u_texsize:new o.Uniform2f(y),u_pixels_to_tile_units:new o.UniformMatrix2f(y),u_device_pixel_ratio:new o.Uniform1f(y),u_image:new o.Uniform1i(y),u_units_to_pixels:new o.Uniform2f(y),u_tile_units_to_pixels:new o.Uniform1f(y),u_alpha_discard_threshold:new o.Uniform1f(y)}),raster:y=>({u_matrix:new o.UniformMatrix4f(y),u_tl_parent:new o.Uniform2f(y),u_scale_parent:new o.Uniform1f(y),u_fade_t:new o.Uniform1f(y),u_opacity:new o.Uniform1f(y),u_image0:new o.Uniform1i(y),u_image1:new o.Uniform1i(y),u_brightness_low:new o.Uniform1f(y),u_brightness_high:new o.Uniform1f(y),u_saturation_factor:new o.Uniform1f(y),u_contrast_factor:new o.Uniform1f(y),u_spin_weights:new o.Uniform3f(y),u_perspective_transform:new o.Uniform2f(y)}),symbolIcon:y=>({u_is_size_zoom_constant:new o.Uniform1i(y),u_is_size_feature_constant:new o.Uniform1i(y),u_size_t:new o.Uniform1f(y),u_size:new o.Uniform1f(y),u_camera_to_center_distance:new o.Uniform1f(y),u_rotate_symbol:new o.Uniform1i(y),u_aspect_ratio:new o.Uniform1f(y),u_fade_change:new o.Uniform1f(y),u_matrix:new o.UniformMatrix4f(y),u_label_plane_matrix:new o.UniformMatrix4f(y),u_coord_matrix:new o.UniformMatrix4f(y),u_is_text:new o.Uniform1i(y),u_pitch_with_map:new o.Uniform1i(y),u_texsize:new o.Uniform2f(y),u_tile_id:new o.Uniform3f(y),u_zoom_transition:new o.Uniform1f(y),u_inv_rot_matrix:new o.UniformMatrix4f(y),u_merc_center:new o.Uniform2f(y),u_camera_forward:new o.Uniform3f(y),u_tile_matrix:new o.UniformMatrix4f(y),u_up_vector:new o.Uniform3f(y),u_ecef_origin:new o.Uniform3f(y),u_texture:new o.Uniform1i(y)}),symbolSDF:y=>({u_is_size_zoom_constant:new o.Uniform1i(y),u_is_size_feature_constant:new o.Uniform1i(y),u_size_t:new o.Uniform1f(y),u_size:new o.Uniform1f(y),u_camera_to_center_distance:new o.Uniform1f(y),u_rotate_symbol:new o.Uniform1i(y),u_aspect_ratio:new o.Uniform1f(y),u_fade_change:new o.Uniform1f(y),u_matrix:new o.UniformMatrix4f(y),u_label_plane_matrix:new o.UniformMatrix4f(y),u_coord_matrix:new o.UniformMatrix4f(y),u_is_text:new o.Uniform1i(y),u_pitch_with_map:new o.Uniform1i(y),u_texsize:new o.Uniform2f(y),u_texture:new o.Uniform1i(y),u_gamma_scale:new o.Uniform1f(y),u_device_pixel_ratio:new o.Uniform1f(y),u_tile_id:new o.Uniform3f(y),u_zoom_transition:new o.Uniform1f(y),u_inv_rot_matrix:new o.UniformMatrix4f(y),u_merc_center:new o.Uniform2f(y),u_camera_forward:new o.Uniform3f(y),u_tile_matrix:new o.UniformMatrix4f(y),u_up_vector:new o.Uniform3f(y),u_ecef_origin:new o.Uniform3f(y),u_is_halo:new o.Uniform1i(y)}),symbolTextAndIcon:y=>({u_is_size_zoom_constant:new o.Uniform1i(y),u_is_size_feature_constant:new o.Uniform1i(y),u_size_t:new o.Uniform1f(y),u_size:new o.Uniform1f(y),u_camera_to_center_distance:new o.Uniform1f(y),u_rotate_symbol:new o.Uniform1i(y),u_aspect_ratio:new o.Uniform1f(y),u_fade_change:new o.Uniform1f(y),u_matrix:new o.UniformMatrix4f(y),u_label_plane_matrix:new o.UniformMatrix4f(y),u_coord_matrix:new o.UniformMatrix4f(y),u_is_text:new o.Uniform1i(y),u_pitch_with_map:new o.Uniform1i(y),u_texsize:new o.Uniform2f(y),u_texsize_icon:new o.Uniform2f(y),u_texture:new o.Uniform1i(y),u_texture_icon:new o.Uniform1i(y),u_gamma_scale:new o.Uniform1f(y),u_device_pixel_ratio:new o.Uniform1f(y),u_is_halo:new o.Uniform1i(y)}),background:y=>({u_matrix:new o.UniformMatrix4f(y),u_opacity:new o.Uniform1f(y),u_color:new o.UniformColor(y)}),backgroundPattern:y=>({u_matrix:new o.UniformMatrix4f(y),u_opacity:new o.Uniform1f(y),u_image:new o.Uniform1i(y),u_pattern_tl:new o.Uniform2f(y),u_pattern_br:new o.Uniform2f(y),u_texsize:new o.Uniform2f(y),u_pattern_size:new o.Uniform2f(y),u_pixel_coord_upper:new o.Uniform2f(y),u_pixel_coord_lower:new o.Uniform2f(y),u_tile_units_to_pixels:new o.Uniform1f(y)}),terrainRaster:jm,terrainDepth:jm,skybox:y=>({u_matrix:new o.UniformMatrix4f(y),u_sun_direction:new o.Uniform3f(y),u_cubemap:new o.Uniform1i(y),u_opacity:new o.Uniform1f(y),u_temporal_offset:new o.Uniform1f(y)}),skyboxGradient:y=>({u_matrix:new o.UniformMatrix4f(y),u_color_ramp:new o.Uniform1i(y),u_center_direction:new o.Uniform3f(y),u_radius:new o.Uniform1f(y),u_opacity:new o.Uniform1f(y),u_temporal_offset:new o.Uniform1f(y)}),skyboxCapture:y=>({u_matrix_3f:new o.UniformMatrix3f(y),u_sun_direction:new o.Uniform3f(y),u_sun_intensity:new o.Uniform1f(y),u_color_tint_r:new o.Uniform4f(y),u_color_tint_m:new o.Uniform4f(y),u_luminance:new o.Uniform1f(y)}),globeRaster:y=>({u_proj_matrix:new o.UniformMatrix4f(y),u_globe_matrix:new o.UniformMatrix4f(y),u_normalize_matrix:new o.UniformMatrix4f(y),u_merc_matrix:new o.UniformMatrix4f(y),u_zoom_transition:new o.Uniform1f(y),u_merc_center:new o.Uniform2f(y),u_image0:new o.Uniform1i(y),u_grid_matrix:new o.UniformMatrix3f(y),u_skirt_height:new o.Uniform1f(y),u_frustum_tl:new o.Uniform3f(y),u_frustum_tr:new o.Uniform3f(y),u_frustum_br:new o.Uniform3f(y),u_frustum_bl:new o.Uniform3f(y),u_globe_pos:new o.Uniform3f(y),u_globe_radius:new o.Uniform1f(y),u_viewport:new o.Uniform2f(y)}),globeAtmosphere:y=>({u_frustum_tl:new o.Uniform3f(y),u_frustum_tr:new o.Uniform3f(y),u_frustum_br:new o.Uniform3f(y),u_frustum_bl:new o.Uniform3f(y),u_horizon:new o.Uniform1f(y),u_transition:new o.Uniform1f(y),u_fadeout_range:new o.Uniform1f(y),u_color:new o.Uniform4f(y),u_high_color:new o.Uniform4f(y),u_space_color:new o.Uniform4f(y),u_star_intensity:new o.Uniform1f(y),u_star_density:new o.Uniform1f(y),u_star_size:new o.Uniform1f(y),u_temporal_offset:new o.Uniform1f(y),u_horizon_angle:new o.Uniform1f(y),u_rotation_matrix:new o.UniformMatrix4f(y)})};let rf;function yd(y,u,p,b,S,k,M){const P=y.context,R=P.gl,$=y.transform,F=y.useProgram("collisionBox"),H=[];let ne=0,ae=0;for(let ye=0;ye<b.length;ye++){const Te=b[ye],Ie=u.getTile(Te),Ce=Ie.getBucket(p);if(!Ce)continue;const Le=is(Te,Ce,$);let Re=Le;S[0]===0&&S[1]===0||(Re=y.translatePosMatrix(Le,Ie,S,k));const Ge=M?Ce.textCollisionBox:Ce.iconCollisionBox,St=Ce.collisionCircleArray;if(St.length>0){const Ve=o.create(),ut=Re;o.mul(Ve,Ce.placementInvProjMatrix,$.glCoordMatrix),o.mul(Ve,Ve,Ce.placementViewportMatrix),H.push({circleArray:St,circleOffset:ae,transform:ut,invTransform:Ve,projection:Ce.getProjection()}),ne+=St.length/4,ae=ne}Ge&&(y.terrain&&y.terrain.setupElevationDraw(Ie,F),F.draw(P,R.LINES,o.DepthMode.disabled,o.StencilMode.disabled,y.colorModeForRenderPass(),o.CullFaceMode.disabled,Xm(Re,$,Ie,Ce.getProjection()),p.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,$.zoom,null,[Ge.collisionVertexBuffer,Ge.collisionVertexBufferExt]))}if(!M||!H.length)return;const ue=y.useProgram("collisionCircle"),le=new o.StructArrayLayout2f1f2i16;le.resize(4*ne),le._trim();let de=0;for(const ye of H)for(let Te=0;Te<ye.circleArray.length/4;Te++){const Ie=4*Te,Ce=ye.circleArray[Ie+0],Le=ye.circleArray[Ie+1],Re=ye.circleArray[Ie+2],Ge=ye.circleArray[Ie+3];le.emplace(de++,Ce,Le,Re,Ge,0),le.emplace(de++,Ce,Le,Re,Ge,1),le.emplace(de++,Ce,Le,Re,Ge,2),le.emplace(de++,Ce,Le,Re,Ge,3)}(!rf||rf.length<2*ne)&&(rf=function(ye){const Te=2*ye,Ie=new o.StructArrayLayout3ui6;Ie.resize(Te),Ie._trim();for(let Ce=0;Ce<Te;Ce++){const Le=6*Ce;Ie.uint16[Le+0]=4*Ce+0,Ie.uint16[Le+1]=4*Ce+1,Ie.uint16[Le+2]=4*Ce+2,Ie.uint16[Le+3]=4*Ce+2,Ie.uint16[Le+4]=4*Ce+3,Ie.uint16[Le+5]=4*Ce+0}return Ie}(ne));const Z=P.createIndexBuffer(rf,!0),oe=P.createVertexBuffer(le,o.collisionCircleLayout.members,!0);for(const ye of H){const Te={u_matrix:ye.transform,u_inv_matrix:ye.invTransform,u_camera_to_center_distance:(ge=$).getCameraToCenterDistance(ye.projection),u_viewport_size:[ge.width,ge.height]};ue.draw(P,R.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,y.colorModeForRenderPass(),o.CullFaceMode.disabled,Te,p.id,oe,Z,o.SegmentVector.simpleSegment(0,2*ye.circleOffset,ye.circleArray.length,ye.circleArray.length/2),null,$.zoom)}var ge;oe.destroy(),Z.destroy()}const u0=o.create();function tg({width:y,height:u,anchor:p,textOffset:b,textScale:S},k){const{horizontalAlign:M,verticalAlign:P}=o.getAnchorAlignment(p),R=-(M-.5)*y,$=-(P-.5)*u,F=o.evaluateVariableOffset(p,b);return new o.Point((R/S+F[0])*k,($/S+F[1])*k)}function Mw(y,u,p,b,S,k,M,P,R,$,F){const H=y.text.placedSymbolArray,ne=y.text.dynamicLayoutVertexArray,ae=y.icon.dynamicLayoutVertexArray,ue={},le=y.getProjection(),de=Ii(P,le,k),Z=k.elevation,oe=le.upVectorScale(P.canonical,k.center.lat,k.worldSize).metersToTile;ne.clear();for(let ge=0;ge<H.length;ge++){const ye=H.get(ge),{tileAnchorX:Te,tileAnchorY:Ie,numGlyphs:Ce}=ye,Le=ye.hidden||!ye.crossTileID||y.allowVerticalPlacement&&!ye.placedOrientation?null:b[ye.crossTileID];if(Le){let Re=0,Ge=0,St=0;if(Z){const It=Z?Z.getAtTileOffset(P,Te,Ie):0,[rn,vn,Yt]=le.upVector(P.canonical,Te,Ie);Re=It*rn*oe,Ge=It*vn*oe,St=It*Yt*oe}let[Ve,ut,Ye,bt]=Dr(ye.projectedAnchorX+Re,ye.projectedAnchorY+Ge,ye.projectedAnchorZ+St,p?de:M);const qe=Kv(k.getCameraToCenterDistance(le),bt);let ct=S.evaluateSizeForFeature(y.textSizeData,$,ye)*qe/o.ONE_EM;p&&(ct*=y.tilePixelRatio/R);const Tt=tg(Le,ct);p?({x:Ve,y:ut,z:Ye}=le.projectTilePoint(Te+Tt.x,Ie+Tt.y,P.canonical),[Ve,ut,Ye]=Dr(Ve+Re,ut+Ge,Ye+St,M)):(u&&Tt._rotate(-k.angle),Ve+=Tt.x,ut+=Tt.y,Ye=0);const pt=y.allowVerticalPlacement&&ye.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let It=0;It<Ce;It++)o.addDynamicAttributes(ne,Ve,ut,Ye,pt);F&&ye.associatedIconIndex>=0&&(ue[ye.associatedIconIndex]={x:Ve,y:ut,z:Ye,angle:pt})}else ks(Ce,ne)}if(F){ae.clear();const ge=y.icon.placedSymbolArray;for(let ye=0;ye<ge.length;ye++){const Te=ge.get(ye),{numGlyphs:Ie}=Te,Ce=ue[ye];if(Te.hidden||!Ce)ks(Ie,ae);else{const{x:Le,y:Re,z:Ge,angle:St}=Ce;for(let Ve=0;Ve<Ie;Ve++)o.addDynamicAttributes(ae,Le,Re,Ge,St)}}y.icon.dynamicLayoutVertexBuffer.updateData(ae)}y.text.dynamicLayoutVertexBuffer.updateData(ne)}function ng(y,u,p){return p.iconsInText&&u?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function d0(y,u,p,b,S,k,M,P,R,$,F,H){const ne=y.context,ae=ne.gl,ue=y.transform,le=P==="map",de=R==="map",Z=le&&p.layout.get("symbol-placement")!=="point",oe=le&&!de&&!Z,ge=p.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ye=!1;const Te=y.depthModeForSublayer(0,o.DepthMode.ReadOnly),Ie=[o.mercatorXfromLng(ue.center.lng),o.mercatorYfromLat(ue.center.lat)],Ce=p.layout.get("text-variable-anchor"),Le=ue.projection.name==="globe",Re=[],Ge=[0,-1,0];let St=Ge;!Le&&!ue.mercatorFromTransition||le||(St=function(Ve){const ut=Ve._camera.getWorldToCamera(Ve.worldSize,1),Ye=o.multiply([],ut,Ve.globeMatrix);o.invert(Ye,Ye);const bt=[0,0,0],qe=[0,1,0,0];return o.transformMat4$1(qe,qe,Ye),bt[0]=qe[0],bt[1]=qe[1],bt[2]=qe[2],o.normalize(bt,bt),bt}(ue));for(const Ve of b){const ut=u.getTile(Ve),Ye=ut.getBucket(p);if(!Ye||Ye.projection.name==="mercator"&&Le)continue;const bt=S?Ye.text:Ye.icon;if(!bt||Ye.fullyClipped||!bt.segments.get().length)continue;const qe=bt.programConfigurations.get(p.id),ct=S||Ye.sdfIcons,Tt=S?Ye.textSizeData:Ye.iconSizeData,pt=de||ue.pitch!==0,It=o.evaluateSizeForZoom(Tt,ue.zoom);let rn,vn,Yt,un,Dn=[0,0],Mn=null;if(S)vn=ut.glyphAtlasTexture,Yt=ae.LINEAR,rn=ut.glyphAtlasTexture.size,Ye.iconsInText&&(Dn=ut.imageAtlasTexture.size,Mn=ut.imageAtlasTexture,un=pt||y.options.rotating||y.options.zooming||Tt.kind==="composite"||Tt.kind==="camera"?ae.LINEAR:ae.NEAREST);else{const Ta=p.layout.get("icon-size").constantOr(0)!==1||Ye.iconsNeedLinear;vn=ut.imageAtlasTexture,Yt=ct||y.options.rotating||y.options.zooming||Ta||pt?ae.LINEAR:ae.NEAREST,rn=ut.imageAtlasTexture.size}const tn=Ye.projection.name==="globe",Qn=tn?St:Ge,oi=tn?o.globeToMercatorTransition(ue.zoom):0,si=Ii(Ve,Ye.getProjection(),ue),ai=ue.calculatePixelsToTileUnitsMatrix(ut),Qr=st(si,ut.tileID.canonical,de,le,ue,Ye.getProjection(),ai),Lr=y.terrain&&de&&Z?o.invert(o.create(),Qr):u0,ls=ar(si,ut.tileID.canonical,de,le,ue,Ye.getProjection(),ai),Js=Ce&&Ye.hasTextData(),Ai=p.layout.get("icon-text-fit")!=="none"&&Js&&Ye.hasIconData();if(Z){const Ta=ue.elevation,al=Ta?Ta.getAtTileOffsetFunc(Ve,ue.center.lat,ue.worldSize,Ye.getProjection()):null,Gl=va(si,ut.tileID.canonical,de,le,ue,Ye.getProjection(),ai);Im(Ye,si,y,S,Gl,ls,de,$,al,Ve)}const li=Z||S&&Ce||Ai,Gn=y.translatePosMatrix(si,ut,k,M),lr=li?u0:Qr,po=y.translatePosMatrix(ls,ut,k,M,!0),Si=Ye.getProjection().createInversionMatrix(ue,Ve.canonical),ko=[];y.terrainRenderModeElevated()&&de&&ko.push("PITCH_WITH_MAP_TERRAIN"),tn&&ko.push("PROJECTION_GLOBE_VIEW"),li&&ko.push("PROJECTED_POS_ON_VIEWPORT");const _f=ct&&p.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Wl;Wl=ct?Ye.iconsInText?c0(Tt.kind,It,oe,de,y,Gn,lr,po,rn,Dn,Ve,oi,Ie,Si,Qn,Ye.getProjection()):nf(Tt.kind,It,oe,de,y,Gn,lr,po,S,rn,!0,Ve,oi,Ie,Si,Qn,Ye.getProjection()):Jm(Tt.kind,It,oe,de,y,Gn,lr,po,S,rn,Ve,oi,Ie,Si,Qn,Ye.getProjection());const Id={program:y.useProgram(ng(ct,S,Ye),qe,ko),buffers:bt,uniformValues:Wl,atlasTexture:vn,atlasTextureIcon:Mn,atlasInterpolation:Yt,atlasInterpolationIcon:un,isSDF:ct,hasHalo:_f,tile:ut,labelPlaneMatrixInv:Lr};if(ge&&Ye.canOverlap){ye=!0;const Ta=bt.segments.get();for(const al of Ta)Re.push({segments:new o.SegmentVector([al]),sortKey:al.sortKey,state:Id})}else Re.push({segments:bt.segments,sortKey:0,state:Id})}ye&&Re.sort((Ve,ut)=>Ve.sortKey-ut.sortKey);for(const Ve of Re){const ut=Ve.state;if(y.terrain&&y.terrain.setupElevationDraw(ut.tile,ut.program,{useDepthForOcclusion:!Le,labelPlaneMatrixInv:ut.labelPlaneMatrixInv}),ne.activeTexture.set(ae.TEXTURE0),ut.atlasTexture.bind(ut.atlasInterpolation,ae.CLAMP_TO_EDGE),ut.atlasTextureIcon&&(ne.activeTexture.set(ae.TEXTURE1),ut.atlasTextureIcon&&ut.atlasTextureIcon.bind(ut.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),ut.isSDF){const Ye=ut.uniformValues;ut.hasHalo&&(Ye.u_is_halo=1,vd(ut.buffers,Ve.segments,p,y,ut.program,Te,F,H,Ye)),Ye.u_is_halo=0}vd(ut.buffers,Ve.segments,p,y,ut.program,Te,F,H,ut.uniformValues)}}function vd(y,u,p,b,S,k,M,P,R){const $=b.context,F=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.globeExtVertexBuffer];S.draw($,$.gl.TRIANGLES,k,M,P,o.CullFaceMode.disabled,R,p.id,y.layoutVertexBuffer,y.indexBuffer,u,p.paint,b.transform.zoom,y.programConfigurations.get(p.id),F)}function h0(y,u,p,b,S,k,M){const P=y.context.gl,R=p.paint.get("fill-pattern"),$=R&&R.constantOr(1);let F,H,ne,ae,ue;M?(H=$&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=P.LINES):(H=$?"fillPattern":"fill",F=P.TRIANGLES);for(const le of b){const de=u.getTile(le);if($&&!de.patternsLoaded())continue;const Z=de.getBucket(p);if(!Z)continue;y.prepareDrawTile();const oe=Z.programConfigurations.get(p.id),ge=y.useProgram(H,oe);$&&(y.context.activeTexture.set(P.TEXTURE0),de.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),oe.updatePaintBuffers());const ye=R.constantOr(null);if(ye&&de.imageAtlas){const Ie=de.imageAtlas.patternPositions[ye.toString()];Ie&&oe.setConstantPatternPositions(Ie)}const Te=y.translatePosMatrix(le.projMatrix,de,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(M){ae=Z.indexBuffer2,ue=Z.segments2;const Ie=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[P.drawingBufferWidth,P.drawingBufferHeight];ne=H==="fillOutlinePattern"&&$?Tw(Te,y,de,Ie):kw(Te,Ie)}else ae=Z.indexBuffer,ue=Z.segments,ne=$?Gm(Te,y,de):jl(Te);y.prepareDrawProgram(y.context,ge,le.toUnwrapped()),ge.draw(y.context,F,S,y.stencilModeForClipping(le),k,o.CullFaceMode.disabled,ne,p.id,Z.layoutVertexBuffer,ae,ue,p.paint,y.transform.zoom,oe)}}function of(y,u,p,b,S,k,M){const P=y.context,R=P.gl,$=y.transform,F=p.paint.get("fill-extrusion-pattern"),H=F.constantOr(1),ne=p.paint.get("fill-extrusion-opacity"),ae=[p.paint.get("fill-extrusion-ambient-occlusion-intensity"),p.paint.get("fill-extrusion-ambient-occlusion-radius")],ue=p.layout.get("fill-extrusion-edge-radius"),le=ue>0&&!p.paint.get("fill-extrusion-rounded-roof"),de=le?0:ue,Z=$.projection.name==="globe"?o.fillExtrusionHeightLift():0,oe=$.projection.name==="globe",ge=oe?o.globeToMercatorTransition($.zoom):0,ye=[o.mercatorXfromLng($.center.lng),o.mercatorYfromLat($.center.lat)],Te=[];oe&&Te.push("PROJECTION_GLOBE_VIEW"),ae[0]>0&&Te.push("FAUX_AO"),le&&Te.push("ZERO_ROOF_RADIUS");for(const Ie of b){const Ce=u.getTile(Ie),Le=Ce.getBucket(p);if(!Le||Le.projection.name!==$.projection.name)continue;const Re=Le.programConfigurations.get(p.id),Ge=y.useProgram(H?"fillExtrusionPattern":"fillExtrusion",Re,Te);if(y.terrain){const ct=y.terrain;if(y.style.terrainSetForDrapingOnly())ct.setupElevationDraw(Ce,Ge,{useMeterToDem:!0});else{if(!Le.enableTerrain)continue;if(ct.setupElevationDraw(Ce,Ge,{useMeterToDem:!0}),f0(P,u,Ie,Le,p,ct),!Le.centroidVertexBuffer){const Tt=Ge.attributes.a_centroid_pos;Tt!==void 0&&R.vertexAttrib2f(Tt,0,0)}}}H&&(y.context.activeTexture.set(R.TEXTURE0),Ce.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),Re.updatePaintBuffers());const St=F.constantOr(null);if(St&&Ce.imageAtlas){const ct=Ce.imageAtlas.patternPositions[St.toString()];ct&&Re.setConstantPatternPositions(ct)}const Ve=y.translatePosMatrix(Ie.projMatrix,Ce,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),ut=$.projection.createInversionMatrix($,Ie.canonical),Ye=p.paint.get("fill-extrusion-vertical-gradient"),bt=H?s0(Ve,y,Ye,ne,ae,de,Ie,Ce,Z,ge,ye,ut):Wm(Ve,y,Ye,ne,ae,de,Ie,Z,ge,ye,ut);y.prepareDrawProgram(P,Ge,Ie.toUnwrapped());const qe=[];y.terrain&&qe.push(Le.centroidVertexBuffer),oe&&qe.push(Le.layoutVertexExtBuffer),Ge.draw(P,P.gl.TRIANGLES,S,k,M,o.CullFaceMode.backCCW,bt,p.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,p.paint,y.transform.zoom,Re,qe)}}function f0(y,u,p,b,S,k){const M=[Z=>{let oe=Z.canonical.x-1,ge=Z.wrap;return oe<0&&(oe=(1<<Z.canonical.z)-1,ge--),new o.OverscaledTileID(Z.overscaledZ,ge,Z.canonical.z,oe,Z.canonical.y)},Z=>{let oe=Z.canonical.x+1,ge=Z.wrap;return oe===1<<Z.canonical.z&&(oe=0,ge++),new o.OverscaledTileID(Z.overscaledZ,ge,Z.canonical.z,oe,Z.canonical.y)},Z=>new o.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,(Z.canonical.y===0?1<<Z.canonical.z:Z.canonical.y)-1),Z=>new o.OverscaledTileID(Z.overscaledZ,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y===(1<<Z.canonical.z)-1?0:Z.canonical.y+1)],P=Z=>{const oe=u.getSource().minzoom,ge=Te=>{const Ie=u.getTileByID(Te);if(Ie&&Ie.hasData())return Ie.getBucket(S)},ye=[0,-1,1];for(const Te of ye){if(Z.overscaledZ+Te<oe)continue;const Ie=ge(Z.calculateScaledKey(Z.overscaledZ+Te));if(Ie)return Ie}},R=[0,0,0],$=(Z,oe)=>(R[0]=Math.min(Z.min.y,oe.min.y),R[1]=Math.max(Z.max.y,oe.max.y),R[2]=o.EXTENT-oe.min.x>Z.max.x?oe.min.x-o.EXTENT:Z.max.x,R),F=(Z,oe)=>(R[0]=Math.min(Z.min.x,oe.min.x),R[1]=Math.max(Z.max.x,oe.max.x),R[2]=o.EXTENT-oe.min.y>Z.max.y?oe.min.y-o.EXTENT:Z.max.y,R),H=[(Z,oe)=>$(Z,oe),(Z,oe)=>$(oe,Z),(Z,oe)=>F(Z,oe),(Z,oe)=>F(oe,Z)],ne=new o.Point(0,0);let ae,ue,le;const de=(Z,oe,ge,ye,Te)=>{const Ie=[[ye?ge:Z,ye?Z:ge,0],[ye?ge:oe,ye?oe:ge,0]],Ce=Te<0?o.EXTENT+Te:Te,Le=[ye?Ce:(Z+oe)/2,ye?(Z+oe)/2:Ce,0];return ge===0&&Te<0||ge!==0&&Te>0?k.getForTilePoints(le,[Le],!0,ue):Ie.push(Le),k.getForTilePoints(p,Ie,!0,ae),Math.max(Ie[0][2],Ie[1][2],Le[2])/k.exaggeration()};for(let Z=0;Z<4;Z++){const oe=(Z<2?1:5)-Z,ge=b.borders[Z];if(ge.length===0)continue;const ye=le=M[Z](p),Te=P(ye);if(!(Te&&Te instanceof o.FillExtrusionBucket&&Te.enableTerrain)||b.borderDoneWithNeighborZ[Z]===Te.canonical.z&&Te.borderDoneWithNeighborZ[oe]===b.canonical.z||(ue=k.findDEMTileFor(ye),!ue||!ue.dem))continue;if(!ae){const Re=k.findDEMTileFor(p);if(!Re||!Re.dem)return;ae=Re}const Ie=Te.borders[oe];let Ce=0;const Le=Te.borderDoneWithNeighborZ[oe]!==b.canonical.z;if(b.canonical.z===Te.canonical.z){for(let Re=0;Re<ge.length;Re++){const Ge=b.featuresOnBorder[ge[Re]],St=Ge.borders[Z];let Ve;for(;Ce<Ie.length&&(Ve=Te.featuresOnBorder[Ie[Ce]],!(Ve.borders[oe][1]>St[0]+3));)Le&&Te.encodeCentroid(void 0,Ve,!1),Ce++;if(Ve&&Ce<Ie.length){const ut=Ce;let Ye=0;for(;!(Ve.borders[oe][0]>St[1]-3)&&(Ye++,++Ce!==Ie.length);)Ve=Te.featuresOnBorder[Ie[Ce]];if(Ve=Te.featuresOnBorder[Ie[ut]],Ge.intersectsCount()>1||Ve.intersectsCount()>1||Ye!==1){Ye!==1&&(Ce=ut),b.encodeCentroid(void 0,Ge,!1),Le&&Te.encodeCentroid(void 0,Ve,!1);continue}const bt=H[Z](Ge,Ve),qe=Z%2?o.EXTENT-1:0;ne.x=de(bt[0],Math.min(o.EXTENT-1,bt[1]),qe,Z<2,bt[2]),ne.y=0,b.encodeCentroid(ne,Ge,!1),Le&&Te.encodeCentroid(ne,Ve,!1)}else b.encodeCentroid(void 0,Ge,!1)}b.borderDoneWithNeighborZ[Z]=Te.canonical.z,b.needsCentroidUpdate=!0,Le&&(Te.borderDoneWithNeighborZ[oe]=b.canonical.z,Te.needsCentroidUpdate=!0)}else{for(const Re of ge)b.encodeCentroid(void 0,b.featuresOnBorder[Re],!1);if(Le){for(const Re of Ie)Te.encodeCentroid(void 0,Te.featuresOnBorder[Re],!1);Te.borderDoneWithNeighborZ[oe]=b.canonical.z,Te.needsCentroidUpdate=!0}b.borderDoneWithNeighborZ[Z]=Te.canonical.z,b.needsCentroidUpdate=!0}}(b.needsCentroidUpdate||!b.centroidVertexBuffer&&b.centroidVertexArray.length!==0)&&b.uploadCentroid(y)}const Pc=new o.Color(1,0,0,1),Pw=new o.Color(0,1,0,1),Ow=new o.Color(0,0,1,1),Dw=new o.Color(1,0,1,1),Rw=new o.Color(0,1,1,1);function Lw(y,u,p){const b=y.context,S=y.transform,k=b.gl,M=S.projection.name==="globe",P=M?["PROJECTION_GLOBE_VIEW"]:null;let R=p.projMatrix;if(M&&o.globeToMercatorTransition(S.zoom)>0){const Ge=o.transitionTileAABBinECEF(p.canonical,S),St=o.globeDenormalizeECEF(Ge);R=o.multiply(new Float32Array(16),S.globeMatrix,St),o.multiply(R,S.projMatrix,R)}const $=y.useProgram("debug",null,P),F=u.getTileByID(p.key);y.terrain&&y.terrain.setupElevationDraw(F,$);const H=o.DepthMode.disabled,ne=o.StencilMode.disabled,ae=y.colorModeForRenderPass(),ue="$debug";b.activeTexture.set(k.TEXTURE0),y.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),M?F._makeGlobeTileDebugBuffers(y.context,S):F._makeDebugTileBoundsBuffers(y.context,S.projection);const le=F._tileDebugBuffer||y.debugBuffer,de=F._tileDebugIndexBuffer||y.debugIndexBuffer,Z=F._tileDebugSegments||y.debugSegments;$.draw(b,k.LINE_STRIP,H,ne,ae,o.CullFaceMode.disabled,ef(R,o.Color.red),ue,le,de,Z,null,null,null,[F._globeTileDebugBorderBuffer]);const oe=F.latestRawTileData,ge=Math.floor((oe&&oe.byteLength||0)/1024),ye=u.getTile(p).tileSize,Te=512/Math.min(ye,512)*(p.overscaledZ/S.zoom)*.5;let Ie=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Ie+=` => ${p.overscaledZ}`),Ie+=` ${ge}kb`,function(Ge,St){Ge.initDebugOverlayCanvas();const Ve=Ge.debugOverlayCanvas,ut=Ge.context.gl,Ye=Ge.debugOverlayCanvas.getContext("2d");Ye.clearRect(0,0,Ve.width,Ve.height),Ye.shadowColor="white",Ye.shadowBlur=2,Ye.lineWidth=1.5,Ye.strokeStyle="white",Ye.textBaseline="top",Ye.font="bold 36px Open Sans, sans-serif",Ye.fillText(St,5,5),Ye.strokeText(St,5,5),Ge.debugOverlayTexture.update(Ve),Ge.debugOverlayTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE)}(y,Ie);const Ce=F._tileDebugTextBuffer||y.debugBuffer,Le=F._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,Re=F._tileDebugTextSegments||y.debugSegments;$.draw(b,k.TRIANGLES,H,ne,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,ef(R,o.Color.transparent,Te),ue,Ce,Le,Re,null,null,null,[F._globeTileDebugTextBuffer])}function p0(y,u,p,b){Oc(y,0,u+p/2,y.transform.width,p,b)}function sf(y,u,p,b){Oc(y,u-p/2,0,p,y.transform.height,b)}function Oc(y,u,p,b,S,k){const M=y.context,P=M.gl;P.enable(P.SCISSOR_TEST),P.scissor(u*o.exported.devicePixelRatio,p*o.exported.devicePixelRatio,b*o.exported.devicePixelRatio,S*o.exported.devicePixelRatio),M.clear({color:k}),P.disable(P.SCISSOR_TEST)}const m0=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:g0}=m0;function Ea(y,u,p,b){y.emplaceBack(u,p,b)}class af{constructor(u){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Ea(this.vertexArray,-1,-1,1),Ea(this.vertexArray,1,-1,1),Ea(this.vertexArray,-1,1,1),Ea(this.vertexArray,1,1,1),Ea(this.vertexArray,-1,-1,-1),Ea(this.vertexArray,1,-1,-1),Ea(this.vertexArray,-1,1,-1),Ea(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,g0),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function ss(y,u,p,b,S,k){const M=y.gl,P=u.paint.get("sky-atmosphere-color"),R=u.paint.get("sky-atmosphere-halo-color"),$=u.paint.get("sky-atmosphere-sun-intensity"),F=((H,ne,ae,ue,le)=>({u_matrix_3f:H,u_sun_direction:ne,u_sun_intensity:ae,u_color_tint_r:[ue.r,ue.g,ue.b,ue.a],u_color_tint_m:[le.r,le.g,le.b,le.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),b),S,$,P,R);M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+k,u.skyboxTexture,0),p.draw(y,M.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,F,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const bd=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class y0{constructor(u){const p=new o.StructArrayLayout5f20;p.emplaceBack(-1,1,1,0,0),p.emplaceBack(1,1,1,1,0),p.emplaceBack(1,-1,1,1,1),p.emplaceBack(-1,-1,1,0,1);const b=new o.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(p,bd.members),this.indexBuffer=u.createIndexBuffer(b),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Vl={symbol:function(y,u,p,b,S){if(y.renderPass!=="translucent")return;const k=o.StencilMode.disabled,M=y.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(P,R,$,F,H,ne,ae){const ue=R.transform,le=H==="map",de=ne==="map";for(const Z of P){const oe=F.getTile(Z),ge=oe.getBucket($);if(!ge||!ge.text||!ge.text.segments.get().length)continue;const ye=o.evaluateSizeForZoom(ge.textSizeData,ue.zoom),Te=Ii(Z,ge.getProjection(),ue),Ie=ue.calculatePixelsToTileUnitsMatrix(oe),Ce=st(Te,oe.tileID.canonical,de,le,ue,ge.getProjection(),Ie),Le=$.layout.get("icon-text-fit")!=="none"&&ge.hasIconData();if(ye){const Re=Math.pow(2,ue.zoom-oe.tileID.overscaledZ);Mw(ge,le,de,ae,o.symbolSize,ue,Ce,Z,Re,ye,Le)}}}(b,y,p,u,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),S),p.paint.get("icon-opacity").constantOr(1)!==0&&d0(y,u,p,b,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),k,M),p.paint.get("text-opacity").constantOr(1)!==0&&d0(y,u,p,b,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),k,M),u.map.showCollisionBoxes&&(yd(y,u,p,b,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),yd(y,u,p,b,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(y,u,p,b){if(y.renderPass!=="translucent")return;const S=p.paint.get("circle-opacity"),k=p.paint.get("circle-stroke-width"),M=p.paint.get("circle-stroke-opacity"),P=p.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)===0&&(k.constantOr(1)===0||M.constantOr(1)===0))return;const R=y.context,$=R.gl,F=y.transform,H=y.depthModeForSublayer(0,o.DepthMode.ReadOnly),ne=o.StencilMode.disabled,ae=y.colorModeForRenderPass(),ue=F.projection.name==="globe",le=[o.mercatorXfromLng(F.center.lng),o.mercatorYfromLat(F.center.lat)],de=[];for(let oe=0;oe<b.length;oe++){const ge=b[oe],ye=u.getTile(ge),Te=ye.getBucket(p);if(!Te||Te.projection.name!==F.projection.name)continue;const Ie=Te.programConfigurations.get(p.id),Ce=Zm(p);ue&&Ce.push("PROJECTION_GLOBE_VIEW");const Le=y.useProgram("circle",Ie,Ce),Re=Te.layoutVertexBuffer,Ge=Te.globeExtVertexBuffer,St=Te.indexBuffer,Ve=F.projection.createInversionMatrix(F,ge.canonical),ut={programConfiguration:Ie,program:Le,layoutVertexBuffer:Re,globeExtVertexBuffer:Ge,indexBuffer:St,uniformValues:Hm(y,ge,ye,Ve,le,p),tile:ye};if(P){const Ye=Te.segments.get();for(const bt of Ye)de.push({segments:new o.SegmentVector([bt]),sortKey:bt.sortKey,state:ut})}else de.push({segments:Te.segments,sortKey:0,state:ut})}P&&de.sort((oe,ge)=>oe.sortKey-ge.sortKey);const Z={useDepthForOcclusion:!ue};for(const oe of de){const{programConfiguration:ge,program:ye,layoutVertexBuffer:Te,globeExtVertexBuffer:Ie,indexBuffer:Ce,uniformValues:Le,tile:Re}=oe.state,Ge=oe.segments;y.terrain&&y.terrain.setupElevationDraw(Re,ye,Z),y.prepareDrawProgram(R,ye,Re.tileID.toUnwrapped()),ye.draw(R,$.TRIANGLES,H,ne,ae,o.CullFaceMode.disabled,Le,p.id,Te,Ce,Ge,p.paint,F.zoom,ge,[Ie])}},heatmap:function(y,u,p,b){if(p.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const S=y.context,k=S.gl,M=o.StencilMode.disabled,P=new o.ColorMode([k.ONE,k.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(ae,ue,le,de){const Z=ae.gl,oe=ue.width*de,ge=ue.height*de;ae.activeTexture.set(Z.TEXTURE1),ae.viewport.set([0,0,oe,ge]);let ye=le.heatmapFbo;if(!ye||ye&&(ye.width!==oe||ye.height!==ge)){ye&&ye.destroy();const Te=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,Te),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),ye=le.heatmapFbo=ae.createFramebuffer(oe,ge,!1),function(Ie,Ce,Le,Re,Ge,St){const Ve=Ie.gl;Ve.texImage2D(Ve.TEXTURE_2D,0,Ie.isWebGL2&&Ie.extRenderToTextureHalfFloat?Ve.RGBA16F:Ve.RGBA,Ge,St,0,Ve.RGBA,Ie.extRenderToTextureHalfFloat?Ie.isWebGL2?Ve.HALF_FLOAT:Ie.extTextureHalfFloat.HALF_FLOAT_OES:Ve.UNSIGNED_BYTE,null),Re.colorAttachment.set(Le)}(ae,0,Te,ye,oe,ge)}else Z.bindTexture(Z.TEXTURE_2D,ye.colorAttachment.get()),ae.bindFramebuffer.set(ye.framebuffer)})(S,y,p,y.transform.projection.name==="globe"?.5:.25),S.clear({color:o.Color.transparent});const R=y.transform,$=R.projection.name==="globe",F=$?["PROJECTION_GLOBE_VIEW"]:null,H=$?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,ne=[o.mercatorXfromLng(R.center.lng),o.mercatorYfromLat(R.center.lat)];for(let ae=0;ae<b.length;ae++){const ue=b[ae];if(u.hasRenderableParent(ue))continue;const le=u.getTile(ue),de=le.getBucket(p);if(!de||de.projection.name!==R.projection.name)continue;const Z=de.programConfigurations.get(p.id),oe=y.useProgram("heatmap",Z,F),{zoom:ge}=y.transform;y.terrain&&y.terrain.setupElevationDraw(le,oe),y.prepareDrawProgram(S,oe,ue.toUnwrapped());const ye=R.projection.createInversionMatrix(R,ue.canonical);oe.draw(S,k.TRIANGLES,o.DepthMode.disabled,M,P,H,l0(y,ue,le,ye,ne,ge,p.paint.get("heatmap-intensity")),p.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,p.paint,y.transform.zoom,Z,$?[de.globeExtVertexBuffer]:null)}S.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(S,k){const M=S.context,P=M.gl,R=k.heatmapFbo;if(!R)return;M.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,R.colorAttachment.get()),M.activeTexture.set(P.TEXTURE1);let $=k.colorRampTexture;$||($=k.colorRampTexture=new o.Texture(M,k.colorRamp,P.RGBA)),$.bind(P.LINEAR,P.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(M,P.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,S.colorModeForRenderPass(),o.CullFaceMode.disabled,((F,H,ne,ae)=>({u_image:0,u_color_ramp:1,u_opacity:H.paint.get("heatmap-opacity")}))(0,k),k.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,k.paint,S.transform.zoom)}(y,p))},line:function(y,u,p,b){if(y.renderPass!=="translucent")return;const S=p.paint.get("line-opacity"),k=p.paint.get("line-width");if(S.constantOr(1)===0||k.constantOr(1)===0)return;const M=y.depthModeForSublayer(0,o.DepthMode.ReadOnly),P=y.colorModeForRenderPass(),R=y.terrain&&y.terrain.renderingToTexture?1:o.exported.devicePixelRatio,$=p.paint.get("line-dasharray"),F=$.constantOr(1),H=p.layout.get("line-cap"),ne=p.paint.get("line-pattern"),ae=ne.constantOr(1),ue=p.paint.get("line-gradient"),le=ae?"linePattern":"line",de=y.context,Z=de.gl,oe=(ye=>{const Te=[];gd(ye)&&Te.push("RENDER_LINE_DASH"),ye.paint.get("line-gradient")&&Te.push("RENDER_LINE_GRADIENT");const Ie=ye.paint.get("line-trim-offset");Ie[0]===0&&Ie[1]===0||Te.push("RENDER_LINE_TRIM_OFFSET");const Ce=ye.paint.get("line-pattern").constantOr(1),Le=ye.paint.get("line-opacity").constantOr(1)!==1;return!Ce&&Le&&Te.push("RENDER_LINE_ALPHA_DISCARD"),Te})(p);let ge=oe.includes("RENDER_LINE_ALPHA_DISCARD");y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(ge=!1);for(const ye of b){const Te=u.getTile(ye);if(ae&&!Te.patternsLoaded())continue;const Ie=Te.getBucket(p);if(!Ie)continue;y.prepareDrawTile();const Ce=Ie.programConfigurations.get(p.id),Le=y.useProgram(le,Ce,oe),Re=ne.constantOr(null);if(Re&&Te.imageAtlas){const ct=Te.imageAtlas.patternPositions[Re.toString()];ct&&Ce.setConstantPatternPositions(ct)}const Ge=$.constantOr(null),St=H.constantOr(null);if(!ae&&Ge&&St&&Te.lineAtlas){const ct=Te.lineAtlas.getDash(Ge,St);ct&&Ce.setConstantPatternPositions(ct)}let[Ve,ut]=p.paint.get("line-trim-offset");(St==="round"||St==="square")&&Ve!==ut&&(Ve===0&&(Ve-=1),ut===1&&(ut+=1));const Ye=y.terrain?ye.projMatrix:null,bt=ae?md(y,Te,p,Ye,R):Iw(y,Te,p,Ye,Ie.lineClipsArray.length,R,[Ve,ut]);if(ue){const ct=Ie.gradients[p.id];let Tt=ct.texture;if(p.gradientVersion!==ct.version){let pt=256;if(p.stepInterpolant){const It=u.getSource().maxzoom,rn=ye.canonical.z===It?Math.ceil(1<<y.transform.maxZoom-ye.canonical.z):1;pt=o.clamp(o.nextPowerOfTwo(Ie.maxLineLength/o.EXTENT*1024*rn),256,de.maxTextureSize)}ct.gradient=o.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:pt,image:ct.gradient||void 0,clips:Ie.lineClipsArray}),ct.texture?ct.texture.update(ct.gradient):ct.texture=new o.Texture(de,ct.gradient,Z.RGBA),ct.version=p.gradientVersion,Tt=ct.texture}de.activeTexture.set(Z.TEXTURE1),Tt.bind(p.stepInterpolant?Z.NEAREST:Z.LINEAR,Z.CLAMP_TO_EDGE)}F&&(de.activeTexture.set(Z.TEXTURE0),Te.lineAtlasTexture.bind(Z.LINEAR,Z.REPEAT),Ce.updatePaintBuffers()),ae&&(de.activeTexture.set(Z.TEXTURE0),Te.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Ce.updatePaintBuffers()),y.prepareDrawProgram(de,Le,ye.toUnwrapped());const qe=ct=>{Le.draw(de,Z.TRIANGLES,M,ct,P,o.CullFaceMode.disabled,bt,p.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,p.paint,y.transform.zoom,Ce,[Ie.layoutVertexBuffer2])};if(ge){const ct=y.stencilModeForClipping(ye).ref;ct===0&&y.terrain&&de.clear({stencil:0});const Tt={func:Z.EQUAL,mask:255};bt.u_alpha_discard_threshold=.8,qe(new o.StencilMode(Tt,ct,255,Z.KEEP,Z.KEEP,Z.INVERT)),bt.u_alpha_discard_threshold=0,qe(new o.StencilMode(Tt,ct,255,Z.KEEP,Z.KEEP,Z.KEEP))}else qe(y.stencilModeForClipping(ye))}ge&&(y.resetStencilClippingMasks(),y.terrain&&de.clear({stencil:0}))},fill:function(y,u,p,b){const S=p.paint.get("fill-color"),k=p.paint.get("fill-opacity");if(k.constantOr(1)===0)return;const M=y.colorModeForRenderPass(),P=p.paint.get("fill-pattern"),R=y.opaquePassEnabledForLayer()&&!P.constantOr(1)&&S.constantOr(o.Color.transparent).a===1&&k.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===R){const $=y.depthModeForSublayer(1,y.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);h0(y,u,p,b,$,M,!1)}if(y.renderPass==="translucent"&&p.paint.get("fill-antialias")){const $=y.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);h0(y,u,p,b,$,M,!0)}},"fill-extrusion":function(y,u,p,b){const S=p.paint.get("fill-extrusion-opacity");if(S!==0&&y.renderPass==="translucent"){const k=new o.DepthMode(y.context.gl.LEQUAL,o.DepthMode.ReadWrite,y.depthRangeFor3D);if(S!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))of(y,u,p,b,k,o.StencilMode.disabled,o.ColorMode.disabled),of(y,u,p,b,k,y.stencilModeFor3D(),y.colorModeForRenderPass()),y.resetStencilClippingMasks();else{const M=y.colorModeForRenderPass();of(y,u,p,b,k,o.StencilMode.disabled,M)}}},hillshade:function(y,u,p,b){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const S=y.context,k=y.depthModeForSublayer(0,o.DepthMode.ReadOnly),M=y.colorModeForRenderPass(),P=y.terrain&&y.terrain.renderingToTexture,[R,$]=y.renderPass!=="translucent"||P?[{},b]:y.stencilConfigForOverlap(b);for(const F of $){const H=u.getTile(F);if(H.needsHillshadePrepare&&y.renderPass==="offscreen")i0(y,H,p,k,o.StencilMode.disabled,M);else if(y.renderPass==="translucent"){const ne=P&&y.terrain?y.terrain.stencilModeForRTTOverlap(F):R[F.overscaledZ];n0(y,F,H,p,k,ne,M)}}S.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,u,p,b,S,k){if(y.renderPass!=="translucent"||p.paint.get("raster-opacity")===0||!b.length)return;const M=y.context,P=M.gl,R=u.getSource(),$=y.useProgram("raster"),F=y.colorModeForRenderPass(),H=y.terrain&&y.terrain.renderingToTexture,[ne,ae]=R instanceof In||H?[{},b]:y.stencilConfigForOverlap(b),ue=ae[ae.length-1].overscaledZ,le=!y.options.moving;for(const de of ae){const Z=H?o.DepthMode.disabled:y.depthModeForSublayer(de.overscaledZ-ue,p.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,P.LESS),oe=de.toUnwrapped(),ge=u.getTile(de);if(H&&(!ge||!ge.hasData()))continue;const ye=H?de.projMatrix:y.transform.calculateProjMatrix(oe,le),Te=y.terrain&&H?y.terrain.stencilModeForRTTOverlap(de):ne[de.overscaledZ],Ie=k?0:p.paint.get("raster-fade-duration");ge.registerFadeDuration(Ie);const Ce=u.findLoadedParent(de,0),Le=Vm(ge,Ce,u,y.transform,Ie);let Re,Ge;y.terrain&&y.terrain.prepareDrawTile();const St=p.paint.get("raster-resampling")==="nearest"?P.NEAREST:P.LINEAR;M.activeTexture.set(P.TEXTURE0),ge.texture.bind(St,P.CLAMP_TO_EDGE),M.activeTexture.set(P.TEXTURE1),Ce?(Ce.texture.bind(St,P.CLAMP_TO_EDGE),Re=Math.pow(2,Ce.tileID.overscaledZ-ge.tileID.overscaledZ),Ge=[ge.tileID.canonical.x*Re%1,ge.tileID.canonical.y*Re%1]):ge.texture.bind(St,P.CLAMP_TO_EDGE),ge.texture.useMipmap&&M.extTextureFilterAnisotropic&&y.transform.pitch>20&&P.texParameterf(P.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax);const Ve=Ym(ye,Ge||[0,0],Re||1,Le,p,R instanceof In?R.perspectiveTransform:[0,0]);if(y.prepareDrawProgram(M,$,oe),R instanceof In)R.boundsBuffer&&R.boundsSegments&&$.draw(M,P.TRIANGLES,Z,o.StencilMode.disabled,F,o.CullFaceMode.disabled,Ve,p.id,R.boundsBuffer,y.quadTriangleIndexBuffer,R.boundsSegments);else{const{tileBoundsBuffer:ut,tileBoundsIndexBuffer:Ye,tileBoundsSegments:bt}=y.getTileBoundsBuffers(ge);$.draw(M,P.TRIANGLES,Z,Te,F,o.CullFaceMode.disabled,Ve,p.id,ut,Ye,bt)}}y.resetStencilClippingMasks()},background:function(y,u,p,b){const S=p.paint.get("background-color"),k=p.paint.get("background-opacity");if(k===0)return;const M=y.context,P=M.gl,R=y.transform,$=R.tileSize,F=p.paint.get("background-pattern");if(y.isPatternMissing(F))return;const H=!F&&S.a===1&&k===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==H)return;const ne=o.StencilMode.disabled,ae=y.depthModeForSublayer(0,H==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),ue=y.colorModeForRenderPass(),le=y.useProgram(F?"backgroundPattern":"background");let de,Z=b;Z||(de=y.getBackgroundTiles(),Z=Object.values(de).map(oe=>oe.tileID)),F&&(M.activeTexture.set(P.TEXTURE0),y.imageManager.bind(y.context));for(const oe of Z){const ge=oe.toUnwrapped(),ye=b?oe.projMatrix:y.transform.calculateProjMatrix(ge);y.prepareDrawTile();const Te=u?u.getTile(oe):de?de[oe.key]:new o.Tile(oe,$,R.zoom,y),Ie=F?Aw(ye,k,y,F,{tileID:oe,tileSize:$}):Qm(ye,k,S);y.prepareDrawProgram(M,le,ge);const{tileBoundsBuffer:Ce,tileBoundsIndexBuffer:Le,tileBoundsSegments:Re}=y.getTileBoundsBuffers(Te);le.draw(M,P.TRIANGLES,ae,ne,ue,o.CullFaceMode.disabled,Ie,p.id,Ce,Le,Re)}},sky:function(y,u,p){const b=y.transform,S=b.projection.name==="mercator"||b.projection.name==="globe"?1:o.smoothstep(7,8,b.zoom),k=p.paint.get("sky-opacity")*S;if(k===0)return;const M=y.context,P=p.paint.get("sky-type"),R=new o.DepthMode(M.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),$=y.frameCounter/1e3%1;P==="atmosphere"?y.renderPass==="offscreen"?p.needsSkyboxCapture(y)&&(function(F,H,ne,ae){const ue=F.context,le=ue.gl;let de=H.skyboxFbo;if(!de){de=H.skyboxFbo=ue.createFramebuffer(32,32,!1),H.skyboxGeometry=new af(ue),H.skyboxTexture=ue.gl.createTexture(),le.bindTexture(le.TEXTURE_CUBE_MAP,H.skyboxTexture),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_CUBE_MAP,le.TEXTURE_MAG_FILTER,le.LINEAR);for(let ye=0;ye<6;++ye)le.texImage2D(le.TEXTURE_CUBE_MAP_POSITIVE_X+ye,0,le.RGBA,32,32,0,le.RGBA,le.UNSIGNED_BYTE,null)}ue.bindFramebuffer.set(de.framebuffer),ue.viewport.set([0,0,32,32]);const Z=H.getCenter(F,!0),oe=F.useProgram("skyboxCapture"),ge=new Float64Array(16);o.identity(ge),o.rotateY(ge,ge,.5*-Math.PI),ss(ue,H,oe,ge,Z,0),o.identity(ge),o.rotateY(ge,ge,.5*Math.PI),ss(ue,H,oe,ge,Z,1),o.identity(ge),o.rotateX(ge,ge,.5*-Math.PI),ss(ue,H,oe,ge,Z,2),o.identity(ge),o.rotateX(ge,ge,.5*Math.PI),ss(ue,H,oe,ge,Z,3),o.identity(ge),ss(ue,H,oe,ge,Z,4),o.identity(ge),o.rotateY(ge,ge,Math.PI),ss(ue,H,oe,ge,Z,5),ue.viewport.set([0,0,F.width,F.height])}(y,p),p.markSkyboxValid(y)):y.renderPass==="sky"&&function(F,H,ne,ae,ue){const le=F.context,de=le.gl,Z=F.transform,oe=F.useProgram("skybox");le.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_CUBE_MAP,H.skyboxTexture);const ge=((ye,Te,Ie,Ce,Le)=>({u_matrix:ye,u_sun_direction:Te,u_cubemap:0,u_opacity:Ce,u_temporal_offset:Le}))(Z.skyboxMatrix,H.getCenter(F,!1),0,ae,ue);F.prepareDrawProgram(le,oe),oe.draw(le,de.TRIANGLES,ne,o.StencilMode.disabled,F.colorModeForRenderPass(),o.CullFaceMode.backCW,ge,"skybox",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(y,p,R,k,$):P==="gradient"&&y.renderPass==="sky"&&function(F,H,ne,ae,ue){const le=F.context,de=le.gl,Z=F.transform,oe=F.useProgram("skyboxGradient");H.skyboxGeometry||(H.skyboxGeometry=new af(le)),le.activeTexture.set(de.TEXTURE0);let ge=H.colorRampTexture;ge||(ge=H.colorRampTexture=new o.Texture(le,H.colorRamp,de.RGBA)),ge.bind(de.LINEAR,de.CLAMP_TO_EDGE);const ye=((Te,Ie,Ce,Le,Re)=>({u_matrix:Te,u_color_ramp:0,u_center_direction:Ie,u_radius:o.degToRad(Ce),u_opacity:Le,u_temporal_offset:Re}))(Z.skyboxMatrix,H.getCenter(F,!1),H.paint.get("sky-gradient-radius"),ae,ue);F.prepareDrawProgram(le,oe),oe.draw(le,de.TRIANGLES,ne,o.StencilMode.disabled,F.colorModeForRenderPass(),o.CullFaceMode.backCW,ye,"skyboxGradient",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(y,p,R,k,$)},debug:function(y,u,p){for(let b=0;b<p.length;b++)Lw(y,u,p[b])},custom:function(y,u,p,b){const S=y.context,k=p.implementation;if(!y.transform.projection.unsupportedLayers||!y.transform.projection.unsupportedLayers.includes("custom")||y.terrain&&(y.terrain.renderingToTexture||y.renderPass==="offscreen")&&p.isLayerDraped()){if(y.renderPass==="offscreen"){const M=k.prerender;if(M){if(y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),y.transform.projection.name==="globe"){const P=y.transform.pointMerc;M.call(k,S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(y.transform.zoom),[P.x,P.y],y.transform.pixelsPerMeterRatio)}else M.call(k,S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState()}}else if(y.renderPass==="translucent"){if(y.terrain&&y.terrain.renderingToTexture){const P=k.renderToTile;if(P){const R=b[0].canonical,$=new o.MercatorCoordinate(R.x+b[0].wrap*(1<<R.z),R.y,R.z);S.setDepthMode(o.DepthMode.disabled),S.setStencilMode(o.StencilMode.disabled),S.setColorMode(y.colorModeForRenderPass()),y.setCustomLayerDefaults(),P.call(k,S.gl,$),S.setDirty(),y.setBaseState()}return}y.setCustomLayerDefaults(),S.setColorMode(y.colorModeForRenderPass()),S.setStencilMode(o.StencilMode.disabled);const M=k.renderingMode==="3d"?new o.DepthMode(y.context.gl.LEQUAL,o.DepthMode.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(S.setDepthMode(M),y.transform.projection.name==="globe"){const P=y.transform.pointMerc;k.render(S.gl,y.transform.customLayerMatrix(),y.transform.getProjection(),y.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(y.transform.zoom),[P.x,P.y],y.transform.pixelsPerMeterRatio)}else k.render(S.gl,y.transform.customLayerMatrix());S.setDirty(),y.setBaseState(),S.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Dc{constructor(u,p,b=!1){this.context=new Mt(u,b),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(u,p){const b=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(b||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new qm(this,u));const S=this._terrain;this.transform.elevation=b?S:null,S.update(u,this.transform,p)}_updateFog(u){const p=u.fog;if(!p||this.transform.projection.name==="globe"||p.getOpacity(this.transform.pitch)<1||p.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[b,S]=p.getFovAdjustedRange(this.transform._fov);if(b>S)return void(this.transform.fogCullDistSq=null);const k=b+.78*(S-b);this.transform.fogCullDistSq=k*k}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(u,p){if(this.width=u*o.exported.devicePixelRatio,this.height=p*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style.order)this.style._layers[b].resize()}setup(){const u=this.context,p=new o.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(o.EXTENT,0),p.emplaceBack(0,o.EXTENT),p.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(p,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const b=new o.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(o.EXTENT,0),b.emplaceBack(0,o.EXTENT),b.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=u.createVertexBuffer(b,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const S=new o.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(S,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const k=new o.StructArrayLayout4i8;k.emplaceBack(0,0,0,0),k.emplaceBack(o.EXTENT,0,o.EXTENT,0),k.emplaceBack(0,o.EXTENT,0,o.EXTENT),k.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=u.createVertexBuffer(k,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const M=new o.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(M);const P=new o.StructArrayLayout1ui2;for(const $ of[0,1,3,2,0])P.emplaceBack($);this.debugIndexBuffer=u.createIndexBuffer(P),this.emptyTexture=new o.Texture(u,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA),this.identityMat=o.create();const R=this.context.gl;this.stencilClearMode=new o.StencilMode({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new y0(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context,p=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(u,p.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,fd(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,p,b){if(!p||this.currentStencilSource===p.id||!u.isTileClipped()||!b||b.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const R of b)if(this._tileClippingMaskIDs[R.key]===void 0){P=!0;break}if(!P)return}this.currentStencilSource=p.id;const S=this.context,k=S.gl;this.nextStencilID+b.length>256&&this.clearStencil(),S.setColorMode(o.ColorMode.disabled),S.setDepthMode(o.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of b){const R=p.getTile(P),$=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:H,tileBoundsSegments:ne}=this.getTileBoundsBuffers(R);M.draw(S,k.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:k.ALWAYS,mask:0},$,255,k.KEEP,k.KEEP,k.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,fd(P.projMatrix),"$clipping",F,H,ne)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,p=this.context.gl;return new o.StencilMode({func:p.NOTEQUAL,mask:255},u,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const p=this.context.gl;return new o.StencilMode({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(u){const p=this.context.gl,b=u.sort((M,P)=>P.overscaledZ-M.overscaledZ),S=b[b.length-1].overscaledZ,k=b[0].overscaledZ-S+1;if(k>1){this.currentStencilSource=void 0,this.nextStencilID+k>256&&this.clearStencil();const M={};for(let P=0;P<k;P++)M[P+S]=new o.StencilMode({func:p.GEQUAL,mask:255},P+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=k,[M,b]}return[{[S]:o.StencilMode.disabled},b]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([u.CONSTANT_COLOR,u.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(u,p,b){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new o.DepthMode(b||this.context.gl.LEQUAL,p,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,p){this.style=u,this.options=p,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const b=this.style.order,S=this.style._sourceCaches;for(const $ in S){const F=S[$];F.used&&F.prepare(this.context)}const k={},M={},P={};for(const $ in S){const F=S[$];k[$]=F.getVisibleCoordinates(),M[$]=k[$].slice().reverse(),P[$]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<b.length;$++)if(this.style._layers[b[$]].is3D()){this.opaquePassCutoff=$;break}if(this.terrain&&(this.terrain.updateTileBinding(P),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),!o.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const $ of b){const F=this.style._layers[$],H=u._getLayerSourceCache(F);if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const ne=H?M[H.id]:void 0;(F.type==="custom"||F.isSky()||ne&&ne.length)&&this.renderLayer(this,H,F,ne)}this.depthRangeFor3D=[0,1-(u.order.length+2)*this.numSublayers*this.depthEpsilon];const R=this.terrain;if(R&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&R.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:p.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[b[this.currentLayer]],F=u._getLayerSourceCache($);if($.isSky())continue;const H=F?M[F.id]:void 0;this._renderTileClippingMasks($,F,H),this.renderLayer(this,F,$,H)}if(this.style.fog&&this.transform.projection.supportsFog&&function($,F){const H=$.context,ne=H.gl,ae=$.transform,ue=new o.DepthMode(ne.LEQUAL,o.DepthMode.ReadOnly,[0,1]),le=$.useProgram("globeAtmosphere",null,ae.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),de=o.globeToMercatorTransition(ae.zoom),Z=F.properties.get("color").toArray01(),oe=F.properties.get("high-color").toArray01(),ge=F.properties.get("space-color").toArray01PremultipliedAlpha(),ye=o.identity$1([]);o.rotateY$1(ye,ye,-o.degToRad(ae._center.lng)),o.rotateX$1(ye,ye,o.degToRad(ae._center.lat)),o.rotateZ$1(ye,ye,ae.angle),o.rotateX$1(ye,ye,-ae._pitch);const Te=o.fromQuat(new Float32Array(16),ye),Ie=o.mapValue(F.properties.get("star-intensity"),0,1,0,.25),Ce=5e-4,Le=o.mapValue(F.properties.get("horizon-blend"),0,1,Ce,.25),Re=o.globeUseCustomAntiAliasing($,H,ae)&&Le===Ce?ae.worldSize/(2*Math.PI*1.025)-1:ae.globeRadius,Ge=$.frameCounter/1e3%1,St=o.length(ae.globeCenterInViewSpace),Ve=Math.sqrt(Math.pow(St,2)-Math.pow(Re,2)),ut=Math.acos(Ve/St),Ye=((qe,ct,Tt,pt,It,rn,vn,Yt,un,Dn,Mn,tn,Qn,oi)=>({u_frustum_tl:qe,u_frustum_tr:ct,u_frustum_br:Tt,u_frustum_bl:pt,u_horizon:It,u_transition:rn,u_fadeout_range:vn,u_color:Yt,u_high_color:un,u_space_color:Dn,u_star_intensity:Mn,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:tn,u_horizon_angle:Qn,u_rotation_matrix:oi}))(ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.frustumCorners.horizon,de,Le,Z,oe,ge,Ie,Ge,ut,Te);$.prepareDrawProgram(H,le);const bt=$.atmosphereBuffer;bt&&le.draw(H,ne.TRIANGLES,ue,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,Ye,"skybox",bt.vertexBuffer,bt.indexBuffer,bt.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const $=this.style._layers[b[this.currentLayer]],F=u._getLayerSourceCache($);$.isSky()&&this.renderLayer(this,F,$,F?M[F.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;){const $=this.style._layers[b[this.currentLayer]],F=u._getLayerSourceCache($);if($.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped($)){if($.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const H=F?($.type==="symbol"?P:M)[F.id]:void 0;this._renderTileClippingMasks($,F,F?k[F.id]:void 0),this.renderLayer(this,F,$,H),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let $=null;o.values(this.style._layers).forEach(F=>{const H=u._getLayerSourceCache(F);H&&!F.isHidden(this.transform.zoom)&&(!$||$.getSource().maxzoom<H.getSource().maxzoom)&&($=H)}),$&&this.options.showTileBoundaries&&Vl.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const F=$.transform.padding;p0($,$.transform.height-(F.top||0),3,Pc),p0($,F.bottom||0,3,Pw),sf($,F.left||0,3,Ow),sf($,$.transform.width-(F.right||0),3,Dw);const H=$.transform.centerPoint;(function(ne,ae,ue,le){Oc(ne,ae-1,ue-10,2,20,le),Oc(ne,ae-10,ue-1,20,2,le)})($,H.x,$.transform.height-H.y,Rw)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}renderLayer(u,p,b,S){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="sky"||b.type==="custom"||S&&S.length)&&(this.id=b.id,this.gpuTimingStart(b),(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes(b.type)||u.terrain&&b.type==="custom")&&Vl[b.type](u,p,b,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let b=this.gpuTimers[u.id];b||(b=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),b.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,p=u.createQueryEXT();this.deferredRenderGpuTimeQueries.push(p),u.beginQueryEXT(u.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const p={};for(const b in u){const S=u[b],k=this.context.extTimerQuery,M=k.getQueryObjectEXT(S.query,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(S.query),p[b]=M}return p}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const p=this.context.extTimerQuery;let b=0;for(const S of u)b+=p.getQueryObjectEXT(S,p.QUERY_RESULT_EXT)/1e6,p.deleteQueryEXT(S);return b}translatePosMatrix(u,p,b,S,k){if(!b[0]&&!b[1])return u;const M=k?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(M){const $=Math.sin(M),F=Math.cos(M);b=[b[0]*F-b[1]*$,b[0]*$+b[1]*F]}const P=[k?b[0]:ft(p,b[0],this.transform.zoom),k?b[1]:ft(p,b[1],this.transform.zoom),0],R=new Float32Array(16);return o.translate(R,u,P),R}saveTileTexture(u){const p=this._tileTextures[u.size[0]];p?p.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const p=this._tileTextures[u];return p&&p.length>0?p.pop():null}isPatternMissing(u){return u===null||u!==void 0&&!this.imageManager.getPattern(u.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const u=this.terrain&&this.terrain.renderingToTexture,p=this.terrain&&this.terrain.exaggeration()===0,b=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),this.transform.projection.name==="globe"&&S.push("GLOBE"),p&&S.push("ZERO_EXAGGERATION"),b&&!u&&b.getOpacity(this.transform.pitch)!==0&&S.push("FOG"),u&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(u,p,b){this.cache=this.cache||{};const S=b||[],k=this.currentGlobalDefines().concat(S),M=Vn.cacheKey(Fm[u],u,k,p);return this.cache[M]||(this.cache[M]=new Vn(this.context,u,Fm[u],p,eg[u],k)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(u,p,b){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const k=S.getOpacity(this.transform.pitch),M=((P,R,$,F,H,ne,ae,ue,le,de,Z)=>{const oe=P.transform,ge=R.properties.get("color").toArray01();ge[3]=F;const ye=P.frameCounter/1e3%1;return{u_fog_matrix:$?oe.calculateFogTileMatrix($):P.identityMat,u_fog_range:R.getFovAdjustedRange(oe._fov),u_fog_color:ge,u_fog_horizon_blend:R.properties.get("horizon-blend"),u_fog_temporal_offset:ye,u_frustum_tl:H,u_frustum_tr:ne,u_frustum_br:ae,u_frustum_bl:ue,u_globe_pos:le,u_globe_radius:de,u_viewport:Z,u_globe_transition:o.globeToMercatorTransition(oe.zoom),u_is_globe:+(oe.projection.name==="globe")}})(this,S,b,k,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);p.setFogUniformValues(u,M)}}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){const u=this.canvasCopy();u&&(this.frameCopies.push(u),this.tileLoaded=!1)}canvasCopy(){const u=this.context.gl,p=u.createTexture();return u.bindTexture(u.TEXTURE_2D,p),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),p}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&u.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const u=this._backgroundTiles,p=this._backgroundTiles={},b=this.transform.coveringTiles({tileSize:512});for(const S of b)p[S.key]=u[S.key]||new o.Tile(S,512,this.transform.tileZoom,this);return p}clearBackgroundTiles(){this._backgroundTiles={}}}class lf{constructor(u=0,p=0,b=0,S=0){if(isNaN(u)||u<0||isNaN(p)||p<0||isNaN(b)||b<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=p,this.left=b,this.right=S}interpolate(u,p,b){return p.top!=null&&u.top!=null&&(this.top=o.number(u.top,p.top,b)),p.bottom!=null&&u.bottom!=null&&(this.bottom=o.number(u.bottom,p.bottom,b)),p.left!=null&&u.left!=null&&(this.left=o.number(u.left,p.left,b)),p.right!=null&&u.right!=null&&(this.right=o.number(u.right,p.right,b)),this}getCenter(u,p){const b=o.clamp((this.left+u-this.right)/2,0,u),S=o.clamp((this.top+p-this.bottom)/2,0,p);return new o.Point(b,S)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new lf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function cf(y,u){const p=o.getColumn(y,3);o.fromQuat(y,u),o.setColumn(y,3,p)}function Un(y,u){const p=o.identity$1([]);return o.rotateZ$1(p,p,-u),o.rotateX$1(p,p,-y),p}function _d(y,u){const p=[y[0],y[1],0],b=[u[0],u[1],0];if(o.length(p)>=1e-15){const M=o.normalize([],p);o.scale$2(b,M,o.dot(b,M)),u[0]=b[0],u[1]=b[1]}const S=o.cross([],u,y);if(o.len(S)<1e-15)return null;const k=Math.atan2(-S[1],S[0]);return Un(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),k)}class v0{constructor(u,p){this.position=u,this.orientation=p}get position(){return this._position}set position(u){if(u){const p=u instanceof o.MercatorCoordinate?u:new o.MercatorCoordinate(u[0],u[1],u[2]);this._renderWorldCopies&&(p.x=o.wrap(p.x,0,1)),this._position=p}else this._position=null}lookAtPoint(u,p){if(this.orientation=null,!this.position)return;const b=this.position,S=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(u)):0,k=o.MercatorCoordinate.fromLngLat(u,S),M=[k.x-b.x,k.y-b.y,k.z-b.z];p||(p=[0,0,1]),p[2]=Math.abs(p[2]),this.orientation=_d(M,p)}setPitchBearing(u,p){this.orientation=Un(o.degToRad(u),o.degToRad(-p))}}class uf{constructor(u,p){this._transform=o.identity([]),this.orientation=p,this.position=u}get mercatorPosition(){const u=this.position;return new o.MercatorCoordinate(u[0],u[1],u[2])}get position(){const u=o.getColumn(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var p;u&&o.setColumn(this._transform,3,[(p=u)[0],p[1],p[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||o.identity$1([]),u&&cf(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),p=this.right();return{bearing:Math.atan2(-p[1],p[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,p){this._orientation=Un(u,p),cf(this._transform,this._orientation)}forward(){const u=o.getColumn(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=o.getColumn(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=o.getColumn(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,p){const b=new Float64Array(16);return o.invert(b,this.getWorldToCamera(u,p)),b}getWorldToCameraPosition(u,p,b){const S=this.position;o.scale$2(S,S,-u);const k=new Float64Array(16);return o.fromScaling(k,[b,b,b]),o.translate(k,k,S),k[10]*=p,k}getWorldToCamera(u,p){const b=new Float64Array(16),S=new Float64Array(4),k=this.position;return o.conjugate(S,this._orientation),o.scale$2(k,k,-u),o.fromQuat(b,S),o.translate(b,b,k),b[1]*=-1,b[5]*=-1,b[9]*=-1,b[13]*=-1,b[8]*=p,b[9]*=p,b[10]*=p,b[11]*=p,b}getCameraToClipPerspective(u,p,b,S){const k=new Float64Array(16);return o.perspective(k,u,p,b,S),k}getDistanceToElevation(u,p=!1){const b=u===0?0:o.mercatorZfromAltitude(u,p?o.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(b-this.position[2])/S[2]}clone(){return new uf([...this.position],[...this.orientation])}}function Rc(y,u){const p=df(y.projection,y.zoom,y.width,y.height),b=function(k,M,P,R,$){const F=new o.LngLat(P.lng-180*ka,P.lat),H=new o.LngLat(P.lng+180*ka,P.lat),ne=k.project(F.lng,F.lat),ae=k.project(H.lng,H.lat),ue=-Math.atan2(ae.y-ne.y,ae.x-ne.x),le=o.MercatorCoordinate.fromLngLat(P);le.y=o.clamp(le.y,-1+ka,1-ka);const de=le.toLngLat(),Z=k.project(de.lng,de.lat),oe=o.MercatorCoordinate.fromLngLat(de);oe.x+=ka;const ge=oe.toLngLat(),ye=k.project(ge.lng,ge.lat),Te=hf(ye.x-Z.x,ye.y-Z.y,ue),Ie=o.MercatorCoordinate.fromLngLat(de);Ie.y+=ka;const Ce=Ie.toLngLat(),Le=k.project(Ce.lng,Ce.lat),Re=hf(Le.x-Z.x,Le.y-Z.y,ue),Ge=Math.abs(Te.x)/Math.abs(Re.y),St=o.identity([]);o.rotateZ(St,St,-ue*(1-($?0:R)));const Ve=o.identity([]);return o.scale(Ve,Ve,[1,1-(1-Ge)*R,1]),Ve[4]=-Re.x/Re.y*R,o.rotateZ(Ve,Ve,ue),o.multiply(Ve,St,Ve),Ve}(y.projection,0,y.center,p,u),S=b0(y);return o.scale(b,b,[S,S,1]),b}function b0(y){const u=y.projection,p=df(y.projection,y.zoom,y.width,y.height),b=_0(u,y.center),S=_0(u,o.LngLat.convert(u.center));return Math.pow(2,b*p+(1-p)*S)}function df(y,u,p,b,S=1/0){const k=y.range;if(!k)return 0;const M=Math.min(S,Math.max(p,b)),P=Math.log(M/1024)/Math.LN2;return o.smoothstep(k[0]+P,k[1]+P,u)}const ka=1/4e4;function _0(y,u){const p=o.clamp(u.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),b=new o.LngLat(u.lng-180*ka,p),S=new o.LngLat(u.lng+180*ka,p),k=y.project(b.lng,p),M=y.project(S.lng,p),P=o.MercatorCoordinate.fromLngLat(b),R=o.MercatorCoordinate.fromLngLat(S),$=M.x-k.x,F=M.y-k.y,H=R.x-P.x,ne=R.y-P.y,ae=Math.sqrt((H*H+ne*ne)/($*$+F*F));return Math.log(ae)/Math.LN2}function hf(y,u,p){const b=Math.cos(p),S=Math.sin(p);return{x:y*b-u*S,y:y*S+u*b}}class Lc{constructor(u,p,b,S,k,M,P){this.tileSize=512,this._renderWorldCopies=k===void 0||k,this._minZoom=u||0,this._maxZoom=p||22,this._minPitch=b==null?0:b,this._maxPitch=S==null?60:S,this.setProjection(M),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new lf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new uf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const u=new Lc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(u,p=!1){const b=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||b)&&this._updateCameraOnTerrain(),(u||b)&&this._constrainCamera(p),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const p=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const b=!f(p,this.getProjection());return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const p=u!==this.projection.name;return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.Point(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const p=-u*Math.PI/180;var b;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(b=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b),function(S,k,M){var P=k[0],R=k[1],$=k[2],F=k[3],H=Math.sin(M),ne=Math.cos(M);S[0]=P*ne+$*H,S[1]=R*ne+F*H,S[2]=P*-H+$*ne,S[3]=R*-H+F*ne}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const p=o.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=o.degToRad(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const p=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._setZoom(p),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const u=this._elevation;this._centerAltitude=u.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=u.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,p=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],b=this.horizonLineFromTop();let S=0,k=0;for(let M=0;M<p.length;M++){const P=new o.Point(p[M][0]*this.width,b+p[M][1]*(this.height-b)),R=u.pointCoordinate(P);if(!R)continue;const $=1/Math.hypot(R[0]-this._camera.position[0],R[1]-this._camera.position[1]);S+=R[3]*$,k+=$}return k===0?NaN:S/k}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const u=this._seaLevelZoom,p=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),b=this.pixelsPerMeter/this.worldSize*p,S=this._mercatorZfromZoom(u),k=this._mercatorZfromZoom(this._maxZoom),M=Math.max(S-b,k);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const p=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let b;b=u.z<this._camera.position[2]?[p.x,p.y,p.z]:[u.x,u.y,u.z];const S=o.length(o.sub([],this._camera.position,b));return o.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let p=!1;if(u.orientation&&!o.exactEquals(u.orientation,this._camera.orientation)&&(p=this._setCameraOrientation(u.orientation)),u.position){const b=[u.position.x,u.position.y,u.position.z];o.exactEquals$1(b,this._camera.position)||(this._setCameraPosition(b),p=!0)}p&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,p=new v0;return p.position=new o.MercatorCoordinate(u[0],u[1],u[2]),p.orientation=this._camera.orientation,p._elevation=this.elevation,p._renderWorldCopies=this.renderWorldCopies,p}_setCameraOrientation(u){if(!o.length$1(u))return!1;o.normalize$1(u,u);const p=o.transformQuat([],[0,0,-1],u),b=o.transformQuat([],[0,-1,0],u);if(b[2]<0)return!1;const S=_d(p,b);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(u){const p=this.zoomScale(this.minZoom)*this.tileSize,b=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;u[2]=o.clamp(u[2],S/b,S/p),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,p,b){this._unmodified=!1,this._edgeInsets.interpolate(u,p,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const p=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(u){const p=[new o.UnwrappedTileID(0,u)];if(this.renderWorldCopies){const b=this.pointCoordinate(new o.Point(0,0)),S=this.pointCoordinate(new o.Point(this.width,0)),k=this.pointCoordinate(new o.Point(this.width,this.height)),M=this.pointCoordinate(new o.Point(0,this.height)),P=Math.floor(Math.min(b.x,S.x,k.x,M.x)),R=Math.floor(Math.max(b.x,S.x,k.x,M.x)),$=1;for(let F=P-$;F<=R+$;F++)F!==0&&p.push(new o.UnwrappedTileID(F,u))}return p}coveringTiles(u){let p=this.coveringZoomLevel(u);const b=p,S=this.elevation&&!u.isTerrainDEM,k=this.projection.name==="mercator";if(u.minzoom!==void 0&&p<u.minzoom)return[];u.maxzoom!==void 0&&p>u.maxzoom&&(p=u.maxzoom);const M=this.locationCoordinate(this.center),P=this.center.lat,R=1<<p,$=[R*M.x,R*M.y,0],F=this.projection.name==="globe",H=!F,ne=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p,H),ae=F?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ue=R*o.mercatorZfromAltitude(1,this.center.lat),le=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),de=[R*ae.x,R*ae.y,le*(H?1:ue)],Z=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),oe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?p:0,ge=u.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ye=u.isTerrainDEM?-ge:this._elevation?this._elevation.getMinElevationBelowMSL():0,Te=this.projection.isReprojectedInTileSpace?b0(this):1,Ie=qe=>{const Tt=new o.MercatorCoordinate(qe.x+25e-6,qe.y,qe.z),pt=new o.MercatorCoordinate(qe.x,qe.y+25e-6,qe.z),It=qe.toLngLat(),rn=Tt.toLngLat(),vn=pt.toLngLat(),Yt=this.locationCoordinate(It),un=this.locationCoordinate(rn),Dn=this.locationCoordinate(vn),Mn=Math.hypot(un.x-Yt.x,un.y-Yt.y),tn=Math.hypot(Dn.x-Yt.x,Dn.y-Yt.y);return Math.sqrt(Mn*tn)*Te/25e-6},Ce=qe=>{const ct=ge,Tt=ye;return{aabb:o.tileAABB(this,R,0,0,0,qe,Tt,ct,this.projection),zoom:0,x:0,y:0,minZ:Tt,maxZ:ct,wrap:qe,fullyVisible:!1}},Le=[];let Re=[];const Ge=p,St=u.reparseOverscaled?b:p,Ve=qe=>qe*qe,ut=Ve((le-this._centerAltitude)*ue),Ye=qe=>{if(!this._elevation||!qe.tileID||!k)return;const ct=this._elevation.getMinMaxForTile(qe.tileID),Tt=qe.aabb;ct?(Tt.min[2]=ct.min,Tt.max[2]=ct.max,Tt.center[2]=(Tt.min[2]+Tt.max[2])/2):(qe.shouldSplit=bt(qe),qe.shouldSplit||(Tt.min[2]=Tt.max[2]=Tt.center[2]=this._centerAltitude))},bt=qe=>{if(qe.zoom<oe)return!0;if(qe.zoom===Ge)return!1;if(qe.shouldSplit!=null)return qe.shouldSplit;const ct=qe.aabb.distanceX(de),Tt=qe.aabb.distanceY(de);let pt=ut,It=1;if(F){pt=Ve(qe.aabb.distanceZ(de));const Yt=Math.pow(2,qe.zoom),un=o.latFromMercatorY((qe.y+1)/Yt),Dn=o.latFromMercatorY(qe.y/Yt),Mn=Math.min(Math.max(P,un),Dn),tn=o.circumferenceAtLatitude(Mn)/o.circumferenceAtLatitude(P);if(It=Mn===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,tn/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&qe.zoom===Ge-1&&tn>=.9)return!0}else if(S&&(pt=Ve(qe.aabb.distanceZ(de)*ue)),this.projection.isReprojectedInTileSpace&&b<=5){const Yt=Math.pow(2,qe.zoom),un=Ie(new o.MercatorCoordinate((qe.x+.5)/Yt,(qe.y+.5)/Yt));It=un>.85?1:un}const rn=ct*ct+Tt*Tt+pt,vn=Ve((1<<Ge-qe.zoom)*Z*It*((Yt,un)=>{if(un*Ve(.707)<Yt)return 1;const Dn=Math.sqrt(un/Yt);return Dn/(1.4144271570014144+(Math.pow(1.1,Dn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(pt,ut),rn));return rn<vn};if(this.renderWorldCopies)for(let qe=1;qe<=3;qe++)Le.push(Ce(-qe)),Le.push(Ce(qe));for(Le.push(Ce(0));Le.length>0;){const qe=Le.pop(),ct=qe.x,Tt=qe.y;let pt=qe.fullyVisible;if(!pt){const It=qe.aabb.intersects(ne);if(It===0)continue;pt=It===2}if(qe.zoom!==Ge&&bt(qe))for(let It=0;It<4;It++){const rn=(ct<<1)+It%2,vn=(Tt<<1)+(It>>1),Yt={aabb:k?qe.aabb.quadrant(It):o.tileAABB(this,R,qe.zoom+1,rn,vn,qe.wrap,qe.minZ,qe.maxZ,this.projection),zoom:qe.zoom+1,x:rn,y:vn,wrap:qe.wrap,fullyVisible:pt,tileID:void 0,shouldSplit:void 0,minZ:qe.minZ,maxZ:qe.maxZ};S&&!F&&(Yt.tileID=new o.OverscaledTileID(qe.zoom+1===Ge?St:qe.zoom+1,qe.wrap,qe.zoom+1,rn,vn),Ye(Yt)),Le.push(Yt)}else{const It=qe.zoom===Ge?St:qe.zoom;if(u.minzoom&&u.minzoom>It)continue;const rn=$[0]-(.5+ct+(qe.wrap<<qe.zoom))*(1<<p-qe.zoom),vn=$[1]-.5-Tt,Yt=qe.tileID?qe.tileID:new o.OverscaledTileID(It,qe.wrap,qe.zoom,ct,Tt);Re.push({tileID:Yt,distanceSq:rn*rn+vn*vn})}}if(this.fogCullDistSq){const qe=this.fogCullDistSq,ct=this.horizonLineFromTop();Re=Re.filter(Tt=>{const pt=[0,0,0,1],It=[o.EXTENT,o.EXTENT,0,1],rn=this.calculateFogTileMatrix(Tt.tileID.toUnwrapped());o.transformMat4$1(pt,pt,rn),o.transformMat4$1(It,It,rn);const vn=o.getAABBPointSquareDist(pt,It);if(vn===0)return!0;let Yt=!1;const un=this._elevation;if(un&&vn>qe&&ct!==0){const Dn=this.calculateProjMatrix(Tt.tileID.toUnwrapped());let Mn;u.isTerrainDEM||(Mn=un.getMinMaxForTile(Tt.tileID)),Mn||(Mn={min:ye,max:ge});const tn=o.furthestTileCorner(this.rotation),Qn=[tn[0]*o.EXTENT,tn[1]*o.EXTENT,Mn.max];o.transformMat4(Qn,Qn,Dn),Yt=(1-Qn[1])*this.height*.5<ct}return vn<qe||Yt})}return Re.sort((qe,ct)=>qe.distanceSq-ct.distanceSq).map(qe=>qe.tileID)}resize(u,p){this.width=u,this.height=p,this.pixelsToGLUnits=[2/u,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const p=o.clamp(u.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),b=this.projection.project(u.lng,p);return new o.Point(b.x*this.worldSize,b.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(u,p){let b,S;const k=this.centerPoint;if(this.projection.name==="globe"){const P=this.worldSize;b=(p.x-k.x)/P,S=(p.y-k.y)/P}else{const P=this.pointCoordinate(p),R=this.pointCoordinate(k);b=P.x-R.x,S=P.y-R.y}const M=this.locationCoordinate(u);this.setLocation(new o.MercatorCoordinate(M.x-b,M.y-S))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,p){const b=p?o.mercatorZfromAltitude(p,u.lat):void 0,S=this.projection.project(u.lng,u.lat);return new o.MercatorCoordinate(S.x,S.y,b)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,p){const b=p!=null?p:this._centerAltitude,S=[u.x,u.y,0,1],k=[u.x,u.y,1,1];o.transformMat4$1(S,S,this.pixelMatrixInverse),o.transformMat4$1(k,k,this.pixelMatrixInverse);const M=k[3];o.scale$1(S,S,1/S[3]),o.scale$1(k,k,1/M);const P=S[2],R=k[2];return{p0:S,p1:k,t:P===R?0:(b-P)/(R-P)}}screenPointToMercatorRay(u){const p=[u.x,u.y,0,1],b=[u.x,u.y,1,1];return o.transformMat4$1(p,p,this.pixelMatrixInverse),o.transformMat4$1(b,b,this.pixelMatrixInverse),o.scale$1(p,p,1/p[3]),o.scale$1(b,b,1/b[3]),p[2]=o.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,b[2]=o.mercatorZfromAltitude(b[2],this._center.lat)*this.worldSize,o.scale$1(p,p,1/this.worldSize),o.scale$1(b,b,1/this.worldSize),new o.Ray([p[0],p[1],p[2]],o.normalize([],o.sub([],b,p)))}rayIntersectionCoordinate(u){const{p0:p,p1:b,t:S}=u,k=o.mercatorZfromAltitude(p[2],this._center.lat),M=o.mercatorZfromAltitude(b[2],this._center.lat);return new o.MercatorCoordinate(o.number(p[0],b[0],S)/this.worldSize,o.number(p[1],b[1],S)/this.worldSize,o.number(k,M,S))}pointCoordinate(u,p=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,p)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let p=this.projection.pointCoordinate3D(this,u.x,u.y);if(p)return new o.MercatorCoordinate(p[0],p[1],p[2]);let b=0,S=this.horizonLineFromTop();if(u.y>S)return this.pointCoordinate(u);const k=.02*S,M=u.clone();for(let P=0;P<10&&S-b>k;P++){M.y=o.number(b,S,.66);const R=this.projection.pointCoordinate3D(this,M.x,M.y);R?(S=M.y,p=R):b=M.y}return p?new o.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}isPointOnSurface(u){if(u.y<0||u.y>this.height||u.x<0||u.x>this.width)return!1;if(this.elevation||this.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(u);const p=this.pointCoordinate(u);return p.y>=0&&p.y<=1}_coordinatePoint(u,p){const b=p&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,S=[u.x*this.worldSize,u.y*this.worldSize,b+u.toAltitude(),1];return o.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new o.Point(S[0]/S[3],S[1]/S[3]):new o.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:u,left:p}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,k=this.pointLocation3D(new o.Point(p,u)),M=this.pointLocation3D(new o.Point(S,u)),P=this.pointLocation3D(new o.Point(S,b)),R=this.pointLocation3D(new o.Point(p,b));let $=Math.min(k.lng,M.lng,P.lng,R.lng),F=Math.max(k.lng,M.lng,P.lng,R.lng),H=Math.min(k.lat,M.lat,P.lat,R.lat),ne=Math.max(k.lat,M.lat,P.lat,R.lat);const ae=Math.pow(2,-this.zoom)/16*270,ue=this.projection.name==="globe"?1:4,le=(de,Z,oe,ge,ye)=>{const Te=(de+oe)/2,Ie=(Z+ge)/2,Ce=new o.Point(Te,Ie),{lng:Le,lat:Re}=this.pointLocation3D(Ce),Ge=Math.max(0,$-Le,H-Re,Le-F,Re-ne);$=Math.min($,Le),F=Math.max(F,Le),H=Math.min(H,Re),ne=Math.max(ne,Re),(ye<ue||Ge>ae)&&(le(de,Z,Te,Ie,ye+1),le(Te,Ie,oe,ge,ye+1))};if(le(p,u,S,u,1),le(S,u,S,b,1),le(S,b,p,b,1),le(p,b,p,u,1),this.projection.name==="globe"){const[de,Z]=o.polesInViewport(this);de?(ne=90,F=180,$=-180):Z&&(H=-90,F=180,$=-180)}return new o.LngLatBounds(new o.LngLat($,H),new o.LngLat(F,ne))}_getBoundsRectangular(u,p){const{top:b,left:S}=this._edgeInsets,k=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,P=new o.Point(S,b),R=new o.Point(M,b),$=new o.Point(M,k),F=new o.Point(S,k);let H=this.pointCoordinate(P,u),ne=this.pointCoordinate(R,u);const ae=this.pointCoordinate($,p),ue=this.pointCoordinate(F,p),le=(de,Z)=>(Z.y-de.y)/(Z.x-de.x);return H.y>1&&ne.y>=0?H=new o.MercatorCoordinate((1-ue.y)/le(ue,H)+ue.x,1):H.y<0&&ne.y<=1&&(H=new o.MercatorCoordinate(-ue.y/le(ue,H)+ue.x,0)),ne.y>1&&H.y>=0?ne=new o.MercatorCoordinate((1-ae.y)/le(ae,ne)+ae.x,1):ne.y<0&&H.y<=1&&(ne=new o.MercatorCoordinate(-ae.y/le(ae,ne)+ae.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(H)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(ue)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBoundsRectangular(0,0);const p=u.visibleDemTiles.reduce((b,S)=>{if(S.dem){const k=S.dem.tree;b.min=Math.min(b.min,k.minimums[0]),b.max=Math.max(b.max,k.maximums[0])}return b},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(p.min*u.exaggeration(),p.max*u.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(u=!0){const p=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,b=this.height/2-p*(1-this._horizonShift);return u?Math.max(0,b):b}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,p){return this.projection.createTileMatrix(this,p,u)}calculateDistanceTileData(u){const p=u.key,b=this._distanceTileDataCache;if(b[p])return b[p];const S=u.canonical,k=1/this.height,M=this.cameraWorldSize,P=M/this.zoomScale(S.z),R=(S.x+Math.pow(2,S.z)*u.wrap)*P,$=S.y*P,F=this.point;F.x*=M/this.worldSize,F.y*=M/this.worldSize;const H=this.angle,ne=Math.sin(-H),ae=-Math.cos(-H);return b[p]={bearing:[ne,ae],center:[(F.x-R)*k,(F.y-$)*k],scale:P/o.EXTENT*k},b[p]}calculateFogTileMatrix(u){const p=u.key,b=this._fogTileMatrixCache;if(b[p])return b[p];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return o.multiply(S,this.worldToFogMatrix,S),b[p]=new Float32Array(S),b[p]}calculateProjMatrix(u,p=!1){const b=u.key,S=p?this._alignedProjMatrixCache:this._projMatrixCache;if(S[b])return S[b];const k=this.calculatePosMatrix(u,this.worldSize);return o.multiply(k,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.alignedProjMatrix:this.projMatrix,k),S[b]=new Float32Array(k),S[b]}calculatePixelsToTileUnitsMatrix(u){const p=u.tileID.key,b=this._pixelsToTileUnitsCache;if(b[p])return b[p];const S=function(k,M){const{scale:P}=k.tileTransform,R=P*o.EXTENT/(k.tileSize*Math.pow(2,M.zoom-k.tileID.overscaledZ+k.tileID.canonical.z));return $=new Float32Array(4),ne=(F=M.inverseAdjustmentMatrix)[1],ae=F[2],ue=F[3],de=(H=[R,R])[1],$[0]=F[0]*(le=H[0]),$[1]=ne*le,$[2]=ae*de,$[3]=ue*de,$;var $,F,H,ne,ae,ue,le,de}(u,this);return b[p]=S,b[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const u=1/this.worldSize,p=o.fromScaling([],[u,u,u]);return o.multiply(p,p,this.globeMatrix),p}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const u=this._elevation;this._updateCameraState();const p=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(p),S=this._camera.forward(),k=o.mercatorZfromAltitude(1,this._center.lat);b[2]/=k,S[2]/=k,o.normalize(S,S);const M=u.raycast(b,S,u.exaggeration());if(M){const P=o.scaleAndAdd([],b,S,M),R=new o.MercatorCoordinate(P[0],P[1],o.mercatorZfromAltitude(P[2],o.latFromMercatorY(P[1]))),$=(R.z+o.length([R.x-b[0],R.y-b[1],R.z-b[2]*k]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ($),this._centerAltitude=R.toAltitude(),this._center=this.coordinateLocation(R),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const p=this._elevation,b=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(b),k=p.getAtPointOrZero(new o.MercatorCoordinate(...S)),M=this.pixelsPerMeter/this.worldSize*k,P=this._minimumHeightOverTerrain(),R=S[2]-M;if(R<=P)if(R<0||u){const $=this.locationCoordinate(this._center,this._centerAltitude),F=[S[0],S[1],$.z-S[2]],H=o.length(F);F[2]-=(P-R)/this._pixelsPerMercatorPixel;const ne=o.length(F);if(ne===0)return;o.scale$2(F,F,H/ne*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],$.z*this._pixelsPerMercatorPixel-F[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const ne=this.center;return ne.lat=o.clamp(ne.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(ne.lng=o.clamp(ne.lng,this.minLng,this.maxLng)),this.center=ne,void(this._constraining=!1)}const p=this._unmodified,{x:b,y:S}=this.point;let k=0,M=b,P=S;const R=this.width/2,$=this.height/2,F=this.worldMinY*this.scale,H=this.worldMaxY*this.scale;if(S-$<F&&(P=F+$),S+$>H&&(P=H-$),H-F<this.height&&(k=Math.max(k,this.height/(H-F)),P=(H+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ne=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ue=this.worldSize/2-(ne+ae)/2;M=(b+ue+this.worldSize)%this.worldSize-ue,M-R<ne&&(M=ne+R),M+R>ae&&(M=ae-R),ae-ne<this.width&&(k=Math.max(k,this.width/(ae-ne)),M=(ae+ne)/2)}M===b&&P===S||(this.center=this.unproject(new o.Point(M,P))),k&&(this.zoom+=this.scaleZoom(k)),this._constrainCamera(),this._unmodified=p,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const b=df(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?p:1,k=this._camera.getWorldToCamera(this.worldSize,S),M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);M[8]=2*-u.x/this.width,M[9]=2*u.y/this.height;let P=o.mul([],M,k);if(this.projection.isReprojectedInTileSpace){const Ie=this.locationCoordinate(this.center),Ce=o.identity([]);o.translate(Ce,Ce,[Ie.x*this.worldSize,Ie.y*this.worldSize,0]),o.multiply(Ce,Ce,Rc(this)),o.translate(Ce,Ce,[-Ie.x*this.worldSize,-Ie.y*this.worldSize,0]),o.multiply(P,P,Ce),this.inverseAdjustmentMatrix=function(Le){const Re=Rc(Le,!0);return te([],[Re[0],Re[1],Re[4],Re[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],P,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=P,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const R=o.invert([],M);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(R,this.horizonLineFromTop(),this.height);const $=new Float32Array(16);o.identity($),o.scale($,$,[1,-1,1]),o.rotateX($,$,this._pitch),o.rotateZ($,$,this.angle);const F=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),H=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;F[8]=2*-u.x/this.width,F[9]=2*(u.y+H)/this.height,this.skyboxMatrix=o.multiply($,F,$);const ne=this.point,ae=ne.x,ue=ne.y,le=this.width%2/2,de=this.height%2/2,Z=Math.cos(this.angle),oe=Math.sin(this.angle),ge=ae-Math.round(ae)+Z*le+oe*de,ye=ue-Math.round(ue)+Z*de+oe*le,Te=new Float64Array(P);if(o.translate(Te,Te,[ge>.5?ge-1:ge,ye>.5?ye-1:ye,0]),this.alignedProjMatrix=Te,P=o.create(),o.scale(P,P,[this.width/2,-this.height/2,1]),o.translate(P,P,[1,-1,0]),this.labelPlaneMatrix=P,P=o.create(),o.scale(P,P,[1,-1,1]),o.translate(P,P,[-1,-1,0]),o.scale(P,P,[2/this.width,2/this.height,1]),this.glCoordMatrix=P,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},P=o.invert(new Float64Array(16),this.pixelMatrix),!P)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=P,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const Ie=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(Ie,Ie,k),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=P;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,p=this.cameraPixelsPerMeter,b=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,k=[u,u,p];o.scale$2(k,k,S),o.scale$2(b,b,-1),o.multiply$2(b,b,k);const M=o.create();o.translate(M,M,b),o.scale(M,M,k),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,p,S)}_computeCameraPosition(u){const p=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,b=this._camera.forward(),S=this.point,k=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*p-u/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-b[0]*k,S.y/this.worldSize-b[1]*k,u/this.worldSize*this._centerAltitude-b[2]*k]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const p=this._maxCameraBoundsDistance()*Math.cos(this._pitch),b=this._camera.position[2],S=u[2];let k=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(k=Math.min((p-b)/S,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,u,k),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,p=this._camera.forward(),{pitch:b,bearing:S}=this._camera.getPitchBearing(),k=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),P=Math.max((u[2]-k)/Math.cos(b),M),R=this._zoomFromMercatorZ(P);o.scaleAndAdd(u,u,p,P),this._pitch=o.clamp(b,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(S,-Math.PI,Math.PI),this._setZoom(o.clamp(R,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){let p=0,b=o.GLOBE_ZOOM_THRESHOLD_MAX,S=0,k=1/0;for(;b-p>1e-6&&b>p;){const M=p+.5*(b-p),P=this.tileSize*Math.pow(2,M),R=this.getCameraToCenterDistance(this.projection,M,P),$=this.scaleZoom(R/(u*this.tileSize)),F=Math.abs(M-$);F<k&&(k=F,S=M),M<$?p=M:b=M}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,p){const b=Math.min(u.x,p.x),S=Math.max(u.x,p.x),k=Math.min(u.y,p.y),M=Math.max(u.y,p.y);if(k<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const P=[new o.Point(b,k),new o.Point(S,M),new o.Point(b,M),new o.Point(S,k)],R=this.renderWorldCopies?-3:0,$=this.renderWorldCopies?4:1;for(const F of P){const H=this.pointRayIntersection(F);if(H.t<0)return!0;const ne=this.rayIntersectionCoordinate(H);if(ne.x<R||ne.y<0||ne.x>$||ne.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.Point(0,0),new o.Point(this.width,this.height))}zoomDeltaToMovement(u,p){const b=o.length(o.sub([],this._camera.position,u)),S=this._zoomFromMercatorZ(b)+p;return b-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const u=function([p,b,S],k){const M=[p,b,S,1];o.transformMat4$1(M,M,k);const P=M[3]=Math.max(M[3],1e-6);return M[0]/=P,M[1]/=P,M[2]/=P,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.Point(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,u))}}getCameraToCenterDistance(u,p=this.zoom,b=this.worldSize){const S=df(u,p,this.width,this.height,1024),k=u.pixelSpaceConversion(this.center.lat,b,S);return .5/Math.tan(.5*this._fov)*this.height*k}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(u,u,this.globeMatrix),u}}function zc(y,u){let p=!1,b=null;const S=()=>{b=null,p&&(y(),b=setTimeout(S,u),p=!1)};return()=>(p=!0,b||S(),b)}class ig{constructor(u){this._hashName=u&&encodeURIComponent(u),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=zc(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,o.window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const p=xd(u);if(this._hashName){const b=this._hashName;let S=!1;const k=o.window.location.hash.slice(1).split("&").map(M=>{const P=M.split("=")[0];return P===b?(S=!0,`${P}=${p}`):M}).filter(M=>M);return S||k.push(`${b}=${p}`),`#${k.join("&")}`}return`#${p}`}_getCurrentHash(){const u=o.window.location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(p=b)}),(p&&p[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const p=this._getCurrentHash();if(p.length>=3&&!p.some(b=>isNaN(b))){const b=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(p[3]||0):u.getBearing();return u.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:b,pitch:+(p[4]||0)}),!0}return!1}_updateHashUnthrottled(){const u=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,u)}}function xd(y,u){const p=y.getCenter(),b=Math.round(100*y.getZoom())/100,S=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,S),M=Math.round(p.lng*k)/k,P=Math.round(p.lat*k)/k,R=y.getBearing(),$=y.getPitch();let F=u?`/${M}/${P}/${b}`:`${b}/${P}/${M}`;return(R||$)&&(F+="/"+Math.round(10*R)/10),$&&(F+=`/${Math.round($)}`),F}const wd={linearity:.3,easing:o.bezier(0,0,.3,1)},ff=o.extend({deceleration:2500,maxSpeed:1400},wd),pf=o.extend({deceleration:20,maxSpeed:1400},wd),Ht=o.extend({deceleration:1e3,maxSpeed:360},wd),Ts=o.extend({deceleration:1e3,maxSpeed:90},wd);class x0{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,p=o.exported.now();for(;u.length>0&&p-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const p={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:k}of this._inertiaBuffer)p.zoom+=k.zoomDelta||0,p.bearing+=k.bearingDelta||0,p.pitch+=k.pitchDelta||0,k.panDelta&&p.pan._add(k.panDelta),k.around&&(p.around=k.around),k.pinchAround&&(p.pinchAround=k.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(p.pan.mag()){const k=Ed(p.pan.mag(),b,o.extend({},ff,u||{}));S.offset=p.pan.mult(k.amount/p.pan.mag()),S.center=this._map.transform.center,Sd(S,k)}if(p.zoom){const k=Ed(p.zoom,b,pf);S.zoom=this._map.transform.zoom+k.amount,Sd(S,k)}if(p.bearing){const k=Ed(p.bearing,b,Ht);S.bearing=this._map.transform.bearing+o.clamp(k.amount,-179,179),Sd(S,k)}if(p.pitch){const k=Ed(p.pitch,b,Ts);S.pitch=this._map.transform.pitch+k.amount,Sd(S,k)}if(S.zoom||S.bearing){const k=p.pinchAround===void 0?p.around:p.pinchAround;S.around=k?this._map.unproject(k):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Sd(y,u){(!y.duration||y.duration<u.duration)&&(y.duration=u.duration,y.easing=u.easing)}function Ed(y,u,p){const{maxSpeed:b,linearity:S,deceleration:k}=p,M=o.clamp(y*S/(u/1e3),-b,b),P=Math.abs(M)/(k*S);return{easing:p.easing,duration:1e3*P,amount:M*(P/2)}}class Rr extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,b,S={}){const k=se(p.getCanvasContainer(),b),M=p.unproject(k);super(u,o.extend({point:k,lngLat:M,originalEvent:b},S)),this._defaultPrevented=!1,this.target=p}}class kd extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,b){const S=u==="touchend"?b.changedTouches:b.touches,k=ie(p.getCanvasContainer(),S),M=k.map(R=>p.unproject(R)),P=k.reduce((R,$,F,H)=>R.add($.div(H.length)),new o.Point(0,0));super(u,{points:k,point:P,lngLats:M,lngLat:p.unproject(P),originalEvent:b}),this._defaultPrevented=!1}}class mf extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,b){super(u,{originalEvent:b}),this._defaultPrevented=!1}}class rg{constructor(u,p){this._map=u,this._clickTolerance=p.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new mf(u.type,this._map,u))}mousedown(u,p){return this._mousedownPos=p,this._firePreventable(new Rr(u.type,this._map,u))}mouseup(u){this._map.fire(new Rr(u.type,this._map,u))}preclick(u){const p=o.extend({},u);p.type="preclick",this._map.fire(new Rr(p.type,this._map,p))}click(u,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||(this.preclick(u),this._map.fire(new Rr(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new Rr(u.type,this._map,u))}mouseover(u){this._map.fire(new Rr(u.type,this._map,u))}mouseout(u){this._map.fire(new Rr(u.type,this._map,u))}touchstart(u){return this._firePreventable(new kd(u.type,this._map,u))}touchmove(u){this._map.fire(new kd(u.type,this._map,u))}touchend(u){this._map.fire(new kd(u.type,this._map,u))}touchcancel(u){this._map.fire(new kd(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gf{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new Rr(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Rr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new Rr(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class w0{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,p){this.isEnabled()&&u.shiftKey&&u.button===0&&(V(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(u,p){if(!this._active)return;const b=p,S=this._startPos,k=this._lastPos;if(!S||!k||k.equals(b)||!this._box&&b.dist(S)<this._clickTolerance)return;this._lastPos=b,this._box||(this._box=T("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const M=Math.min(S.x,b.x),P=Math.max(S.x,b.x),R=Math.min(S.y,b.y),$=Math.max(S.y,b.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${R}px)`,this._box.style.width=P-M+"px",this._box.style.height=$-R+"px")})}mouseupWindow(u,p){if(!this._active)return;const b=this._startPos,S=p;if(b&&u.button===0){if(this.reset(),K(),b.x!==S.x||b.y!==S.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:k=>k.fitScreenCoordinates(b,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),N(),delete this._startPos,delete this._lastPos}_fireEvent(u,p){return this._map.fire(new o.Event(u,{originalEvent:p}))}}function yf(y,u){const p={};for(let b=0;b<y.length;b++)p[y[b].identifier]=u[b];return p}class Bc{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,p,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=u.timeStamp),b.length===this.numTouches&&(this.centroid=function(S){const k=new o.Point(0,0);for(const M of S)k._add(M);return k.div(S.length)}(p),this.touches=yf(b,p)))}touchmove(u,p,b){if(this.aborted||!this.centroid)return;const S=yf(b,p);for(const k in this.touches){const M=S[k];(!M||M.dist(this.touches[k])>30)&&(this.aborted=!0)}}touchend(u,p,b){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class og{constructor(u){this.singleTap=new Bc(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,p,b){this.singleTap.touchstart(u,p,b)}touchmove(u,p,b){this.singleTap.touchmove(u,p,b)}touchend(u,p,b){const S=this.singleTap.touchend(u,p,b);if(S){const k=u.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(S)<30;if(k&&M||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class zw{constructor(){this._zoomIn=new og({numTouches:1,numTaps:2}),this._zoomOut=new og({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,p,b){this._zoomIn.touchstart(u,p,b),this._zoomOut.touchstart(u,p,b)}touchmove(u,p,b){this._zoomIn.touchmove(u,p,b),this._zoomOut.touchmove(u,p,b)}touchend(u,p,b){const S=this._zoomIn.touchend(u,p,b),k=this._zoomOut.touchend(u,p,b);return S?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(S)},{originalEvent:u})}):k?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(k)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const S0={0:1,2:2};class Fc{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,p){return!1}_move(u,p){return{}}mousedown(u,p){if(this._lastPoint)return;const b=Q(u);this._correctButton(u,b)&&(this._lastPoint=p,this._eventButton=b)}mousemoveWindow(u,p){const b=this._lastPoint;if(b){if(u.preventDefault(),this._eventButton!=null&&function(S,k){const M=S0[k];return S.buttons===void 0||(S.buttons&M)!==M}(u,this._eventButton))this.reset();else if(this._moved||!(p.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(b,p)}}mouseupWindow(u){this._lastPoint&&Q(u)===this._eventButton&&(this._moved&&K(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sg extends Fc{mousedown(u,p){super.mousedown(u,p),this._lastPoint&&(this._active=!0)}_correctButton(u,p){return p===0&&!u.ctrlKey}_move(u,p){return{around:p,panDelta:p.sub(u)}}}class ag extends Fc{_correctButton(u,p){return p===0&&u.ctrlKey||p===2}_move(u,p){const b=.8*(p.x-u.x);if(b)return this._active=!0,{bearingDelta:b}}contextmenu(u){u.preventDefault()}}class lg extends Fc{_correctButton(u,p){return p===0&&u.ctrlKey||p===2}_move(u,p){const b=-.5*(p.y-u.y);if(b)return this._active=!0,{pitchDelta:b}}contextmenu(u){u.preventDefault()}}class vf{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=p.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)}touchstart(u,p,b){return this._calculateTransform(u,p,b)}touchmove(u,p,b){if(this._active&&!(b.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(b.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,p,b)}}touchend(u,p,b){this._calculateTransform(u,p,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,p,b){b.length>0&&(this._active=!0);const S=yf(b,p),k=new o.Point(0,0),M=new o.Point(0,0);let P=0;for(const $ in S){const F=S[$],H=this._touches[$];H&&(k._add(F),M._add(F.sub(H)),P++,S[$]=F)}if(this._touches=S,P<this._minTouches||!M.mag())return;const R=M.div(P);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:k.div(P),panDelta:R}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=T("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Td{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,p,b){return{}}touchstart(u,p,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([p[0],p[1]]))}touchmove(u,p,b){const S=this._firstTwoTouches;if(!S)return;u.preventDefault();const[k,M]=S,P=Cd(b,p,k),R=Cd(b,p,M);if(!P||!R)return;const $=this._aroundCenter?null:P.add(R).div(2);return this._move([P,R],$,u)}touchend(u,p,b){if(!this._firstTwoTouches)return;const[S,k]=this._firstTwoTouches,M=Cd(b,p,S),P=Cd(b,p,k);M&&P||(this._active&&K(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Cd(y,u,p){for(let b=0;b<y.length;b++)if(y[b].identifier===p)return u[b]}function cg(y,u){return Math.log(y/u)/Math.LN2}class E0 extends Td{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,p){const b=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(cg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cg(this._distance,b),pinchAround:p}}}function ug(y,u){return 180*y.angleWith(u)/Math.PI}class k0 extends Td{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,p){const b=this._vector;if(this._vector=u[0].sub(u[1]),b&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ug(this._vector,b),pinchAround:p}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const p=25/(Math.PI*this._minDiameter)*360,b=this._startVector;if(!b)return!1;const S=ug(u,b);return Math.abs(S)<p}}function sl(y){return Math.abs(y.y)>Math.abs(y.x)}class T0 extends Td{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,sl(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,p,b){const S=this._lastPoints;if(!S)return;const k=u[0].sub(S[0]),M=u[1].sub(S[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&b.touches.length<3||(this._valid=this.gestureBeginsVertically(k,M,b.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(k.y+M.y)/2*-.5})}gestureBeginsVertically(u,p,b){if(this._valid!==void 0)return this._valid;const S=u.mag()>=2,k=p.mag()>=2;if(!S&&!k)return;if(!S||!k)return this._firstMove==null&&(this._firstMove=b),b-this._firstMove<100&&void 0;const M=u.y>0==p.y>0;return sl(u)&&sl(p)&&M}}const C0={panStep:100,bearingStep:15,pitchStep:10};class Bw{constructor(){const u=C0;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let p=0,b=0,S=0,k=0,M=0;switch(u.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:u.shiftKey?b=-1:(u.preventDefault(),k=-1);break;case 39:u.shiftKey?b=1:(u.preventDefault(),k=1);break;case 38:u.shiftKey?S=1:(u.preventDefault(),M=-1);break;case 40:u.shiftKey?S=-1:(u.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(b=0,S=0),{cameraAnimation:P=>{const R=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:I0,zoom:p?Math.round(R)+p*(u.shiftKey?2:1):R,bearing:P.getBearing()+b*this._bearingStep,pitch:P.getPitch()+S*this._pitchStep,offset:[-k*this._panStep,-M*this._panStep],center:P.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function I0(y){return y*(2-y)}const dg=4.000244140625;class A0{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let p=u.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const b=o.exported.now(),S=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,p!==0&&p%dg==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(S*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),u.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=u,this._delta-=p,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=se(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:p,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;this._type==="wheel"&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const p=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>dg?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&$!==0&&($=1/$);const F=p(),H=Math.pow(2,F),ne=typeof this._targetZoom=="number"?u.zoomScale(this._targetZoom):H;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(ne*$))),this._type==="wheel"&&(this._startZoom=F,this._easing=this._smoothOutEasing(200)),this._delta=0}const b=typeof this._targetZoom=="number"?this._targetZoom:p(),S=this._startZoom,k=this._easing;let M,P=!1;if(this._type==="wheel"&&S&&k){const R=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),$=k(R);M=o.number(S,b,$),R<1?this._frameId||(this._frameId=!0):P=!0}else M=b,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:M-p(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let p=o.ease;if(this._prevEase){const b=this._prevEase,S=(o.exported.now()-b.start)/b.duration,k=b.easing(S+.01)-b.easing(S),M=.27/Math.sqrt(k*k+1e-4)*.01,P=Math.sqrt(.0729-M*M);p=o.bezier(M,P,.25,1)}return this._prevEase={start:o.exported.now(),duration:u,easing:p},p}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=T("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class M0{constructor(u,p){this._clickZoom=u,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Jr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,p){return u.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:b.getZoom()+(u.shiftKey?-1:1),around:b.unproject(p)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fw{constructor(){this._tap=new og({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,p,b){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=p[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(u,p,b))}touchmove(u,p,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const S=p[0],k=S.y-this._swipePoint.y;return this._swipePoint=S,u.preventDefault(),this._active=!0,{zoomDelta:k/128}}}else this._tap.touchmove(u,p,b)}touchend(u,p,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(u,p,b)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class P0{constructor(u,p,b){this._el=u,this._mousePan=p,this._touchPan=b}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nw{constructor(u,p,b){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=p,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class $w{constructor(u,p,b,S){this._el=u,this._touchZoom=p,this._touchRotate=b,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const as=y=>y.zoom||y.drag||y.pitch||y.rotate;class O0 extends o.Event{}class jw{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,p){const b=o.sub([],p,u);this.radius=o.length(b[2]<0?o.div([],b,this.constants):[b[0],b[1],0])}projectRay(u){o.div(u,u,this.constants),o.normalize(u,u),o.mul$1(u,u,this.constants);const p=o.scale$2([],u,this.radius);if(p[2]>0){const b=o.scale$2([],[0,0,1],o.dot(p,[0,0,1])),S=o.scale$2([],o.normalize([],[p[0],p[1],0]),this.radius),k=o.add([],p,o.scale$2([],o.sub([],o.add([],S,b),p),2));p[0]=k[0],p[1]=k[1]}return p}}function Cs(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class Ys{constructor(u,p){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new x0(u),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new jw,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(p),o.bindAll(["handleEvent","handleWindowEvent"],this);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[S,k,M]of this._listeners)S.addEventListener(k,S===o.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[u,p,b]of this._listeners)u.removeEventListener(p,u===o.window.document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(u){const p=this._map,b=p.getCanvasContainer();this._add("mapEvent",new rg(p,u));const S=p.boxZoom=new w0(p,u);this._add("boxZoom",S);const k=new zw,M=new Jr;p.doubleClickZoom=new M0(M,k),this._add("tapZoom",k),this._add("clickZoom",M);const P=new Fw;this._add("tapDragZoom",P);const R=p.touchPitch=new T0(p);this._add("touchPitch",R);const $=new ag(u),F=new lg(u);p.dragRotate=new Nw(u,$,F),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const H=new sg(u),ne=new vf(p,u);p.dragPan=new P0(b,H,ne),this._add("mousePan",H),this._add("touchPan",ne,["touchZoom","touchRotate"]);const ae=new k0,ue=new E0;p.touchZoomRotate=new $w(b,ue,ae,P),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),this._add("blockableMapEvent",new gf(p));const le=p.scrollZoom=new A0(p,this);this._add("scrollZoom",le,["mousePan"]);const de=p.keyboard=new Bw;this._add("keyboard",de);for(const Z of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[Z]&&p[Z].enable(u[Z])}_add(u,p,b){this._handlers.push({handlerName:u,handler:p,allowed:b}),this._handlersById[u]=p}stop(u){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!as(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,p,b){for(const S in u)if(S!==b&&(!p||p.indexOf(S)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const p=[];for(const b of u)this._el.contains(b.target)&&p.push(b);return p}handleEvent(u,p){this._updatingCamera=!0;const b=u.type==="renderFrame",S=b?void 0:u,k={needsRenderFrame:!1},M={},P={},R=u.touches?this._getMapTouches(u.touches):void 0,$=R?ie(this._el,R):b?void 0:se(this._el,u);for(const{handlerName:ne,handler:ae,allowed:ue}of this._handlers){if(!ae.isEnabled())continue;let le;this._blockedByActive(P,ue,ne)?ae.reset():ae[p||u.type]&&(le=ae[p||u.type](u,$,R),this.mergeHandlerResult(k,M,le,ne,S),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||ae.isActive())&&(P[ne]=ae)}const F={};for(const ne in this._previousActiveHandlers)P[ne]||(F[ne]=S);this._previousActiveHandlers=P,(Object.keys(F).length||Cs(k))&&(this._changes.push([k,M,F]),this._triggerRenderFrame()),(Object.keys(P).length||Cs(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=k;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))}mergeHandlerResult(u,p,b,S,k){if(!b)return;o.extend(u,b);const M={handlerName:S,originalEvent:b.originalEvent||k};b.zoomDelta!==void 0&&(p.zoom=M),b.panDelta!==void 0&&(p.drag=M),b.pitchDelta!==void 0&&(p.pitch=M),b.bearingDelta!==void 0&&(p.rotate=M)}_applyChanges(){const u={},p={},b={};for(const[S,k,M]of this._changes)S.panDelta&&(u.panDelta=(u.panDelta||new o.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(u.around=S.around),S.aroundCoord!==void 0&&(u.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(u.pinchAround=S.pinchAround),S.noInertia&&(u.noInertia=S.noInertia),o.extend(p,k),o.extend(b,M);this._updateMapTransform(u,p,b),this._changes=[]}_updateMapTransform(u,p,b){const S=this._map,k=S.transform,M=oe=>[oe.x,oe.y,oe.z];if((oe=>{const ge=this._eventsInProgress.drag;return ge&&!this._handlersById[ge.handlerName].isActive()})()&&!Cs(u)){const oe=k.zoom;k.cameraElevationReference="sea",k.recenterOnTerrain(),k.cameraElevationReference="ground",oe!==k.zoom&&this._map._update(!0)}if(k._isCameraConstrained&&S._stop(!0),!Cs(u))return void this._fireEvents(p,b,!0);let{panDelta:P,zoomDelta:R,bearingDelta:$,pitchDelta:F,around:H,aroundCoord:ne,pinchAround:ae}=u;k._isCameraConstrained&&(R>0&&(R=0),k._isCameraConstrained=!1),ae!==void 0&&(H=ae),(R||(oe=>p[oe]&&!this._eventsInProgress[oe])("drag"))&&H&&(this._dragOrigin=M(k.pointCoordinate3D(H)),this._trackingEllipsoid.setup(k._camera.position,this._dragOrigin)),k.cameraElevationReference="sea",S._stop(!0),H=H||S.transform.centerPoint,$&&(k.bearing+=$),F&&(k.pitch+=F),k._updateCameraState();const ue=[0,0,0];if(P)if(k.projection.name==="mercator"){const oe=this._trackingEllipsoid.projectRay(k.screenPointToMercatorRay(H).dir),ge=this._trackingEllipsoid.projectRay(k.screenPointToMercatorRay(H.sub(P)).dir);ue[0]=ge[0]-oe[0],ue[1]=ge[1]-oe[1]}else{const oe=k.pointCoordinate(H);if(k.projection.name==="globe"){P=P.rotate(-k.angle);const ge=k._pixelsPerMercatorPixel/k.worldSize;ue[0]=-P.x*o.mercatorScale(o.latFromMercatorY(oe.y))*ge,ue[1]=-P.y*o.mercatorScale(k.center.lat)*ge}else{const ge=k.pointCoordinate(H.sub(P));oe&&ge&&(ue[0]=ge.x-oe.x,ue[1]=ge.y-oe.y)}}const le=k.zoom,de=[0,0,0];if(R){const oe=M(ne||k.pointCoordinate3D(H)),ge={dir:o.normalize([],o.sub([],oe,k._camera.position))};if(ge.dir[2]<0){const ye=k.zoomDeltaToMovement(oe,R);o.scale$2(de,ge.dir,ye)}}const Z=o.add(ue,ue,de);k._translateCameraConstrained(Z),R&&Math.abs(k.zoom-le)>1e-4&&k.recenterOnTerrain(),k.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(p,b,!0)}_fireEvents(u,p,b){const S=as(this._eventsInProgress),k=as(u),M={};for(const F in u){const{originalEvent:H}=u[F];this._eventsInProgress[F]||(M[`${F}start`]=H),this._eventsInProgress[F]=u[F]}!S&&k&&this._fireEvent("movestart",k.originalEvent);for(const F in M)this._fireEvent(F,M[F]);k&&this._fireEvent("move",k.originalEvent);for(const F in u){const{originalEvent:H}=u[F];this._fireEvent(F,H)}const P={};let R;for(const F in this._eventsInProgress){const{handlerName:H,originalEvent:ne}=this._eventsInProgress[F];this._handlersById[H].isActive()||(delete this._eventsInProgress[F],R=p[H]||ne,P[`${F}end`]=R)}for(const F in P)this._fireEvent(F,P[F]);const $=as(this._eventsInProgress);if(b&&(S||k)&&!$){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=ne=>ne!==0&&-this._bearingSnap<ne&&ne<this._bearingSnap;F?(H(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:R})):(this._map.fire(new o.Event("moveend",{originalEvent:R})),H(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,p){this._map.fire(new o.Event(u,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new O0("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ul="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class bf extends o.Evented{constructor(u,p){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=p.bearingSnap,this._respectPrefersReducedMotion=p.respectPrefersReducedMotion!==!1,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(u,p){return this.jumpTo({center:u},p)}panBy(u,p,b){return u=o.Point.convert(u).mult(-1),this.panTo(this.transform.center,o.extend({offset:u},p),b)}panTo(u,p,b){return this.easeTo(o.extend({center:u},p),b)}getZoom(){return this.transform.zoom}setZoom(u,p){return this.jumpTo({zoom:u},p),this}zoomTo(u,p,b){return this.easeTo(o.extend({zoom:u},p),b)}zoomIn(u,p){return this.zoomTo(this.getZoom()+1,u,p),this}zoomOut(u,p){return this.zoomTo(this.getZoom()-1,u,p),this}getBearing(){return this.transform.bearing}setBearing(u,p){return this.jumpTo({bearing:u},p),this}getPadding(){return this.transform.padding}setPadding(u,p){return this.jumpTo({padding:u},p),this}rotateTo(u,p,b){return this.easeTo(o.extend({bearing:u},p),b)}resetNorth(u,p){return this.rotateTo(0,o.extend({duration:1e3},u),p),this}resetNorthPitch(u,p){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},u),p),this}snapToNorth(u,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,p):this}getPitch(){return this.transform.pitch}setPitch(u,p){return this.jumpTo({pitch:u},p),this}cameraForBounds(u,p){u=o.LngLatBounds.convert(u);const b=p&&p.bearing||0,S=p&&p.pitch||0,k=u.getNorthWest(),M=u.getSouthEast();return this._cameraForBounds(this.transform,k,M,b,S,p)}_extendCameraOptions(u){const p={top:0,bottom:0,right:0,left:0};if(typeof(u=o.extend({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const b=u.padding;u.padding={top:b,bottom:b,right:b,left:b}}return u.padding=o.extend(p,u.padding),u}_minimumAABBFrustumDistance(u,p){const b=p.max[0]-p.min[0],S=p.max[1]-p.min[1];return b/S>u.aspect?b/(2*Math.tan(.5*u.fovX)*u.aspect):S/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,p,b,S,k,M){const P=u.clone(),R=this._extendCameraOptions(M);P.bearing=S,P.pitch=k;const $=o.LngLat.convert(p),F=o.LngLat.convert(b),H=.5*($.lat+F.lat),ne=.5*($.lng+F.lng),ae=o.latLngToECEF(H,ne),ue=o.normalize([],ae),le=o.normalize([],o.cross([],ue,[0,1,0])),de=o.cross([],le,ue),Z=[le[0],le[1],le[2],0,de[0],de[1],de[2],0,ue[0],ue[1],ue[2],0,0,0,0,1],oe=[ae,o.latLngToECEF($.lat,$.lng),o.latLngToECEF(F.lat,$.lng),o.latLngToECEF(F.lat,F.lng),o.latLngToECEF($.lat,F.lng),o.latLngToECEF(H,$.lng),o.latLngToECEF(H,F.lng),o.latLngToECEF($.lat,ne),o.latLngToECEF(F.lat,ne)];let ge=o.Aabb.fromPoints(oe.map(pt=>[o.dot(le,pt),o.dot(de,pt),o.dot(ue,pt)]));const ye=o.transformMat4([],ge.center,Z);o.squaredLength(ye)===0&&o.set(ye,0,0,1),o.normalize(ye,ye),o.scale$2(ye,ye,o.GLOBE_RADIUS),P.center=o.ecefToLatLng(ye);const Te=P.getWorldToCameraMatrix(),Ie=o.invert(new Float64Array(16),Te);ge=o.Aabb.applyTransform(ge,o.multiply([],Te,Z)),o.transformMat4(ye,ye,Te);const Ce=.5*(ge.max[2]-ge.min[2]),Le=this._minimumAABBFrustumDistance(P,ge),Re=o.scale$2([],[0,0,1],Ce),Ge=o.add(Re,ye,Re),St=Le+(P.pitch===0?0:o.distance(ye,Ge)),Ve=P.globeCenterInViewSpace,ut=o.sub([],ye,[Ve[0],Ve[1],Ve[2]]);o.normalize(ut,ut),o.scale$2(ut,ut,St);const Ye=o.add([],ye,ut);o.transformMat4(Ye,Ye,Ie);const bt=o.earthRadius/o.GLOBE_RADIUS,qe=o.length(Ye),ct=o.mercatorZfromAltitude(Math.max(qe*bt-o.earthRadius,Number.EPSILON),0),Tt=Math.min(P.zoomFromMercatorZAdjusted(ct),R.maxZoom);return Tt>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"mercator"}),P.zoom=Tt,this._cameraForBounds(P,p,b,S,k,M)):{center:P.center,zoom:Tt,bearing:S,pitch:k}}queryTerrainElevation(u,p){const b=this.transform.elevation;return b?(p=o.extend({},{exaggerated:!0},p),b.getAtPoint(o.MercatorCoordinate.fromLngLat(u),null,p.exaggerated)):null}_cameraForBounds(u,p,b,S,k,M){if(u.projection.name==="globe")return this._cameraForBoundsOnGlobe(u,p,b,S,k,M);const P=u.clone(),R=this._extendCameraOptions(M),$=P.padding;P.bearing=S,P.pitch=k;const F=o.LngLat.convert(p),H=o.LngLat.convert(b),ne=new o.LngLat(F.lng,H.lat),ae=new o.LngLat(H.lng,F.lat),ue=P.project(F),le=P.project(H),de=this.queryTerrainElevation(F),Z=this.queryTerrainElevation(H),oe=this.queryTerrainElevation(ne),ge=this.queryTerrainElevation(ae),ye=[[ue.x,ue.y,Math.min(de||0,Z||0,oe||0,ge||0)],[le.x,le.y,Math.max(de||0,Z||0,oe||0,ge||0)]];let Te=o.Aabb.fromPoints(ye);const Ie=P.getWorldToCameraMatrix(),Ce=o.invert(new Float64Array(16),Ie);Te=o.Aabb.applyTransform(Te,Ie);const Le=o.sub([],Te.max,Te.min),Re=$.left||0,Ge=$.right||0,St=$.bottom||0,Ve=$.top||0,{left:ut,right:Ye,top:bt,bottom:qe}=R.padding,ct=.5*(Re+Ge),Tt=.5*(Ve+St),pt=Math.min(P.scaleZoom(P.scale*Math.min((P.width-(Re+Ge+ut+Ye))/Le[0],(P.height-(St+Ve+qe+bt))/Le[1])),R.maxZoom),It=P.scale/P.zoomScale(pt);Te=new o.Aabb([Te.min[0]-(ut+ct)*It,Te.min[1]-(qe+Tt)*It,Te.min[2]],[Te.max[0]+(Ye+ct)*It,Te.max[1]+(bt+Tt)*It,Te.max[2]]);const rn=.5*Le[2],vn=this._minimumAABBFrustumDistance(P,Te),Yt=[0,0,1,0];o.transformMat4$1(Yt,Yt,Ie),o.normalize$2(Yt,Yt);const un=o.scale$2([],Yt,vn+rn),Dn=o.add([],Te.center,un),Mn=(typeof R.offset.x=="number"&&typeof R.offset.y=="number"?new o.Point(R.offset.x,R.offset.y):o.Point.convert(R.offset)).rotate(-o.degToRad(S));Te.center[0]-=Mn.x*It,Te.center[1]+=Mn.y*It,o.transformMat4(Te.center,Te.center,Ce),o.transformMat4(Dn,Dn,Ce);const tn=[Te.center[0],Te.center[1],Dn[2]*P.pixelsPerMeter];o.scale$2(tn,tn,1/P.worldSize);const Qn=o.lngFromMercatorX(tn[0]),oi=o.latFromMercatorY(tn[1]),si=Math.min(P._zoomFromMercatorZ(tn[2]),R.maxZoom),ai=new o.LngLat(Qn,oi);return P.mercatorFromTransition&&si<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"globe"}),P.zoom=si,this._cameraForBounds(P,p,b,S,k,M)):{center:ai,zoom:si,bearing:S,pitch:k}}fitBounds(u,p,b){const S=this.cameraForBounds(u,p);return this._fitInternal(S,p,b)}fitScreenCoordinates(u,p,b,S,k){const M=o.Point.convert(u),P=o.Point.convert(p),R=new o.Point(Math.min(M.x,P.x),Math.min(M.y,P.y)),$=new o.Point(Math.max(M.x,P.x),Math.max(M.y,P.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(M,P))return this;const F=this.transform.pointLocation3D(R),H=this.transform.pointLocation3D($),ne=this.transform.pointLocation3D(new o.Point(R.x,$.y)),ae=this.transform.pointLocation3D(new o.Point($.x,R.y)),ue=[Math.min(F.lng,H.lng,ne.lng,ae.lng),Math.min(F.lat,H.lat,ne.lat,ae.lat)],le=[Math.max(F.lng,H.lng,ne.lng,ae.lng),Math.max(F.lat,H.lat,ne.lat,ae.lat)],de=S&&S.pitch?S.pitch:this.getPitch(),Z=this._cameraForBounds(this.transform,ue,le,b,de,S);return this._fitInternal(Z,S,k)}_fitInternal(u,p,b){return u?(delete(p=o.extend(u,p)).padding,p.linear?this.easeTo(p,b):this.flyTo(p,b)):this}jumpTo(u,p){this.stop();const b=u.preloadOnly?this.transform.clone():this.transform;let S=!1,k=!1,M=!1;return"zoom"in u&&b.zoom!==+u.zoom&&(S=!0,b.zoom=+u.zoom),u.center!==void 0&&(b.center=o.LngLat.convert(u.center)),"bearing"in u&&b.bearing!==+u.bearing&&(k=!0,b.bearing=+u.bearing),"pitch"in u&&b.pitch!==+u.pitch&&(M=!0,b.pitch=+u.pitch),u.padding==null||b.isPaddingEqual(u.padding)||(b.padding=u.padding),u.preloadOnly?(this._preloadTiles(b),this):(this.fire(new o.Event("movestart",p)).fire(new o.Event("move",p)),S&&this.fire(new o.Event("zoomstart",p)).fire(new o.Event("zoom",p)).fire(new o.Event("zoomend",p)),k&&this.fire(new o.Event("rotatestart",p)).fire(new o.Event("rotate",p)).fire(new o.Event("rotateend",p)),M&&this.fire(new o.Event("pitchstart",p)).fire(new o.Event("pitch",p)).fire(new o.Event("pitchend",p)),this.fire(new o.Event("moveend",p)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Ul),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,p){const b=this.transform;if(!b.projection.supportsFreeCamera)return o.warnOnce(Ul),this;this.stop();const S=b.zoom,k=b.pitch,M=b.bearing;b.setFreeCameraOptions(u);const P=S!==b.zoom,R=k!==b.pitch,$=M!==b.bearing;return this.fire(new o.Event("movestart",p)).fire(new o.Event("move",p)),P&&this.fire(new o.Event("zoomstart",p)).fire(new o.Event("zoom",p)).fire(new o.Event("zoomend",p)),$&&this.fire(new o.Event("rotatestart",p)).fire(new o.Event("rotate",p)).fire(new o.Event("rotateend",p)),R&&this.fire(new o.Event("pitchstart",p)).fire(new o.Event("pitch",p)).fire(new o.Event("pitchend",p)),this.fire(new o.Event("moveend",p)),this}easeTo(u,p){this._stop(!1,u.easeId),((u=o.extend({offset:[0,0],duration:500,easing:o.ease},u)).animate===!1||this._prefersReducedMotion(u))&&(u.duration=0);const b=this.transform,S=this.getZoom(),k=this.getBearing(),M=this.getPitch(),P=this.getPadding(),R="zoom"in u?+u.zoom:S,$="bearing"in u?this._normalizeBearing(u.bearing,k):k,F="pitch"in u?+u.pitch:M,H="padding"in u?u.padding:b.padding,ne=o.Point.convert(u.offset);let ae,ue,le;if(b.projection.name==="globe"){const Re=o.MercatorCoordinate.fromLngLat(b.center),Ge=ne.rotate(-b.angle);Re.x+=Ge.x/b.worldSize,Re.y+=Ge.y/b.worldSize;const St=Re.toLngLat(),Ve=o.LngLat.convert(u.center||St);this._normalizeCenter(Ve),ae=b.centerPoint.add(Ge),ue=new o.Point(Re.x,Re.y).mult(b.worldSize),le=new o.Point(o.mercatorXfromLng(Ve.lng),o.mercatorYfromLat(Ve.lat)).mult(b.worldSize).sub(ue)}else{ae=b.centerPoint.add(ne);const Re=b.pointLocation(ae),Ge=o.LngLat.convert(u.center||Re);this._normalizeCenter(Ge),ue=b.project(Re),le=b.project(Ge).sub(ue)}const de=b.zoomScale(R-S);let Z,oe;u.around&&(Z=o.LngLat.convert(u.around),oe=b.locationPoint(Z));const ge=this._zooming||R!==S,ye=this._rotating||k!==$,Te=this._pitching||F!==M,Ie=!b.isPaddingEqual(H),Ce=Re=>Ge=>{if(ge&&(Re.zoom=o.number(S,R,Ge)),ye&&(Re.bearing=o.number(k,$,Ge)),Te&&(Re.pitch=o.number(M,F,Ge)),Ie&&(Re.interpolatePadding(P,H,Ge),ae=Re.centerPoint.add(ne)),Z)Re.setLocationAtPoint(Z,oe);else{const St=Re.zoomScale(Re.zoom-S),Ve=R>S?Math.min(2,de):Math.max(.5,de),ut=Math.pow(Ve,1-Ge),Ye=Re.unproject(ue.add(le.mult(Ge*ut)).mult(St));Re.setLocationAtPoint(Re.renderWorldCopies?Ye.wrap():Ye,ae)}return u.preloadOnly||this._fireMoveEvents(p),Re};if(u.preloadOnly){const Re=this._emulate(Ce,u.duration,b);return this._preloadTiles(Re),this}const Le={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ge,this._rotating=ye,this._pitching=Te,this._padding=Ie,this._easeId=u.easeId,this._prepareEase(p,u.noMoveStart,Le),this._ease(Ce(b),Re=>{b.recenterOnTerrain(),this._afterEase(p,Re)},u),this}_prepareEase(u,p,b={}){this._moving=!0,this.transform.cameraElevationReference="sea",p||b.moving||this.fire(new o.Event("movestart",u)),this._zooming&&!b.zooming&&this.fire(new o.Event("zoomstart",u)),this._rotating&&!b.rotating&&this.fire(new o.Event("rotatestart",u)),this._pitching&&!b.pitching&&this.fire(new o.Event("pitchstart",u))}_fireMoveEvents(u){this.fire(new o.Event("move",u)),this._zooming&&this.fire(new o.Event("zoom",u)),this._rotating&&this.fire(new o.Event("rotate",u)),this._pitching&&this.fire(new o.Event("pitch",u))}_afterEase(u,p){if(this._easeId&&p&&this._easeId===p)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const b=this._zooming,S=this._rotating,k=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new o.Event("zoomend",u)),S&&this.fire(new o.Event("rotateend",u)),k&&this.fire(new o.Event("pitchend",u)),this.fire(new o.Event("moveend",u))}flyTo(u,p){if(this._prefersReducedMotion(u)){const pt=o.pick(u,["center","zoom","bearing","pitch","around"]);return this.jumpTo(pt,p)}this.stop(),u=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},u);const b=this.transform,S=this.getZoom(),k=this.getBearing(),M=this.getPitch(),P=this.getPadding(),R="zoom"in u?o.clamp(+u.zoom,b.minZoom,b.maxZoom):S,$="bearing"in u?this._normalizeBearing(u.bearing,k):k,F="pitch"in u?+u.pitch:M,H="padding"in u?u.padding:b.padding,ne=b.zoomScale(R-S),ae=o.Point.convert(u.offset);let ue=b.centerPoint.add(ae);const le=b.pointLocation(ue),de=o.LngLat.convert(u.center||le);this._normalizeCenter(de);const Z=b.project(le),oe=b.project(de).sub(Z);let ge=u.curve;const ye=Math.max(b.width,b.height),Te=ye/ne,Ie=oe.mag();if("minZoom"in u){const pt=o.clamp(Math.min(u.minZoom,S,R),b.minZoom,b.maxZoom),It=ye/b.zoomScale(pt-S);ge=Math.sqrt(It/Ie*2)}const Ce=ge*ge;function Le(pt){const It=(Te*Te-ye*ye+(pt?-1:1)*Ce*Ce*Ie*Ie)/(2*(pt?Te:ye)*Ce*Ie);return Math.log(Math.sqrt(It*It+1)-It)}function Re(pt){return(Math.exp(pt)-Math.exp(-pt))/2}function Ge(pt){return(Math.exp(pt)+Math.exp(-pt))/2}const St=Le(0);let Ve=function(pt){return Ge(St)/Ge(St+ge*pt)},ut=function(pt){return ye*((Ge(St)*(Re(It=St+ge*pt)/Ge(It))-Re(St))/Ce)/Ie;var It},Ye=(Le(1)-St)/ge;if(Math.abs(Ie)<1e-6||!isFinite(Ye)){if(Math.abs(ye-Te)<1e-6)return this.easeTo(u,p);const pt=Te<ye?-1:1;Ye=Math.abs(Math.log(Te/ye))/ge,ut=function(){return 0},Ve=function(It){return Math.exp(pt*ge*It)}}u.duration="duration"in u?+u.duration:1e3*Ye/("screenSpeed"in u?+u.screenSpeed/ge:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const bt=k!==$,qe=F!==M,ct=!b.isPaddingEqual(H),Tt=pt=>It=>{const rn=It*Ye,vn=1/Ve(rn);pt.zoom=It===1?R:S+pt.scaleZoom(vn),bt&&(pt.bearing=o.number(k,$,It)),qe&&(pt.pitch=o.number(M,F,It)),ct&&(pt.interpolatePadding(P,H,It),ue=pt.centerPoint.add(ae));const Yt=It===1?de:pt.unproject(Z.add(oe.mult(ut(rn))).mult(vn));return pt.setLocationAtPoint(pt.renderWorldCopies?Yt.wrap():Yt,ue),pt._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(p),pt};if(u.preloadOnly){const pt=this._emulate(Tt,u.duration,b);return this._preloadTiles(pt),this}return this._zooming=!0,this._rotating=bt,this._pitching=qe,this._padding=ct,this._prepareEase(p,!1),this._ease(Tt(b),()=>this._afterEase(p),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const b=this._onEaseEnd;this._onEaseEnd=void 0,b.call(this,p)}if(!u){const b=this.handlers;b&&b.stop(!1)}return this}_ease(u,p,b){b.animate===!1||b.duration===0?(u(1),p()):(this._easeStart=o.exported.now(),this._easeOptions=b,this._onEaseFrame=u,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),p=this._onEaseFrame;p&&p(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,p){u=o.wrap(u,-180,180);const b=Math.abs(u-p);return Math.abs(u-360-p)<b&&(u-=360),Math.abs(u+360-p)<b&&(u+=360),u}_normalizeCenter(u){const p=this.transform;if(!p.renderWorldCopies||p.maxBounds)return;const b=u.lng-p.center.lng;u.lng+=b>180?-360:b<-180?360:0}_prefersReducedMotion(u){return this._respectPrefersReducedMotion&&o.exported.prefersReducedMotion&&!(u&&u.essential)}_emulate(u,p,b){const S=Math.ceil(15*p/1e3),k=[],M=u(b.clone());for(let P=0;P<=S;P++){const R=M(P/S);k.push(R.clone())}return k}}class Kt{constructor(u={}){this.options=u,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const p=this.options&&this.options.compact;return this._map=u,this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T("button","mapboxgl-ctrl-attrib-button",this._container),T("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),p===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(u,p){const b=this._map._getUIString(`AttributionControl.${p}`);u.setAttribute("aria-label",b),u.removeAttribute("title"),u.firstElementChild&&u.firstElementChild.setAttribute("title",b)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(u){const b=p.reduce((S,k,M)=>(k.value&&(S+=`${k.key}=${k.value}${M<p.length-1?"&":""}`),S),"?");u.href=`${o.config.FEEDBACK_URL}/${b}#${xd(this._map,!0)}`,u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}}_updateData(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const p=this._map.style._sourceCaches;for(const S in p){const k=p[S];if(k.used){const M=k.getSource();M.attribution&&u.indexOf(M.attribution)<0&&u.push(M.attribution)}}u.sort((S,k)=>S.length-k.length),u=u.filter((S,k)=>{for(let M=k+1;M<u.length;M++)if(u[M].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const b=u.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,u.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class hg{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=T("div","mapboxgl-ctrl");const p=T("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(Object.entries(u).length===0)return!0;for(const p in u){const b=u[p].getSource();if(b.hasOwnProperty("mapbox_logo")&&!b.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}}}class fg{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const p=++this._id;return this._queue.push({callback:u,id:p,cancelled:!1}),p}remove(u){const p=this._currentlyRunning,b=p?this._queue.concat(p):this._queue;for(const S of b)if(S.id===u)return void(S.cancelled=!0)}run(u=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const b of p)if(!b.cancelled&&(b.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Nc(y,u,p){if(y=new o.LngLat(y.lng,y.lat),u){const b=new o.LngLat(y.lng-360,y.lat),S=new o.LngLat(y.lng+360,y.lat),k=360*Math.ceil(Math.abs(y.lng-p.center.lng)/360),M=p.locationPoint(y).distSqr(u),P=u.x<0||u.y<0||u.x>p.width||u.y>p.height;p.locationPoint(b).distSqr(u)<M&&(P||Math.abs(b.lng-p.center.lng)<k)?y=b:p.locationPoint(S).distSqr(u)<M&&(P||Math.abs(S.lng-p.center.lng)<k)&&(y=S)}for(;Math.abs(y.lng-p.center.lng)>180;){const b=p.locationPoint(y);if(b.x>=0&&b.y>=0&&b.x<=p.width&&b.y<=p.height)break;y.lng>p.center.lng?y.lng-=360:y.lng+=360}return y}const ql={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Wt extends o.Evented{constructor(u,p){if(super(),(u instanceof o.window.HTMLElement||p)&&(u=o.extend({element:u},p)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=o.Point.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=T("div");const S=41,k=27,M=A("svg",{display:"block",height:S*this._scale+"px",width:k*this._scale+"px",viewBox:`0 0 ${k} ${S}`},this._element),P=A("radialGradient",{id:"shadowGradient"},A("defs",{},M));A("stop",{offset:"10%","stop-opacity":.4},P),A("stop",{offset:"100%","stop-opacity":.05},P),A("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),A("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),A("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),A("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=o.Point.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const b=this._element.classList;for(const S in ql)b.remove(`mapboxgl-marker-anchor-${S}`);b.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=o.LngLat.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const p=u.code,b=u.charCode||u.keyCode;p!=="Space"&&p!=="Enter"&&b!==32&&b!==13||this.togglePopup()}_onMapClick(u){const p=u.originalEvent.target,b=this._element;this._popup&&(p===b||b.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,p=this._pos;if(!u||!p)return!1;const b=u.unproject(p),S=u.getFreeCameraOptions();if(!S.position)return!1;const k=S.position.toLngLat();return k.distanceTo(b)<.9*k.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const p=this._pos;if(!p||p.x<0||p.x>u.transform.width||p.y<0||p.y>u.transform.height)return void this._clearFadeTimer();const b=u.unproject(p);let S;u._showingGlobe()&&o.isLngLatBehindGlobe(u.transform,this._lngLat)?S=0:(S=1-u._queryFogOpacity(b),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const p=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${u.x}px,${u.y}px)
            ${ql[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${p.x}px,${p.y}px)
        `}_calculateXYTransform(){const u=this._pos,p=this._map,b=this.getPitchAlignment();if(!p||!u||b!=="map")return"";if(!p._showingGlobe()){const R=p.getPitch();return R?`rotateX(${R}deg)`:""}const S=o.radToDeg(o.globeTiltAtLngLat(p.transform,this._lngLat)),k=u.sub(o.globeCenterToScreenPoint(p.transform)),M=Math.abs(k.x)+Math.abs(k.y);if(M===0)return"";const P=S/M;return`rotateX(${-k.y*P}deg) rotateY(${k.x*P}deg)`}_calculateZTransform(){const u=this._pos,p=this._map;if(!p||!u)return"";let b=0;const S=this.getRotationAlignment();if(S==="map")if(p._showingGlobe()){const k=p.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),M=p.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(k);b=o.radToDeg(Math.atan2(M.y,M.x))-90}else b=-p.getBearing();else if(S==="horizon"){const k=o.smoothstep(4,6,p.getZoom()),M=o.globeCenterToScreenPoint(p.transform);M.y+=k*p.transform.height;const P=u.sub(M),R=o.radToDeg(Math.atan2(P.y,P.x));b=(R>90?R-270:R+90)*(1-k)}return b+=this._rotation,b?`rotateZ(${b}deg)`:""}_update(u){o.window.cancelAnimationFrame(this._updateFrameId);const p=this._map;p&&(p.transform.renderWorldCopies&&(this._lngLat=Nc(this._lngLat,this._pos,p.transform)),this._pos=p.project(this._lngLat),u===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),p._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(p._showingGlobe()||p.getTerrain()||p.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=o.Point.convert(u),this._update(),this}_onMove(u){const p=this._map;if(!p)return;const b=this._pointerdownPos,S=this._positionDelta;if(b&&S){if(!this._isDragging){const k=this._clickTolerance||p._clickTolerance;if(u.point.dist(b)<k)return;this._isDragging=!0}this._pos=u.point.sub(S),this._lngLat=p.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(u){const p=this._map,b=this._pos;p&&b&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(b),this._pointerdownPos=u.point,this._state="pending",p.on("mousemove",this._onMove),p.on("touchmove",this._onMove),p.once("mouseup",this._onUp),p.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const p=this._map;return p&&(u?(p.on("mousedown",this._addDragHandler),p.on("touchstart",this._addDragHandler)):(p.off("mousedown",this._addDragHandler),p.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const pg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Vw=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function D0(y=new o.Point(0,0),u="bottom"){if(typeof y=="number"){const p=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(u){case"top":return new o.Point(0,y);case"top-left":return new o.Point(p,p);case"top-right":return new o.Point(-p,p);case"bottom":return new o.Point(0,-y);case"bottom-left":return new o.Point(p,-p);case"bottom-right":return new o.Point(-p,-p);case"left":return new o.Point(y,0);case"right":return new o.Point(-y,0)}return new o.Point(0,0)}return y instanceof o.Point||Array.isArray(y)?o.Point.convert(y):o.Point.convert(y[u]||[0,0])}class mg{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const p=o.easeCubicInOut((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-p)+this._end*p}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,p,b){this._start=this.getValue(p),this._end=u,this._startTime=p,this._endTime=p+b}}const R0={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},L0={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Uw={showCompass:!0,showZoom:!0,visualizePitch:!1};class qw{constructor(u,p,b=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new ag({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,b&&(this.mousePitch=new lg({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener("mousedown",this.mousedown),p.addEventListener("touchstart",this.touchstart,{passive:!1}),p.addEventListener("touchmove",this.touchmove),p.addEventListener("touchend",this.touchend),p.addEventListener("touchcancel",this.reset)}down(u,p){this.mouseRotate.mousedown(u,p),this.mousePitch&&this.mousePitch.mousedown(u,p),V()}move(u,p){const b=this.map,S=this.mouseRotate.mousemoveWindow(u,p),k=S&&S.bearingDelta;if(k&&b.setBearing(b.getBearing()+k),this.mousePitch){const M=this.mousePitch.mousemoveWindow(u,p),P=M&&M.pitchDelta;P&&b.setPitch(b.getPitch()+P)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){N(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(o.extend({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),se(this.element,u)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,se(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ie(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){u.targetTouches.length!==1?this.reset():(this._lastPos=ie(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const gg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},yg={maxWidth:100,unit:"metric"},vg={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},$c={version:o.version,supported:g,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends bf{constructor(y){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(y=o.extend({},L0,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(y.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Lc(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),y),this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._useWebGL2=y.useWebGL2,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._optimizeForTerrain=y.optimizeForTerrain,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new fg,this._domRenderTaskQueue=new fg,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},R0,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new mg(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,typeof y.container=="string"){if(this._container=o.window.document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ys(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this._hash=y.hash&&new ig(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,o.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),y.attributionControl&&this.addControl(new Kt({customAttribution:y.customAttribution})),this._logoControl=new hg,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new o.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new o.Event(`${u.dataType}dataloading`,u))})}_getMapId(){return this._mapId}addControl(y,u){if(u===void 0&&(u=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=y.onAdd(this);this._controls.push(y);const b=this._controlPositions[u];return u.indexOf("bottom")!==-1?b.insertBefore(p,b.firstChild):b.appendChild(p),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(y);return u>-1&&this._controls.splice(u,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new o.Event("movestart",y)).fire(new o.Event("move",y)),this.fire(new o.Event("resize",y)),u&&this.fire(new o.Event("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(o.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y==null?-2:y)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y==null?22:y)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y==null?0:y)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y==null?85:y)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?o.window.navigator.language:Array.isArray(y)?y.length===0?void 0:y.map(u=>u==="auto"?o.window.navigator.language:u):y}setLanguage(y){const u=this._parseLanguage(y);if(!this.style||u===this._language)return this;this._language=u,this.style._reloadSources();for(const p of this._controls)p._setLanguage&&p._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,u=y.projection.name;let p;u==="globe"&&y.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(y.setMercatorFromTransition(),p=!0):u==="mercator"&&y.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(y.setProjection({name:"globe"}),p=!0),p&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,u){return this._updateProjection(y||u||{name:"mercator"})}_updateProjection(y){let u;if(u=y.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),u){this.painter.clearBackgroundTiles();for(const p in this.style._sourceCaches)this.style._sourceCaches[p].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(y){return this.transform.locationPoint3D(o.LngLat.convert(y))}unproject(y){return this.transform.pointLocation3D(o.Point.convert(y))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,u,p){if(y==="mouseenter"||y==="mouseover"){let b=!1;const S=M=>{const P=u.filter($=>this.getLayer($)),R=P.length?this.queryRenderedFeatures(M.point,{layers:P}):[];R.length?b||(b=!0,p.call(this,new Rr(y,this,M.originalEvent,{features:R}))):b=!1},k=()=>{b=!1};return{layers:new Set(u),listener:p,delegates:{mousemove:S,mouseout:k}}}if(y==="mouseleave"||y==="mouseout"){let b=!1;const S=M=>{const P=u.filter(R=>this.getLayer(R));(P.length?this.queryRenderedFeatures(M.point,{layers:P}):[]).length?b=!0:b&&(b=!1,p.call(this,new Rr(y,this,M.originalEvent)))},k=M=>{b&&(b=!1,p.call(this,new Rr(y,this,M.originalEvent)))};return{layers:new Set(u),listener:p,delegates:{mousemove:S,mouseout:k}}}{const b=S=>{const k=u.filter(P=>this.getLayer(P)),M=k.length?this.queryRenderedFeatures(S.point,{layers:k}):[];M.length&&(S.features=M,p.call(this,S),delete S.features)};return{layers:new Set(u),listener:p,delegates:{[y]:b}}}}on(y,u,p){if(p===void 0)return super.on(y,u);Array.isArray(u)||(u=[u]);const b=this._createDelegatedListener(y,u,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(b);for(const S in b.delegates)this.on(S,b.delegates[S]);return this}once(y,u,p){if(p===void 0)return super.once(y,u);Array.isArray(u)||(u=[u]);const b=this._createDelegatedListener(y,u,p);for(const S in b.delegates)this.once(S,b.delegates[S]);return this}off(y,u,p){if(p===void 0)return super.off(y,u);u=new Set(Array.isArray(u)?u:[u]);const b=(k,M)=>{if(k.size!==M.size)return!1;for(const P of k)if(!M.has(P))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[y]:void 0;return S&&(k=>{for(let M=0;M<k.length;M++){const P=k[M];if(P.listener===p&&b(P.layers,u)){for(const R in P.delegates)this.off(R,P.delegates[R]);return k.splice(M,1),this}}})(S),this}queryRenderedFeatures(y,u){return this.style?(u!==void 0||y===void 0||y instanceof o.Point||Array.isArray(y)||(u=y,y=void 0),this.style.queryRenderedFeatures(y=y||[[0,0],[this.transform.width,this.transform.height]],u=u||{},this.transform)):[]}querySourceFeatures(y,u){return this.style.querySourceFeatures(y,u)}isPointOnSurface(y){const{name:u}=this.transform.projection;return u!=="globe"&&u!=="mercator"&&o.warnOnce(`${u} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(o.Point.convert(y))}setStyle(y,u){return(u=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u)).diff!==!1&&u.localIdeographFontFamily===this._localIdeographFontFamily&&u.localFontFamily===this._localFontFamily&&this.style&&y?(this._diffStyle(y,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(y,u))}_getUIString(y){const u=this._locale[y];if(u==null)throw new Error(`Missing UI string '${y}'`);return u}_updateStyle(y,u){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y&&(this.style=new Xs(this,u||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Xs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,u){if(typeof y=="string"){const p=this._requestManager.normalizeStyleURL(y),b=this._requestManager.transformRequest(p,o.ResourceType.Style);o.getJSON(b,(S,k)=>{S?this.fire(new o.ErrorEvent(S)):k&&this._updateDiff(k,u)})}else typeof y=="object"&&this._updateDiff(y,u)}_updateDiff(y,u){try{this.style.setState(y)&&this._update(!0)}catch(p){o.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(y,u)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(y,u){return this._lazyInitEmptyStyle(),this.style.addSource(y,u),this._update(!0)}isSourceLoaded(y){return!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){const y=this.style&&this.style._sourceCaches;for(const u in y){const p=y[u]._tiles;for(const b in p){const S=p[b];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}addSourceType(y,u,p){this._lazyInitEmptyStyle(),this.style.addSourceType(y,u,p)}removeSource(y){return this.style.removeSource(y),this._updateTerrain(),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,u,{pixelRatio:p=1,sdf:b=!1,stretchX:S,stretchY:k,content:M}={}){if(this._lazyInitEmptyStyle(),u instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&u instanceof o.window.ImageBitmap){const{width:P,height:R,data:$}=o.exported.getImageData(u);this.style.addImage(y,{data:new o.RGBAImage({width:P,height:R},$),pixelRatio:p,stretchX:S,stretchY:k,content:M,sdf:b,version:0})}else if(u.width===void 0||u.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:P,height:R}=u,$=u;this.style.addImage(y,{data:new o.RGBAImage({width:P,height:R},new Uint8Array($.data)),pixelRatio:p,stretchX:S,stretchY:k,content:M,sdf:b,version:0,userImage:$}),$.onAdd&&$.onAdd(this,y)}}updateImage(y,u){const p=this.style.getImage(y);if(!p)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=u instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&u instanceof o.window.ImageBitmap?o.exported.getImageData(u):u,{width:S,height:k}=b;S!==void 0&&k!==void 0?S===p.data.width&&k===p.data.height?(p.data.replace(b.data,!(u instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&u instanceof o.window.ImageBitmap)),this.style.updateImage(y,p)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${k})
                must be that same as the previous version of the image
                (${p.data.width}, ${p.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,u){o.getImage(this._requestManager.transformRequest(y,o.ResourceType.Image),(p,b)=>{u(p,b instanceof o.window.HTMLImageElement?o.exported.getImageData(b):b)})}listImages(){return this.style.listImages()}addLayer(y,u){return this._lazyInitEmptyStyle(),this.style.addLayer(y,u),this._update(!0)}moveLayer(y,u){return this.style.moveLayer(y,u),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,u,p){return this.style.setLayerZoomRange(y,u,p),this._update(!0)}setFilter(y,u,p={}){return this.style.setFilter(y,u,p),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,u,p,b={}){return this.style.setPaintProperty(y,u,p,b),this._update(!0)}getPaintProperty(y,u){return this.style.getPaintProperty(y,u)}setLayoutProperty(y,u,p,b={}){return this.style.setLayoutProperty(y,u,p,b),this._update(!0)}getLayoutProperty(y,u){return this.style.getLayoutProperty(y,u)}setLight(y,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,u),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(y),this.transform):0}setFeatureState(y,u){return this.style.setFeatureState(y,u),this._update()}removeFeatureState(y,u){return this.style.removeFeatureState(y,u),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let p,b,S,k=this._container;for(;k&&(!b||!S);){const M=o.window.getComputedStyle(k).transform;M&&M!=="none"&&(p=M.match(/matrix.*\((.+)\)/)[1].split(", "),p[0]&&p[0]!=="0"&&p[0]!=="1"&&(b=p[0]),p[3]&&p[3]!=="0"&&p[3]!=="1"&&(S=p[3])),k=k.parentElement}this._containerWidth=b?Math.abs(y/b):y,this._containerHeight=S?Math.abs(u/S):u}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=T("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=T("div","mapboxgl-canvas-container",y);this._interactive&&u.classList.add("mapboxgl-interactive"),this._canvas=T("canvas","mapboxgl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const p=this._controlContainer=T("div","mapboxgl-control-container",y),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{b[S]=T("div",`mapboxgl-ctrl-${S}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,u){const p=o.exported.devicePixelRatio||1;this._canvas.width=p*Math.ceil(y),this._canvas.height=p*Math.ceil(u),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${u}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const u=this._markers.indexOf(y);u!==-1&&this._markers.splice(u,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const u=this._popups.indexOf(y);u!==-1&&this._popups.splice(u,1)}_setupPainter(){const y=o.extend({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._useWebGL2&&this._canvas.getContext("webgl2",y),p=u||this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);p?(this._useWebGL2&&!u&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(p,!0),this.painter=new Dc(p,this.transform,!!u),this.on("data",b=>{b.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(p)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let u;const p=this.painter.context.extTimerQuery,b=o.exported.now();if(this.listens("gpu-timing-frame")&&(u=p.createQueryEXT(),p.beginQueryEXT(p.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,R=this.transform.pitch,$=o.exported.now(),F=new o.EvaluationParameters(P,{now:$,fadeDuration:S,pitch:R,transition:this.style.getTransition()});this.style.update(F)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let k=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),k=this._updateAverageElevation(b),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):k=this._updateAverageElevation(b),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const P=o.exported.now()-b;p.endQueryEXT(p.TIME_ELAPSED_EXT,u),setTimeout(()=>{const R=p.getQueryObjectEXT(u,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(u),this.fire(new o.Event("gpu-timing-frame",{cpuTime:P,gpuTime:R})),o.window.performance.mark("frame-gpu",{startTime:b,detail:{gpuTime:R}})},50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout(()=>{const R=this.painter.queryGpuTimers(P);this.fire(new o.Event("gpu-timing-layer",{layerTimes:R}))},50)}if(this.listens("gpu-timing-deferred-render")){const P=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const R=this.painter.queryGpuTimeDeferredRender(P);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:R}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||k;if(M||this._repaint)this.triggerRepaint();else{const P=!this.isMoving()&&this.loaded();if(P&&(k=this._updateAverageElevation(b,!0)),k)this.triggerRepaint();else if(this._triggerFrame(!1),P&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const R=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:R})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const u of this._markers)y&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!y||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(y,u=!1){const p=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&p(0);if((u||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const b=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),k=!1;this.transform.elevation&&(k=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=y;const M=Math.abs(b-S);if(M>1){if(this._isInitialLoad||k)return this._averageElevation.jumpTo(S),p(S);this._averageElevation.easeTo(S,y,300)}else if(M>1e-4)return this._averageElevation.jumpTo(S),p(S)}return!!this._averageElevation.isEasing(y)&&p(this._averageElevation.getValue(y))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===o.AUTH_ERR_MSG||y.status===401)){const u=this.painter.context.gl;o.storeAuthState(u,!1),this._logoControl instanceof hg&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const p=this.painter.context.gl,b=p.createFramebuffer();function S(k){p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,k,0);const M=new Uint8Array(p.drawingBufferWidth*p.drawingBufferHeight*4);return p.readPixels(0,0,p.drawingBufferWidth,p.drawingBufferHeight,p.RGBA,p.UNSIGNED_BYTE,M),M}return p.bindFramebuffer(p.FRAMEBUFFER,b),this._canvasPixelComparison(S(y),u.canvasCopies.map(S),u.timeStamps)}_canvasPixelComparison(y,u,p){let b=p[1]-p[0];const S=y.length/4;for(let k=0;k<u.length;k++){const M=u[k];let P=0;for(let R=0;R<M.length;R+=4)M[R]===y[R]&&M[R+1]===y[R+1]&&M[R+2]===y[R+2]&&M[R+3]===y[R+3]&&(P+=1);b+=(p[k+2]-p[k+1])*(1-P/S)}return b}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=o.exported.frame(u=>{const p=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,p&&this._render(u)}))}_preloadTiles(y){const u=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(u,(p,b)=>p._preloadTiles(y,b),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,y&&this._update())}_setCacheLimits(y,u){o.setCacheLimits(y,u)}get version(){return o.version}},NavigationControl:class{constructor(y){this.options=o.extend({},Uw,y),this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),T("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),T("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const p=this._map;p&&(this.options.visualizePitch?p.resetNorthPitch({},{originalEvent:u}):p.resetNorth({},{originalEvent:u}))}),this._compassIcon=T("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const u=y.getZoom(),p=u===y.getMaxZoom(),b=u===y.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qw(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,u){const p=T("button",y,this._container);return p.type="button",p.addEventListener("click",u),p}_setButtonTitle(y,u){if(!this._map)return;const p=this._map._getUIString(`NavigationControl.${u}`);y.setAttribute("aria-label",p),y.firstElementChild&&y.firstElementChild.setAttribute("title",p)}},GeolocateControl:class extends o.Evented{constructor(y){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},gg,y),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=zc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const u=(p=!!this.options.geolocation)=>{this._supportsGeolocation=p,y(p)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(p=>u(p.state!=="denied")).catch(()=>u()):u()}_isOutOfMapMaxBounds(y){const u=this._map.getMaxBounds(),p=y.coords;return!!u&&(p.longitude<u.getWest()||p.longitude>u.getEast()||p.latitude<u.getSouth()||p.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",y)),this._finish()}}_updateCamera(y){const u=new o.LngLat(y.coords.longitude,y.coords.latitude),p=y.coords.accuracy,b=this._map.getBearing(),S=o.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(p),S,{geolocateSource:!0})}_updateMarker(y){if(y){const u=new o.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,u=o.mercatorZfromAltitude(1,y._center.lat)*y.worldSize,p=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=T("button","mapboxgl-ctrl-geolocate",this._container),T("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T("div","mapboxgl-user-location"),this._dotElement.appendChild(T("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(T("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Wt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=T("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(u=>{u==="granted"&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Kt,ScaleControl:class{constructor(y){this.options=o.extend({},yg,y),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch(u){return!1}}(),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,u=this._map,p=u._containerHeight/2,b=u._containerWidth/2-y/2,S=u.unproject([b,p]),k=u.unproject([b+y,p]),M=S.distanceTo(k);if(this.options.unit==="imperial"){const P=3.2808*M;P>5280?this._setScale(y,P/5280,"mile"):this._setScale(y,P,"foot")}else this.options.unit==="nautical"?this._setScale(y,M/1852,"nautical-mile"):M>=1e3?this._setScale(y,M/1e3,"kilometer"):this._setScale(y,M,"meter")}_setScale(y,u,p){this._map._requestDomTask(()=>{const b=function(k){const M=Math.pow(10,`${Math.floor(k)}`.length-1);let P=k/M;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(R){const $=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*$)/$}(P),M*P}(u),S=b/u;this._container.innerHTML=this._isNumberFormatSupported&&p!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:p}).format(b):`${b}&nbsp;${vg[p]}`,this._container.style.width=y*S+"px"})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=T("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof o.window.HTMLElement?this._container=y.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=T("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=T("button","mapboxgl-ctrl-fullscreen",this._controlContainer);T("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(y){super(),this.options=o.extend(Object.create(pg),y),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=o.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(o.window.document.createTextNode(y))}setHTML(y){const u=o.window.document.createDocumentFragment(),p=o.window.document.createElement("body");let b;for(p.innerHTML=y;b=p.firstChild,b;)u.appendChild(b);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=T("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(y),this.options.closeButton){const p=this._closeButton=T("button","mapboxgl-popup-close-button",u);p.type="button",p.setAttribute("aria-label","Close popup"),p.setAttribute("aria-hidden","true"),p.innerHTML="&#215;",p.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let u;return this._classList.delete(y)?u=!1:(this._classList.add(y),u=!0),this._updateClassList(),u}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const u=this._map,p=this._container,b=this._pos;if(!u||!p||!b)return"bottom";const S=p.offsetWidth,k=p.offsetHeight,M=b.x<S/2,P=b.x>u.transform.width-S/2;if(b.y+y<k)return M?"top-left":P?"top-right":"top";if(b.y>u.transform.height-k){if(M)return"bottom-left";if(P)return"bottom-right"}return M?"left":P?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),y.className=u.join(" ")}_update(y){const u=this._map,p=this._content;if(!u||!this._lngLat&&!this._trackPointer||!p)return;let b=this._container;if(b||(b=this._container=T("div","mapboxgl-popup",u.getContainer()),this._tip=T("div","mapboxgl-popup-tip",b),b.appendChild(p)),this.options.maxWidth&&b.style.maxWidth!==this.options.maxWidth&&(b.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Nc(this._lngLat,this._pos,u.transform)),!this._trackPointer||y){const S=this._pos=this._trackPointer&&y?y:u.project(this._lngLat),k=D0(this.options.offset),M=this._anchor=this._getAnchor(k.y),P=D0(this.options.offset,M),R=S.add(P).round();u._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${ql[M]} translate(${R.x}px,${R.y}px)`)})}if(!this._marker&&u._showingGlobe()){const S=o.isLngLatBehindGlobe(u.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(Vw);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:Wt,Style:Xs,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:v0,Evented:o.Evented,config:o.config,prewarm:function(){il().acquire(ns)},clearPrewarmedResources:function(){const y=qr;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(ns),qr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(y){o.config.ACCESS_TOKEN=y},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(y){o.config.API_URL=y},get workerCount(){return Yi.workerCount},set workerCount(y){Yi.workerCount=y},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){o.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){o.clearTileCache(y)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return $c});var d=r;return d})})(g5);var oQ=g5.exports;const Ey=_c(oQ);function Wa(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(r){return"'"+r+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Fu(t){return!!t&&!!t[nr]}function vc(t){var e;return!!t&&(function(n){if(!n||typeof n!="object")return!1;var i=Object.getPrototypeOf(n);if(i===null)return!0;var r=Object.hasOwnProperty.call(i,"constructor")&&i.constructor;return r===Object||typeof r=="function"&&Function.toString.call(r)===pQ}(t)||Array.isArray(t)||!!t[gL]||!!(!((e=t.constructor)===null||e===void 0)&&e[gL])||UI(t)||qI(t))}function Ah(t,e,n){n===void 0&&(n=!1),_m(t)===0?(n?Object.keys:Dp)(t).forEach(function(i){n&&typeof i=="symbol"||e(i,t[i],t)}):t.forEach(function(i,r){return e(r,i,t)})}function _m(t){var e=t[nr];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:UI(t)?2:qI(t)?3:0}function Op(t,e){return _m(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function sQ(t,e){return _m(t)===2?t.get(e):t[e]}function v5(t,e,n){var i=_m(t);i===2?t.set(e,n):i===3?t.add(n):t[e]=n}function b5(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function UI(t){return hQ&&t instanceof Map}function qI(t){return fQ&&t instanceof Set}function Zd(t){return t.o||t.t}function WI(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=x5(t);delete e[nr];for(var n=Dp(e),i=0;i<n.length;i++){var r=n[i],a=e[r];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(e[r]={configurable:!0,writable:!0,enumerable:a.enumerable,value:t[r]})}return Object.create(Object.getPrototypeOf(t),e)}function GI(t,e){return e===void 0&&(e=!1),HI(t)||Fu(t)||!vc(t)||(_m(t)>1&&(t.set=t.add=t.clear=t.delete=aQ),Object.freeze(t),e&&Ah(t,function(n,i){return GI(i,!0)},!0)),t}function aQ(){Wa(2)}function HI(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function Cl(t){var e=tC[t];return e||Wa(18,t),e}function lQ(t,e){tC[t]||(tC[t]=e)}function JT(){return yv}function qE(t,e){e&&(Cl("Patches"),t.u=[],t.s=[],t.v=e)}function Cx(t){QT(t),t.p.forEach(cQ),t.p=null}function QT(t){t===yv&&(yv=t.l)}function uL(t){return yv={p:[],l:yv,h:t,m:!0,_:0}}function cQ(t){var e=t[nr];e.i===0||e.i===1?e.j():e.g=!0}function WE(t,e){e._=e.p.length;var n=e.p[0],i=t!==void 0&&t!==n;return e.h.O||Cl("ES5").S(e,t,i),i?(n[nr].P&&(Cx(e),Wa(4)),vc(t)&&(t=Ix(e,t),e.l||Ax(e,t)),e.u&&Cl("Patches").M(n[nr].t,t,e.u,e.s)):t=Ix(e,n,[]),Cx(e),e.u&&e.v(e.u,e.s),t!==_5?t:void 0}function Ix(t,e,n){if(HI(e))return e;var i=e[nr];if(!i)return Ah(e,function(o,f){return dL(t,i,e,o,f,n)},!0),e;if(i.A!==t)return e;if(!i.P)return Ax(t,i.t,!0),i.t;if(!i.I){i.I=!0,i.A._--;var r=i.i===4||i.i===5?i.o=WI(i.k):i.o,a=r,d=!1;i.i===3&&(a=new Set(r),r.clear(),d=!0),Ah(a,function(o,f){return dL(t,i,r,o,f,n,d)}),Ax(t,r,!1),n&&t.u&&Cl("Patches").N(i,n,t.u,t.s)}return i.o}function dL(t,e,n,i,r,a,d){if(Fu(r)){var o=Ix(t,r,a&&e&&e.i!==3&&!Op(e.R,i)?a.concat(i):void 0);if(v5(n,i,o),!Fu(o))return;t.m=!1}else d&&n.add(r);if(vc(r)&&!HI(r)){if(!t.h.D&&t._<1)return;Ix(t,r),e&&e.A.l||Ax(t,r)}}function Ax(t,e,n){n===void 0&&(n=!1),!t.l&&t.h.D&&t.m&&GI(e,n)}function GE(t,e){var n=t[nr];return(n?Zd(n):t)[e]}function hL(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var i=Object.getOwnPropertyDescriptor(n,e);if(i)return i;n=Object.getPrototypeOf(n)}}function fu(t){t.P||(t.P=!0,t.l&&fu(t.l))}function HE(t){t.o||(t.o=WI(t.t))}function eC(t,e,n){var i=UI(e)?Cl("MapSet").F(e,n):qI(e)?Cl("MapSet").T(e,n):t.O?function(r,a){var d=Array.isArray(r),o={i:d?1:0,A:a?a.A:JT(),P:!1,I:!1,R:{},l:a,t:r,k:null,o:null,j:null,C:!1},f=o,g=vv;d&&(f=[o],g=ky);var _=Proxy.revocable(f,g),w=_.revoke,T=_.proxy;return o.k=T,o.j=w,T}(e,n):Cl("ES5").J(e,n);return(n?n.A:JT()).p.push(i),i}function uQ(t){return Fu(t)||Wa(22,t),function e(n){if(!vc(n))return n;var i,r=n[nr],a=_m(n);if(r){if(!r.P&&(r.i<4||!Cl("ES5").K(r)))return r.t;r.I=!0,i=fL(n,a),r.I=!1}else i=fL(n,a);return Ah(i,function(d,o){r&&sQ(r.t,d)===o||v5(i,d,e(o))}),a===3?new Set(i):i}(t)}function fL(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return WI(t)}function dQ(){function t(a,d){var o=r[a];return o?o.enumerable=d:r[a]=o={configurable:!0,enumerable:d,get:function(){var f=this[nr];return vv.get(f,a)},set:function(f){var g=this[nr];vv.set(g,a,f)}},o}function e(a){for(var d=a.length-1;d>=0;d--){var o=a[d][nr];if(!o.P)switch(o.i){case 5:i(o)&&fu(o);break;case 4:n(o)&&fu(o)}}}function n(a){for(var d=a.t,o=a.k,f=Dp(o),g=f.length-1;g>=0;g--){var _=f[g];if(_!==nr){var w=d[_];if(w===void 0&&!Op(d,_))return!0;var T=o[_],A=T&&T[nr];if(A?A.t!==w:!b5(T,w))return!0}}var D=!!d[nr];return f.length!==Dp(d).length+(D?0:1)}function i(a){var d=a.k;if(d.length!==a.t.length)return!0;var o=Object.getOwnPropertyDescriptor(d,d.length-1);if(o&&!o.get)return!0;for(var f=0;f<d.length;f++)if(!d.hasOwnProperty(f))return!0;return!1}var r={};lQ("ES5",{J:function(a,d){var o=Array.isArray(a),f=function(_,w){if(_){for(var T=Array(w.length),A=0;A<w.length;A++)Object.defineProperty(T,""+A,t(A,!0));return T}var D=x5(w);delete D[nr];for(var z=Dp(D),G=0;G<z.length;G++){var V=z[G];D[V]=t(V,_||!!D[V].enumerable)}return Object.create(Object.getPrototypeOf(w),D)}(o,a),g={i:o?5:4,A:d?d.A:JT(),P:!1,I:!1,R:{},l:d,t:a,k:f,o:null,g:!1,C:!1};return Object.defineProperty(f,nr,{value:g,writable:!0}),f},S:function(a,d,o){o?Fu(d)&&d[nr].A===a&&e(a.p):(a.u&&function f(g){if(g&&typeof g=="object"){var _=g[nr];if(_){var w=_.t,T=_.k,A=_.R,D=_.i;if(D===4)Ah(T,function(q){q!==nr&&(w[q]!==void 0||Op(w,q)?A[q]||f(T[q]):(A[q]=!0,fu(_)))}),Ah(w,function(q){T[q]!==void 0||Op(T,q)||(A[q]=!1,fu(_))});else if(D===5){if(i(_)&&(fu(_),A.length=!0),T.length<w.length)for(var z=T.length;z<w.length;z++)A[z]=!1;else for(var G=w.length;G<T.length;G++)A[G]=!0;for(var V=Math.min(T.length,w.length),N=0;N<V;N++)T.hasOwnProperty(N)||(A[N]=!0),A[N]===void 0&&f(T[N])}}}}(a.p[0]),e(a.p))},K:function(a){return a.i===4?n(a):i(a)}})}var pL,yv,ZI=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",hQ=typeof Map<"u",fQ=typeof Set<"u",mL=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",_5=ZI?Symbol.for("immer-nothing"):((pL={})["immer-nothing"]=!0,pL),gL=ZI?Symbol.for("immer-draftable"):"__$immer_draftable",nr=ZI?Symbol.for("immer-state"):"__$immer_state",pQ=""+Object.prototype.constructor,Dp=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,x5=Object.getOwnPropertyDescriptors||function(t){var e={};return Dp(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},tC={},vv={get:function(t,e){if(e===nr)return t;var n=Zd(t);if(!Op(n,e))return function(r,a,d){var o,f=hL(a,d);return f?"value"in f?f.value:(o=f.get)===null||o===void 0?void 0:o.call(r.k):void 0}(t,n,e);var i=n[e];return t.I||!vc(i)?i:i===GE(t.t,e)?(HE(t),t.o[e]=eC(t.A.h,i,t)):i},has:function(t,e){return e in Zd(t)},ownKeys:function(t){return Reflect.ownKeys(Zd(t))},set:function(t,e,n){var i=hL(Zd(t),e);if(i!=null&&i.set)return i.set.call(t.k,n),!0;if(!t.P){var r=GE(Zd(t),e),a=r==null?void 0:r[nr];if(a&&a.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(b5(n,r)&&(n!==void 0||Op(t.t,e)))return!0;HE(t),fu(t)}return t.o[e]===n&&(n!==void 0||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return GE(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,HE(t),fu(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=Zd(t),i=Reflect.getOwnPropertyDescriptor(n,e);return i&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:i.enumerable,value:n[e]}},defineProperty:function(){Wa(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){Wa(12)}},ky={};Ah(vv,function(t,e){ky[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),ky.deleteProperty=function(t,e){return ky.set.call(this,t,e,void 0)},ky.set=function(t,e,n){return vv.set.call(this,t[0],e,n,t[0])};var mQ=function(){function t(n){var i=this;this.O=mL,this.D=!0,this.produce=function(r,a,d){if(typeof r=="function"&&typeof a!="function"){var o=a;a=r;var f=i;return function(z){var G=this;z===void 0&&(z=o);for(var V=arguments.length,N=Array(V>1?V-1:0),q=1;q<V;q++)N[q-1]=arguments[q];return f.produce(z,function(K){var se;return(se=a).call.apply(se,[G,K].concat(N))})}}var g;if(typeof a!="function"&&Wa(6),d!==void 0&&typeof d!="function"&&Wa(7),vc(r)){var _=uL(i),w=eC(i,r,void 0),T=!0;try{g=a(w),T=!1}finally{T?Cx(_):QT(_)}return typeof Promise<"u"&&g instanceof Promise?g.then(function(z){return qE(_,d),WE(z,_)},function(z){throw Cx(_),z}):(qE(_,d),WE(g,_))}if(!r||typeof r!="object"){if((g=a(r))===void 0&&(g=r),g===_5&&(g=void 0),i.D&&GI(g,!0),d){var A=[],D=[];Cl("Patches").M(r,g,A,D),d(A,D)}return g}Wa(21,r)},this.produceWithPatches=function(r,a){if(typeof r=="function")return function(g){for(var _=arguments.length,w=Array(_>1?_-1:0),T=1;T<_;T++)w[T-1]=arguments[T];return i.produceWithPatches(g,function(A){return r.apply(void 0,[A].concat(w))})};var d,o,f=i.produce(r,a,function(g,_){d=g,o=_});return typeof Promise<"u"&&f instanceof Promise?f.then(function(g){return[g,d,o]}):[f,d,o]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){vc(n)||Wa(8),Fu(n)&&(n=uQ(n));var i=uL(this),r=eC(this,n,void 0);return r[nr].C=!0,QT(i),r},e.finishDraft=function(n,i){var r=n&&n[nr],a=r.A;return qE(a,i),WE(void 0,a)},e.setAutoFreeze=function(n){this.D=n},e.setUseProxies=function(n){n&&!mL&&Wa(20),this.O=n},e.applyPatches=function(n,i){var r;for(r=i.length-1;r>=0;r--){var a=i[r];if(a.path.length===0&&a.op==="replace"){n=a.value;break}}r>-1&&(i=i.slice(r+1));var d=Cl("Patches").$;return Fu(n)?d(n,i):this.produce(n,function(o){return d(o,i)})},t}(),$s=new mQ,w5=$s.produce;$s.produceWithPatches.bind($s);$s.setAutoFreeze.bind($s);$s.setUseProxies.bind($s);$s.applyPatches.bind($s);$s.createDraft.bind($s);$s.finishDraft.bind($s);function bv(t){"@babel/helpers - typeof";return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bv(t)}function gQ(t,e){if(bv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(bv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yQ(t){var e=gQ(t,"string");return bv(e)==="symbol"?e:String(e)}function vQ(t,e,n){return e=yQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function vL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yL(Object(n),!0).forEach(function(i){vQ(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yL(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Do(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var bL=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),ZE=function(){return Math.random().toString(36).substring(7).split("").join(".")},Mx={INIT:"@@redux/INIT"+ZE(),REPLACE:"@@redux/REPLACE"+ZE(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ZE()}};function bQ(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function S5(t,e,n){var i;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Do(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Do(1));return n(S5)(t,e)}if(typeof t!="function")throw new Error(Do(2));var r=t,a=e,d=[],o=d,f=!1;function g(){o===d&&(o=d.slice())}function _(){if(f)throw new Error(Do(3));return a}function w(z){if(typeof z!="function")throw new Error(Do(4));if(f)throw new Error(Do(5));var G=!0;return g(),o.push(z),function(){if(G){if(f)throw new Error(Do(6));G=!1,g();var N=o.indexOf(z);o.splice(N,1),d=null}}}function T(z){if(!bQ(z))throw new Error(Do(7));if(typeof z.type>"u")throw new Error(Do(8));if(f)throw new Error(Do(9));try{f=!0,a=r(a,z)}finally{f=!1}for(var G=d=o,V=0;V<G.length;V++){var N=G[V];N()}return z}function A(z){if(typeof z!="function")throw new Error(Do(10));r=z,T({type:Mx.REPLACE})}function D(){var z,G=w;return z={subscribe:function(N){if(typeof N!="object"||N===null)throw new Error(Do(11));function q(){N.next&&N.next(_())}q();var K=G(q);return{unsubscribe:K}}},z[bL]=function(){return this},z}return T({type:Mx.INIT}),i={dispatch:T,subscribe:w,getState:_,replaceReducer:A},i[bL]=D,i}function _Q(t){Object.keys(t).forEach(function(e){var n=t[e],i=n(void 0,{type:Mx.INIT});if(typeof i>"u")throw new Error(Do(12));if(typeof n(void 0,{type:Mx.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Do(13))})}function xQ(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++){var r=e[i];typeof t[r]=="function"&&(n[r]=t[r])}var a=Object.keys(n),d;try{_Q(n)}catch(o){d=o}return function(f,g){if(f===void 0&&(f={}),d)throw d;for(var _=!1,w={},T=0;T<a.length;T++){var A=a[T],D=n[A],z=f[A],G=D(z,g);if(typeof G>"u")throw g&&g.type,new Error(Do(14));w[A]=G,_=_||G!==z}return _=_||a.length!==Object.keys(f).length,_?w:f}}function Px(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(i){return i}:e.length===1?e[0]:e.reduce(function(i,r){return function(){return i(r.apply(void 0,arguments))}})}function wQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(i){return function(){var r=i.apply(void 0,arguments),a=function(){throw new Error(Do(15))},d={getState:r.getState,dispatch:function(){return a.apply(void 0,arguments)}},o=e.map(function(f){return f(d)});return a=Px.apply(void 0,o)(r.dispatch),vL(vL({},r),{},{dispatch:a})}}}var Ox="NOT_FOUND";function SQ(t){var e;return{get:function(i){return e&&t(e.key,i)?e.value:Ox},put:function(i,r){e={key:i,value:r}},getEntries:function(){return e?[e]:[]},clear:function(){e=void 0}}}function EQ(t,e){var n=[];function i(o){var f=n.findIndex(function(_){return e(o,_.key)});if(f>-1){var g=n[f];return f>0&&(n.splice(f,1),n.unshift(g)),g.value}return Ox}function r(o,f){i(o)===Ox&&(n.unshift({key:o,value:f}),n.length>t&&n.pop())}function a(){return n}function d(){n=[]}return{get:i,put:r,getEntries:a,clear:d}}var kQ=function(e,n){return e===n};function TQ(t){return function(n,i){if(n===null||i===null||n.length!==i.length)return!1;for(var r=n.length,a=0;a<r;a++)if(!t(n[a],i[a]))return!1;return!0}}function CQ(t,e){var n=typeof e=="object"?e:{equalityCheck:e},i=n.equalityCheck,r=i===void 0?kQ:i,a=n.maxSize,d=a===void 0?1:a,o=n.resultEqualityCheck,f=TQ(r),g=d===1?SQ(f):EQ(d,f);function _(){var w=g.get(arguments);if(w===Ox){if(w=t.apply(null,arguments),o){var T=g.getEntries(),A=T.find(function(D){return o(D.value,w)});A&&(w=A.value)}g.put(arguments,w)}return w}return _.clearCache=function(){return g.clear()},_}function IQ(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every(function(i){return typeof i=="function"})){var n=e.map(function(i){return typeof i=="function"?"function "+(i.name||"unnamed")+"()":typeof i}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return e}function AQ(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=function(){for(var d=arguments.length,o=new Array(d),f=0;f<d;f++)o[f]=arguments[f];var g=0,_,w={memoizeOptions:void 0},T=o.pop();if(typeof T=="object"&&(w=T,T=o.pop()),typeof T!="function")throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof T+"]");var A=w,D=A.memoizeOptions,z=D===void 0?n:D,G=Array.isArray(z)?z:[z],V=IQ(o),N=t.apply(void 0,[function(){return g++,T.apply(null,arguments)}].concat(G)),q=t(function(){for(var se=[],ie=V.length,Q=0;Q<ie;Q++)se.push(V[Q].apply(null,arguments));return _=N.apply(null,se),_});return Object.assign(q,{resultFunc:T,memoizedResultFunc:N,dependencies:V,lastResult:function(){return _},recomputations:function(){return g},resetRecomputations:function(){return g=0}}),q};return r}var tl=AQ(CQ);function E5(t){var e=function(i){var r=i.dispatch,a=i.getState;return function(d){return function(o){return typeof o=="function"?o(r,a,t):d(o)}}};return e}var k5=E5();k5.withExtraArgument=E5;const _L=k5;var T5=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),MQ=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,d;return d={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function o(g){return function(_){return f([g,_])}}function f(g){if(i)throw new TypeError("Generator is already executing.");for(;n;)try{if(i=1,r&&(a=g[0]&2?r.return:g[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,g[1])).done)return a;switch(r=0,a&&(g=[g[0]&2,a.value]),g[0]){case 0:case 1:a=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,r=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!a||g[1]>a[0]&&g[1]<a[3])){n.label=g[1];break}if(g[0]===6&&n.label<a[1]){n.label=a[1],a=g;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(g);break}a[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(t,n)}catch(_){g=[6,_],r=0}finally{i=a=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}},Jp=globalThis&&globalThis.__spreadArray||function(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t},PQ=Object.defineProperty,OQ=Object.defineProperties,DQ=Object.getOwnPropertyDescriptors,xL=Object.getOwnPropertySymbols,RQ=Object.prototype.hasOwnProperty,LQ=Object.prototype.propertyIsEnumerable,wL=function(t,e,n){return e in t?PQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},Iu=function(t,e){for(var n in e||(e={}))RQ.call(e,n)&&wL(t,n,e[n]);if(xL)for(var i=0,r=xL(e);i<r.length;i++){var n=r[i];LQ.call(e,n)&&wL(t,n,e[n])}return t},XE=function(t,e){return OQ(t,DQ(e))},zQ=function(t,e,n){return new Promise(function(i,r){var a=function(f){try{o(n.next(f))}catch(g){r(g)}},d=function(f){try{o(n.throw(f))}catch(g){r(g)}},o=function(f){return f.done?i(f.value):Promise.resolve(f.value).then(a,d)};o((n=n.apply(t,e)).next())})},BQ=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Px:Px.apply(null,arguments)};function FQ(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return e===n}var NQ=function(t){T5(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=t.apply(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,Jp([void 0],n[0].concat(this)))):new(e.bind.apply(e,Jp([void 0],n.concat(this))))},e}(Array),$Q=function(t){T5(e,t);function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=t.apply(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,Jp([void 0],n[0].concat(this)))):new(e.bind.apply(e,Jp([void 0],n.concat(this))))},e}(Array);function nC(t){return vc(t)?w5(t,function(){}):t}function jQ(t){return typeof t=="boolean"}function VQ(){return function(e){return UQ(e)}}function UQ(t){t===void 0&&(t={});var e=t.thunk,n=e===void 0?!0:e;t.immutableCheck,t.serializableCheck;var i=new NQ;return n&&(jQ(n)?i.push(_L):i.push(_L.withExtraArgument(n.extraArgument))),i}var qQ=!0;function WQ(t){var e=VQ(),n=t||{},i=n.reducer,r=i===void 0?void 0:i,a=n.middleware,d=a===void 0?e():a,o=n.devTools,f=o===void 0?!0:o,g=n.preloadedState,_=g===void 0?void 0:g,w=n.enhancers,T=w===void 0?void 0:w,A;if(typeof r=="function")A=r;else if(FQ(r))A=xQ(r);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var D=d;typeof D=="function"&&(D=D(e));var z=wQ.apply(void 0,D),G=Px;f&&(G=BQ(Iu({trace:!qQ},typeof f=="object"&&f)));var V=new $Q(z),N=V;Array.isArray(T)?N=Jp([z],T):typeof T=="function"&&(N=T(V));var q=G.apply(void 0,N);return S5(A,_,q)}function Au(t,e){function n(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];if(e){var a=e.apply(void 0,i);if(!a)throw new Error("prepareAction did not return an object");return Iu(Iu({type:t,payload:a.payload},"meta"in a&&{meta:a.meta}),"error"in a&&{error:a.error})}return{type:t,payload:i[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(i){return i.type===t},n}function C5(t){var e={},n=[],i,r={addCase:function(a,d){var o=typeof a=="string"?a:a.type;if(o in e)throw new Error("addCase cannot be called with two reducers for the same action type");return e[o]=d,r},addMatcher:function(a,d){return n.push({matcher:a,reducer:d}),r},addDefaultCase:function(a){return i=a,r}};return t(r),[e,n,i]}function GQ(t){return typeof t=="function"}function HQ(t,e,n,i){n===void 0&&(n=[]);var r=typeof e=="function"?C5(e):[e,n,i],a=r[0],d=r[1],o=r[2],f;if(GQ(t))f=function(){return nC(t())};else{var g=nC(t);f=function(){return g}}function _(w,T){w===void 0&&(w=f());var A=Jp([a[T.type]],d.filter(function(D){var z=D.matcher;return z(T)}).map(function(D){var z=D.reducer;return z}));return A.filter(function(D){return!!D}).length===0&&(A=[o]),A.reduce(function(D,z){if(z)if(Fu(D)){var G=D,V=z(G,T);return V===void 0?D:V}else{if(vc(D))return w5(D,function(N){return z(N,T)});var V=z(D,T);if(V===void 0){if(D===null)return D;throw Error("A case reducer on a non-draftable value must not return undefined")}return V}return D},w)}return _.getInitialState=f,_}function ZQ(t,e){return t+"/"+e}function xm(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");typeof process<"u";var n=typeof t.initialState=="function"?t.initialState:nC(t.initialState),i=t.reducers||{},r=Object.keys(i),a={},d={},o={};r.forEach(function(_){var w=i[_],T=ZQ(e,_),A,D;"reducer"in w?(A=w.reducer,D=w.prepare):A=w,a[_]=A,d[T]=A,o[_]=D?Au(T,D):Au(T)});function f(){var _=typeof t.extraReducers=="function"?C5(t.extraReducers):[t.extraReducers],w=_[0],T=w===void 0?{}:w,A=_[1],D=A===void 0?[]:A,z=_[2],G=z===void 0?void 0:z,V=Iu(Iu({},T),d);return HQ(n,function(N){for(var q in V)N.addCase(q,V[q]);for(var K=0,se=D;K<se.length;K++){var ie=se[K];N.addMatcher(ie.matcher,ie.reducer)}G&&N.addDefaultCase(G)})}var g;return{name:e,reducer:function(_,w){return g||(g=f()),g(_,w)},actions:o,caseReducers:a,getInitialState:function(){return g||(g=f()),g.getInitialState()}}}var XQ="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",KQ=function(t){t===void 0&&(t=21);for(var e="",n=t;n--;)e+=XQ[Math.random()*64|0];return e},YQ=["name","message","stack","code"],KE=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),SL=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),JQ=function(t){if(typeof t=="object"&&t!==null){for(var e={},n=0,i=YQ;n<i.length;n++){var r=i[n];typeof t[r]=="string"&&(e[r]=t[r])}return e}return{message:String(t)}};(function(){function t(e,n,i){var r=Au(e+"/fulfilled",function(g,_,w,T){return{payload:g,meta:XE(Iu({},T||{}),{arg:w,requestId:_,requestStatus:"fulfilled"})}}),a=Au(e+"/pending",function(g,_,w){return{payload:void 0,meta:XE(Iu({},w||{}),{arg:_,requestId:g,requestStatus:"pending"})}}),d=Au(e+"/rejected",function(g,_,w,T,A){return{payload:T,error:(i&&i.serializeError||JQ)(g||"Rejected"),meta:XE(Iu({},A||{}),{arg:w,requestId:_,rejectedWithValue:!!T,requestStatus:"rejected",aborted:(g==null?void 0:g.name)==="AbortError",condition:(g==null?void 0:g.name)==="ConditionError"})}}),o=typeof AbortController<"u"?AbortController:function(){function g(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return g.prototype.abort=function(){},g}();function f(g){return function(_,w,T){var A=i!=null&&i.idGenerator?i.idGenerator(g):KQ(),D=new o,z;function G(N){z=N,D.abort()}var V=function(){return zQ(this,null,function(){var N,q,K,se,ie,Q,J;return MQ(this,function(te){switch(te.label){case 0:return te.trys.push([0,4,,5]),se=(N=i==null?void 0:i.condition)==null?void 0:N.call(i,g,{getState:w,extra:T}),eee(se)?[4,se]:[3,2];case 1:se=te.sent(),te.label=2;case 2:if(se===!1||D.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return ie=new Promise(function(me,Fe){return D.signal.addEventListener("abort",function(){return Fe({name:"AbortError",message:z||"Aborted"})})}),_(a(A,g,(q=i==null?void 0:i.getPendingMeta)==null?void 0:q.call(i,{requestId:A,arg:g},{getState:w,extra:T}))),[4,Promise.race([ie,Promise.resolve(n(g,{dispatch:_,getState:w,extra:T,requestId:A,signal:D.signal,abort:G,rejectWithValue:function(me,Fe){return new KE(me,Fe)},fulfillWithValue:function(me,Fe){return new SL(me,Fe)}})).then(function(me){if(me instanceof KE)throw me;return me instanceof SL?r(me.payload,A,g,me.meta):r(me,A,g)})])];case 3:return K=te.sent(),[3,5];case 4:return Q=te.sent(),K=Q instanceof KE?d(null,A,g,Q.payload,Q.meta):d(Q,A,g),[3,5];case 5:return J=i&&!i.dispatchConditionRejection&&d.match(K)&&K.meta.condition,J||_(K),[2,K]}})})}();return Object.assign(V,{abort:G,requestId:A,arg:g,unwrap:function(){return V.then(QQ)}})}}return Object.assign(f,{pending:a,rejected:d,fulfilled:r,typePrefix:e})}return t.withTypes=function(){return t},t})();function QQ(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function eee(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var XI="listenerMiddleware";Au(XI+"/add");Au(XI+"/removeAll");Au(XI+"/remove");var EL;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);dQ();const tee={memberships:{}},I5=xm({name:"membership",initialState:tee,reducers:{addMemberships:(t,e)=>{e.payload.forEach(n=>{t.memberships[n.id]={...t.memberships[n.id],...n}})}},extraReducers:t=>{t.addCase(Hu,(e,n)=>{n.payload.forEach(i=>{var r;((r=i.memberships)!=null?r:[]).forEach(a=>{e.memberships[a.id]={...e.memberships[a.id],...a}})})})}}),{addMemberships:$h}=I5.actions,nee=I5.reducer,N1=t=>t.membership.memberships;tl((t,e)=>N1(t),(t,e)=>e,(t,e)=>t[e]);const iee=tl((t,e)=>N1(t),(t,e)=>e,(t,e)=>Object.values(t).filter(n=>n.userId===e)),ree=tl((t,e)=>N1(t),(t,e)=>e,(t,e)=>Object.values(t).filter(n=>n.channelId===e)),A5=tl((t,e,n)=>N1(t),(t,e,n)=>e,(t,e,n)=>n,(t,e,n)=>Object.values(t).find(i=>i.channelId===e&&i.userId===n)),oee={channels:{},channelId:null},M5=xm({name:"channel",initialState:oee,reducers:{addChannels:(t,e)=>{e.payload.forEach(n=>{t.channels[n.id]={...t.channels[n.id],...n}})},setFocusChannelId:(t,e)=>{t.channelId=e.payload},toggleFocusChannelId:(t,e)=>{t.channelId===e.payload?t.channelId=null:t.channelId=e.payload}},extraReducers:t=>{t.addCase($h,(e,n)=>{n.payload.forEach(i=>{var r;(r=i.channel)!=null&&r.id&&(e.channels[i.channel.id]={...e.channels[i.channel.id],...i.channel})})})}}),{addChannels:Hu,setFocusChannelId:g_,toggleFocusChannelId:Ofe}=M5.actions,see=M5.reducer,P5=t=>t.channel.channels;tl((t,e)=>P5(t),(t,e)=>e,(t,e)=>t[e]);const Zu=t=>t.channel.channelId?t.channel.channels[t.channel.channelId]:null,aee={posts:{}},O5=xm({name:"post",initialState:aee,reducers:{addPosts:(t,e)=>{e.payload.forEach(n=>{t.posts[n.id]={...t.posts[n.id],...n}})}}}),{addPosts:$1}=O5.actions,lee=O5.reducer,j1=t=>t.post.posts;tl((t,e)=>j1(t),(t,e)=>e,(t,e)=>t[e]);tl((t,e)=>j1(t),(t,e)=>e,(t,e)=>Object.values(t).filter(n=>n.userId===e));const cee=tl((t,e)=>j1(t),(t,e)=>e,(t,e)=>Object.values(t).filter(n=>n.channelId===e));tl((t,e,n)=>j1(t),(t,e,n)=>e,(t,e,n)=>n,(t,e,n)=>Object.values(t).find(i=>i.channelId===e&&i.userId===n));const uee={users:{},userId:null},D5=xm({name:"user",initialState:uee,reducers:{addUsers:(t,e)=>{e.payload.forEach(n=>{t.users[n.id]={...t.users[n.id],...n}})},setAppUserId:(t,e)=>{t.userId=e.payload}},extraReducers:t=>{t.addCase($h,(e,n)=>{n.payload.forEach(i=>{var r;(r=i.user)!=null&&r.id&&(e.users[i.user.id]={...e.users[i.user.id],...i.user})})}).addCase(Hu,(e,n)=>{n.payload.forEach(i=>{var r;((r=i.memberships)!=null?r:[]).forEach(a=>{var d;(d=a.user)!=null&&d.id&&(e.users[a.user.id]={...e.users[a.user.id],...a.user})})})}).addCase($1,(e,n)=>{n.payload.forEach(i=>{var r;(r=i.user)!=null&&r.id&&(e.users[i.user.id]={...e.users[i.user.id],...i.user})})})}}),{addUsers:wc,setAppUserId:ch}=D5.actions,dee=D5.reducer,V1=t=>t.user.users;tl((t,e)=>V1(t),(t,e)=>e,(t,e)=>t[e]);const Ws=t=>t.user.userId?t.user.users[t.user.userId]:null;var R5={exports:{}},L5={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qp=et;function hee(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fee=typeof Object.is=="function"?Object.is:hee,pee=Qp.useState,mee=Qp.useEffect,gee=Qp.useLayoutEffect,yee=Qp.useDebugValue;function vee(t,e){var n=e(),i=pee({inst:{value:n,getSnapshot:e}}),r=i[0].inst,a=i[1];return gee(function(){r.value=n,r.getSnapshot=e,YE(r)&&a({inst:r})},[t,n,e]),mee(function(){return YE(r)&&a({inst:r}),t(function(){YE(r)&&a({inst:r})})},[t]),yee(n),n}function YE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fee(t,n)}catch(i){return!0}}function bee(t,e){return e()}var _ee=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?bee:vee;L5.useSyncExternalStore=Qp.useSyncExternalStore!==void 0?Qp.useSyncExternalStore:_ee;R5.exports=L5;var xee=R5.exports,z5={exports:{}},B5={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U1=et,wee=xee;function See(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Eee=typeof Object.is=="function"?Object.is:See,kee=wee.useSyncExternalStore,Tee=U1.useRef,Cee=U1.useEffect,Iee=U1.useMemo,Aee=U1.useDebugValue;B5.useSyncExternalStoreWithSelector=function(t,e,n,i,r){var a=Tee(null);if(a.current===null){var d={hasValue:!1,value:null};a.current=d}else d=a.current;a=Iee(function(){function f(A){if(!g){if(g=!0,_=A,A=i(A),r!==void 0&&d.hasValue){var D=d.value;if(r(D,A))return w=D}return w=A}if(D=w,Eee(_,A))return D;var z=i(A);return r!==void 0&&r(D,z)?D:(_=A,w=z)}var g=!1,_,w,T=n===void 0?null:n;return[function(){return f(e())},T===null?void 0:function(){return f(T())}]},[e,n,i,r]);var o=kee(t,a[0],a[1]);return Cee(function(){d.hasValue=!0,d.value=o},[o]),Aee(o),o};z5.exports=B5;var Mee=z5.exports;function Pee(t){t()}let F5=Pee;const Oee=t=>F5=t,Dee=()=>F5,kL=Symbol.for(`react-redux-context-${et.version}`),TL=globalThis;function Ree(){let t=TL[kL];return t||(t=et.createContext(null),TL[kL]=t),t}const Nu=new Proxy({},new Proxy({},{get(t,e){const n=Ree();return(i,...r)=>Reflect[e](n,...r)}}));function KI(t=Nu){return function(){return et.useContext(t)}}const N5=KI(),Lee=()=>{throw new Error("uSES not initialized!")};let $5=Lee;const zee=t=>{$5=t},Bee=(t,e)=>t===e;function Fee(t=Nu){const e=t===Nu?N5:KI(t);return function(i,r={}){const{equalityFn:a=Bee,stabilityCheck:d=void 0,noopCheck:o=void 0}=typeof r=="function"?{equalityFn:r}:r,{store:f,subscription:g,getServerState:_,stabilityCheck:w,noopCheck:T}=e();et.useRef(!0);const A=et.useCallback({[i.name](z){return i(z)}}[i.name],[i,w,d]),D=$5(g.addNestedSub,f.getState,_||f.getState,A,a);return et.useDebugValue(D),D}}const Nee=Fee();var Ri={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YI=Symbol.for("react.element"),JI=Symbol.for("react.portal"),q1=Symbol.for("react.fragment"),W1=Symbol.for("react.strict_mode"),G1=Symbol.for("react.profiler"),H1=Symbol.for("react.provider"),Z1=Symbol.for("react.context"),$ee=Symbol.for("react.server_context"),X1=Symbol.for("react.forward_ref"),K1=Symbol.for("react.suspense"),Y1=Symbol.for("react.suspense_list"),J1=Symbol.for("react.memo"),Q1=Symbol.for("react.lazy"),jee=Symbol.for("react.offscreen"),j5;j5=Symbol.for("react.module.reference");function ga(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case YI:switch(t=t.type,t){case q1:case G1:case W1:case K1:case Y1:return t;default:switch(t=t&&t.$$typeof,t){case $ee:case Z1:case X1:case Q1:case J1:case H1:return t;default:return e}}case JI:return e}}}Ri.ContextConsumer=Z1;Ri.ContextProvider=H1;Ri.Element=YI;Ri.ForwardRef=X1;Ri.Fragment=q1;Ri.Lazy=Q1;Ri.Memo=J1;Ri.Portal=JI;Ri.Profiler=G1;Ri.StrictMode=W1;Ri.Suspense=K1;Ri.SuspenseList=Y1;Ri.isAsyncMode=function(){return!1};Ri.isConcurrentMode=function(){return!1};Ri.isContextConsumer=function(t){return ga(t)===Z1};Ri.isContextProvider=function(t){return ga(t)===H1};Ri.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===YI};Ri.isForwardRef=function(t){return ga(t)===X1};Ri.isFragment=function(t){return ga(t)===q1};Ri.isLazy=function(t){return ga(t)===Q1};Ri.isMemo=function(t){return ga(t)===J1};Ri.isPortal=function(t){return ga(t)===JI};Ri.isProfiler=function(t){return ga(t)===G1};Ri.isStrictMode=function(t){return ga(t)===W1};Ri.isSuspense=function(t){return ga(t)===K1};Ri.isSuspenseList=function(t){return ga(t)===Y1};Ri.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===q1||t===G1||t===W1||t===K1||t===Y1||t===jee||typeof t=="object"&&t!==null&&(t.$$typeof===Q1||t.$$typeof===J1||t.$$typeof===H1||t.$$typeof===Z1||t.$$typeof===X1||t.$$typeof===j5||t.getModuleId!==void 0)};Ri.typeOf=ga;function Vee(){const t=Dee();let e=null,n=null;return{clear(){e=null,n=null},notify(){t(()=>{let i=e;for(;i;)i.callback(),i=i.next})},get(){let i=[],r=e;for(;r;)i.push(r),r=r.next;return i},subscribe(i){let r=!0,a=n={callback:i,next:null,prev:n};return a.prev?a.prev.next=a:e=a,function(){!r||e===null||(r=!1,a.next?a.next.prev=a.prev:n=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}const CL={notify(){},get:()=>[]};function Uee(t,e){let n,i=CL;function r(w){return f(),i.subscribe(w)}function a(){i.notify()}function d(){_.onStateChange&&_.onStateChange()}function o(){return!!n}function f(){n||(n=e?e.addNestedSub(d):t.subscribe(d),i=Vee())}function g(){n&&(n(),n=void 0,i.clear(),i=CL)}const _={addNestedSub:r,notifyNestedSubs:a,handleChangeWrapper:d,isSubscribed:o,trySubscribe:f,tryUnsubscribe:g,getListeners:()=>i};return _}const qee=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Wee=qee?et.useLayoutEffect:et.useEffect;function iC({store:t,context:e,children:n,serverState:i,stabilityCheck:r="once",noopCheck:a="once"}){const d=et.useMemo(()=>{const g=Uee(t);return{store:t,subscription:g,getServerState:i?()=>i:void 0,stabilityCheck:r,noopCheck:a}},[t,i,r,a]),o=et.useMemo(()=>t.getState(),[t]);Wee(()=>{const{subscription:g}=d;return g.onStateChange=g.notifyNestedSubs,g.trySubscribe(),o!==t.getState()&&g.notifyNestedSubs(),()=>{g.tryUnsubscribe(),g.onStateChange=void 0}},[d,o]);const f=e||Nu;return We.createElement(f.Provider,{value:d},n)}function V5(t=Nu){const e=t===Nu?N5:KI(t);return function(){const{store:i}=e();return i}}const Gee=V5();function Hee(t=Nu){const e=t===Nu?Gee:V5(t);return function(){return e().dispatch}}const Zee=Hee();zee(Mee.useSyncExternalStoreWithSelector);Oee(Bv.unstable_batchedUpdates);const Xee={interval:null,isInitialized:!1},U5=xm({name:"auth",initialState:Xee,reducers:{setRefreshInterval:(t,e)=>{t.interval=e.payload},setIsInitialized:(t,e)=>{t.isInitialized=e.payload}}}),{setRefreshInterval:y_,setIsInitialized:JE}=U5.actions,Kee=U5.reducer,q5=t=>t.auth.interval,Yee=t=>t.auth.isInitialized,Jee={dealId:null,deals:{}},W5=xm({name:"deal",initialState:Jee,reducers:{addDeals:(t,e)=>{e.payload.forEach(n=>{t.deals[n.id]={...t.deals[n.id],...n}})}}}),{addDeals:Qee}=W5.actions,ete=W5.reducer,G5=t=>t.deal.deals,tte=tl((t,e)=>G5(t),(t,e)=>e,(t,e)=>t[e]),rC=WQ({reducer:{auth:Kee,channel:see,deal:ete,membership:nee,post:lee,user:dee}}),ji=Zee,ei=Nee;var QE="Invariant Violation",IL=Object.setPrototypeOf,nte=IL===void 0?function(t,e){return t.__proto__=e,t}:IL,vi=function(t){ma(e,t);function e(n){n===void 0&&(n=QE);var i=t.call(this,typeof n=="number"?QE+": "+n+" (see https://github.com/apollographql/invariant-packages)":n)||this;return i.framesToPop=1,i.name=QE,nte(i,e.prototype),i}return e}(Error);function Ut(t,e){if(!t)throw new vi(e)}var H5=["debug","log","warn","error","silent"],ite=H5.indexOf("log");function Wb(t){return function(){if(H5.indexOf(t)>=ite){var e=console[t]||console.log;return e.apply(console,arguments)}}}(function(t){t.debug=Wb("debug"),t.log=Wb("log"),t.warn=Wb("warn"),t.error=Wb("error")})(Ut||(Ut={}));function aa(t){try{return t()}catch(e){}}const AL=aa(function(){return globalThis})||aa(function(){return window})||aa(function(){return self})||aa(function(){return global})||aa(function(){return aa.constructor("return this")()});var ML="__",PL=[ML,ML].join("DEV");function rte(){try{return!!__DEV__}catch(t){return Object.defineProperty(AL,PL,{value:aa(function(){return"production"})!=="production",enumerable:!1,configurable:!0,writable:!0}),AL[PL]}}const ek=rte();function su(t){try{return t()}catch(e){}}var oC=su(function(){return globalThis})||su(function(){return window})||su(function(){return self})||su(function(){return global})||su(function(){return su.constructor("return this")()}),sC=!1;function ote(){oC&&!su(function(){return"production"})&&!su(function(){return process})&&(Object.defineProperty(oC,"process",{value:{env:{NODE_ENV:"production"}},configurable:!0,enumerable:!1,writable:!0}),sC=!0)}ote();function OL(){sC&&(delete oC.process,sC=!1)}function v_(t,e){if(!!!t)throw new Error(e)}function ste(t){return typeof t=="object"&&t!==null}function ate(t,e){if(!!!t)throw new Error(e!=null?e:"Unexpected invariant triggered.")}const lte=/\r\n|[\n\r]/g;function aC(t,e){let n=0,i=1;for(const r of t.body.matchAll(lte)){if(typeof r.index=="number"||ate(!1),r.index>=e)break;n=r.index+r[0].length,i+=1}return{line:i,column:e+1-n}}function cte(t){return Z5(t.source,aC(t.source,t.start))}function Z5(t,e){const n=t.locationOffset.column-1,i="".padStart(n)+t.body,r=e.line-1,a=t.locationOffset.line-1,d=e.line+a,o=e.line===1?n:0,f=e.column+o,g=`${t.name}:${d}:${f}
`,_=i.split(/\r\n|[\n\r]/g),w=_[r];if(w.length>120){const T=Math.floor(f/80),A=f%80,D=[];for(let z=0;z<w.length;z+=80)D.push(w.slice(z,z+80));return g+DL([[`${d} |`,D[0]],...D.slice(1,T+1).map(z=>["|",z]),["|","^".padStart(A)],["|",D[T+1]]])}return g+DL([[`${d-1} |`,_[r-1]],[`${d} |`,w],["|","^".padStart(f)],[`${d+1} |`,_[r+1]]])}function DL(t){const e=t.filter(([i,r])=>r!==void 0),n=Math.max(...e.map(([i])=>i.length));return e.map(([i,r])=>i.padStart(n)+(r?" "+r:"")).join(`
`)}function ute(t){const e=t[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:t[1],positions:t[2],path:t[3],originalError:t[4],extensions:t[5]}:e}class QI extends Error{constructor(e,...n){var i,r,a;const{nodes:d,source:o,positions:f,path:g,originalError:_,extensions:w}=ute(n);super(e),this.name="GraphQLError",this.path=g!=null?g:void 0,this.originalError=_!=null?_:void 0,this.nodes=RL(Array.isArray(d)?d:d?[d]:void 0);const T=RL((i=this.nodes)===null||i===void 0?void 0:i.map(D=>D.loc).filter(D=>D!=null));this.source=o!=null?o:T==null||(r=T[0])===null||r===void 0?void 0:r.source,this.positions=f!=null?f:T==null?void 0:T.map(D=>D.start),this.locations=f&&o?f.map(D=>aC(o,D)):T==null?void 0:T.map(D=>aC(D.source,D.start));const A=ste(_==null?void 0:_.extensions)?_==null?void 0:_.extensions:void 0;this.extensions=(a=w!=null?w:A)!==null&&a!==void 0?a:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),_!=null&&_.stack?Object.defineProperty(this,"stack",{value:_.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,QI):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const n of this.nodes)n.loc&&(e+=`

`+cte(n.loc));else if(this.source&&this.locations)for(const n of this.locations)e+=`

`+Z5(this.source,n);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function RL(t){return t===void 0||t.length===0?void 0:t}function oo(t,e,n){return new QI(`Syntax Error: ${n}`,{source:t,positions:[e]})}class dte{constructor(e,n,i){this.start=e.start,this.end=n.end,this.startToken=e,this.endToken=n,this.source=i}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class X5{constructor(e,n,i,r,a,d){this.kind=e,this.start=n,this.end=i,this.line=r,this.column=a,this.value=d,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const K5={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},hte=new Set(Object.keys(K5));function LL(t){const e=t==null?void 0:t.kind;return typeof e=="string"&&hte.has(e)}var vp;(function(t){t.QUERY="query",t.MUTATION="mutation",t.SUBSCRIPTION="subscription"})(vp||(vp={}));var lC;(function(t){t.QUERY="QUERY",t.MUTATION="MUTATION",t.SUBSCRIPTION="SUBSCRIPTION",t.FIELD="FIELD",t.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",t.FRAGMENT_SPREAD="FRAGMENT_SPREAD",t.INLINE_FRAGMENT="INLINE_FRAGMENT",t.VARIABLE_DEFINITION="VARIABLE_DEFINITION",t.SCHEMA="SCHEMA",t.SCALAR="SCALAR",t.OBJECT="OBJECT",t.FIELD_DEFINITION="FIELD_DEFINITION",t.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",t.INTERFACE="INTERFACE",t.UNION="UNION",t.ENUM="ENUM",t.ENUM_VALUE="ENUM_VALUE",t.INPUT_OBJECT="INPUT_OBJECT",t.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(lC||(lC={}));var cn;(function(t){t.NAME="Name",t.DOCUMENT="Document",t.OPERATION_DEFINITION="OperationDefinition",t.VARIABLE_DEFINITION="VariableDefinition",t.SELECTION_SET="SelectionSet",t.FIELD="Field",t.ARGUMENT="Argument",t.FRAGMENT_SPREAD="FragmentSpread",t.INLINE_FRAGMENT="InlineFragment",t.FRAGMENT_DEFINITION="FragmentDefinition",t.VARIABLE="Variable",t.INT="IntValue",t.FLOAT="FloatValue",t.STRING="StringValue",t.BOOLEAN="BooleanValue",t.NULL="NullValue",t.ENUM="EnumValue",t.LIST="ListValue",t.OBJECT="ObjectValue",t.OBJECT_FIELD="ObjectField",t.DIRECTIVE="Directive",t.NAMED_TYPE="NamedType",t.LIST_TYPE="ListType",t.NON_NULL_TYPE="NonNullType",t.SCHEMA_DEFINITION="SchemaDefinition",t.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",t.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",t.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",t.FIELD_DEFINITION="FieldDefinition",t.INPUT_VALUE_DEFINITION="InputValueDefinition",t.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",t.UNION_TYPE_DEFINITION="UnionTypeDefinition",t.ENUM_TYPE_DEFINITION="EnumTypeDefinition",t.ENUM_VALUE_DEFINITION="EnumValueDefinition",t.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",t.DIRECTIVE_DEFINITION="DirectiveDefinition",t.SCHEMA_EXTENSION="SchemaExtension",t.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",t.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",t.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",t.UNION_TYPE_EXTENSION="UnionTypeExtension",t.ENUM_TYPE_EXTENSION="EnumTypeExtension",t.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(cn||(cn={}));function cC(t){return t===9||t===32}function _v(t){return t>=48&&t<=57}function Y5(t){return t>=97&&t<=122||t>=65&&t<=90}function J5(t){return Y5(t)||t===95}function fte(t){return Y5(t)||_v(t)||t===95}function pte(t){var e;let n=Number.MAX_SAFE_INTEGER,i=null,r=-1;for(let d=0;d<t.length;++d){var a;const o=t[d],f=mte(o);f!==o.length&&(i=(a=i)!==null&&a!==void 0?a:d,r=d,d!==0&&f<n&&(n=f))}return t.map((d,o)=>o===0?d:d.slice(n)).slice((e=i)!==null&&e!==void 0?e:0,r+1)}function mte(t){let e=0;for(;e<t.length&&cC(t.charCodeAt(e));)++e;return e}function gte(t,e){const n=t.replace(/"""/g,'\\"""'),i=n.split(/\r\n|[\n\r]/g),r=i.length===1,a=i.length>1&&i.slice(1).every(A=>A.length===0||cC(A.charCodeAt(0))),d=n.endsWith('\\"""'),o=t.endsWith('"')&&!d,f=t.endsWith("\\"),g=o||f,_=!(e!=null&&e.minimize)&&(!r||t.length>70||g||a||d);let w="";const T=r&&cC(t.charCodeAt(0));return(_&&!T||a)&&(w+=`
`),w+=n,(_||g)&&(w+=`
`),'"""'+w+'"""'}var Ct;(function(t){t.SOF="<SOF>",t.EOF="<EOF>",t.BANG="!",t.DOLLAR="$",t.AMP="&",t.PAREN_L="(",t.PAREN_R=")",t.SPREAD="...",t.COLON=":",t.EQUALS="=",t.AT="@",t.BRACKET_L="[",t.BRACKET_R="]",t.BRACE_L="{",t.PIPE="|",t.BRACE_R="}",t.NAME="Name",t.INT="Int",t.FLOAT="Float",t.STRING="String",t.BLOCK_STRING="BlockString",t.COMMENT="Comment"})(Ct||(Ct={}));class yte{constructor(e){const n=new X5(Ct.SOF,0,0,0,0);this.source=e,this.lastToken=n,this.token=n,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==Ct.EOF)do if(e.next)e=e.next;else{const n=bte(this,e.end);e.next=n,n.prev=e,e=n}while(e.kind===Ct.COMMENT);return e}}function vte(t){return t===Ct.BANG||t===Ct.DOLLAR||t===Ct.AMP||t===Ct.PAREN_L||t===Ct.PAREN_R||t===Ct.SPREAD||t===Ct.COLON||t===Ct.EQUALS||t===Ct.AT||t===Ct.BRACKET_L||t===Ct.BRACKET_R||t===Ct.BRACE_L||t===Ct.PIPE||t===Ct.BRACE_R}function wm(t){return t>=0&&t<=55295||t>=57344&&t<=1114111}function ew(t,e){return Q5(t.charCodeAt(e))&&e$(t.charCodeAt(e+1))}function Q5(t){return t>=55296&&t<=56319}function e$(t){return t>=56320&&t<=57343}function Mh(t,e){const n=t.source.body.codePointAt(e);if(n===void 0)return Ct.EOF;if(n>=32&&n<=126){const i=String.fromCodePoint(n);return i==='"'?`'"'`:`"${i}"`}return"U+"+n.toString(16).toUpperCase().padStart(4,"0")}function Fr(t,e,n,i,r){const a=t.line,d=1+n-t.lineStart;return new X5(e,n,i,a,d,r)}function bte(t,e){const n=t.source.body,i=n.length;let r=e;for(;r<i;){const a=n.charCodeAt(r);switch(a){case 65279:case 9:case 32:case 44:++r;continue;case 10:++r,++t.line,t.lineStart=r;continue;case 13:n.charCodeAt(r+1)===10?r+=2:++r,++t.line,t.lineStart=r;continue;case 35:return _te(t,r);case 33:return Fr(t,Ct.BANG,r,r+1);case 36:return Fr(t,Ct.DOLLAR,r,r+1);case 38:return Fr(t,Ct.AMP,r,r+1);case 40:return Fr(t,Ct.PAREN_L,r,r+1);case 41:return Fr(t,Ct.PAREN_R,r,r+1);case 46:if(n.charCodeAt(r+1)===46&&n.charCodeAt(r+2)===46)return Fr(t,Ct.SPREAD,r,r+3);break;case 58:return Fr(t,Ct.COLON,r,r+1);case 61:return Fr(t,Ct.EQUALS,r,r+1);case 64:return Fr(t,Ct.AT,r,r+1);case 91:return Fr(t,Ct.BRACKET_L,r,r+1);case 93:return Fr(t,Ct.BRACKET_R,r,r+1);case 123:return Fr(t,Ct.BRACE_L,r,r+1);case 124:return Fr(t,Ct.PIPE,r,r+1);case 125:return Fr(t,Ct.BRACE_R,r,r+1);case 34:return n.charCodeAt(r+1)===34&&n.charCodeAt(r+2)===34?Tte(t,r):wte(t,r)}if(_v(a)||a===45)return xte(t,r,a);if(J5(a))return Cte(t,r);throw oo(t.source,r,a===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:wm(a)||ew(n,r)?`Unexpected character: ${Mh(t,r)}.`:`Invalid character: ${Mh(t,r)}.`)}return Fr(t,Ct.EOF,i,i)}function _te(t,e){const n=t.source.body,i=n.length;let r=e+1;for(;r<i;){const a=n.charCodeAt(r);if(a===10||a===13)break;if(wm(a))++r;else if(ew(n,r))r+=2;else break}return Fr(t,Ct.COMMENT,e,r,n.slice(e+1,r))}function xte(t,e,n){const i=t.source.body;let r=e,a=n,d=!1;if(a===45&&(a=i.charCodeAt(++r)),a===48){if(a=i.charCodeAt(++r),_v(a))throw oo(t.source,r,`Invalid number, unexpected digit after 0: ${Mh(t,r)}.`)}else r=tk(t,r,a),a=i.charCodeAt(r);if(a===46&&(d=!0,a=i.charCodeAt(++r),r=tk(t,r,a),a=i.charCodeAt(r)),(a===69||a===101)&&(d=!0,a=i.charCodeAt(++r),(a===43||a===45)&&(a=i.charCodeAt(++r)),r=tk(t,r,a),a=i.charCodeAt(r)),a===46||J5(a))throw oo(t.source,r,`Invalid number, expected digit but got: ${Mh(t,r)}.`);return Fr(t,d?Ct.FLOAT:Ct.INT,e,r,i.slice(e,r))}function tk(t,e,n){if(!_v(n))throw oo(t.source,e,`Invalid number, expected digit but got: ${Mh(t,e)}.`);const i=t.source.body;let r=e+1;for(;_v(i.charCodeAt(r));)++r;return r}function wte(t,e){const n=t.source.body,i=n.length;let r=e+1,a=r,d="";for(;r<i;){const o=n.charCodeAt(r);if(o===34)return d+=n.slice(a,r),Fr(t,Ct.STRING,e,r+1,d);if(o===92){d+=n.slice(a,r);const f=n.charCodeAt(r+1)===117?n.charCodeAt(r+2)===123?Ste(t,r):Ete(t,r):kte(t,r);d+=f.value,r+=f.size,a=r;continue}if(o===10||o===13)break;if(wm(o))++r;else if(ew(n,r))r+=2;else throw oo(t.source,r,`Invalid character within String: ${Mh(t,r)}.`)}throw oo(t.source,r,"Unterminated string.")}function Ste(t,e){const n=t.source.body;let i=0,r=3;for(;r<12;){const a=n.charCodeAt(e+r++);if(a===125){if(r<5||!wm(i))break;return{value:String.fromCodePoint(i),size:r}}if(i=i<<4|Ty(a),i<0)break}throw oo(t.source,e,`Invalid Unicode escape sequence: "${n.slice(e,e+r)}".`)}function Ete(t,e){const n=t.source.body,i=zL(n,e+2);if(wm(i))return{value:String.fromCodePoint(i),size:6};if(Q5(i)&&n.charCodeAt(e+6)===92&&n.charCodeAt(e+7)===117){const r=zL(n,e+8);if(e$(r))return{value:String.fromCodePoint(i,r),size:12}}throw oo(t.source,e,`Invalid Unicode escape sequence: "${n.slice(e,e+6)}".`)}function zL(t,e){return Ty(t.charCodeAt(e))<<12|Ty(t.charCodeAt(e+1))<<8|Ty(t.charCodeAt(e+2))<<4|Ty(t.charCodeAt(e+3))}function Ty(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:-1}function kte(t,e){const n=t.source.body;switch(n.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw oo(t.source,e,`Invalid character escape sequence: "${n.slice(e,e+2)}".`)}function Tte(t,e){const n=t.source.body,i=n.length;let r=t.lineStart,a=e+3,d=a,o="";const f=[];for(;a<i;){const g=n.charCodeAt(a);if(g===34&&n.charCodeAt(a+1)===34&&n.charCodeAt(a+2)===34){o+=n.slice(d,a),f.push(o);const _=Fr(t,Ct.BLOCK_STRING,e,a+3,pte(f).join(`
`));return t.line+=f.length-1,t.lineStart=r,_}if(g===92&&n.charCodeAt(a+1)===34&&n.charCodeAt(a+2)===34&&n.charCodeAt(a+3)===34){o+=n.slice(d,a),d=a+1,a+=4;continue}if(g===10||g===13){o+=n.slice(d,a),f.push(o),g===13&&n.charCodeAt(a+1)===10?a+=2:++a,o="",d=a,r=a;continue}if(wm(g))++a;else if(ew(n,a))a+=2;else throw oo(t.source,a,`Invalid character within String: ${Mh(t,a)}.`)}throw oo(t.source,a,"Unterminated string.")}function Cte(t,e){const n=t.source.body,i=n.length;let r=e+1;for(;r<i;){const a=n.charCodeAt(r);if(fte(a))++r;else break}return Fr(t,Ct.NAME,e,r,n.slice(e,r))}const Ite=10,t$=2;function n$(t){return tw(t,[])}function tw(t,e){switch(typeof t){case"string":return JSON.stringify(t);case"function":return t.name?`[function ${t.name}]`:"[function]";case"object":return Ate(t,e);default:return String(t)}}function Ate(t,e){if(t===null)return"null";if(e.includes(t))return"[Circular]";const n=[...e,t];if(Mte(t)){const i=t.toJSON();if(i!==t)return typeof i=="string"?i:tw(i,n)}else if(Array.isArray(t))return Ote(t,n);return Pte(t,n)}function Mte(t){return typeof t.toJSON=="function"}function Pte(t,e){const n=Object.entries(t);return n.length===0?"{}":e.length>t$?"["+Dte(t)+"]":"{ "+n.map(([r,a])=>r+": "+tw(a,e)).join(", ")+" }"}function Ote(t,e){if(t.length===0)return"[]";if(e.length>t$)return"[Array]";const n=Math.min(Ite,t.length),i=t.length-n,r=[];for(let a=0;a<n;++a)r.push(tw(t[a],e));return i===1?r.push("... 1 more item"):i>1&&r.push(`... ${i} more items`),"["+r.join(", ")+"]"}function Dte(t){const e=Object.prototype.toString.call(t).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof t.constructor=="function"){const n=t.constructor.name;if(typeof n=="string"&&n!=="")return n}return e}const Rte=function(e,n){return e instanceof n};class eA{constructor(e,n="GraphQL request",i={line:1,column:1}){typeof e=="string"||v_(!1,`Body must be a string. Received: ${n$(e)}.`),this.body=e,this.name=n,this.locationOffset=i,this.locationOffset.line>0||v_(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||v_(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function Lte(t){return Rte(t,eA)}function zte(t,e){return new Bte(t,e).parseDocument()}class Bte{constructor(e,n={}){const i=Lte(e)?e:new eA(e);this._lexer=new yte(i),this._options=n,this._tokenCounter=0}parseName(){const e=this.expectToken(Ct.NAME);return this.node(e,{kind:cn.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:cn.DOCUMENT,definitions:this.many(Ct.SOF,this.parseDefinition,Ct.EOF)})}parseDefinition(){if(this.peek(Ct.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),n=e?this._lexer.lookahead():this._lexer.token;if(n.kind===Ct.NAME){switch(n.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw oo(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(n.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(n)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(Ct.BRACE_L))return this.node(e,{kind:cn.OPERATION_DEFINITION,operation:vp.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const n=this.parseOperationType();let i;return this.peek(Ct.NAME)&&(i=this.parseName()),this.node(e,{kind:cn.OPERATION_DEFINITION,operation:n,name:i,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(Ct.NAME);switch(e.value){case"query":return vp.QUERY;case"mutation":return vp.MUTATION;case"subscription":return vp.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(Ct.PAREN_L,this.parseVariableDefinition,Ct.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:cn.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(Ct.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(Ct.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(Ct.DOLLAR),this.node(e,{kind:cn.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:cn.SELECTION_SET,selections:this.many(Ct.BRACE_L,this.parseSelection,Ct.BRACE_R)})}parseSelection(){return this.peek(Ct.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,n=this.parseName();let i,r;return this.expectOptionalToken(Ct.COLON)?(i=n,r=this.parseName()):r=n,this.node(e,{kind:cn.FIELD,alias:i,name:r,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(Ct.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const n=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(Ct.PAREN_L,n,Ct.PAREN_R)}parseArgument(e=!1){const n=this._lexer.token,i=this.parseName();return this.expectToken(Ct.COLON),this.node(n,{kind:cn.ARGUMENT,name:i,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(Ct.SPREAD);const n=this.expectOptionalKeyword("on");return!n&&this.peek(Ct.NAME)?this.node(e,{kind:cn.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:cn.INLINE_FRAGMENT,typeCondition:n?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:cn.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:cn.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const n=this._lexer.token;switch(n.kind){case Ct.BRACKET_L:return this.parseList(e);case Ct.BRACE_L:return this.parseObject(e);case Ct.INT:return this.advanceLexer(),this.node(n,{kind:cn.INT,value:n.value});case Ct.FLOAT:return this.advanceLexer(),this.node(n,{kind:cn.FLOAT,value:n.value});case Ct.STRING:case Ct.BLOCK_STRING:return this.parseStringLiteral();case Ct.NAME:switch(this.advanceLexer(),n.value){case"true":return this.node(n,{kind:cn.BOOLEAN,value:!0});case"false":return this.node(n,{kind:cn.BOOLEAN,value:!1});case"null":return this.node(n,{kind:cn.NULL});default:return this.node(n,{kind:cn.ENUM,value:n.value})}case Ct.DOLLAR:if(e)if(this.expectToken(Ct.DOLLAR),this._lexer.token.kind===Ct.NAME){const i=this._lexer.token.value;throw oo(this._lexer.source,n.start,`Unexpected variable "$${i}" in constant value.`)}else throw this.unexpected(n);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:cn.STRING,value:e.value,block:e.kind===Ct.BLOCK_STRING})}parseList(e){const n=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:cn.LIST,values:this.any(Ct.BRACKET_L,n,Ct.BRACKET_R)})}parseObject(e){const n=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:cn.OBJECT,fields:this.any(Ct.BRACE_L,n,Ct.BRACE_R)})}parseObjectField(e){const n=this._lexer.token,i=this.parseName();return this.expectToken(Ct.COLON),this.node(n,{kind:cn.OBJECT_FIELD,name:i,value:this.parseValueLiteral(e)})}parseDirectives(e){const n=[];for(;this.peek(Ct.AT);)n.push(this.parseDirective(e));return n}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const n=this._lexer.token;return this.expectToken(Ct.AT),this.node(n,{kind:cn.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let n;if(this.expectOptionalToken(Ct.BRACKET_L)){const i=this.parseTypeReference();this.expectToken(Ct.BRACKET_R),n=this.node(e,{kind:cn.LIST_TYPE,type:i})}else n=this.parseNamedType();return this.expectOptionalToken(Ct.BANG)?this.node(e,{kind:cn.NON_NULL_TYPE,type:n}):n}parseNamedType(){return this.node(this._lexer.token,{kind:cn.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(Ct.STRING)||this.peek(Ct.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("schema");const i=this.parseConstDirectives(),r=this.many(Ct.BRACE_L,this.parseOperationTypeDefinition,Ct.BRACE_R);return this.node(e,{kind:cn.SCHEMA_DEFINITION,description:n,directives:i,operationTypes:r})}parseOperationTypeDefinition(){const e=this._lexer.token,n=this.parseOperationType();this.expectToken(Ct.COLON);const i=this.parseNamedType();return this.node(e,{kind:cn.OPERATION_TYPE_DEFINITION,operation:n,type:i})}parseScalarTypeDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("scalar");const i=this.parseName(),r=this.parseConstDirectives();return this.node(e,{kind:cn.SCALAR_TYPE_DEFINITION,description:n,name:i,directives:r})}parseObjectTypeDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("type");const i=this.parseName(),r=this.parseImplementsInterfaces(),a=this.parseConstDirectives(),d=this.parseFieldsDefinition();return this.node(e,{kind:cn.OBJECT_TYPE_DEFINITION,description:n,name:i,interfaces:r,directives:a,fields:d})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(Ct.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(Ct.BRACE_L,this.parseFieldDefinition,Ct.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,n=this.parseDescription(),i=this.parseName(),r=this.parseArgumentDefs();this.expectToken(Ct.COLON);const a=this.parseTypeReference(),d=this.parseConstDirectives();return this.node(e,{kind:cn.FIELD_DEFINITION,description:n,name:i,arguments:r,type:a,directives:d})}parseArgumentDefs(){return this.optionalMany(Ct.PAREN_L,this.parseInputValueDef,Ct.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,n=this.parseDescription(),i=this.parseName();this.expectToken(Ct.COLON);const r=this.parseTypeReference();let a;this.expectOptionalToken(Ct.EQUALS)&&(a=this.parseConstValueLiteral());const d=this.parseConstDirectives();return this.node(e,{kind:cn.INPUT_VALUE_DEFINITION,description:n,name:i,type:r,defaultValue:a,directives:d})}parseInterfaceTypeDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("interface");const i=this.parseName(),r=this.parseImplementsInterfaces(),a=this.parseConstDirectives(),d=this.parseFieldsDefinition();return this.node(e,{kind:cn.INTERFACE_TYPE_DEFINITION,description:n,name:i,interfaces:r,directives:a,fields:d})}parseUnionTypeDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("union");const i=this.parseName(),r=this.parseConstDirectives(),a=this.parseUnionMemberTypes();return this.node(e,{kind:cn.UNION_TYPE_DEFINITION,description:n,name:i,directives:r,types:a})}parseUnionMemberTypes(){return this.expectOptionalToken(Ct.EQUALS)?this.delimitedMany(Ct.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("enum");const i=this.parseName(),r=this.parseConstDirectives(),a=this.parseEnumValuesDefinition();return this.node(e,{kind:cn.ENUM_TYPE_DEFINITION,description:n,name:i,directives:r,values:a})}parseEnumValuesDefinition(){return this.optionalMany(Ct.BRACE_L,this.parseEnumValueDefinition,Ct.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,n=this.parseDescription(),i=this.parseEnumValueName(),r=this.parseConstDirectives();return this.node(e,{kind:cn.ENUM_VALUE_DEFINITION,description:n,name:i,directives:r})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw oo(this._lexer.source,this._lexer.token.start,`${Gb(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("input");const i=this.parseName(),r=this.parseConstDirectives(),a=this.parseInputFieldsDefinition();return this.node(e,{kind:cn.INPUT_OBJECT_TYPE_DEFINITION,description:n,name:i,directives:r,fields:a})}parseInputFieldsDefinition(){return this.optionalMany(Ct.BRACE_L,this.parseInputValueDef,Ct.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===Ct.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const n=this.parseConstDirectives(),i=this.optionalMany(Ct.BRACE_L,this.parseOperationTypeDefinition,Ct.BRACE_R);if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:cn.SCHEMA_EXTENSION,directives:n,operationTypes:i})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const n=this.parseName(),i=this.parseConstDirectives();if(i.length===0)throw this.unexpected();return this.node(e,{kind:cn.SCALAR_TYPE_EXTENSION,name:n,directives:i})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const n=this.parseName(),i=this.parseImplementsInterfaces(),r=this.parseConstDirectives(),a=this.parseFieldsDefinition();if(i.length===0&&r.length===0&&a.length===0)throw this.unexpected();return this.node(e,{kind:cn.OBJECT_TYPE_EXTENSION,name:n,interfaces:i,directives:r,fields:a})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const n=this.parseName(),i=this.parseImplementsInterfaces(),r=this.parseConstDirectives(),a=this.parseFieldsDefinition();if(i.length===0&&r.length===0&&a.length===0)throw this.unexpected();return this.node(e,{kind:cn.INTERFACE_TYPE_EXTENSION,name:n,interfaces:i,directives:r,fields:a})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const n=this.parseName(),i=this.parseConstDirectives(),r=this.parseUnionMemberTypes();if(i.length===0&&r.length===0)throw this.unexpected();return this.node(e,{kind:cn.UNION_TYPE_EXTENSION,name:n,directives:i,types:r})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const n=this.parseName(),i=this.parseConstDirectives(),r=this.parseEnumValuesDefinition();if(i.length===0&&r.length===0)throw this.unexpected();return this.node(e,{kind:cn.ENUM_TYPE_EXTENSION,name:n,directives:i,values:r})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const n=this.parseName(),i=this.parseConstDirectives(),r=this.parseInputFieldsDefinition();if(i.length===0&&r.length===0)throw this.unexpected();return this.node(e,{kind:cn.INPUT_OBJECT_TYPE_EXTENSION,name:n,directives:i,fields:r})}parseDirectiveDefinition(){const e=this._lexer.token,n=this.parseDescription();this.expectKeyword("directive"),this.expectToken(Ct.AT);const i=this.parseName(),r=this.parseArgumentDefs(),a=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const d=this.parseDirectiveLocations();return this.node(e,{kind:cn.DIRECTIVE_DEFINITION,description:n,name:i,arguments:r,repeatable:a,locations:d})}parseDirectiveLocations(){return this.delimitedMany(Ct.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,n=this.parseName();if(Object.prototype.hasOwnProperty.call(lC,n.value))return n;throw this.unexpected(e)}node(e,n){return this._options.noLocation!==!0&&(n.loc=new dte(e,this._lexer.lastToken,this._lexer.source)),n}peek(e){return this._lexer.token.kind===e}expectToken(e){const n=this._lexer.token;if(n.kind===e)return this.advanceLexer(),n;throw oo(this._lexer.source,n.start,`Expected ${i$(e)}, found ${Gb(n)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const n=this._lexer.token;if(n.kind===Ct.NAME&&n.value===e)this.advanceLexer();else throw oo(this._lexer.source,n.start,`Expected "${e}", found ${Gb(n)}.`)}expectOptionalKeyword(e){const n=this._lexer.token;return n.kind===Ct.NAME&&n.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const n=e!=null?e:this._lexer.token;return oo(this._lexer.source,n.start,`Unexpected ${Gb(n)}.`)}any(e,n,i){this.expectToken(e);const r=[];for(;!this.expectOptionalToken(i);)r.push(n.call(this));return r}optionalMany(e,n,i){if(this.expectOptionalToken(e)){const r=[];do r.push(n.call(this));while(!this.expectOptionalToken(i));return r}return[]}many(e,n,i){this.expectToken(e);const r=[];do r.push(n.call(this));while(!this.expectOptionalToken(i));return r}delimitedMany(e,n){this.expectOptionalToken(e);const i=[];do i.push(n.call(this));while(this.expectOptionalToken(e));return i}advanceLexer(){const{maxTokens:e}=this._options,n=this._lexer.advance();if(e!==void 0&&n.kind!==Ct.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw oo(this._lexer.source,n.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function Gb(t){const e=t.value;return i$(t.kind)+(e!=null?` "${e}"`:"")}function i$(t){return vte(t)?`"${t}"`:t}function Fte(t){return`"${t.replace(Nte,$te)}"`}const Nte=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function $te(t){return jte[t.charCodeAt(0)]}const jte=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],tA=Object.freeze({});function bc(t,e,n=K5){const i=new Map;for(const V of Object.values(cn))i.set(V,Vte(e,V));let r,a=Array.isArray(t),d=[t],o=-1,f=[],g=t,_,w;const T=[],A=[];do{o++;const V=o===d.length,N=V&&f.length!==0;if(V){if(_=A.length===0?void 0:T[T.length-1],g=w,w=A.pop(),N)if(a){g=g.slice();let K=0;for(const[se,ie]of f){const Q=se-K;ie===null?(g.splice(Q,1),K++):g[Q]=ie}}else{g=Object.defineProperties({},Object.getOwnPropertyDescriptors(g));for(const[K,se]of f)g[K]=se}o=r.index,d=r.keys,f=r.edits,a=r.inArray,r=r.prev}else if(w){if(_=a?o:d[o],g=w[_],g==null)continue;T.push(_)}let q;if(!Array.isArray(g)){var D,z;LL(g)||v_(!1,`Invalid AST Node: ${n$(g)}.`);const K=V?(D=i.get(g.kind))===null||D===void 0?void 0:D.leave:(z=i.get(g.kind))===null||z===void 0?void 0:z.enter;if(q=K==null?void 0:K.call(e,g,_,w,T,A),q===tA)break;if(q===!1){if(!V){T.pop();continue}}else if(q!==void 0&&(f.push([_,q]),!V))if(LL(q))g=q;else{T.pop();continue}}if(q===void 0&&N&&f.push([_,g]),V)T.pop();else{var G;r={inArray:a,index:o,keys:d,edits:f,prev:r},a=Array.isArray(g),d=a?g:(G=n[g.kind])!==null&&G!==void 0?G:[],o=-1,f=[],w&&A.push(w),w=g}}while(r!==void 0);return f.length!==0?f[f.length-1][1]:t}function Vte(t,e){const n=t[e];return typeof n=="object"?n:typeof n=="function"?{enter:n,leave:void 0}:{enter:t.enter,leave:t.leave}}function r$(t){return bc(t,qte)}const Ute=80,qte={Name:{leave:t=>t.value},Variable:{leave:t=>"$"+t.name},Document:{leave:t=>dn(t.definitions,`

`)},OperationDefinition:{leave(t){const e=Yn("(",dn(t.variableDefinitions,", "),")"),n=dn([t.operation,dn([t.name,e]),dn(t.directives," ")]," ");return(n==="query"?"":n+" ")+t.selectionSet}},VariableDefinition:{leave:({variable:t,type:e,defaultValue:n,directives:i})=>t+": "+e+Yn(" = ",n)+Yn(" ",dn(i," "))},SelectionSet:{leave:({selections:t})=>Fa(t)},Field:{leave({alias:t,name:e,arguments:n,directives:i,selectionSet:r}){const a=Yn("",t,": ")+e;let d=a+Yn("(",dn(n,", "),")");return d.length>Ute&&(d=a+Yn(`(
`,b_(dn(n,`
`)),`
)`)),dn([d,dn(i," "),r]," ")}},Argument:{leave:({name:t,value:e})=>t+": "+e},FragmentSpread:{leave:({name:t,directives:e})=>"..."+t+Yn(" ",dn(e," "))},InlineFragment:{leave:({typeCondition:t,directives:e,selectionSet:n})=>dn(["...",Yn("on ",t),dn(e," "),n]," ")},FragmentDefinition:{leave:({name:t,typeCondition:e,variableDefinitions:n,directives:i,selectionSet:r})=>`fragment ${t}${Yn("(",dn(n,", "),")")} on ${e} ${Yn("",dn(i," ")," ")}`+r},IntValue:{leave:({value:t})=>t},FloatValue:{leave:({value:t})=>t},StringValue:{leave:({value:t,block:e})=>e?gte(t):Fte(t)},BooleanValue:{leave:({value:t})=>t?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:t})=>t},ListValue:{leave:({values:t})=>"["+dn(t,", ")+"]"},ObjectValue:{leave:({fields:t})=>"{"+dn(t,", ")+"}"},ObjectField:{leave:({name:t,value:e})=>t+": "+e},Directive:{leave:({name:t,arguments:e})=>"@"+t+Yn("(",dn(e,", "),")")},NamedType:{leave:({name:t})=>t},ListType:{leave:({type:t})=>"["+t+"]"},NonNullType:{leave:({type:t})=>t+"!"},SchemaDefinition:{leave:({description:t,directives:e,operationTypes:n})=>Yn("",t,`
`)+dn(["schema",dn(e," "),Fa(n)]," ")},OperationTypeDefinition:{leave:({operation:t,type:e})=>t+": "+e},ScalarTypeDefinition:{leave:({description:t,name:e,directives:n})=>Yn("",t,`
`)+dn(["scalar",e,dn(n," ")]," ")},ObjectTypeDefinition:{leave:({description:t,name:e,interfaces:n,directives:i,fields:r})=>Yn("",t,`
`)+dn(["type",e,Yn("implements ",dn(n," & ")),dn(i," "),Fa(r)]," ")},FieldDefinition:{leave:({description:t,name:e,arguments:n,type:i,directives:r})=>Yn("",t,`
`)+e+(BL(n)?Yn(`(
`,b_(dn(n,`
`)),`
)`):Yn("(",dn(n,", "),")"))+": "+i+Yn(" ",dn(r," "))},InputValueDefinition:{leave:({description:t,name:e,type:n,defaultValue:i,directives:r})=>Yn("",t,`
`)+dn([e+": "+n,Yn("= ",i),dn(r," ")]," ")},InterfaceTypeDefinition:{leave:({description:t,name:e,interfaces:n,directives:i,fields:r})=>Yn("",t,`
`)+dn(["interface",e,Yn("implements ",dn(n," & ")),dn(i," "),Fa(r)]," ")},UnionTypeDefinition:{leave:({description:t,name:e,directives:n,types:i})=>Yn("",t,`
`)+dn(["union",e,dn(n," "),Yn("= ",dn(i," | "))]," ")},EnumTypeDefinition:{leave:({description:t,name:e,directives:n,values:i})=>Yn("",t,`
`)+dn(["enum",e,dn(n," "),Fa(i)]," ")},EnumValueDefinition:{leave:({description:t,name:e,directives:n})=>Yn("",t,`
`)+dn([e,dn(n," ")]," ")},InputObjectTypeDefinition:{leave:({description:t,name:e,directives:n,fields:i})=>Yn("",t,`
`)+dn(["input",e,dn(n," "),Fa(i)]," ")},DirectiveDefinition:{leave:({description:t,name:e,arguments:n,repeatable:i,locations:r})=>Yn("",t,`
`)+"directive @"+e+(BL(n)?Yn(`(
`,b_(dn(n,`
`)),`
)`):Yn("(",dn(n,", "),")"))+(i?" repeatable":"")+" on "+dn(r," | ")},SchemaExtension:{leave:({directives:t,operationTypes:e})=>dn(["extend schema",dn(t," "),Fa(e)]," ")},ScalarTypeExtension:{leave:({name:t,directives:e})=>dn(["extend scalar",t,dn(e," ")]," ")},ObjectTypeExtension:{leave:({name:t,interfaces:e,directives:n,fields:i})=>dn(["extend type",t,Yn("implements ",dn(e," & ")),dn(n," "),Fa(i)]," ")},InterfaceTypeExtension:{leave:({name:t,interfaces:e,directives:n,fields:i})=>dn(["extend interface",t,Yn("implements ",dn(e," & ")),dn(n," "),Fa(i)]," ")},UnionTypeExtension:{leave:({name:t,directives:e,types:n})=>dn(["extend union",t,dn(e," "),Yn("= ",dn(n," | "))]," ")},EnumTypeExtension:{leave:({name:t,directives:e,values:n})=>dn(["extend enum",t,dn(e," "),Fa(n)]," ")},InputObjectTypeExtension:{leave:({name:t,directives:e,fields:n})=>dn(["extend input",t,dn(e," "),Fa(n)]," ")}};function dn(t,e=""){var n;return(n=t==null?void 0:t.filter(i=>i).join(e))!==null&&n!==void 0?n:""}function Fa(t){return Yn(`{
`,b_(dn(t,`
`)),`
}`)}function Yn(t,e,n=""){return e!=null&&e!==""?t+e+n:""}function b_(t){return Yn("  ",t.replace(/\n/g,`
  `))}function BL(t){var e;return(e=t==null?void 0:t.some(n=>n.includes(`
`)))!==null&&e!==void 0?e:!1}function FL(t){return t.kind===cn.FIELD||t.kind===cn.FRAGMENT_SPREAD||t.kind===cn.INLINE_FRAGMENT}function Wte(){return OL()}function Gte(){__DEV__?Ut(typeof ek=="boolean",ek):Ut(typeof ek=="boolean",39)}Wte();Gte();function nw(t,e){var n=t.directives;return!n||!n.length?!0:Xte(n).every(function(i){var r=i.directive,a=i.ifArgument,d=!1;return a.value.kind==="Variable"?(d=e&&e[a.value.name.value],__DEV__?Ut(d!==void 0,"Invalid variable referenced in @".concat(r.name.value," directive.")):Ut(d!==void 0,40)):d=a.value.value,r.name.value==="skip"?!d:d})}function nA(t,e,n){var i=new Set(t),r=i.size;return bc(e,{Directive:function(a){if(i.delete(a.name.value)&&(!n||!i.size))return tA}}),n?!i.size:i.size<r}function Hte(t){return t&&nA(["client","export"],t,!0)}function Zte(t){var e=t.name.value;return e==="skip"||e==="include"}function Xte(t){var e=[];return t&&t.length&&t.forEach(function(n){if(Zte(n)){var i=n.arguments,r=n.name.value;__DEV__?Ut(i&&i.length===1,"Incorrect number of arguments for the @".concat(r," directive.")):Ut(i&&i.length===1,41);var a=i[0];__DEV__?Ut(a.name&&a.name.value==="if","Invalid argument for the @".concat(r," directive.")):Ut(a.name&&a.name.value==="if",42);var d=a.value;__DEV__?Ut(d&&(d.kind==="Variable"||d.kind==="BooleanValue"),"Argument for the @".concat(r," directive must be a variable or a boolean value.")):Ut(d&&(d.kind==="Variable"||d.kind==="BooleanValue"),43),e.push({directive:n,ifArgument:a})}}),e}function Kte(t,e){var n=e,i=[];t.definitions.forEach(function(a){if(a.kind==="OperationDefinition")throw __DEV__?new vi("Found a ".concat(a.operation," operation").concat(a.name?" named '".concat(a.name.value,"'"):"",". ")+"No operations are allowed when using a fragment as a query. Only fragments are allowed."):new vi(44);a.kind==="FragmentDefinition"&&i.push(a)}),typeof n>"u"&&(__DEV__?Ut(i.length===1,"Found ".concat(i.length," fragments. `fragmentName` must be provided when there is not exactly 1 fragment.")):Ut(i.length===1,45),n=i[0].name.value);var r=rt(rt({},t),{definitions:ah([{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:n}}]}}],t.definitions,!0)});return r}function iA(t){t===void 0&&(t=[]);var e={};return t.forEach(function(n){e[n.name.value]=n}),e}function rA(t,e){switch(t.kind){case"InlineFragment":return t;case"FragmentSpread":{var n=t.name.value;if(typeof e=="function")return e(n);var i=e&&e[n];return __DEV__?Ut(i,"No fragment named ".concat(n)):Ut(i,46),i||null}default:return null}}function $i(t){return t!==null&&typeof t=="object"}function Rp(t){return{__ref:String(t)}}function Ei(t){return!!(t&&typeof t=="object"&&typeof t.__ref=="string")}function Yte(t){return $i(t)&&t.kind==="Document"&&Array.isArray(t.definitions)}function Jte(t){return t.kind==="StringValue"}function Qte(t){return t.kind==="BooleanValue"}function ene(t){return t.kind==="IntValue"}function tne(t){return t.kind==="FloatValue"}function nne(t){return t.kind==="Variable"}function ine(t){return t.kind==="ObjectValue"}function rne(t){return t.kind==="ListValue"}function one(t){return t.kind==="EnumValue"}function sne(t){return t.kind==="NullValue"}function em(t,e,n,i){if(ene(n)||tne(n))t[e.value]=Number(n.value);else if(Qte(n)||Jte(n))t[e.value]=n.value;else if(ine(n)){var r={};n.fields.map(function(d){return em(r,d.name,d.value,i)}),t[e.value]=r}else if(nne(n)){var a=(i||{})[n.name.value];t[e.value]=a}else if(rne(n))t[e.value]=n.values.map(function(d){var o={};return em(o,e,d,i),o[e.value]});else if(one(n))t[e.value]=n.value;else if(sne(n))t[e.value]=null;else throw __DEV__?new vi('The inline argument "'.concat(e.value,'" of kind "').concat(n.kind,'"')+"is not supported. Use variables instead of inline arguments to overcome this limitation."):new vi(55)}function ane(t,e){var n=null;t.directives&&(n={},t.directives.forEach(function(r){n[r.name.value]={},r.arguments&&r.arguments.forEach(function(a){var d=a.name,o=a.value;return em(n[r.name.value],d,o,e)})}));var i=null;return t.arguments&&t.arguments.length&&(i={},t.arguments.forEach(function(r){var a=r.name,d=r.value;return em(i,a,d,e)})),oA(t.name.value,i,n)}var lne=["connection","include","skip","client","rest","export"],oA=Object.assign(function(t,e,n){if(e&&n&&n.connection&&n.connection.key)if(n.connection.filter&&n.connection.filter.length>0){var i=n.connection.filter?n.connection.filter:[];i.sort();var r={};return i.forEach(function(o){r[o]=e[o]}),"".concat(n.connection.key,"(").concat(uy(r),")")}else return n.connection.key;var a=t;if(e){var d=uy(e);a+="(".concat(d,")")}return n&&Object.keys(n).forEach(function(o){lne.indexOf(o)===-1&&(n[o]&&Object.keys(n[o]).length?a+="@".concat(o,"(").concat(uy(n[o]),")"):a+="@".concat(o))}),a},{setStringify:function(t){var e=uy;return uy=t,e}}),uy=function(e){return JSON.stringify(e,cne)};function cne(t,e){return $i(e)&&!Array.isArray(e)&&(e=Object.keys(e).sort().reduce(function(n,i){return n[i]=e[i],n},{})),e}function iw(t,e){if(t.arguments&&t.arguments.length){var n={};return t.arguments.forEach(function(i){var r=i.name,a=i.value;return em(n,r,a,e)}),n}return null}function Ph(t){return t.alias?t.alias.value:t.name.value}function uC(t,e,n){for(var i,r=0,a=e.selections;r<a.length;r++){var d=a[r];if(Oh(d)){if(d.name.value==="__typename")return t[Ph(d)]}else i?i.push(d):i=[d]}if(typeof t.__typename=="string")return t.__typename;if(i)for(var o=0,f=i;o<f.length;o++){var d=f[o],g=uC(t,rA(d,n).selectionSet,n);if(typeof g=="string")return g}}function Oh(t){return t.kind==="Field"}function une(t){return t.kind==="InlineFragment"}function rw(t){__DEV__?Ut(t&&t.kind==="Document",'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'):Ut(t&&t.kind==="Document",47);var e=t.definitions.filter(function(n){return n.kind!=="FragmentDefinition"}).map(function(n){if(n.kind!=="OperationDefinition")throw __DEV__?new vi('Schema type definitions not allowed in queries. Found: "'.concat(n.kind,'"')):new vi(48);return n});return __DEV__?Ut(e.length<=1,"Ambiguous GraphQL document: contains ".concat(e.length," operations")):Ut(e.length<=1,49),t}function Wv(t){return rw(t),t.definitions.filter(function(e){return e.kind==="OperationDefinition"})[0]}function dC(t){return t.definitions.filter(function(e){return e.kind==="OperationDefinition"&&!!e.name}).map(function(e){return e.name.value})[0]||null}function sA(t){return t.definitions.filter(function(e){return e.kind==="FragmentDefinition"})}function o$(t){var e=Wv(t);return __DEV__?Ut(e&&e.operation==="query","Must contain a query definition."):Ut(e&&e.operation==="query",50),e}function dne(t){__DEV__?Ut(t.kind==="Document",'Expecting a parsed GraphQL document. Perhaps you need to wrap the query string in a "gql" tag? http://docs.apollostack.com/apollo-client/core.html#gql'):Ut(t.kind==="Document",51),__DEV__?Ut(t.definitions.length<=1,"Fragment must have exactly one definition."):Ut(t.definitions.length<=1,52);var e=t.definitions[0];return __DEV__?Ut(e.kind==="FragmentDefinition","Must be a fragment definition."):Ut(e.kind==="FragmentDefinition",53),e}function Gv(t){rw(t);for(var e,n=0,i=t.definitions;n<i.length;n++){var r=i[n];if(r.kind==="OperationDefinition"){var a=r.operation;if(a==="query"||a==="mutation"||a==="subscription")return r}r.kind==="FragmentDefinition"&&!e&&(e=r)}if(e)return e;throw __DEV__?new vi("Expected a parsed GraphQL query with a query, mutation, subscription, or a fragment."):new vi(54)}function aA(t){var e=Object.create(null),n=t&&t.variableDefinitions;return n&&n.length&&n.forEach(function(i){i.defaultValue&&em(e,i.variable.name,i.defaultValue)}),e}var Cr=Array.isArray;function Pl(t){return Array.isArray(t)&&t.length>0}var NL={kind:cn.FIELD,name:{kind:cn.NAME,value:"__typename"}};function s$(t,e){return!t||t.selectionSet.selections.every(function(n){return n.kind===cn.FRAGMENT_SPREAD&&s$(e[n.name.value],e)})}function hne(t){return s$(Wv(t)||dne(t),iA(sA(t)))?null:t}function fne(t){var e=new Set,n=[];return t.forEach(function(i){i.name?e.add(i.name):i.test&&n.push(i.test)}),function(i){return e.has(i.name.value)||n.some(function(r){return r(i)})}}function $L(t){var e=new Map;return function(i){i===void 0&&(i=t);var r=e.get(i);return r||e.set(i,r={variables:new Set,fragmentSpreads:new Set}),r}}function a$(t,e){for(var n=$L(""),i=$L(""),r=function(N){for(var q=0,K=void 0;q<N.length&&(K=N[q]);++q)if(!Cr(K)){if(K.kind===cn.OPERATION_DEFINITION)return n(K.name&&K.name.value);if(K.kind===cn.FRAGMENT_DEFINITION)return i(K.name.value)}return __DEV__&&Ut.error("Could not find operation or fragment"),null},a=0,d=e.definitions.length-1;d>=0;--d)e.definitions[d].kind===cn.OPERATION_DEFINITION&&++a;var o=fne(t),f=t.some(function(N){return N.remove}),g=function(N){return f&&N&&N.some(o)},_=new Map,w=!1,T={enter:function(N){if(g(N.directives))return w=!0,null}},A=bc(e,{Field:T,InlineFragment:T,VariableDefinition:{enter:function(){return!1}},Variable:{enter:function(N,q,K,se,ie){var Q=r(ie);Q&&Q.variables.add(N.name.value)}},FragmentSpread:{enter:function(N,q,K,se,ie){if(g(N.directives))return w=!0,null;var Q=r(ie);Q&&Q.fragmentSpreads.add(N.name.value)}},FragmentDefinition:{enter:function(N,q,K,se){_.set(JSON.stringify(se),N)},leave:function(N,q,K,se){var ie=_.get(JSON.stringify(se));if(N===ie)return N;if(a>0&&N.selectionSet.selections.every(function(Q){return Q.kind===cn.FIELD&&Q.name.value==="__typename"}))return i(N.name.value).removed=!0,w=!0,null}},Directive:{leave:function(N){if(o(N))return w=!0,null}}});if(!w)return e;var D=function(N){return N.transitiveVars||(N.transitiveVars=new Set(N.variables),N.removed||N.fragmentSpreads.forEach(function(q){D(i(q)).transitiveVars.forEach(function(K){N.transitiveVars.add(K)})})),N},z=new Set;A.definitions.forEach(function(N){N.kind===cn.OPERATION_DEFINITION?D(n(N.name&&N.name.value)).fragmentSpreads.forEach(function(q){z.add(q)}):N.kind===cn.FRAGMENT_DEFINITION&&a===0&&!i(N.name.value).removed&&z.add(N.name.value)}),z.forEach(function(N){D(i(N)).fragmentSpreads.forEach(function(q){z.add(q)})});var G=function(N){return!!(!z.has(N)||i(N).removed)},V={enter:function(N){if(G(N.name.value))return null}};return hne(bc(A,{FragmentSpread:V,FragmentDefinition:V,OperationDefinition:{leave:function(N){if(N.variableDefinitions){var q=D(n(N.name&&N.name.value)).transitiveVars;if(q.size<N.variableDefinitions.length)return rt(rt({},N),{variableDefinitions:N.variableDefinitions.filter(function(K){return q.has(K.variable.name.value)})})}}}}))}var lA=Object.assign(function(t){return bc(t,{SelectionSet:{enter:function(e,n,i){if(!(i&&i.kind===cn.OPERATION_DEFINITION)){var r=e.selections;if(r){var a=r.some(function(o){return Oh(o)&&(o.name.value==="__typename"||o.name.value.lastIndexOf("__",0)===0)});if(!a){var d=i;if(!(Oh(d)&&d.directives&&d.directives.some(function(o){return o.name.value==="export"})))return rt(rt({},e),{selections:ah(ah([],r,!0),[NL],!1)})}}}}}})},{added:function(t){return t===NL}}),pne={test:function(t){var e=t.name.value==="connection";return e&&(!t.arguments||!t.arguments.some(function(n){return n.name.value==="key"}))&&__DEV__&&Ut.warn("Removing an @connection directive even though it does not have a key. You may want to use the key parameter to specify a store key."),e}};function mne(t){return a$([pne],rw(t))}function gne(t){var e=Gv(t),n=e.operation;if(n==="query")return t;var i=bc(t,{OperationDefinition:{enter:function(r){return rt(rt({},r),{operation:"query"})}}});return i}function yne(t){rw(t);var e=a$([{test:function(n){return n.name.value==="client"},remove:!0}],t);return e}var vne=Object.prototype.hasOwnProperty;function jL(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return cA(t)}function cA(t){var e=t[0]||{},n=t.length;if(n>1)for(var i=new $u,r=1;r<n;++r)e=i.merge(e,t[r]);return e}var bne=function(t,e,n){return this.merge(t[n],e[n])},$u=function(){function t(e){e===void 0&&(e=bne),this.reconciler=e,this.isObject=$i,this.pastCopies=new Set}return t.prototype.merge=function(e,n){for(var i=this,r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];return $i(n)&&$i(e)?(Object.keys(n).forEach(function(d){if(vne.call(e,d)){var o=e[d];if(n[d]!==o){var f=i.reconciler.apply(i,ah([e,n,d],r,!1));f!==o&&(e=i.shallowCopyForMerge(e),e[d]=f)}}else e=i.shallowCopyForMerge(e),e[d]=n[d]}),e):n},t.prototype.shallowCopyForMerge=function(e){return $i(e)&&(this.pastCopies.has(e)||(Array.isArray(e)?e=e.slice(0):e=rt({__proto__:Object.getPrototypeOf(e)},e),this.pastCopies.add(e))),e},t}();function _ne(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=xne(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xne(t,e){if(t){if(typeof t=="string")return VL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VL(t,e)}}function VL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function UL(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function uA(t,e,n){return e&&UL(t.prototype,e),n&&UL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var dA=function(){return typeof Symbol=="function"},hA=function(t){return dA()&&!!Symbol[t]},fA=function(t){return hA(t)?Symbol[t]:"@@"+t};dA()&&!hA("observable")&&(Symbol.observable=Symbol("observable"));var wne=fA("iterator"),hC=fA("observable"),l$=fA("species");function Dx(t,e){var n=t[e];if(n!=null){if(typeof n!="function")throw new TypeError(n+" is not a function");return n}}function dy(t){var e=t.constructor;return e!==void 0&&(e=e[l$],e===null&&(e=void 0)),e!==void 0?e:Bi}function Sne(t){return t instanceof Bi}function tm(t){tm.log?tm.log(t):setTimeout(function(){throw t})}function __(t){Promise.resolve().then(function(){try{t()}catch(e){tm(e)}})}function c$(t){var e=t._cleanup;if(e!==void 0&&(t._cleanup=void 0,!!e))try{if(typeof e=="function")e();else{var n=Dx(e,"unsubscribe");n&&n.call(e)}}catch(i){tm(i)}}function fC(t){t._observer=void 0,t._queue=void 0,t._state="closed"}function Ene(t){var e=t._queue;if(e){t._queue=void 0,t._state="ready";for(var n=0;n<e.length&&(u$(t,e[n].type,e[n].value),t._state!=="closed");++n);}}function u$(t,e,n){t._state="running";var i=t._observer;try{var r=Dx(i,e);switch(e){case"next":r&&r.call(i,n);break;case"error":if(fC(t),r)r.call(i,n);else throw n;break;case"complete":fC(t),r&&r.call(i);break}}catch(a){tm(a)}t._state==="closed"?c$(t):t._state==="running"&&(t._state="ready")}function nk(t,e,n){if(t._state!=="closed"){if(t._state==="buffering"){t._queue.push({type:e,value:n});return}if(t._state!=="ready"){t._state="buffering",t._queue=[{type:e,value:n}],__(function(){return Ene(t)});return}u$(t,e,n)}}var kne=function(){function t(n,i){this._cleanup=void 0,this._observer=n,this._queue=void 0,this._state="initializing";var r=new Tne(this);try{this._cleanup=i.call(void 0,r)}catch(a){r.error(a)}this._state==="initializing"&&(this._state="ready")}var e=t.prototype;return e.unsubscribe=function(){this._state!=="closed"&&(fC(this),c$(this))},uA(t,[{key:"closed",get:function(){return this._state==="closed"}}]),t}(),Tne=function(){function t(n){this._subscription=n}var e=t.prototype;return e.next=function(i){nk(this._subscription,"next",i)},e.error=function(i){nk(this._subscription,"error",i)},e.complete=function(){nk(this._subscription,"complete")},uA(t,[{key:"closed",get:function(){return this._subscription._state==="closed"}}]),t}(),Bi=function(){function t(n){if(!(this instanceof t))throw new TypeError("Observable cannot be called as a function");if(typeof n!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=n}var e=t.prototype;return e.subscribe=function(i){return(typeof i!="object"||i===null)&&(i={next:i,error:arguments[1],complete:arguments[2]}),new kne(i,this._subscriber)},e.forEach=function(i){var r=this;return new Promise(function(a,d){if(typeof i!="function"){d(new TypeError(i+" is not a function"));return}function o(){f.unsubscribe(),a()}var f=r.subscribe({next:function(g){try{i(g,o)}catch(_){d(_),f.unsubscribe()}},error:d,complete:a})})},e.map=function(i){var r=this;if(typeof i!="function")throw new TypeError(i+" is not a function");var a=dy(this);return new a(function(d){return r.subscribe({next:function(o){try{o=i(o)}catch(f){return d.error(f)}d.next(o)},error:function(o){d.error(o)},complete:function(){d.complete()}})})},e.filter=function(i){var r=this;if(typeof i!="function")throw new TypeError(i+" is not a function");var a=dy(this);return new a(function(d){return r.subscribe({next:function(o){try{if(!i(o))return}catch(f){return d.error(f)}d.next(o)},error:function(o){d.error(o)},complete:function(){d.complete()}})})},e.reduce=function(i){var r=this;if(typeof i!="function")throw new TypeError(i+" is not a function");var a=dy(this),d=arguments.length>1,o=!1,f=arguments[1],g=f;return new a(function(_){return r.subscribe({next:function(w){var T=!o;if(o=!0,!T||d)try{g=i(g,w)}catch(A){return _.error(A)}else g=w},error:function(w){_.error(w)},complete:function(){if(!o&&!d)return _.error(new TypeError("Cannot reduce an empty sequence"));_.next(g),_.complete()}})})},e.concat=function(){for(var i=this,r=arguments.length,a=new Array(r),d=0;d<r;d++)a[d]=arguments[d];var o=dy(this);return new o(function(f){var g,_=0;function w(T){g=T.subscribe({next:function(A){f.next(A)},error:function(A){f.error(A)},complete:function(){_===a.length?(g=void 0,f.complete()):w(o.from(a[_++]))}})}return w(i),function(){g&&(g.unsubscribe(),g=void 0)}})},e.flatMap=function(i){var r=this;if(typeof i!="function")throw new TypeError(i+" is not a function");var a=dy(this);return new a(function(d){var o=[],f=r.subscribe({next:function(_){if(i)try{_=i(_)}catch(T){return d.error(T)}var w=a.from(_).subscribe({next:function(T){d.next(T)},error:function(T){d.error(T)},complete:function(){var T=o.indexOf(w);T>=0&&o.splice(T,1),g()}});o.push(w)},error:function(_){d.error(_)},complete:function(){g()}});function g(){f.closed&&o.length===0&&d.complete()}return function(){o.forEach(function(_){return _.unsubscribe()}),f.unsubscribe()}})},e[hC]=function(){return this},t.from=function(i){var r=typeof this=="function"?this:t;if(i==null)throw new TypeError(i+" is not an object");var a=Dx(i,hC);if(a){var d=a.call(i);if(Object(d)!==d)throw new TypeError(d+" is not an object");return Sne(d)&&d.constructor===r?d:new r(function(o){return d.subscribe(o)})}if(hA("iterator")&&(a=Dx(i,wne),a))return new r(function(o){__(function(){if(!o.closed){for(var f=_ne(a.call(i)),g;!(g=f()).done;){var _=g.value;if(o.next(_),o.closed)return}o.complete()}})});if(Array.isArray(i))return new r(function(o){__(function(){if(!o.closed){for(var f=0;f<i.length;++f)if(o.next(i[f]),o.closed)return;o.complete()}})});throw new TypeError(i+" is not observable")},t.of=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var d=typeof this=="function"?this:t;return new d(function(o){__(function(){if(!o.closed){for(var f=0;f<r.length;++f)if(o.next(r[f]),o.closed)return;o.complete()}})})},uA(t,null,[{key:l$,get:function(){return this}}]),t}();dA()&&Object.defineProperty(Bi,Symbol("extensions"),{value:{symbol:hC,hostReportError:tm},configurable:!0});function Cne(t){var e,n=t.Symbol;if(typeof n=="function")if(n.observable)e=n.observable;else{typeof n.for=="function"?e=n.for("https://github.com/benlesh/symbol-observable"):e=n("https://github.com/benlesh/symbol-observable");try{n.observable=e}catch(i){}}else e="@@observable";return e}var np;typeof self<"u"?np=self:typeof window<"u"?np=window:typeof global<"u"?np=global:typeof module<"u"?np=module:np=Function("return this")();Cne(np);var qL=Bi.prototype,WL="@@observable";qL[WL]||(qL[WL]=function(){return this});var Ine=Object.prototype.toString;function d$(t){return pC(t)}function pC(t,e){switch(Ine.call(t)){case"[object Array]":{if(e=e||new Map,e.has(t))return e.get(t);var n=t.slice(0);return e.set(t,n),n.forEach(function(r,a){n[a]=pC(r,e)}),n}case"[object Object]":{if(e=e||new Map,e.has(t))return e.get(t);var i=Object.create(Object.getPrototypeOf(t));return e.set(t,i),Object.keys(t).forEach(function(r){i[r]=pC(t[r],e)}),i}default:return t}}function Ane(t){var e=new Set([t]);return e.forEach(function(n){$i(n)&&Mne(n)===n&&Object.getOwnPropertyNames(n).forEach(function(i){$i(n[i])&&e.add(n[i])})}),t}function Mne(t){if(__DEV__&&!Object.isFrozen(t))try{Object.freeze(t)}catch(e){if(e instanceof TypeError)return null;throw e}return t}function mC(t){return __DEV__&&Ane(t),t}function Vy(t,e,n){var i=[];t.forEach(function(r){return r[e]&&i.push(r)}),i.forEach(function(r){return r[e](n)})}function ik(t,e,n){return new Bi(function(i){var r=i.next,a=i.error,d=i.complete,o=0,f=!1,g={then:function(A){return new Promise(function(D){return D(A())})}};function _(A,D){return A?function(z){++o;var G=function(){return A(z)};g=g.then(G,G).then(function(V){--o,r&&r.call(i,V),f&&w.complete()},function(V){throw--o,V}).catch(function(V){a&&a.call(i,V)})}:function(z){return D&&D.call(i,z)}}var w={next:_(e,r),error:_(n,a),complete:function(){f=!0,o||d&&d.call(i)}},T=t.subscribe(w);return function(){return T.unsubscribe()}})}var jh=typeof WeakMap=="function"&&aa(function(){return navigator.product})!=="ReactNative",Pne=typeof WeakSet=="function",pA=typeof Symbol=="function"&&typeof Symbol.for=="function",ow=pA&&Symbol.asyncIterator;aa(function(){return window.document.createElement});aa(function(){return navigator.userAgent.indexOf("jsdom")>=0});function h$(t){function e(n){Object.defineProperty(t,n,{value:Bi})}return pA&&Symbol.species&&e(Symbol.species),e("@@species"),t}function GL(t){return t&&typeof t.then=="function"}var ip=function(t){ma(e,t);function e(n){var i=t.call(this,function(r){return i.addObserver(r),function(){return i.removeObserver(r)}})||this;return i.observers=new Set,i.promise=new Promise(function(r,a){i.resolve=r,i.reject=a}),i.handlers={next:function(r){i.sub!==null&&(i.latest=["next",r],i.notify("next",r),Vy(i.observers,"next",r))},error:function(r){var a=i.sub;a!==null&&(a&&setTimeout(function(){return a.unsubscribe()}),i.sub=null,i.latest=["error",r],i.reject(r),i.notify("error",r),Vy(i.observers,"error",r))},complete:function(){var r=i,a=r.sub,d=r.sources,o=d===void 0?[]:d;if(a!==null){var f=o.shift();f?GL(f)?f.then(function(g){return i.sub=g.subscribe(i.handlers)}):i.sub=f.subscribe(i.handlers):(a&&setTimeout(function(){return a.unsubscribe()}),i.sub=null,i.latest&&i.latest[0]==="next"?i.resolve(i.latest[1]):i.resolve(),i.notify("complete"),Vy(i.observers,"complete"))}}},i.nextResultListeners=new Set,i.cancel=function(r){i.reject(r),i.sources=[],i.handlers.complete()},i.promise.catch(function(r){}),typeof n=="function"&&(n=[new Bi(n)]),GL(n)?n.then(function(r){return i.start(r)},i.handlers.error):i.start(n),i}return e.prototype.start=function(n){this.sub===void 0&&(this.sources=Array.from(n),this.handlers.complete())},e.prototype.deliverLastMessage=function(n){if(this.latest){var i=this.latest[0],r=n[i];r&&r.call(n,this.latest[1]),this.sub===null&&i==="next"&&n.complete&&n.complete()}},e.prototype.addObserver=function(n){this.observers.has(n)||(this.deliverLastMessage(n),this.observers.add(n))},e.prototype.removeObserver=function(n){this.observers.delete(n)&&this.observers.size<1&&this.handlers.complete()},e.prototype.notify=function(n,i){var r=this.nextResultListeners;r.size&&(this.nextResultListeners=new Set,r.forEach(function(a){return a(n,i)}))},e.prototype.beforeNext=function(n){var i=!1;this.nextResultListeners.add(function(r,a){i||(i=!0,n(r,a))})},e}(Bi);h$(ip);function Lp(t){return"incremental"in t}function One(t){return"hasNext"in t&&"data"in t}function Dne(t){return Lp(t)||One(t)}function Rne(t){return $i(t)&&"payload"in t}function f$(t,e){var n=t,i=new $u;return Lp(e)&&Pl(e.incremental)&&e.incremental.forEach(function(r){for(var a=r.data,d=r.path,o=d.length-1;o>=0;--o){var f=d[o],g=!isNaN(+f),_=g?[]:{};_[f]=a,a=_}n=i.merge(n,a)}),n}function x_(t){var e=gC(t);return Pl(e)}function gC(t){var e=Pl(t.errors)?t.errors.slice(0):[];return Lp(t)&&Pl(t.incremental)&&t.incremental.forEach(function(n){n.errors&&e.push.apply(e,n.errors)}),e}function sw(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Object.create(null);return t.forEach(function(i){i&&Object.keys(i).forEach(function(r){var a=i[r];a!==void 0&&(n[r]=a)})}),n}var HL=new Map;function yC(t){var e=HL.get(t)||1;return HL.set(t,e+1),"".concat(t,":").concat(e,":").concat(Math.random().toString(36).slice(2))}function Lne(t){var e=yC("stringifyForDisplay");return JSON.stringify(t,function(n,i){return i===void 0?e:i}).split(JSON.stringify(e)).join("<undefined>")}function w_(t,e){return sw(t,e,e.variables&&{variables:rt(rt({},t&&t.variables),e.variables)})}function ZL(t){return new Bi(function(e){e.error(t)})}var vC=function(t,e,n){var i=new Error(n);throw i.name="ServerError",i.response=t,i.statusCode=t.status,i.result=e,i};function zne(t){for(var e=["query","operationName","variables","extensions","context"],n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];if(e.indexOf(r)<0)throw __DEV__?new vi("illegal argument: ".concat(r)):new vi(27)}return t}function Bne(t,e){var n=rt({},t),i=function(a){typeof a=="function"?n=rt(rt({},n),a(n)):n=rt(rt({},n),a)},r=function(){return rt({},n)};return Object.defineProperty(e,"setContext",{enumerable:!1,value:i}),Object.defineProperty(e,"getContext",{enumerable:!1,value:r}),e}function Fne(t){var e={variables:t.variables||{},extensions:t.extensions||{},operationName:t.operationName,query:t.query};return e.operationName||(e.operationName=typeof e.query!="string"?dC(e.query)||void 0:""),e}function XL(t,e){return e?e(t):Bi.of()}function hy(t){return typeof t=="function"?new Xu(t):t}function Hb(t){return t.request.length<=1}var Nne=function(t){ma(e,t);function e(n,i){var r=t.call(this,n)||this;return r.link=i,r}return e}(Error),Xu=function(){function t(e){e&&(this.request=e)}return t.empty=function(){return new t(function(){return Bi.of()})},t.from=function(e){return e.length===0?t.empty():e.map(hy).reduce(function(n,i){return n.concat(i)})},t.split=function(e,n,i){var r=hy(n),a=hy(i||new t(XL));return Hb(r)&&Hb(a)?new t(function(d){return e(d)?r.request(d)||Bi.of():a.request(d)||Bi.of()}):new t(function(d,o){return e(d)?r.request(d,o)||Bi.of():a.request(d,o)||Bi.of()})},t.execute=function(e,n){return e.request(Bne(n.context,Fne(zne(n))))||Bi.of()},t.concat=function(e,n){var i=hy(e);if(Hb(i))return __DEV__&&Ut.warn(new Nne("You are calling concat on a terminating link, which will have no effect",i)),i;var r=hy(n);return Hb(r)?new t(function(a){return i.request(a,function(d){return r.request(d)||Bi.of()})||Bi.of()}):new t(function(a,d){return i.request(a,function(o){return r.request(o,d)||Bi.of()})||Bi.of()})},t.prototype.split=function(e,n,i){return this.concat(t.split(e,n,i||new t(XL)))},t.prototype.concat=function(e){return t.concat(this,e)},t.prototype.request=function(e,n){throw __DEV__?new vi("request is not implemented"):new vi(22)},t.prototype.onError=function(e,n){if(n&&n.error)return n.error(e),!1;throw e},t.prototype.setOnError=function(e){return this.onError=e,this},t}(),$ne=Xu.split,bC=Xu.execute,jne="3.7.17";function Vne(t){return!!t.body}function Une(t){return!!t.getReader}function qne(t){return!!(ow&&t[Symbol.asyncIterator])}function Wne(t){return!!t.stream}function Gne(t){return!!t.arrayBuffer}function Hne(t){return!!t.pipe}function Zne(t){var e,n=t[Symbol.asyncIterator]();return e={next:function(){return n.next()}},e[Symbol.asyncIterator]=function(){return this},e}function Xne(t){var e=null,n=null,i=!1,r=[],a=[];function d(w){if(!n){if(a.length){var T=a.shift();if(Array.isArray(T)&&T[0])return T[0]({value:w,done:!1})}r.push(w)}}function o(w){n=w;var T=a.slice();T.forEach(function(A){A[1](w)}),!e||e()}function f(){i=!0;var w=a.slice();w.forEach(function(T){T[0]({value:void 0,done:!0})}),!e||e()}e=function(){e=null,t.removeListener("data",d),t.removeListener("error",o),t.removeListener("end",f),t.removeListener("finish",f),t.removeListener("close",f)},t.on("data",d),t.on("error",o),t.on("end",f),t.on("finish",f),t.on("close",f);function g(){return new Promise(function(w,T){if(n)return T(n);if(r.length)return w({value:r.shift(),done:!1});if(i)return w({value:void 0,done:!0});a.push([w,T])})}var _={next:function(){return g()}};return ow&&(_[Symbol.asyncIterator]=function(){return this}),_}function Kne(t){var e=!1,n={next:function(){return e?Promise.resolve({value:void 0,done:!0}):(e=!0,new Promise(function(i,r){t.then(function(a){i({value:a,done:!1})}).catch(r)}))}};return ow&&(n[Symbol.asyncIterator]=function(){return this}),n}function KL(t){var e={next:function(){return t.read()}};return ow&&(e[Symbol.asyncIterator]=function(){return this}),e}function Yne(t){var e=t;if(Vne(t)&&(e=t.body),qne(e))return Zne(e);if(Une(e))return KL(e.getReader());if(Wne(e))return KL(e.stream().getReader());if(Gne(e))return Kne(e.arrayBuffer());if(Hne(e))return Xne(e);throw new Error("Unknown body type for responseIterator. Please pass a streamable response.")}var mA=Symbol();function Jne(t){return t.extensions?Array.isArray(t.extensions[mA]):!1}function Qne(t){return t.hasOwnProperty("graphQLErrors")}var eie=function(t){var e=ah(ah(ah([],t.graphQLErrors,!0),t.clientErrors,!0),t.protocolErrors,!0);return t.networkError&&e.push(t.networkError),e.map(function(n){return $i(n)&&n.message||"Error message not found."}).join(`
`)},au=function(t){ma(e,t);function e(n){var i=n.graphQLErrors,r=n.protocolErrors,a=n.clientErrors,d=n.networkError,o=n.errorMessage,f=n.extraInfo,g=t.call(this,o)||this;return g.name="ApolloError",g.graphQLErrors=i||[],g.protocolErrors=r||[],g.clientErrors=a||[],g.networkError=d||null,g.message=o||eie(g),g.extraInfo=f,g.__proto__=e.prototype,g}return e}(Error),YL=Object.prototype.hasOwnProperty;function tie(t,e){var n,i,r,a,d;return ru(this,void 0,void 0,function(){var o,f,g,_,w,T,A,D,z,G,V,N,q,K,se,ie,Q,J,te,me,Fe,tt,At;return ou(this,function(_t){switch(_t.label){case 0:if(TextDecoder===void 0)throw new Error("TextDecoder must be defined in the environment: please import a polyfill.");o=new TextDecoder("utf-8"),f=(n=t.headers)===null||n===void 0?void 0:n.get("content-type"),g="boundary=",_=f!=null&&f.includes(g)?f==null?void 0:f.substring((f==null?void 0:f.indexOf(g))+g.length).replace(/['"]/g,"").replace(/\;(.*)/gm,"").trim():"-",w=`\r
--`.concat(_),T="",A=Yne(t),D=!0,_t.label=1;case 1:return D?[4,A.next()]:[3,3];case 2:for(z=_t.sent(),G=z.value,V=z.done,N=typeof G=="string"?G:o.decode(G),q=T.length-w.length+1,D=!V,T+=N,K=T.indexOf(w,q);K>-1;){if(se=void 0,tt=[T.slice(0,K),T.slice(K+w.length)],se=tt[0],T=tt[1],ie=se.indexOf(`\r
\r
`),Q=nie(se.slice(0,ie)),J=Q["content-type"],J&&J.toLowerCase().indexOf("application/json")===-1)throw new Error("Unsupported patch content type: application/json is required.");if(te=se.slice(ie),te)try{me=p$(t,te),Object.keys(me).length>1||"data"in me||"incremental"in me||"errors"in me||"payload"in me?Rne(me)?(Fe={},"payload"in me&&(Fe=rt({},me.payload)),"errors"in me&&(Fe=rt(rt({},Fe),{extensions:rt(rt({},"extensions"in Fe?Fe.extensions:null),(At={},At[mA]=me.errors,At))})),(i=e.next)===null||i===void 0||i.call(e,Fe)):(r=e.next)===null||r===void 0||r.call(e,me):Object.keys(me).length===1&&"hasNext"in me&&!me.hasNext&&((a=e.complete)===null||a===void 0||a.call(e))}catch(xt){gA(xt,e)}K=T.indexOf(w)}return[3,1];case 3:return(d=e.complete)===null||d===void 0||d.call(e),[2]}})})}function nie(t){var e={};return t.split(`
`).forEach(function(n){var i=n.indexOf(":");if(i>-1){var r=n.slice(0,i).trim().toLowerCase(),a=n.slice(i+1).trim();e[r]=a}}),e}function p$(t,e){if(t.status>=300){var n=function(){try{return JSON.parse(e)}catch(r){return e}};vC(t,n(),"Response not successful: Received status code ".concat(t.status))}try{return JSON.parse(e)}catch(r){var i=r;throw i.name="ServerParseError",i.response=t,i.statusCode=t.status,i.bodyText=e,i}}function gA(t,e){var n,i;t.name!=="AbortError"&&(t.result&&t.result.errors&&t.result.data&&((n=e.next)===null||n===void 0||n.call(e,t.result)),(i=e.error)===null||i===void 0||i.call(e,t))}function iie(t,e,n){rie(e)(t).then(function(i){var r,a;(r=n.next)===null||r===void 0||r.call(n,i),(a=n.complete)===null||a===void 0||a.call(n)}).catch(function(i){return gA(i,n)})}function rie(t){return function(e){return e.text().then(function(n){return p$(e,n)}).then(function(n){return e.status>=300&&vC(e,n,"Response not successful: Received status code ".concat(e.status)),!Array.isArray(n)&&!YL.call(n,"data")&&!YL.call(n,"errors")&&vC(e,n,"Server response was missing for query '".concat(Array.isArray(t)?t.map(function(i){return i.operationName}):t.operationName,"'.")),n})}}var _C=function(t,e){var n;try{n=JSON.stringify(t)}catch(r){var i=__DEV__?new vi("Network request failed. ".concat(e," is not serializable: ").concat(r.message)):new vi(24);throw i.parseError=r,i}return n},oie={includeQuery:!0,includeExtensions:!1,preserveHeaderCase:!1},sie={accept:"*/*","content-type":"application/json"},aie={method:"POST"},lie={http:oie,headers:sie,options:aie},cie=function(t,e){return e(t)};function uie(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r={},a={};n.forEach(function(w){r=rt(rt(rt({},r),w.options),{headers:rt(rt({},r.headers),w.headers)}),w.credentials&&(r.credentials=w.credentials),a=rt(rt({},a),w.http)}),r.headers&&(r.headers=die(r.headers,a.preserveHeaderCase));var d=t.operationName,o=t.extensions,f=t.variables,g=t.query,_={operationName:d,variables:f};return a.includeExtensions&&(_.extensions=o),a.includeQuery&&(_.query=e(g,r$)),{options:r,body:_}}function die(t,e){if(!e){var n=Object.create(null);return Object.keys(Object(t)).forEach(function(a){n[a.toLowerCase()]=t[a]}),n}var i=Object.create(null);Object.keys(Object(t)).forEach(function(a){i[a.toLowerCase()]={originalName:a,value:t[a]}});var r=Object.create(null);return Object.keys(i).forEach(function(a){r[i[a].originalName]=i[a].value}),r}var hie=function(t){if(!t&&typeof fetch>"u")throw __DEV__?new vi(`
"fetch" has not been found globally and no fetcher has been configured. To fix this, install a fetch package (like https://www.npmjs.com/package/cross-fetch), instantiate the fetcher, and pass it into your HttpLink constructor. For example:

import fetch from 'cross-fetch';
import { ApolloClient, HttpLink } from '@apollo/client';
const client = new ApolloClient({
  link: new HttpLink({ uri: '/graphql', fetch })
});
    `):new vi(23)},fie=function(){if(typeof AbortController>"u")return{controller:!1,signal:!1};var t=new AbortController,e=t.signal;return{controller:t,signal:e}},pie=function(t,e){var n=t.getContext(),i=n.uri;return i||(typeof e=="function"?e(t):e||"/graphql")};function mie(t,e){var n=[],i=function(w,T){n.push("".concat(w,"=").concat(encodeURIComponent(T)))};if("query"in e&&i("query",e.query),e.operationName&&i("operationName",e.operationName),e.variables){var r=void 0;try{r=_C(e.variables,"Variables map")}catch(w){return{parseError:w}}i("variables",r)}if(e.extensions){var a=void 0;try{a=_C(e.extensions,"Extensions map")}catch(w){return{parseError:w}}i("extensions",a)}var d="",o=t,f=t.indexOf("#");f!==-1&&(d=t.substr(f),o=t.substr(0,f));var g=o.indexOf("?")===-1?"?":"&",_=o+g+n.join("&")+d;return{newURI:_}}var JL=aa(function(){return fetch}),m$=function(t){t===void 0&&(t={});var e=t.uri,n=e===void 0?"/graphql":e,i=t.fetch,r=t.print,a=r===void 0?cie:r,d=t.includeExtensions,o=t.preserveHeaderCase,f=t.useGETForQueries,g=t.includeUnusedVariables,_=g===void 0?!1:g,w=or(t,["uri","fetch","print","includeExtensions","preserveHeaderCase","useGETForQueries","includeUnusedVariables"]);__DEV__&&hie(i||JL);var T={http:{includeExtensions:d,preserveHeaderCase:o},options:w.fetchOptions,credentials:w.credentials,headers:w.headers};return new Xu(function(A){var D=pie(A,n),z=A.getContext(),G={};if(z.clientAwareness){var V=z.clientAwareness,N=V.name,q=V.version;N&&(G["apollographql-client-name"]=N),q&&(G["apollographql-client-version"]=q)}var K=rt(rt({},G),z.headers),se={http:z.http,options:z.fetchOptions,credentials:z.credentials,headers:K},ie=uie(A,a,lie,T,se),Q=ie.options,J=ie.body;if(J.variables&&!_){var te=new Set(Object.keys(J.variables));bc(A.query,{Variable:function(gt,Nt,en){en&&en.kind!=="VariableDefinition"&&te.delete(gt.name.value)}}),te.size&&(J.variables=rt({},J.variables),te.forEach(function(gt){delete J.variables[gt]}))}var me;if(!Q.signal){var Fe=fie(),tt=Fe.controller,At=Fe.signal;me=tt,me&&(Q.signal=At)}var _t=function(gt){return gt.kind==="OperationDefinition"&&gt.operation==="mutation"},xt=function(gt){return gt.kind==="OperationDefinition"&&gt.operation==="subscription"},lt=xt(Gv(A.query)),zt=nA(["defer"],A.query);if(f&&!A.query.definitions.some(_t)&&(Q.method="GET"),zt||lt){Q.headers=Q.headers||{};var ze="multipart/mixed;";lt&&zt&&__DEV__&&Ut.warn("Multipart-subscriptions do not support @defer"),lt?ze+="boundary=graphql;subscriptionSpec=1.0,application/json":zt&&(ze+="deferSpec=20220824,application/json"),Q.headers.accept=ze}if(Q.method==="GET"){var ot=mie(D,J),Be=ot.newURI,ft=ot.parseError;if(ft)return ZL(ft);D=Be}else try{Q.body=_C(J,"Payload")}catch(gt){return ZL(gt)}return new Bi(function(gt){var Nt=i||aa(function(){return fetch})||JL;return Nt(D,Q).then(function(en){var Xt;A.setContext({response:en});var wt=(Xt=en.headers)===null||Xt===void 0?void 0:Xt.get("content-type");return wt!==null&&/^multipart\/mixed/i.test(wt)?tie(en,gt):iie(en,A,gt)}).catch(function(en){return gA(en,gt)}),function(){me&&me.abort()}})})},gie=function(t){ma(e,t);function e(n){n===void 0&&(n={});var i=t.call(this,m$(n).request)||this;return i.options=n,i}return e}(Xu);const{toString:QL,hasOwnProperty:yie}=Object.prototype,ez=Function.prototype.toString,xC=new Map;function kr(t,e){try{return wC(t,e)}finally{xC.clear()}}function wC(t,e){if(t===e)return!0;const n=QL.call(t),i=QL.call(e);if(n!==i)return!1;switch(n){case"[object Array]":if(t.length!==e.length)return!1;case"[object Object]":{if(nz(t,e))return!0;const r=tz(t),a=tz(e),d=r.length;if(d!==a.length)return!1;for(let o=0;o<d;++o)if(!yie.call(e,r[o]))return!1;for(let o=0;o<d;++o){const f=r[o];if(!wC(t[f],e[f]))return!1}return!0}case"[object Error]":return t.name===e.name&&t.message===e.message;case"[object Number]":if(t!==t)return e!==e;case"[object Boolean]":case"[object Date]":return+t==+e;case"[object RegExp]":case"[object String]":return t==`${e}`;case"[object Map]":case"[object Set]":{if(t.size!==e.size)return!1;if(nz(t,e))return!0;const r=t.entries(),a=n==="[object Map]";for(;;){const d=r.next();if(d.done)break;const[o,f]=d.value;if(!e.has(o)||a&&!wC(f,e.get(o)))return!1}return!0}case"[object Uint16Array]":case"[object Uint8Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object ArrayBuffer]":t=new Uint8Array(t),e=new Uint8Array(e);case"[object DataView]":{let r=t.byteLength;if(r===e.byteLength)for(;r--&&t[r]===e[r];);return r===-1}case"[object AsyncFunction]":case"[object GeneratorFunction]":case"[object AsyncGeneratorFunction]":case"[object Function]":{const r=ez.call(t);return r!==ez.call(e)?!1:!_ie(r,bie)}}return!1}function tz(t){return Object.keys(t).filter(vie,t)}function vie(t){return this[t]!==void 0}const bie="{ [native code] }";function _ie(t,e){const n=t.length-e.length;return n>=0&&t.indexOf(e,n)===n}function nz(t,e){let n=xC.get(t);if(n){if(n.has(e))return!0}else xC.set(t,n=new Set);return n.add(e),!1}var xie=function(){return Object.create(null)},g$=Array.prototype,wie=g$.forEach,Sie=g$.slice,Eie=function(){function t(e,n){e===void 0&&(e=!0),n===void 0&&(n=xie),this.weakness=e,this.makeData=n}return t.prototype.lookup=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.lookupArray(e)},t.prototype.lookupArray=function(e){var n=this;return wie.call(e,function(i){return n=n.getChildTrie(i)}),n.data||(n.data=this.makeData(Sie.call(e)))},t.prototype.getChildTrie=function(e){var n=this.weakness&&kie(e)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map),i=n.get(e);return i||n.set(e,i=new t(this.weakness,this.makeData)),i},t}();function kie(t){switch(typeof t){case"object":if(t===null)break;case"function":return!0}return!1}let mo=null;const iz={};let Tie=1;const Cie=()=>class{constructor(){this.id=["slot",Tie++,Date.now(),Math.random().toString(36).slice(2)].join(":")}hasValue(){for(let e=mo;e;e=e.parent)if(this.id in e.slots){const n=e.slots[this.id];if(n===iz)break;return e!==mo&&(mo.slots[this.id]=n),!0}return mo&&(mo.slots[this.id]=iz),!1}getValue(){if(this.hasValue())return mo.slots[this.id]}withValue(e,n,i,r){const a={__proto__:null,[this.id]:e},d=mo;mo={parent:d,slots:a};try{return n.apply(r,i)}finally{mo=d}}static bind(e){const n=mo;return function(){const i=mo;try{return mo=n,e.apply(this,arguments)}finally{mo=i}}}static noContext(e,n,i){if(mo){const r=mo;try{return mo=null,e.apply(i,n)}finally{mo=r}}else return e.apply(i,n)}};function rz(t){try{return t()}catch(e){}}const rk="@wry/context:Slot",Iie=rz(()=>globalThis)||rz(()=>global)||Object.create(null),oz=Iie,y$=oz[rk]||Array[rk]||function(t){try{Object.defineProperty(oz,rk,{value:t,enumerable:!1,writable:!1,configurable:!0})}finally{return t}}(Cie());function Aie(){}var Mie=function(){function t(e,n){e===void 0&&(e=1/0),n===void 0&&(n=Aie),this.max=e,this.dispose=n,this.map=new Map,this.newest=null,this.oldest=null}return t.prototype.has=function(e){return this.map.has(e)},t.prototype.get=function(e){var n=this.getNode(e);return n&&n.value},t.prototype.getNode=function(e){var n=this.map.get(e);if(n&&n!==this.newest){var i=n.older,r=n.newer;r&&(r.older=i),i&&(i.newer=r),n.older=this.newest,n.older.newer=n,n.newer=null,this.newest=n,n===this.oldest&&(this.oldest=r)}return n},t.prototype.set=function(e,n){var i=this.getNode(e);return i?i.value=n:(i={key:e,value:n,newer:null,older:this.newest},this.newest&&(this.newest.newer=i),this.newest=i,this.oldest=this.oldest||i,this.map.set(e,i),i.value)},t.prototype.clean=function(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)},t.prototype.delete=function(e){var n=this.map.get(e);return n?(n===this.newest&&(this.newest=n.older),n===this.oldest&&(this.oldest=n.newer),n.newer&&(n.newer.older=n.older),n.older&&(n.older.newer=n.newer),this.map.delete(e),this.dispose(n.value,e),!0):!1},t}(),aw=new y$,ok,Pie=Object.prototype.hasOwnProperty,yA=(ok=Array.from,ok===void 0?function(t){var e=[];return t.forEach(function(n){return e.push(n)}),e}:ok);function Rx(t){var e=t.unsubscribe;typeof e=="function"&&(t.unsubscribe=void 0,e())}var xv=[],Oie=100;function nm(t,e){if(!t)throw new Error(e||"assertion failure")}function Die(t,e){var n=t.length;return n>0&&n===e.length&&t[n-1]===e[n-1]}function v$(t){switch(t.length){case 0:throw new Error("unknown value");case 1:return t[0];case 2:throw t[1]}}function Rie(t){return t.slice(0)}var Lie=function(){function t(e){this.fn=e,this.parents=new Set,this.childValues=new Map,this.dirtyChildren=null,this.dirty=!0,this.recomputing=!1,this.value=[],this.deps=null,++t.count}return t.prototype.peek=function(){if(this.value.length===1&&!ju(this))return sz(this),this.value[0]},t.prototype.recompute=function(e){return nm(!this.recomputing,"already recomputing"),sz(this),ju(this)?zie(this,e):v$(this.value)},t.prototype.setDirty=function(){this.dirty||(this.dirty=!0,this.value.length=0,b$(this),Rx(this))},t.prototype.dispose=function(){var e=this;this.setDirty(),E$(this),vA(this,function(n,i){n.setDirty(),k$(n,e)})},t.prototype.forget=function(){this.dispose()},t.prototype.dependOn=function(e){e.add(this),this.deps||(this.deps=xv.pop()||new Set),this.deps.add(e)},t.prototype.forgetDeps=function(){var e=this;this.deps&&(yA(this.deps).forEach(function(n){return n.delete(e)}),this.deps.clear(),xv.push(this.deps),this.deps=null)},t.count=0,t}();function sz(t){var e=aw.getValue();if(e)return t.parents.add(e),e.childValues.has(t)||e.childValues.set(t,[]),ju(t)?x$(e,t):w$(e,t),e}function zie(t,e){return E$(t),aw.withValue(t,Bie,[t,e]),Nie(t,e)&&Fie(t),v$(t.value)}function Bie(t,e){t.recomputing=!0,t.value.length=0;try{t.value[0]=t.fn.apply(null,e)}catch(n){t.value[1]=n}t.recomputing=!1}function ju(t){return t.dirty||!!(t.dirtyChildren&&t.dirtyChildren.size)}function Fie(t){t.dirty=!1,!ju(t)&&_$(t)}function b$(t){vA(t,x$)}function _$(t){vA(t,w$)}function vA(t,e){var n=t.parents.size;if(n)for(var i=yA(t.parents),r=0;r<n;++r)e(i[r],t)}function x$(t,e){nm(t.childValues.has(e)),nm(ju(e));var n=!ju(t);if(!t.dirtyChildren)t.dirtyChildren=xv.pop()||new Set;else if(t.dirtyChildren.has(e))return;t.dirtyChildren.add(e),n&&b$(t)}function w$(t,e){nm(t.childValues.has(e)),nm(!ju(e));var n=t.childValues.get(e);n.length===0?t.childValues.set(e,Rie(e.value)):Die(n,e.value)||t.setDirty(),S$(t,e),!ju(t)&&_$(t)}function S$(t,e){var n=t.dirtyChildren;n&&(n.delete(e),n.size===0&&(xv.length<Oie&&xv.push(n),t.dirtyChildren=null))}function E$(t){t.childValues.size>0&&t.childValues.forEach(function(e,n){k$(t,n)}),t.forgetDeps(),nm(t.dirtyChildren===null)}function k$(t,e){e.parents.delete(t),t.childValues.delete(e),S$(t,e)}function Nie(t,e){if(typeof t.subscribe=="function")try{Rx(t),t.unsubscribe=t.subscribe.apply(null,e)}catch(n){return t.setDirty(),!1}return!0}var $ie={setDirty:!0,dispose:!0,forget:!0};function T$(t){var e=new Map,n=t&&t.subscribe;function i(r){var a=aw.getValue();if(a){var d=e.get(r);d||e.set(r,d=new Set),a.dependOn(d),typeof n=="function"&&(Rx(d),d.unsubscribe=n(r))}}return i.dirty=function(a,d){var o=e.get(a);if(o){var f=d&&Pie.call($ie,d)?d:"setDirty";yA(o).forEach(function(g){return g[f]()}),e.delete(a),Rx(o)}},i}function C$(){var t=new Eie(typeof WeakMap=="function");return function(){return t.lookupArray(arguments)}}C$();var sk=new Set;function Lx(t,e){e===void 0&&(e=Object.create(null));var n=new Mie(e.max||Math.pow(2,16),function(g){return g.dispose()}),i=e.keyArgs,r=e.makeCacheKey||C$(),a=function(){var g=r.apply(null,i?i.apply(null,arguments):arguments);if(g===void 0)return t.apply(null,arguments);var _=n.get(g);_||(n.set(g,_=new Lie(t)),_.subscribe=e.subscribe,_.forget=function(){return n.delete(g)});var w=_.recompute(Array.prototype.slice.call(arguments));return n.set(g,_),sk.add(n),aw.hasValue()||(sk.forEach(function(T){return T.clean()}),sk.clear()),w};Object.defineProperty(a,"size",{get:function(){return n.map.size},configurable:!1,enumerable:!1});function d(g){var _=n.get(g);_&&_.setDirty()}a.dirtyKey=d,a.dirty=function(){d(r.apply(null,arguments))};function o(g){var _=n.get(g);if(_)return _.peek()}a.peekKey=o,a.peek=function(){return o(r.apply(null,arguments))};function f(g){return n.delete(g)}return a.forgetKey=f,a.forget=function(){return f(r.apply(null,arguments))},a.makeCacheKey=r,a.getKey=i?function(){return r.apply(null,i.apply(null,arguments))}:r,Object.freeze(a)}var jie=function(){function t(){this.getFragmentDoc=Lx(Kte)}return t.prototype.batch=function(e){var n=this,i=typeof e.optimistic=="string"?e.optimistic:e.optimistic===!1?null:void 0,r;return this.performTransaction(function(){return r=e.update(n)},i),r},t.prototype.recordOptimisticTransaction=function(e,n){this.performTransaction(e,n)},t.prototype.transformDocument=function(e){return e},t.prototype.transformForLink=function(e){return e},t.prototype.identify=function(e){},t.prototype.gc=function(){return[]},t.prototype.modify=function(e){return!1},t.prototype.readQuery=function(e,n){return n===void 0&&(n=!!e.optimistic),this.read(rt(rt({},e),{rootId:e.id||"ROOT_QUERY",optimistic:n}))},t.prototype.readFragment=function(e,n){return n===void 0&&(n=!!e.optimistic),this.read(rt(rt({},e),{query:this.getFragmentDoc(e.fragment,e.fragmentName),rootId:e.id,optimistic:n}))},t.prototype.writeQuery=function(e){var n=e.id,i=e.data,r=or(e,["id","data"]);return this.write(Object.assign(r,{dataId:n||"ROOT_QUERY",result:i}))},t.prototype.writeFragment=function(e){var n=e.id,i=e.data,r=e.fragment,a=e.fragmentName,d=or(e,["id","data","fragment","fragmentName"]);return this.write(Object.assign(d,{query:this.getFragmentDoc(r,a),dataId:n,result:i}))},t.prototype.updateQuery=function(e,n){return this.batch({update:function(i){var r=i.readQuery(e),a=n(r);return a==null?r:(i.writeQuery(rt(rt({},e),{data:a})),a)}})},t.prototype.updateFragment=function(e,n){return this.batch({update:function(i){var r=i.readFragment(e),a=n(r);return a==null?r:(i.writeFragment(rt(rt({},e),{data:a})),a)}})},t}(),I$=function(t){ma(e,t);function e(n,i,r,a){var d,o=t.call(this,n)||this;if(o.message=n,o.path=i,o.query=r,o.variables=a,Array.isArray(o.path)){o.missing=o.message;for(var f=o.path.length-1;f>=0;--f)o.missing=(d={},d[o.path[f]]=o.missing,d)}else o.missing=o.path;return o.__proto__=e.prototype,o}return e}(Error);const Vie=()=>Object.create(null),{forEach:Uie,slice:qie}=Array.prototype,{hasOwnProperty:Wie}=Object.prototype;class Sm{constructor(e=!0,n=Vie){this.weakness=e,this.makeData=n}lookup(...e){return this.lookupArray(e)}lookupArray(e){let n=this;return Uie.call(e,i=>n=n.getChildTrie(i)),Wie.call(n,"data")?n.data:n.data=this.makeData(qie.call(e))}peek(...e){return this.peekArray(e)}peekArray(e){let n=this;for(let i=0,r=e.length;n&&i<r;++i){const a=this.weakness&&az(e[i])?n.weak:n.strong;n=a&&a.get(e[i])}return n&&n.data}getChildTrie(e){const n=this.weakness&&az(e)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map);let i=n.get(e);return i||n.set(e,i=new Sm(this.weakness,this.makeData)),i}}function az(t){switch(typeof t){case"object":if(t===null)break;case"function":return!0}return!1}var no=Object.prototype.hasOwnProperty;function fy(t){return t==null}function A$(t,e){var n=t.__typename,i=t.id,r=t._id;if(typeof n=="string"&&(e&&(e.keyObject=fy(i)?fy(r)?void 0:{_id:r}:{id:i}),fy(i)&&!fy(r)&&(i=r),!fy(i)))return"".concat(n,":").concat(typeof i=="number"||typeof i=="string"?i:JSON.stringify(i))}var M$={dataIdFromObject:A$,addTypename:!0,resultCaching:!0,canonizeResults:!1};function Gie(t){return sw(M$,t)}function P$(t){var e=t.canonizeResults;return e===void 0?M$.canonizeResults:e}function Hie(t,e){return Ei(e)?t.get(e.__ref,"__typename"):e&&e.__typename}var O$=/^[_a-z][_0-9a-z]*/i;function Vu(t){var e=t.match(O$);return e?e[0]:t}function SC(t,e,n){return $i(e)?Cr(e)?e.every(function(i){return SC(t,i,n)}):t.selections.every(function(i){if(Oh(i)&&nw(i,n)){var r=Ph(i);return no.call(e,r)&&(!i.selectionSet||SC(i.selectionSet,e[r],n))}return!0}):!1}function bp(t){return $i(t)&&!Ei(t)&&!Cr(t)}function Zie(){return new $u}function D$(t,e){var n=iA(sA(t));return{fragmentMap:n,lookupFragment:function(i){var r=n[i];return!r&&e&&(r=e.lookup(i)),r||null}}}var S_=Object.create(null),ak=function(){return S_},lz=Object.create(null),wv=function(){function t(e,n){var i=this;this.policies=e,this.group=n,this.data=Object.create(null),this.rootIds=Object.create(null),this.refs=Object.create(null),this.getFieldValue=function(r,a){return mC(Ei(r)?i.get(r.__ref,a):r&&r[a])},this.canRead=function(r){return Ei(r)?i.has(r.__ref):typeof r=="object"},this.toReference=function(r,a){if(typeof r=="string")return Rp(r);if(Ei(r))return r;var d=i.policies.identify(r)[0];if(d){var o=Rp(d);return a&&i.merge(d,r),o}}}return t.prototype.toObject=function(){return rt({},this.data)},t.prototype.has=function(e){return this.lookup(e,!0)!==void 0},t.prototype.get=function(e,n){if(this.group.depend(e,n),no.call(this.data,e)){var i=this.data[e];if(i&&no.call(i,n))return i[n]}if(n==="__typename"&&no.call(this.policies.rootTypenamesById,e))return this.policies.rootTypenamesById[e];if(this instanceof eu)return this.parent.get(e,n)},t.prototype.lookup=function(e,n){if(n&&this.group.depend(e,"__exists"),no.call(this.data,e))return this.data[e];if(this instanceof eu)return this.parent.lookup(e,n);if(this.policies.rootTypenamesById[e])return Object.create(null)},t.prototype.merge=function(e,n){var i=this,r;Ei(e)&&(e=e.__ref),Ei(n)&&(n=n.__ref);var a=typeof e=="string"?this.lookup(r=e):e,d=typeof n=="string"?this.lookup(r=n):n;if(d){__DEV__?Ut(typeof r=="string","store.merge expects a string ID"):Ut(typeof r=="string",1);var o=new $u(Kie).merge(a,d);if(this.data[r]=o,o!==a&&(delete this.refs[r],this.group.caching)){var f=Object.create(null);a||(f.__exists=1),Object.keys(d).forEach(function(g){if(!a||a[g]!==o[g]){f[g]=1;var _=Vu(g);_!==g&&!i.policies.hasKeyArgs(o.__typename,_)&&(f[_]=1),o[g]===void 0&&!(i instanceof eu)&&delete o[g]}}),f.__typename&&!(a&&a.__typename)&&this.policies.rootTypenamesById[r]===o.__typename&&delete f.__typename,Object.keys(f).forEach(function(g){return i.group.dirty(r,g)})}}},t.prototype.modify=function(e,n){var i=this,r=this.lookup(e);if(r){var a=Object.create(null),d=!1,o=!0,f={DELETE:S_,INVALIDATE:lz,isReference:Ei,toReference:this.toReference,canRead:this.canRead,readField:function(g,_){return i.policies.readField(typeof g=="string"?{fieldName:g,from:_||Rp(e)}:g,{store:i})}};if(Object.keys(r).forEach(function(g){var _=Vu(g),w=r[g];if(w!==void 0){var T=typeof n=="function"?n:n[g]||n[_];if(T){var A=T===ak?S_:T(mC(w),rt(rt({},f),{fieldName:_,storeFieldName:g,storage:i.getStorage(e,g)}));A===lz?i.group.dirty(e,g):(A===S_&&(A=void 0),A!==w&&(a[g]=A,d=!0,w=A))}w!==void 0&&(o=!1)}}),d)return this.merge(e,a),o&&(this instanceof eu?this.data[e]=void 0:delete this.data[e],this.group.dirty(e,"__exists")),!0}return!1},t.prototype.delete=function(e,n,i){var r,a=this.lookup(e);if(a){var d=this.getFieldValue(a,"__typename"),o=n&&i?this.policies.getStoreFieldName({typename:d,fieldName:n,args:i}):n;return this.modify(e,o?(r={},r[o]=ak,r):ak)}return!1},t.prototype.evict=function(e,n){var i=!1;return e.id&&(no.call(this.data,e.id)&&(i=this.delete(e.id,e.fieldName,e.args)),this instanceof eu&&this!==n&&(i=this.parent.evict(e,n)||i),(e.fieldName||i)&&this.group.dirty(e.id,e.fieldName||"__exists")),i},t.prototype.clear=function(){this.replace(null)},t.prototype.extract=function(){var e=this,n=this.toObject(),i=[];return this.getRootIdSet().forEach(function(r){no.call(e.policies.rootTypenamesById,r)||i.push(r)}),i.length&&(n.__META={extraRootIds:i.sort()}),n},t.prototype.replace=function(e){var n=this;if(Object.keys(this.data).forEach(function(a){e&&no.call(e,a)||n.delete(a)}),e){var i=e.__META,r=or(e,["__META"]);Object.keys(r).forEach(function(a){n.merge(a,r[a])}),i&&i.extraRootIds.forEach(this.retain,this)}},t.prototype.retain=function(e){return this.rootIds[e]=(this.rootIds[e]||0)+1},t.prototype.release=function(e){if(this.rootIds[e]>0){var n=--this.rootIds[e];return n||delete this.rootIds[e],n}return 0},t.prototype.getRootIdSet=function(e){return e===void 0&&(e=new Set),Object.keys(this.rootIds).forEach(e.add,e),this instanceof eu?this.parent.getRootIdSet(e):Object.keys(this.policies.rootTypenamesById).forEach(e.add,e),e},t.prototype.gc=function(){var e=this,n=this.getRootIdSet(),i=this.toObject();n.forEach(function(d){no.call(i,d)&&(Object.keys(e.findChildRefIds(d)).forEach(n.add,n),delete i[d])});var r=Object.keys(i);if(r.length){for(var a=this;a instanceof eu;)a=a.parent;r.forEach(function(d){return a.delete(d)})}return r},t.prototype.findChildRefIds=function(e){if(!no.call(this.refs,e)){var n=this.refs[e]=Object.create(null),i=this.data[e];if(!i)return n;var r=new Set([i]);r.forEach(function(a){Ei(a)&&(n[a.__ref]=!0),$i(a)&&Object.keys(a).forEach(function(d){var o=a[d];$i(o)&&r.add(o)})})}return this.refs[e]},t.prototype.makeCacheKey=function(){return this.group.keyMaker.lookupArray(arguments)},t}(),R$=function(){function t(e,n){n===void 0&&(n=null),this.caching=e,this.parent=n,this.d=null,this.resetCaching()}return t.prototype.resetCaching=function(){this.d=this.caching?T$():null,this.keyMaker=new Sm(jh)},t.prototype.depend=function(e,n){if(this.d){this.d(lk(e,n));var i=Vu(n);i!==n&&this.d(lk(e,i)),this.parent&&this.parent.depend(e,n)}},t.prototype.dirty=function(e,n){this.d&&this.d.dirty(lk(e,n),n==="__exists"?"forget":"setDirty")},t}();function lk(t,e){return e+"#"+t}function cz(t,e){Uy(t)&&t.group.depend(e,"__exists")}(function(t){var e=function(n){ma(i,n);function i(r){var a=r.policies,d=r.resultCaching,o=d===void 0?!0:d,f=r.seed,g=n.call(this,a,new R$(o))||this;return g.stump=new Xie(g),g.storageTrie=new Sm(jh),f&&g.replace(f),g}return i.prototype.addLayer=function(r,a){return this.stump.addLayer(r,a)},i.prototype.removeLayer=function(){return this},i.prototype.getStorage=function(){return this.storageTrie.lookupArray(arguments)},i}(t);t.Root=e})(wv||(wv={}));var eu=function(t){ma(e,t);function e(n,i,r,a){var d=t.call(this,i.policies,a)||this;return d.id=n,d.parent=i,d.replay=r,d.group=a,r(d),d}return e.prototype.addLayer=function(n,i){return new e(n,this,i,this.group)},e.prototype.removeLayer=function(n){var i=this,r=this.parent.removeLayer(n);return n===this.id?(this.group.caching&&Object.keys(this.data).forEach(function(a){var d=i.data[a],o=r.lookup(a);o?d?d!==o&&Object.keys(d).forEach(function(f){kr(d[f],o[f])||i.group.dirty(a,f)}):(i.group.dirty(a,"__exists"),Object.keys(o).forEach(function(f){i.group.dirty(a,f)})):i.delete(a)}),r):r===this.parent?this:r.addLayer(this.id,this.replay)},e.prototype.toObject=function(){return rt(rt({},this.parent.toObject()),this.data)},e.prototype.findChildRefIds=function(n){var i=this.parent.findChildRefIds(n);return no.call(this.data,n)?rt(rt({},i),t.prototype.findChildRefIds.call(this,n)):i},e.prototype.getStorage=function(){for(var n=this.parent;n.parent;)n=n.parent;return n.getStorage.apply(n,arguments)},e}(wv),Xie=function(t){ma(e,t);function e(n){return t.call(this,"EntityStore.Stump",n,function(){},new R$(n.group.caching,n.group))||this}return e.prototype.removeLayer=function(){return this},e.prototype.merge=function(){return this.parent.merge.apply(this.parent,arguments)},e}(eu);function Kie(t,e,n){var i=t[n],r=e[n];return kr(i,r)?i:r}function Uy(t){return!!(t instanceof wv&&t.group.caching)}function Yie(t){return $i(t)?Cr(t)?t.slice(0):rt({__proto__:Object.getPrototypeOf(t)},t):t}var EC=function(){function t(){this.known=new(Pne?WeakSet:Set),this.pool=new Sm(jh),this.passes=new WeakMap,this.keysByJSON=new Map,this.empty=this.admit({})}return t.prototype.isKnown=function(e){return $i(e)&&this.known.has(e)},t.prototype.pass=function(e){if($i(e)){var n=Yie(e);return this.passes.set(n,e),n}return e},t.prototype.admit=function(e){var n=this;if($i(e)){var i=this.passes.get(e);if(i)return i;var r=Object.getPrototypeOf(e);switch(r){case Array.prototype:{if(this.known.has(e))return e;var a=e.map(this.admit,this),d=this.pool.lookupArray(a);return d.array||(this.known.add(d.array=a),__DEV__&&Object.freeze(a)),d.array}case null:case Object.prototype:{if(this.known.has(e))return e;var o=Object.getPrototypeOf(e),f=[o],g=this.sortedKeys(e);f.push(g.json);var _=f.length;g.sorted.forEach(function(A){f.push(n.admit(e[A]))});var d=this.pool.lookupArray(f);if(!d.object){var w=d.object=Object.create(o);this.known.add(w),g.sorted.forEach(function(A,D){w[A]=f[_+D]}),__DEV__&&Object.freeze(w)}return d.object}}}return e},t.prototype.sortedKeys=function(e){var n=Object.keys(e),i=this.pool.lookupArray(n);if(!i.keys){n.sort();var r=JSON.stringify(n);(i.keys=this.keysByJSON.get(r))||this.keysByJSON.set(r,i.keys={sorted:n,json:r})}return i.keys},t}(),uh=Object.assign(function(t){if($i(t)){kC===void 0&&uz();var e=kC.admit(t),n=TC.get(e);return n===void 0&&TC.set(e,n=JSON.stringify(e)),n}return JSON.stringify(t)},{reset:uz}),kC,TC;function uz(){kC=new EC,TC=new(jh?WeakMap:Map)}function dz(t){return[t.selectionSet,t.objectOrReference,t.context,t.context.canonizeResults]}var Jie=function(){function t(e){var n=this;this.knownResults=new(jh?WeakMap:Map),this.config=sw(e,{addTypename:e.addTypename!==!1,canonizeResults:P$(e)}),this.canon=e.canon||new EC,this.executeSelectionSet=Lx(function(i){var r,a=i.context.canonizeResults,d=dz(i);d[3]=!a;var o=(r=n.executeSelectionSet).peek.apply(r,d);return o?a?rt(rt({},o),{result:n.canon.admit(o.result)}):o:(cz(i.context.store,i.enclosingRef.__ref),n.execSelectionSetImpl(i))},{max:this.config.resultCacheMaxSize,keyArgs:dz,makeCacheKey:function(i,r,a,d){if(Uy(a.store))return a.store.makeCacheKey(i,Ei(r)?r.__ref:r,a.varString,d)}}),this.executeSubSelectedArray=Lx(function(i){return cz(i.context.store,i.enclosingRef.__ref),n.execSubSelectedArrayImpl(i)},{max:this.config.resultCacheMaxSize,makeCacheKey:function(i){var r=i.field,a=i.array,d=i.context;if(Uy(d.store))return d.store.makeCacheKey(r,a,d.varString)}})}return t.prototype.resetCanon=function(){this.canon=new EC},t.prototype.diffQueryAgainstStore=function(e){var n=e.store,i=e.query,r=e.rootId,a=r===void 0?"ROOT_QUERY":r,d=e.variables,o=e.returnPartialData,f=o===void 0?!0:o,g=e.canonizeResults,_=g===void 0?this.config.canonizeResults:g,w=this.config.cache.policies;d=rt(rt({},aA(o$(i))),d);var T=Rp(a),A=this.executeSelectionSet({selectionSet:Gv(i).selectionSet,objectOrReference:T,enclosingRef:T,context:rt({store:n,query:i,policies:w,variables:d,varString:uh(d),canonizeResults:_},D$(i,this.config.fragments))}),D;if(A.missing&&(D=[new I$(Qie(A.missing),A.missing,i,d)],!f))throw D[0];return{result:A.result,complete:!D,missing:D}},t.prototype.isFresh=function(e,n,i,r){if(Uy(r.store)&&this.knownResults.get(e)===i){var a=this.executeSelectionSet.peek(i,n,r,this.canon.isKnown(e));if(a&&e===a.result)return!0}return!1},t.prototype.execSelectionSetImpl=function(e){var n=this,i=e.selectionSet,r=e.objectOrReference,a=e.enclosingRef,d=e.context;if(Ei(r)&&!d.policies.rootTypenamesById[r.__ref]&&!d.store.has(r.__ref))return{result:this.canon.empty,missing:"Dangling reference to missing ".concat(r.__ref," object")};var o=d.variables,f=d.policies,g=d.store,_=g.getFieldValue(r,"__typename"),w=[],T,A=new $u;this.config.addTypename&&typeof _=="string"&&!f.rootIdsByTypename[_]&&w.push({__typename:_});function D(q,K){var se;return q.missing&&(T=A.merge(T,(se={},se[K]=q.missing,se))),q.result}var z=new Set(i.selections);z.forEach(function(q){var K,se;if(nw(q,o))if(Oh(q)){var ie=f.readField({fieldName:q.name.value,field:q,variables:d.variables,from:r},d),Q=Ph(q);ie===void 0?lA.added(q)||(T=A.merge(T,(K={},K[Q]="Can't find field '".concat(q.name.value,"' on ").concat(Ei(r)?r.__ref+" object":"object "+JSON.stringify(r,null,2)),K))):Cr(ie)?ie=D(n.executeSubSelectedArray({field:q,array:ie,enclosingRef:a,context:d}),Q):q.selectionSet?ie!=null&&(ie=D(n.executeSelectionSet({selectionSet:q.selectionSet,objectOrReference:ie,enclosingRef:Ei(ie)?ie:a,context:d}),Q)):d.canonizeResults&&(ie=n.canon.pass(ie)),ie!==void 0&&w.push((se={},se[Q]=ie,se))}else{var J=rA(q,d.lookupFragment);if(!J&&q.kind===cn.FRAGMENT_SPREAD)throw __DEV__?new vi("No fragment named ".concat(q.name.value)):new vi(5);J&&f.fragmentMatches(J,_)&&J.selectionSet.selections.forEach(z.add,z)}});var G=cA(w),V={result:G,missing:T},N=d.canonizeResults?this.canon.admit(V):mC(V);return N.result&&this.knownResults.set(N.result,i),N},t.prototype.execSubSelectedArrayImpl=function(e){var n=this,i=e.field,r=e.array,a=e.enclosingRef,d=e.context,o,f=new $u;function g(_,w){var T;return _.missing&&(o=f.merge(o,(T={},T[w]=_.missing,T))),_.result}return i.selectionSet&&(r=r.filter(d.store.canRead)),r=r.map(function(_,w){return _===null?null:Cr(_)?g(n.executeSubSelectedArray({field:i,array:_,enclosingRef:a,context:d}),w):i.selectionSet?g(n.executeSelectionSet({selectionSet:i.selectionSet,objectOrReference:_,enclosingRef:Ei(_)?_:a,context:d}),w):(__DEV__&&ere(d.store,i,_),_)}),{result:d.canonizeResults?this.canon.admit(r):r,missing:o}},t}();function Qie(t){try{JSON.stringify(t,function(e,n){if(typeof n=="string")throw n;return n})}catch(e){return e}}function ere(t,e,n){if(!e.selectionSet){var i=new Set([n]);i.forEach(function(r){$i(r)&&(__DEV__?Ut(!Ei(r),"Missing selection set for object of type ".concat(Hie(t,r)," returned for query field ").concat(e.name.value)):Ut(!Ei(r),6),Object.values(r).forEach(i.add,i))})}}var bA=new y$,hz=new WeakMap;function qy(t){var e=hz.get(t);return e||hz.set(t,e={vars:new Set,dep:T$()}),e}function fz(t){qy(t).vars.forEach(function(e){return e.forgetCache(t)})}function tre(t){qy(t).vars.forEach(function(e){return e.attachCache(t)})}function nre(t){var e=new Set,n=new Set,i=function(a){if(arguments.length>0){if(t!==a){t=a,e.forEach(function(f){qy(f).dep.dirty(i),ire(f)});var d=Array.from(n);n.clear(),d.forEach(function(f){return f(t)})}}else{var o=bA.getValue();o&&(r(o),qy(o).dep(i))}return t};i.onNextChange=function(a){return n.add(a),function(){n.delete(a)}};var r=i.attachCache=function(a){return e.add(a),qy(a).vars.add(i),i};return i.forgetCache=function(a){return e.delete(a)},i}function ire(t){t.broadcastWatches&&t.broadcastWatches()}var pz=Object.create(null);function _A(t){var e=JSON.stringify(t);return pz[e]||(pz[e]=Object.create(null))}function mz(t){var e=_A(t);return e.keyFieldsFn||(e.keyFieldsFn=function(n,i){var r=function(d,o){return i.readField(o,d)},a=i.keyObject=xA(t,function(d){var o=zp(i.storeObject,d,r);return o===void 0&&n!==i.storeObject&&no.call(n,d[0])&&(o=zp(n,d,z$)),__DEV__?Ut(o!==void 0,"Missing field '".concat(d.join("."),"' while extracting keyFields from ").concat(JSON.stringify(n))):Ut(o!==void 0,2),o});return"".concat(i.typename,":").concat(JSON.stringify(a))})}function gz(t){var e=_A(t);return e.keyArgsFn||(e.keyArgsFn=function(n,i){var r=i.field,a=i.variables,d=i.fieldName,o=xA(t,function(g){var _=g[0],w=_.charAt(0);if(w==="@"){if(r&&Pl(r.directives)){var T=_.slice(1),A=r.directives.find(function(V){return V.name.value===T}),D=A&&iw(A,a);return D&&zp(D,g.slice(1))}return}if(w==="$"){var z=_.slice(1);if(a&&no.call(a,z)){var G=g.slice(0);return G[0]=z,zp(a,G)}return}if(n)return zp(n,g)}),f=JSON.stringify(o);return(n||f!=="{}")&&(d+=":"+f),d})}function xA(t,e){var n=new $u;return L$(t).reduce(function(i,r){var a,d=e(r);if(d!==void 0){for(var o=r.length-1;o>=0;--o)d=(a={},a[r[o]]=d,a);i=n.merge(i,d)}return i},Object.create(null))}function L$(t){var e=_A(t);if(!e.paths){var n=e.paths=[],i=[];t.forEach(function(r,a){Cr(r)?(L$(r).forEach(function(d){return n.push(i.concat(d))}),i.length=0):(i.push(r),Cr(t[a+1])||(n.push(i.slice(0)),i.length=0))})}return e.paths}function z$(t,e){return t[e]}function zp(t,e,n){return n=n||z$,B$(e.reduce(function i(r,a){return Cr(r)?r.map(function(d){return i(d,a)}):r&&n(r,a)},t))}function B$(t){return $i(t)?Cr(t)?t.map(B$):xA(Object.keys(t).sort(),function(e){return zp(t,e)}):t}oA.setStringify(uh);function CC(t){return t.args!==void 0?t.args:t.field?iw(t.field,t.variables):null}var rre=function(){},yz=function(t,e){return e.fieldName},vz=function(t,e,n){var i=n.mergeObjects;return i(t,e)},bz=function(t,e){return e},ore=function(){function t(e){this.config=e,this.typePolicies=Object.create(null),this.toBeAdded=Object.create(null),this.supertypeMap=new Map,this.fuzzySubtypes=new Map,this.rootIdsByTypename=Object.create(null),this.rootTypenamesById=Object.create(null),this.usingPossibleTypes=!1,this.config=rt({dataIdFromObject:A$},e),this.cache=this.config.cache,this.setRootTypename("Query"),this.setRootTypename("Mutation"),this.setRootTypename("Subscription"),e.possibleTypes&&this.addPossibleTypes(e.possibleTypes),e.typePolicies&&this.addTypePolicies(e.typePolicies)}return t.prototype.identify=function(e,n){var i,r=this,a=n&&(n.typename||((i=n.storeObject)===null||i===void 0?void 0:i.__typename))||e.__typename;if(a===this.rootTypenamesById.ROOT_QUERY)return["ROOT_QUERY"];for(var d=n&&n.storeObject||e,o=rt(rt({},n),{typename:a,storeObject:d,readField:n&&n.readField||function(){var T=wA(arguments,d);return r.readField(T,{store:r.cache.data,variables:T.variables})}}),f,g=a&&this.getTypePolicy(a),_=g&&g.keyFn||this.config.dataIdFromObject;_;){var w=_(rt(rt({},e),d),o);if(Cr(w))_=mz(w);else{f=w;break}}return f=f?String(f):void 0,o.keyObject?[f,o.keyObject]:[f]},t.prototype.addTypePolicies=function(e){var n=this;Object.keys(e).forEach(function(i){var r=e[i],a=r.queryType,d=r.mutationType,o=r.subscriptionType,f=or(r,["queryType","mutationType","subscriptionType"]);a&&n.setRootTypename("Query",i),d&&n.setRootTypename("Mutation",i),o&&n.setRootTypename("Subscription",i),no.call(n.toBeAdded,i)?n.toBeAdded[i].push(f):n.toBeAdded[i]=[f]})},t.prototype.updateTypePolicy=function(e,n){var i=this,r=this.getTypePolicy(e),a=n.keyFields,d=n.fields;function o(f,g){f.merge=typeof g=="function"?g:g===!0?vz:g===!1?bz:f.merge}o(r,n.merge),r.keyFn=a===!1?rre:Cr(a)?mz(a):typeof a=="function"?a:r.keyFn,d&&Object.keys(d).forEach(function(f){var g=i.getFieldPolicy(e,f,!0),_=d[f];if(typeof _=="function")g.read=_;else{var w=_.keyArgs,T=_.read,A=_.merge;g.keyFn=w===!1?yz:Cr(w)?gz(w):typeof w=="function"?w:g.keyFn,typeof T=="function"&&(g.read=T),o(g,A)}g.read&&g.merge&&(g.keyFn=g.keyFn||yz)})},t.prototype.setRootTypename=function(e,n){n===void 0&&(n=e);var i="ROOT_"+e.toUpperCase(),r=this.rootTypenamesById[i];n!==r&&(__DEV__?Ut(!r||r===e,"Cannot change root ".concat(e," __typename more than once")):Ut(!r||r===e,3),r&&delete this.rootIdsByTypename[r],this.rootIdsByTypename[n]=i,this.rootTypenamesById[i]=n)},t.prototype.addPossibleTypes=function(e){var n=this;this.usingPossibleTypes=!0,Object.keys(e).forEach(function(i){n.getSupertypeSet(i,!0),e[i].forEach(function(r){n.getSupertypeSet(r,!0).add(i);var a=r.match(O$);(!a||a[0]!==r)&&n.fuzzySubtypes.set(r,new RegExp(r))})})},t.prototype.getTypePolicy=function(e){var n=this;if(!no.call(this.typePolicies,e)){var i=this.typePolicies[e]=Object.create(null);i.fields=Object.create(null);var r=this.supertypeMap.get(e);r&&r.size&&r.forEach(function(d){var o=n.getTypePolicy(d),f=o.fields,g=or(o,["fields"]);Object.assign(i,g),Object.assign(i.fields,f)})}var a=this.toBeAdded[e];return a&&a.length&&a.splice(0).forEach(function(d){n.updateTypePolicy(e,d)}),this.typePolicies[e]},t.prototype.getFieldPolicy=function(e,n,i){if(e){var r=this.getTypePolicy(e).fields;return r[n]||i&&(r[n]=Object.create(null))}},t.prototype.getSupertypeSet=function(e,n){var i=this.supertypeMap.get(e);return!i&&n&&this.supertypeMap.set(e,i=new Set),i},t.prototype.fragmentMatches=function(e,n,i,r){var a=this;if(!e.typeCondition)return!0;if(!n)return!1;var d=e.typeCondition.name.value;if(n===d)return!0;if(this.usingPossibleTypes&&this.supertypeMap.has(d))for(var o=this.getSupertypeSet(n,!0),f=[o],g=function(D){var z=a.getSupertypeSet(D,!1);z&&z.size&&f.indexOf(z)<0&&f.push(z)},_=!!(i&&this.fuzzySubtypes.size),w=!1,T=0;T<f.length;++T){var A=f[T];if(A.has(d))return o.has(d)||(w&&__DEV__&&Ut.warn("Inferring subtype ".concat(n," of supertype ").concat(d)),o.add(d)),!0;A.forEach(g),_&&T===f.length-1&&SC(e.selectionSet,i,r)&&(_=!1,w=!0,this.fuzzySubtypes.forEach(function(D,z){var G=n.match(D);G&&G[0]===n&&g(z)}))}return!1},t.prototype.hasKeyArgs=function(e,n){var i=this.getFieldPolicy(e,n,!1);return!!(i&&i.keyFn)},t.prototype.getStoreFieldName=function(e){var n=e.typename,i=e.fieldName,r=this.getFieldPolicy(n,i,!1),a,d=r&&r.keyFn;if(d&&n)for(var o={typename:n,fieldName:i,field:e.field||null,variables:e.variables},f=CC(e);d;){var g=d(f,o);if(Cr(g))d=gz(g);else{a=g||i;break}}return a===void 0&&(a=e.field?ane(e.field,e.variables):oA(i,CC(e))),a===!1?i:i===Vu(a)?a:i+":"+a},t.prototype.readField=function(e,n){var i=e.from;if(i){var r=e.field||e.fieldName;if(r){if(e.typename===void 0){var a=n.store.getFieldValue(i,"__typename");a&&(e.typename=a)}var d=this.getStoreFieldName(e),o=Vu(d),f=n.store.getFieldValue(i,d),g=this.getFieldPolicy(e.typename,o,!1),_=g&&g.read;if(_){var w=_z(this,i,e,n,n.store.getStorage(Ei(i)?i.__ref:i,d));return bA.withValue(this.cache,_,[f,w])}return f}}},t.prototype.getReadFunction=function(e,n){var i=this.getFieldPolicy(e,n,!1);return i&&i.read},t.prototype.getMergeFunction=function(e,n,i){var r=this.getFieldPolicy(e,n,!1),a=r&&r.merge;return!a&&i&&(r=this.getTypePolicy(i),a=r&&r.merge),a},t.prototype.runMergeFunction=function(e,n,i,r,a){var d=i.field,o=i.typename,f=i.merge;return f===vz?F$(r.store)(e,n):f===bz?n:(r.overwrite&&(e=void 0),f(e,n,_z(this,void 0,{typename:o,fieldName:d.name.value,field:d,variables:r.variables},r,a||Object.create(null))))},t}();function _z(t,e,n,i,r){var a=t.getStoreFieldName(n),d=Vu(a),o=n.variables||i.variables,f=i.store,g=f.toReference,_=f.canRead;return{args:CC(n),field:n.field||null,fieldName:d,storeFieldName:a,variables:o,isReference:Ei,toReference:g,storage:r,cache:t.cache,canRead:_,readField:function(){return t.readField(wA(arguments,e,o),i)},mergeObjects:F$(i.store)}}function wA(t,e,n){var i=t[0],r=t[1],a=t.length,d;return typeof i=="string"?d={fieldName:i,from:a>1?r:e}:(d=rt({},i),no.call(d,"from")||(d.from=e)),__DEV__&&d.from===void 0&&__DEV__&&Ut.warn("Undefined 'from' passed to readField with arguments ".concat(Lne(Array.from(t)))),d.variables===void 0&&(d.variables=n),d}function F$(t){return function(n,i){if(Cr(n)||Cr(i))throw __DEV__?new vi("Cannot automatically merge arrays"):new vi(4);if($i(n)&&$i(i)){var r=t.getFieldValue(n,"__typename"),a=t.getFieldValue(i,"__typename"),d=r&&a&&r!==a;if(d)return i;if(Ei(n)&&bp(i))return t.merge(n.__ref,i),n;if(bp(n)&&Ei(i))return t.merge(n,i.__ref),i;if(bp(n)&&bp(i))return rt(rt({},n),i)}return i}}function ck(t,e,n){var i="".concat(e).concat(n),r=t.flavors.get(i);return r||t.flavors.set(i,r=t.clientOnly===e&&t.deferred===n?t:rt(rt({},t),{clientOnly:e,deferred:n})),r}var sre=function(){function t(e,n,i){this.cache=e,this.reader=n,this.fragments=i}return t.prototype.writeToStore=function(e,n){var i=this,r=n.query,a=n.result,d=n.dataId,o=n.variables,f=n.overwrite,g=Wv(r),_=Zie();o=rt(rt({},aA(g)),o);var w=rt(rt({store:e,written:Object.create(null),merge:function(A,D){return _.merge(A,D)},variables:o,varString:uh(o)},D$(r,this.fragments)),{overwrite:!!f,incomingById:new Map,clientOnly:!1,deferred:!1,flavors:new Map}),T=this.processSelectionSet({result:a||Object.create(null),dataId:d,selectionSet:g.selectionSet,mergeTree:{map:new Map},context:w});if(!Ei(T))throw __DEV__?new vi("Could not identify object ".concat(JSON.stringify(a))):new vi(7);return w.incomingById.forEach(function(A,D){var z=A.storeObject,G=A.mergeTree,V=A.fieldNodeSet,N=Rp(D);if(G&&G.map.size){var q=i.applyMerges(G,N,z,w);if(Ei(q))return;z=q}if(__DEV__&&!w.overwrite){var K=Object.create(null);V.forEach(function(Q){Q.selectionSet&&(K[Q.name.value]=!0)});var se=function(Q){return K[Vu(Q)]===!0},ie=function(Q){var J=G&&G.map.get(Q);return!!(J&&J.info&&J.info.merge)};Object.keys(z).forEach(function(Q){se(Q)&&!ie(Q)&&are(N,z,Q,w.store)})}e.merge(D,z)}),e.retain(T.__ref),T},t.prototype.processSelectionSet=function(e){var n=this,i=e.dataId,r=e.result,a=e.selectionSet,d=e.context,o=e.mergeTree,f=this.cache.policies,g=Object.create(null),_=i&&f.rootTypenamesById[i]||uC(r,a,d.fragmentMap)||i&&d.store.get(i,"__typename");typeof _=="string"&&(g.__typename=_);var w=function(){var q=wA(arguments,g,d.variables);if(Ei(q.from)){var K=d.incomingById.get(q.from.__ref);if(K){var se=f.readField(rt(rt({},q),{from:K.storeObject}),d);if(se!==void 0)return se}}return f.readField(q,d)},T=new Set;this.flattenFields(a,r,d,_).forEach(function(q,K){var se,ie=Ph(K),Q=r[ie];if(T.add(K),Q!==void 0){var J=f.getStoreFieldName({typename:_,fieldName:K.name.value,field:K,variables:q.variables}),te=xz(o,J),me=n.processFieldValue(Q,K,K.selectionSet?ck(q,!1,!1):q,te),Fe=void 0;K.selectionSet&&(Ei(me)||bp(me))&&(Fe=w("__typename",me));var tt=f.getMergeFunction(_,K.name.value,Fe);tt?te.info={field:K,typename:_,merge:tt}:wz(o,J),g=q.merge(g,(se={},se[J]=me,se))}else __DEV__&&!q.clientOnly&&!q.deferred&&!lA.added(K)&&!f.getReadFunction(_,K.name.value)&&__DEV__&&Ut.error("Missing field '".concat(Ph(K),"' while writing result ").concat(JSON.stringify(r,null,2)).substring(0,1e3))});try{var A=f.identify(r,{typename:_,selectionSet:a,fragmentMap:d.fragmentMap,storeObject:g,readField:w}),D=A[0],z=A[1];i=i||D,z&&(g=d.merge(g,z))}catch(q){if(!i)throw q}if(typeof i=="string"){var G=Rp(i),V=d.written[i]||(d.written[i]=[]);if(V.indexOf(a)>=0||(V.push(a),this.reader&&this.reader.isFresh(r,G,a,d)))return G;var N=d.incomingById.get(i);return N?(N.storeObject=d.merge(N.storeObject,g),N.mergeTree=IC(N.mergeTree,o),T.forEach(function(q){return N.fieldNodeSet.add(q)})):d.incomingById.set(i,{storeObject:g,mergeTree:zx(o)?void 0:o,fieldNodeSet:T}),G}return g},t.prototype.processFieldValue=function(e,n,i,r){var a=this;return!n.selectionSet||e===null?__DEV__?d$(e):e:Cr(e)?e.map(function(d,o){var f=a.processFieldValue(d,n,i,xz(r,o));return wz(r,o),f}):this.processSelectionSet({result:e,selectionSet:n.selectionSet,context:i,mergeTree:r})},t.prototype.flattenFields=function(e,n,i,r){r===void 0&&(r=uC(n,e,i.fragmentMap));var a=new Map,d=this.cache.policies,o=new Sm(!1);return function f(g,_){var w=o.lookup(g,_.clientOnly,_.deferred);w.visited||(w.visited=!0,g.selections.forEach(function(T){if(nw(T,i.variables)){var A=_.clientOnly,D=_.deferred;if(!(A&&D)&&Pl(T.directives)&&T.directives.forEach(function(V){var N=V.name.value;if(N==="client"&&(A=!0),N==="defer"){var q=iw(V,i.variables);(!q||q.if!==!1)&&(D=!0)}}),Oh(T)){var z=a.get(T);z&&(A=A&&z.clientOnly,D=D&&z.deferred),a.set(T,ck(i,A,D))}else{var G=rA(T,i.lookupFragment);if(!G&&T.kind===cn.FRAGMENT_SPREAD)throw __DEV__?new vi("No fragment named ".concat(T.name.value)):new vi(8);G&&d.fragmentMatches(G,r,n,i.variables)&&f(G.selectionSet,ck(i,A,D))}}}))}(e,i),a},t.prototype.applyMerges=function(e,n,i,r,a){var d,o=this;if(e.map.size&&!Ei(i)){var f=!Cr(i)&&(Ei(n)||bp(n))?n:void 0,g=i;f&&!a&&(a=[Ei(f)?f.__ref:f]);var _,w=function(T,A){return Cr(T)?typeof A=="number"?T[A]:void 0:r.store.getFieldValue(T,String(A))};e.map.forEach(function(T,A){var D=w(f,A),z=w(g,A);if(z!==void 0){a&&a.push(A);var G=o.applyMerges(T,D,z,r,a);G!==z&&(_=_||new Map,_.set(A,G)),a&&Ut(a.pop()===A)}}),_&&(i=Cr(g)?g.slice(0):rt({},g),_.forEach(function(T,A){i[A]=T}))}return e.info?this.cache.policies.runMergeFunction(n,i,e.info,r,a&&(d=r.store).getStorage.apply(d,a)):i},t}(),N$=[];function xz(t,e){var n=t.map;return n.has(e)||n.set(e,N$.pop()||{map:new Map}),n.get(e)}function IC(t,e){if(t===e||!e||zx(e))return t;if(!t||zx(t))return e;var n=t.info&&e.info?rt(rt({},t.info),e.info):t.info||e.info,i=t.map.size&&e.map.size,r=i?new Map:t.map.size?t.map:e.map,a={info:n,map:r};if(i){var d=new Set(e.map.keys());t.map.forEach(function(o,f){a.map.set(f,IC(o,e.map.get(f))),d.delete(f)}),d.forEach(function(o){a.map.set(o,IC(e.map.get(o),t.map.get(o)))})}return a}function zx(t){return!t||!(t.info||t.map.size)}function wz(t,e){var n=t.map,i=n.get(e);i&&zx(i)&&(N$.push(i),n.delete(e))}var Sz=new Set;function are(t,e,n,i){var r=function(w){var T=i.getFieldValue(w,n);return typeof T=="object"&&T},a=r(t);if(a){var d=r(e);if(d&&!Ei(a)&&!kr(a,d)&&!Object.keys(a).every(function(w){return i.getFieldValue(d,w)!==void 0})){var o=i.getFieldValue(t,"__typename")||i.getFieldValue(e,"__typename"),f=Vu(n),g="".concat(o,".").concat(f);if(!Sz.has(g)){Sz.add(g);var _=[];!Cr(a)&&!Cr(d)&&[a,d].forEach(function(w){var T=i.getFieldValue(w,"__typename");typeof T=="string"&&!_.includes(T)&&_.push(T)}),__DEV__&&Ut.warn("Cache data may be lost when replacing the ".concat(f," field of a ").concat(o,` object.

This could cause additional (usually avoidable) network requests to fetch data that were otherwise cached.

To address this problem (which is not a bug in Apollo Client), `).concat(_.length?"either ensure all objects of type "+_.join(" and ")+" have an ID or a custom merge function, or ":"","define a custom merge function for the ").concat(g,` field, so InMemoryCache can safely merge these objects:

  existing: `).concat(JSON.stringify(a).slice(0,1e3),`
  incoming: `).concat(JSON.stringify(d).slice(0,1e3),`

For more information about these options, please refer to the documentation:

  * Ensuring entity objects have IDs: https://go.apollo.dev/c/generating-unique-identifiers
  * Defining custom merge functions: https://go.apollo.dev/c/merging-non-normalized-objects
`))}}}}var lre=function(t){ma(e,t);function e(n){n===void 0&&(n={});var i=t.call(this)||this;return i.watches=new Set,i.typenameDocumentCache=new Map,i.makeVar=nre,i.txCount=0,i.config=Gie(n),i.addTypename=!!i.config.addTypename,i.policies=new ore({cache:i,dataIdFromObject:i.config.dataIdFromObject,possibleTypes:i.config.possibleTypes,typePolicies:i.config.typePolicies}),i.init(),i}return e.prototype.init=function(){var n=this.data=new wv.Root({policies:this.policies,resultCaching:this.config.resultCaching});this.optimisticData=n.stump,this.resetResultCache()},e.prototype.resetResultCache=function(n){var i=this,r=this.storeReader,a=this.config.fragments;this.storeWriter=new sre(this,this.storeReader=new Jie({cache:this,addTypename:this.addTypename,resultCacheMaxSize:this.config.resultCacheMaxSize,canonizeResults:P$(this.config),canon:n?void 0:r&&r.canon,fragments:a}),a),this.maybeBroadcastWatch=Lx(function(d,o){return i.broadcastWatch(d,o)},{max:this.config.resultCacheMaxSize,makeCacheKey:function(d){var o=d.optimistic?i.optimisticData:i.data;if(Uy(o)){var f=d.optimistic,g=d.id,_=d.variables;return o.makeCacheKey(d.query,d.callback,uh({optimistic:f,id:g,variables:_}))}}}),new Set([this.data.group,this.optimisticData.group]).forEach(function(d){return d.resetCaching()})},e.prototype.restore=function(n){return this.init(),n&&this.data.replace(n),this},e.prototype.extract=function(n){return n===void 0&&(n=!1),(n?this.optimisticData:this.data).extract()},e.prototype.read=function(n){var i=n.returnPartialData,r=i===void 0?!1:i;try{return this.storeReader.diffQueryAgainstStore(rt(rt({},n),{store:n.optimistic?this.optimisticData:this.data,config:this.config,returnPartialData:r})).result||null}catch(a){if(a instanceof I$)return null;throw a}},e.prototype.write=function(n){try{return++this.txCount,this.storeWriter.writeToStore(this.data,n)}finally{!--this.txCount&&n.broadcast!==!1&&this.broadcastWatches()}},e.prototype.modify=function(n){if(no.call(n,"id")&&!n.id)return!1;var i=n.optimistic?this.optimisticData:this.data;try{return++this.txCount,i.modify(n.id||"ROOT_QUERY",n.fields)}finally{!--this.txCount&&n.broadcast!==!1&&this.broadcastWatches()}},e.prototype.diff=function(n){return this.storeReader.diffQueryAgainstStore(rt(rt({},n),{store:n.optimistic?this.optimisticData:this.data,rootId:n.id||"ROOT_QUERY",config:this.config}))},e.prototype.watch=function(n){var i=this;return this.watches.size||tre(this),this.watches.add(n),n.immediate&&this.maybeBroadcastWatch(n),function(){i.watches.delete(n)&&!i.watches.size&&fz(i),i.maybeBroadcastWatch.forget(n)}},e.prototype.gc=function(n){uh.reset();var i=this.optimisticData.gc();return n&&!this.txCount&&(n.resetResultCache?this.resetResultCache(n.resetResultIdentities):n.resetResultIdentities&&this.storeReader.resetCanon()),i},e.prototype.retain=function(n,i){return(i?this.optimisticData:this.data).retain(n)},e.prototype.release=function(n,i){return(i?this.optimisticData:this.data).release(n)},e.prototype.identify=function(n){if(Ei(n))return n.__ref;try{return this.policies.identify(n)[0]}catch(i){__DEV__&&Ut.warn(i)}},e.prototype.evict=function(n){if(!n.id){if(no.call(n,"id"))return!1;n=rt(rt({},n),{id:"ROOT_QUERY"})}try{return++this.txCount,this.optimisticData.evict(n,this.data)}finally{!--this.txCount&&n.broadcast!==!1&&this.broadcastWatches()}},e.prototype.reset=function(n){var i=this;return this.init(),uh.reset(),n&&n.discardWatches?(this.watches.forEach(function(r){return i.maybeBroadcastWatch.forget(r)}),this.watches.clear(),fz(this)):this.broadcastWatches(),Promise.resolve()},e.prototype.removeOptimistic=function(n){var i=this.optimisticData.removeLayer(n);i!==this.optimisticData&&(this.optimisticData=i,this.broadcastWatches())},e.prototype.batch=function(n){var i=this,r=n.update,a=n.optimistic,d=a===void 0?!0:a,o=n.removeOptimistic,f=n.onWatchUpdated,g,_=function(T){var A=i,D=A.data,z=A.optimisticData;++i.txCount,T&&(i.data=i.optimisticData=T);try{return g=r(i)}finally{--i.txCount,i.data=D,i.optimisticData=z}},w=new Set;return f&&!this.txCount&&this.broadcastWatches(rt(rt({},n),{onWatchUpdated:function(T){return w.add(T),!1}})),typeof d=="string"?this.optimisticData=this.optimisticData.addLayer(d,_):d===!1?_(this.data):_(),typeof o=="string"&&(this.optimisticData=this.optimisticData.removeLayer(o)),f&&w.size?(this.broadcastWatches(rt(rt({},n),{onWatchUpdated:function(T,A){var D=f.call(this,T,A);return D!==!1&&w.delete(T),D}})),w.size&&w.forEach(function(T){return i.maybeBroadcastWatch.dirty(T)})):this.broadcastWatches(n),g},e.prototype.performTransaction=function(n,i){return this.batch({update:n,optimistic:i||i!==null})},e.prototype.transformDocument=function(n){if(this.addTypename){var i=this.typenameDocumentCache.get(n);return i||(i=lA(n),this.typenameDocumentCache.set(n,i),this.typenameDocumentCache.set(i,i)),i}return n},e.prototype.transformForLink=function(n){var i=this.config.fragments;return i?i.transform(n):n},e.prototype.broadcastWatches=function(n){var i=this;this.txCount||this.watches.forEach(function(r){return i.maybeBroadcastWatch(r,n)})},e.prototype.broadcastWatch=function(n,i){var r=n.lastDiff,a=this.diff(n);i&&(n.optimistic&&typeof i.optimistic=="string"&&(a.fromOptimisticTransaction=!0),i.onWatchUpdated&&i.onWatchUpdated.call(this,n,a,r)===!1)||(!r||!kr(r.result,a.result))&&n.callback(n.lastDiff=a,r)},e}(jie),Pi;(function(t){t[t.loading=1]="loading",t[t.setVariables=2]="setVariables",t[t.fetchMore=3]="fetchMore",t[t.refetch=4]="refetch",t[t.poll=6]="poll",t[t.ready=7]="ready",t[t.error=8]="error"})(Pi||(Pi={}));function Sv(t){return t?t<7:!1}var cre=Object.assign,ure=Object.hasOwnProperty,AC=function(t){ma(e,t);function e(n){var i=n.queryManager,r=n.queryInfo,a=n.options,d=t.call(this,function(G){try{var V=G._subscription._observer;V&&!V.error&&(V.error=dre)}catch(K){}var N=!d.observers.size;d.observers.add(G);var q=d.last;return q&&q.error?G.error&&G.error(q.error):q&&q.result&&G.next&&G.next(q.result),N&&d.reobserve().catch(function(){}),function(){d.observers.delete(G)&&!d.observers.size&&d.tearDownQuery()}})||this;d.observers=new Set,d.subscriptions=new Set,d.queryInfo=r,d.queryManager=i,d.waitForOwnResult=uk(a.fetchPolicy),d.isTornDown=!1;var o=i.defaultOptions.watchQuery,f=o===void 0?{}:o,g=f.fetchPolicy,_=g===void 0?"cache-first":g,w=a.fetchPolicy,T=w===void 0?_:w,A=a.initialFetchPolicy,D=A===void 0?T==="standby"?_:T:A;d.options=rt(rt({},a),{initialFetchPolicy:D,fetchPolicy:T}),d.queryId=r.queryId||i.generateQueryId();var z=Wv(d.query);return d.queryName=z&&z.name&&z.name.value,d}return Object.defineProperty(e.prototype,"query",{get:function(){return this.queryManager.transform(this.options.query).document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variables",{get:function(){return this.options.variables},enumerable:!1,configurable:!0}),e.prototype.result=function(){var n=this;return new Promise(function(i,r){var a={next:function(o){i(o),n.observers.delete(a),n.observers.size||n.queryManager.removeQuery(n.queryId),setTimeout(function(){d.unsubscribe()},0)},error:r},d=n.subscribe(a)})},e.prototype.getCurrentResult=function(n){n===void 0&&(n=!0);var i=this.getLastResult(!0),r=this.queryInfo.networkStatus||i&&i.networkStatus||Pi.ready,a=rt(rt({},i),{loading:Sv(r),networkStatus:r}),d=this.options.fetchPolicy,o=d===void 0?"cache-first":d;if(!(uk(o)||this.queryManager.transform(this.options.query).hasForcedResolvers))if(this.waitForOwnResult)this.queryInfo.updateWatch();else{var f=this.queryInfo.getDiff();(f.complete||this.options.returnPartialData)&&(a.data=f.result),kr(a.data,{})&&(a.data=void 0),f.complete?(delete a.partial,f.complete&&a.networkStatus===Pi.loading&&(o==="cache-first"||o==="cache-only")&&(a.networkStatus=Pi.ready,a.loading=!1)):a.partial=!0,__DEV__&&!f.complete&&!this.options.partialRefetch&&!a.loading&&!a.data&&!a.error&&j$(f.missing)}return n&&this.updateLastResult(a),a},e.prototype.isDifferentFromLastResult=function(n,i){return!this.last||!kr(this.last.result,n)||i&&!kr(this.last.variables,i)},e.prototype.getLast=function(n,i){var r=this.last;if(r&&r[n]&&(!i||kr(r.variables,this.variables)))return r[n]},e.prototype.getLastResult=function(n){return this.getLast("result",n)},e.prototype.getLastError=function(n){return this.getLast("error",n)},e.prototype.resetLastResults=function(){delete this.last,this.isTornDown=!1},e.prototype.resetQueryStoreErrors=function(){this.queryManager.resetErrors(this.queryId)},e.prototype.refetch=function(n){var i,r={pollInterval:0},a=this.options.fetchPolicy;if(a==="cache-and-network"?r.fetchPolicy=a:a==="no-cache"?r.fetchPolicy="no-cache":r.fetchPolicy="network-only",__DEV__&&n&&ure.call(n,"variables")){var d=o$(this.query),o=d.variableDefinitions;(!o||!o.some(function(f){return f.variable.name.value==="variables"}))&&__DEV__&&Ut.warn("Called refetch(".concat(JSON.stringify(n),") for query ").concat(((i=d.name)===null||i===void 0?void 0:i.value)||JSON.stringify(d),`, which does not declare a $variables variable.
Did you mean to call refetch(variables) instead of refetch({ variables })?`))}return n&&!kr(this.options.variables,n)&&(r.variables=this.options.variables=rt(rt({},this.options.variables),n)),this.queryInfo.resetLastWrite(),this.reobserve(r,Pi.refetch)},e.prototype.fetchMore=function(n){var i=this,r=rt(rt({},n.query?n:rt(rt(rt(rt({},this.options),{query:this.query}),n),{variables:rt(rt({},this.options.variables),n.variables)})),{fetchPolicy:"no-cache"}),a=this.queryManager.generateQueryId(),d=this.queryInfo,o=d.networkStatus;d.networkStatus=Pi.fetchMore,r.notifyOnNetworkStatusChange&&this.observe();var f=new Set;return this.queryManager.fetchQuery(a,r,Pi.fetchMore).then(function(g){return i.queryManager.removeQuery(a),d.networkStatus===Pi.fetchMore&&(d.networkStatus=o),i.queryManager.cache.batch({update:function(_){var w=n.updateQuery;w?_.updateQuery({query:i.query,variables:i.variables,returnPartialData:!0,optimistic:!1},function(T){return w(T,{fetchMoreResult:g.data,variables:r.variables})}):_.writeQuery({query:r.query,variables:r.variables,data:g.data})},onWatchUpdated:function(_){f.add(_.query)}}),g}).finally(function(){f.has(i.query)||$$(i)})},e.prototype.subscribeToMore=function(n){var i=this,r=this.queryManager.startGraphQLSubscription({query:n.document,variables:n.variables,context:n.context}).subscribe({next:function(a){var d=n.updateQuery;d&&i.updateQuery(function(o,f){var g=f.variables;return d(o,{subscriptionData:a,variables:g})})},error:function(a){if(n.onError){n.onError(a);return}__DEV__&&Ut.error("Unhandled GraphQL subscription error",a)}});return this.subscriptions.add(r),function(){i.subscriptions.delete(r)&&r.unsubscribe()}},e.prototype.setOptions=function(n){return this.reobserve(n)},e.prototype.setVariables=function(n){return kr(this.variables,n)?this.observers.size?this.result():Promise.resolve():(this.options.variables=n,this.observers.size?this.reobserve({fetchPolicy:this.options.initialFetchPolicy,variables:n},Pi.setVariables):Promise.resolve())},e.prototype.updateQuery=function(n){var i=this.queryManager,r=i.cache.diff({query:this.options.query,variables:this.variables,returnPartialData:!0,optimistic:!1}).result,a=n(r,{variables:this.variables});a&&(i.cache.writeQuery({query:this.options.query,data:a,variables:this.variables}),i.broadcastQueries())},e.prototype.startPolling=function(n){this.options.pollInterval=n,this.updatePolling()},e.prototype.stopPolling=function(){this.options.pollInterval=0,this.updatePolling()},e.prototype.applyNextFetchPolicy=function(n,i){if(i.nextFetchPolicy){var r=i.fetchPolicy,a=r===void 0?"cache-first":r,d=i.initialFetchPolicy,o=d===void 0?a:d;a==="standby"||(typeof i.nextFetchPolicy=="function"?i.fetchPolicy=i.nextFetchPolicy(a,{reason:n,options:i,observable:this,initialFetchPolicy:o}):n==="variables-changed"?i.fetchPolicy=o:i.fetchPolicy=i.nextFetchPolicy)}return i.fetchPolicy},e.prototype.fetch=function(n,i){return this.queryManager.setObservableQuery(this),this.queryManager.fetchConcastWithInfo(this.queryId,n,i)},e.prototype.updatePolling=function(){var n=this;if(!this.queryManager.ssrMode){var i=this,r=i.pollingInfo,a=i.options.pollInterval;if(!a){r&&(clearTimeout(r.timeout),delete this.pollingInfo);return}if(!(r&&r.interval===a)){__DEV__?Ut(a,"Attempted to start a polling query without a polling interval."):Ut(a,13);var d=r||(this.pollingInfo={});d.interval=a;var o=function(){n.pollingInfo&&(Sv(n.queryInfo.networkStatus)?f():n.reobserve({fetchPolicy:n.options.initialFetchPolicy==="no-cache"?"no-cache":"network-only"},Pi.poll).then(f,f))},f=function(){var g=n.pollingInfo;g&&(clearTimeout(g.timeout),g.timeout=setTimeout(o,g.interval))};f()}}},e.prototype.updateLastResult=function(n,i){return i===void 0&&(i=this.variables),this.last=rt(rt({},this.last),{result:this.queryManager.assumeImmutableResults?n:d$(n),variables:i}),Pl(n.errors)||delete this.last.error,this.last},e.prototype.reobserveAsConcast=function(n,i){var r=this;this.isTornDown=!1;var a=i===Pi.refetch||i===Pi.fetchMore||i===Pi.poll,d=this.options.variables,o=this.options.fetchPolicy,f=sw(this.options,n||{}),g=a?f:cre(this.options,f);a||(this.updatePolling(),n&&n.variables&&!kr(n.variables,d)&&g.fetchPolicy!=="standby"&&g.fetchPolicy===o&&(this.applyNextFetchPolicy("variables-changed",g),i===void 0&&(i=Pi.setVariables))),this.waitForOwnResult&&(this.waitForOwnResult=uk(g.fetchPolicy));var _=function(){r.concast===A&&(r.waitForOwnResult=!1)},w=g.variables&&rt({},g.variables),T=this.fetch(g,i),A=T.concast,D=T.fromLink,z={next:function(G){_(),r.reportResult(G,w)},error:function(G){_(),r.reportError(G,w)}};return!a&&D&&(this.concast&&this.observer&&this.concast.removeObserver(this.observer),this.concast=A,this.observer=z),A.addObserver(z),A},e.prototype.reobserve=function(n,i){return this.reobserveAsConcast(n,i).promise},e.prototype.observe=function(){this.reportResult(this.getCurrentResult(!1),this.variables)},e.prototype.reportResult=function(n,i){var r=this.getLastError();(r||this.isDifferentFromLastResult(n,i))&&((r||!n.partial||this.options.returnPartialData)&&this.updateLastResult(n,i),Vy(this.observers,"next",n))},e.prototype.reportError=function(n,i){var r=rt(rt({},this.getLastResult()),{error:n,errors:n.graphQLErrors,networkStatus:Pi.error,loading:!1});this.updateLastResult(r,i),Vy(this.observers,"error",this.last.error=n)},e.prototype.hasObservers=function(){return this.observers.size>0},e.prototype.tearDownQuery=function(){this.isTornDown||(this.concast&&this.observer&&(this.concast.removeObserver(this.observer),delete this.concast,delete this.observer),this.stopPolling(),this.subscriptions.forEach(function(n){return n.unsubscribe()}),this.subscriptions.clear(),this.queryManager.stopQuery(this.queryId),this.observers.clear(),this.isTornDown=!0)},e}(Bi);h$(AC);function $$(t){var e=t.options,n=e.fetchPolicy,i=e.nextFetchPolicy;return n==="cache-and-network"||n==="network-only"?t.reobserve({fetchPolicy:"cache-first",nextFetchPolicy:function(){return this.nextFetchPolicy=i,typeof i=="function"?i.apply(this,arguments):n}}):t.reobserve()}function dre(t){__DEV__&&Ut.error("Unhandled error",t.message,t.stack)}function j$(t){__DEV__&&t&&__DEV__&&Ut.debug("Missing cache result fields: ".concat(JSON.stringify(t)),t)}function uk(t){return t==="network-only"||t==="no-cache"||t==="standby"}var V$=function(){function t(e){var n=e.cache,i=e.client,r=e.resolvers,a=e.fragmentMatcher;this.selectionsToResolveCache=new WeakMap,this.cache=n,i&&(this.client=i),r&&this.addResolvers(r),a&&this.setFragmentMatcher(a)}return t.prototype.addResolvers=function(e){var n=this;this.resolvers=this.resolvers||{},Array.isArray(e)?e.forEach(function(i){n.resolvers=jL(n.resolvers,i)}):this.resolvers=jL(this.resolvers,e)},t.prototype.setResolvers=function(e){this.resolvers={},this.addResolvers(e)},t.prototype.getResolvers=function(){return this.resolvers||{}},t.prototype.runResolvers=function(e){var n=e.document,i=e.remoteResult,r=e.context,a=e.variables,d=e.onlyRunForcedResolvers,o=d===void 0?!1:d;return ru(this,void 0,void 0,function(){return ou(this,function(f){return n?[2,this.resolveDocument(n,i.data,r,a,this.fragmentMatcher,o).then(function(g){return rt(rt({},i),{data:g.result})})]:[2,i]})})},t.prototype.setFragmentMatcher=function(e){this.fragmentMatcher=e},t.prototype.getFragmentMatcher=function(){return this.fragmentMatcher},t.prototype.clientQuery=function(e){return nA(["client"],e)&&this.resolvers?e:null},t.prototype.serverQuery=function(e){return yne(e)},t.prototype.prepareContext=function(e){var n=this.cache;return rt(rt({},e),{cache:n,getCacheKey:function(i){return n.identify(i)}})},t.prototype.addExportedVariables=function(e,n,i){return n===void 0&&(n={}),i===void 0&&(i={}),ru(this,void 0,void 0,function(){return ou(this,function(r){return e?[2,this.resolveDocument(e,this.buildRootValueFromCache(e,n)||{},this.prepareContext(i),n).then(function(a){return rt(rt({},n),a.exportedVariables)})]:[2,rt({},n)]})})},t.prototype.shouldForceResolvers=function(e){var n=!1;return bc(e,{Directive:{enter:function(i){if(i.name.value==="client"&&i.arguments&&(n=i.arguments.some(function(r){return r.name.value==="always"&&r.value.kind==="BooleanValue"&&r.value.value===!0}),n))return tA}}}),n},t.prototype.buildRootValueFromCache=function(e,n){return this.cache.diff({query:gne(e),variables:n,returnPartialData:!0,optimistic:!1}).result},t.prototype.resolveDocument=function(e,n,i,r,a,d){return i===void 0&&(i={}),r===void 0&&(r={}),a===void 0&&(a=function(){return!0}),d===void 0&&(d=!1),ru(this,void 0,void 0,function(){var o,f,g,_,w,T,A,D,z,G,V;return ou(this,function(N){return o=Gv(e),f=sA(e),g=iA(f),_=this.collectSelectionsToResolve(o,g),w=o.operation,T=w?w.charAt(0).toUpperCase()+w.slice(1):"Query",A=this,D=A.cache,z=A.client,G={fragmentMap:g,context:rt(rt({},i),{cache:D,client:z}),variables:r,fragmentMatcher:a,defaultOperationType:T,exportedVariables:{},selectionsToResolve:_,onlyRunForcedResolvers:d},V=!1,[2,this.resolveSelectionSet(o.selectionSet,V,n,G).then(function(q){return{result:q,exportedVariables:G.exportedVariables}})]})})},t.prototype.resolveSelectionSet=function(e,n,i,r){return ru(this,void 0,void 0,function(){var a,d,o,f,g,_=this;return ou(this,function(w){return a=r.fragmentMap,d=r.context,o=r.variables,f=[i],g=function(T){return ru(_,void 0,void 0,function(){var A,D;return ou(this,function(z){return!n&&!r.selectionsToResolve.has(T)?[2]:nw(T,o)?Oh(T)?[2,this.resolveField(T,n,i,r).then(function(G){var V;typeof G<"u"&&f.push((V={},V[Ph(T)]=G,V))})]:(une(T)?A=T:(A=a[T.name.value],__DEV__?Ut(A,"No fragment named ".concat(T.name.value)):Ut(A,11)),A&&A.typeCondition&&(D=A.typeCondition.name.value,r.fragmentMatcher(i,D,d))?[2,this.resolveSelectionSet(A.selectionSet,n,i,r).then(function(G){f.push(G)})]:[2]):[2]})})},[2,Promise.all(e.selections.map(g)).then(function(){return cA(f)})]})})},t.prototype.resolveField=function(e,n,i,r){return ru(this,void 0,void 0,function(){var a,d,o,f,g,_,w,T,A,D=this;return ou(this,function(z){return i?(a=r.variables,d=e.name.value,o=Ph(e),f=d!==o,g=i[o]||i[d],_=Promise.resolve(g),(!r.onlyRunForcedResolvers||this.shouldForceResolvers(e))&&(w=i.__typename||r.defaultOperationType,T=this.resolvers&&this.resolvers[w],T&&(A=T[f?d:o],A&&(_=Promise.resolve(bA.withValue(this.cache,A,[i,iw(e,a),r.context,{field:e,fragmentMap:r.fragmentMap}]))))),[2,_.then(function(G){var V,N;if(G===void 0&&(G=g),e.directives&&e.directives.forEach(function(K){K.name.value==="export"&&K.arguments&&K.arguments.forEach(function(se){se.name.value==="as"&&se.value.kind==="StringValue"&&(r.exportedVariables[se.value.value]=G)})}),!e.selectionSet||G==null)return G;var q=(N=(V=e.directives)===null||V===void 0?void 0:V.some(function(K){return K.name.value==="client"}))!==null&&N!==void 0?N:!1;if(Array.isArray(G))return D.resolveSubSelectedArray(e,n||q,G,r);if(e.selectionSet)return D.resolveSelectionSet(e.selectionSet,n||q,G,r)})]):[2,null]})})},t.prototype.resolveSubSelectedArray=function(e,n,i,r){var a=this;return Promise.all(i.map(function(d){if(d===null)return null;if(Array.isArray(d))return a.resolveSubSelectedArray(e,n,d,r);if(e.selectionSet)return a.resolveSelectionSet(e.selectionSet,n,d,r)}))},t.prototype.collectSelectionsToResolve=function(e,n){var i=function(d){return!Array.isArray(d)},r=this.selectionsToResolveCache;function a(d){if(!r.has(d)){var o=new Set;r.set(d,o),bc(d,{Directive:function(f,g,_,w,T){f.name.value==="client"&&T.forEach(function(A){i(A)&&FL(A)&&o.add(A)})},FragmentSpread:function(f,g,_,w,T){var A=n[f.name.value];__DEV__?Ut(A,"No fragment named ".concat(f.name.value)):Ut(A,12);var D=a(A);D.size>0&&(T.forEach(function(z){i(z)&&FL(z)&&o.add(z)}),o.add(f),D.forEach(function(z){o.add(z)}))}})}return r.get(d)}return a(e)},t}(),_p=new(jh?WeakMap:Map);function dk(t,e){var n=t[e];typeof n=="function"&&(t[e]=function(){return _p.set(t,(_p.get(t)+1)%1e15),n.apply(this,arguments)})}function Ez(t){t.notifyTimeout&&(clearTimeout(t.notifyTimeout),t.notifyTimeout=void 0)}var hk=function(){function t(e,n){n===void 0&&(n=e.generateQueryId()),this.queryId=n,this.listeners=new Set,this.document=null,this.lastRequestId=1,this.subscriptions=new Set,this.stopped=!1,this.dirty=!1,this.observableQuery=null;var i=this.cache=e.cache;_p.has(i)||(_p.set(i,0),dk(i,"evict"),dk(i,"modify"),dk(i,"reset"))}return t.prototype.init=function(e){var n=e.networkStatus||Pi.loading;return this.variables&&this.networkStatus!==Pi.loading&&!kr(this.variables,e.variables)&&(n=Pi.setVariables),kr(e.variables,this.variables)||(this.lastDiff=void 0),Object.assign(this,{document:e.document,variables:e.variables,networkError:null,graphQLErrors:this.graphQLErrors||[],networkStatus:n}),e.observableQuery&&this.setObservableQuery(e.observableQuery),e.lastRequestId&&(this.lastRequestId=e.lastRequestId),this},t.prototype.reset=function(){Ez(this),this.dirty=!1},t.prototype.getDiff=function(e){e===void 0&&(e=this.variables);var n=this.getDiffOptions(e);if(this.lastDiff&&kr(n,this.lastDiff.options))return this.lastDiff.diff;this.updateWatch(this.variables=e);var i=this.observableQuery;if(i&&i.options.fetchPolicy==="no-cache")return{complete:!1};var r=this.cache.diff(n);return this.updateLastDiff(r,n),r},t.prototype.updateLastDiff=function(e,n){this.lastDiff=e?{diff:e,options:n||this.getDiffOptions()}:void 0},t.prototype.getDiffOptions=function(e){var n;return e===void 0&&(e=this.variables),{query:this.document,variables:e,returnPartialData:!0,optimistic:!0,canonizeResults:(n=this.observableQuery)===null||n===void 0?void 0:n.options.canonizeResults}},t.prototype.setDiff=function(e){var n=this,i=this.lastDiff&&this.lastDiff.diff;this.updateLastDiff(e),!this.dirty&&!kr(i&&i.result,e&&e.result)&&(this.dirty=!0,this.notifyTimeout||(this.notifyTimeout=setTimeout(function(){return n.notify()},0)))},t.prototype.setObservableQuery=function(e){var n=this;e!==this.observableQuery&&(this.oqListener&&this.listeners.delete(this.oqListener),this.observableQuery=e,e?(e.queryInfo=this,this.listeners.add(this.oqListener=function(){var i=n.getDiff();i.fromOptimisticTransaction?e.observe():$$(e)})):delete this.oqListener)},t.prototype.notify=function(){var e=this;Ez(this),this.shouldNotify()&&this.listeners.forEach(function(n){return n(e)}),this.dirty=!1},t.prototype.shouldNotify=function(){if(!this.dirty||!this.listeners.size)return!1;if(Sv(this.networkStatus)&&this.observableQuery){var e=this.observableQuery.options.fetchPolicy;if(e!=="cache-only"&&e!=="cache-and-network")return!1}return!0},t.prototype.stop=function(){if(!this.stopped){this.stopped=!0,this.reset(),this.cancel(),this.cancel=t.prototype.cancel,this.subscriptions.forEach(function(n){return n.unsubscribe()});var e=this.observableQuery;e&&e.stopPolling()}},t.prototype.cancel=function(){},t.prototype.updateWatch=function(e){var n=this;e===void 0&&(e=this.variables);var i=this.observableQuery;if(!(i&&i.options.fetchPolicy==="no-cache")){var r=rt(rt({},this.getDiffOptions(e)),{watcher:this,callback:function(a){return n.setDiff(a)}});(!this.lastWatch||!kr(r,this.lastWatch))&&(this.cancel(),this.cancel=this.cache.watch(this.lastWatch=r))}},t.prototype.resetLastWrite=function(){this.lastWrite=void 0},t.prototype.shouldWrite=function(e,n){var i=this.lastWrite;return!(i&&i.dmCount===_p.get(this.cache)&&kr(n,i.variables)&&kr(e.data,i.result.data))},t.prototype.markResult=function(e,n,i,r){var a=this,d=new $u,o=Pl(e.errors)?e.errors.slice(0):[];if(this.reset(),"incremental"in e&&Pl(e.incremental)){var f=f$(this.getDiff().result,e);e.data=f}else if("hasNext"in e&&e.hasNext){var g=this.getDiff();e.data=d.merge(g.result,e.data)}this.graphQLErrors=o,i.fetchPolicy==="no-cache"?this.updateLastDiff({result:e.data,complete:!0},this.getDiffOptions(i.variables)):r!==0&&(MC(e,i.errorPolicy)?this.cache.performTransaction(function(_){if(a.shouldWrite(e,i.variables))_.writeQuery({query:n,data:e.data,variables:i.variables,overwrite:r===1}),a.lastWrite={result:e,variables:i.variables,dmCount:_p.get(a.cache)};else if(a.lastDiff&&a.lastDiff.diff.complete){e.data=a.lastDiff.diff.result;return}var w=a.getDiffOptions(i.variables),T=_.diff(w);a.stopped||a.updateWatch(i.variables),a.updateLastDiff(T,w),T.complete&&(e.data=T.result)}):this.lastWrite=void 0)},t.prototype.markReady=function(){return this.networkError=null,this.networkStatus=Pi.ready},t.prototype.markError=function(e){return this.networkStatus=Pi.error,this.lastWrite=void 0,this.reset(),e.graphQLErrors&&(this.graphQLErrors=e.graphQLErrors),e.networkError&&(this.networkError=e.networkError),e},t}();function MC(t,e){e===void 0&&(e="none");var n=e==="ignore"||e==="all",i=!x_(t);return!i&&n&&t.data&&(i=!0),i}var hre=Object.prototype.hasOwnProperty,fre=function(){function t(e){var n=e.cache,i=e.link,r=e.defaultOptions,a=e.queryDeduplication,d=a===void 0?!1:a,o=e.onBroadcast,f=e.ssrMode,g=f===void 0?!1:f,_=e.clientAwareness,w=_===void 0?{}:_,T=e.localState,A=e.assumeImmutableResults;this.clientAwareness={},this.queries=new Map,this.fetchCancelFns=new Map,this.transformCache=new(jh?WeakMap:Map),this.queryIdCounter=1,this.requestIdCounter=1,this.mutationIdCounter=1,this.inFlightLinkObservables=new Map,this.cache=n,this.link=i,this.defaultOptions=r||Object.create(null),this.queryDeduplication=d,this.clientAwareness=w,this.localState=T||new V$({cache:n}),this.ssrMode=g,this.assumeImmutableResults=!!A,(this.onBroadcast=o)&&(this.mutationStore=Object.create(null))}return t.prototype.stop=function(){var e=this;this.queries.forEach(function(n,i){e.stopQueryNoBroadcast(i)}),this.cancelPendingFetches(__DEV__?new vi("QueryManager stopped while query was in flight"):new vi(14))},t.prototype.cancelPendingFetches=function(e){this.fetchCancelFns.forEach(function(n){return n(e)}),this.fetchCancelFns.clear()},t.prototype.mutate=function(e){var n,i,r=e.mutation,a=e.variables,d=e.optimisticResponse,o=e.updateQueries,f=e.refetchQueries,g=f===void 0?[]:f,_=e.awaitRefetchQueries,w=_===void 0?!1:_,T=e.update,A=e.onQueryUpdated,D=e.fetchPolicy,z=D===void 0?((n=this.defaultOptions.mutate)===null||n===void 0?void 0:n.fetchPolicy)||"network-only":D,G=e.errorPolicy,V=G===void 0?((i=this.defaultOptions.mutate)===null||i===void 0?void 0:i.errorPolicy)||"none":G,N=e.keepRootFields,q=e.context;return ru(this,void 0,void 0,function(){var K,se,ie,Q,J,te;return ou(this,function(me){switch(me.label){case 0:return __DEV__?Ut(r,"mutation option is required. You must specify your GraphQL document in the mutation option."):Ut(r,15),__DEV__?Ut(z==="network-only"||z==="no-cache","Mutations support only 'network-only' or 'no-cache' fetchPolicy strings. The default `network-only` behavior automatically writes mutation results to the cache. Passing `no-cache` skips the cache write."):Ut(z==="network-only"||z==="no-cache",16),K=this.generateMutationId(),se=this.transform(r),ie=se.document,Q=se.hasClientExports,r=this.cache.transformForLink(ie),a=this.getVariables(r,a),Q?[4,this.localState.addExportedVariables(r,a,q)]:[3,2];case 1:a=me.sent(),me.label=2;case 2:return J=this.mutationStore&&(this.mutationStore[K]={mutation:r,variables:a,loading:!0,error:null}),d&&this.markMutationOptimistic(d,{mutationId:K,document:r,variables:a,fetchPolicy:z,errorPolicy:V,context:q,updateQueries:o,update:T,keepRootFields:N}),this.broadcastQueries(),te=this,[2,new Promise(function(Fe,tt){return ik(te.getObservableFromLink(r,rt(rt({},q),{optimisticResponse:d}),a,!1),function(At){if(x_(At)&&V==="none")throw new au({graphQLErrors:gC(At)});J&&(J.loading=!1,J.error=null);var _t=rt({},At);return typeof g=="function"&&(g=g(_t)),V==="ignore"&&x_(_t)&&delete _t.errors,te.markMutationResult({mutationId:K,result:_t,document:r,variables:a,fetchPolicy:z,errorPolicy:V,context:q,update:T,updateQueries:o,awaitRefetchQueries:w,refetchQueries:g,removeOptimistic:d?K:void 0,onQueryUpdated:A,keepRootFields:N})}).subscribe({next:function(At){te.broadcastQueries(),(!("hasNext"in At)||At.hasNext===!1)&&Fe(At)},error:function(At){J&&(J.loading=!1,J.error=At),d&&te.cache.removeOptimistic(K),te.broadcastQueries(),tt(At instanceof au?At:new au({networkError:At}))}})})]}})})},t.prototype.markMutationResult=function(e,n){var i=this;n===void 0&&(n=this.cache);var r=e.result,a=[],d=e.fetchPolicy==="no-cache";if(!d&&MC(r,e.errorPolicy)){if(Lp(r)||a.push({result:r.data,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}),Lp(r)&&Pl(r.incremental)){var o=n.diff({id:"ROOT_MUTATION",query:this.transform(e.document).asQuery,variables:e.variables,optimistic:!1,returnPartialData:!0}),f=void 0;o.result&&(f=f$(o.result,r)),typeof f<"u"&&(r.data=f,a.push({result:f,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}))}var g=e.updateQueries;g&&this.queries.forEach(function(w,T){var A=w.observableQuery,D=A&&A.queryName;if(!(!D||!hre.call(g,D))){var z=g[D],G=i.queries.get(T),V=G.document,N=G.variables,q=n.diff({query:V,variables:N,returnPartialData:!0,optimistic:!1}),K=q.result,se=q.complete;if(se&&K){var ie=z(K,{mutationResult:r,queryName:V&&dC(V)||void 0,queryVariables:N});ie&&a.push({result:ie,dataId:"ROOT_QUERY",query:V,variables:N})}}})}if(a.length>0||e.refetchQueries||e.update||e.onQueryUpdated||e.removeOptimistic){var _=[];if(this.refetchQueries({updateCache:function(w){d||a.forEach(function(z){return w.write(z)});var T=e.update,A=!Dne(r)||Lp(r)&&!r.hasNext;if(T){if(!d){var D=w.diff({id:"ROOT_MUTATION",query:i.transform(e.document).asQuery,variables:e.variables,optimistic:!1,returnPartialData:!0});D.complete&&(r=rt(rt({},r),{data:D.result}),"incremental"in r&&delete r.incremental,"hasNext"in r&&delete r.hasNext)}A&&T(w,r,{context:e.context,variables:e.variables})}!d&&!e.keepRootFields&&A&&w.modify({id:"ROOT_MUTATION",fields:function(z,G){var V=G.fieldName,N=G.DELETE;return V==="__typename"?z:N}})},include:e.refetchQueries,optimistic:!1,removeOptimistic:e.removeOptimistic,onQueryUpdated:e.onQueryUpdated||null}).forEach(function(w){return _.push(w)}),e.awaitRefetchQueries||e.onQueryUpdated)return Promise.all(_).then(function(){return r})}return Promise.resolve(r)},t.prototype.markMutationOptimistic=function(e,n){var i=this,r=typeof e=="function"?e(n.variables):e;return this.cache.recordOptimisticTransaction(function(a){try{i.markMutationResult(rt(rt({},n),{result:{data:r}}),a)}catch(d){__DEV__&&Ut.error(d)}},n.mutationId)},t.prototype.fetchQuery=function(e,n,i){return this.fetchQueryObservable(e,n,i).promise},t.prototype.getQueryStore=function(){var e=Object.create(null);return this.queries.forEach(function(n,i){e[i]={variables:n.variables,networkStatus:n.networkStatus,networkError:n.networkError,graphQLErrors:n.graphQLErrors}}),e},t.prototype.resetErrors=function(e){var n=this.queries.get(e);n&&(n.networkError=void 0,n.graphQLErrors=[])},t.prototype.transform=function(e){var n=this.transformCache;if(!n.has(e)){var i=this.cache.transformDocument(e),r=mne(i),a=this.localState.clientQuery(i),d=r&&this.localState.serverQuery(r),o={document:i,hasClientExports:Hte(i),hasForcedResolvers:this.localState.shouldForceResolvers(i),clientQuery:a,serverQuery:d,defaultVars:aA(Wv(i)),asQuery:rt(rt({},i),{definitions:i.definitions.map(function(g){return g.kind==="OperationDefinition"&&g.operation!=="query"?rt(rt({},g),{operation:"query"}):g})})},f=function(g){g&&!n.has(g)&&n.set(g,o)};f(e),f(i),f(a),f(d)}return n.get(e)},t.prototype.getVariables=function(e,n){return rt(rt({},this.transform(e).defaultVars),n)},t.prototype.watchQuery=function(e){e=rt(rt({},e),{variables:this.getVariables(e.query,e.variables)}),typeof e.notifyOnNetworkStatusChange>"u"&&(e.notifyOnNetworkStatusChange=!1);var n=new hk(this),i=new AC({queryManager:this,queryInfo:n,options:e});return this.queries.set(i.queryId,n),n.init({document:i.query,observableQuery:i,variables:i.variables}),i},t.prototype.query=function(e,n){var i=this;return n===void 0&&(n=this.generateQueryId()),__DEV__?Ut(e.query,"query option is required. You must specify your GraphQL document in the query option."):Ut(e.query,17),__DEV__?Ut(e.query.kind==="Document",'You must wrap the query string in a "gql" tag.'):Ut(e.query.kind==="Document",18),__DEV__?Ut(!e.returnPartialData,"returnPartialData option only supported on watchQuery."):Ut(!e.returnPartialData,19),__DEV__?Ut(!e.pollInterval,"pollInterval option only supported on watchQuery."):Ut(!e.pollInterval,20),this.fetchQuery(n,e).finally(function(){return i.stopQuery(n)})},t.prototype.generateQueryId=function(){return String(this.queryIdCounter++)},t.prototype.generateRequestId=function(){return this.requestIdCounter++},t.prototype.generateMutationId=function(){return String(this.mutationIdCounter++)},t.prototype.stopQueryInStore=function(e){this.stopQueryInStoreNoBroadcast(e),this.broadcastQueries()},t.prototype.stopQueryInStoreNoBroadcast=function(e){var n=this.queries.get(e);n&&n.stop()},t.prototype.clearStore=function(e){return e===void 0&&(e={discardWatches:!0}),this.cancelPendingFetches(__DEV__?new vi("Store reset while query was in flight (not completed in link chain)"):new vi(21)),this.queries.forEach(function(n){n.observableQuery?n.networkStatus=Pi.loading:n.stop()}),this.mutationStore&&(this.mutationStore=Object.create(null)),this.cache.reset(e)},t.prototype.getObservableQueries=function(e){var n=this;e===void 0&&(e="active");var i=new Map,r=new Map,a=new Set;return Array.isArray(e)&&e.forEach(function(d){typeof d=="string"?r.set(d,!1):Yte(d)?r.set(n.transform(d).document,!1):$i(d)&&d.query&&a.add(d)}),this.queries.forEach(function(d,o){var f=d.observableQuery,g=d.document;if(f){if(e==="all"){i.set(o,f);return}var _=f.queryName,w=f.options.fetchPolicy;if(w==="standby"||e==="active"&&!f.hasObservers())return;(e==="active"||_&&r.has(_)||g&&r.has(g))&&(i.set(o,f),_&&r.set(_,!0),g&&r.set(g,!0))}}),a.size&&a.forEach(function(d){var o=yC("legacyOneTimeQuery"),f=n.getQuery(o).init({document:d.query,variables:d.variables}),g=new AC({queryManager:n,queryInfo:f,options:rt(rt({},d),{fetchPolicy:"network-only"})});Ut(g.queryId===o),f.setObservableQuery(g),i.set(o,g)}),__DEV__&&r.size&&r.forEach(function(d,o){d||__DEV__&&Ut.warn("Unknown query ".concat(typeof o=="string"?"named ":"").concat(JSON.stringify(o,null,2)," requested in refetchQueries options.include array"))}),i},t.prototype.reFetchObservableQueries=function(e){var n=this;e===void 0&&(e=!1);var i=[];return this.getObservableQueries(e?"all":"active").forEach(function(r,a){var d=r.options.fetchPolicy;r.resetLastResults(),(e||d!=="standby"&&d!=="cache-only")&&i.push(r.refetch()),n.getQuery(a).setDiff(null)}),this.broadcastQueries(),Promise.all(i)},t.prototype.setObservableQuery=function(e){this.getQuery(e.queryId).setObservableQuery(e)},t.prototype.startGraphQLSubscription=function(e){var n=this,i=e.query,r=e.fetchPolicy,a=e.errorPolicy,d=e.variables,o=e.context,f=o===void 0?{}:o;i=this.transform(i).document,d=this.getVariables(i,d);var g=function(w){return n.getObservableFromLink(i,f,w).map(function(T){r!=="no-cache"&&(MC(T,a)&&n.cache.write({query:i,result:T.data,dataId:"ROOT_SUBSCRIPTION",variables:w}),n.broadcastQueries());var A=x_(T),D=Jne(T);if(A||D){var z={};throw A&&(z.graphQLErrors=T.errors),D&&(z.protocolErrors=T.extensions[mA]),new au(z)}return T})};if(this.transform(i).hasClientExports){var _=this.localState.addExportedVariables(i,d,f).then(g);return new Bi(function(w){var T=null;return _.then(function(A){return T=A.subscribe(w)},w.error),function(){return T&&T.unsubscribe()}})}return g(d)},t.prototype.stopQuery=function(e){this.stopQueryNoBroadcast(e),this.broadcastQueries()},t.prototype.stopQueryNoBroadcast=function(e){this.stopQueryInStoreNoBroadcast(e),this.removeQuery(e)},t.prototype.removeQuery=function(e){this.fetchCancelFns.delete(e),this.queries.has(e)&&(this.getQuery(e).stop(),this.queries.delete(e))},t.prototype.broadcastQueries=function(){this.onBroadcast&&this.onBroadcast(),this.queries.forEach(function(e){return e.notify()})},t.prototype.getLocalState=function(){return this.localState},t.prototype.getObservableFromLink=function(e,n,i,r){var a=this,d;r===void 0&&(r=(d=n==null?void 0:n.queryDeduplication)!==null&&d!==void 0?d:this.queryDeduplication);var o,f=this.transform(e).serverQuery;if(f){var g=this,_=g.inFlightLinkObservables,w=g.link,T={query:f,variables:i,operationName:dC(f)||void 0,context:this.prepareContext(rt(rt({},n),{forceFetch:!r}))};if(n=T.context,r){var A=_.get(f)||new Map;_.set(f,A);var D=uh(i);if(o=A.get(D),!o){var z=new ip([bC(w,T)]);A.set(D,o=z),z.beforeNext(function(){A.delete(D)&&A.size<1&&_.delete(f)})}}else o=new ip([bC(w,T)])}else o=new ip([Bi.of({data:{}})]),n=this.prepareContext(n);var G=this.transform(e).clientQuery;return G&&(o=ik(o,function(V){return a.localState.runResolvers({document:G,remoteResult:V,context:n,variables:i})})),o},t.prototype.getResultsFromLink=function(e,n,i){var r=e.lastRequestId=this.generateRequestId(),a=this.cache.transformForLink(this.transform(e.document).document);return ik(this.getObservableFromLink(a,i.context,i.variables),function(d){var o=gC(d),f=o.length>0;if(r>=e.lastRequestId){if(f&&i.errorPolicy==="none")throw e.markError(new au({graphQLErrors:o}));e.markResult(d,a,i,n),e.markReady()}var g={data:d.data,loading:!1,networkStatus:Pi.ready};return f&&i.errorPolicy!=="ignore"&&(g.errors=o,g.networkStatus=Pi.error),g},function(d){var o=Qne(d)?d:new au({networkError:d});throw r>=e.lastRequestId&&e.markError(o),o})},t.prototype.fetchQueryObservable=function(e,n,i){return this.fetchConcastWithInfo(e,n,i).concast},t.prototype.fetchConcastWithInfo=function(e,n,i){var r=this;i===void 0&&(i=Pi.loading);var a=this.transform(n.query).document,d=this.getVariables(a,n.variables),o=this.getQuery(e),f=this.defaultOptions.watchQuery,g=n.fetchPolicy,_=g===void 0?f&&f.fetchPolicy||"cache-first":g,w=n.errorPolicy,T=w===void 0?f&&f.errorPolicy||"none":w,A=n.returnPartialData,D=A===void 0?!1:A,z=n.notifyOnNetworkStatusChange,G=z===void 0?!1:z,V=n.context,N=V===void 0?{}:V,q=Object.assign({},n,{query:a,variables:d,fetchPolicy:_,errorPolicy:T,returnPartialData:D,notifyOnNetworkStatusChange:G,context:N}),K=function(te){q.variables=te;var me=r.fetchQueryByPolicy(o,q,i);return q.fetchPolicy!=="standby"&&me.sources.length>0&&o.observableQuery&&o.observableQuery.applyNextFetchPolicy("after-fetch",n),me},se=function(){return r.fetchCancelFns.delete(e)};this.fetchCancelFns.set(e,function(te){se(),setTimeout(function(){return ie.cancel(te)})});var ie,Q;if(this.transform(q.query).hasClientExports)ie=new ip(this.localState.addExportedVariables(q.query,q.variables,q.context).then(K).then(function(te){return te.sources})),Q=!0;else{var J=K(q.variables);Q=J.fromLink,ie=new ip(J.sources)}return ie.promise.then(se,se),{concast:ie,fromLink:Q}},t.prototype.refetchQueries=function(e){var n=this,i=e.updateCache,r=e.include,a=e.optimistic,d=a===void 0?!1:a,o=e.removeOptimistic,f=o===void 0?d?yC("refetchQueries"):void 0:o,g=e.onQueryUpdated,_=new Map;r&&this.getObservableQueries(r).forEach(function(T,A){_.set(A,{oq:T,lastDiff:n.getQuery(A).getDiff()})});var w=new Map;return i&&this.cache.batch({update:i,optimistic:d&&f||!1,removeOptimistic:f,onWatchUpdated:function(T,A,D){var z=T.watcher instanceof hk&&T.watcher.observableQuery;if(z){if(g){_.delete(z.queryId);var G=g(z,A,D);return G===!0&&(G=z.refetch()),G!==!1&&w.set(z,G),G}g!==null&&_.set(z.queryId,{oq:z,lastDiff:D,diff:A})}}}),_.size&&_.forEach(function(T,A){var D=T.oq,z=T.lastDiff,G=T.diff,V;if(g){if(!G){var N=D.queryInfo;N.reset(),G=N.getDiff()}V=g(D,G,z)}(!g||V===!0)&&(V=D.refetch()),V!==!1&&w.set(D,V),A.indexOf("legacyOneTimeQuery")>=0&&n.stopQueryNoBroadcast(A)}),f&&this.cache.removeOptimistic(f),w},t.prototype.fetchQueryByPolicy=function(e,n,i){var r=this,a=n.query,d=n.variables,o=n.fetchPolicy,f=n.refetchWritePolicy,g=n.errorPolicy,_=n.returnPartialData,w=n.context,T=n.notifyOnNetworkStatusChange,A=e.networkStatus;e.init({document:this.transform(a).document,variables:d,networkStatus:i});var D=function(){return e.getDiff(d)},z=function(K,se){se===void 0&&(se=e.networkStatus||Pi.loading);var ie=K.result;__DEV__&&!_&&!kr(ie,{})&&j$(K.missing);var Q=function(J){return Bi.of(rt({data:J,loading:Sv(se),networkStatus:se},K.complete?null:{partial:!0}))};return ie&&r.transform(a).hasForcedResolvers?r.localState.runResolvers({document:a,remoteResult:{data:ie},context:w,variables:d,onlyRunForcedResolvers:!0}).then(function(J){return Q(J.data||void 0)}):g==="none"&&se===Pi.refetch&&Array.isArray(K.missing)?Q(void 0):Q(ie)},G=o==="no-cache"?0:i===Pi.refetch&&f!=="merge"?1:2,V=function(){return r.getResultsFromLink(e,G,{variables:d,context:w,fetchPolicy:o,errorPolicy:g})},N=T&&typeof A=="number"&&A!==i&&Sv(i);switch(o){default:case"cache-first":{var q=D();return q.complete?{fromLink:!1,sources:[z(q,e.markReady())]}:_||N?{fromLink:!0,sources:[z(q),V()]}:{fromLink:!0,sources:[V()]}}case"cache-and-network":{var q=D();return q.complete||_||N?{fromLink:!0,sources:[z(q),V()]}:{fromLink:!0,sources:[V()]}}case"cache-only":return{fromLink:!1,sources:[z(D(),e.markReady())]};case"network-only":return N?{fromLink:!0,sources:[z(D()),V()]}:{fromLink:!0,sources:[V()]};case"no-cache":return N?{fromLink:!0,sources:[z(e.getDiff()),V()]}:{fromLink:!0,sources:[V()]};case"standby":return{fromLink:!1,sources:[]}}},t.prototype.getQuery=function(e){return e&&!this.queries.has(e)&&this.queries.set(e,new hk(this,e)),this.queries.get(e)},t.prototype.prepareContext=function(e){e===void 0&&(e={});var n=this.localState.prepareContext(e);return rt(rt({},n),{clientAwareness:this.clientAwareness})},t}(),kz=!1,pre=function(){function t(e){var n=this;this.resetStoreCallbacks=[],this.clearStoreCallbacks=[];var i=e.uri,r=e.credentials,a=e.headers,d=e.cache,o=e.ssrMode,f=o===void 0?!1:o,g=e.ssrForceFetchDelay,_=g===void 0?0:g,w=e.connectToDevTools,T=w===void 0?typeof window=="object"&&!window.__APOLLO_CLIENT__&&__DEV__:w,A=e.queryDeduplication,D=A===void 0?!0:A,z=e.defaultOptions,G=e.assumeImmutableResults,V=G===void 0?!1:G,N=e.resolvers,q=e.typeDefs,K=e.fragmentMatcher,se=e.name,ie=e.version,Q=e.link;if(Q||(Q=i?new gie({uri:i,credentials:r,headers:a}):Xu.empty()),!d)throw __DEV__?new vi(`To initialize Apollo Client, you must specify a 'cache' property in the options object. 
For more information, please visit: https://go.apollo.dev/c/docs`):new vi(9);if(this.link=Q,this.cache=d,this.disableNetworkFetches=f||_>0,this.queryDeduplication=D,this.defaultOptions=z||Object.create(null),this.typeDefs=q,_&&setTimeout(function(){return n.disableNetworkFetches=!1},_),this.watchQuery=this.watchQuery.bind(this),this.query=this.query.bind(this),this.mutate=this.mutate.bind(this),this.resetStore=this.resetStore.bind(this),this.reFetchObservableQueries=this.reFetchObservableQueries.bind(this),T&&typeof window=="object"&&(window.__APOLLO_CLIENT__=this),!kz&&T&&__DEV__&&(kz=!0,typeof window<"u"&&window.document&&window.top===window.self&&!window.__APOLLO_DEVTOOLS_GLOBAL_HOOK__)){var J=window.navigator,te=J&&J.userAgent,me=void 0;typeof te=="string"&&(te.indexOf("Chrome/")>-1?me="https://chrome.google.com/webstore/detail/apollo-client-developer-t/jdkknkkbebbapilgoeccciglkfbmbnfm":te.indexOf("Firefox/")>-1&&(me="https://addons.mozilla.org/en-US/firefox/addon/apollo-developer-tools/")),me&&__DEV__&&Ut.log("Download the Apollo DevTools for a better development experience: "+me)}this.version=jne,this.localState=new V$({cache:d,client:this,resolvers:N,fragmentMatcher:K}),this.queryManager=new fre({cache:this.cache,link:this.link,defaultOptions:this.defaultOptions,queryDeduplication:D,ssrMode:f,clientAwareness:{name:se,version:ie},localState:this.localState,assumeImmutableResults:V,onBroadcast:T?function(){n.devToolsHookCb&&n.devToolsHookCb({action:{},state:{queries:n.queryManager.getQueryStore(),mutations:n.queryManager.mutationStore||{}},dataWithOptimisticResults:n.cache.extract(!0)})}:void 0})}return t.prototype.stop=function(){this.queryManager.stop()},t.prototype.watchQuery=function(e){return this.defaultOptions.watchQuery&&(e=w_(this.defaultOptions.watchQuery,e)),this.disableNetworkFetches&&(e.fetchPolicy==="network-only"||e.fetchPolicy==="cache-and-network")&&(e=rt(rt({},e),{fetchPolicy:"cache-first"})),this.queryManager.watchQuery(e)},t.prototype.query=function(e){return this.defaultOptions.query&&(e=w_(this.defaultOptions.query,e)),__DEV__?Ut(e.fetchPolicy!=="cache-and-network","The cache-and-network fetchPolicy does not work with client.query, because client.query can only return a single result. Please use client.watchQuery to receive multiple results from the cache and the network, or consider using a different fetchPolicy, such as cache-first or network-only."):Ut(e.fetchPolicy!=="cache-and-network",10),this.disableNetworkFetches&&e.fetchPolicy==="network-only"&&(e=rt(rt({},e),{fetchPolicy:"cache-first"})),this.queryManager.query(e)},t.prototype.mutate=function(e){return this.defaultOptions.mutate&&(e=w_(this.defaultOptions.mutate,e)),this.queryManager.mutate(e)},t.prototype.subscribe=function(e){return this.queryManager.startGraphQLSubscription(e)},t.prototype.readQuery=function(e,n){return n===void 0&&(n=!1),this.cache.readQuery(e,n)},t.prototype.readFragment=function(e,n){return n===void 0&&(n=!1),this.cache.readFragment(e,n)},t.prototype.writeQuery=function(e){var n=this.cache.writeQuery(e);return e.broadcast!==!1&&this.queryManager.broadcastQueries(),n},t.prototype.writeFragment=function(e){var n=this.cache.writeFragment(e);return e.broadcast!==!1&&this.queryManager.broadcastQueries(),n},t.prototype.__actionHookForDevTools=function(e){this.devToolsHookCb=e},t.prototype.__requestRaw=function(e){return bC(this.link,e)},t.prototype.resetStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore({discardWatches:!1})}).then(function(){return Promise.all(e.resetStoreCallbacks.map(function(n){return n()}))}).then(function(){return e.reFetchObservableQueries()})},t.prototype.clearStore=function(){var e=this;return Promise.resolve().then(function(){return e.queryManager.clearStore({discardWatches:!0})}).then(function(){return Promise.all(e.clearStoreCallbacks.map(function(n){return n()}))})},t.prototype.onResetStore=function(e){var n=this;return this.resetStoreCallbacks.push(e),function(){n.resetStoreCallbacks=n.resetStoreCallbacks.filter(function(i){return i!==e})}},t.prototype.onClearStore=function(e){var n=this;return this.clearStoreCallbacks.push(e),function(){n.clearStoreCallbacks=n.clearStoreCallbacks.filter(function(i){return i!==e})}},t.prototype.reFetchObservableQueries=function(e){return this.queryManager.reFetchObservableQueries(e)},t.prototype.refetchQueries=function(e){var n=this.queryManager.refetchQueries(e),i=[],r=[];n.forEach(function(d,o){i.push(o),r.push(d)});var a=Promise.all(r);return a.queries=i,a.results=r,a.catch(function(d){__DEV__&&Ut.debug("In client.refetchQueries, Promise.all promise rejected with error ".concat(d))}),a},t.prototype.getObservableQueries=function(e){return e===void 0&&(e="active"),this.queryManager.getObservableQueries(e)},t.prototype.extract=function(e){return this.cache.extract(e)},t.prototype.restore=function(e){return this.cache.restore(e)},t.prototype.addResolvers=function(e){this.localState.addResolvers(e)},t.prototype.setResolvers=function(e){this.localState.setResolvers(e)},t.prototype.getResolvers=function(){return this.localState.getResolvers()},t.prototype.setLocalStateFragmentMatcher=function(e){this.localState.setFragmentMatcher(e)},t.prototype.setLink=function(e){this.link=this.queryManager.link=e},t}(),E_=new Map,PC=new Map,U$=!0,Bx=!1;function q$(t){return t.replace(/[\s,]+/g," ").trim()}function mre(t){return q$(t.source.body.substring(t.start,t.end))}function gre(t){var e=new Set,n=[];return t.definitions.forEach(function(i){if(i.kind==="FragmentDefinition"){var r=i.name.value,a=mre(i.loc),d=PC.get(r);d&&!d.has(a)?U$&&console.warn("Warning: fragment with name "+r+` already exists.
graphql-tag enforces all fragment names across your application to be unique; read more about
this in the docs: http://dev.apollodata.com/core/fragments.html#unique-names`):d||PC.set(r,d=new Set),d.add(a),e.has(a)||(e.add(a),n.push(i))}else n.push(i)}),rt(rt({},t),{definitions:n})}function yre(t){var e=new Set(t.definitions);e.forEach(function(i){i.loc&&delete i.loc,Object.keys(i).forEach(function(r){var a=i[r];a&&typeof a=="object"&&e.add(a)})});var n=t.loc;return n&&(delete n.startToken,delete n.endToken),t}function vre(t){var e=q$(t);if(!E_.has(e)){var n=zte(t,{experimentalFragmentVariables:Bx,allowLegacyFragmentVariables:Bx});if(!n||n.kind!=="Document")throw new Error("Not a valid GraphQL document.");E_.set(e,yre(gre(n)))}return E_.get(e)}function ti(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];typeof t=="string"&&(t=[t]);var i=t[0];return e.forEach(function(r,a){r&&r.kind==="Document"?i+=r.loc.source.body:i+=r,i+=t[a+1]}),vre(i)}function bre(){E_.clear(),PC.clear()}function _re(){U$=!1}function xre(){Bx=!0}function wre(){Bx=!1}var py={gql:ti,resetCaches:bre,disableFragmentWarnings:_re,enableExperimentalFragmentVariables:xre,disableExperimentalFragmentVariables:wre};(function(t){t.gql=py.gql,t.resetCaches=py.resetCaches,t.disableFragmentWarnings=py.disableFragmentWarnings,t.enableExperimentalFragmentVariables=py.enableExperimentalFragmentVariables,t.disableExperimentalFragmentVariables=py.disableExperimentalFragmentVariables})(ti||(ti={}));ti.default=ti;var Tz=pA?Symbol.for("__APOLLO_CONTEXT__"):"__APOLLO_CONTEXT__";function W$(){var t=et.createContext[Tz];return t||(Object.defineProperty(et.createContext,Tz,{value:t=et.createContext({}),enumerable:!1,writable:!1,configurable:!0}),t.displayName="ApolloContext"),t}var OC=function(t){var e=t.client,n=t.children,i=W$();return et.createElement(i.Consumer,null,function(r){return r===void 0&&(r={}),e&&r.client!==e&&(r=Object.assign({},r,{client:e})),__DEV__?Ut(r.client,'ApolloProvider was not passed a client instance. Make sure you pass in your client via the "client" prop.'):Ut(r.client,29),et.createElement(i.Provider,{value:r},n)})};function G$(t){var e=et.useContext(W$()),n=t||e.client;return __DEV__?Ut(!!n,'Could not find "client" in the context or passed in as an option. Wrap the root component in an <ApolloProvider>, or pass an ApolloClient instance in via options.'):Ut(!!n,32),n}var Il;(function(t){t[t.Query=0]="Query",t[t.Mutation=1]="Mutation",t[t.Subscription=2]="Subscription"})(Il||(Il={}));var Cz=new Map;function Iz(t){var e;switch(t){case Il.Query:e="Query";break;case Il.Mutation:e="Mutation";break;case Il.Subscription:e="Subscription";break}return e}function Sre(t){var e=Cz.get(t);if(e)return e;var n,i,r;__DEV__?Ut(!!t&&!!t.kind,"Argument of ".concat(t," passed to parser was not a valid GraphQL ")+"DocumentNode. You may need to use 'graphql-tag' or another method to convert your operation into a document"):Ut(!!t&&!!t.kind,33);for(var a=[],d=[],o=[],f=[],g=0,_=t.definitions;g<_.length;g++){var w=_[g];if(w.kind==="FragmentDefinition"){a.push(w);continue}if(w.kind==="OperationDefinition")switch(w.operation){case"query":d.push(w);break;case"mutation":o.push(w);break;case"subscription":f.push(w);break}}__DEV__?Ut(!a.length||d.length||o.length||f.length,"Passing only a fragment to 'graphql' is not yet supported. You must include a query, subscription or mutation as well"):Ut(!a.length||d.length||o.length||f.length,34),__DEV__?Ut(d.length+o.length+f.length<=1,"react-apollo only supports a query, subscription, or a mutation per HOC. "+"".concat(t," had ").concat(d.length," queries, ").concat(f.length," ")+"subscriptions and ".concat(o.length," mutations. ")+"You can use 'compose' to join multiple operation types to a component"):Ut(d.length+o.length+f.length<=1,35),i=d.length?Il.Query:Il.Mutation,!d.length&&!o.length&&(i=Il.Subscription);var T=d.length?d:o.length?o:f;__DEV__?Ut(T.length===1,"react-apollo only supports one definition per HOC. ".concat(t," had ")+"".concat(T.length," definitions. ")+"You can use 'compose' to join multiple operation types to a component"):Ut(T.length===1,36);var A=T[0];n=A.variableDefinitions||[],A.name&&A.name.kind==="Name"?r=A.name.value:r="data";var D={name:r,type:i,variables:n};return Cz.set(t,D),D}function H$(t,e){var n=Sre(t),i=Iz(e),r=Iz(n.type);__DEV__?Ut(n.type===e,"Running a ".concat(i," requires a graphql ")+"".concat(i,", but a ").concat(r," was used instead.")):Ut(n.type===e,37)}function Ir(t,e){var n=G$(e==null?void 0:e.client);H$(t,Il.Mutation);var i=et.useState({called:!1,loading:!1,client:n}),r=i[0],a=i[1],d=et.useRef({result:r,mutationId:0,isMounted:!0,client:n,mutation:t,options:e});Object.assign(d.current,{client:n,options:e,mutation:t});var o=et.useCallback(function(g){g===void 0&&(g={});var _=d.current,w=_.options,T=_.mutation,A=rt(rt({},w),{mutation:T}),D=g.client||d.current.client;!d.current.result.loading&&!A.ignoreResults&&d.current.isMounted&&a(d.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:D});var z=++d.current.mutationId,G=w_(A,g);return D.mutate(G).then(function(V){var N,q=V.data,K=V.errors,se=K&&K.length>0?new au({graphQLErrors:K}):void 0;if(z===d.current.mutationId&&!G.ignoreResults){var ie={called:!0,loading:!1,data:q,error:se,client:D};d.current.isMounted&&!kr(d.current.result,ie)&&a(d.current.result=ie)}var Q=g.onCompleted||((N=d.current.options)===null||N===void 0?void 0:N.onCompleted);return Q==null||Q(V.data,G),V}).catch(function(V){var N;if(z===d.current.mutationId&&d.current.isMounted){var q={loading:!1,error:V,data:void 0,called:!0,client:D};kr(d.current.result,q)||a(d.current.result=q)}var K=g.onError||((N=d.current.options)===null||N===void 0?void 0:N.onError);if(K)return K(V,G),{data:void 0,errors:V};throw V})},[]),f=et.useCallback(function(){d.current.isMounted&&a({called:!1,loading:!1,client:n})},[]);return et.useEffect(function(){return d.current.isMounted=!0,function(){d.current.isMounted=!1}},[]),[o,rt({reset:f},r)]}function SA(t,e){var n=et.useRef(!1),i=G$(e==null?void 0:e.client);H$(t,Il.Subscription);var r=et.useState({loading:!(e!=null&&e.skip),error:void 0,data:void 0,variables:e==null?void 0:e.variables}),a=r[0],d=r[1];n.current||(n.current=!0,e!=null&&e.onSubscriptionData&&__DEV__&&Ut.warn(e.onData?"'useSubscription' supports only the 'onSubscriptionData' or 'onData' option, but not both. Only the 'onData' option will be used.":"'onSubscriptionData' is deprecated and will be removed in a future major version. Please use the 'onData' option instead."),e!=null&&e.onSubscriptionComplete&&__DEV__&&Ut.warn(e.onComplete?"'useSubscription' supports only the 'onSubscriptionComplete' or 'onComplete' option, but not both. Only the 'onComplete' option will be used.":"'onSubscriptionComplete' is deprecated and will be removed in a future major version. Please use the 'onComplete' option instead."));var o=et.useState(function(){return e!=null&&e.skip?null:i.subscribe({query:t,variables:e==null?void 0:e.variables,fetchPolicy:e==null?void 0:e.fetchPolicy,context:e==null?void 0:e.context})}),f=o[0],g=o[1],_=et.useRef(!1);et.useEffect(function(){return function(){_.current=!0}},[]);var w=et.useRef({client:i,subscription:t,options:e});return et.useEffect(function(){var T,A,D,z,G=e==null?void 0:e.shouldResubscribe;typeof G=="function"&&(G=!!G(e)),e!=null&&e.skip?(!(e!=null&&e.skip)!=!(!((T=w.current.options)===null||T===void 0)&&T.skip)||_.current)&&(d({loading:!1,data:void 0,error:void 0,variables:e==null?void 0:e.variables}),g(null),_.current=!1):(G!==!1&&(i!==w.current.client||t!==w.current.subscription||(e==null?void 0:e.fetchPolicy)!==((A=w.current.options)===null||A===void 0?void 0:A.fetchPolicy)||!(e!=null&&e.skip)!=!(!((D=w.current.options)===null||D===void 0)&&D.skip)||!kr(e==null?void 0:e.variables,(z=w.current.options)===null||z===void 0?void 0:z.variables))||_.current)&&(d({loading:!0,data:void 0,error:void 0,variables:e==null?void 0:e.variables}),g(i.subscribe({query:t,variables:e==null?void 0:e.variables,fetchPolicy:e==null?void 0:e.fetchPolicy,context:e==null?void 0:e.context})),_.current=!1),Object.assign(w.current,{client:i,subscription:t,options:e})},[i,t,e,_.current]),et.useEffect(function(){if(f){var T=!1,A=f.subscribe({next:function(D){var z,G;if(!T){var V={loading:!1,data:D.data,error:void 0,variables:e==null?void 0:e.variables};d(V),!((z=w.current.options)===null||z===void 0)&&z.onData?w.current.options.onData({client:i,data:V}):!((G=w.current.options)===null||G===void 0)&&G.onSubscriptionData&&w.current.options.onSubscriptionData({client:i,subscriptionData:V})}},error:function(D){var z,G;T||(d({loading:!1,data:void 0,error:D,variables:e==null?void 0:e.variables}),(G=(z=w.current.options)===null||z===void 0?void 0:z.onError)===null||G===void 0||G.call(z,D))},complete:function(){var D,z;T||(!((D=w.current.options)===null||D===void 0)&&D.onComplete?w.current.options.onComplete():!((z=w.current.options)===null||z===void 0)&&z.onSubscriptionComplete&&w.current.options.onSubscriptionComplete())}});return function(){T=!0,setTimeout(function(){A.unsubscribe()})}}},[f]),a}const Ku=ti`
  fragment ChannelFields on Channel {
    id
    name
    detail
    ownerId
    lat
    lng
    memberCount
    activeUserCount
    createdAt
    updatedAt
    deletedAt
  }
`;ti`
  mutation GetActiveChannels($lng: Float!, $lat: Float!) {
    getActiveChannels(lng: $lng, lat: $lat) {
      ...ChannelFields
    }
  }
  ${Ku}
`;const Ere=ti`
  mutation GetChannels($lng: Float!, $lat: Float!) {
    getChannels(lng: $lng, lat: $lat) {
      ...ChannelFields
    }
  }
  ${Ku}
`,kre=t=>{const e=ji(),[n]=Ir(Ere,{onError:r=>{console.log(r)},onCompleted:r=>{console.log(r),e(Hu(r.getChannels)),t(!0)}});return(r,a)=>{n({variables:{lng:r,lat:a}})}},Yu=ti`
  fragment UserFields on User {
    id
    email
    phone
    name
    isAdmin
    isCamOn
    isMicOn
    isSoundOn
    activeChannelId
  }
`,Em=ti`
  fragment MembershipFields on Membership {
    id
    channelId 
    userId
    savedIndex
    isActive
    createdAt
    updatedAt
    deletedAt
  }
`,Tre=ti`
  mutation ActivateChannel($channelId: Int) {
    activateChannel(channelId: $channelId) {
      user {
        ...UserFields
      }
      channels {
        ...ChannelFields
      }
      memberships {
        ...MembershipFields
      }
    }
  }
  ${Yu}
  ${Ku}
  ${Em}
`,Z$=()=>{const t=ji(),[e]=Ir(Tre,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t(wc([i.activateChannel.user])),t(Hu(i.activateChannel.channels)),t($h(i.activateChannel.memberships))}});return i=>{e({variables:{channelId:i}})}};var X$={exports:{}},K$={exports:{}};(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(n,i){return n<<i|n>>>32-i},rotr:function(n,i){return n<<32-i|n>>>i},endian:function(n){if(n.constructor==Number)return e.rotl(n,8)&16711935|e.rotl(n,24)&4278255360;for(var i=0;i<n.length;i++)n[i]=e.endian(n[i]);return n},randomBytes:function(n){for(var i=[];n>0;n--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(n){for(var i=[],r=0,a=0;r<n.length;r++,a+=8)i[a>>>5]|=n[r]<<24-a%32;return i},wordsToBytes:function(n){for(var i=[],r=0;r<n.length*32;r+=8)i.push(n[r>>>5]>>>24-r%32&255);return i},bytesToHex:function(n){for(var i=[],r=0;r<n.length;r++)i.push((n[r]>>>4).toString(16)),i.push((n[r]&15).toString(16));return i.join("")},hexToBytes:function(n){for(var i=[],r=0;r<n.length;r+=2)i.push(parseInt(n.substr(r,2),16));return i},bytesToBase64:function(n){for(var i=[],r=0;r<n.length;r+=3)for(var a=n[r]<<16|n[r+1]<<8|n[r+2],d=0;d<4;d++)r*8+d*6<=n.length*8?i.push(t.charAt(a>>>6*(3-d)&63)):i.push("=");return i.join("")},base64ToBytes:function(n){n=n.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],r=0,a=0;r<n.length;a=++r%4)a!=0&&i.push((t.indexOf(n.charAt(r-1))&Math.pow(2,-2*a+8)-1)<<a*2|t.indexOf(n.charAt(r))>>>6-a*2);return i}};K$.exports=e})();var Cre=K$.exports,DC={utf8:{stringToBytes:function(t){return DC.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(DC.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(t.charCodeAt(n)&255);return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}},Az=DC;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Ire=function(t){return t!=null&&(Y$(t)||Are(t)||!!t._isBuffer)};function Y$(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function Are(t){return typeof t.readFloatLE=="function"&&typeof t.slice=="function"&&Y$(t.slice(0,0))}(function(){var t=Cre,e=Az.utf8,n=Ire,i=Az.bin,r=function(a,d){a.constructor==String?d&&d.encoding==="binary"?a=i.stringToBytes(a):a=e.stringToBytes(a):n(a)?a=Array.prototype.slice.call(a,0):!Array.isArray(a)&&a.constructor!==Uint8Array&&(a=a.toString());for(var o=t.bytesToWords(a),f=a.length*8,g=1732584193,_=-271733879,w=-1732584194,T=271733878,A=0;A<o.length;A++)o[A]=(o[A]<<8|o[A]>>>24)&16711935|(o[A]<<24|o[A]>>>8)&4278255360;o[f>>>5]|=128<<f%32,o[(f+64>>>9<<4)+14]=f;for(var D=r._ff,z=r._gg,G=r._hh,V=r._ii,A=0;A<o.length;A+=16){var N=g,q=_,K=w,se=T;g=D(g,_,w,T,o[A+0],7,-680876936),T=D(T,g,_,w,o[A+1],12,-389564586),w=D(w,T,g,_,o[A+2],17,606105819),_=D(_,w,T,g,o[A+3],22,-1044525330),g=D(g,_,w,T,o[A+4],7,-176418897),T=D(T,g,_,w,o[A+5],12,1200080426),w=D(w,T,g,_,o[A+6],17,-1473231341),_=D(_,w,T,g,o[A+7],22,-45705983),g=D(g,_,w,T,o[A+8],7,1770035416),T=D(T,g,_,w,o[A+9],12,-1958414417),w=D(w,T,g,_,o[A+10],17,-42063),_=D(_,w,T,g,o[A+11],22,-1990404162),g=D(g,_,w,T,o[A+12],7,1804603682),T=D(T,g,_,w,o[A+13],12,-40341101),w=D(w,T,g,_,o[A+14],17,-1502002290),_=D(_,w,T,g,o[A+15],22,1236535329),g=z(g,_,w,T,o[A+1],5,-165796510),T=z(T,g,_,w,o[A+6],9,-1069501632),w=z(w,T,g,_,o[A+11],14,643717713),_=z(_,w,T,g,o[A+0],20,-373897302),g=z(g,_,w,T,o[A+5],5,-701558691),T=z(T,g,_,w,o[A+10],9,38016083),w=z(w,T,g,_,o[A+15],14,-660478335),_=z(_,w,T,g,o[A+4],20,-405537848),g=z(g,_,w,T,o[A+9],5,568446438),T=z(T,g,_,w,o[A+14],9,-1019803690),w=z(w,T,g,_,o[A+3],14,-187363961),_=z(_,w,T,g,o[A+8],20,1163531501),g=z(g,_,w,T,o[A+13],5,-1444681467),T=z(T,g,_,w,o[A+2],9,-51403784),w=z(w,T,g,_,o[A+7],14,1735328473),_=z(_,w,T,g,o[A+12],20,-1926607734),g=G(g,_,w,T,o[A+5],4,-378558),T=G(T,g,_,w,o[A+8],11,-2022574463),w=G(w,T,g,_,o[A+11],16,1839030562),_=G(_,w,T,g,o[A+14],23,-35309556),g=G(g,_,w,T,o[A+1],4,-1530992060),T=G(T,g,_,w,o[A+4],11,1272893353),w=G(w,T,g,_,o[A+7],16,-155497632),_=G(_,w,T,g,o[A+10],23,-1094730640),g=G(g,_,w,T,o[A+13],4,681279174),T=G(T,g,_,w,o[A+0],11,-358537222),w=G(w,T,g,_,o[A+3],16,-722521979),_=G(_,w,T,g,o[A+6],23,76029189),g=G(g,_,w,T,o[A+9],4,-640364487),T=G(T,g,_,w,o[A+12],11,-421815835),w=G(w,T,g,_,o[A+15],16,530742520),_=G(_,w,T,g,o[A+2],23,-995338651),g=V(g,_,w,T,o[A+0],6,-198630844),T=V(T,g,_,w,o[A+7],10,1126891415),w=V(w,T,g,_,o[A+14],15,-1416354905),_=V(_,w,T,g,o[A+5],21,-57434055),g=V(g,_,w,T,o[A+12],6,1700485571),T=V(T,g,_,w,o[A+3],10,-1894986606),w=V(w,T,g,_,o[A+10],15,-1051523),_=V(_,w,T,g,o[A+1],21,-2054922799),g=V(g,_,w,T,o[A+8],6,1873313359),T=V(T,g,_,w,o[A+15],10,-30611744),w=V(w,T,g,_,o[A+6],15,-1560198380),_=V(_,w,T,g,o[A+13],21,1309151649),g=V(g,_,w,T,o[A+4],6,-145523070),T=V(T,g,_,w,o[A+11],10,-1120210379),w=V(w,T,g,_,o[A+2],15,718787259),_=V(_,w,T,g,o[A+9],21,-343485551),g=g+N>>>0,_=_+q>>>0,w=w+K>>>0,T=T+se>>>0}return t.endian([g,_,w,T])};r._ff=function(a,d,o,f,g,_,w){var T=a+(d&o|~d&f)+(g>>>0)+w;return(T<<_|T>>>32-_)+d},r._gg=function(a,d,o,f,g,_,w){var T=a+(d&f|o&~f)+(g>>>0)+w;return(T<<_|T>>>32-_)+d},r._hh=function(a,d,o,f,g,_,w){var T=a+(d^o^f)+(g>>>0)+w;return(T<<_|T>>>32-_)+d},r._ii=function(a,d,o,f,g,_,w){var T=a+(o^(d|~f))+(g>>>0)+w;return(T<<_|T>>>32-_)+d},r._blocksize=16,r._digestsize=16,X$.exports=function(a,d){if(a==null)throw new Error("Illegal argument "+a);var o=t.wordsToBytes(r(a,d));return d&&d.asBytes?o:d&&d.asString?i.bytesToString(o):t.bytesToHex(o)}})();var Mre=X$.exports;const lw=_c(Mre),Mz=t=>e=>{e&&(e.srcObject=t,e.play())},J$=({authModal:t,streams:e})=>{const n=ei(Ws),i=ei(Zu),r=ei(g=>{var _;return ree(g,(_=i==null?void 0:i.id)!=null?_:-1)}),a=ei(V1),d=Z$(),o=()=>{var g;if(!(n!=null&&n.id)){(g=t.current)==null||g.present();return}i!=null&&i.id&&d(i.id)},f=()=>{d(null)};return Qt("div",{children:[(n==null?void 0:n.activeChannelId)===(i==null?void 0:i.id)?Ae(rr,{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Ae(Rn,{onClick:f,style:{backgroundColor:"red",color:"var(--ion-color-dark)",borderRadius:"5px",fontWeight:"bold"},children:"LEAVE"})}):Ae(rr,{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Ae(Rn,{onClick:o,style:{backgroundColor:"green",color:"var(--ion-color-dark)",borderRadius:"5px",fontWeight:"bold"},children:"CALL"})}),Ae("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},children:r.filter(g=>g.isActive).sort((g,_)=>g.userId===(n==null?void 0:n.id)?-1:_.userId===(n==null?void 0:n.id)?1:g.createdAt<_.createdAt?-1:g.createdAt>_.createdAt?1:0).map(g=>{var _,w;return Qt("div",{style:{margin:5,width:100},children:[Qt("div",{children:[(_=e[g.userId])!=null&&_.video&&(g.userId!==(n==null?void 0:n.id)||n!=null&&n.isCamOn)?Ae("video",{ref:Mz(e[g.userId].video),playsInline:!0,autoPlay:!0,muted:!0,style:{width:100,height:100,transform:g.userId===(n==null?void 0:n.id)?"rotateY(180deg)":"",border:"1px solid",borderRadius:5}}):Ae(L1,{style:{width:100,height:100,border:"1px solid",borderRadius:5},children:Ae("img",{src:`https://www.gravatar.com/avatar/${lw(a[g.userId].email||"")}?d=retro`})}),(w=e[g.userId])!=null&&w.audio&&(n!=null&&n.isSoundOn)&&g.userId!==(n==null?void 0:n.id)?Ae("audio",{ref:Mz(e[g.userId].audio),playsInline:!0,autoPlay:!0,muted:!1}):null]}),Ae("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:a[g.userId].name})]},"membership-"+g.id)})})]})},EA=ti`
  fragment PostFields on Post {
    id
    channelId 
    userId
    text
    createdAt
    updatedAt
    deletedAt
  }
`,Pre=ti`
  mutation GetChannelPosts($channelId: Int!, $createdAt: String) {
    getChannelPosts(channelId: $channelId, createdAt: $createdAt) {
      ...PostFields
      user {
        id
        name
        email
      }
    }
  }
  ${EA}
`,Ore=()=>{const t=ji(),[e]=Ir(Pre,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t($1(i.getChannelPosts))}});return(i,r)=>{e({variables:{channelId:i,createdAt:r}})}};function yo(t){this.content=t}yo.prototype={constructor:yo,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var i=n&&n!=t?this.remove(n):this,r=i.find(t),a=i.content.slice();return r==-1?a.push(n||t,e):(a[r+1]=e,n&&(a[r]=n)),new yo(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new yo(n)},addToStart:function(t,e){return new yo([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new yo(n)},addBefore:function(t,e,n){var i=this.remove(e),r=i.content.slice(),a=i.find(t);return r.splice(a==-1?r.length:a,0,e,n),new yo(r)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=yo.from(t),t.size?new yo(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=yo.from(t),t.size?new yo(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=yo.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};yo.from=function(t){if(t instanceof yo)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new yo(e)};function Q$(t,e,n){for(let i=0;;i++){if(i==t.childCount||i==e.childCount)return t.childCount==e.childCount?null:n;let r=t.child(i),a=e.child(i);if(r==a){n+=r.nodeSize;continue}if(!r.sameMarkup(a))return n;if(r.isText&&r.text!=a.text){for(let d=0;r.text[d]==a.text[d];d++)n++;return n}if(r.content.size||a.content.size){let d=Q$(r.content,a.content,n+1);if(d!=null)return d}n+=r.nodeSize}}function e6(t,e,n,i){for(let r=t.childCount,a=e.childCount;;){if(r==0||a==0)return r==a?null:{a:n,b:i};let d=t.child(--r),o=e.child(--a),f=d.nodeSize;if(d==o){n-=f,i-=f;continue}if(!d.sameMarkup(o))return{a:n,b:i};if(d.isText&&d.text!=o.text){let g=0,_=Math.min(d.text.length,o.text.length);for(;g<_&&d.text[d.text.length-g-1]==o.text[o.text.length-g-1];)g++,n--,i--;return{a:n,b:i}}if(d.content.size||o.content.size){let g=e6(d.content,o.content,n-1,i-1);if(g)return g}n-=f,i-=f}}class Ft{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let i=0;i<e.length;i++)this.size+=e[i].nodeSize}nodesBetween(e,n,i,r=0,a){for(let d=0,o=0;o<n;d++){let f=this.content[d],g=o+f.nodeSize;if(g>e&&i(f,r+o,a||null,d)!==!1&&f.content.size){let _=o+1;f.nodesBetween(Math.max(0,e-_),Math.min(f.content.size,n-_),i,r+_)}o=g}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,i,r){let a="",d=!0;return this.nodesBetween(e,n,(o,f)=>{o.isText?(a+=o.text.slice(Math.max(e,f)-f,n-f),d=!i):o.isLeaf?(r?a+=typeof r=="function"?r(o):r:o.type.spec.leafText&&(a+=o.type.spec.leafText(o)),d=!i):!d&&o.isBlock&&(a+=i,d=!0)},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,i=e.firstChild,r=this.content.slice(),a=0;for(n.isText&&n.sameMarkup(i)&&(r[r.length-1]=n.withText(n.text+i.text),a=1);a<e.content.length;a++)r.push(e.content[a]);return new Ft(r,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let i=[],r=0;if(n>e)for(let a=0,d=0;d<n;a++){let o=this.content[a],f=d+o.nodeSize;f>e&&((d<e||f>n)&&(o.isText?o=o.cut(Math.max(0,e-d),Math.min(o.text.length,n-d)):o=o.cut(Math.max(0,e-d-1),Math.min(o.content.size,n-d-1))),i.push(o),r+=o.nodeSize),d=f}return new Ft(i,r)}cutByIndex(e,n){return e==n?Ft.empty:e==0&&n==this.content.length?this:new Ft(this.content.slice(e,n))}replaceChild(e,n){let i=this.content[e];if(i==n)return this;let r=this.content.slice(),a=this.size+n.nodeSize-i.nodeSize;return r[e]=n,new Ft(r,a)}addToStart(e){return new Ft([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ft(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,i=0;n<this.content.length;n++){let r=this.content[n];e(r,i,n),i+=r.nodeSize}}findDiffStart(e,n=0){return Q$(this,e,n)}findDiffEnd(e,n=this.size,i=e.size){return e6(this,e,n,i)}findIndex(e,n=-1){if(e==0)return Zb(0,e);if(e==this.size)return Zb(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let i=0,r=0;;i++){let a=this.child(i),d=r+a.nodeSize;if(d>=e)return d==e||n>0?Zb(i+1,d):Zb(i,r);r=d}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Ft.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ft(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ft.empty;let n,i=0;for(let r=0;r<e.length;r++){let a=e[r];i+=a.nodeSize,r&&a.isText&&e[r-1].sameMarkup(a)?(n||(n=e.slice(0,r)),n[n.length-1]=a.withText(n[n.length-1].text+a.text)):n&&n.push(a)}return new Ft(n||e,i)}static from(e){if(!e)return Ft.empty;if(e instanceof Ft)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ft([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ft.empty=new Ft([],0);const fk={index:0,offset:0};function Zb(t,e){return fk.index=t,fk.offset=e,fk}function Fx(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!Fx(t[i],e[i]))return!1}else{for(let i in t)if(!(i in e)||!Fx(t[i],e[i]))return!1;for(let i in e)if(!(i in t))return!1}return!0}let Oi=class RC{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,i=!1;for(let r=0;r<e.length;r++){let a=e[r];if(this.eq(a))return e;if(this.type.excludes(a.type))n||(n=e.slice(0,r));else{if(a.type.excludes(this.type))return e;!i&&a.type.rank>this.type.rank&&(n||(n=e.slice(0,r)),n.push(this),i=!0),n&&n.push(a)}}return n||(n=e.slice()),i||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Fx(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let i=e.marks[n.type];if(!i)throw new RangeError(`There is no mark type ${n.type} in this schema`);return i.create(n.attrs)}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].eq(n[i]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return RC.none;if(e instanceof RC)return[e];let n=e.slice();return n.sort((i,r)=>i.type.rank-r.type.rank),n}};Oi.none=[];class Nx extends Error{}class nn{constructor(e,n,i){this.content=e,this.openStart=n,this.openEnd=i}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let i=n6(this.content,e+this.openStart,n);return i&&new nn(i,this.openStart,this.openEnd)}removeBetween(e,n){return new nn(t6(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return nn.empty;let i=n.openStart||0,r=n.openEnd||0;if(typeof i!="number"||typeof r!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new nn(Ft.fromJSON(e,n.content),i,r)}static maxOpen(e,n=!0){let i=0,r=0;for(let a=e.firstChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.firstChild)i++;for(let a=e.lastChild;a&&!a.isLeaf&&(n||!a.type.spec.isolating);a=a.lastChild)r++;return new nn(e,i,r)}}nn.empty=new nn(Ft.empty,0,0);function t6(t,e,n){let{index:i,offset:r}=t.findIndex(e),a=t.maybeChild(i),{index:d,offset:o}=t.findIndex(n);if(r==e||a.isText){if(o!=n&&!t.child(d).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(i!=d)throw new RangeError("Removing non-flat range");return t.replaceChild(i,a.copy(t6(a.content,e-r-1,n-r-1)))}function n6(t,e,n,i){let{index:r,offset:a}=t.findIndex(e),d=t.maybeChild(r);if(a==e||d.isText)return i&&!i.canReplace(r,r,n)?null:t.cut(0,e).append(n).append(t.cut(e));let o=n6(d.content,e-a-1,n);return o&&t.replaceChild(r,d.copy(o))}function Dre(t,e,n){if(n.openStart>t.depth)throw new Nx("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Nx("Inconsistent open depths");return i6(t,e,n,0)}function i6(t,e,n,i){let r=t.index(i),a=t.node(i);if(r==e.index(i)&&i<t.depth-n.openStart){let d=i6(t,e,n,i+1);return a.copy(a.content.replaceChild(r,d))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==i&&e.depth==i){let d=t.parent,o=d.content;return hh(d,o.cut(0,t.parentOffset).append(n.content).append(o.cut(e.parentOffset)))}else{let{start:d,end:o}=Rre(n,t);return hh(a,o6(t,d,o,e,i))}else return hh(a,$x(t,e,i))}function r6(t,e){if(!e.type.compatibleContent(t.type))throw new Nx("Cannot join "+e.type.name+" onto "+t.type.name)}function LC(t,e,n){let i=t.node(n);return r6(i,e.node(n)),i}function dh(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Wy(t,e,n,i){let r=(e||t).node(n),a=0,d=e?e.index(n):r.childCount;t&&(a=t.index(n),t.depth>n?a++:t.textOffset&&(dh(t.nodeAfter,i),a++));for(let o=a;o<d;o++)dh(r.child(o),i);e&&e.depth==n&&e.textOffset&&dh(e.nodeBefore,i)}function hh(t,e){return t.type.checkContent(e),t.copy(e)}function o6(t,e,n,i,r){let a=t.depth>r&&LC(t,e,r+1),d=i.depth>r&&LC(n,i,r+1),o=[];return Wy(null,t,r,o),a&&d&&e.index(r)==n.index(r)?(r6(a,d),dh(hh(a,o6(t,e,n,i,r+1)),o)):(a&&dh(hh(a,$x(t,e,r+1)),o),Wy(e,n,r,o),d&&dh(hh(d,$x(n,i,r+1)),o)),Wy(i,null,r,o),new Ft(o)}function $x(t,e,n){let i=[];if(Wy(null,t,n,i),t.depth>n){let r=LC(t,e,n+1);dh(hh(r,$x(t,e,n+1)),i)}return Wy(e,null,n,i),new Ft(i)}function Rre(t,e){let n=e.depth-t.openStart,r=e.node(n).copy(t.content);for(let a=n-1;a>=0;a--)r=e.node(a).copy(Ft.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}class Ev{constructor(e,n,i){this.pos=e,this.path=n,this.parentOffset=i,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let i=this.pos-this.path[this.path.length-1],r=e.child(n);return i?e.child(n).cut(i):r}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let i=this.path[n*3],r=n==0?0:this.path[n*3-1]+1;for(let a=0;a<e;a++)r+=i.child(a).nodeSize;return r}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Oi.none;if(this.textOffset)return e.child(n).marks;let i=e.maybeChild(n-1),r=e.maybeChild(n);if(!i){let o=i;i=r,r=o}let a=i.marks;for(var d=0;d<a.length;d++)a[d].type.spec.inclusive===!1&&(!r||!a[d].isInSet(r.marks))&&(a=a[d--].removeFromSet(a));return a}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let i=n.marks,r=e.parent.maybeChild(e.index());for(var a=0;a<i.length;a++)i[a].type.spec.inclusive===!1&&(!r||!i[a].isInSet(r.marks))&&(i=i[a--].removeFromSet(i));return i}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let i=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);i>=0;i--)if(e.pos<=this.end(i)&&(!n||n(this.node(i))))return new jx(this,e,i);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let i=[],r=0,a=n;for(let d=e;;){let{index:o,offset:f}=d.content.findIndex(a),g=a-f;if(i.push(d,o,r+f),!g||(d=d.child(o),d.isText))break;a=g-1,r+=f+1}return new Ev(n,i,a)}static resolveCached(e,n){for(let r=0;r<pk.length;r++){let a=pk[r];if(a.pos==n&&a.doc==e)return a}let i=pk[mk]=Ev.resolve(e,n);return mk=(mk+1)%Lre,i}}let pk=[],mk=0,Lre=12;class jx{constructor(e,n,i){this.$from=e,this.$to=n,this.depth=i}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const zre=Object.create(null);let fh=class zC{constructor(e,n,i,r=Oi.none){this.type=e,this.attrs=n,this.marks=r,this.content=i||Ft.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,i,r=0){this.content.nodesBetween(e,n,i,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,i,r){return this.content.textBetween(e,n,i,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,i){return this.type==e&&Fx(this.attrs,n||e.defaultAttrs||zre)&&Oi.sameSet(this.marks,i||Oi.none)}copy(e=null){return e==this.content?this:new zC(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new zC(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,i=!1){if(e==n)return nn.empty;let r=this.resolve(e),a=this.resolve(n),d=i?0:r.sharedDepth(n),o=r.start(d),g=r.node(d).content.cut(r.pos-o,a.pos-o);return new nn(g,r.depth-d,a.depth-d)}replace(e,n,i){return Dre(this.resolve(e),this.resolve(n),i)}nodeAt(e){for(let n=this;;){let{index:i,offset:r}=n.content.findIndex(e);if(n=n.maybeChild(i),!n)return null;if(r==e||n.isText)return n;e-=r+1}}childAfter(e){let{index:n,offset:i}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:i}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:i}=this.content.findIndex(e);if(i<e)return{node:this.content.child(n),index:n,offset:i};let r=this.content.child(n-1);return{node:r,index:n-1,offset:i-r.nodeSize}}resolve(e){return Ev.resolveCached(this,e)}resolveNoCache(e){return Ev.resolve(this,e)}rangeHasMark(e,n,i){let r=!1;return n>e&&this.nodesBetween(e,n,a=>(i.isInSet(a.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),s6(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,i=Ft.empty,r=0,a=i.childCount){let d=this.contentMatchAt(e).matchFragment(i,r,a),o=d&&d.matchFragment(this.content,n);if(!o||!o.validEnd)return!1;for(let f=r;f<a;f++)if(!this.type.allowsMarks(i.child(f).marks))return!1;return!0}canReplaceWith(e,n,i,r){if(r&&!this.type.allowsMarks(r))return!1;let a=this.contentMatchAt(e).matchType(i),d=a&&a.matchFragment(this.content,n);return d?d.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=Oi.none;for(let n=0;n<this.marks.length;n++)e=this.marks[n].addToSet(e);if(!Oi.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let i=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");i=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,i)}let r=Ft.fromJSON(e,n.content);return e.nodeType(n.type).create(n.attrs,r,i)}};fh.prototype.text=void 0;class Vx extends fh{constructor(e,n,i,r){if(super(e,n,null,r),!i)throw new RangeError("Empty text nodes are not allowed");this.text=i}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):s6(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Vx(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Vx(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function s6(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Dh{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let i=new Bre(e,n);if(i.next==null)return Dh.empty;let r=a6(i);i.next&&i.err("Unexpected trailing text");let a=qre(Ure(r));return Wre(a,i),a}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,i=e.childCount){let r=this;for(let a=n;r&&a<i;a++)r=r.matchType(e.child(a).type);return r}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let i=0;i<e.next.length;i++)if(this.next[n].type==e.next[i].type)return!0;return!1}fillBefore(e,n=!1,i=0){let r=[this];function a(d,o){let f=d.matchFragment(e,i);if(f&&(!n||f.validEnd))return Ft.from(o.map(g=>g.createAndFill()));for(let g=0;g<d.next.length;g++){let{type:_,next:w}=d.next[g];if(!(_.isText||_.hasRequiredAttrs())&&r.indexOf(w)==-1){r.push(w);let T=a(w,o.concat(_));if(T)return T}}return null}return a(this,[])}findWrapping(e){for(let i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==e)return this.wrapCache[i+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),i=[{match:this,type:null,via:null}];for(;i.length;){let r=i.shift(),a=r.match;if(a.matchType(e)){let d=[];for(let o=r;o.type;o=o.via)d.push(o.type);return d.reverse()}for(let d=0;d<a.next.length;d++){let{type:o,next:f}=a.next[d];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in n)&&(!r.type||f.validEnd)&&(i.push({match:o.contentMatch,type:o,via:r}),n[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(i){e.push(i);for(let r=0;r<i.next.length;r++)e.indexOf(i.next[r].next)==-1&&n(i.next[r].next)}return n(this),e.map((i,r)=>{let a=r+(i.validEnd?"*":" ")+" ";for(let d=0;d<i.next.length;d++)a+=(d?", ":"")+i.next[d].type.name+"->"+e.indexOf(i.next[d].next);return a}).join(`
`)}}Dh.empty=new Dh(!0);class Bre{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function a6(t){let e=[];do e.push(Fre(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Fre(t){let e=[];do e.push(Nre(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Nre(t){let e=Vre(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=$re(t,e);else break;return e}function Pz(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function $re(t,e){let n=Pz(t),i=n;return t.eat(",")&&(t.next!="}"?i=Pz(t):i=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:e}}function jre(t,e){let n=t.nodeTypes,i=n[e];if(i)return[i];let r=[];for(let a in n){let d=n[a];d.groups.indexOf(e)>-1&&r.push(d)}return r.length==0&&t.err("No node type or group '"+e+"' found"),r}function Vre(t){if(t.eat("(")){let e=a6(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=jre(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Ure(t){let e=[[]];return r(a(t,0),n()),e;function n(){return e.push([])-1}function i(d,o,f){let g={term:f,to:o};return e[d].push(g),g}function r(d,o){d.forEach(f=>f.to=o)}function a(d,o){if(d.type=="choice")return d.exprs.reduce((f,g)=>f.concat(a(g,o)),[]);if(d.type=="seq")for(let f=0;;f++){let g=a(d.exprs[f],o);if(f==d.exprs.length-1)return g;r(g,o=n())}else if(d.type=="star"){let f=n();return i(o,f),r(a(d.expr,f),f),[i(f)]}else if(d.type=="plus"){let f=n();return r(a(d.expr,o),f),r(a(d.expr,f),f),[i(f)]}else{if(d.type=="opt")return[i(o)].concat(a(d.expr,o));if(d.type=="range"){let f=o;for(let g=0;g<d.min;g++){let _=n();r(a(d.expr,f),_),f=_}if(d.max==-1)r(a(d.expr,f),f);else for(let g=d.min;g<d.max;g++){let _=n();i(f,_),r(a(d.expr,f),_),f=_}return[i(f)]}else{if(d.type=="name")return[i(o,void 0,d.value)];throw new Error("Unknown expr type")}}}}function l6(t,e){return e-t}function Oz(t,e){let n=[];return i(e),n.sort(l6);function i(r){let a=t[r];if(a.length==1&&!a[0].term)return i(a[0].to);n.push(r);for(let d=0;d<a.length;d++){let{term:o,to:f}=a[d];!o&&n.indexOf(f)==-1&&i(f)}}}function qre(t){let e=Object.create(null);return n(Oz(t,0));function n(i){let r=[];i.forEach(d=>{t[d].forEach(({term:o,to:f})=>{if(!o)return;let g;for(let _=0;_<r.length;_++)r[_][0]==o&&(g=r[_][1]);Oz(t,f).forEach(_=>{g||r.push([o,g=[]]),g.indexOf(_)==-1&&g.push(_)})})});let a=e[i.join(",")]=new Dh(i.indexOf(t.length-1)>-1);for(let d=0;d<r.length;d++){let o=r[d][1].sort(l6);a.next.push({type:r[d][0],next:e[o.join(",")]||n(o)})}return a}}function Wre(t,e){for(let n=0,i=[t];n<i.length;n++){let r=i[n],a=!r.validEnd,d=[];for(let o=0;o<r.next.length;o++){let{type:f,next:g}=r.next[o];d.push(f.name),a&&!(f.isText||f.hasRequiredAttrs())&&(a=!1),i.indexOf(g)==-1&&i.push(g)}a&&e.err("Only non-generatable nodes ("+d.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function c6(t){let e=Object.create(null);for(let n in t){let i=t[n];if(!i.hasDefault)return null;e[n]=i.default}return e}function u6(t,e){let n=Object.create(null);for(let i in t){let r=e&&e[i];if(r===void 0){let a=t[i];if(a.hasDefault)r=a.default;else throw new RangeError("No value supplied for attribute "+i)}n[i]=r}return n}function d6(t){let e=Object.create(null);if(t)for(let n in t)e[n]=new Gre(t[n]);return e}let Dz=class h6{constructor(e,n,i){this.name=e,this.schema=n,this.spec=i,this.markSet=null,this.groups=i.group?i.group.split(" "):[],this.attrs=d6(i.attrs),this.defaultAttrs=c6(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(i.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Dh.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:u6(this.attrs,e)}create(e=null,n,i){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new fh(this,this.computeAttrs(e),Ft.from(n),Oi.setFrom(i))}createChecked(e=null,n,i){return n=Ft.from(n),this.checkContent(n),new fh(this,this.computeAttrs(e),n,Oi.setFrom(i))}createAndFill(e=null,n,i){if(e=this.computeAttrs(e),n=Ft.from(n),n.size){let d=this.contentMatch.fillBefore(n);if(!d)return null;n=d.append(n)}let r=this.contentMatch.matchFragment(n),a=r&&r.fillBefore(Ft.empty,!0);return a?new fh(this,e,n.append(a),Oi.setFrom(i)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let i=0;i<e.childCount;i++)if(!this.allowsMarks(e.child(i).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let i=0;i<e.length;i++)this.allowsMarkType(e[i].type)?n&&n.push(e[i]):n||(n=e.slice(0,i));return n?n.length?n:Oi.none:e}static compile(e,n){let i=Object.create(null);e.forEach((a,d)=>i[a]=new h6(a,n,d));let r=n.spec.topNode||"doc";if(!i[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(let a in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}};class Gre{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class cw{constructor(e,n,i,r){this.name=e,this.rank=n,this.schema=i,this.spec=r,this.attrs=d6(r.attrs),this.excluded=null;let a=c6(this.attrs);this.instance=a?new Oi(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Oi(this,u6(this.attrs,e))}static compile(e,n){let i=Object.create(null),r=0;return e.forEach((a,d)=>i[a]=new cw(a,r++,n,d)),i}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}excludes(e){return this.excluded.indexOf(e)>-1}}class Hre{constructor(e){this.cached=Object.create(null);let n=this.spec={};for(let r in e)n[r]=e[r];n.nodes=yo.from(e.nodes),n.marks=yo.from(e.marks||{}),this.nodes=Dz.compile(this.spec.nodes,this),this.marks=cw.compile(this.spec.marks,this);let i=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let a=this.nodes[r],d=a.spec.content||"",o=a.spec.marks;a.contentMatch=i[d]||(i[d]=Dh.parse(d,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.markSet=o=="_"?null:o?Rz(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let r in this.marks){let a=this.marks[r],d=a.spec.excludes;a.excluded=d==null?[a]:d==""?[]:Rz(this,d.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,i,r){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Dz){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,i,r)}text(e,n){let i=this.nodes.text;return new Vx(i,i.defaultAttrs,e,Oi.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return fh.fromJSON(this,e)}markFromJSON(e){return Oi.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Rz(t,e){let n=[];for(let i=0;i<e.length;i++){let r=e[i],a=t.marks[r],d=a;if(a)n.push(a);else for(let o in t.marks){let f=t.marks[o];(r=="_"||f.spec.group&&f.spec.group.split(" ").indexOf(r)>-1)&&n.push(d=f)}if(!d)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}let kA=class BC{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[],n.forEach(i=>{i.tag?this.tags.push(i):i.style&&this.styles.push(i)}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let r=e.nodes[i.node];return r.contentMatch.matchType(r)})}parse(e,n={}){let i=new zz(this,n,!1);return i.addAll(e,n.from,n.to),i.finish()}parseSlice(e,n={}){let i=new zz(this,n,!0);return i.addAll(e,n.from,n.to),nn.maxOpen(i.finish())}matchTag(e,n,i){for(let r=i?this.tags.indexOf(i)+1:0;r<this.tags.length;r++){let a=this.tags[r];if(Kre(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||n.matchesContext(a.context))){if(a.getAttrs){let d=a.getAttrs(e);if(d===!1)continue;a.attrs=d||void 0}return a}}}matchStyle(e,n,i,r){for(let a=r?this.styles.indexOf(r)+1:0;a<this.styles.length;a++){let d=this.styles[a],o=d.style;if(!(o.indexOf(e)!=0||d.context&&!i.matchesContext(d.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=n))){if(d.getAttrs){let f=d.getAttrs(n);if(f===!1)continue;d.attrs=f||void 0}return d}}}static schemaRules(e){let n=[];function i(r){let a=r.priority==null?50:r.priority,d=0;for(;d<n.length;d++){let o=n[d];if((o.priority==null?50:o.priority)<a)break}n.splice(d,0,r)}for(let r in e.marks){let a=e.marks[r].spec.parseDOM;a&&a.forEach(d=>{i(d=Bz(d)),d.mark||d.ignore||d.clearMark||(d.mark=r)})}for(let r in e.nodes){let a=e.nodes[r].spec.parseDOM;a&&a.forEach(d=>{i(d=Bz(d)),d.node||d.ignore||d.mark||(d.node=r)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new BC(e,BC.schemaRules(e)))}};const f6={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Zre={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},p6={ol:!0,ul:!0},Ux=1,qx=2,Gy=4;function Lz(t,e,n){return e!=null?(e?Ux:0)|(e==="full"?qx:0):t&&t.whitespace=="pre"?Ux|qx:n&~Gy}class Xb{constructor(e,n,i,r,a,d,o){this.type=e,this.attrs=n,this.marks=i,this.pendingMarks=r,this.solid=a,this.options=o,this.content=[],this.activeMarks=Oi.none,this.stashMarks=[],this.match=d||(o&Gy?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Ft.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let i=this.type.contentMatch,r;return(r=i.findWrapping(e.type))?(this.match=i,r):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ux)){let i=this.content[this.content.length-1],r;if(i&&i.isText&&(r=/[ \t\r\n\u000c]+$/.exec(i.text))){let a=i;i.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-r[0].length))}}let n=Ft.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Ft.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}popFromStashMark(e){for(let n=this.stashMarks.length-1;n>=0;n--)if(e.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]}applyPending(e){for(let n=0,i=this.pendingMarks;n<i.length;n++){let r=i[n];(this.type?this.type.allowsMarkType(r.type):Jre(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!f6.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class zz{constructor(e,n,i){this.parser=e,this.options=n,this.isOpen=i,this.open=0;let r=n.topNode,a,d=Lz(null,n.preserveWhitespace,0)|(i?Gy:0);r?a=new Xb(r.type,r.attrs,Oi.none,Oi.none,!0,n.topMatch||r.type.contentMatch,d):i?a=new Xb(null,null,Oi.none,Oi.none,!0,null,d):a=new Xb(e.schema.topNodeType,null,Oi.none,Oi.none,!0,null,d),this.nodes=[a],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,n){let i=e.getAttribute("style");if(!i)return n();let r=this.readStyles(Yre(i));if(!r)return;let[a,d]=r,o=this.top;for(let f=0;f<d.length;f++)this.removePendingMark(d[f],o);for(let f=0;f<a.length;f++)this.addPendingMark(a[f]);n();for(let f=0;f<a.length;f++)this.removePendingMark(a[f],o);for(let f=0;f<d.length;f++)this.addPendingMark(d[f])}addTextNode(e){let n=e.nodeValue,i=this.top;if(i.options&qx||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(i.options&Ux)i.options&qx?n=n.replace(/\r\n?/g,`
`):n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let r=i.content[i.content.length-1],a=e.previousSibling;(!r||a&&a.nodeName=="BR"||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(e)}else this.findInside(e)}addElement(e,n){let i=e.nodeName.toLowerCase(),r;p6.hasOwnProperty(i)&&this.parser.normalizeLists&&Xre(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(r=this.parser.matchTag(e,this,n));if(a?a.ignore:Zre.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let d,o=this.top,f=this.needsBlock;if(f6.hasOwnProperty(i))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),d=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}a&&a.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),d&&this.sync(o),this.needsBlock=f}else this.withStyleRules(e,()=>{this.addElementByRule(e,a,a.consuming===!1?r:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let n=Oi.none,i=Oi.none;for(let r=0;r<e.length;r+=2)for(let a=void 0;;){let d=this.parser.matchStyle(e[r],e[r+1],this,a);if(!d)break;if(d.ignore)return null;if(d.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(o=>{d.clearMark(o)&&(i=o.addToSet(i))}):n=this.parser.schema.marks[d.mark].create(d.attrs).addToSet(n),d.consuming===!1)a=d;else break}return[n,i]}addElementByRule(e,n,i){let r,a,d;n.node?(a=this.parser.schema.nodes[n.node],a.isLeaf?this.insertNode(a.create(n.attrs))||this.leafFallback(e):r=this.enter(a,n.attrs||null,n.preserveWhitespace)):(d=this.parser.schema.marks[n.mark].create(n.attrs),this.addPendingMark(d));let o=this.top;if(a&&a.isLeaf)this.findInside(e);else if(i)this.addElement(e,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(f=>this.insertNode(f));else{let f=e;typeof n.contentElement=="string"?f=e.querySelector(n.contentElement):typeof n.contentElement=="function"?f=n.contentElement(e):n.contentElement&&(f=n.contentElement),this.findAround(e,f,!0),this.addAll(f)}r&&this.sync(o)&&this.open--,d&&this.removePendingMark(d,o)}addAll(e,n,i){let r=n||0;for(let a=n?e.childNodes[n]:e.firstChild,d=i==null?null:e.childNodes[i];a!=d;a=a.nextSibling,++r)this.findAtPoint(e,r),this.addDOM(a);this.findAtPoint(e,r)}findPlace(e){let n,i;for(let r=this.open;r>=0;r--){let a=this.nodes[r],d=a.findWrapping(e);if(d&&(!n||n.length>d.length)&&(n=d,i=a,!d.length)||a.solid)break}if(!n)return!1;this.sync(i);for(let r=0;r<n.length;r++)this.enterInner(n[r],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(e)){this.closeExtra();let n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));let i=n.activeMarks;for(let r=0;r<e.marks.length;r++)(!n.type||n.type.allowsMarkType(e.marks[r].type))&&(i=e.marks[r].addToSet(i));return n.content.push(e.mark(i)),!0}return!1}enter(e,n,i){let r=this.findPlace(e.create(n));return r&&this.enterInner(e,n,!0,i),r}enterInner(e,n=null,i=!1,r){this.closeExtra();let a=this.top;a.applyPending(e),a.match=a.match&&a.match.matchType(e);let d=Lz(e,r,a.options);a.options&Gy&&a.content.length==0&&(d|=Gy),this.nodes.push(new Xb(e,n,a.activeMarks,a.pendingMarks,i,null,d)),this.open++}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let n=this.open;n>=0;n--)if(this.nodes[n]==e)return this.open=n,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let i=this.nodes[n].content;for(let r=i.length-1;r>=0;r--)e+=i[r].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==e&&this.find[i].offset==n&&(this.find[i].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,i){if(e!=n&&this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&n.compareDocumentPosition(this.find[r].node)&(i?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),i=this.options.context,r=!this.isOpen&&(!i||i.parent.type==this.nodes[0].type),a=-(i?i.depth+1:0)+(r?0:1),d=(o,f)=>{for(;o>=0;o--){let g=n[o];if(g==""){if(o==n.length-1||o==0)continue;for(;f>=a;f--)if(d(o-1,f))return!0;return!1}else{let _=f>0||f==0&&r?this.nodes[f].type:i&&f>=a?i.node(f-a).type:null;if(!_||_.name!=g&&_.groups.indexOf(g)==-1)return!1;f--}}return!0};return d(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(let n in this.parser.schema.nodes){let i=this.parser.schema.nodes[n];if(i.isTextblock&&i.defaultAttrs)return i}}addPendingMark(e){let n=Qre(e,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,n){for(let i=this.open;i>=0;i--){let r=this.nodes[i];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);let d=r.popFromStashMark(e);d&&r.type&&r.type.allowsMarkType(d.type)&&(r.activeMarks=d.addToSet(r.activeMarks))}if(r==n)break}}}function Xre(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let i=e.nodeType==1?e.nodeName.toLowerCase():null;i&&p6.hasOwnProperty(i)&&n?(n.appendChild(e),e=n):i=="li"?n=e:i&&(n=null)}}function Kre(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Yre(t){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,n,i=[];for(;n=e.exec(t);)i.push(n[1],n[2].trim());return i}function Bz(t){let e={};for(let n in t)e[n]=t[n];return e}function Jre(t,e){let n=e.schema.nodes;for(let i in n){let r=n[i];if(!r.allowsMarkType(t))continue;let a=[],d=o=>{a.push(o);for(let f=0;f<o.edgeCount;f++){let{type:g,next:_}=o.edge(f);if(g==e||a.indexOf(_)<0&&d(_))return!0}};if(d(r.contentMatch))return!0}}function Qre(t,e){for(let n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}class Sl{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},i){i||(i=gk(n).createDocumentFragment());let r=i,a=[];return e.forEach(d=>{if(a.length||d.marks.length){let o=0,f=0;for(;o<a.length&&f<d.marks.length;){let g=d.marks[f];if(!this.marks[g.type.name]){f++;continue}if(!g.eq(a[o][0])||g.type.spec.spanning===!1)break;o++,f++}for(;o<a.length;)r=a.pop()[1];for(;f<d.marks.length;){let g=d.marks[f++],_=this.serializeMark(g,d.isInline,n);_&&(a.push([g,r]),r.appendChild(_.dom),r=_.contentDOM||_.dom)}}r.appendChild(this.serializeNodeInner(d,n))}),i}serializeNodeInner(e,n){let{dom:i,contentDOM:r}=Sl.renderSpec(gk(n),this.nodes[e.type.name](e));if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,r)}return i}serializeNode(e,n={}){let i=this.serializeNodeInner(e,n);for(let r=e.marks.length-1;r>=0;r--){let a=this.serializeMark(e.marks[r],e.isInline,n);a&&((a.contentDOM||a.dom).appendChild(i),i=a.dom)}return i}serializeMark(e,n,i={}){let r=this.marks[e.type.name];return r&&Sl.renderSpec(gk(i),r(e,n))}static renderSpec(e,n,i=null){if(typeof n=="string")return{dom:e.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;let r=n[0],a=r.indexOf(" ");a>0&&(i=r.slice(0,a),r=r.slice(a+1));let d,o=i?e.createElementNS(i,r):e.createElement(r),f=n[1],g=1;if(f&&typeof f=="object"&&f.nodeType==null&&!Array.isArray(f)){g=2;for(let _ in f)if(f[_]!=null){let w=_.indexOf(" ");w>0?o.setAttributeNS(_.slice(0,w),_.slice(w+1),f[_]):o.setAttribute(_,f[_])}}for(let _=g;_<n.length;_++){let w=n[_];if(w===0){if(_<n.length-1||_>g)throw new RangeError("Content hole must be the only child of its parent node");return{dom:o,contentDOM:o}}else{let{dom:T,contentDOM:A}=Sl.renderSpec(e,w,i);if(o.appendChild(T),A){if(d)throw new RangeError("Multiple content holes");d=A}}}return{dom:o,contentDOM:d}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Sl(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=Fz(e.nodes);return n.text||(n.text=i=>i.text),n}static marksFromSchema(e){return Fz(e.marks)}}function Fz(t){let e={};for(let n in t){let i=t[n].spec.toDOM;i&&(e[n]=i)}return e}function gk(t){return t.document||window.document}const m6=65535,g6=Math.pow(2,16);function eoe(t,e){return t+e*g6}function Nz(t){return t&m6}function toe(t){return(t-(t&m6))/g6}const y6=1,v6=2,k_=4,b6=8;class FC{constructor(e,n,i){this.pos=e,this.delInfo=n,this.recover=i}get deleted(){return(this.delInfo&b6)>0}get deletedBefore(){return(this.delInfo&(y6|k_))>0}get deletedAfter(){return(this.delInfo&(v6|k_))>0}get deletedAcross(){return(this.delInfo&k_)>0}}class zs{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&zs.empty)return zs.empty}recover(e){let n=0,i=Nz(e);if(!this.inverted)for(let r=0;r<i;r++)n+=this.ranges[r*3+2]-this.ranges[r*3+1];return this.ranges[i*3]+n+toe(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,i){let r=0,a=this.inverted?2:1,d=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let f=this.ranges[o]-(this.inverted?r:0);if(f>e)break;let g=this.ranges[o+a],_=this.ranges[o+d],w=f+g;if(e<=w){let T=g?e==f?-1:e==w?1:n:n,A=f+r+(T<0?0:_);if(i)return A;let D=e==(n<0?f:w)?null:eoe(o/3,e-f),z=e==f?v6:e==w?y6:k_;return(n<0?e!=f:e!=w)&&(z|=b6),new FC(A,z,D)}r+=_-g}return i?e+r:new FC(e+r,0,null)}touches(e,n){let i=0,r=Nz(n),a=this.inverted?2:1,d=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let f=this.ranges[o]-(this.inverted?i:0);if(f>e)break;let g=this.ranges[o+a],_=f+g;if(e<=_&&o==r*3)return!0;i+=this.ranges[o+d]-g}return!1}forEach(e){let n=this.inverted?2:1,i=this.inverted?1:2;for(let r=0,a=0;r<this.ranges.length;r+=3){let d=this.ranges[r],o=d-(this.inverted?a:0),f=d+(this.inverted?0:a),g=this.ranges[r+n],_=this.ranges[r+i];e(o,o+g,f,f+_),a+=_-g}}invert(){return new zs(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?zs.empty:new zs(e<0?[0,-e,0]:[0,0,e])}}zs.empty=new zs([]);class Bp{constructor(e=[],n,i=0,r=e.length){this.maps=e,this.mirror=n,this.from=i,this.to=r}slice(e=0,n=this.maps.length){return new Bp(this.maps,this.mirror,e,n)}copy(){return new Bp(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,n){this.to=this.maps.push(e),n!=null&&this.setMirror(this.maps.length-1,n)}appendMapping(e){for(let n=0,i=this.maps.length;n<e.maps.length;n++){let r=e.getMirror(n);this.appendMap(e.maps[n],r!=null&&r<n?i+r:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,i=this.maps.length+e.maps.length;n>=0;n--){let r=e.getMirror(n);this.appendMap(e.maps[n].invert(),r!=null&&r>n?i-r-1:void 0)}}invert(){let e=new Bp;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let i=this.from;i<this.to;i++)e=this.maps[i].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,i){let r=0;for(let a=this.from;a<this.to;a++){let d=this.maps[a],o=d.mapResult(e,n);if(o.recover!=null){let f=this.getMirror(a);if(f!=null&&f>a&&f<this.to){a=f,e=this.maps[f].recover(o.recover);continue}}r|=o.delInfo,e=o.pos}return i?e:new FC(e,r,null)}}const yk=Object.create(null);class $o{getMap(){return zs.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let i=yk[n.stepType];if(!i)throw new RangeError(`No step type ${n.stepType} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in yk)throw new RangeError("Duplicate use of step JSON ID "+e);return yk[e]=n,n.prototype.jsonID=e,n}}class $r{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new $r(e,null)}static fail(e){return new $r(null,e)}static fromReplace(e,n,i,r){try{return $r.ok(e.replace(n,i,r))}catch(a){if(a instanceof Nx)return $r.fail(a.message);throw a}}}function TA(t,e,n){let i=[];for(let r=0;r<t.childCount;r++){let a=t.child(r);a.content.size&&(a=a.copy(TA(a.content,e,a))),a.isInline&&(a=e(a,n,r)),i.push(a)}return Ft.fromArray(i)}class yu extends $o{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=e.resolve(this.from),r=i.node(i.sharedDepth(this.to)),a=new nn(TA(n.content,(d,o)=>!d.isAtom||!o.type.allowsMarkType(this.mark.type)?d:d.mark(this.mark.addToSet(d.marks)),r),n.openStart,n.openEnd);return $r.fromReplace(e,this.from,this.to,a)}invert(){return new El(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new yu(n.pos,i.pos,this.mark)}merge(e){return e instanceof yu&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new yu(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new yu(n.from,n.to,e.markFromJSON(n.mark))}}$o.jsonID("addMark",yu);class El extends $o{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=new nn(TA(n.content,r=>r.mark(this.mark.removeFromSet(r.marks)),e),n.openStart,n.openEnd);return $r.fromReplace(e,this.from,this.to,i)}invert(){return new yu(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new El(n.pos,i.pos,this.mark)}merge(e){return e instanceof El&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new El(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new El(n.from,n.to,e.markFromJSON(n.mark))}}$o.jsonID("removeMark",El);class vu extends $o{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return $r.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return $r.fromReplace(e,this.pos,this.pos+1,new nn(Ft.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let i=this.mark.addToSet(n.marks);if(i.length==n.marks.length){for(let r=0;r<n.marks.length;r++)if(!n.marks[r].isInSet(i))return new vu(this.pos,n.marks[r]);return new vu(this.pos,this.mark)}}return new im(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new vu(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new vu(n.pos,e.markFromJSON(n.mark))}}$o.jsonID("addNodeMark",vu);class im extends $o{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return $r.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return $r.fromReplace(e,this.pos,this.pos+1,new nn(Ft.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new vu(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new im(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new im(n.pos,e.markFromJSON(n.mark))}}$o.jsonID("removeNodeMark",im);class vo extends $o{constructor(e,n,i,r=!1){super(),this.from=e,this.to=n,this.slice=i,this.structure=r}apply(e){return this.structure&&NC(e,this.from,this.to)?$r.fail("Structure replace would overwrite content"):$r.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new zs([this.from,this.to-this.from,this.slice.size])}invert(e){return new vo(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deletedAcross&&i.deletedAcross?null:new vo(n.pos,Math.max(n.pos,i.pos),this.slice)}merge(e){if(!(e instanceof vo)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?nn.empty:new nn(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new vo(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?nn.empty:new nn(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new vo(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new vo(n.from,n.to,nn.fromJSON(e,n.slice),!!n.structure)}}$o.jsonID("replace",vo);class ao extends $o{constructor(e,n,i,r,a,d,o=!1){super(),this.from=e,this.to=n,this.gapFrom=i,this.gapTo=r,this.slice=a,this.insert=d,this.structure=o}apply(e){if(this.structure&&(NC(e,this.from,this.gapFrom)||NC(e,this.gapTo,this.to)))return $r.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return $r.fail("Gap is not a flat range");let i=this.slice.insertAt(this.insert,n.content);return i?$r.fromReplace(e,this.from,this.to,i):$r.fail("Content does not fit in gap")}getMap(){return new zs([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new ao(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1),r=e.map(this.gapFrom,-1),a=e.map(this.gapTo,1);return n.deletedAcross&&i.deletedAcross||r<n.pos||a>i.pos?null:new ao(n.pos,i.pos,r,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ao(n.from,n.to,n.gapFrom,n.gapTo,nn.fromJSON(e,n.slice),n.insert,!!n.structure)}}$o.jsonID("replaceAround",ao);function NC(t,e,n){let i=t.resolve(e),r=n-e,a=i.depth;for(;r>0&&a>0&&i.indexAfter(a)==i.node(a).childCount;)a--,r--;if(r>0){let d=i.node(a).maybeChild(i.indexAfter(a));for(;r>0;){if(!d||d.isLeaf)return!0;d=d.firstChild,r--}}return!1}function noe(t,e,n,i){let r=[],a=[],d,o;t.doc.nodesBetween(e,n,(f,g,_)=>{if(!f.isInline)return;let w=f.marks;if(!i.isInSet(w)&&_.type.allowsMarkType(i.type)){let T=Math.max(g,e),A=Math.min(g+f.nodeSize,n),D=i.addToSet(w);for(let z=0;z<w.length;z++)w[z].isInSet(D)||(d&&d.to==T&&d.mark.eq(w[z])?d.to=A:r.push(d=new El(T,A,w[z])));o&&o.to==T?o.to=A:a.push(o=new yu(T,A,i))}}),r.forEach(f=>t.step(f)),a.forEach(f=>t.step(f))}function ioe(t,e,n,i){let r=[],a=0;t.doc.nodesBetween(e,n,(d,o)=>{if(!d.isInline)return;a++;let f=null;if(i instanceof cw){let g=d.marks,_;for(;_=i.isInSet(g);)(f||(f=[])).push(_),g=_.removeFromSet(g)}else i?i.isInSet(d.marks)&&(f=[i]):f=d.marks;if(f&&f.length){let g=Math.min(o+d.nodeSize,n);for(let _=0;_<f.length;_++){let w=f[_],T;for(let A=0;A<r.length;A++){let D=r[A];D.step==a-1&&w.eq(r[A].style)&&(T=D)}T?(T.to=g,T.step=a):r.push({style:w,from:Math.max(o,e),to:g,step:a})}}}),r.forEach(d=>t.step(new El(d.from,d.to,d.style)))}function roe(t,e,n,i=n.contentMatch){let r=t.doc.nodeAt(e),a=[],d=e+1;for(let o=0;o<r.childCount;o++){let f=r.child(o),g=d+f.nodeSize,_=i.matchType(f.type);if(!_)a.push(new vo(d,g,nn.empty));else{i=_;for(let w=0;w<f.marks.length;w++)n.allowsMarkType(f.marks[w].type)||t.step(new El(d,g,f.marks[w]));if(f.isText&&!n.spec.code){let w,T=/\r?\n|\r/g,A;for(;w=T.exec(f.text);)A||(A=new nn(Ft.from(n.schema.text(" ",n.allowedMarks(f.marks))),0,0)),a.push(new vo(d+w.index,d+w.index+w[0].length,A))}}d=g}if(!i.validEnd){let o=i.fillBefore(Ft.empty,!0);t.replace(d,d,new nn(o,0,0))}for(let o=a.length-1;o>=0;o--)t.step(a[o])}function ooe(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function km(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let i=t.depth;;--i){let r=t.$from.node(i),a=t.$from.index(i),d=t.$to.indexAfter(i);if(i<t.depth&&r.canReplace(a,d,n))return i;if(i==0||r.type.spec.isolating||!ooe(r,a,d))break}return null}function soe(t,e,n){let{$from:i,$to:r,depth:a}=e,d=i.before(a+1),o=r.after(a+1),f=d,g=o,_=Ft.empty,w=0;for(let D=a,z=!1;D>n;D--)z||i.index(D)>0?(z=!0,_=Ft.from(i.node(D).copy(_)),w++):f--;let T=Ft.empty,A=0;for(let D=a,z=!1;D>n;D--)z||r.after(D+1)<r.end(D)?(z=!0,T=Ft.from(r.node(D).copy(T)),A++):g++;t.step(new ao(f,g,d,o,new nn(_.append(T),w,A),_.size-w,!0))}function CA(t,e,n=null,i=t){let r=aoe(t,e),a=r&&loe(i,e);return a?r.map($z).concat({type:e,attrs:n}).concat(a.map($z)):null}function $z(t){return{type:t,attrs:null}}function aoe(t,e){let{parent:n,startIndex:i,endIndex:r}=t,a=n.contentMatchAt(i).findWrapping(e);if(!a)return null;let d=a.length?a[0]:e;return n.canReplaceWith(i,r,d)?a:null}function loe(t,e){let{parent:n,startIndex:i,endIndex:r}=t,a=n.child(i),d=e.contentMatch.findWrapping(a.type);if(!d)return null;let f=(d.length?d[d.length-1]:e).contentMatch;for(let g=i;f&&g<r;g++)f=f.matchType(n.child(g).type);return!f||!f.validEnd?null:d}function coe(t,e,n){let i=Ft.empty;for(let d=n.length-1;d>=0;d--){if(i.size){let o=n[d].type.contentMatch.matchFragment(i);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=Ft.from(n[d].type.create(n[d].attrs,i))}let r=e.start,a=e.end;t.step(new ao(r,a,r,a,new nn(i,0,0),n.length,!0))}function uoe(t,e,n,i,r){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,n,(d,o)=>{if(d.isTextblock&&!d.hasMarkup(i,r)&&doe(t.doc,t.mapping.slice(a).map(o),i)){t.clearIncompatible(t.mapping.slice(a).map(o,1),i);let f=t.mapping.slice(a),g=f.map(o,1),_=f.map(o+d.nodeSize,1);return t.step(new ao(g,_,g+1,_-1,new nn(Ft.from(i.create(r,null,d.marks)),0,0),1,!0)),!1}})}function doe(t,e,n){let i=t.resolve(e),r=i.index();return i.parent.canReplaceWith(r,r+1,n)}function hoe(t,e,n,i,r){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");n||(n=a.type);let d=n.create(i,null,r||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,d);if(!n.validContent(a.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new ao(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new nn(Ft.from(d),0,0),1,!0))}function Fp(t,e,n=1,i){let r=t.resolve(e),a=r.depth-n,d=i&&i[i.length-1]||r.parent;if(a<0||r.parent.type.spec.isolating||!r.parent.canReplace(r.index(),r.parent.childCount)||!d.type.validContent(r.parent.content.cutByIndex(r.index(),r.parent.childCount)))return!1;for(let g=r.depth-1,_=n-2;g>a;g--,_--){let w=r.node(g),T=r.index(g);if(w.type.spec.isolating)return!1;let A=w.content.cutByIndex(T,w.childCount),D=i&&i[_+1];D&&(A=A.replaceChild(0,D.type.create(D.attrs)));let z=i&&i[_]||w;if(!w.canReplace(T+1,w.childCount)||!z.type.validContent(A))return!1}let o=r.indexAfter(a),f=i&&i[0];return r.node(a).canReplaceWith(o,o,f?f.type:r.node(a+1).type)}function foe(t,e,n=1,i){let r=t.doc.resolve(e),a=Ft.empty,d=Ft.empty;for(let o=r.depth,f=r.depth-n,g=n-1;o>f;o--,g--){a=Ft.from(r.node(o).copy(a));let _=i&&i[g];d=Ft.from(_?_.type.create(_.attrs,d):r.node(o).copy(d))}t.step(new vo(e,e,new nn(a.append(d),n,n),!0))}function Ju(t,e){let n=t.resolve(e),i=n.index();return _6(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function _6(t,e){return!!(t&&e&&!t.isLeaf&&t.canAppend(e))}function uw(t,e,n=-1){let i=t.resolve(e);for(let r=i.depth;;r--){let a,d,o=i.index(r);if(r==i.depth?(a=i.nodeBefore,d=i.nodeAfter):n>0?(a=i.node(r+1),o++,d=i.node(r).maybeChild(o)):(a=i.node(r).maybeChild(o-1),d=i.node(r+1)),a&&!a.isTextblock&&_6(a,d)&&i.node(r).canReplace(o,o+1))return e;if(r==0)break;e=n<0?i.before(r):i.after(r)}}function poe(t,e,n){let i=new vo(e-n,e+n,nn.empty,!0);t.step(i)}function moe(t,e,n){let i=t.resolve(e);if(i.parent.canReplaceWith(i.index(),i.index(),n))return e;if(i.parentOffset==0)for(let r=i.depth-1;r>=0;r--){let a=i.index(r);if(i.node(r).canReplaceWith(a,a,n))return i.before(r+1);if(a>0)return null}if(i.parentOffset==i.parent.content.size)for(let r=i.depth-1;r>=0;r--){let a=i.indexAfter(r);if(i.node(r).canReplaceWith(a,a,n))return i.after(r+1);if(a<i.node(r).childCount)return null}return null}function x6(t,e,n){let i=t.resolve(e);if(!n.content.size)return e;let r=n.content;for(let a=0;a<n.openStart;a++)r=r.firstChild.content;for(let a=1;a<=(n.openStart==0&&n.size?2:1);a++)for(let d=i.depth;d>=0;d--){let o=d==i.depth?0:i.pos<=(i.start(d+1)+i.end(d+1))/2?-1:1,f=i.index(d)+(o>0?1:0),g=i.node(d),_=!1;if(a==1)_=g.canReplace(f,f,r);else{let w=g.contentMatchAt(f).findWrapping(r.firstChild.type);_=w&&g.canReplaceWith(f,f,w[0])}if(_)return o==0?i.pos:o<0?i.before(d+1):i.after(d+1)}return null}function IA(t,e,n=e,i=nn.empty){if(e==n&&!i.size)return null;let r=t.resolve(e),a=t.resolve(n);return w6(r,a,i)?new vo(e,n,i):new goe(r,a,i).fit()}function w6(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class goe{constructor(e,n,i){this.$from=e,this.$to=n,this.unplaced=i,this.frontier=[],this.placed=Ft.empty;for(let r=0;r<=e.depth;r++){let a=e.node(r);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=Ft.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let g=this.findFittable();g?this.placeNodes(g):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,i=this.$from,r=this.close(e<0?this.$to:i.doc.resolve(e));if(!r)return null;let a=this.placed,d=i.depth,o=r.depth;for(;d&&o&&a.childCount==1;)a=a.firstChild.content,d--,o--;let f=new nn(a,d,o);return e>-1?new ao(i.pos,e,this.$to.pos,this.$to.end(),f,n):f.size||i.pos!=this.$to.pos?new vo(i.pos,r.pos,f):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,i=0,r=this.unplaced.openEnd;i<e;i++){let a=n.firstChild;if(n.childCount>1&&(r=0),a.type.spec.isolating&&r<=i){e=i;break}n=a.content}for(let n=1;n<=2;n++)for(let i=n==1?e:this.unplaced.openStart;i>=0;i--){let r,a=null;i?(a=vk(this.unplaced.content,i-1).firstChild,r=a.content):r=this.unplaced.content;let d=r.firstChild;for(let o=this.depth;o>=0;o--){let{type:f,match:g}=this.frontier[o],_,w=null;if(n==1&&(d?g.matchType(d.type)||(w=g.fillBefore(Ft.from(d),!1)):a&&f.compatibleContent(a.type)))return{sliceDepth:i,frontierDepth:o,parent:a,inject:w};if(n==2&&d&&(_=g.findWrapping(d.type)))return{sliceDepth:i,frontierDepth:o,parent:a,wrap:_};if(a&&g.matchType(a.type))break}}}openMore(){let{content:e,openStart:n,openEnd:i}=this.unplaced,r=vk(e,n);return!r.childCount||r.firstChild.isLeaf?!1:(this.unplaced=new nn(e,n+1,Math.max(i,r.size+n>=e.size-i?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:i}=this.unplaced,r=vk(e,n);if(r.childCount<=1&&n>0){let a=e.size-n<=n+r.size;this.unplaced=new nn(Cy(e,n-1,1),n-1,a?n-1:i)}else this.unplaced=new nn(Cy(e,n,1),n,i)}placeNodes({sliceDepth:e,frontierDepth:n,parent:i,inject:r,wrap:a}){for(;this.depth>n;)this.closeFrontierNode();if(a)for(let z=0;z<a.length;z++)this.openFrontierNode(a[z]);let d=this.unplaced,o=i?i.content:d.content,f=d.openStart-e,g=0,_=[],{match:w,type:T}=this.frontier[n];if(r){for(let z=0;z<r.childCount;z++)_.push(r.child(z));w=w.matchFragment(r)}let A=o.size+e-(d.content.size-d.openEnd);for(;g<o.childCount;){let z=o.child(g),G=w.matchType(z.type);if(!G)break;g++,(g>1||f==0||z.content.size)&&(w=G,_.push(S6(z.mark(T.allowedMarks(z.marks)),g==1?f:0,g==o.childCount?A:-1)))}let D=g==o.childCount;D||(A=-1),this.placed=Iy(this.placed,n,Ft.from(_)),this.frontier[n].match=w,D&&A<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let z=0,G=o;z<A;z++){let V=G.lastChild;this.frontier.push({type:V.type,match:V.contentMatchAt(V.childCount)}),G=V.content}this.unplaced=D?e==0?nn.empty:new nn(Cy(d.content,e-1,1),e-1,A<0?d.openEnd:e-1):new nn(Cy(d.content,e,g),d.openStart,d.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!bk(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:i}=this.$to,r=this.$to.after(i);for(;i>1&&r==this.$to.end(--i);)++r;return r}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:i,type:r}=this.frontier[n],a=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),d=bk(e,n,r,i,a);if(d){for(let o=n-1;o>=0;o--){let{match:f,type:g}=this.frontier[o],_=bk(e,o,g,f,!0);if(!_||_.childCount)continue e}return{depth:n,fit:d,move:a?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Iy(this.placed,n.depth,n.fit)),e=n.move;for(let i=n.depth+1;i<=e.depth;i++){let r=e.node(i),a=r.type.contentMatch.fillBefore(r.content,!0,e.index(i));this.openFrontierNode(r.type,r.attrs,a)}return e}openFrontierNode(e,n=null,i){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Iy(this.placed,this.depth,Ft.from(e.create(n,i))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Ft.empty,!0);n.childCount&&(this.placed=Iy(this.placed,this.frontier.length,n))}}function Cy(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Cy(t.firstChild.content,e-1,n)))}function Iy(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Iy(t.lastChild.content,e-1,n)))}function vk(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function S6(t,e,n){if(e<=0)return t;let i=t.content;return e>1&&(i=i.replaceChild(0,S6(i.firstChild,e-1,i.childCount==1?n-1:0))),e>0&&(i=t.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(t.type.contentMatch.matchFragment(i).fillBefore(Ft.empty,!0)))),t.copy(i)}function bk(t,e,n,i,r){let a=t.node(e),d=r?t.indexAfter(e):t.index(e);if(d==a.childCount&&!n.compatibleContent(a.type))return null;let o=i.fillBefore(a.content,!0,d);return o&&!yoe(n,a.content,d)?o:null}function yoe(t,e,n){for(let i=n;i<e.childCount;i++)if(!t.allowsMarks(e.child(i).marks))return!0;return!1}function voe(t){return t.spec.defining||t.spec.definingForContent}function boe(t,e,n,i){if(!i.size)return t.deleteRange(e,n);let r=t.doc.resolve(e),a=t.doc.resolve(n);if(w6(r,a,i))return t.step(new vo(e,n,i));let d=k6(r,t.doc.resolve(n));d[d.length-1]==0&&d.pop();let o=-(r.depth+1);d.unshift(o);for(let T=r.depth,A=r.pos-1;T>0;T--,A--){let D=r.node(T).type.spec;if(D.defining||D.definingAsContext||D.isolating)break;d.indexOf(T)>-1?o=T:r.before(T)==A&&d.splice(1,0,-T)}let f=d.indexOf(o),g=[],_=i.openStart;for(let T=i.content,A=0;;A++){let D=T.firstChild;if(g.push(D),A==i.openStart)break;T=D.content}for(let T=_-1;T>=0;T--){let A=g[T],D=voe(A.type);if(D&&!A.sameMarkup(r.node(Math.abs(o)-1)))_=T;else if(D||!A.type.isTextblock)break}for(let T=i.openStart;T>=0;T--){let A=(T+_+1)%(i.openStart+1),D=g[A];if(D)for(let z=0;z<d.length;z++){let G=d[(z+f)%d.length],V=!0;G<0&&(V=!1,G=-G);let N=r.node(G-1),q=r.index(G-1);if(N.canReplaceWith(q,q,D.type,D.marks))return t.replace(r.before(G),V?a.after(G):n,new nn(E6(i.content,0,i.openStart,A),A,i.openEnd))}}let w=t.steps.length;for(let T=d.length-1;T>=0&&(t.replace(e,n,i),!(t.steps.length>w));T--){let A=d[T];A<0||(e=r.before(A),n=a.after(A))}}function E6(t,e,n,i,r){if(e<n){let a=t.firstChild;t=t.replaceChild(0,a.copy(E6(a.content,e+1,n,i,a)))}if(e>i){let a=r.contentMatchAt(0),d=a.fillBefore(t).append(t);t=d.append(a.matchFragment(d).fillBefore(Ft.empty,!0))}return t}function _oe(t,e,n,i){if(!i.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let r=moe(t.doc,e,i.type);r!=null&&(e=n=r)}t.replaceRange(e,n,new nn(Ft.from(i),0,0))}function xoe(t,e,n){let i=t.doc.resolve(e),r=t.doc.resolve(n),a=k6(i,r);for(let d=0;d<a.length;d++){let o=a[d],f=d==a.length-1;if(f&&o==0||i.node(o).type.contentMatch.validEnd)return t.delete(i.start(o),r.end(o));if(o>0&&(f||i.node(o-1).canReplace(i.index(o-1),r.indexAfter(o-1))))return t.delete(i.before(o),r.after(o))}for(let d=1;d<=i.depth&&d<=r.depth;d++)if(e-i.start(d)==i.depth-d&&n>i.end(d)&&r.end(d)-n!=r.depth-d)return t.delete(i.before(d),n);t.delete(e,n)}function k6(t,e){let n=[],i=Math.min(t.depth,e.depth);for(let r=i;r>=0;r--){let a=t.start(r);if(a<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;(a==e.start(r)||r==t.depth&&r==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&r&&e.start(r-1)==a-1)&&n.push(r)}return n}class Np extends $o{constructor(e,n,i){super(),this.pos=e,this.attr=n,this.value=i}apply(e){let n=e.nodeAt(this.pos);if(!n)return $r.fail("No node at attribute step's position");let i=Object.create(null);for(let a in n.attrs)i[a]=n.attrs[a];i[this.attr]=this.value;let r=n.type.create(i,null,n.marks);return $r.fromReplace(e,this.pos,this.pos+1,new nn(Ft.from(r),0,n.isLeaf?0:1))}getMap(){return zs.empty}invert(e){return new Np(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Np(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Np(n.pos,n.attr,n.value)}}$o.jsonID("attr",Np);class kv extends $o{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let r in e.attrs)n[r]=e.attrs[r];n[this.attr]=this.value;let i=e.type.create(n,e.content,e.marks);return $r.ok(i)}getMap(){return zs.empty}invert(e){return new kv(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new kv(n.attr,n.value)}}$o.jsonID("docAttr",kv);let rm=class extends Error{};rm=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};rm.prototype=Object.create(Error.prototype);rm.prototype.constructor=rm;rm.prototype.name="TransformError";class woe{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Bp}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new rm(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,i=nn.empty){let r=IA(this.doc,e,n,i);return r&&this.step(r),this}replaceWith(e,n,i){return this.replace(e,n,new nn(Ft.from(i),0,0))}delete(e,n){return this.replace(e,n,nn.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,i){return boe(this,e,n,i),this}replaceRangeWith(e,n,i){return _oe(this,e,n,i),this}deleteRange(e,n){return xoe(this,e,n),this}lift(e,n){return soe(this,e,n),this}join(e,n=1){return poe(this,e,n),this}wrap(e,n){return coe(this,e,n),this}setBlockType(e,n=e,i,r=null){return uoe(this,e,n,i,r),this}setNodeMarkup(e,n,i=null,r){return hoe(this,e,n,i,r),this}setNodeAttribute(e,n,i){return this.step(new Np(e,n,i)),this}setDocAttribute(e,n){return this.step(new kv(e,n)),this}addNodeMark(e,n){return this.step(new vu(e,n)),this}removeNodeMark(e,n){if(!(n instanceof Oi)){let i=this.doc.nodeAt(e);if(!i)throw new RangeError("No node at position "+e);if(n=n.isInSet(i.marks),!n)return this}return this.step(new im(e,n)),this}split(e,n=1,i){return foe(this,e,n,i),this}addMark(e,n,i){return noe(this,e,n,i),this}removeMark(e,n,i){return ioe(this,e,n,i),this}clearIncompatible(e,n,i){return roe(this,e,n,i),this}}const _k=Object.create(null);class $n{constructor(e,n,i){this.$anchor=e,this.$head=n,this.ranges=i||[new Soe(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=nn.empty){let i=n.content.lastChild,r=null;for(let o=0;o<n.openEnd;o++)r=i,i=i.lastChild;let a=e.steps.length,d=this.ranges;for(let o=0;o<d.length;o++){let{$from:f,$to:g}=d[o],_=e.mapping.slice(a);e.replaceRange(_.map(f.pos),_.map(g.pos),o?nn.empty:n),o==0&&Uz(e,a,(i?i.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,n){let i=e.steps.length,r=this.ranges;for(let a=0;a<r.length;a++){let{$from:d,$to:o}=r[a],f=e.mapping.slice(i),g=f.map(d.pos),_=f.map(o.pos);a?e.deleteRange(g,_):(e.replaceRangeWith(g,_,n),Uz(e,i,n.isInline?-1:1))}}static findFrom(e,n,i=!1){let r=e.parent.inlineContent?new Bn(e):rp(e.node(0),e.parent,e.pos,e.index(),n,i);if(r)return r;for(let a=e.depth-1;a>=0;a--){let d=n<0?rp(e.node(0),e.node(a),e.before(a+1),e.index(a),n,i):rp(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,n,i);if(d)return d}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Ja(e.node(0))}static atStart(e){return rp(e,e,0,0,1)||new Ja(e)}static atEnd(e){return rp(e,e,e.content.size,e.childCount,-1)||new Ja(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let i=_k[n.type];if(!i)throw new RangeError(`No selection type ${n.type} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in _k)throw new RangeError("Duplicate use of selection JSON ID "+e);return _k[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Bn.between(this.$anchor,this.$head).getBookmark()}}$n.prototype.visible=!0;class Soe{constructor(e,n){this.$from=e,this.$to=n}}let jz=!1;function Vz(t){!jz&&!t.parent.inlineContent&&(jz=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Bn extends $n{constructor(e,n=e){Vz(e),Vz(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let i=e.resolve(n.map(this.head));if(!i.parent.inlineContent)return $n.near(i);let r=e.resolve(n.map(this.anchor));return new Bn(r.parent.inlineContent?r:i,i)}replace(e,n=nn.empty){if(super.replace(e,n),n==nn.empty){let i=this.$from.marksAcross(this.$to);i&&e.ensureMarks(i)}}eq(e){return e instanceof Bn&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new dw(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Bn(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,i=n){let r=e.resolve(n);return new this(r,i==n?r:e.resolve(i))}static between(e,n,i){let r=e.pos-n.pos;if((!i||r)&&(i=r>=0?1:-1),!n.parent.inlineContent){let a=$n.findFrom(n,i,!0)||$n.findFrom(n,-i,!0);if(a)n=a.$head;else return $n.near(n,i)}return e.parent.inlineContent||(r==0?e=n:(e=($n.findFrom(e,-i,!0)||$n.findFrom(e,i,!0)).$anchor,e.pos<n.pos!=r<0&&(e=n))),new Bn(e,n)}}$n.jsonID("text",Bn);class dw{constructor(e,n){this.anchor=e,this.head=n}map(e){return new dw(e.map(this.anchor),e.map(this.head))}resolve(e){return Bn.between(e.resolve(this.anchor),e.resolve(this.head))}}class Cn extends $n{constructor(e){let n=e.nodeAfter,i=e.node(0).resolve(e.pos+n.nodeSize);super(e,i),this.node=n}map(e,n){let{deleted:i,pos:r}=n.mapResult(this.anchor),a=e.resolve(r);return i?$n.near(a):new Cn(a)}content(){return new nn(Ft.from(this.node),0,0)}eq(e){return e instanceof Cn&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new AA(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Cn(e.resolve(n.anchor))}static create(e,n){return new Cn(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Cn.prototype.visible=!1;$n.jsonID("node",Cn);class AA{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:i}=e.mapResult(this.anchor);return n?new dw(i,i):new AA(i)}resolve(e){let n=e.resolve(this.anchor),i=n.nodeAfter;return i&&Cn.isSelectable(i)?new Cn(n):$n.near(n)}}class Ja extends $n{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=nn.empty){if(n==nn.empty){e.delete(0,e.doc.content.size);let i=$n.atStart(e.doc);i.eq(e.selection)||e.setSelection(i)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Ja(e)}map(e){return new Ja(e)}eq(e){return e instanceof Ja}getBookmark(){return Eoe}}$n.jsonID("all",Ja);const Eoe={map(){return this},resolve(t){return new Ja(t)}};function rp(t,e,n,i,r,a=!1){if(e.inlineContent)return Bn.create(t,n);for(let d=i-(r>0?0:1);r>0?d<e.childCount:d>=0;d+=r){let o=e.child(d);if(o.isAtom){if(!a&&Cn.isSelectable(o))return Cn.create(t,n-(r<0?o.nodeSize:0))}else{let f=rp(t,o,n+r,r<0?o.childCount:0,r,a);if(f)return f}n+=o.nodeSize*r}return null}function Uz(t,e,n){let i=t.steps.length-1;if(i<e)return;let r=t.steps[i];if(!(r instanceof vo||r instanceof ao))return;let a=t.mapping.maps[i],d;a.forEach((o,f,g,_)=>{d==null&&(d=_)}),t.setSelection($n.near(t.doc.resolve(d),n))}const qz=1,Kb=2,Wz=4;class koe extends woe{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|qz)&~Kb,this.storedMarks=null,this}get selectionSet(){return(this.updated&qz)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Kb,this}ensureMarks(e){return Oi.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Kb)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Kb,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let i=this.selection;return n&&(e=e.mark(this.storedMarks||(i.empty?i.$from.marks():i.$from.marksAcross(i.$to)||Oi.none))),i.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,i){let r=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(i==null&&(i=n),i=i==null?n:i,!e)return this.deleteRange(n,i);let a=this.storedMarks;if(!a){let d=this.doc.resolve(n);a=i==n?d.marks():d.marksAcross(this.doc.resolve(i))}return this.replaceRangeWith(n,i,r.text(e,a)),this.selection.empty||this.setSelection($n.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Wz,this}get scrolledIntoView(){return(this.updated&Wz)>0}}function Gz(t,e){return!e||!t?t:t.bind(e)}class Ay{constructor(e,n,i){this.name=e,this.init=Gz(n.init,i),this.apply=Gz(n.apply,i)}}const Toe=[new Ay("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Ay("selection",{init(t,e){return t.selection||$n.atStart(e.doc)},apply(t){return t.selection}}),new Ay("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,i){return i.selection.$cursor?t.storedMarks:null}}),new Ay("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class xk{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Toe.slice(),n&&n.forEach(i=>{if(this.pluginsByKey[i.key])throw new RangeError("Adding different instances of a keyed plugin ("+i.key+")");this.plugins.push(i),this.pluginsByKey[i.key]=i,i.spec.state&&this.fields.push(new Ay(i.key,i.spec.state,i))})}}class xp{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=n){let r=this.config.plugins[i];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],i=this.applyInner(e),r=null;for(;;){let a=!1;for(let d=0;d<this.config.plugins.length;d++){let o=this.config.plugins[d];if(o.spec.appendTransaction){let f=r?r[d].n:0,g=r?r[d].state:this,_=f<n.length&&o.spec.appendTransaction.call(o,f?n.slice(f):n,g,i);if(_&&i.filterTransaction(_,d)){if(_.setMeta("appendedTransaction",e),!r){r=[];for(let w=0;w<this.config.plugins.length;w++)r.push(w<d?{state:i,n:n.length}:{state:this,n:0})}n.push(_),i=i.applyInner(_),a=!0}r&&(r[d]={state:i,n:n.length})}}if(!a)return{state:i,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new xp(this.config),i=this.config.fields;for(let r=0;r<i.length;r++){let a=i[r];n[a.name]=a.apply(e,this[a.name],this,n)}return n}get tr(){return new koe(this)}static create(e){let n=new xk(e.doc?e.doc.type.schema:e.schema,e.plugins),i=new xp(n);for(let r=0;r<n.fields.length;r++)i[n.fields[r].name]=n.fields[r].init(e,i);return i}reconfigure(e){let n=new xk(this.schema,e.plugins),i=n.fields,r=new xp(n);for(let a=0;a<i.length;a++){let d=i[a].name;r[d]=this.hasOwnProperty(d)?this[d]:i[a].init(e,r)}return r}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(i=>i.toJSON())),e&&typeof e=="object")for(let i in e){if(i=="doc"||i=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[i],a=r.spec.state;a&&a.toJSON&&(n[i]=a.toJSON.call(r,this[r.key]))}return n}static fromJSON(e,n,i){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new xk(e.schema,e.plugins),a=new xp(r);return r.fields.forEach(d=>{if(d.name=="doc")a.doc=fh.fromJSON(e.schema,n.doc);else if(d.name=="selection")a.selection=$n.fromJSON(a.doc,n.selection);else if(d.name=="storedMarks")n.storedMarks&&(a.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(i)for(let o in i){let f=i[o],g=f.spec.state;if(f.key==d.name&&g&&g.fromJSON&&Object.prototype.hasOwnProperty.call(n,o)){a[d.name]=g.fromJSON.call(f,e,n[o],a);return}}a[d.name]=d.init(e,a)}}),a}}function T6(t,e,n){for(let i in t){let r=t[i];r instanceof Function?r=r.bind(e):i=="handleDOMEvents"&&(r=T6(r,e,{})),n[i]=r}return n}class ya{constructor(e){this.spec=e,this.props={},e.props&&T6(e.props,this,this.props),this.key=e.key?e.key.key:C6("plugin")}getState(e){return e[this.key]}}const wk=Object.create(null);function C6(t){return t in wk?t+"$"+ ++wk[t]:(wk[t]=0,t+"$")}class Qu{constructor(e="key"){this.key=C6(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Xo=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Tv=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let Hz=null;const ic=function(t,e,n){let i=Hz||(Hz=document.createRange());return i.setEnd(t,n==null?t.nodeValue.length:n),i.setStart(t,e||0),i},Rh=function(t,e,n,i){return n&&(Zz(t,e,n,i,-1)||Zz(t,e,n,i,1))},Coe=/^(img|br|input|textarea|hr)$/i;function Zz(t,e,n,i,r){for(;;){if(t==n&&e==i)return!0;if(e==(r<0?0:xl(t))){let a=t.parentNode;if(!a||a.nodeType!=1||MA(t)||Coe.test(t.nodeName)||t.contentEditable=="false")return!1;e=Xo(t)+(r<0?0:1),t=a}else if(t.nodeType==1){if(t=t.childNodes[e+(r<0?-1:0)],t.contentEditable=="false")return!1;e=r<0?xl(t):0}else return!1}}function xl(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Ioe(t,e,n){for(let i=e==0,r=e==xl(t);i||r;){if(t==n)return!0;let a=Xo(t);if(t=t.parentNode,!t)return!1;i=i&&a==0,r=r&&a==xl(t)}}function MA(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const hw=function(t){return t.focusNode&&Rh(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Kd(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function Aoe(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Moe(t,e,n){if(t.caretPositionFromPoint)try{let i=t.caretPositionFromPoint(e,n);if(i)return{node:i.offsetNode,offset:i.offset}}catch(i){}if(t.caretRangeFromPoint){let i=t.caretRangeFromPoint(e,n);if(i)return{node:i.startContainer,offset:i.startOffset}}}const Ol=typeof navigator<"u"?navigator:null,Xz=typeof document<"u"?document:null,ed=Ol&&Ol.userAgent||"",$C=/Edge\/(\d+)/.exec(ed),I6=/MSIE \d/.exec(ed),jC=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ed),ws=!!(I6||jC||$C),Mu=I6?document.documentMode:jC?+jC[1]:$C?+$C[1]:0,el=!ws&&/gecko\/(\d+)/i.test(ed);el&&+(/Firefox\/(\d+)/.exec(ed)||[0,0])[1];const VC=!ws&&/Chrome\/(\d+)/.exec(ed),zo=!!VC,Poe=VC?+VC[1]:0,Yo=!ws&&!!Ol&&/Apple Computer/.test(Ol.vendor),om=Yo&&(/Mobile\/\w+/.test(ed)||!!Ol&&Ol.maxTouchPoints>2),ra=om||(Ol?/Mac/.test(Ol.platform):!1),Ooe=Ol?/Win/.test(Ol.platform):!1,qa=/Android \d/.test(ed),Hv=!!Xz&&"webkitFontSmoothing"in Xz.documentElement.style,Doe=Hv?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Roe(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function ec(t,e){return typeof t=="number"?t:t[e]}function Loe(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,i=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*i}}function Kz(t,e,n){let i=t.someProp("scrollThreshold")||0,r=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let d=n||t.dom;d;d=Tv(d)){if(d.nodeType!=1)continue;let o=d,f=o==a.body,g=f?Roe(a):Loe(o),_=0,w=0;if(e.top<g.top+ec(i,"top")?w=-(g.top-e.top+ec(r,"top")):e.bottom>g.bottom-ec(i,"bottom")&&(w=e.bottom-e.top>g.bottom-g.top?e.top+ec(r,"top")-g.top:e.bottom-g.bottom+ec(r,"bottom")),e.left<g.left+ec(i,"left")?_=-(g.left-e.left+ec(r,"left")):e.right>g.right-ec(i,"right")&&(_=e.right-g.right+ec(r,"right")),_||w)if(f)a.defaultView.scrollBy(_,w);else{let T=o.scrollLeft,A=o.scrollTop;w&&(o.scrollTop+=w),_&&(o.scrollLeft+=_);let D=o.scrollLeft-T,z=o.scrollTop-A;e={left:e.left-D,top:e.top-z,right:e.right-D,bottom:e.bottom-z}}if(f||/^(fixed|sticky)$/.test(getComputedStyle(d).position))break}}function zoe(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),i,r;for(let a=(e.left+e.right)/2,d=n+1;d<Math.min(innerHeight,e.bottom);d+=5){let o=t.root.elementFromPoint(a,d);if(!o||o==t.dom||!t.dom.contains(o))continue;let f=o.getBoundingClientRect();if(f.top>=n-20){i=o,r=f.top;break}}return{refDOM:i,refTop:r,stack:A6(t.dom)}}function A6(t){let e=[],n=t.ownerDocument;for(let i=t;i&&(e.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),t!=n);i=Tv(i));return e}function Boe({refDOM:t,refTop:e,stack:n}){let i=t?t.getBoundingClientRect().top:0;M6(n,i==0?0:i-e)}function M6(t,e){for(let n=0;n<t.length;n++){let{dom:i,top:r,left:a}=t[n];i.scrollTop!=r+e&&(i.scrollTop=r+e),i.scrollLeft!=a&&(i.scrollLeft=a)}}let Wf=null;function Foe(t){if(t.setActive)return t.setActive();if(Wf)return t.focus(Wf);let e=A6(t);t.focus(Wf==null?{get preventScroll(){return Wf={preventScroll:!0},!0}}:void 0),Wf||(Wf=!1,M6(e,0))}function P6(t,e){let n,i=2e8,r,a=0,d=e.top,o=e.top,f,g;for(let _=t.firstChild,w=0;_;_=_.nextSibling,w++){let T;if(_.nodeType==1)T=_.getClientRects();else if(_.nodeType==3)T=ic(_).getClientRects();else continue;for(let A=0;A<T.length;A++){let D=T[A];if(D.top<=d&&D.bottom>=o){d=Math.max(D.bottom,d),o=Math.min(D.top,o);let z=D.left>e.left?D.left-e.left:D.right<e.left?e.left-D.right:0;if(z<i){n=_,i=z,r=z&&n.nodeType==3?{left:D.right<e.left?D.right:D.left,top:e.top}:e,_.nodeType==1&&z&&(a=w+(e.left>=(D.left+D.right)/2?1:0));continue}}else D.top>e.top&&!f&&D.left<=e.left&&D.right>=e.left&&(f=_,g={left:Math.max(D.left,Math.min(D.right,e.left)),top:D.top});!n&&(e.left>=D.right&&e.top>=D.top||e.left>=D.left&&e.top>=D.bottom)&&(a=w+1)}}return!n&&f&&(n=f,r=g,i=0),n&&n.nodeType==3?Noe(n,r):!n||i&&n.nodeType==1?{node:t,offset:a}:P6(n,r)}function Noe(t,e){let n=t.nodeValue.length,i=document.createRange();for(let r=0;r<n;r++){i.setEnd(t,r+1),i.setStart(t,r);let a=tu(i,1);if(a.top!=a.bottom&&PA(e,a))return{node:t,offset:r+(e.left>=(a.left+a.right)/2?1:0)}}return{node:t,offset:0}}function PA(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function $oe(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function joe(t,e,n){let{node:i,offset:r}=P6(e,n),a=-1;if(i.nodeType==1&&!i.firstChild){let d=i.getBoundingClientRect();a=d.left!=d.right&&n.left>(d.left+d.right)/2?1:-1}return t.docView.posFromDOM(i,r,a)}function Voe(t,e,n,i){let r=-1;for(let a=e,d=!1;a!=t.dom;){let o=t.docView.nearestDesc(a,!0);if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent&&!d||!o.contentDOM)){let f=o.dom.getBoundingClientRect();if(o.node.isBlock&&o.parent&&!d&&(d=!0,f.left>i.left||f.top>i.top?r=o.posBefore:(f.right<i.left||f.bottom<i.top)&&(r=o.posAfter)),!o.contentDOM&&r<0&&!o.node.isText)return(o.node.isBlock?i.top<(f.top+f.bottom)/2:i.left<(f.left+f.right)/2)?o.posBefore:o.posAfter}a=o.dom.parentNode}return r>-1?r:t.docView.posFromDOM(e,n,-1)}function O6(t,e,n){let i=t.childNodes.length;if(i&&n.top<n.bottom)for(let r=Math.max(0,Math.min(i-1,Math.floor(i*(e.top-n.top)/(n.bottom-n.top))-2)),a=r;;){let d=t.childNodes[a];if(d.nodeType==1){let o=d.getClientRects();for(let f=0;f<o.length;f++){let g=o[f];if(PA(e,g))return O6(d,e,g)}}if((a=(a+1)%i)==r)break}return t}function Uoe(t,e){let n=t.dom.ownerDocument,i,r=0,a=Moe(n,e.left,e.top);a&&({node:i,offset:r}=a);let d=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),o;if(!d||!t.dom.contains(d.nodeType!=1?d.parentNode:d)){let g=t.dom.getBoundingClientRect();if(!PA(e,g)||(d=O6(t.dom,e,g),!d))return null}if(Yo)for(let g=d;i&&g;g=Tv(g))g.draggable&&(i=void 0);if(d=$oe(d,e),i){if(el&&i.nodeType==1&&(r=Math.min(r,i.childNodes.length),r<i.childNodes.length)){let _=i.childNodes[r],w;_.nodeName=="IMG"&&(w=_.getBoundingClientRect()).right<=e.left&&w.bottom>e.top&&r++}let g;Hv&&r&&i.nodeType==1&&(g=i.childNodes[r-1]).nodeType==1&&g.contentEditable=="false"&&g.getBoundingClientRect().top>=e.top&&r--,i==t.dom&&r==i.childNodes.length-1&&i.lastChild.nodeType==1&&e.top>i.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(r==0||i.nodeType!=1||i.childNodes[r-1].nodeName!="BR")&&(o=Voe(t,i,r,e))}o==null&&(o=joe(t,d,e));let f=t.docView.nearestDesc(d,!0);return{pos:o,inside:f?f.posAtStart-f.border:-1}}function Yz(t){return t.top<t.bottom||t.left<t.right}function tu(t,e){let n=t.getClientRects();if(n.length){let i=n[e<0?0:n.length-1];if(Yz(i))return i}return Array.prototype.find.call(n,Yz)||t.getBoundingClientRect()}const qoe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function D6(t,e,n){let{node:i,offset:r,atom:a}=t.docView.domFromPos(e,n<0?-1:1),d=Hv||el;if(i.nodeType==3)if(d&&(qoe.test(i.nodeValue)||(n<0?!r:r==i.nodeValue.length))){let f=tu(ic(i,r,r),n);if(el&&r&&/\s/.test(i.nodeValue[r-1])&&r<i.nodeValue.length){let g=tu(ic(i,r-1,r-1),-1);if(g.top==f.top){let _=tu(ic(i,r,r+1),-1);if(_.top!=f.top)return my(_,_.left<g.left)}}return f}else{let f=r,g=r,_=n<0?1:-1;return n<0&&!r?(g++,_=-1):n>=0&&r==i.nodeValue.length?(f--,_=1):n<0?f--:g++,my(tu(ic(i,f,g),_),_<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&r&&(n<0||r==xl(i))){let f=i.childNodes[r-1];if(f.nodeType==1)return Sk(f.getBoundingClientRect(),!1)}if(a==null&&r<xl(i)){let f=i.childNodes[r];if(f.nodeType==1)return Sk(f.getBoundingClientRect(),!0)}return Sk(i.getBoundingClientRect(),n>=0)}if(a==null&&r&&(n<0||r==xl(i))){let f=i.childNodes[r-1],g=f.nodeType==3?ic(f,xl(f)-(d?0:1)):f.nodeType==1&&(f.nodeName!="BR"||!f.nextSibling)?f:null;if(g)return my(tu(g,1),!1)}if(a==null&&r<xl(i)){let f=i.childNodes[r];for(;f.pmViewDesc&&f.pmViewDesc.ignoreForCoords;)f=f.nextSibling;let g=f?f.nodeType==3?ic(f,0,d?0:1):f.nodeType==1?f:null:null;if(g)return my(tu(g,-1),!0)}return my(tu(i.nodeType==3?ic(i):i,-n),n>=0)}function my(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Sk(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function R6(t,e,n){let i=t.state,r=t.root.activeElement;i!=e&&t.updateState(e),r!=t.dom&&t.focus();try{return n()}finally{i!=e&&t.updateState(i),r!=t.dom&&r&&r.focus()}}function Woe(t,e,n){let i=e.selection,r=n=="up"?i.$from:i.$to;return R6(t,e,()=>{let{node:a}=t.docView.domFromPos(r.pos,n=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let d=D6(t,r.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let f;if(o.nodeType==1)f=o.getClientRects();else if(o.nodeType==3)f=ic(o,0,o.nodeValue.length).getClientRects();else continue;for(let g=0;g<f.length;g++){let _=f[g];if(_.bottom>_.top+1&&(n=="up"?d.top-_.top>(_.bottom-d.top)*2:_.bottom-d.bottom>(d.bottom-_.top)*2))return!1}}return!0})}const Goe=/[\u0590-\u08ac]/;function Hoe(t,e,n){let{$head:i}=e.selection;if(!i.parent.isTextblock)return!1;let r=i.parentOffset,a=!r,d=r==i.parent.content.size,o=t.domSelection();return!Goe.test(i.parent.textContent)||!o.modify?n=="left"||n=="backward"?a:d:R6(t,e,()=>{let{focusNode:f,focusOffset:g,anchorNode:_,anchorOffset:w}=t.domSelectionRange(),T=o.caretBidiLevel;o.modify("move",n,"character");let A=i.depth?t.docView.domAfterPos(i.before()):t.dom,{focusNode:D,focusOffset:z}=t.domSelectionRange(),G=D&&!A.contains(D.nodeType==1?D:D.parentNode)||f==D&&g==z;try{o.collapse(_,w),f&&(f!=_||g!=w)&&o.extend&&o.extend(f,g)}catch(V){}return T!=null&&(o.caretBidiLevel=T),G})}let Jz=null,Qz=null,e3=!1;function Zoe(t,e,n){return Jz==e&&Qz==n?e3:(Jz=e,Qz=n,e3=n=="up"||n=="down"?Woe(t,e,n):Hoe(t,e,n))}const ha=0,t3=1,nh=2,Dl=3;class Zv{constructor(e,n,i,r){this.parent=e,this.children=n,this.dom=i,this.contentDOM=r,this.dirty=ha,i.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,i){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,i=this.posAtStart;;n++){let r=this.children[n];if(r==e)return i;i+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,i){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(i<0){let a,d;if(e==this.contentDOM)a=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((d=a.pmViewDesc)&&d.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(d)+d.size:this.posAtStart}else{let a,d;if(e==this.contentDOM)a=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((d=a.pmViewDesc)&&d.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(d):this.posAtEnd}let r;if(e==this.dom&&this.contentDOM)r=n>Xo(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let a=e;;a=a.parentNode){if(a==this.dom){r=!1;break}if(a.previousSibling)break}if(r==null&&n==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){r=!0;break}if(a.nextSibling)break}}return(r==null?i>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let i=!0,r=e;r;r=r.parentNode){let a=this.getDesc(r),d;if(a&&(!n||a.node))if(i&&(d=a.nodeDOM)&&!(d.nodeType==1?d.contains(e.nodeType==1?e:e.parentNode):d==e))i=!1;else return a}}getDesc(e){let n=e.pmViewDesc;for(let i=n;i;i=i.parent)if(i==this)return n}posFromDOM(e,n,i){for(let r=e;r;r=r.parentNode){let a=this.getDesc(r);if(a)return a.localPosFromDOM(e,n,i)}return-1}descAt(e){for(let n=0,i=0;n<this.children.length;n++){let r=this.children[n],a=i+r.size;if(i==e&&a!=i){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<a)return r.descAt(e-i-r.border);i=a}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let i=0,r=0;for(let a=0;i<this.children.length;i++){let d=this.children[i],o=a+d.size;if(o>e||d instanceof z6){r=e-a;break}a=o}if(r)return this.children[i].domFromPos(r-this.children[i].border,n);for(let a;i&&!(a=this.children[i-1]).size&&a instanceof L6&&a.side>=0;i--);if(n<=0){let a,d=!0;for(;a=i?this.children[i-1]:null,!(!a||a.dom.parentNode==this.contentDOM);i--,d=!1);return a&&n&&d&&!a.border&&!a.domAtom?a.domFromPos(a.size,n):{node:this.contentDOM,offset:a?Xo(a.dom)+1:0}}else{let a,d=!0;for(;a=i<this.children.length?this.children[i]:null,!(!a||a.dom.parentNode==this.contentDOM);i++,d=!1);return a&&d&&!a.border&&!a.domAtom?a.domFromPos(0,n):{node:this.contentDOM,offset:a?Xo(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,i=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,a=-1;for(let d=i,o=0;;o++){let f=this.children[o],g=d+f.size;if(r==-1&&e<=g){let _=d+f.border;if(e>=_&&n<=g-f.border&&f.node&&f.contentDOM&&this.contentDOM.contains(f.contentDOM))return f.parseRange(e,n,_);e=d;for(let w=o;w>0;w--){let T=this.children[w-1];if(T.size&&T.dom.parentNode==this.contentDOM&&!T.emptyChildAt(1)){r=Xo(T.dom)+1;break}e-=T.size}r==-1&&(r=0)}if(r>-1&&(g>n||o==this.children.length-1)){n=g;for(let _=o+1;_<this.children.length;_++){let w=this.children[_];if(w.size&&w.dom.parentNode==this.contentDOM&&!w.emptyChildAt(-1)){a=Xo(w.dom);break}n+=w.size}a==-1&&(a=this.contentDOM.childNodes.length);break}d=g}return{node:this.contentDOM,from:e,to:n,fromOffset:r,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:i}=this.domFromPos(e,0);if(n.nodeType!=1||i==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[i]}setSelection(e,n,i,r=!1){let a=Math.min(e,n),d=Math.max(e,n);for(let T=0,A=0;T<this.children.length;T++){let D=this.children[T],z=A+D.size;if(a>A&&d<z)return D.setSelection(e-A-D.border,n-A-D.border,i,r);A=z}let o=this.domFromPos(e,e?-1:1),f=n==e?o:this.domFromPos(n,n?-1:1),g=i.getSelection(),_=!1;if((el||Yo)&&e==n){let{node:T,offset:A}=o;if(T.nodeType==3){if(_=!!(A&&T.nodeValue[A-1]==`
`),_&&A==T.nodeValue.length)for(let D=T,z;D;D=D.parentNode){if(z=D.nextSibling){z.nodeName=="BR"&&(o=f={node:z.parentNode,offset:Xo(z)+1});break}let G=D.pmViewDesc;if(G&&G.node&&G.node.isBlock)break}}else{let D=T.childNodes[A-1];_=D&&(D.nodeName=="BR"||D.contentEditable=="false")}}if(el&&g.focusNode&&g.focusNode!=f.node&&g.focusNode.nodeType==1){let T=g.focusNode.childNodes[g.focusOffset];T&&T.contentEditable=="false"&&(r=!0)}if(!(r||_&&Yo)&&Rh(o.node,o.offset,g.anchorNode,g.anchorOffset)&&Rh(f.node,f.offset,g.focusNode,g.focusOffset))return;let w=!1;if((g.extend||e==n)&&!_){g.collapse(o.node,o.offset);try{e!=n&&g.extend(f.node,f.offset),w=!0}catch(T){}}if(!w){if(e>n){let A=o;o=f,f=A}let T=document.createRange();T.setEnd(f.node,f.offset),T.setStart(o.node,o.offset),g.removeAllRanges(),g.addRange(T)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let i=0,r=0;r<this.children.length;r++){let a=this.children[r],d=i+a.size;if(i==d?e<=d&&n>=i:e<d&&n>i){let o=i+a.border,f=d-a.border;if(e>=o&&n<=f){this.dirty=e==i||n==d?nh:t3,e==o&&n==f&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=Dl:a.markDirty(e-o,n-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?nh:Dl}i=d}this.dirty=nh}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let i=e==1?nh:t3;n.dirty<i&&(n.dirty=i)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class L6 extends Zv{constructor(e,n,i,r){let a,d=n.type.toDOM;if(typeof d=="function"&&(d=d(i,()=>{if(!a)return r;if(a.parent)return a.parent.posBeforeChild(a)})),!n.type.spec.raw){if(d.nodeType!=1){let o=document.createElement("span");o.appendChild(d),d=o}d.contentEditable="false",d.classList.add("ProseMirror-widget")}super(e,[],d,null),this.widget=n,this.widget=n,a=this}matchesWidget(e){return this.dirty==ha&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Xoe extends Zv{constructor(e,n,i,r){super(e,[],n,null),this.textDOM=i,this.text=r}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Lh extends Zv{constructor(e,n,i,r){super(e,[],i,r),this.mark=n}static create(e,n,i,r){let a=r.nodeViews[n.type.name],d=a&&a(n,r,i);return(!d||!d.dom)&&(d=Sl.renderSpec(document,n.type.spec.toDOM(n,i))),new Lh(e,n,d.dom,d.contentDOM||d.dom)}parseRule(){return this.dirty&Dl||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Dl&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=ha){let i=this.parent;for(;!i.node;)i=i.parent;i.dirty<this.dirty&&(i.dirty=this.dirty),this.dirty=ha}}slice(e,n,i){let r=Lh.create(this.parent,this.mark,!0,i),a=this.children,d=this.size;n<d&&(a=WC(a,n,d,i)),e>0&&(a=WC(a,0,e,i));for(let o=0;o<a.length;o++)a[o].parent=r;return r.children=a,r}}class Pu extends Zv{constructor(e,n,i,r,a,d,o,f,g){super(e,[],a,d),this.node=n,this.outerDeco=i,this.innerDeco=r,this.nodeDOM=o}static create(e,n,i,r,a,d){let o=a.nodeViews[n.type.name],f,g=o&&o(n,a,()=>{if(!f)return d;if(f.parent)return f.parent.posBeforeChild(f)},i,r),_=g&&g.dom,w=g&&g.contentDOM;if(n.isText){if(!_)_=document.createTextNode(n.text);else if(_.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else _||({dom:_,contentDOM:w}=Sl.renderSpec(document,n.type.spec.toDOM(n)));!w&&!n.isText&&_.nodeName!="BR"&&(_.hasAttribute("contenteditable")||(_.contentEditable="false"),n.type.spec.draggable&&(_.draggable=!0));let T=_;return _=N6(_,i,n),g?f=new Koe(e,n,i,r,_,w||null,T,g,a,d+1):n.isText?new fw(e,n,i,r,_,T,a):new Pu(e,n,i,r,_,w||null,T,a,d+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let i=this.children[n];if(this.dom.contains(i.dom.parentNode)){e.contentElement=i.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ft.empty)}return e}matchesNode(e,n,i){return this.dirty==ha&&e.eq(this.node)&&qC(n,this.outerDeco)&&i.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let i=this.node.inlineContent,r=n,a=e.composing?this.localCompositionInfo(e,n):null,d=a&&a.pos>-1?a:null,o=a&&a.pos<0,f=new Joe(this,d&&d.node,e);tse(this.node,this.innerDeco,(g,_,w)=>{g.spec.marks?f.syncToMarks(g.spec.marks,i,e):g.type.side>=0&&!w&&f.syncToMarks(_==this.node.childCount?Oi.none:this.node.child(_).marks,i,e),f.placeWidget(g,e,r)},(g,_,w,T)=>{f.syncToMarks(g.marks,i,e);let A;f.findNodeMatch(g,_,w,T)||o&&e.state.selection.from>r&&e.state.selection.to<r+g.nodeSize&&(A=f.findIndexWithChild(a.node))>-1&&f.updateNodeAt(g,_,w,A,e)||f.updateNextNode(g,_,w,e,T,r)||f.addNode(g,_,w,e,r),r+=g.nodeSize}),f.syncToMarks([],i,e),this.node.isTextblock&&f.addTextblockHacks(),f.destroyRest(),(f.changed||this.dirty==nh)&&(d&&this.protectLocalComposition(e,d),B6(this.contentDOM,this.children,e),om&&nse(this.dom))}localCompositionInfo(e,n){let{from:i,to:r}=e.state.selection;if(!(e.state.selection instanceof Bn)||i<n||r>n+this.node.content.size)return null;let a=e.domSelectionRange(),d=ise(a.focusNode,a.focusOffset);if(!d||!this.dom.contains(d.parentNode))return null;if(this.node.inlineContent){let o=d.nodeValue,f=rse(this.node.content,o,i-n,r-n);return f<0?null:{node:d,pos:f,text:o}}else return{node:d,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:i,text:r}){if(this.getDesc(n))return;let a=n;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let d=new Xoe(this,a,n,r);e.input.compositionNodes.push(d),this.children=WC(this.children,i,i+r.length,e,d)}update(e,n,i,r){return this.dirty==Dl||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,i,r),!0)}updateInner(e,n,i,r){this.updateOuterDeco(n),this.node=e,this.innerDeco=i,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=ha}updateOuterDeco(e){if(qC(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,i=this.dom;this.dom=F6(this.dom,this.nodeDOM,UC(this.outerDeco,this.node,n),UC(e,this.node,n)),this.dom!=i&&(i.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function n3(t,e,n,i,r){N6(i,e,t);let a=new Pu(void 0,t,e,n,i,i,i,r,0);return a.contentDOM&&a.updateChildren(r,0),a}class fw extends Pu{constructor(e,n,i,r,a,d,o){super(e,n,i,r,a,null,d,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,i,r){return this.dirty==Dl||this.dirty!=ha&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=ha||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=ha,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,i){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,i)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,i){let r=this.node.cut(e,n),a=document.createTextNode(r.text);return new fw(this.parent,r,this.outerDeco,this.innerDeco,a,a,i)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Dl)}get domAtom(){return!1}}class z6 extends Zv{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==ha&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Koe extends Pu{constructor(e,n,i,r,a,d,o,f,g,_){super(e,n,i,r,a,d,o,g,_),this.spec=f}update(e,n,i,r){if(this.dirty==Dl)return!1;if(this.spec.update){let a=this.spec.update(e,n,i);return a&&this.updateInner(e,n,i,r),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,i,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,i,r){this.spec.setSelection?this.spec.setSelection(e,n,i):super.setSelection(e,n,i,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function B6(t,e,n){let i=t.firstChild,r=!1;for(let a=0;a<e.length;a++){let d=e[a],o=d.dom;if(o.parentNode==t){for(;o!=i;)i=i3(i),r=!0;i=i.nextSibling}else r=!0,t.insertBefore(o,i);if(d instanceof Lh){let f=i?i.previousSibling:t.lastChild;B6(d.contentDOM,d.children,n),i=f?f.nextSibling:t.firstChild}}for(;i;)i=i3(i),r=!0;r&&n.trackWrites==t&&(n.trackWrites=null)}const Hy=function(t){t&&(this.nodeName=t)};Hy.prototype=Object.create(null);const ih=[new Hy];function UC(t,e,n){if(t.length==0)return ih;let i=n?ih[0]:new Hy,r=[i];for(let a=0;a<t.length;a++){let d=t[a].type.attrs;if(d){d.nodeName&&r.push(i=new Hy(d.nodeName));for(let o in d){let f=d[o];f!=null&&(n&&r.length==1&&r.push(i=new Hy(e.isInline?"span":"div")),o=="class"?i.class=(i.class?i.class+" ":"")+f:o=="style"?i.style=(i.style?i.style+";":"")+f:o!="nodeName"&&(i[o]=f))}}}return r}function F6(t,e,n,i){if(n==ih&&i==ih)return e;let r=e;for(let a=0;a<i.length;a++){let d=i[a],o=n[a];if(a){let f;o&&o.nodeName==d.nodeName&&r!=t&&(f=r.parentNode)&&f.nodeName.toLowerCase()==d.nodeName||(f=document.createElement(d.nodeName),f.pmIsDeco=!0,f.appendChild(r),o=ih[0]),r=f}Yoe(r,o||ih[0],d)}return r}function Yoe(t,e,n){for(let i in e)i!="class"&&i!="style"&&i!="nodeName"&&!(i in n)&&t.removeAttribute(i);for(let i in n)i!="class"&&i!="style"&&i!="nodeName"&&n[i]!=e[i]&&t.setAttribute(i,n[i]);if(e.class!=n.class){let i=e.class?e.class.split(" ").filter(Boolean):[],r=n.class?n.class.split(" ").filter(Boolean):[];for(let a=0;a<i.length;a++)r.indexOf(i[a])==-1&&t.classList.remove(i[a]);for(let a=0;a<r.length;a++)i.indexOf(r[a])==-1&&t.classList.add(r[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=i.exec(e.style);)t.style.removeProperty(r[1])}n.style&&(t.style.cssText+=n.style)}}function N6(t,e,n){return F6(t,t,ih,UC(e,n,t.nodeType!=1))}function qC(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function i3(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class Joe{constructor(e,n,i){this.lock=n,this.view=i,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Qoe(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let i=e;i<n;i++)this.top.children[i].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,i){let r=0,a=this.stack.length>>1,d=Math.min(a,e.length);for(;r<d&&(r==a-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&e[r].type.spec.spanning!==!1;)r++;for(;r<a;)this.destroyRest(),this.top.dirty=ha,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<e.length;){this.stack.push(this.top,this.index+1);let o=-1;for(let f=this.index;f<Math.min(this.index+3,this.top.children.length);f++){let g=this.top.children[f];if(g.matchesMark(e[a])&&!this.isLocked(g.dom)){o=f;break}}if(o>-1)o>this.index&&(this.changed=!0,this.destroyBetween(this.index,o)),this.top=this.top.children[this.index];else{let f=Lh.create(this.top,e[a],n,i);this.top.children.splice(this.index,0,f),this.top=f,this.changed=!0}this.index=0,a++}}findNodeMatch(e,n,i,r){let a=-1,d;if(r>=this.preMatch.index&&(d=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&d.matchesNode(e,n,i))a=this.top.children.indexOf(d,this.index);else for(let o=this.index,f=Math.min(this.top.children.length,o+5);o<f;o++){let g=this.top.children[o];if(g.matchesNode(e,n,i)&&!this.preMatch.matched.has(g)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,n,i,r,a){let d=this.top.children[r];return d.dirty==Dl&&d.dom==d.contentDOM&&(d.dirty=nh),d.update(e,n,i,a)?(this.destroyBetween(this.index,r),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let i=e.pmViewDesc;if(i){for(let r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==i)return r}return-1}e=n}}updateNextNode(e,n,i,r,a,d){for(let o=this.index;o<this.top.children.length;o++){let f=this.top.children[o];if(f instanceof Pu){let g=this.preMatch.matched.get(f);if(g!=null&&g!=a)return!1;let _=f.dom,w,T=this.isLocked(_)&&!(e.isText&&f.node&&f.node.isText&&f.nodeDOM.nodeValue==e.text&&f.dirty!=Dl&&qC(n,f.outerDeco));if(!T&&f.update(e,n,i,r))return this.destroyBetween(this.index,o),f.dom!=_&&(this.changed=!0),this.index++,!0;if(!T&&(w=this.recreateWrapper(f,e,n,i,r,d)))return this.top.children[this.index]=w,w.contentDOM&&(w.dirty=nh,w.updateChildren(r,d+1),w.dirty=ha),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,i,r,a,d){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content))return null;let o=Pu.create(this.top,n,i,r,a,d);if(o.contentDOM){o.children=e.children,e.children=[];for(let f of o.children)f.parent=o}return e.destroy(),o}addNode(e,n,i,r,a){let d=Pu.create(this.top,e,n,i,r,a);d.contentDOM&&d.updateChildren(r,a+1),this.top.children.splice(this.index++,0,d),this.changed=!0}placeWidget(e,n,i){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let a=new L6(this.top,e,n,i);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Lh;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof fw)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Yo||zo)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let i=document.createElement(e);e=="IMG"&&(i.className="ProseMirror-separator",i.alt=""),e=="BR"&&(i.className="ProseMirror-trailingBreak");let r=new z6(this.top,[],i,null);n!=this.top?n.children.push(r):n.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Qoe(t,e){let n=e,i=n.children.length,r=t.childCount,a=new Map,d=[];e:for(;r>0;){let o;for(;;)if(i){let g=n.children[i-1];if(g instanceof Lh)n=g,i=g.children.length;else{o=g,i--;break}}else{if(n==e)break e;i=n.parent.children.indexOf(n),n=n.parent}let f=o.node;if(f){if(f!=t.child(r-1))break;--r,a.set(o,r),d.push(o)}}return{index:r,matched:a,matches:d.reverse()}}function ese(t,e){return t.type.side-e.type.side}function tse(t,e,n,i){let r=e.locals(t),a=0;if(r.length==0){for(let g=0;g<t.childCount;g++){let _=t.child(g);i(_,r,e.forChild(a,_),g),a+=_.nodeSize}return}let d=0,o=[],f=null;for(let g=0;;){let _,w;for(;d<r.length&&r[d].to==a;){let G=r[d++];G.widget&&(_?(w||(w=[_])).push(G):_=G)}if(_)if(w){w.sort(ese);for(let G=0;G<w.length;G++)n(w[G],g,!!f)}else n(_,g,!!f);let T,A;if(f)A=-1,T=f,f=null;else if(g<t.childCount)A=g,T=t.child(g++);else break;for(let G=0;G<o.length;G++)o[G].to<=a&&o.splice(G--,1);for(;d<r.length&&r[d].from<=a&&r[d].to>a;)o.push(r[d++]);let D=a+T.nodeSize;if(T.isText){let G=D;d<r.length&&r[d].from<G&&(G=r[d].from);for(let V=0;V<o.length;V++)o[V].to<G&&(G=o[V].to);G<D&&(f=T.cut(G-a),T=T.cut(0,G-a),D=G,A=-1)}let z=T.isInline&&!T.isLeaf?o.filter(G=>!G.inline):o.slice();i(T,z,e.forChild(a,T),A),a=D}}function nse(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function ise(t,e){for(;;){if(t.nodeType==3)return t;if(t.nodeType==1&&e>0){if(t.childNodes.length>e&&t.childNodes[e].nodeType==3)return t.childNodes[e];t=t.childNodes[e-1],e=xl(t)}else if(t.nodeType==1&&e<t.childNodes.length)t=t.childNodes[e],e=0;else return null}}function rse(t,e,n,i){for(let r=0,a=0;r<t.childCount&&a<=i;){let d=t.child(r++),o=a;if(a+=d.nodeSize,!d.isText)continue;let f=d.text;for(;r<t.childCount;){let g=t.child(r++);if(a+=g.nodeSize,!g.isText)break;f+=g.text}if(a>=n){if(a>=i&&f.slice(i-e.length-o,i-o)==e)return i-e.length;let g=o<i?f.lastIndexOf(e,i-o-1):-1;if(g>=0&&g+e.length+o>=n)return o+g;if(n==i&&f.length>=i+e.length-o&&f.slice(i-o,i-o+e.length)==e)return i}}return-1}function WC(t,e,n,i,r){let a=[];for(let d=0,o=0;d<t.length;d++){let f=t[d],g=o,_=o+=f.size;g>=n||_<=e?a.push(f):(g<e&&a.push(f.slice(0,e-g,i)),r&&(a.push(r),r=void 0),_>n&&a.push(f.slice(n-g,f.size,i)))}return a}function OA(t,e=null){let n=t.domSelectionRange(),i=t.state.doc;if(!n.focusNode)return null;let r=t.docView.nearestDesc(n.focusNode),a=r&&r.size==0,d=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(d<0)return null;let o=i.resolve(d),f,g;if(hw(n)){for(f=o;r&&!r.node;)r=r.parent;let _=r.node;if(r&&_.isAtom&&Cn.isSelectable(_)&&r.parent&&!(_.isInline&&Ioe(n.focusNode,n.focusOffset,r.dom))){let w=r.posBefore;g=new Cn(d==w?o:i.resolve(w))}}else{let _=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(_<0)return null;f=i.resolve(_)}if(!g){let _=e=="pointer"||t.state.selection.head<o.pos&&!a?1:-1;g=DA(t,f,o,_)}return g}function $6(t){return t.editable?t.hasFocus():V6(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function fc(t,e=!1){let n=t.state.selection;if(j6(t,n),!!$6(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&zo){let i=t.domSelectionRange(),r=t.domObserver.currentSelection;if(i.anchorNode&&r.anchorNode&&Rh(i.anchorNode,i.anchorOffset,r.anchorNode,r.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)sse(t);else{let{anchor:i,head:r}=n,a,d;r3&&!(n instanceof Bn)&&(n.$from.parent.inlineContent||(a=o3(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(d=o3(t,n.to))),t.docView.setSelection(i,r,t.root,e),r3&&(a&&s3(a),d&&s3(d)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&ose(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const r3=Yo||zo&&Poe<63;function o3(t,e){let{node:n,offset:i}=t.docView.domFromPos(e,0),r=i<n.childNodes.length?n.childNodes[i]:null,a=i?n.childNodes[i-1]:null;if(Yo&&r&&r.contentEditable=="false")return Ek(r);if((!r||r.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(r)return Ek(r);if(a)return Ek(a)}}function Ek(t){return t.contentEditable="true",Yo&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function s3(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function ose(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),i=n.anchorNode,r=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=i||n.anchorOffset!=r)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!$6(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function sse(t){let e=t.domSelection(),n=document.createRange(),i=t.cursorWrapper.dom,r=i.nodeName=="IMG";r?n.setEnd(i.parentNode,Xo(i)+1):n.setEnd(i,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!r&&!t.state.selection.visible&&ws&&Mu<=11&&(i.disabled=!0,i.disabled=!1)}function j6(t,e){if(e instanceof Cn){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(a3(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else a3(t)}function a3(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function DA(t,e,n,i){return t.someProp("createSelectionBetween",r=>r(t,e,n))||Bn.between(e,n,i)}function l3(t){return t.editable&&!t.hasFocus()?!1:V6(t)}function V6(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch(n){return!1}}function ase(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return Rh(e.node,e.offset,n.anchorNode,n.anchorOffset)}function GC(t,e){let{$anchor:n,$head:i}=t.selection,r=e>0?n.max(i):n.min(i),a=r.parent.inlineContent?r.depth?t.doc.resolve(e>0?r.after():r.before()):null:r;return a&&$n.findFrom(a,e)}function lu(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function c3(t,e,n){let i=t.state.selection;if(i instanceof Bn)if(n.indexOf("s")>-1){let{$head:r}=i,a=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let d=t.state.doc.resolve(r.pos+a.nodeSize*(e<0?-1:1));return lu(t,new Bn(i.$anchor,d))}else if(i.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let r=GC(t.state,e);return r&&r instanceof Cn?lu(t,r):!1}else if(!(ra&&n.indexOf("m")>-1)){let r=i.$head,a=r.textOffset?null:e<0?r.nodeBefore:r.nodeAfter,d;if(!a||a.isText)return!1;let o=e<0?r.pos-a.nodeSize:r.pos;return a.isAtom||(d=t.docView.descAt(o))&&!d.contentDOM?Cn.isSelectable(a)?lu(t,new Cn(e<0?t.state.doc.resolve(r.pos-a.nodeSize):r)):Hv?lu(t,new Bn(t.state.doc.resolve(e<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(i instanceof Cn&&i.node.isInline)return lu(t,new Bn(e>0?i.$to:i.$from));{let r=GC(t.state,e);return r?lu(t,r):!1}}}function Wx(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Zy(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Gf(t,e){return e<0?lse(t):cse(t)}function lse(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let r,a,d=!1;for(el&&n.nodeType==1&&i<Wx(n)&&Zy(n.childNodes[i],-1)&&(d=!0);;)if(i>0){if(n.nodeType!=1)break;{let o=n.childNodes[i-1];if(Zy(o,-1))r=n,a=--i;else if(o.nodeType==3)n=o,i=n.nodeValue.length;else break}}else{if(U6(n))break;{let o=n.previousSibling;for(;o&&Zy(o,-1);)r=n.parentNode,a=Xo(o),o=o.previousSibling;if(o)n=o,i=Wx(n);else{if(n=n.parentNode,n==t.dom)break;i=0}}}d?HC(t,n,i):r&&HC(t,r,a)}function cse(t){let e=t.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let r=Wx(n),a,d;for(;;)if(i<r){if(n.nodeType!=1)break;let o=n.childNodes[i];if(Zy(o,1))a=n,d=++i;else break}else{if(U6(n))break;{let o=n.nextSibling;for(;o&&Zy(o,1);)a=o.parentNode,d=Xo(o)+1,o=o.nextSibling;if(o)n=o,i=0,r=Wx(n);else{if(n=n.parentNode,n==t.dom)break;i=r=0}}}a&&HC(t,a,d)}function U6(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function use(t,e){for(;t&&e==t.childNodes.length&&!MA(t);)e=Xo(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function dse(t,e){for(;t&&!e&&!MA(t);)e=Xo(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function HC(t,e,n){if(e.nodeType!=3){let a,d;(d=use(e,n))?(e=d,n=0):(a=dse(e,n))&&(e=a,n=a.nodeValue.length)}let i=t.domSelection();if(hw(i)){let a=document.createRange();a.setEnd(e,n),a.setStart(e,n),i.removeAllRanges(),i.addRange(a)}else i.extend&&i.extend(e,n);t.domObserver.setCurSelection();let{state:r}=t;setTimeout(()=>{t.state==r&&fc(t)},50)}function u3(t,e){let n=t.state.doc.resolve(e);if(!(zo||Ooe)&&n.parent.inlineContent){let r=t.coordsAtPos(e);if(e>n.start()){let a=t.coordsAtPos(e-1),d=(a.top+a.bottom)/2;if(d>r.top&&d<r.bottom&&Math.abs(a.left-r.left)>1)return a.left<r.left?"ltr":"rtl"}if(e<n.end()){let a=t.coordsAtPos(e+1),d=(a.top+a.bottom)/2;if(d>r.top&&d<r.bottom&&Math.abs(a.left-r.left)>1)return a.left>r.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function d3(t,e,n){let i=t.state.selection;if(i instanceof Bn&&!i.empty||n.indexOf("s")>-1||ra&&n.indexOf("m")>-1)return!1;let{$from:r,$to:a}=i;if(!r.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let d=GC(t.state,e);if(d&&d instanceof Cn)return lu(t,d)}if(!r.parent.inlineContent){let d=e<0?r:a,o=i instanceof Ja?$n.near(d,e):$n.findFrom(d,e);return o?lu(t,o):!1}return!1}function h3(t,e){if(!(t.state.selection instanceof Bn))return!0;let{$head:n,$anchor:i,empty:r}=t.state.selection;if(!n.sameParent(i))return!0;if(!r)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){let d=t.state.tr;return e<0?d.delete(n.pos-a.nodeSize,n.pos):d.delete(n.pos,n.pos+a.nodeSize),t.dispatch(d),!0}return!1}function f3(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function hse(t){if(!Yo||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let i=e.firstChild;f3(t,i,"true"),setTimeout(()=>f3(t,i,"false"),20)}return!1}function fse(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function pse(t,e){let n=e.keyCode,i=fse(e);if(n==8||ra&&n==72&&i=="c")return h3(t,-1)||Gf(t,-1);if(n==46&&!e.shiftKey||ra&&n==68&&i=="c")return h3(t,1)||Gf(t,1);if(n==13||n==27)return!0;if(n==37||ra&&n==66&&i=="c"){let r=n==37?u3(t,t.state.selection.from)=="ltr"?-1:1:-1;return c3(t,r,i)||Gf(t,r)}else if(n==39||ra&&n==70&&i=="c"){let r=n==39?u3(t,t.state.selection.from)=="ltr"?1:-1:1;return c3(t,r,i)||Gf(t,r)}else{if(n==38||ra&&n==80&&i=="c")return d3(t,-1,i)||Gf(t,-1);if(n==40||ra&&n==78&&i=="c")return hse(t)||d3(t,1,i)||Gf(t,1);if(i==(ra?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function q6(t,e){t.someProp("transformCopied",A=>{e=A(e,t)});let n=[],{content:i,openStart:r,openEnd:a}=e;for(;r>1&&a>1&&i.childCount==1&&i.firstChild.childCount==1;){r--,a--;let A=i.firstChild;n.push(A.type.name,A.attrs!=A.type.defaultAttrs?A.attrs:null),i=A.content}let d=t.someProp("clipboardSerializer")||Sl.fromSchema(t.state.schema),o=K6(),f=o.createElement("div");f.appendChild(d.serializeFragment(i,{document:o}));let g=f.firstChild,_,w=0;for(;g&&g.nodeType==1&&(_=X6[g.nodeName.toLowerCase()]);){for(let A=_.length-1;A>=0;A--){let D=o.createElement(_[A]);for(;f.firstChild;)D.appendChild(f.firstChild);f.appendChild(D),w++}g=f.firstChild}g&&g.nodeType==1&&g.setAttribute("data-pm-slice",`${r} ${a}${w?` -${w}`:""} ${JSON.stringify(n)}`);let T=t.someProp("clipboardTextSerializer",A=>A(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:f,text:T}}function W6(t,e,n,i,r){let a=r.parent.type.spec.code,d,o;if(!n&&!e)return null;let f=e&&(i||a||!n);if(f){if(t.someProp("transformPastedText",T=>{e=T(e,a||i,t)}),a)return e?new nn(Ft.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):nn.empty;let w=t.someProp("clipboardTextParser",T=>T(e,r,i,t));if(w)o=w;else{let T=r.marks(),{schema:A}=t.state,D=Sl.fromSchema(A);d=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(z=>{let G=d.appendChild(document.createElement("p"));z&&G.appendChild(D.serializeNode(A.text(z,T)))})}}else t.someProp("transformPastedHTML",w=>{n=w(n,t)}),d=yse(n),Hv&&vse(d);let g=d&&d.querySelector("[data-pm-slice]"),_=g&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(g.getAttribute("data-pm-slice")||"");if(_&&_[3])for(let w=+_[3];w>0;w--){let T=d.firstChild;for(;T&&T.nodeType!=1;)T=T.nextSibling;if(!T)break;d=T}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||kA.fromSchema(t.state.schema)).parseSlice(d,{preserveWhitespace:!!(f||_),context:r,ruleFromNode(T){return T.nodeName=="BR"&&!T.nextSibling&&T.parentNode&&!mse.test(T.parentNode.nodeName)?{ignore:!0}:null}})),_)o=bse(p3(o,+_[1],+_[2]),_[4]);else if(o=nn.maxOpen(gse(o.content,r),!0),o.openStart||o.openEnd){let w=0,T=0;for(let A=o.content.firstChild;w<o.openStart&&!A.type.spec.isolating;w++,A=A.firstChild);for(let A=o.content.lastChild;T<o.openEnd&&!A.type.spec.isolating;T++,A=A.lastChild);o=p3(o,w,T)}return t.someProp("transformPasted",w=>{o=w(o,t)}),o}const mse=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function gse(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.index(n)),a,d=[];if(t.forEach(o=>{if(!d)return;let f=r.findWrapping(o.type),g;if(!f)return d=null;if(g=d.length&&a.length&&H6(f,a,o,d[d.length-1],0))d[d.length-1]=g;else{d.length&&(d[d.length-1]=Z6(d[d.length-1],a.length));let _=G6(o,f);d.push(_),r=r.matchType(_.type),a=f}}),d)return Ft.from(d)}return t}function G6(t,e,n=0){for(let i=e.length-1;i>=n;i--)t=e[i].create(null,Ft.from(t));return t}function H6(t,e,n,i,r){if(r<t.length&&r<e.length&&t[r]==e[r]){let a=H6(t,e,n,i.lastChild,r+1);if(a)return i.copy(i.content.replaceChild(i.childCount-1,a));if(i.contentMatchAt(i.childCount).matchType(r==t.length-1?n.type:t[r+1]))return i.copy(i.content.append(Ft.from(G6(n,t,r+1))))}}function Z6(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,Z6(t.lastChild,e-1)),i=t.contentMatchAt(t.childCount).fillBefore(Ft.empty,!0);return t.copy(n.append(i))}function ZC(t,e,n,i,r,a){let d=e<0?t.firstChild:t.lastChild,o=d.content;return t.childCount>1&&(a=0),r<i-1&&(o=ZC(o,e,n,i,r+1,a)),r>=n&&(o=e<0?d.contentMatchAt(0).fillBefore(o,a<=r).append(o):o.append(d.contentMatchAt(d.childCount).fillBefore(Ft.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,d.copy(o))}function p3(t,e,n){return e<t.openStart&&(t=new nn(ZC(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new nn(ZC(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const X6={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let m3=null;function K6(){return m3||(m3=document.implementation.createHTMLDocument("title"))}function yse(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=K6().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(t),r;if((r=i&&X6[i[1].toLowerCase()])&&(t=r.map(a=>"<"+a+">").join("")+t+r.map(a=>"</"+a+">").reverse().join("")),n.innerHTML=t,r)for(let a=0;a<r.length;a++)n=n.querySelector(r[a])||n;return n}function vse(t){let e=t.querySelectorAll(zo?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let i=e[n];i.childNodes.length==1&&i.textContent==" "&&i.parentNode&&i.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),i)}}function bse(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,i;try{i=JSON.parse(e)}catch(o){return t}let{content:r,openStart:a,openEnd:d}=t;for(let o=i.length-2;o>=0;o-=2){let f=n.nodes[i[o]];if(!f||f.hasRequiredAttrs())break;r=Ft.from(f.create(i[o+1],r)),a++,d++}return new nn(r,a,d)}const Jo={},Qo={},_se={touchstart:!0,touchmove:!0};class xse{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function wse(t){for(let e in Jo){let n=Jo[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=i=>{Ese(t,i)&&!RA(t,i)&&(t.editable||!(i.type in Qo))&&n(t,i)},_se[e]?{passive:!0}:void 0)}Yo&&t.dom.addEventListener("input",()=>null),XC(t)}function bu(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function Sse(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function XC(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=i=>RA(t,i))})}function RA(t,e){return t.someProp("handleDOMEvents",n=>{let i=n[e.type];return i?i(t,e)||e.defaultPrevented:!1})}function Ese(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function kse(t,e){!RA(t,e)&&Jo[e.type]&&(t.editable||!(e.type in Qo))&&Jo[e.type](t,e)}Qo.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!J6(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(qa&&zo&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),om&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let i=Date.now();t.input.lastIOSEnter=i,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==i&&(t.someProp("handleKeyDown",r=>r(t,Kd(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",i=>i(t,n))||pse(t,n)?n.preventDefault():bu(t,"key")};Qo.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Qo.keypress=(t,e)=>{let n=e;if(J6(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||ra&&n.metaKey)return;if(t.someProp("handleKeyPress",r=>r(t,n))){n.preventDefault();return}let i=t.state.selection;if(!(i instanceof Bn)||!i.$from.sameParent(i.$to)){let r=String.fromCharCode(n.charCode);!/[\r\n]/.test(r)&&!t.someProp("handleTextInput",a=>a(t,i.$from.pos,i.$to.pos,r))&&t.dispatch(t.state.tr.insertText(r).scrollIntoView()),n.preventDefault()}};function pw(t){return{left:t.clientX,top:t.clientY}}function Tse(t,e){let n=e.x-t.clientX,i=e.y-t.clientY;return n*n+i*i<100}function LA(t,e,n,i,r){if(i==-1)return!1;let a=t.state.doc.resolve(i);for(let d=a.depth+1;d>0;d--)if(t.someProp(e,o=>d>a.depth?o(t,n,a.nodeAfter,a.before(d),r,!0):o(t,n,a.node(d),a.before(d),r,!1)))return!0;return!1}function $p(t,e,n){t.focused||t.focus();let i=t.state.tr.setSelection(e);n=="pointer"&&i.setMeta("pointer",!0),t.dispatch(i)}function Cse(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),i=n.nodeAfter;return i&&i.isAtom&&Cn.isSelectable(i)?($p(t,new Cn(n),"pointer"),!0):!1}function Ise(t,e){if(e==-1)return!1;let n=t.state.selection,i,r;n instanceof Cn&&(i=n.node);let a=t.state.doc.resolve(e);for(let d=a.depth+1;d>0;d--){let o=d>a.depth?a.nodeAfter:a.node(d);if(Cn.isSelectable(o)){i&&n.$from.depth>0&&d>=n.$from.depth&&a.before(n.$from.depth+1)==n.$from.pos?r=a.before(n.$from.depth):r=a.before(d);break}}return r!=null?($p(t,Cn.create(t.state.doc,r),"pointer"),!0):!1}function Ase(t,e,n,i,r){return LA(t,"handleClickOn",e,n,i)||t.someProp("handleClick",a=>a(t,e,i))||(r?Ise(t,n):Cse(t,n))}function Mse(t,e,n,i){return LA(t,"handleDoubleClickOn",e,n,i)||t.someProp("handleDoubleClick",r=>r(t,e,i))}function Pse(t,e,n,i){return LA(t,"handleTripleClickOn",e,n,i)||t.someProp("handleTripleClick",r=>r(t,e,i))||Ose(t,n,i)}function Ose(t,e,n){if(n.button!=0)return!1;let i=t.state.doc;if(e==-1)return i.inlineContent?($p(t,Bn.create(i,0,i.content.size),"pointer"),!0):!1;let r=i.resolve(e);for(let a=r.depth+1;a>0;a--){let d=a>r.depth?r.nodeAfter:r.node(a),o=r.before(a);if(d.inlineContent)$p(t,Bn.create(i,o+1,o+1+d.content.size),"pointer");else if(Cn.isSelectable(d))$p(t,Cn.create(i,o),"pointer");else continue;return!0}}function zA(t){return Gx(t)}const Y6=ra?"metaKey":"ctrlKey";Jo.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let i=zA(t),r=Date.now(),a="singleClick";r-t.input.lastClick.time<500&&Tse(n,t.input.lastClick)&&!n[Y6]&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:r,x:n.clientX,y:n.clientY,type:a};let d=t.posAtCoords(pw(n));d&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new Dse(t,d,n,!!i)):(a=="doubleClick"?Mse:Pse)(t,d.pos,d.inside,n)?n.preventDefault():bu(t,"pointer"))};class Dse{constructor(e,n,i,r){this.view=e,this.pos=n,this.event=i,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!i[Y6],this.allowDefault=i.shiftKey;let a,d;if(n.inside>-1)a=e.state.doc.nodeAt(n.inside),d=n.inside;else{let _=e.state.doc.resolve(n.pos);a=_.parent,d=_.depth?_.before():0}const o=r?null:i.target,f=o?e.docView.nearestDesc(o,!0):null;this.target=f?f.dom:null;let{selection:g}=e.state;(i.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||g instanceof Cn&&g.from<=d&&g.to>d)&&(this.mightDrag={node:a,pos:d,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&el&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),bu(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>fc(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(pw(e))),this.updateAllowDefault(e),this.allowDefault||!n?bu(this.view,"pointer"):Ase(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Yo&&this.mightDrag&&!this.mightDrag.node.isAtom||zo&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?($p(this.view,$n.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):bu(this.view,"pointer")}move(e){this.updateAllowDefault(e),bu(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Jo.touchstart=t=>{t.input.lastTouch=Date.now(),zA(t),bu(t,"pointer")};Jo.touchmove=t=>{t.input.lastTouch=Date.now(),bu(t,"pointer")};Jo.contextmenu=t=>zA(t);function J6(t,e){return t.composing?!0:Yo&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const Rse=qa?5e3:-1;Qo.compositionstart=Qo.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(i=>i.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Gx(t,!0),t.markCursor=null;else if(Gx(t),el&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let i=t.domSelectionRange();for(let r=i.focusNode,a=i.focusOffset;r&&r.nodeType==1&&a!=0;){let d=a<0?r.lastChild:r.childNodes[a-1];if(!d)break;if(d.nodeType==3){t.domSelection().collapse(d,d.nodeValue.length);break}else r=d,a=-1}}t.input.composing=!0}Q6(t,Rse)};Qo.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,Q6(t,20))};function Q6(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Gx(t),e))}function ej(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=Lse());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function Lse(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Gx(t,e=!1){if(!(qa&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),ej(t),e||t.docView&&t.docView.dirty){let n=OA(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}function zse(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),r=document.createRange();r.selectNodeContents(e),t.dom.blur(),i.removeAllRanges(),i.addRange(r),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const sm=ws&&Mu<15||om&&Doe<604;Jo.copy=Qo.cut=(t,e)=>{let n=e,i=t.state.selection,r=n.type=="cut";if(i.empty)return;let a=sm?null:n.clipboardData,d=i.content(),{dom:o,text:f}=q6(t,d);a?(n.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",f)):zse(t,o),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Bse(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function Fse(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,i=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus();let r=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),i.parentNode&&i.parentNode.removeChild(i),n?Cv(t,i.value,null,r,e):Cv(t,i.textContent,i.innerHTML,r,e)},50)}function Cv(t,e,n,i,r){let a=W6(t,e,n,i,t.state.selection.$from);if(t.someProp("handlePaste",f=>f(t,r,a||nn.empty)))return!0;if(!a)return!1;let d=Bse(a),o=d?t.state.tr.replaceSelectionWith(d,i):t.state.tr.replaceSelection(a);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Qo.paste=(t,e)=>{let n=e;if(t.composing&&!qa)return;let i=sm?null:n.clipboardData,r=t.input.shiftKey&&t.input.lastKeyCode!=45;i&&Cv(t,i.getData("text/plain"),i.getData("text/html"),r,n)?n.preventDefault():Fse(t,n)};class Nse{constructor(e,n){this.slice=e,this.move=n}}const tj=ra?"altKey":"ctrlKey";Jo.dragstart=(t,e)=>{let n=e,i=t.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let r=t.state.selection,a=r.empty?null:t.posAtCoords(pw(n));if(!(a&&a.pos>=r.from&&a.pos<=(r instanceof Cn?r.to-1:r.to))){if(i&&i.mightDrag)t.dispatch(t.state.tr.setSelection(Cn.create(t.state.doc,i.mightDrag.pos)));else if(n.target&&n.target.nodeType==1){let g=t.docView.nearestDesc(n.target,!0);g&&g.node.type.spec.draggable&&g!=t.docView&&t.dispatch(t.state.tr.setSelection(Cn.create(t.state.doc,g.posBefore)))}}let d=t.state.selection.content(),{dom:o,text:f}=q6(t,d);n.dataTransfer.clearData(),n.dataTransfer.setData(sm?"Text":"text/html",o.innerHTML),n.dataTransfer.effectAllowed="copyMove",sm||n.dataTransfer.setData("text/plain",f),t.dragging=new Nse(d,!n[tj])};Jo.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Qo.dragover=Qo.dragenter=(t,e)=>e.preventDefault();Qo.drop=(t,e)=>{let n=e,i=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let r=t.posAtCoords(pw(n));if(!r)return;let a=t.state.doc.resolve(r.pos),d=i&&i.slice;d?t.someProp("transformPasted",D=>{d=D(d,t)}):d=W6(t,n.dataTransfer.getData(sm?"Text":"text/plain"),sm?null:n.dataTransfer.getData("text/html"),!1,a);let o=!!(i&&!n[tj]);if(t.someProp("handleDrop",D=>D(t,n,d||nn.empty,o))){n.preventDefault();return}if(!d)return;n.preventDefault();let f=d?x6(t.state.doc,a.pos,d):a.pos;f==null&&(f=a.pos);let g=t.state.tr;o&&g.deleteSelection();let _=g.mapping.map(f),w=d.openStart==0&&d.openEnd==0&&d.content.childCount==1,T=g.doc;if(w?g.replaceRangeWith(_,_,d.content.firstChild):g.replaceRange(_,_,d),g.doc.eq(T))return;let A=g.doc.resolve(_);if(w&&Cn.isSelectable(d.content.firstChild)&&A.nodeAfter&&A.nodeAfter.sameMarkup(d.content.firstChild))g.setSelection(new Cn(A));else{let D=g.mapping.map(f);g.mapping.maps[g.mapping.maps.length-1].forEach((z,G,V,N)=>D=N),g.setSelection(DA(t,A,g.doc.resolve(D)))}t.focus(),t.dispatch(g.setMeta("uiEvent","drop"))};Jo.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&fc(t)},20))};Jo.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Jo.beforeinput=(t,e)=>{if(zo&&qa&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:i}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=i||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,Kd(8,"Backspace")))))return;let{$cursor:r}=t.state.selection;r&&r.pos>0&&t.dispatch(t.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let t in Qo)Jo[t]=Qo[t];function Iv(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Hx{constructor(e,n){this.toDOM=e,this.spec=n||ph,this.side=this.spec.side||0}map(e,n,i,r){let{pos:a,deleted:d}=e.mapResult(n.from+r,this.side<0?-1:1);return d?null:new ca(a-i,a-i,this)}valid(){return!0}eq(e){return this==e||e instanceof Hx&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Iv(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ou{constructor(e,n){this.attrs=e,this.spec=n||ph}map(e,n,i,r){let a=e.map(n.from+r,this.spec.inclusiveStart?-1:1)-i,d=e.map(n.to+r,this.spec.inclusiveEnd?1:-1)-i;return a>=d?null:new ca(a,d,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Ou&&Iv(this.attrs,e.attrs)&&Iv(this.spec,e.spec)}static is(e){return e.type instanceof Ou}destroy(){}}class BA{constructor(e,n){this.attrs=e,this.spec=n||ph}map(e,n,i,r){let a=e.mapResult(n.from+r,1);if(a.deleted)return null;let d=e.mapResult(n.to+r,-1);return d.deleted||d.pos<=a.pos?null:new ca(a.pos-i,d.pos-i,this)}valid(e,n){let{index:i,offset:r}=e.content.findIndex(n.from),a;return r==n.from&&!(a=e.child(i)).isText&&r+a.nodeSize==n.to}eq(e){return this==e||e instanceof BA&&Iv(this.attrs,e.attrs)&&Iv(this.spec,e.spec)}destroy(){}}class ca{constructor(e,n,i){this.from=e,this.to=n,this.type=i}copy(e,n){return new ca(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,i){return this.type.map(e,this,n,i)}static widget(e,n,i){return new ca(e,e,new Hx(n,i))}static inline(e,n,i,r){return new ca(e,n,new Ou(i,r))}static node(e,n,i,r){return new ca(e,n,new BA(i,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ou}get widget(){return this.type instanceof Hx}}const op=[],ph={};class Xr{constructor(e,n){this.local=e.length?e:op,this.children=n.length?n:op}static create(e,n){return n.length?Zx(n,e,0,ph):Ro}find(e,n,i){let r=[];return this.findInner(e==null?0:e,n==null?1e9:n,r,0,i),r}findInner(e,n,i,r,a){for(let d=0;d<this.local.length;d++){let o=this.local[d];o.from<=n&&o.to>=e&&(!a||a(o.spec))&&i.push(o.copy(o.from+r,o.to+r))}for(let d=0;d<this.children.length;d+=3)if(this.children[d]<n&&this.children[d+1]>e){let o=this.children[d]+1;this.children[d+2].findInner(e-o,n-o,i,r+o,a)}}map(e,n,i){return this==Ro||e.maps.length==0?this:this.mapInner(e,n,0,0,i||ph)}mapInner(e,n,i,r,a){let d;for(let o=0;o<this.local.length;o++){let f=this.local[o].map(e,i,r);f&&f.type.valid(n,f)?(d||(d=[])).push(f):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?$se(this.children,d||[],e,n,i,r,a):d?new Xr(d.sort(mh),op):Ro}add(e,n){return n.length?this==Ro?Xr.create(e,n):this.addInner(e,n,0):this}addInner(e,n,i){let r,a=0;e.forEach((o,f)=>{let g=f+i,_;if(_=ij(n,o,g)){for(r||(r=this.children.slice());a<r.length&&r[a]<f;)a+=3;r[a]==f?r[a+2]=r[a+2].addInner(o,_,g+1):r.splice(a,0,f,f+o.nodeSize,Zx(_,o,g+1,ph)),a+=3}});let d=nj(a?rj(n):n,-i);for(let o=0;o<d.length;o++)d[o].type.valid(e,d[o])||d.splice(o--,1);return new Xr(d.length?this.local.concat(d).sort(mh):this.local,r||this.children)}remove(e){return e.length==0||this==Ro?this:this.removeInner(e,0)}removeInner(e,n){let i=this.children,r=this.local;for(let a=0;a<i.length;a+=3){let d,o=i[a]+n,f=i[a+1]+n;for(let _=0,w;_<e.length;_++)(w=e[_])&&w.from>o&&w.to<f&&(e[_]=null,(d||(d=[])).push(w));if(!d)continue;i==this.children&&(i=this.children.slice());let g=i[a+2].removeInner(d,o+1);g!=Ro?i[a+2]=g:(i.splice(a,3),a-=3)}if(r.length){for(let a=0,d;a<e.length;a++)if(d=e[a])for(let o=0;o<r.length;o++)r[o].eq(d,n)&&(r==this.local&&(r=this.local.slice()),r.splice(o--,1))}return i==this.children&&r==this.local?this:r.length||i.length?new Xr(r,i):Ro}forChild(e,n){if(this==Ro)return this;if(n.isLeaf)return Xr.empty;let i,r;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(i=this.children[o+2]);break}let a=e+1,d=a+n.content.size;for(let o=0;o<this.local.length;o++){let f=this.local[o];if(f.from<d&&f.to>a&&f.type instanceof Ou){let g=Math.max(a,f.from)-a,_=Math.min(d,f.to)-a;g<_&&(r||(r=[])).push(f.copy(g,_))}}if(r){let o=new Xr(r.sort(mh),op);return i?new pu([o,i]):o}return i||Ro}eq(e){if(this==e)return!0;if(!(e instanceof Xr)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return FA(this.localsInner(e))}localsInner(e){if(this==Ro)return op;if(e.inlineContent||!this.local.some(Ou.is))return this.local;let n=[];for(let i=0;i<this.local.length;i++)this.local[i].type instanceof Ou||n.push(this.local[i]);return n}}Xr.empty=new Xr([],[]);Xr.removeOverlap=FA;const Ro=Xr.empty;class pu{constructor(e){this.members=e}map(e,n){const i=this.members.map(r=>r.map(e,n,ph));return pu.from(i)}forChild(e,n){if(n.isLeaf)return Xr.empty;let i=[];for(let r=0;r<this.members.length;r++){let a=this.members[r].forChild(e,n);a!=Ro&&(a instanceof pu?i=i.concat(a.members):i.push(a))}return pu.from(i)}eq(e){if(!(e instanceof pu)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,i=!0;for(let r=0;r<this.members.length;r++){let a=this.members[r].localsInner(e);if(a.length)if(!n)n=a;else{i&&(n=n.slice(),i=!1);for(let d=0;d<a.length;d++)n.push(a[d])}}return n?FA(i?n:n.sort(mh)):op}static from(e){switch(e.length){case 0:return Ro;case 1:return e[0];default:return new pu(e.every(n=>n instanceof Xr)?e:e.reduce((n,i)=>n.concat(i instanceof Xr?i:i.members),[]))}}}function $se(t,e,n,i,r,a,d){let o=t.slice();for(let g=0,_=a;g<n.maps.length;g++){let w=0;n.maps[g].forEach((T,A,D,z)=>{let G=z-D-(A-T);for(let V=0;V<o.length;V+=3){let N=o[V+1];if(N<0||T>N+_-w)continue;let q=o[V]+_-w;A>=q?o[V+1]=T<=q?-2:-1:D>=r&&G&&(o[V]+=G,o[V+1]+=G)}w+=G}),_=n.maps[g].map(_,-1)}let f=!1;for(let g=0;g<o.length;g+=3)if(o[g+1]<0){if(o[g+1]==-2){f=!0,o[g+1]=-1;continue}let _=n.map(t[g]+a),w=_-r;if(w<0||w>=i.content.size){f=!0;continue}let T=n.map(t[g+1]+a,-1),A=T-r,{index:D,offset:z}=i.content.findIndex(w),G=i.maybeChild(D);if(G&&z==w&&z+G.nodeSize==A){let V=o[g+2].mapInner(n,G,_+1,t[g]+a+1,d);V!=Ro?(o[g]=w,o[g+1]=A,o[g+2]=V):(o[g+1]=-2,f=!0)}else f=!0}if(f){let g=jse(o,t,e,n,r,a,d),_=Zx(g,i,0,d);e=_.local;for(let w=0;w<o.length;w+=3)o[w+1]<0&&(o.splice(w,3),w-=3);for(let w=0,T=0;w<_.children.length;w+=3){let A=_.children[w];for(;T<o.length&&o[T]<A;)T+=3;o.splice(T,0,_.children[w],_.children[w+1],_.children[w+2])}}return new Xr(e.sort(mh),o)}function nj(t,e){if(!e||!t.length)return t;let n=[];for(let i=0;i<t.length;i++){let r=t[i];n.push(new ca(r.from+e,r.to+e,r.type))}return n}function jse(t,e,n,i,r,a,d){function o(f,g){for(let _=0;_<f.local.length;_++){let w=f.local[_].map(i,r,g);w?n.push(w):d.onRemove&&d.onRemove(f.local[_].spec)}for(let _=0;_<f.children.length;_+=3)o(f.children[_+2],f.children[_]+g+1)}for(let f=0;f<t.length;f+=3)t[f+1]==-1&&o(t[f+2],e[f]+a+1);return n}function ij(t,e,n){if(e.isLeaf)return null;let i=n+e.nodeSize,r=null;for(let a=0,d;a<t.length;a++)(d=t[a])&&d.from>n&&d.to<i&&((r||(r=[])).push(d),t[a]=null);return r}function rj(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Zx(t,e,n,i){let r=[],a=!1;e.forEach((o,f)=>{let g=ij(t,o,f+n);if(g){a=!0;let _=Zx(g,o,n+f+1,i);_!=Ro&&r.push(f,f+o.nodeSize,_)}});let d=nj(a?rj(t):t,-n).sort(mh);for(let o=0;o<d.length;o++)d[o].type.valid(e,d[o])||(i.onRemove&&i.onRemove(d[o].spec),d.splice(o--,1));return d.length||r.length?new Xr(d,r):Ro}function mh(t,e){return t.from-e.from||t.to-e.to}function FA(t){let e=t;for(let n=0;n<e.length-1;n++){let i=e[n];if(i.from!=i.to)for(let r=n+1;r<e.length;r++){let a=e[r];if(a.from==i.from){a.to!=i.to&&(e==t&&(e=t.slice()),e[r]=a.copy(a.from,i.to),g3(e,r+1,a.copy(i.to,a.to)));continue}else{a.from<i.to&&(e==t&&(e=t.slice()),e[n]=i.copy(i.from,a.from),g3(e,r,i.copy(a.from,i.to)));break}}}return e}function g3(t,e,n){for(;e<t.length&&mh(n,t[e])>0;)e++;t.splice(e,0,n)}function kk(t){let e=[];return t.someProp("decorations",n=>{let i=n(t.state);i&&i!=Ro&&e.push(i)}),t.cursorWrapper&&e.push(Xr.create(t.state.doc,[t.cursorWrapper.deco])),pu.from(e)}const Vse={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Use=ws&&Mu<=11;class qse{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Wse{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new qse,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(i=>{for(let r=0;r<i.length;r++)this.queue.push(i[r]);ws&&Mu<=11&&i.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),Use&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Vse)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(l3(this.view)){if(this.suppressingSelectionUpdates)return fc(this.view);if(ws&&Mu<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Rh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,i;for(let a=e.focusNode;a;a=Tv(a))n.add(a);for(let a=e.anchorNode;a;a=Tv(a))if(n.has(a)){i=a;break}let r=i&&this.view.docView.nearestDesc(i);if(r&&r.ignoreMutation({type:"selection",target:i.nodeType==3?i.parentNode:i}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let i=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(i)&&l3(e)&&!this.ignoreSelectionChange(i),a=-1,d=-1,o=!1,f=[];if(e.editable)for(let _=0;_<n.length;_++){let w=this.registerMutation(n[_],f);w&&(a=a<0?w.from:Math.min(w.from,a),d=d<0?w.to:Math.max(w.to,d),w.typeOver&&(o=!0))}if(el&&f.length>1){let _=f.filter(w=>w.nodeName=="BR");if(_.length==2){let w=_[0],T=_[1];w.parentNode&&w.parentNode.parentNode==T.parentNode?T.remove():w.remove()}}let g=null;a<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&hw(i)&&(g=OA(e))&&g.eq($n.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,fc(e),this.currentSelection.set(i),e.scrollToSelection()):(a>-1||r)&&(a>-1&&(e.docView.markDirty(a,d),Gse(e)),this.handleDOMChange(a,d,o,f),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(i)||fc(e),this.currentSelection.set(i))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let i=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(i==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!i||i.ignoreMutation(e))return null;if(e.type=="childList"){for(let _=0;_<e.addedNodes.length;_++)n.push(e.addedNodes[_]);if(i.contentDOM&&i.contentDOM!=i.dom&&!i.contentDOM.contains(e.target))return{from:i.posBefore,to:i.posAfter};let r=e.previousSibling,a=e.nextSibling;if(ws&&Mu<=11&&e.addedNodes.length)for(let _=0;_<e.addedNodes.length;_++){let{previousSibling:w,nextSibling:T}=e.addedNodes[_];(!w||Array.prototype.indexOf.call(e.addedNodes,w)<0)&&(r=w),(!T||Array.prototype.indexOf.call(e.addedNodes,T)<0)&&(a=T)}let d=r&&r.parentNode==e.target?Xo(r)+1:0,o=i.localPosFromDOM(e.target,d,-1),f=a&&a.parentNode==e.target?Xo(a):e.target.childNodes.length,g=i.localPosFromDOM(e.target,f,1);return{from:o,to:g}}else return e.type=="attributes"?{from:i.posAtStart-i.border,to:i.posAtEnd+i.border}:{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let y3=new WeakMap,v3=!1;function Gse(t){if(!y3.has(t)&&(y3.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=el,v3)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),v3=!0}}function Hse(t){let e;function n(f){f.preventDefault(),f.stopImmediatePropagation(),e=f.getTargetRanges()[0]}t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0);let i=e.startContainer,r=e.startOffset,a=e.endContainer,d=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return Rh(o.node,o.offset,a,d)&&([i,r,a,d]=[a,d,i,r]),{anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:d}}function Zse(t,e,n){let{node:i,fromOffset:r,toOffset:a,from:d,to:o}=t.docView.parseRange(e,n),f=t.domSelectionRange(),g,_=f.anchorNode;if(_&&t.dom.contains(_.nodeType==1?_:_.parentNode)&&(g=[{node:_,offset:f.anchorOffset}],hw(f)||g.push({node:f.focusNode,offset:f.focusOffset})),zo&&t.input.lastKeyCode===8)for(let G=a;G>r;G--){let V=i.childNodes[G-1],N=V.pmViewDesc;if(V.nodeName=="BR"&&!N){a=G;break}if(!N||N.size)break}let w=t.state.doc,T=t.someProp("domParser")||kA.fromSchema(t.state.schema),A=w.resolve(d),D=null,z=T.parse(i,{topNode:A.parent,topMatch:A.parent.contentMatchAt(A.index()),topOpen:!0,from:r,to:a,preserveWhitespace:A.parent.type.whitespace=="pre"?"full":!0,findPositions:g,ruleFromNode:Xse,context:A});if(g&&g[0].pos!=null){let G=g[0].pos,V=g[1]&&g[1].pos;V==null&&(V=G),D={anchor:G+d,head:V+d}}return{doc:z,sel:D,from:d,to:o}}function Xse(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Yo&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Yo&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Kse=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Yse(t,e,n,i,r){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let te=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,me=OA(t,te);if(me&&!t.state.selection.eq(me)){if(zo&&qa&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",tt=>tt(t,Kd(13,"Enter"))))return;let Fe=t.state.tr.setSelection(me);te=="pointer"?Fe.setMeta("pointer",!0):te=="key"&&Fe.scrollIntoView(),a&&Fe.setMeta("composition",a),t.dispatch(Fe)}return}let d=t.state.doc.resolve(e),o=d.sharedDepth(n);e=d.before(o+1),n=t.state.doc.resolve(n).after(o+1);let f=t.state.selection,g=Zse(t,e,n),_=t.state.doc,w=_.slice(g.from,g.to),T,A;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(T=t.state.selection.to,A="end"):(T=t.state.selection.from,A="start"),t.input.lastKeyCode=null;let D=eae(w.content,g.doc.content,g.from,T,A);if((om&&t.input.lastIOSEnter>Date.now()-225||qa)&&r.some(te=>te.nodeType==1&&!Kse.test(te.nodeName))&&(!D||D.endA>=D.endB)&&t.someProp("handleKeyDown",te=>te(t,Kd(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!D)if(i&&f instanceof Bn&&!f.empty&&f.$head.sameParent(f.$anchor)&&!t.composing&&!(g.sel&&g.sel.anchor!=g.sel.head))D={start:f.from,endA:f.to,endB:f.to};else{if(g.sel){let te=b3(t,t.state.doc,g.sel);if(te&&!te.eq(t.state.selection)){let me=t.state.tr.setSelection(te);a&&me.setMeta("composition",a),t.dispatch(me)}}return}if(zo&&t.cursorWrapper&&g.sel&&g.sel.anchor==t.cursorWrapper.deco.from&&g.sel.head==g.sel.anchor){let te=D.endB-D.start;g.sel={anchor:g.sel.anchor+te,head:g.sel.anchor+te}}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&D.start==D.endB&&t.state.selection instanceof Bn&&(D.start>t.state.selection.from&&D.start<=t.state.selection.from+2&&t.state.selection.from>=g.from?D.start=t.state.selection.from:D.endA<t.state.selection.to&&D.endA>=t.state.selection.to-2&&t.state.selection.to<=g.to&&(D.endB+=t.state.selection.to-D.endA,D.endA=t.state.selection.to)),ws&&Mu<=11&&D.endB==D.start+1&&D.endA==D.start&&D.start>g.from&&g.doc.textBetween(D.start-g.from-1,D.start-g.from+1)=="  "&&(D.start--,D.endA--,D.endB--);let z=g.doc.resolveNoCache(D.start-g.from),G=g.doc.resolveNoCache(D.endB-g.from),V=_.resolve(D.start),N=z.sameParent(G)&&z.parent.inlineContent&&V.end()>=D.endA,q;if((om&&t.input.lastIOSEnter>Date.now()-225&&(!N||r.some(te=>te.nodeName=="DIV"||te.nodeName=="P"))||!N&&z.pos<g.doc.content.size&&!z.sameParent(G)&&(q=$n.findFrom(g.doc.resolve(z.pos+1),1,!0))&&q.head==G.pos)&&t.someProp("handleKeyDown",te=>te(t,Kd(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>D.start&&Qse(_,D.start,D.endA,z,G)&&t.someProp("handleKeyDown",te=>te(t,Kd(8,"Backspace")))){qa&&zo&&t.domObserver.suppressSelectionUpdates();return}zo&&qa&&D.endB==D.start&&(t.input.lastAndroidDelete=Date.now()),qa&&!N&&z.start()!=G.start()&&G.parentOffset==0&&z.depth==G.depth&&g.sel&&g.sel.anchor==g.sel.head&&g.sel.head==D.endA&&(D.endB-=2,G=g.doc.resolveNoCache(D.endB-g.from),setTimeout(()=>{t.someProp("handleKeyDown",function(te){return te(t,Kd(13,"Enter"))})},20));let K=D.start,se=D.endA,ie,Q,J;if(N){if(z.pos==G.pos)ws&&Mu<=11&&z.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>fc(t),20)),ie=t.state.tr.delete(K,se),Q=_.resolve(D.start).marksAcross(_.resolve(D.endA));else if(D.endA==D.endB&&(J=Jse(z.parent.content.cut(z.parentOffset,G.parentOffset),V.parent.content.cut(V.parentOffset,D.endA-V.start()))))ie=t.state.tr,J.type=="add"?ie.addMark(K,se,J.mark):ie.removeMark(K,se,J.mark);else if(z.parent.child(z.index()).isText&&z.index()==G.index()-(G.textOffset?0:1)){let te=z.parent.textBetween(z.parentOffset,G.parentOffset);if(t.someProp("handleTextInput",me=>me(t,K,se,te)))return;ie=t.state.tr.insertText(te,K,se)}}if(ie||(ie=t.state.tr.replace(K,se,g.doc.slice(D.start-g.from,D.endB-g.from))),g.sel){let te=b3(t,ie.doc,g.sel);te&&!(zo&&qa&&t.composing&&te.empty&&(D.start!=D.endB||t.input.lastAndroidDelete<Date.now()-100)&&(te.head==K||te.head==ie.mapping.map(se)-1)||ws&&te.empty&&te.head==K)&&ie.setSelection(te)}Q&&ie.ensureMarks(Q),a&&ie.setMeta("composition",a),t.dispatch(ie.scrollIntoView())}function b3(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:DA(t,e.resolve(n.anchor),e.resolve(n.head))}function Jse(t,e){let n=t.firstChild.marks,i=e.firstChild.marks,r=n,a=i,d,o,f;for(let _=0;_<i.length;_++)r=i[_].removeFromSet(r);for(let _=0;_<n.length;_++)a=n[_].removeFromSet(a);if(r.length==1&&a.length==0)o=r[0],d="add",f=_=>_.mark(o.addToSet(_.marks));else if(r.length==0&&a.length==1)o=a[0],d="remove",f=_=>_.mark(o.removeFromSet(_.marks));else return null;let g=[];for(let _=0;_<e.childCount;_++)g.push(f(e.child(_)));if(Ft.from(g).eq(t))return{mark:o,type:d}}function Qse(t,e,n,i,r){if(!i.parent.isTextblock||n-e<=r.pos-i.pos||Tk(i,!0,!1)<r.pos)return!1;let a=t.resolve(e);if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let d=t.resolve(Tk(a,!0,!0));return!d.parent.isTextblock||d.pos>n||Tk(d,!0,!1)<n?!1:i.parent.content.cut(i.parentOffset).eq(d.parent.content)}function Tk(t,e,n){let i=t.depth,r=e?t.end():t.pos;for(;i>0&&(e||t.indexAfter(i)==t.node(i).childCount);)i--,r++,e=!1;if(n){let a=t.node(i).maybeChild(t.indexAfter(i));for(;a&&!a.isLeaf;)a=a.firstChild,r++}return r}function eae(t,e,n,i,r){let a=t.findDiffStart(e,n);if(a==null)return null;let{a:d,b:o}=t.findDiffEnd(e,n+t.size,n+e.size);if(r=="end"){let f=Math.max(0,a-Math.min(d,o));i-=d+f-a}if(d<a&&t.size<e.size){let f=i<=a&&i>=d?a-i:0;a-=f,o=a+(o-d),d=a}else if(o<a){let f=i<=a&&i>=o?a-i:0;a-=f,d=a+(d-o),o=a}return{start:a,endA:d,endB:o}}class tae{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new xse,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(E3),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=w3(this),x3(this),this.nodeViews=S3(this),this.docView=n3(this.state.doc,_3(this),kk(this),this.dom,this),this.domObserver=new Wse(this,(i,r,a,d)=>Yse(this,i,r,a,d)),this.domObserver.start(),wse(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&XC(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(E3),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let i in this._props)n[i]=this._props[i];n.state=this.state;for(let i in e)n[i]=e[i];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){let i=this.state,r=!1,a=!1;e.storedMarks&&this.composing&&(ej(this),a=!0),this.state=e;let d=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(d||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let T=S3(this);iae(T,this.nodeViews)&&(this.nodeViews=T,r=!0)}(d||n.handleDOMEvents!=this._props.handleDOMEvents)&&XC(this),this.editable=w3(this),x3(this);let o=kk(this),f=_3(this),g=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",_=r||!this.docView.matchesNode(e.doc,f,o);(_||!e.selection.eq(i.selection))&&(a=!0);let w=g=="preserve"&&a&&this.dom.style.overflowAnchor==null&&zoe(this);if(a){this.domObserver.stop();let T=_&&(ws||zo)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&nae(i.selection,e.selection);if(_){let A=zo?this.trackWrites=this.domSelectionRange().focusNode:null;(r||!this.docView.update(e.doc,f,o,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=n3(e.doc,f,o,this.dom,this)),A&&!this.trackWrites&&(T=!0)}T||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&ase(this))?fc(this,T):(j6(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),g=="reset"?this.dom.scrollTop=0:g=="to selection"?this.scrollToSelection():w&&Boe(w)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof Cn){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&Kz(this,n.getBoundingClientRect(),e)}else Kz(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let i=this.state.plugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let i=this.pluginViews[n];i.update&&i.update(this,e)}}someProp(e,n){let i=this._props&&this._props[e],r;if(i!=null&&(r=n?n(i):i))return r;for(let d=0;d<this.directPlugins.length;d++){let o=this.directPlugins[d].props[e];if(o!=null&&(r=n?n(o):o))return r}let a=this.state.plugins;if(a)for(let d=0;d<a.length;d++){let o=a[d].props[e];if(o!=null&&(r=n?n(o):o))return r}}hasFocus(){if(ws){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&Foe(this.dom),fc(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Uoe(this,e)}coordsAtPos(e,n=1){return D6(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,i=-1){let r=this.docView.posFromDOM(e,n,i);if(r==null)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,n){return Zoe(this,n||this.state,e)}pasteHTML(e,n){return Cv(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Cv(this,e,null,!0,n||new ClipboardEvent("paste"))}destroy(){this.docView&&(Sse(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],kk(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return kse(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Yo&&this.root.nodeType===11&&Aoe(this.dom.ownerDocument)==this.dom?Hse(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function _3(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let i in n)i=="class"?e.class+=" "+n[i]:i=="style"?e.style=(e.style?e.style+";":"")+n[i]:!e[i]&&i!="contenteditable"&&i!="nodeName"&&(e[i]=String(n[i]))}),e.translate||(e.translate="no"),[ca.node(0,t.state.doc.content.size,e)]}function x3(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:ca.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function w3(t){return!t.someProp("editable",e=>e(t.state)===!1)}function nae(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function S3(t){let e=Object.create(null);function n(i){for(let r in i)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=i[r])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function iae(t,e){let n=0,i=0;for(let r in t){if(t[r]!=e[r])return!0;n++}for(let r in e)i++;return n!=i}function E3(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Uu={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Xx={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},rae=typeof navigator<"u"&&/Mac/.test(navigator.platform),oae=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var bo=0;bo<10;bo++)Uu[48+bo]=Uu[96+bo]=String(bo);for(var bo=1;bo<=24;bo++)Uu[bo+111]="F"+bo;for(var bo=65;bo<=90;bo++)Uu[bo]=String.fromCharCode(bo+32),Xx[bo]=String.fromCharCode(bo);for(var Ck in Uu)Xx.hasOwnProperty(Ck)||(Xx[Ck]=Uu[Ck]);function sae(t){var e=rae&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||oae&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Xx:Uu)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const aae=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function lae(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let i,r,a,d;for(let o=0;o<e.length-1;o++){let f=e[o];if(/^(cmd|meta|m)$/i.test(f))d=!0;else if(/^a(lt)?$/i.test(f))i=!0;else if(/^(c|ctrl|control)$/i.test(f))r=!0;else if(/^s(hift)?$/i.test(f))a=!0;else if(/^mod$/i.test(f))aae?d=!0:r=!0;else throw new Error("Unrecognized modifier name: "+f)}return i&&(n="Alt-"+n),r&&(n="Ctrl-"+n),d&&(n="Meta-"+n),a&&(n="Shift-"+n),n}function cae(t){let e=Object.create(null);for(let n in t)e[lae(n)]=t[n];return e}function Ik(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function uae(t){return new ya({props:{handleKeyDown:oj(t)}})}function oj(t){let e=cae(t);return function(n,i){let r=sae(i),a,d=e[Ik(r,i)];if(d&&d(n.state,n.dispatch,n))return!0;if(r.length==1&&r!=" "){if(i.shiftKey){let o=e[Ik(r,i,!1)];if(o&&o(n.state,n.dispatch,n))return!0}if((i.shiftKey||i.altKey||i.metaKey||r.charCodeAt(0)>127)&&(a=Uu[i.keyCode])&&a!=r){let o=e[Ik(a,i)];if(o&&o(n.state,n.dispatch,n))return!0}}return!1}}const dae=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function hae(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const fae=(t,e,n)=>{let i=hae(t,n);if(!i)return!1;let r=sj(i);if(!r){let d=i.blockRange(),o=d&&km(d);return o==null?!1:(e&&e(t.tr.lift(d,o).scrollIntoView()),!0)}let a=r.nodeBefore;if(!a.type.spec.isolating&&cj(t,r,e))return!0;if(i.parent.content.size==0&&(am(a,"end")||Cn.isSelectable(a))){let d=IA(t.doc,i.before(),i.after(),nn.empty);if(d&&d.slice.size<d.to-d.from){if(e){let o=t.tr.step(d);o.setSelection(am(a,"end")?$n.findFrom(o.doc.resolve(o.mapping.map(r.pos,-1)),-1):Cn.create(o.doc,r.pos-a.nodeSize)),e(o.scrollIntoView())}return!0}}return a.isAtom&&r.depth==i.depth-1?(e&&e(t.tr.delete(r.pos-a.nodeSize,r.pos).scrollIntoView()),!0):!1};function am(t,e,n=!1){for(let i=t;i;i=e=="start"?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&i.childCount!=1)return!1}return!1}const pae=(t,e,n)=>{let{$head:i,empty:r}=t.selection,a=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):i.parentOffset>0)return!1;a=sj(i)}let d=a&&a.nodeBefore;return!d||!Cn.isSelectable(d)?!1:(e&&e(t.tr.setSelection(Cn.create(t.doc,a.pos-d.nodeSize)).scrollIntoView()),!0)};function sj(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function mae(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const gae=(t,e,n)=>{let i=mae(t,n);if(!i)return!1;let r=aj(i);if(!r)return!1;let a=r.nodeAfter;if(cj(t,r,e))return!0;if(i.parent.content.size==0&&(am(a,"start")||Cn.isSelectable(a))){let d=IA(t.doc,i.before(),i.after(),nn.empty);if(d&&d.slice.size<d.to-d.from){if(e){let o=t.tr.step(d);o.setSelection(am(a,"start")?$n.findFrom(o.doc.resolve(o.mapping.map(r.pos)),1):Cn.create(o.doc,o.mapping.map(r.pos))),e(o.scrollIntoView())}return!0}}return a.isAtom&&r.depth==i.depth-1?(e&&e(t.tr.delete(r.pos,r.pos+a.nodeSize).scrollIntoView()),!0):!1},yae=(t,e,n)=>{let{$head:i,empty:r}=t.selection,a=i;if(!r)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):i.parentOffset<i.parent.content.size)return!1;a=aj(i)}let d=a&&a.nodeAfter;return!d||!Cn.isSelectable(d)?!1:(e&&e(t.tr.setSelection(Cn.create(t.doc,a.pos)).scrollIntoView()),!0)};function aj(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const vae=(t,e)=>{let n=t.selection,i=n instanceof Cn,r;if(i){if(n.node.isTextblock||!Ju(t.doc,n.from))return!1;r=n.from}else if(r=uw(t.doc,n.from,-1),r==null)return!1;if(e){let a=t.tr.join(r);i&&a.setSelection(Cn.create(a.doc,r-t.doc.resolve(r).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},bae=(t,e)=>{let n=t.selection,i;if(n instanceof Cn){if(n.node.isTextblock||!Ju(t.doc,n.to))return!1;i=n.to}else if(i=uw(t.doc,n.to,1),i==null)return!1;return e&&e(t.tr.join(i).scrollIntoView()),!0},_ae=(t,e)=>{let{$from:n,$to:i}=t.selection,r=n.blockRange(i),a=r&&km(r);return a==null?!1:(e&&e(t.tr.lift(r,a).scrollIntoView()),!0)},xae=(t,e)=>{let{$head:n,$anchor:i}=t.selection;return!n.parent.type.spec.code||!n.sameParent(i)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function lj(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const wae=(t,e)=>{let{$head:n,$anchor:i}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let r=n.node(-1),a=n.indexAfter(-1),d=lj(r.contentMatchAt(a));if(!d||!r.canReplaceWith(a,a,d))return!1;if(e){let o=n.after(),f=t.tr.replaceWith(o,o,d.createAndFill());f.setSelection($n.near(f.doc.resolve(o),1)),e(f.scrollIntoView())}return!0},Sae=(t,e)=>{let n=t.selection,{$from:i,$to:r}=n;if(n instanceof Ja||i.parent.inlineContent||r.parent.inlineContent)return!1;let a=lj(r.parent.contentMatchAt(r.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let d=(!i.parentOffset&&r.index()<r.parent.childCount?i:r).pos,o=t.tr.insert(d,a.createAndFill());o.setSelection(Bn.create(o.doc,d+1)),e(o.scrollIntoView())}return!0},Eae=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let a=n.before();if(Fp(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let i=n.blockRange(),r=i&&km(i);return r==null?!1:(e&&e(t.tr.lift(i,r).scrollIntoView()),!0)},kae=(t,e)=>{let{$from:n,to:i}=t.selection,r,a=n.sharedDepth(i);return a==0?!1:(r=n.before(a),e&&e(t.tr.setSelection(Cn.create(t.doc,r))),!0)};function Tae(t,e,n){let i=e.nodeBefore,r=e.nodeAfter,a=e.index();return!i||!r||!i.type.compatibleContent(r.type)?!1:!i.content.size&&e.parent.canReplace(a-1,a)?(n&&n(t.tr.delete(e.pos-i.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(r.isTextblock||Ju(t.doc,e.pos))?!1:(n&&n(t.tr.clearIncompatible(e.pos,i.type,i.contentMatchAt(i.childCount)).join(e.pos).scrollIntoView()),!0)}function cj(t,e,n){let i=e.nodeBefore,r=e.nodeAfter,a,d;if(i.type.spec.isolating||r.type.spec.isolating)return!1;if(Tae(t,e,n))return!0;let o=e.parent.canReplace(e.index(),e.index()+1);if(o&&(a=(d=i.contentMatchAt(i.childCount)).findWrapping(r.type))&&d.matchType(a[0]||r.type).validEnd){if(n){let w=e.pos+r.nodeSize,T=Ft.empty;for(let z=a.length-1;z>=0;z--)T=Ft.from(a[z].create(null,T));T=Ft.from(i.copy(T));let A=t.tr.step(new ao(e.pos-1,w,e.pos,w,new nn(T,1,0),a.length,!0)),D=w+2*a.length;Ju(A.doc,D)&&A.join(D),n(A.scrollIntoView())}return!0}let f=$n.findFrom(e,1),g=f&&f.$from.blockRange(f.$to),_=g&&km(g);if(_!=null&&_>=e.depth)return n&&n(t.tr.lift(g,_).scrollIntoView()),!0;if(o&&am(r,"start",!0)&&am(i,"end")){let w=i,T=[];for(;T.push(w),!w.isTextblock;)w=w.lastChild;let A=r,D=1;for(;!A.isTextblock;A=A.firstChild)D++;if(w.canReplace(w.childCount,w.childCount,A.content)){if(n){let z=Ft.empty;for(let V=T.length-1;V>=0;V--)z=Ft.from(T[V].copy(z));let G=t.tr.step(new ao(e.pos-T.length,e.pos+r.nodeSize,e.pos+D,e.pos+r.nodeSize-D,new nn(z,T.length,0),0,!0));n(G.scrollIntoView())}return!0}}return!1}function uj(t){return function(e,n){let i=e.selection,r=t<0?i.$from:i.$to,a=r.depth;for(;r.node(a).isInline;){if(!a)return!1;a--}return r.node(a).isTextblock?(n&&n(e.tr.setSelection(Bn.create(e.doc,t<0?r.start(a):r.end(a)))),!0):!1}}const Cae=uj(-1),Iae=uj(1);function Aae(t,e=null){return function(n,i){let{$from:r,$to:a}=n.selection,d=r.blockRange(a),o=d&&CA(d,t,e);return o?(i&&i(n.tr.wrap(d,o).scrollIntoView()),!0):!1}}function k3(t,e=null){return function(n,i){let r=!1;for(let a=0;a<n.selection.ranges.length&&!r;a++){let{$from:{pos:d},$to:{pos:o}}=n.selection.ranges[a];n.doc.nodesBetween(d,o,(f,g)=>{if(r)return!1;if(!(!f.isTextblock||f.hasMarkup(t,e)))if(f.type==t)r=!0;else{let _=n.doc.resolve(g),w=_.index();r=_.parent.canReplaceWith(w,w+1,t)}})}if(!r)return!1;if(i){let a=n.tr;for(let d=0;d<n.selection.ranges.length;d++){let{$from:{pos:o},$to:{pos:f}}=n.selection.ranges[d];a.setBlockType(o,f,t,e)}i(a.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Mae(t,e=null){return function(n,i){let{$from:r,$to:a}=n.selection,d=r.blockRange(a),o=!1,f=d;if(!d)return!1;if(d.depth>=2&&r.node(d.depth-1).type.compatibleContent(t)&&d.startIndex==0){if(r.index(d.depth-1)==0)return!1;let _=n.doc.resolve(d.start-2);f=new jx(_,_,d.depth),d.endIndex<d.parent.childCount&&(d=new jx(r,n.doc.resolve(a.end(d.depth)),d.depth)),o=!0}let g=CA(f,t,e,d);return g?(i&&i(Pae(n.tr,d,g,o,t).scrollIntoView()),!0):!1}}function Pae(t,e,n,i,r){let a=Ft.empty;for(let _=n.length-1;_>=0;_--)a=Ft.from(n[_].type.create(n[_].attrs,a));t.step(new ao(e.start-(i?2:0),e.end,e.start,e.end,new nn(a,0,0),n.length,!0));let d=0;for(let _=0;_<n.length;_++)n[_].type==r&&(d=_+1);let o=n.length-d,f=e.start+n.length-(i?2:0),g=e.parent;for(let _=e.startIndex,w=e.endIndex,T=!0;_<w;_++,T=!1)!T&&Fp(t.doc,f,o)&&(t.split(f,o),f+=2*o),f+=g.child(_).nodeSize;return t}function Oae(t){return function(e,n){let{$from:i,$to:r}=e.selection,a=i.blockRange(r,d=>d.childCount>0&&d.firstChild.type==t);return a?n?i.node(a.depth-1).type==t?Dae(e,n,t,a):Rae(e,n,a):!0:!1}}function Dae(t,e,n,i){let r=t.tr,a=i.end,d=i.$to.end(i.depth);a<d&&(r.step(new ao(a-1,d,a,d,new nn(Ft.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new jx(r.doc.resolve(i.$from.pos),r.doc.resolve(d),i.depth));const o=km(i);if(o==null)return!1;r.lift(i,o);let f=r.mapping.map(a,-1)-1;return Ju(r.doc,f)&&r.join(f),e(r.scrollIntoView()),!0}function Rae(t,e,n){let i=t.tr,r=n.parent;for(let A=n.end,D=n.endIndex-1,z=n.startIndex;D>z;D--)A-=r.child(D).nodeSize,i.delete(A-1,A+1);let a=i.doc.resolve(n.start),d=a.nodeAfter;if(i.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;let o=n.startIndex==0,f=n.endIndex==r.childCount,g=a.node(-1),_=a.index(-1);if(!g.canReplace(_+(o?0:1),_+1,d.content.append(f?Ft.empty:Ft.from(r))))return!1;let w=a.pos,T=w+d.nodeSize;return i.step(new ao(w-(o?1:0),T+(f?1:0),w+1,T-1,new nn((o?Ft.empty:Ft.from(r.copy(Ft.empty))).append(f?Ft.empty:Ft.from(r.copy(Ft.empty))),o?0:1,f?0:1),o?0:1)),e(i.scrollIntoView()),!0}function Lae(t){return function(e,n){let{$from:i,$to:r}=e.selection,a=i.blockRange(r,g=>g.childCount>0&&g.firstChild.type==t);if(!a)return!1;let d=a.startIndex;if(d==0)return!1;let o=a.parent,f=o.child(d-1);if(f.type!=t)return!1;if(n){let g=f.lastChild&&f.lastChild.type==o.type,_=Ft.from(g?t.create():null),w=new nn(Ft.from(t.create(null,Ft.from(o.type.create(null,_)))),g?3:1,0),T=a.start,A=a.end;n(e.tr.step(new ao(T-(g?3:1),A,T,A,w,1,!0)).scrollIntoView())}return!0}}function mw(t){const{state:e,transaction:n}=t;let{selection:i}=n,{doc:r}=n,{storedMarks:a}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return i},get doc(){return r},get tr(){return i=n.selection,r=n.doc,a=n.storedMarks,n}}}class gw{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:i}=this,{view:r}=n,{tr:a}=i,d=this.buildProps(a);return Object.fromEntries(Object.entries(e).map(([o,f])=>[o,(..._)=>{const w=f(..._)(d);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(a),w}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:i,editor:r,state:a}=this,{view:d}=r,o=[],f=!!e,g=e||a.tr,_=()=>(!f&&n&&!g.getMeta("preventDispatch")&&!this.hasCustomState&&d.dispatch(g),o.every(T=>T===!0)),w={...Object.fromEntries(Object.entries(i).map(([T,A])=>[T,(...z)=>{const G=this.buildProps(g,n),V=A(...z)(G);return o.push(V),w}])),run:_};return w}createCan(e){const{rawCommands:n,state:i}=this,r=!1,a=e||i.tr,d=this.buildProps(a,r);return{...Object.fromEntries(Object.entries(n).map(([f,g])=>[f,(..._)=>g(..._)({...d,dispatch:void 0})])),chain:()=>this.createChain(a,r)}}buildProps(e,n=!0){const{rawCommands:i,editor:r,state:a}=this,{view:d}=r,o={tr:e,editor:r,view:d,state:mw({state:a,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(i).map(([f,g])=>[f,(..._)=>g(..._)(o)]))}};return o}}class zae{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const i=this.callbacks[e];return i&&i.forEach(r=>r.apply(this,n)),this}off(e,n){const i=this.callbacks[e];return i&&(n?this.callbacks[e]=i.filter(r=>r!==n):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function hn(t,e,n){return t.config[e]===void 0&&t.parent?hn(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?hn(t.parent,e,n):null}):t.config[e]}function yw(t){const e=t.filter(r=>r.type==="extension"),n=t.filter(r=>r.type==="node"),i=t.filter(r=>r.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:i}}function dj(t){const e=[],{nodeExtensions:n,markExtensions:i}=yw(t),r=[...n,...i],a={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(d=>{const o={name:d.name,options:d.options,storage:d.storage},f=hn(d,"addGlobalAttributes",o);if(!f)return;f().forEach(_=>{_.types.forEach(w=>{Object.entries(_.attributes).forEach(([T,A])=>{e.push({type:w,name:T,attribute:{...a,...A}})})})})}),r.forEach(d=>{const o={name:d.name,options:d.options,storage:d.storage},f=hn(d,"addAttributes",o);if(!f)return;const g=f();Object.entries(g).forEach(([_,w])=>{const T={...a,...w};typeof(T==null?void 0:T.default)=="function"&&(T.default=T.default()),T!=null&&T.isRequired&&(T==null?void 0:T.default)===void 0&&delete T.default,e.push({type:d.name,name:_,attribute:T})})}),e}function uo(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function Yr(...t){return t.filter(e=>!!e).reduce((e,n)=>{const i={...e};return Object.entries(n).forEach(([r,a])=>{if(!i[r]){i[r]=a;return}if(r==="class"){const o=a?a.split(" "):[],f=i[r]?i[r].split(" "):[],g=o.filter(_=>!f.includes(_));i[r]=[...f,...g].join(" ")}else r==="style"?i[r]=[i[r],a].join("; "):i[r]=a}),i},{})}function KC(t,e){return e.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,i)=>Yr(n,i),{})}function hj(t){return typeof t=="function"}function Nn(t,e=void 0,...n){return hj(t)?e?t.bind(e)(...n):t(...n):t}function Bae(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Fae(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function T3(t,e){return t.style?t:{...t,getAttrs:n=>{const i=t.getAttrs?t.getAttrs(n):t.attrs;if(i===!1)return!1;const r=e.reduce((a,d)=>{const o=d.attribute.parseHTML?d.attribute.parseHTML(n):Fae(n.getAttribute(d.name));return o==null?a:{...a,[d.name]:o}},{});return{...i,...r}}}}function C3(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&Bae(n)?!1:n!=null))}function Nae(t,e){var n;const i=dj(t),{nodeExtensions:r,markExtensions:a}=yw(t),d=(n=r.find(g=>hn(g,"topNode")))===null||n===void 0?void 0:n.name,o=Object.fromEntries(r.map(g=>{const _=i.filter(V=>V.type===g.name),w={name:g.name,options:g.options,storage:g.storage,editor:e},T=t.reduce((V,N)=>{const q=hn(N,"extendNodeSchema",w);return{...V,...q?q(g):{}}},{}),A=C3({...T,content:Nn(hn(g,"content",w)),marks:Nn(hn(g,"marks",w)),group:Nn(hn(g,"group",w)),inline:Nn(hn(g,"inline",w)),atom:Nn(hn(g,"atom",w)),selectable:Nn(hn(g,"selectable",w)),draggable:Nn(hn(g,"draggable",w)),code:Nn(hn(g,"code",w)),defining:Nn(hn(g,"defining",w)),isolating:Nn(hn(g,"isolating",w)),attrs:Object.fromEntries(_.map(V=>{var N;return[V.name,{default:(N=V==null?void 0:V.attribute)===null||N===void 0?void 0:N.default}]}))}),D=Nn(hn(g,"parseHTML",w));D&&(A.parseDOM=D.map(V=>T3(V,_)));const z=hn(g,"renderHTML",w);z&&(A.toDOM=V=>z({node:V,HTMLAttributes:KC(V,_)}));const G=hn(g,"renderText",w);return G&&(A.toText=G),[g.name,A]})),f=Object.fromEntries(a.map(g=>{const _=i.filter(G=>G.type===g.name),w={name:g.name,options:g.options,storage:g.storage,editor:e},T=t.reduce((G,V)=>{const N=hn(V,"extendMarkSchema",w);return{...G,...N?N(g):{}}},{}),A=C3({...T,inclusive:Nn(hn(g,"inclusive",w)),excludes:Nn(hn(g,"excludes",w)),group:Nn(hn(g,"group",w)),spanning:Nn(hn(g,"spanning",w)),code:Nn(hn(g,"code",w)),attrs:Object.fromEntries(_.map(G=>{var V;return[G.name,{default:(V=G==null?void 0:G.attribute)===null||V===void 0?void 0:V.default}]}))}),D=Nn(hn(g,"parseHTML",w));D&&(A.parseDOM=D.map(G=>T3(G,_)));const z=hn(g,"renderHTML",w);return z&&(A.toDOM=G=>z({mark:G,HTMLAttributes:KC(G,_)})),[g.name,A]}));return new Hre({topNode:d,nodes:o,marks:f})}function Ak(t,e){return e.nodes[t]||e.marks[t]||null}function I3(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}const $ae=(t,e=500)=>{let n="";const i=t.parentOffset;return t.parent.nodesBetween(Math.max(0,i-e),i,(r,a,d,o)=>{var f,g;const _=((g=(f=r.type.spec).toText)===null||g===void 0?void 0:g.call(f,{node:r,pos:a,parent:d,index:o}))||r.textContent||"%leaf%";n+=_.slice(0,Math.max(0,i-a))}),n};function NA(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class vw{constructor(e){this.find=e.find,this.handler=e.handler}}const jae=(t,e)=>{if(NA(e))return e.exec(t);const n=e(t);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=t,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i};function Mk(t){var e;const{editor:n,from:i,to:r,text:a,rules:d,plugin:o}=t,{view:f}=n;if(f.composing)return!1;const g=f.state.doc.resolve(i);if(g.parent.type.spec.code||!((e=g.nodeBefore||g.nodeAfter)===null||e===void 0)&&e.marks.find(T=>T.type.spec.code))return!1;let _=!1;const w=$ae(g)+a;return d.forEach(T=>{if(_)return;const A=jae(w,T.find);if(!A)return;const D=f.state.tr,z=mw({state:f.state,transaction:D}),G={from:i-(A[0].length-a.length),to:r},{commands:V,chain:N,can:q}=new gw({editor:n,state:z});T.handler({state:z,range:G,match:A,commands:V,chain:N,can:q})===null||!D.steps.length||(D.setMeta(o,{transform:D,from:i,to:r,text:a}),f.dispatch(D),_=!0)}),_}function Vae(t){const{editor:e,rules:n}=t,i=new ya({state:{init(){return null},apply(r,a){const d=r.getMeta(i);return d||(r.selectionSet||r.docChanged?null:a)}},props:{handleTextInput(r,a,d,o){return Mk({editor:e,from:a,to:d,text:o,rules:n,plugin:i})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:a}=r.state.selection;a&&Mk({editor:e,from:a.pos,to:a.pos,text:"",rules:n,plugin:i})}),!1)},handleKeyDown(r,a){if(a.key!=="Enter")return!1;const{$cursor:d}=r.state.selection;return d?Mk({editor:e,from:d.pos,to:d.pos,text:`
`,rules:n,plugin:i}):!1}},isInputRules:!0});return i}function Uae(t){return typeof t=="number"}class qae{constructor(e){this.find=e.find,this.handler=e.handler}}const Wae=(t,e)=>{if(NA(e))return[...t.matchAll(e)];const n=e(t);return n?n.map(i=>{const r=[i.text];return r.index=i.index,r.input=t,r.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),r.push(i.replaceWith)),r}):[]};function Gae(t){const{editor:e,state:n,from:i,to:r,rule:a,pasteEvent:d,dropEvent:o}=t,{commands:f,chain:g,can:_}=new gw({editor:e,state:n}),w=[];return n.doc.nodesBetween(i,r,(A,D)=>{if(!A.isTextblock||A.type.spec.code)return;const z=Math.max(i,D),G=Math.min(r,D+A.content.size),V=A.textBetween(z-D,G-D,void 0,"￼");Wae(V,a.find).forEach(q=>{if(q.index===void 0)return;const K=z+q.index+1,se=K+q[0].length,ie={from:n.tr.mapping.map(K),to:n.tr.mapping.map(se)},Q=a.handler({state:n,range:ie,match:q,commands:f,chain:g,can:_,pasteEvent:d,dropEvent:o});w.push(Q)})}),w.every(A=>A!==null)}function Hae(t){const{editor:e,rules:n}=t;let i=null,r=!1,a=!1,d=new ClipboardEvent("paste"),o=new DragEvent("drop");return n.map(g=>new ya({view(_){const w=T=>{var A;i=!((A=_.dom.parentElement)===null||A===void 0)&&A.contains(T.target)?_.dom.parentElement:null};return window.addEventListener("dragstart",w),{destroy(){window.removeEventListener("dragstart",w)}}},props:{handleDOMEvents:{drop:(_,w)=>(a=i===_.dom.parentElement,o=w,!1),paste:(_,w)=>{var T;const A=(T=w.clipboardData)===null||T===void 0?void 0:T.getData("text/html");return d=w,r=!!(A!=null&&A.includes("data-pm-slice")),!1}}},appendTransaction:(_,w,T)=>{const A=_[0],D=A.getMeta("uiEvent")==="paste"&&!r,z=A.getMeta("uiEvent")==="drop"&&!a;if(!D&&!z)return;const G=w.doc.content.findDiffStart(T.doc.content),V=w.doc.content.findDiffEnd(T.doc.content);if(!Uae(G)||!V||G===V.b)return;const N=T.tr,q=mw({state:T,transaction:N});if(!(!Gae({editor:e,state:q,from:Math.max(G-1,0),to:V.b-1,rule:g,pasteEvent:d,dropEvent:o})||!N.steps.length))return o=new DragEvent("drop"),d=new ClipboardEvent("paste"),N}}))}function Zae(t){const e=t.filter((n,i)=>t.indexOf(n)!==i);return[...new Set(e)]}class wp{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=wp.resolve(e),this.schema=Nae(this.extensions,n),this.extensions.forEach(i=>{var r;this.editor.extensionStorage[i.name]=i.storage;const a={name:i.name,options:i.options,storage:i.storage,editor:this.editor,type:Ak(i.name,this.schema)};i.type==="mark"&&(!((r=Nn(hn(i,"keepOnSplit",a)))!==null&&r!==void 0)||r)&&this.splittableMarks.push(i.name);const d=hn(i,"onBeforeCreate",a);d&&this.editor.on("beforeCreate",d);const o=hn(i,"onCreate",a);o&&this.editor.on("create",o);const f=hn(i,"onUpdate",a);f&&this.editor.on("update",f);const g=hn(i,"onSelectionUpdate",a);g&&this.editor.on("selectionUpdate",g);const _=hn(i,"onTransaction",a);_&&this.editor.on("transaction",_);const w=hn(i,"onFocus",a);w&&this.editor.on("focus",w);const T=hn(i,"onBlur",a);T&&this.editor.on("blur",T);const A=hn(i,"onDestroy",a);A&&this.editor.on("destroy",A)})}static resolve(e){const n=wp.sort(wp.flatten(e)),i=Zae(n.map(r=>r.name));return i.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${i.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const i={name:n.name,options:n.options,storage:n.storage},r=hn(n,"addExtensions",i);return r?[n,...this.flatten(r())]:n}).flat(10)}static sort(e){return e.sort((i,r)=>{const a=hn(i,"priority")||100,d=hn(r,"priority")||100;return a>d?-1:a<d?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const i={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Ak(n.name,this.schema)},r=hn(n,"addCommands",i);return r?{...e,...r()}:e},{})}get plugins(){const{editor:e}=this,n=wp.sort([...this.extensions].reverse()),i=[],r=[],a=n.map(d=>{const o={name:d.name,options:d.options,storage:d.storage,editor:e,type:Ak(d.name,this.schema)},f=[],g=hn(d,"addKeyboardShortcuts",o);let _={};if(d.type==="mark"&&d.config.exitable&&(_.ArrowRight=()=>Rl.handleExit({editor:e,mark:d})),g){const z=Object.fromEntries(Object.entries(g()).map(([G,V])=>[G,()=>V({editor:e})]));_={..._,...z}}const w=uae(_);f.push(w);const T=hn(d,"addInputRules",o);I3(d,e.options.enableInputRules)&&T&&i.push(...T());const A=hn(d,"addPasteRules",o);I3(d,e.options.enablePasteRules)&&A&&r.push(...A());const D=hn(d,"addProseMirrorPlugins",o);if(D){const z=D();f.push(...z)}return f}).flat();return[Vae({editor:e,rules:i}),...Hae({editor:e,rules:r}),...a]}get attributes(){return dj(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=yw(this.extensions);return Object.fromEntries(n.filter(i=>!!hn(i,"addNodeView")).map(i=>{const r=this.attributes.filter(f=>f.type===i.name),a={name:i.name,options:i.options,storage:i.storage,editor:e,type:uo(i.name,this.schema)},d=hn(i,"addNodeView",a);if(!d)return[];const o=(f,g,_,w)=>{const T=KC(f,r);return d()({editor:e,node:f,getPos:_,decorations:w,HTMLAttributes:T,extension:i})};return[i.name,o]}))}}function Xae(t){return Object.prototype.toString.call(t).slice(8,-1)}function Pk(t){return Xae(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function bw(t,e){const n={...t};return Pk(t)&&Pk(e)&&Object.keys(e).forEach(i=>{Pk(e[i])?i in t?n[i]=bw(t[i],e[i]):Object.assign(n,{[i]:e[i]}):Object.assign(n,{[i]:e[i]})}),n}class Es{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Nn(hn(this,"addOptions",{name:this.name}))),this.storage=Nn(hn(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Es(e)}configure(e={}){const n=this.extend();return n.options=bw(this.options,e),n.storage=Nn(hn(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new Es(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Nn(hn(n,"addOptions",{name:n.name})),n.storage=Nn(hn(n,"addStorage",{name:n.name,options:n.options})),n}}function fj(t,e,n){const{from:i,to:r}=e,{blockSeparator:a=`

`,textSerializers:d={}}=n||{};let o="",f=!0;return t.nodesBetween(i,r,(g,_,w,T)=>{var A;const D=d==null?void 0:d[g.type.name];D?(g.isBlock&&!f&&(o+=a,f=!0),w&&(o+=D({node:g,pos:_,parent:w,index:T,range:e}))):g.isText?(o+=(A=g==null?void 0:g.text)===null||A===void 0?void 0:A.slice(Math.max(i,_)-_,r-_),f=!1):g.isBlock&&!f&&(o+=a,f=!0)}),o}function pj(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const Kae=Es.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new ya({key:new Qu("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:i,selection:r}=e,{ranges:a}=r,d=Math.min(...a.map(_=>_.$from.pos)),o=Math.max(...a.map(_=>_.$to.pos)),f=pj(n);return fj(i,{from:d,to:o},{textSerializers:f})}}})]}}),Yae=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),Jae=(t=!1)=>({commands:e})=>e.setContent("",t),Qae=()=>({state:t,tr:e,dispatch:n})=>{const{selection:i}=e,{ranges:r}=i;return n&&r.forEach(({$from:a,$to:d})=>{t.doc.nodesBetween(a.pos,d.pos,(o,f)=>{if(o.type.isText)return;const{doc:g,mapping:_}=e,w=g.resolve(_.map(f)),T=g.resolve(_.map(f+o.nodeSize)),A=w.blockRange(T);if(!A)return;const D=km(A);if(o.type.isTextblock){const{defaultType:z}=w.parent.contentMatchAt(w.index());e.setNodeMarkup(A.start,z)}(D||D===0)&&e.lift(A,D)})}),!0},ele=t=>e=>t(e),tle=()=>({state:t,dispatch:e})=>Sae(t,e),nle=(t,e)=>({editor:n,tr:i})=>{const{state:r}=n,a=r.doc.slice(t.from,t.to);i.deleteRange(t.from,t.to);const d=i.mapping.map(e);return i.insert(d,a.content),i.setSelection(new Bn(i.doc.resolve(d-1))),!0},ile=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,i=n.$anchor.node();if(i.content.size>0)return!1;const r=t.selection.$anchor;for(let a=r.depth;a>0;a-=1)if(r.node(a).type===i.type){if(e){const o=r.before(a),f=r.after(a);t.delete(o,f).scrollIntoView()}return!0}return!1},rle=t=>({tr:e,state:n,dispatch:i})=>{const r=uo(t,n.schema),a=e.selection.$anchor;for(let d=a.depth;d>0;d-=1)if(a.node(d).type===r){if(i){const f=a.before(d),g=a.after(d);e.delete(f,g).scrollIntoView()}return!0}return!1},ole=t=>({tr:e,dispatch:n})=>{const{from:i,to:r}=t;return n&&e.delete(i,r),!0},sle=()=>({state:t,dispatch:e})=>dae(t,e),ale=()=>({commands:t})=>t.keyboardShortcut("Enter"),lle=()=>({state:t,dispatch:e})=>wae(t,e);function Kx(t,e,n={strict:!0}){const i=Object.keys(e);return i.length?i.every(r=>n.strict?e[r]===t[r]:NA(e[r])?e[r].test(t[r]):e[r]===t[r]):!0}function YC(t,e,n={}){return t.find(i=>i.type===e&&Kx(i.attrs,n))}function cle(t,e,n={}){return!!YC(t,e,n)}function $A(t,e,n={}){if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if(t.parentOffset===i.offset&&i.offset!==0&&(i=t.parent.childBefore(t.parentOffset)),!i.node)return;const r=YC([...i.node.marks],e,n);if(!r)return;let a=i.index,d=t.start()+i.offset,o=a+1,f=d+i.node.nodeSize;for(YC([...i.node.marks],e,n);a>0&&r.isInSet(t.parent.child(a-1).marks);)a-=1,d-=t.parent.child(a).nodeSize;for(;o<t.parent.childCount&&cle([...t.parent.child(o).marks],e,n);)f+=t.parent.child(o).nodeSize,o+=1;return{from:d,to:f}}function td(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const ule=(t,e={})=>({tr:n,state:i,dispatch:r})=>{const a=td(t,i.schema),{doc:d,selection:o}=n,{$from:f,from:g,to:_}=o;if(r){const w=$A(f,a,e);if(w&&w.from<=g&&w.to>=_){const T=Bn.create(d,w.from,w.to);n.setSelection(T)}}return!0},dle=t=>e=>{const n=typeof t=="function"?t(e):t;for(let i=0;i<n.length;i+=1)if(n[i](e))return!0;return!1};function mj(t){return t instanceof Bn}function rh(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function gj(t,e=null){if(!e)return null;const n=$n.atStart(t),i=$n.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return i;const r=n.from,a=i.to;return e==="all"?Bn.create(t,rh(0,r,a),rh(t.content.size,r,a)):Bn.create(t,rh(e,r,a),rh(e,r,a))}function jA(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const hle=(t=null,e={})=>({editor:n,view:i,tr:r,dispatch:a})=>{e={scrollIntoView:!0,...e};const d=()=>{jA()&&i.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(i.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(i.hasFocus()&&t===null||t===!1)return!0;if(a&&t===null&&!mj(n.state.selection))return d(),!0;const o=gj(r.doc,t)||n.state.selection,f=n.state.selection.eq(o);return a&&(f||r.setSelection(o),f&&r.storedMarks&&r.setStoredMarks(r.storedMarks),d()),!0},fle=(t,e)=>n=>t.every((i,r)=>e(i,{...n,index:r})),ple=(t,e)=>({tr:n,commands:i})=>i.insertContentAt({from:n.selection.from,to:n.selection.to},t,e);function A3(t){const e=`<body>${t}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function Yx(t,e,n){if(n={slice:!0,parseOptions:{},...n},typeof t=="object"&&t!==null)try{return Array.isArray(t)&&t.length>0?Ft.fromArray(t.map(i=>e.nodeFromJSON(i))):e.nodeFromJSON(t)}catch(i){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",i),Yx("",e,n)}if(typeof t=="string"){const i=kA.fromSchema(e);return n.slice?i.parseSlice(A3(t),n.parseOptions).content:i.parse(A3(t),n.parseOptions)}return Yx("",e,n)}function mle(t,e,n){const i=t.steps.length-1;if(i<e)return;const r=t.steps[i];if(!(r instanceof vo||r instanceof ao))return;const a=t.mapping.maps[i];let d=0;a.forEach((o,f,g,_)=>{d===0&&(d=_)}),t.setSelection($n.near(t.doc.resolve(d),n))}const gle=t=>t.toString().startsWith("<"),yle=(t,e,n)=>({tr:i,dispatch:r,editor:a})=>{if(r){n={parseOptions:{},updateSelection:!0,...n};const d=Yx(e,a.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if(d.toString()==="<>")return!0;let{from:o,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},g=!0,_=!0;if((gle(d)?d:[d]).forEach(T=>{T.check(),g=g?T.isText&&T.marks.length===0:!1,_=_?T.isBlock:!1}),o===f&&_){const{parent:T}=i.doc.resolve(o);T.isTextblock&&!T.type.spec.code&&!T.childCount&&(o-=1,f+=1)}g?Array.isArray(e)?i.insertText(e.map(T=>T.text||"").join(""),o,f):typeof e=="object"&&e&&e.text?i.insertText(e.text,o,f):i.insertText(e,o,f):i.replaceWith(o,f,d),n.updateSelection&&mle(i,i.steps.length-1,-1)}return!0},vle=()=>({state:t,dispatch:e})=>vae(t,e),ble=()=>({state:t,dispatch:e})=>bae(t,e),_le=()=>({state:t,dispatch:e})=>fae(t,e),xle=()=>({state:t,dispatch:e})=>gae(t,e),wle=()=>({tr:t,state:e,dispatch:n})=>{try{const i=uw(e.doc,e.selection.$from.pos,-1);return i==null?!1:(t.join(i,2),n&&n(t),!0)}catch(i){return!1}},Sle=()=>({state:t,dispatch:e,tr:n})=>{try{const i=uw(t.doc,t.selection.$from.pos,1);return i==null?!1:(n.join(i,2),e&&e(n),!0)}catch(i){return!1}};function VA(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Ele(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let i,r,a,d;for(let o=0;o<e.length-1;o+=1){const f=e[o];if(/^(cmd|meta|m)$/i.test(f))d=!0;else if(/^a(lt)?$/i.test(f))i=!0;else if(/^(c|ctrl|control)$/i.test(f))r=!0;else if(/^s(hift)?$/i.test(f))a=!0;else if(/^mod$/i.test(f))jA()||VA()?d=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${f}`)}return i&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),d&&(n=`Meta-${n}`),a&&(n=`Shift-${n}`),n}const kle=t=>({editor:e,view:n,tr:i,dispatch:r})=>{const a=Ele(t).split(/-(?!$)/),d=a.find(g=>!["Alt","Ctrl","Meta","Shift"].includes(g)),o=new KeyboardEvent("keydown",{key:d==="Space"?" ":d,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),f=e.captureTransaction(()=>{n.someProp("handleKeyDown",g=>g(n,o))});return f==null||f.steps.forEach(g=>{const _=g.map(i.mapping);_&&r&&i.maybeStep(_)}),!0};function Av(t,e,n={}){const{from:i,to:r,empty:a}=t.selection,d=e?uo(e,t.schema):null,o=[];t.doc.nodesBetween(i,r,(w,T)=>{if(w.isText)return;const A=Math.max(i,T),D=Math.min(r,T+w.nodeSize);o.push({node:w,from:A,to:D})});const f=r-i,g=o.filter(w=>d?d.name===w.node.type.name:!0).filter(w=>Kx(w.node.attrs,n,{strict:!1}));return a?!!g.length:g.reduce((w,T)=>w+T.to-T.from,0)>=f}const Tle=(t,e={})=>({state:n,dispatch:i})=>{const r=uo(t,n.schema);return Av(n,r,e)?_ae(n,i):!1},Cle=()=>({state:t,dispatch:e})=>Eae(t,e),Ile=t=>({state:e,dispatch:n})=>{const i=uo(t,e.schema);return Oae(i)(e,n)},Ale=()=>({state:t,dispatch:e})=>xae(t,e);function _w(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function M3(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((i,r)=>(n.includes(r)||(i[r]=t[r]),i),{})}const Mle=(t,e)=>({tr:n,state:i,dispatch:r})=>{let a=null,d=null;const o=_w(typeof t=="string"?t:t.name,i.schema);return o?(o==="node"&&(a=uo(t,i.schema)),o==="mark"&&(d=td(t,i.schema)),r&&n.selection.ranges.forEach(f=>{i.doc.nodesBetween(f.$from.pos,f.$to.pos,(g,_)=>{a&&a===g.type&&n.setNodeMarkup(_,void 0,M3(g.attrs,e)),d&&g.marks.length&&g.marks.forEach(w=>{d===w.type&&n.addMark(_,_+g.nodeSize,d.create(M3(w.attrs,e)))})})}),!0):!1},Ple=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),Ole=()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),Dle=()=>({state:t,dispatch:e})=>pae(t,e),Rle=()=>({state:t,dispatch:e})=>yae(t,e),Lle=()=>({state:t,dispatch:e})=>kae(t,e),zle=()=>({state:t,dispatch:e})=>Iae(t,e),Ble=()=>({state:t,dispatch:e})=>Cae(t,e);function yj(t,e,n={}){return Yx(t,e,{slice:!1,parseOptions:n})}const Fle=(t,e=!1,n={})=>({tr:i,editor:r,dispatch:a})=>{const{doc:d}=i,o=yj(t,r.schema,n);return a&&i.replaceWith(0,d.content.size,o).setMeta("preventUpdate",!e),!0};function xw(t,e){const n=td(e,t.schema),{from:i,to:r,empty:a}=t.selection,d=[];a?(t.storedMarks&&d.push(...t.storedMarks),d.push(...t.selection.$head.marks())):t.doc.nodesBetween(i,r,f=>{d.push(...f.marks)});const o=d.find(f=>f.type.name===n.name);return o?{...o.attrs}:{}}function Nle(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function $le(t,e){for(let n=t.depth;n>0;n-=1){const i=t.node(n);if(e(i))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:i}}}function UA(t){return e=>$le(e.$from,t)}function jle(t,e){const n=Sl.fromSchema(e).serializeFragment(t),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function Vle(t,e){const n={from:0,to:t.content.size};return fj(t,n,e)}function Ule(t,e){const n=uo(e,t.schema),{from:i,to:r}=t.selection,a=[];t.doc.nodesBetween(i,r,o=>{a.push(o)});const d=a.reverse().find(o=>o.type.name===n.name);return d?{...d.attrs}:{}}function qle(t,e){const n=_w(typeof e=="string"?e:e.name,t.schema);return n==="node"?Ule(t,e):n==="mark"?xw(t,e):{}}function vj(t,e,n){const i=[];return t===e?n.resolve(t).marks().forEach(r=>{const a=n.resolve(t-1),d=$A(a,r.type);d&&i.push({mark:r,...d})}):n.nodesBetween(t,e,(r,a)=>{i.push(...r.marks.map(d=>({from:a,to:a+r.nodeSize,mark:d})))}),i}function T_(t,e,n){return Object.fromEntries(Object.entries(n).filter(([i])=>{const r=t.find(a=>a.type===e&&a.name===i);return r?r.attribute.keepOnSplit:!1}))}function JC(t,e,n={}){const{empty:i,ranges:r}=t.selection,a=e?td(e,t.schema):null;if(i)return!!(t.storedMarks||t.selection.$from.marks()).filter(w=>a?a.name===w.type.name:!0).find(w=>Kx(w.attrs,n,{strict:!1}));let d=0;const o=[];if(r.forEach(({$from:w,$to:T})=>{const A=w.pos,D=T.pos;t.doc.nodesBetween(A,D,(z,G)=>{if(!z.isText&&!z.marks.length)return;const V=Math.max(A,G),N=Math.min(D,G+z.nodeSize),q=N-V;d+=q,o.push(...z.marks.map(K=>({mark:K,from:V,to:N})))})}),d===0)return!1;const f=o.filter(w=>a?a.name===w.mark.type.name:!0).filter(w=>Kx(w.mark.attrs,n,{strict:!1})).reduce((w,T)=>w+T.to-T.from,0),g=o.filter(w=>a?w.mark.type!==a&&w.mark.type.excludes(a):!0).reduce((w,T)=>w+T.to-T.from,0);return(f>0?f+g:f)>=d}function Wle(t,e,n={}){if(!e)return Av(t,null,n)||JC(t,null,n);const i=_w(e,t.schema);return i==="node"?Av(t,e,n):i==="mark"?JC(t,e,n):!1}function P3(t,e){const{nodeExtensions:n}=yw(e),i=n.find(d=>d.name===t);if(!i)return!1;const r={name:i.name,options:i.options,storage:i.storage},a=Nn(hn(i,"group",r));return typeof a!="string"?!1:a.split(" ").includes("list")}function Gle(t){var e;const n=(e=t.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),i=t.toJSON();return JSON.stringify(n)===JSON.stringify(i)}function Hle(t,e,n){var i;const{selection:r}=e;let a=null;if(mj(r)&&(a=r.$cursor),a){const o=(i=t.storedMarks)!==null&&i!==void 0?i:a.marks();return!!n.isInSet(o)||!o.some(f=>f.type.excludes(n))}const{ranges:d}=r;return d.some(({$from:o,$to:f})=>{let g=o.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(o.pos,f.pos,(_,w,T)=>{if(g)return!1;if(_.isInline){const A=!T||T.type.allowsMarkType(n),D=!!n.isInSet(_.marks)||!_.marks.some(z=>z.type.excludes(n));g=A&&D}return!g}),g})}const Zle=(t,e={})=>({tr:n,state:i,dispatch:r})=>{const{selection:a}=n,{empty:d,ranges:o}=a,f=td(t,i.schema);if(r)if(d){const g=xw(i,f);n.addStoredMark(f.create({...g,...e}))}else o.forEach(g=>{const _=g.$from.pos,w=g.$to.pos;i.doc.nodesBetween(_,w,(T,A)=>{const D=Math.max(A,_),z=Math.min(A+T.nodeSize,w);T.marks.find(V=>V.type===f)?T.marks.forEach(V=>{f===V.type&&n.addMark(D,z,f.create({...V.attrs,...e}))}):n.addMark(D,z,f.create(e))})});return Hle(i,n,f)},Xle=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),Kle=(t,e={})=>({state:n,dispatch:i,chain:r})=>{const a=uo(t,n.schema);return a.isTextblock?r().command(({commands:d})=>k3(a,e)(n)?!0:d.clearNodes()).command(({state:d})=>k3(a,e)(d,i)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Yle=t=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,r=rh(t,0,i.content.size),a=Cn.create(i,r);e.setSelection(a)}return!0},Jle=t=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,{from:r,to:a}=typeof t=="number"?{from:t,to:t}:t,d=Bn.atStart(i).from,o=Bn.atEnd(i).to,f=rh(r,d,o),g=rh(a,d,o),_=Bn.create(i,f,g);e.setSelection(_)}return!0},Qle=t=>({state:e,dispatch:n})=>{const i=uo(t,e.schema);return Lae(i)(e,n)};function O3(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const i=n.filter(r=>e==null?void 0:e.includes(r.type.name));t.tr.ensureMarks(i)}}const ece=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:i,editor:r})=>{const{selection:a,doc:d}=e,{$from:o,$to:f}=a,g=r.extensionManager.attributes,_=T_(g,o.node().type.name,o.node().attrs);if(a instanceof Cn&&a.node.isBlock)return!o.parentOffset||!Fp(d,o.pos)?!1:(i&&(t&&O3(n,r.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;if(i){const w=f.parentOffset===f.parent.content.size;a instanceof Bn&&e.deleteSelection();const T=o.depth===0?void 0:Nle(o.node(-1).contentMatchAt(o.indexAfter(-1)));let A=w&&T?[{type:T,attrs:_}]:void 0,D=Fp(e.doc,e.mapping.map(o.pos),1,A);if(!A&&!D&&Fp(e.doc,e.mapping.map(o.pos),1,T?[{type:T}]:void 0)&&(D=!0,A=T?[{type:T,attrs:_}]:void 0),D&&(e.split(e.mapping.map(o.pos),1,A),T&&!w&&!o.parentOffset&&o.parent.type!==T)){const z=e.mapping.map(o.before()),G=e.doc.resolve(z);o.node(-1).canReplaceWith(G.index(),G.index()+1,T)&&e.setNodeMarkup(e.mapping.map(o.before()),T)}t&&O3(n,r.extensionManager.splittableMarks),e.scrollIntoView()}return!0},tce=t=>({tr:e,state:n,dispatch:i,editor:r})=>{var a;const d=uo(t,n.schema),{$from:o,$to:f}=n.selection,g=n.selection.node;if(g&&g.isBlock||o.depth<2||!o.sameParent(f))return!1;const _=o.node(-1);if(_.type!==d)return!1;const w=r.extensionManager.attributes;if(o.parent.content.size===0&&o.node(-1).childCount===o.indexAfter(-1)){if(o.depth===2||o.node(-3).type!==d||o.index(-2)!==o.node(-2).childCount-1)return!1;if(i){let G=Ft.empty;const V=o.index(-1)?1:o.index(-2)?2:3;for(let Q=o.depth-V;Q>=o.depth-3;Q-=1)G=Ft.from(o.node(Q).copy(G));const N=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3,q=T_(w,o.node().type.name,o.node().attrs),K=((a=d.contentMatch.defaultType)===null||a===void 0?void 0:a.createAndFill(q))||void 0;G=G.append(Ft.from(d.createAndFill(null,K)||void 0));const se=o.before(o.depth-(V-1));e.replace(se,o.after(-N),new nn(G,4-V,0));let ie=-1;e.doc.nodesBetween(se,e.doc.content.size,(Q,J)=>{if(ie>-1)return!1;Q.isTextblock&&Q.content.size===0&&(ie=J+1)}),ie>-1&&e.setSelection(Bn.near(e.doc.resolve(ie))),e.scrollIntoView()}return!0}const T=f.pos===o.end()?_.contentMatchAt(0).defaultType:null,A=T_(w,_.type.name,_.attrs),D=T_(w,o.node().type.name,o.node().attrs);e.delete(o.pos,f.pos);const z=T?[{type:d,attrs:A},{type:T,attrs:D}]:[{type:d,attrs:A}];if(!Fp(e.doc,o.pos,2))return!1;if(i){const{selection:G,storedMarks:V}=n,{splittableMarks:N}=r.extensionManager,q=V||G.$to.parentOffset&&G.$from.marks();if(e.split(o.pos,2,z).scrollIntoView(),!q||!i)return!0;const K=q.filter(se=>N.includes(se.type.name));e.ensureMarks(K)}return!0},Ok=(t,e)=>{const n=UA(d=>d.type===e)(t.selection);if(!n)return!0;const i=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(i===void 0)return!0;const r=t.doc.nodeAt(i);return n.node.type===(r==null?void 0:r.type)&&Ju(t.doc,n.pos)&&t.join(n.pos),!0},Dk=(t,e)=>{const n=UA(d=>d.type===e)(t.selection);if(!n)return!0;const i=t.doc.resolve(n.start).after(n.depth);if(i===void 0)return!0;const r=t.doc.nodeAt(i);return n.node.type===(r==null?void 0:r.type)&&Ju(t.doc,i)&&t.join(i),!0},nce=(t,e,n,i={})=>({editor:r,tr:a,state:d,dispatch:o,chain:f,commands:g,can:_})=>{const{extensions:w,splittableMarks:T}=r.extensionManager,A=uo(t,d.schema),D=uo(e,d.schema),{selection:z,storedMarks:G}=d,{$from:V,$to:N}=z,q=V.blockRange(N),K=G||z.$to.parentOffset&&z.$from.marks();if(!q)return!1;const se=UA(ie=>P3(ie.type.name,w))(z);if(q.depth>=1&&se&&q.depth-se.depth<=1){if(se.node.type===A)return g.liftListItem(D);if(P3(se.node.type.name,w)&&A.validContent(se.node.content)&&o)return f().command(()=>(a.setNodeMarkup(se.pos,A),!0)).command(()=>Ok(a,A)).command(()=>Dk(a,A)).run()}return!n||!K||!o?f().command(()=>_().wrapInList(A,i)?!0:g.clearNodes()).wrapInList(A,i).command(()=>Ok(a,A)).command(()=>Dk(a,A)).run():f().command(()=>{const ie=_().wrapInList(A,i),Q=K.filter(J=>T.includes(J.type.name));return a.ensureMarks(Q),ie?!0:g.clearNodes()}).wrapInList(A,i).command(()=>Ok(a,A)).command(()=>Dk(a,A)).run()},ice=(t,e={},n={})=>({state:i,commands:r})=>{const{extendEmptyMarkRange:a=!1}=n,d=td(t,i.schema);return JC(i,d,e)?r.unsetMark(d,{extendEmptyMarkRange:a}):r.setMark(d,e)},rce=(t,e,n={})=>({state:i,commands:r})=>{const a=uo(t,i.schema),d=uo(e,i.schema);return Av(i,a,n)?r.setNode(d):r.setNode(a,n)},oce=(t,e={})=>({state:n,commands:i})=>{const r=uo(t,n.schema);return Av(n,r,e)?i.lift(r):i.wrapIn(r,e)},sce=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let i=0;i<n.length;i+=1){const r=n[i];let a;if(r.spec.isInputRules&&(a=r.getState(t))){if(e){const d=t.tr,o=a.transform;for(let f=o.steps.length-1;f>=0;f-=1)d.step(o.steps[f].invert(o.docs[f]));if(a.text){const f=d.doc.resolve(a.from).marks();d.replaceWith(a.from,a.to,t.schema.text(a.text,f))}else d.delete(a.from,a.to)}return!0}}return!1},ace=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:i,ranges:r}=n;return i||e&&r.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},lce=(t,e={})=>({tr:n,state:i,dispatch:r})=>{var a;const{extendEmptyMarkRange:d=!1}=e,{selection:o}=n,f=td(t,i.schema),{$from:g,empty:_,ranges:w}=o;if(!r)return!0;if(_&&d){let{from:T,to:A}=o;const D=(a=g.marks().find(G=>G.type===f))===null||a===void 0?void 0:a.attrs,z=$A(g,f,D);z&&(T=z.from,A=z.to),n.removeMark(T,A,f)}else w.forEach(T=>{n.removeMark(T.$from.pos,T.$to.pos,f)});return n.removeStoredMark(f),!0},cce=(t,e={})=>({tr:n,state:i,dispatch:r})=>{let a=null,d=null;const o=_w(typeof t=="string"?t:t.name,i.schema);return o?(o==="node"&&(a=uo(t,i.schema)),o==="mark"&&(d=td(t,i.schema)),r&&n.selection.ranges.forEach(f=>{const g=f.$from.pos,_=f.$to.pos;i.doc.nodesBetween(g,_,(w,T)=>{a&&a===w.type&&n.setNodeMarkup(T,void 0,{...w.attrs,...e}),d&&w.marks.length&&w.marks.forEach(A=>{if(d===A.type){const D=Math.max(T,g),z=Math.min(T+w.nodeSize,_);n.addMark(D,z,d.create({...A.attrs,...e}))}})})}),!0):!1},uce=(t,e={})=>({state:n,dispatch:i})=>{const r=uo(t,n.schema);return Aae(r,e)(n,i)},dce=(t,e={})=>({state:n,dispatch:i})=>{const r=uo(t,n.schema);return Mae(r,e)(n,i)};var hce=Object.freeze({__proto__:null,blur:Yae,clearContent:Jae,clearNodes:Qae,command:ele,createParagraphNear:tle,cut:nle,deleteCurrentNode:ile,deleteNode:rle,deleteRange:ole,deleteSelection:sle,enter:ale,exitCode:lle,extendMarkRange:ule,first:dle,focus:hle,forEach:fle,insertContent:ple,insertContentAt:yle,joinUp:vle,joinDown:ble,joinBackward:_le,joinForward:xle,joinItemBackward:wle,joinItemForward:Sle,keyboardShortcut:kle,lift:Tle,liftEmptyBlock:Cle,liftListItem:Ile,newlineInCode:Ale,resetAttributes:Mle,scrollIntoView:Ple,selectAll:Ole,selectNodeBackward:Dle,selectNodeForward:Rle,selectParentNode:Lle,selectTextblockEnd:zle,selectTextblockStart:Ble,setContent:Fle,setMark:Zle,setMeta:Xle,setNode:Kle,setNodeSelection:Yle,setTextSelection:Jle,sinkListItem:Qle,splitBlock:ece,splitListItem:tce,toggleList:nce,toggleMark:ice,toggleNode:rce,toggleWrap:oce,undoInputRule:sce,unsetAllMarks:ace,unsetMark:lce,updateAttributes:cce,wrapIn:uce,wrapInList:dce});const fce=Es.create({name:"commands",addCommands(){return{...hce}}}),pce=Es.create({name:"editable",addProseMirrorPlugins(){return[new ya({key:new Qu("editable"),props:{editable:()=>this.editor.options.editable}})]}}),mce=Es.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new ya({key:new Qu("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const i=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1},blur:(e,n)=>{t.isFocused=!1;const i=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1}}}})]}}),gce=Es.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:d})=>[()=>d.undoInputRule(),()=>d.command(({tr:o})=>{const{selection:f,doc:g}=o,{empty:_,$anchor:w}=f,{pos:T,parent:A}=w,D=w.parent.isTextblock?o.doc.resolve(T-1):w,z=D.parent.type.spec.isolating,G=w.pos-w.parentOffset,V=z&&D.parent.childCount===1?G===w.pos:$n.atStart(g).from===T;return!_||!V||!A.type.isTextblock||A.textContent.length?!1:d.clearNodes()}),()=>d.deleteSelection(),()=>d.joinBackward(),()=>d.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:d})=>[()=>d.deleteSelection(),()=>d.deleteCurrentNode(),()=>d.joinForward(),()=>d.selectNodeForward()]),i={Enter:()=>this.editor.commands.first(({commands:d})=>[()=>d.newlineInCode(),()=>d.createParagraphNear(),()=>d.liftEmptyBlock(),()=>d.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},r={...i},a={...i,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return jA()||VA()?a:r},addProseMirrorPlugins(){return[new ya({key:new Qu("clearDocument"),appendTransaction:(t,e,n)=>{if(!(t.some(D=>D.docChanged)&&!e.doc.eq(n.doc)))return;const{empty:r,from:a,to:d}=e.selection,o=$n.atStart(e.doc).from,f=$n.atEnd(e.doc).to;if(r||!(a===o&&d===f)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const w=n.tr,T=mw({state:n,transaction:w}),{commands:A}=new gw({editor:this.editor,state:T});if(A.clearNodes(),!!w.steps.length)return w}})]}}),yce=Es.create({name:"tabindex",addProseMirrorPlugins(){return[new ya({key:new Qu("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var vce=Object.freeze({__proto__:null,ClipboardTextSerializer:Kae,Commands:fce,Editable:pce,FocusEvents:mce,Keymap:gce,Tabindex:yce});const bce=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function _ce(t,e,n){const i=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(i!==null)return i;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}let xce=class extends zae{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=_ce(bce,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const i=hj(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:i});this.view.updateState(r)}unregisterPlugin(e){if(this.isDestroyed)return;const n=typeof e=="string"?`${e}$`:e.key,i=this.state.reconfigure({plugins:this.state.plugins.filter(r=>!r.key.startsWith(n))});this.view.updateState(i)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(vce):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new wp(n,this)}createCommandManager(){this.commandManager=new gw({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=yj(this.options.content,this.schema,this.options.parseOptions),n=gj(e,this.options.autofocus);this.view=new tae(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:xp.create({doc:e,selection:n||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(d=>{var o;return(o=this.capturedTransaction)===null||o===void 0?void 0:o.step(d)});return}const n=this.state.apply(e),i=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),i&&this.emit("selectionUpdate",{editor:this,transaction:e});const r=e.getMeta("focus"),a=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),a&&this.emit("blur",{editor:this,event:a.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return qle(this.state,e)}isActive(e,n){const i=typeof e=="string"?e:null,r=typeof e=="string"?n:e;return Wle(this.state,i,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return jle(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:i={}}=e||{};return Vle(this.state.doc,{blockSeparator:n,textSerializers:{...pj(this.schema),...i}})}get isEmpty(){return Gle(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}};function lm(t){return new vw({find:t.find,handler:({state:e,range:n,match:i})=>{const r=Nn(t.getAttributes,void 0,i);if(r===!1||r===null)return null;const{tr:a}=e,d=i[i.length-1],o=i[0];if(d){const f=o.search(/\S/),g=n.from+o.indexOf(d),_=g+d.length;if(vj(n.from,n.to,e.doc).filter(A=>A.mark.type.excluded.find(z=>z===t.type&&z!==A.mark.type)).filter(A=>A.to>g).length)return null;_<n.to&&a.delete(_,n.to),g>n.from&&a.delete(n.from+f,g);const T=n.from+f+d.length;a.addMark(n.from+f,T,t.type.create(r||{})),a.removeStoredMark(t.type)}}})}function wce(t){return new vw({find:t.find,handler:({state:e,range:n,match:i})=>{const r=Nn(t.getAttributes,void 0,i)||{},{tr:a}=e,d=n.from;let o=n.to;const f=t.type.create(r);if(i[1]){const g=i[0].lastIndexOf(i[1]);let _=d+g;_>o?_=o:o=_+i[1].length;const w=i[0][i[0].length-1];a.insertText(w,d+i[0].length-1),a.replaceWith(_,o,f)}else i[0]&&a.insert(d-1,t.type.create(r)).delete(a.mapping.map(d),a.mapping.map(o));a.scrollIntoView()}})}function QC(t){return new vw({find:t.find,handler:({state:e,range:n,match:i})=>{const r=e.doc.resolve(n.from),a=Nn(t.getAttributes,void 0,i)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,a)}})}function Mv(t){return new vw({find:t.find,handler:({state:e,range:n,match:i,chain:r})=>{const a=Nn(t.getAttributes,void 0,i)||{},d=e.tr.delete(n.from,n.to),f=d.doc.resolve(n.from).blockRange(),g=f&&CA(f,t.type,a);if(!g)return null;if(d.wrap(f,g),t.keepMarks&&t.editor){const{selection:w,storedMarks:T}=e,{splittableMarks:A}=t.editor.extensionManager,D=T||w.$to.parentOffset&&w.$from.marks();if(D){const z=D.filter(G=>A.includes(G.type.name));d.ensureMarks(z)}}if(t.keepAttributes){const w=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(w,a).run()}const _=d.doc.resolve(n.from-1).nodeBefore;_&&_.type===t.type&&Ju(d.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(i,_))&&d.join(n.from-1)}})}class Rl{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Nn(hn(this,"addOptions",{name:this.name}))),this.storage=Nn(hn(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Rl(e)}configure(e={}){const n=this.extend();return n.options=bw(this.options,e),n.storage=Nn(hn(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new Rl(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Nn(hn(n,"addOptions",{name:n.name})),n.storage=Nn(hn(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:i}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){const d=r.marks();if(!!!d.find(g=>(g==null?void 0:g.type.name)===n.name))return!1;const f=d.find(g=>(g==null?void 0:g.type.name)===n.name);return f&&i.removeStoredMark(f),i.insertText(" ",r.pos),e.view.dispatch(i),!0}return!1}}let Gs=class e2{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Nn(hn(this,"addOptions",{name:this.name}))),this.storage=Nn(hn(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new e2(e)}configure(e={}){const n=this.extend();return n.options=bw(this.options,e),n.storage=Nn(hn(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new e2(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Nn(hn(n,"addOptions",{name:n.name})),n.storage=Nn(hn(n,"addStorage",{name:n.name,options:n.options})),n}};function cm(t){return new qae({find:t.find,handler:({state:e,range:n,match:i,pasteEvent:r})=>{const a=Nn(t.getAttributes,void 0,i,r);if(a===!1||a===null)return null;const{tr:d}=e,o=i[i.length-1],f=i[0];let g=n.to;if(o){const _=f.search(/\S/),w=n.from+f.indexOf(o),T=w+o.length;if(vj(n.from,n.to,e.doc).filter(D=>D.mark.type.excluded.find(G=>G===t.type&&G!==D.mark.type)).filter(D=>D.to>w).length)return null;T<n.to&&d.delete(T,n.to),w>n.from&&d.delete(n.from+_,w),g=n.from+_+o.length,d.addMark(n.from+_,g,t.type.create(a||{})),d.removeStoredMark(t.type)}}})}const Sce=/^\s*>\s$/,Ece=Gs.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Mv({find:Sce,type:this.type})]}}),kce=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,Tce=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Cce=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Ice=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Ace=Rl.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[lm({find:kce,type:this.type}),lm({find:Cce,type:this.type})]},addPasteRules(){return[cm({find:Tce,type:this.type}),cm({find:Ice,type:this.type})]}}),Mce=Gs.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Yr(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),D3=Rl.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=xw(t,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:e.unsetMark(this.name)}}}}),R3=/^\s*([-+*])\s$/,Pce=Gs.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Mce.name,this.editor.getAttributes(D3.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Mv({find:R3,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Mv({find:R3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(D3.name),editor:this.editor})),[t]}}),Oce=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Dce=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Rce=Rl.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[lm({find:Oce,type:this.type})]},addPasteRules(){return[cm({find:Dce,type:this.type})]}}),Lce=/^```([a-z]+)?[\s\n]$/,zce=/^~~~([a-z]+)?[\s\n]$/,Bce=Gs.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,a=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(d=>d.startsWith(n)).map(d=>d.replace(n,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Yr(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:i,empty:r}=n;if(!r||i.parent.type!==this.type)return!1;const a=i.parentOffset===i.parent.nodeSize-2,d=i.parent.textContent.endsWith(`

`);return!a||!d?!1:t.chain().command(({tr:o})=>(o.delete(i.pos-2,i.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:i}=e,{$from:r,empty:a}=n;if(!a||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const o=r.after();return o===void 0||i.nodeAt(o)?!1:t.commands.exitCode()}}},addInputRules(){return[QC({find:Lce,type:this.type,getAttributes:t=>({language:t[1]})}),QC({find:zce,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new ya({key:new Qu("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),i=e.clipboardData.getData("vscode-editor-data"),r=i?JSON.parse(i):void 0,a=r==null?void 0:r.mode;if(!n||!a)return!1;const{tr:d}=t.state;return d.replaceSelectionWith(this.type.create({language:a})),d.setSelection(Bn.near(d.doc.resolve(Math.max(0,d.selection.from-2)))),d.insertText(n.replace(/\r\n?/g,`
`)),d.setMeta("paste",!0),t.dispatch(d),!0}}})]}}),Fce=Gs.create({name:"doc",topNode:!0,content:"block+"});function Nce(t={}){return new ya({view(e){return new $ce(e,t)}})}class $ce{constructor(e,n){var i;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=n.width)!==null&&i!==void 0?i:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let a=d=>{this[r](d)};return e.dom.addEventListener(r,a),{name:r,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,i;if(n){let o=e.nodeBefore,f=e.nodeAfter;if(o||f){let g=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0));if(g){let _=g.getBoundingClientRect(),w=o?_.bottom:_.top;o&&f&&(w=(w+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),i={left:_.left,right:_.right,top:w-this.width/2,bottom:w+this.width/2}}}}if(!i){let o=this.editorView.coordsAtPos(this.cursorPos);i={left:o.left-this.width/2,right:o.left+this.width/2,top:o.top,bottom:o.bottom}}let r=this.editorView.dom.offsetParent;this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let a,d;if(!r||r==document.body&&getComputedStyle(r).position=="static")a=-pageXOffset,d=-pageYOffset;else{let o=r.getBoundingClientRect();a=o.left-r.scrollLeft,d=o.top-r.scrollTop}this.element.style.left=i.left-a+"px",this.element.style.top=i.top-d+"px",this.element.style.width=i.right-i.left+"px",this.element.style.height=i.bottom-i.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),i=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),r=i&&i.type.spec.disableDropCursor,a=typeof r=="function"?r(this.editorView,n,e):r;if(n&&!a){let d=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=x6(this.editorView.state.doc,d,this.editorView.dragging.slice);o!=null&&(d=o)}this.setCursor(d),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const jce=Es.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Nce(this.options)]}});class Tr extends $n{constructor(e){super(e,e)}map(e,n){let i=e.resolve(n.map(this.head));return Tr.valid(i)?new Tr(i):$n.near(i)}content(){return nn.empty}eq(e){return e instanceof Tr&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Tr(e.resolve(n.pos))}getBookmark(){return new qA(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!Vce(e)||!Uce(e))return!1;let i=n.type.spec.allowGapCursor;if(i!=null)return i;let r=n.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,n,i=!1){e:for(;;){if(!i&&Tr.valid(e))return e;let r=e.pos,a=null;for(let d=e.depth;;d--){let o=e.node(d);if(n>0?e.indexAfter(d)<o.childCount:e.index(d)>0){a=o.child(n>0?e.indexAfter(d):e.index(d)-1);break}else if(d==0)return null;r+=n;let f=e.doc.resolve(r);if(Tr.valid(f))return f}for(;;){let d=n>0?a.firstChild:a.lastChild;if(!d){if(a.isAtom&&!a.isText&&!Cn.isSelectable(a)){e=e.doc.resolve(r+a.nodeSize*n),i=!1;continue e}break}a=d,r+=n;let o=e.doc.resolve(r);if(Tr.valid(o))return o}return null}}}Tr.prototype.visible=!1;Tr.findFrom=Tr.findGapCursorFrom;$n.jsonID("gapcursor",Tr);class qA{constructor(e){this.pos=e}map(e){return new qA(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Tr.valid(n)?new Tr(n):$n.near(n)}}function Vce(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),i=t.node(e);if(n==0){if(i.type.spec.isolating)return!0;continue}for(let r=i.child(n-1);;r=r.lastChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function Uce(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),i=t.node(e);if(n==i.childCount){if(i.type.spec.isolating)return!0;continue}for(let r=i.child(n);;r=r.firstChild){if(r.childCount==0&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}function qce(){return new ya({props:{decorations:Zce,createSelectionBetween(t,e,n){return e.pos==n.pos&&Tr.valid(n)?new Tr(n):null},handleClick:Gce,handleKeyDown:Wce,handleDOMEvents:{beforeinput:Hce}}})}const Wce=oj({ArrowLeft:Yb("horiz",-1),ArrowRight:Yb("horiz",1),ArrowUp:Yb("vert",-1),ArrowDown:Yb("vert",1)});function Yb(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(i,r,a){let d=i.selection,o=e>0?d.$to:d.$from,f=d.empty;if(d instanceof Bn){if(!a.endOfTextblock(n)||o.depth==0)return!1;f=!1,o=i.doc.resolve(e>0?o.after():o.before())}let g=Tr.findGapCursorFrom(o,e,f);return g?(r&&r(i.tr.setSelection(new Tr(g))),!0):!1}}function Gce(t,e,n){if(!t||!t.editable)return!1;let i=t.state.doc.resolve(e);if(!Tr.valid(i))return!1;let r=t.posAtCoords({left:n.clientX,top:n.clientY});return r&&r.inside>-1&&Cn.isSelectable(t.state.doc.nodeAt(r.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Tr(i))),!0)}function Hce(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Tr))return!1;let{$from:n}=t.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!i)return!1;let r=Ft.empty;for(let d=i.length-1;d>=0;d--)r=Ft.from(i[d].createAndFill(null,r));let a=t.state.tr.replace(n.pos,n.pos,new nn(r,0,0));return a.setSelection(Bn.near(a.doc.resolve(n.pos+1))),t.dispatch(a),!1}function Zce(t){if(!(t.selection instanceof Tr))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Xr.create(t.doc,[ca.widget(t.selection.head,e,{key:"gapcursor"})])}const Xce=Es.create({name:"gapCursor",addProseMirrorPlugins(){return[qce()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Nn(hn(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),Kce=Gs.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Yr(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:i})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:r,storedMarks:a}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:d}=this.options,{splittableMarks:o}=i.extensionManager,f=a||r.$to.parentOffset&&r.$from.marks();return e().insertContent({type:this.name}).command(({tr:g,dispatch:_})=>{if(_&&f&&d){const w=f.filter(T=>o.includes(T.type.name));g.ensureMarks(w)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Yce=Gs.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Yr(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>QC({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var Jx=200,lo=function(){};lo.prototype.append=function(e){return e.length?(e=lo.from(e),!this.length&&e||e.length<Jx&&this.leafAppend(e)||this.length<Jx&&e.leafPrepend(this)||this.appendInner(e)):this};lo.prototype.prepend=function(e){return e.length?lo.from(e).append(this):this};lo.prototype.appendInner=function(e){return new Jce(this,e)};lo.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?lo.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};lo.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};lo.prototype.forEach=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length),n<=i?this.forEachInner(e,n,i,0):this.forEachInvertedInner(e,n,i,0)};lo.prototype.map=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length);var r=[];return this.forEach(function(a,d){return r.push(e(a,d))},n,i),r};lo.from=function(e){return e instanceof lo?e:e&&e.length?new bj(e):lo.empty};var bj=function(t){function e(i){t.call(this),this.values=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(r,a){return r==0&&a==this.length?this:new e(this.values.slice(r,a))},e.prototype.getInner=function(r){return this.values[r]},e.prototype.forEachInner=function(r,a,d,o){for(var f=a;f<d;f++)if(r(this.values[f],o+f)===!1)return!1},e.prototype.forEachInvertedInner=function(r,a,d,o){for(var f=a-1;f>=d;f--)if(r(this.values[f],o+f)===!1)return!1},e.prototype.leafAppend=function(r){if(this.length+r.length<=Jx)return new e(this.values.concat(r.flatten()))},e.prototype.leafPrepend=function(r){if(this.length+r.length<=Jx)return new e(r.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(lo);lo.empty=new bj([]);var Jce=function(t){function e(n,i){t.call(this),this.left=n,this.right=i,this.length=n.length+i.length,this.depth=Math.max(n.depth,i.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},e.prototype.forEachInner=function(i,r,a,d){var o=this.left.length;if(r<o&&this.left.forEachInner(i,r,Math.min(a,o),d)===!1||a>o&&this.right.forEachInner(i,Math.max(r-o,0),Math.min(this.length,a)-o,d+o)===!1)return!1},e.prototype.forEachInvertedInner=function(i,r,a,d){var o=this.left.length;if(r>o&&this.right.forEachInvertedInner(i,r-o,Math.max(a,o)-o,d+o)===!1||a<o&&this.left.forEachInvertedInner(i,Math.min(r,o),a,d)===!1)return!1},e.prototype.sliceInner=function(i,r){if(i==0&&r==this.length)return this;var a=this.left.length;return r<=a?this.left.slice(i,r):i>=a?this.right.slice(i-a,r-a):this.left.slice(i,a).append(this.right.slice(0,r-a))},e.prototype.leafAppend=function(i){var r=this.right.leafAppend(i);if(r)return new e(this.left,r)},e.prototype.leafPrepend=function(i){var r=this.left.leafPrepend(i);if(r)return new e(r,this.right)},e.prototype.appendInner=function(i){return this.left.depth>=Math.max(this.right.depth,i.depth)+1?new e(this.left,new e(this.right,i)):new e(this,i)},e}(lo);const Qce=500;class Ga{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let i=this.items.length;for(;;i--)if(this.items.get(i-1).selection){--i;break}let r,a;n&&(r=this.remapping(i,this.items.length),a=r.maps.length);let d=e.tr,o,f,g=[],_=[];return this.items.forEach((w,T)=>{if(!w.step){r||(r=this.remapping(i,T+1),a=r.maps.length),a--,_.push(w);return}if(r){_.push(new bl(w.map));let A=w.step.map(r.slice(a)),D;A&&d.maybeStep(A).doc&&(D=d.mapping.maps[d.mapping.maps.length-1],g.push(new bl(D,void 0,void 0,g.length+_.length))),a--,D&&r.appendMap(D,a)}else d.maybeStep(w.step);if(w.selection)return o=r?w.selection.map(r.slice(a)):w.selection,f=new Ga(this.items.slice(0,i).append(_.reverse().concat(g)),this.eventCount-1),!1},this.items.length,0),{remaining:f,transform:d,selection:o}}addTransform(e,n,i,r){let a=[],d=this.eventCount,o=this.items,f=!r&&o.length?o.get(o.length-1):null;for(let _=0;_<e.steps.length;_++){let w=e.steps[_].invert(e.docs[_]),T=new bl(e.mapping.maps[_],w,n),A;(A=f&&f.merge(T))&&(T=A,_?a.pop():o=o.slice(0,o.length-1)),a.push(T),n&&(d++,n=void 0),r||(f=T)}let g=d-i.depth;return g>tue&&(o=eue(o,g),d-=g),new Ga(o.append(a),d)}remapping(e,n){let i=new Bp;return this.items.forEach((r,a)=>{let d=r.mirrorOffset!=null&&a-r.mirrorOffset>=e?i.maps.length-r.mirrorOffset:void 0;i.appendMap(r.map,d)},e,n),i}addMaps(e){return this.eventCount==0?this:new Ga(this.items.append(e.map(n=>new bl(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let i=[],r=Math.max(0,this.items.length-n),a=e.mapping,d=e.steps.length,o=this.eventCount;this.items.forEach(T=>{T.selection&&o--},r);let f=n;this.items.forEach(T=>{let A=a.getMirror(--f);if(A==null)return;d=Math.min(d,A);let D=a.maps[A];if(T.step){let z=e.steps[A].invert(e.docs[A]),G=T.selection&&T.selection.map(a.slice(f+1,A));G&&o++,i.push(new bl(D,z,G))}else i.push(new bl(D))},r);let g=[];for(let T=n;T<d;T++)g.push(new bl(a.maps[T]));let _=this.items.slice(0,r).append(g).append(i),w=new Ga(_,o);return w.emptyItemCount()>Qce&&(w=w.compress(this.items.length-i.length)),w}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),i=n.maps.length,r=[],a=0;return this.items.forEach((d,o)=>{if(o>=e)r.push(d),d.selection&&a++;else if(d.step){let f=d.step.map(n.slice(i)),g=f&&f.getMap();if(i--,g&&n.appendMap(g,i),f){let _=d.selection&&d.selection.map(n.slice(i));_&&a++;let w=new bl(g.invert(),f,_),T,A=r.length-1;(T=r.length&&r[A].merge(w))?r[A]=T:r.push(w)}}else d.map&&i--},this.items.length,0),new Ga(lo.from(r.reverse()),a)}}Ga.empty=new Ga(lo.empty,0);function eue(t,e){let n;return t.forEach((i,r)=>{if(i.selection&&e--==0)return n=r,!1}),t.slice(n)}class bl{constructor(e,n,i,r){this.map=e,this.step=n,this.selection=i,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new bl(n.getMap().invert(),n,this.selection)}}}class cu{constructor(e,n,i,r,a){this.done=e,this.undone=n,this.prevRanges=i,this.prevTime=r,this.prevComposition=a}}const tue=20;function nue(t,e,n,i){let r=n.getMeta(Du),a;if(r)return r.historyState;n.getMeta(rue)&&(t=new cu(t.done,t.undone,null,0,-1));let d=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(d&&d.getMeta(Du))return d.getMeta(Du).redo?new cu(t.done.addTransform(n,void 0,i,C_(e)),t.undone,L3(n.mapping.maps[n.steps.length-1]),t.prevTime,t.prevComposition):new cu(t.done,t.undone.addTransform(n,void 0,i,C_(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(d&&d.getMeta("addToHistory")===!1)){let o=n.getMeta("composition"),f=t.prevTime==0||!d&&t.prevComposition!=o&&(t.prevTime<(n.time||0)-i.newGroupDelay||!iue(n,t.prevRanges)),g=d?Rk(t.prevRanges,n.mapping):L3(n.mapping.maps[n.steps.length-1]);return new cu(t.done.addTransform(n,f?e.selection.getBookmark():void 0,i,C_(e)),Ga.empty,g,n.time,o==null?t.prevComposition:o)}else return(a=n.getMeta("rebased"))?new cu(t.done.rebased(n,a),t.undone.rebased(n,a),Rk(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new cu(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Rk(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function iue(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((i,r)=>{for(let a=0;a<e.length;a+=2)i<=e[a+1]&&r>=e[a]&&(n=!0)}),n}function L3(t){let e=[];return t.forEach((n,i,r,a)=>e.push(r,a)),e}function Rk(t,e){if(!t)return null;let n=[];for(let i=0;i<t.length;i+=2){let r=e.map(t[i],1),a=e.map(t[i+1],-1);r<=a&&n.push(r,a)}return n}function _j(t,e,n,i){let r=C_(e),a=Du.get(e).spec.config,d=(i?t.undone:t.done).popEvent(e,r);if(!d)return;let o=d.selection.resolve(d.transform.doc),f=(i?t.done:t.undone).addTransform(d.transform,e.selection.getBookmark(),a,r),g=new cu(i?f:d.remaining,i?d.remaining:f,null,0,-1);n(d.transform.setSelection(o).setMeta(Du,{redo:i,historyState:g}).scrollIntoView())}let Lk=!1,z3=null;function C_(t){let e=t.plugins;if(z3!=e){Lk=!1,z3=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Lk=!0;break}}return Lk}const Du=new Qu("history"),rue=new Qu("closeHistory");function oue(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new ya({key:Du,state:{init(){return new cu(Ga.empty,Ga.empty,null,0,-1)},apply(e,n,i){return nue(n,i,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let i=n.inputType,r=i=="historyUndo"?xj:i=="historyRedo"?wj:null;return r?(n.preventDefault(),r(e.state,e.dispatch)):!1}}}})}const xj=(t,e)=>{let n=Du.getState(t);return!n||n.done.eventCount==0?!1:(e&&_j(n,t,e,!1),!0)},wj=(t,e)=>{let n=Du.getState(t);return!n||n.undone.eventCount==0?!1:(e&&_j(n,t,e,!0),!0)},sue=Es.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>xj(t,e),redo:()=>({state:t,dispatch:e})=>wj(t,e)}},addProseMirrorPlugins(){return[oue(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),aue=Gs.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Yr(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{const{$to:n}=e.selection,i=t();return n.parentOffset===0?i.insertContentAt(Math.max(n.pos-2,0),{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:r,dispatch:a})=>{var d;if(a){const{$to:o}=r.selection,f=o.end();if(o.nodeAfter)o.nodeAfter.isTextblock?r.setSelection(Bn.create(r.doc,o.pos+1)):o.nodeAfter.isBlock?r.setSelection(Cn.create(r.doc,o.pos)):r.setSelection(Bn.create(r.doc,o.pos));else{const g=(d=o.parent.type.contentMatch.defaultType)===null||d===void 0?void 0:d.create();g&&(r.insert(f,g),r.setSelection(Bn.create(r.doc,f+1)))}r.scrollIntoView()}return!0}).run()}}},addInputRules(){return[wce({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),lue=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,cue=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,uue=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,due=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,hue=Rl.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[lm({find:lue,type:this.type}),lm({find:uue,type:this.type})]},addPasteRules(){return[cm({find:cue,type:this.type}),cm({find:due,type:this.type})]}}),fue=Gs.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Yr(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),pue=Gs.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Yr(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),B3=Rl.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:t=>t.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["span",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:t,commands:e})=>{const n=xw(t,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:e.unsetMark(this.name)}}}}),F3=/^(\d+)\.\s$/,mue=Gs.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",Yr(this.options.HTMLAttributes,n),0]:["ol",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(pue.name,this.editor.getAttributes(B3.name)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Mv({find:F3,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Mv({find:F3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(B3.name)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),gue=Gs.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),yue=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,vue=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,bue=Rl.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Yr(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){const t={};return VA()?t["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():t["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),t},addInputRules(){return[lm({find:yue,type:this.type})]},addPasteRules(){return[cm({find:vue,type:this.type})]}}),_ue=Gs.create({name:"text",group:"inline"}),xue=Es.create({name:"starterKit",addExtensions(){var t,e,n,i,r,a,d,o,f,g,_,w,T,A,D,z,G,V;const N=[];return this.options.blockquote!==!1&&N.push(Ece.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bold!==!1&&N.push(Ace.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&N.push(Pce.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&N.push(Rce.configure((i=this.options)===null||i===void 0?void 0:i.code)),this.options.codeBlock!==!1&&N.push(Bce.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&N.push(Fce.configure((a=this.options)===null||a===void 0?void 0:a.document)),this.options.dropcursor!==!1&&N.push(jce.configure((d=this.options)===null||d===void 0?void 0:d.dropcursor)),this.options.gapcursor!==!1&&N.push(Xce.configure((o=this.options)===null||o===void 0?void 0:o.gapcursor)),this.options.hardBreak!==!1&&N.push(Kce.configure((f=this.options)===null||f===void 0?void 0:f.hardBreak)),this.options.heading!==!1&&N.push(Yce.configure((g=this.options)===null||g===void 0?void 0:g.heading)),this.options.history!==!1&&N.push(sue.configure((_=this.options)===null||_===void 0?void 0:_.history)),this.options.horizontalRule!==!1&&N.push(aue.configure((w=this.options)===null||w===void 0?void 0:w.horizontalRule)),this.options.italic!==!1&&N.push(hue.configure((T=this.options)===null||T===void 0?void 0:T.italic)),this.options.listItem!==!1&&N.push(fue.configure((A=this.options)===null||A===void 0?void 0:A.listItem)),this.options.orderedList!==!1&&N.push(mue.configure((D=this.options)===null||D===void 0?void 0:D.orderedList)),this.options.paragraph!==!1&&N.push(gue.configure((z=this.options)===null||z===void 0?void 0:z.paragraph)),this.options.strike!==!1&&N.push(bue.configure((G=this.options)===null||G===void 0?void 0:G.strike)),this.options.text!==!1&&N.push(_ue.configure((V=this.options)===null||V===void 0?void 0:V.text)),N}}),wue=({renderers:t})=>We.createElement(We.Fragment,null,Object.entries(t).map(([e,n])=>E4.createPortal(n.reactElement,n.element,e)));class Sue extends We.Component{constructor(e){super(e),this.editorContentRef=We.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:e}=this.props;if(e&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=this,e.createNodeViews(),this.initialized=!0}}maybeFlushSync(e){this.initialized?Bv.flushSync(e):e()}setRenderer(e,n){this.maybeFlushSync(()=>{this.setState(({renderers:i})=>({renderers:{...i,[e]:n}}))})}removeRenderer(e){this.maybeFlushSync(()=>{this.setState(({renderers:n})=>{const i={...n};return delete i[e],{renderers:i}})})}componentWillUnmount(){const{editor:e}=this.props;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,...n}=this.props;return We.createElement(We.Fragment,null,We.createElement("div",{ref:this.editorContentRef,...n}),We.createElement(wue,{renderers:this.state.renderers}))}}const Eue=t=>{const e=We.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return We.createElement(Sue,{key:e,...t})},kue=We.memo(Eue);class Tue extends xce{constructor(){super(...arguments),this.contentComponent=null}}function Cue(){const[,t]=et.useState(0);return()=>t(e=>e+1)}const Iue=(t={},e=[])=>{const[n,i]=et.useState(null),r=Cue(),{onBeforeCreate:a,onBlur:d,onCreate:o,onDestroy:f,onFocus:g,onSelectionUpdate:_,onTransaction:w,onUpdate:T}=t,A=et.useRef(a),D=et.useRef(d),z=et.useRef(o),G=et.useRef(f),V=et.useRef(g),N=et.useRef(_),q=et.useRef(w),K=et.useRef(T);return et.useEffect(()=>{n&&(a&&(n.off("beforeCreate",A.current),n.on("beforeCreate",a),A.current=a),d&&(n.off("blur",D.current),n.on("blur",d),D.current=d),o&&(n.off("create",z.current),n.on("create",o),z.current=o),f&&(n.off("destroy",G.current),n.on("destroy",f),G.current=f),g&&(n.off("focus",V.current),n.on("focus",g),V.current=g),_&&(n.off("selectionUpdate",N.current),n.on("selectionUpdate",_),N.current=_),w&&(n.off("transaction",q.current),n.on("transaction",w),q.current=w),T&&(n.off("update",K.current),n.on("update",T),K.current=T))},[a,d,o,f,g,_,w,T,n]),et.useEffect(()=>{let se=!0;const ie=new Tue(t);return i(ie),ie.on("transaction",()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{se&&r()})})}),()=>{se=!1}},e),et.useEffect(()=>()=>{n==null||n.destroy()},[n]),n},Aue=et.createContext({editor:null});Aue.Consumer;const Mue=et.createContext({onDragStart:void 0}),Pue=()=>et.useContext(Mue);We.forwardRef((t,e)=>{const{onDragStart:n}=Pue(),i=t.as||"div";return We.createElement(i,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const Oue=ti`
  mutation CreatePost($channelId: Int!, $text: String!) {
    createPost(channelId: $channelId, text: $text) {
      ...PostFields
    }
  }
  ${EA}
`,Due=t=>{const e=ji(),[n]=Ir(Oue,{onError:r=>{console.log(r),t()},onCompleted:r=>{console.log(r),e($1([r.createPost])),t()}});return(r,a)=>{n({variables:{channelId:r,text:a}})}},N3=[xue.configure({history:{depth:100}})],Rue="",Sj=({isPopup:t})=>{var se;ei(Ws);const e=ei(Zu),n=ei(ie=>{var Q;return cee(ie,(Q=e==null?void 0:e.id)!=null?Q:-1)}),i=ei(V1),r=Ore(),[a,d]=et.useState(!0);et.useEffect(()=>{if(a){if(d(!1),!e||!f)return;f==null||f.setEditable(!1),T(e.id,f.getText())}},[a]);const o=Es.create({name:"custom",addKeyboardShortcuts(){return{Enter:()=>(d(!0),!0)}}});N3.push(o);const f=Iue({extensions:N3,content:Rue}),[g,_]=et.useState(""),T=Due(ie=>{f==null||f.commands.clearContent(),f==null||f.setEditable(!0),ie&&(_(ie),setTimeout(()=>{_("")},3e3))}),A=()=>{!e||!f||(f.setEditable(!1),T(e.id,f.getText()))},[D,z]=et.useState(!0);et.useEffect(()=>{var Q;if(!(e!=null&&e.id)||!D)return;const ie=n.reduce((J,te)=>!J||te.createdAt<J?te.createdAt:J,(Q=n[0])==null?void 0:Q.createdAt);r(e.id,ie),z(!1)},[e==null?void 0:e.id,D]);const G=et.useRef(null),[V,N]=et.useState(!0),[q,K]=et.useState(0);return et.useEffect(()=>{G.current&&(K(G.current.scrollHeight),V?G.current.scrollTo({top:G.current.scrollHeight,behavior:"auto"}):G.current.scrollHeight>q&&G.current.scrollTo({top:G.current.scrollHeight-q+G.current.scrollTop}))},[(se=G.current)==null?void 0:se.scrollHeight,V]),et.useEffect(()=>{var Q;const ie=()=>{var J,te,me,Fe,tt,At;((J=G.current)==null?void 0:J.scrollTop)===((me=(te=G.current)==null?void 0:te.scrollHeight)!=null?me:0)-((tt=(Fe=G.current)==null?void 0:Fe.offsetHeight)!=null?tt:0)?(console.log("scrolled to bottom"),N(!0)):(((At=G.current)==null?void 0:At.scrollTop)===0&&z(!0),N(!1))};return(Q=G.current)==null||Q.addEventListener("scroll",ie),()=>{var J;(J=G.current)==null||J.removeEventListener("scroll",ie)}},[G.current]),Qt("div",{style:{fontSize:14,display:"flex",flexDirection:"column",justifyContent:"end",height:"100%"},children:[Qt("div",{ref:G,style:{height:"100%",overflowY:"scroll"},children:[Ae("div",{style:{display:D?"flex":"none",padding:20},children:Ae(iJ,{})}),n.sort((ie,Q)=>ie.createdAt<Q.createdAt?-1:1).map(ie=>{var Q,J,te;return Qt(lh,{style:{margin:5,padding:10},children:[Qt("div",{style:{display:"flex",marginBottom:5},children:[Ae(L1,{style:{width:20,height:20,marginRight:5},children:Ae("img",{src:`https://www.gravatar.com/avatar/${lw((J=(Q=i[ie.userId])==null?void 0:Q.email)!=null?J:"")}?d=retro`})}),(te=i[ie.userId])==null?void 0:te.name]}),Ae("div",{style:{color:"var(--ion-color-dark)"},children:ie.text})]},ie.id)})]}),Qt("div",{style:{margin:10,border:"1px solid",borderRadius:5,display:"flex"},children:[Ae("div",{style:{minWidth:t?150:320},children:Ae(kue,{editor:f})}),Ae(rr,{style:{paddingRight:5},children:Ae(Rn,{onClick:A,style:{border:"1px solid",borderRadius:5},children:Ae(yr,{icon:KJ})})})]})]})},Ej=({})=>(ei(Ws),ei(Zu),Ae("div",{})),Lue=ti`
  mutation SetMembershipSavedIndex($membershipId: Int!, $index: Int) {
    setMembershipSavedIndex(membershipId: $membershipId, index: $index) {
      ...MembershipFields
    }
  }
  ${Em}
`,WA=()=>{const t=ji(),[e]=Ir(Lue,{onError:i=>{console.error(i)},onCompleted:i=>{console.log(i),t($h(i.setMembershipSavedIndex))}});return(i,r)=>{e({variables:{membershipId:i,index:r}})}},$3=({router:t,authModal:e,streams:n,channelMode:i,setChannelMode:r})=>{ji();const a=ei(Ws),d=ei(Zu),o=ei(T=>{var A,D;return A5(T,(A=d==null?void 0:d.id)!=null?A:-1,(D=a==null?void 0:a.id)!=null?D:-1)}),f=WA(),g=()=>{o!=null&&o.id&&((o==null?void 0:o.savedIndex)===null?f(o.id,0):f(o.id,null))},_=()=>{t.push("/channel/"+(d==null?void 0:d.id),"none")},w=()=>{t.push("/map","none")};return Qt("div",{className:"popup",style:{width:220},children:[Qt("div",{children:[Qt("div",{style:{marginTop:5,fontSize:24,fontWeight:"bold",display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Ae("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:d==null?void 0:d.name}),Qt(rr,{style:{},children:[Ae(Rn,{onClick:g,children:Ae(yr,{icon:!(o!=null&&o.id)||(o==null?void 0:o.savedIndex)===null?m5:VI,size:"small",style:{color:!(o!=null&&o.id)||(o==null?void 0:o.savedIndex)===null?null:"var(--ion-color-primary)"}})}),Ae(Rn,{onClick:_,children:Ae(yr,{icon:JJ,size:"small"})}),Ae(Rn,{onClick:w,children:Ae(yr,{icon:jI,size:"small"})})]})]}),Ae("div",{style:{marginTop:10,textAlign:"left",fontSize:14,color:"var(--ion-color-medium)"},children:d==null?void 0:d.detail}),Qt(rr,{style:{marginTop:5,display:"flex",flexDirection:"row",justifyContent:"center"},children:[Ae(Rn,{onClick:()=>r("talk"),style:{color:i==="talk"?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:i==="talk"?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TALK"}),Ae(Rn,{onClick:()=>r("text"),style:{color:i==="text"?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:i==="text"?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TEXT"}),Ae(Rn,{onClick:()=>r("roam"),style:{color:i==="roam"?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:i==="roam"?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"ROAM"})]})]}),Ae("div",{style:{marginTop:10,height:300},children:i==="talk"?Ae(J$,{authModal:e,streams:n}):i==="text"?Ae(Sj,{isPopup:!0}):i==="roam"?Ae(Ej,{}):null})]})},j3=({createChannel:t})=>Ae("div",{className:"popup",style:{marginTop:5},children:Ae(rr,{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:Ae(Rn,{onClick:t,style:{color:"var(--ion-color-primary)",border:"1px solid var(--ion-color-primary)",borderRadius:"5px",fontWeight:"bold"},children:"NEW CHANNEL"})})});Ey.accessToken="pk.eyJ1Ijoid2VpaHoiLCJhIjoiY2xlNjVuaWI1MDJjcjNybXJsbGo4bXgyMiJ9.w_9vD530_V81gcdS-yZOLw";const zue=({})=>{var gt,Nt,en,Xt;const t=ji(),{streams:e,authModal:n,shouldUpdateMapData:i,setShouldUpdateMapData:r,newChannelLngLat:a,setNewChannelLngLat:d,channelMode:o,setChannelMode:f}=et.useContext(zl),g=bm(),_=ei(Ws),w=ei(Zu),[T,A]=et.useState(-70.9),[D,z]=et.useState(42.35),[G,V]=et.useState(9),N=et.useRef(null),q=et.useRef(null),K=et.useRef(null),se=et.useRef(null),ie=et.useRef(null),Q=ei(V1),J=ei(P5),te=ei(wt=>{var Zt;return iee(wt,(Zt=_==null?void 0:_.id)!=null?Zt:-1)}),[me,Fe]=et.useState(!1),tt=kre(r),At=()=>{var wt;_!=null&&_.id?g.push("/create-channel"):(wt=n==null?void 0:n.current)==null||wt.present()},[_t,xt]=et.useState(-1);et.useEffect(()=>{_t!==-1&&(_t?_t===(w==null?void 0:w.id)?g.push("/map","none"):g.push("/map/"+_t,"none"):g.routeInfo.pathname!=="/map"&&g.push("/map","none"),xt(-1))},[_t,w==null?void 0:w.id,g.routeInfo.pathname]),et.useEffect(()=>{const wt=/^\/map\/(\d+)/,Zt=g.routeInfo.pathname.match(wt);if(Zt){const Fn=parseInt(Zt[1]);Fn!==(w==null?void 0:w.id)&&t(g_(Fn))}else{const Fn=/^\/channel\/(\d+)/,Ci=g.routeInfo.pathname.match(Fn);if(Ci){const Vi=parseInt(Ci[1]);Vi!==(w==null?void 0:w.id)&&t(g_(Vi))}else w!=null&&w.id&&t(g_(null))}},[g.routeInfo.pathname]),et.useEffect(()=>{tt(T,D)},[]),et.useEffect(()=>{console.log("initializing map"),K.current=new Ey.Map({container:q.current,style:"mapbox://styles/mapbox/streets-v12",center:[T,D],zoom:G,trackResize:!0}),K.current.on("load",function(){var wt;console.log("map loaded"),(wt=K.current)==null||wt.resize(),Fe(!0)}),K.current.on("move",()=>{K.current&&(A(K.current.getCenter().lng),z(K.current.getCenter().lat),V(K.current.getZoom()))}),K.current.on("click",wt=>{setTimeout(()=>{wt.clickOnLayer||(console.log("map click",wt.lngLat),d(wt.lngLat),xt(null))},100)})},[]),et.useEffect(()=>{!K.current||!me||!i||(K.current.getSource("channels")&&(K.current.removeLayer("clusters"),K.current.removeLayer("cluster-count"),K.current.removeLayer("unclustered-point"),K.current.removeSource("channels")),K.current.addSource("channels",{type:"geojson",data:{type:"FeatureCollection",features:Object.values(J).map(wt=>({type:"Feature",properties:{id:wt.id,memberCount:wt.memberCount,activeUserCount:wt.activeUserCount},geometry:{type:"Point",coordinates:[wt.lng,wt.lat]}}))},cluster:!0,clusterMaxZoom:14,clusterRadius:30,clusterProperties:{memberCount:["+",["get","memberCount"]],activeUserCount:["+",["get","activeUserCount"]]}}),K.current.addLayer({id:"clusters",type:"circle",source:"channels",filter:["has","point_count"],paint:{"circle-color":["case",[">",["get","activeUserCount"],0],"#f4900c","grey"],"circle-radius":["step",["get","point_count"],20,10,30,100,40,1e3,50],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),K.current.addLayer({id:"cluster-count",type:"symbol",source:"channels",filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-font":["Open Sans Semibold"],"text-size":12}}),K.current.addLayer({id:"unclustered-point",type:"circle",source:"channels",filter:["!",["has","point_count"]],paint:{"circle-color":["case",[">",["get","activeUserCount"],0],"#f4900c","grey"],"circle-radius":12,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),K.current.on("click","clusters",wt=>{var Ci,Vi,gn;wt.clickOnLayer=!0,xt(null);const Zt=(Ci=K.current)==null?void 0:Ci.queryRenderedFeatures(wt.point,{layers:["clusters"]});if(!Zt)return;const Fn=(Vi=Zt[0].properties)==null?void 0:Vi.cluster_id;((gn=K.current)==null?void 0:gn.getSource("channels")).getClusterExpansionZoom(Fn,(sr,fi)=>{var wo;sr||(wo=K.current)==null||wo.easeTo({center:Zt[0].geometry.coordinates,zoom:fi})})}),K.current.on("click","unclustered-point",wt=>{var Fn;if(wt.clickOnLayer=!0,!wt.features)return;const Zt=(Fn=wt.features[0].properties)==null?void 0:Fn.id;Zt&&xt(Zt)}),K.current.on("mouseenter","clusters",()=>{K.current&&(K.current.getCanvas().style.cursor="pointer")}),K.current.on("mouseleave","clusters",()=>{K.current&&(K.current.getCanvas().style.cursor="")}),K.current.on("mouseenter","unclustered-point",()=>{K.current&&(K.current.getCanvas().style.cursor="pointer")}),K.current.on("mouseleave","unclustered-point",()=>{K.current&&(K.current.getCanvas().style.cursor="")}),r(!1))},[me,i,J,te,(gt=K.current)==null?void 0:gt.getSource("channels"),Q]);const lt=et.useRef(null),[zt,ze]=et.useState(null);et.useEffect(()=>{var wt,Zt,Fn,Ci,Vi,gn,sr;if(console.log("update channel popup",w==null?void 0:w.id,zt,o,(wt=q.current)==null?void 0:wt.clientWidth,(Zt=q.current)==null?void 0:Zt.clientHeight),ze((Fn=w==null?void 0:w.id)!=null?Fn:null),w!=null&&w.id)if((w.lat!==D||w.lng!==T)&&((Ci=K.current)==null||Ci.easeTo({center:[w.lng,w.lat]})),(w==null?void 0:w.id)!==zt){(Vi=lt.current)==null||Vi.remove(),d(null);const fi=document.createElement("div");se.current=sx(fi),se.current.render(Ae(OC,{client:d2,children:Ae(iC,{store:rC,children:Ae($3,{router:g,authModal:n,streams:e,channelMode:o,setChannelMode:f})})})),lt.current=new Ey.Popup({offset:15,focusAfterOpen:!0,closeButton:!1}).setLngLat([w.lng,w.lat]).setDOMContent(fi).addTo(K.current)}else(gn=se.current)==null||gn.render(Ae(OC,{client:d2,children:Ae(iC,{store:rC,children:Ae($3,{router:g,authModal:n,streams:e,channelMode:o,setChannelMode:f})})}));else(sr=lt.current)==null||sr.remove(),lt.current=null},[w==null?void 0:w.id,e,o,(Nt=q.current)==null?void 0:Nt.clientWidth,(en=q.current)==null?void 0:en.clientHeight]),et.useEffect(()=>{var wt;if(a)if(xt(null),N.current&&ie.current)ie.current.render(Ae(j3,{createChannel:At})),N.current.setLngLat(a).addTo(K.current),N.current.getPopup().isOpen()||N.current.togglePopup();else{const Zt=document.createElement("div"),Fn=sx(Zt);Fn.render(Ae(j3,{createChannel:At})),ie.current=Fn,N.current=new Ey.Marker({color:"#f4900c"}).setLngLat(a).setPopup(new Ey.Popup({offset:40,focusAfterOpen:!0,closeButton:!1}).setDOMContent(Zt)).addTo(K.current).togglePopup(),N.current.getElement().addEventListener("click",Ci=>{var Vi;Ci.stopPropagation(),d(null),(Vi=N.current)==null||Vi.remove()})}else(wt=N.current)==null||wt.remove()},[a]);const ot=WA(),Be=wt=>()=>{g.push("/map/"+wt,"none"),oc.close()},ft=wt=>Zt=>{Zt.stopPropagation(),ot(wt,null)};return(Xt=K.current)==null||Xt.resize(),et.useEffect(()=>{const wt=()=>{var Zt;(Zt=K.current)==null||Zt.resize()};return window.addEventListener("resize",wt),()=>{window.removeEventListener("resize",wt)}},[]),Qt(hq,{children:[Qt(tJ,{type:"overlay",menuId:"map-menu",contentId:"map-main-content",children:[Ae(z1,{style:{marginTop:ii("ios")&&!ii("mobileweb")?105:55,padding:10},children:"SAVED CHANNELS"}),Ae(da,{children:te.filter(wt=>wt.savedIndex!==null).sort((wt,Zt)=>wt.savedIndex-Zt.savedIndex).map(wt=>Qt(lh,{onClick:Be(wt.channelId),style:{margin:5,padding:10,cursor:"pointer",display:"flex",justifyContent:"space-between"},children:[Ae("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:J[wt.channelId].name}),Ae(rr,{children:Ae(Rn,{onClick:ft(wt.id),children:Ae(yr,{icon:jI})})})]},wt.id))})]}),Ae(hc,{id:"map-main-content",children:Qt(da,{fullscreen:!0,style:{position:"relative"},children:[Ae("div",{ref:q,className:"map-container",style:{opacity:me?1:0,top:0,left:0,right:0,bottom:0,position:"fixed"}}),Ae(lh,{style:{position:"fixed",borderRadius:3,zIndex:10,left:ii("ios")?-10:0,top:ii("ios")?ii("mobileweb")?32:92:52,padding:10},children:w!=null&&w.id?J[w.id].lng.toPrecision(6)+", "+J[w.id].lat.toPrecision(6):a?(a==null?void 0:a.lng.toPrecision(6))+", "+(a==null?void 0:a.lat.toPrecision(6)):T.toPrecision(6)+", "+D.toPrecision(6)}),Ae(lh,{style:{position:"fixed",borderRadius:3,zIndex:10,left:ii("ios")?-10:0,top:ii("ios")?ii("mobileweb")?72:142:92},children:Ae(nJ,{autoHide:!1,children:Ae(rr,{children:Ae(Rn,{children:Ae(yr,{icon:VI,size:"small"})})})})})]})})]})};function GA(t){return Uint8Array.from(window.atob(t),e=>e.charCodeAt(0))}const Bue=({deal:t})=>{const[e,n]=et.useState("");et.useEffect(()=>{const r=GA(t.image.data),a=new Blob([r],{type:"image/jpeg"}),d=URL.createObjectURL(a);return n(d),()=>{URL.revokeObjectURL(d)}},[]);const i="/deal/"+t.id;return Qt(lh,{routerLink:i,style:{margin:"auto",marginBottom:10,padding:10,maxWidth:420,color:"var(--ion-color-secondary-contrast)",backgroundColor:"var(--ion-color-primary-contrast)"},children:[Ae("h1",{style:{marginTop:0,marginBottom:10,fontWeight:"bold",fontSize:32,display:"flex",flexDirection:"row",justifyContent:"center"},children:t.name}),Ae("img",{src:e,style:{width:"100%",borderRadius:5}}),Ae("h3",{style:{margin:5,display:"flex",flexDirection:"row",justifyContent:"center"},children:t.detail}),Qt("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",padding:10},children:[Qt("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[t.quantity," available @ "]}),Ae(rr,{children:Qt(Rn,{routerLink:i,style:{backgroundColor:"",borderRadius:5,border:"1px solid"},children:["$",t.price]})})]})]})},Fue=ti`
  mutation GetDeals {
    getDeals {
      id
      vendorId
      name
      detail
      quantity
      price
      image {
        data
      }
    }
  }
`,Nue=()=>{const t=bm(),e=ji(),{authModal:n}=et.useContext(zl),i=ei(Ws),r=ei(G5),[a]=Ir(Fue,{onError:o=>{console.log(o)},onCompleted:o=>{console.log(o),e(Qee(o.getDeals))}});et.useEffect(()=>{a()},[]);const d=()=>{var o;i!=null&&i.id?t.push("/create-deal"):(o=n.current)==null||o.present()};return Ae(hc,{children:Qt(da,{fullscreen:!0,children:[Ae("div",{style:{padding:10,backgroundColor:"#222222",minHeight:"100%"},children:Object.values(r).map(o=>Ae(Bue,{deal:o},"deal"+o.id))}),Ae(eJ,{vertical:"bottom",horizontal:"end",slot:"fixed",children:Ae(rJ,{onClick:d,size:"small",style:{boxShadow:"0 5px 15px rgb(0 0 0 / 0.2)",borderRadius:"50%"},children:Ae(yr,{icon:jJ})})})]})})};function V3(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function U3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?V3(Object(n),!0).forEach(function(i){kj(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V3(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function I_(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?I_=function(e){return typeof e}:I_=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I_(t)}function kj(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A_(t,e){return $ue(t)||jue(t,e)||Vue(t,e)||Uue()}function $ue(t){if(Array.isArray(t))return t}function jue(t,e){var n=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(n!=null){var i=[],r=!0,a=!1,d,o;try{for(n=n.call(t);!(r=(d=n.next()).done)&&(i.push(d.value),!(e&&i.length===e));r=!0);}catch(f){a=!0,o=f}finally{try{!r&&n.return!=null&&n.return()}finally{if(a)throw o}}return i}}function Vue(t,e){if(t){if(typeof t=="string")return q3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q3(t,e)}}function q3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Uue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var t2=function(e){var n=We.useRef(e);return We.useEffect(function(){n.current=e},[e]),n.current},um=function(e){return e!==null&&I_(e)==="object"},que=function(e){return um(e)&&typeof e.then=="function"},Wue=function(e){return um(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},W3="[object Object]",Gue=function t(e,n){if(!um(e)||!um(n))return e===n;var i=Array.isArray(e),r=Array.isArray(n);if(i!==r)return!1;var a=Object.prototype.toString.call(e)===W3,d=Object.prototype.toString.call(n)===W3;if(a!==d)return!1;if(!a&&!i)return e===n;var o=Object.keys(e),f=Object.keys(n);if(o.length!==f.length)return!1;for(var g={},_=0;_<o.length;_+=1)g[o[_]]=!0;for(var w=0;w<f.length;w+=1)g[f[w]]=!0;var T=Object.keys(g);if(T.length!==o.length)return!1;var A=e,D=n,z=function(V){return t(A[V],D[V])};return T.every(z)},Tj=function(e,n,i){return um(e)?Object.keys(e).reduce(function(r,a){var d=!um(n)||!Gue(e[a],n[a]);return i.includes(a)?(d&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),r):d?U3(U3({},r||{}),{},kj({},a,e[a])):r},null):null},Hue="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",G3=function(e){if(e===null||Wue(e))return e;throw new Error(Hue)},Zue=function(e){if(que(e))return{tag:"async",stripePromise:Promise.resolve(e).then(G3)};var n=G3(e);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},HA=We.createContext(null);HA.displayName="ElementsContext";var Xue=function(e,n){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return e},ZA=We.createContext(null);ZA.displayName="CartElementContext";var Kue=function(e,n){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return e},Cj=function(e){var n=e.stripe,i=e.options,r=e.children,a=We.useMemo(function(){return Zue(n)},[n]),d=We.useState(null),o=A_(d,2),f=o[0],g=o[1],_=We.useState(null),w=A_(_,2),T=w[0],A=w[1],D=We.useState(function(){return{stripe:a.tag==="sync"?a.stripe:null,elements:a.tag==="sync"?a.stripe.elements(i):null}}),z=A_(D,2),G=z[0],V=z[1];We.useEffect(function(){var K=!0,se=function(Q){V(function(J){return J.stripe?J:{stripe:Q,elements:Q.elements(i)}})};return a.tag==="async"&&!G.stripe?a.stripePromise.then(function(ie){ie&&K&&se(ie)}):a.tag==="sync"&&!G.stripe&&se(a.stripe),function(){K=!1}},[a,G,i]);var N=t2(n);We.useEffect(function(){N!==null&&N!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[N,n]);var q=t2(i);return We.useEffect(function(){if(G.elements){var K=Tj(i,q,["clientSecret","fonts"]);K&&G.elements.update(K)}},[i,q,G.elements]),We.useEffect(function(){var K=G.stripe;!K||!K._registerWrapper||!K.registerAppInfo||(K._registerWrapper({name:"react-stripe-js",version:"2.1.1"}),K.registerAppInfo({name:"react-stripe-js",version:"2.1.1",url:"https://stripe.com/docs/stripe-js/react"}))},[G.stripe]),We.createElement(HA.Provider,{value:G},We.createElement(ZA.Provider,{value:{cart:f,setCart:g,cartState:T,setCartState:A}},r))};Cj.propTypes={stripe:mr.any,options:mr.object};var Qx=function(e){var n=We.useContext(HA);return Xue(n,e)},H3=function(e){var n=We.useContext(ZA);return Kue(n,e)},Yue=function(){var e=Qx("calls useElements()"),n=e.elements;return n},Jue=function(){var e=Qx("calls useStripe()"),n=e.stripe;return n};mr.func.isRequired;var Go=function(e,n,i){var r=!!i,a=We.useRef(i);We.useEffect(function(){a.current=i},[i]),We.useEffect(function(){if(!r||!e)return function(){};var d=function(){a.current&&a.current.apply(a,arguments)};return e.on(n,d),function(){e.off(n,d)}},[r,n,e,a])},Que=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},jr=function(e,n){var i="".concat(Que(e),"Element"),r=function(f){var g=f.id,_=f.className,w=f.options,T=w===void 0?{}:w,A=f.onBlur,D=f.onFocus,z=f.onReady,G=f.onChange,V=f.onEscape,N=f.onClick,q=f.onLoadError,K=f.onLoaderStart,se=f.onNetworksChange,ie=f.onCheckout,Q=f.onLineItemClick,J=f.onConfirm,te=f.onCancel,me=f.onShippingAddressChange,Fe=f.onShippingRateChange,tt=Qx("mounts <".concat(i,">")),At=tt.elements,_t=We.useState(null),xt=A_(_t,2),lt=xt[0],zt=xt[1],ze=We.useRef(null),ot=We.useRef(null),Be=H3("mounts <".concat(i,">")),ft=Be.setCart,gt=Be.setCartState;Go(lt,"blur",A),Go(lt,"focus",D),Go(lt,"escape",V),Go(lt,"click",N),Go(lt,"loaderror",q),Go(lt,"loaderstart",K),Go(lt,"networkschange",se),Go(lt,"lineitemclick",Q),Go(lt,"confirm",J),Go(lt,"cancel",te),Go(lt,"shippingaddresschange",me),Go(lt,"shippingratechange",Fe);var Nt;e==="cart"?Nt=function(Fn){gt(Fn),z&&z(Fn)}:z&&(e==="expressCheckout"?Nt=z:Nt=function(){z(lt)}),Go(lt,"ready",Nt);var en=e==="cart"?function(Zt){gt(Zt),G&&G(Zt)}:G;Go(lt,"change",en);var Xt=e==="cart"?function(Zt){gt(Zt),ie&&ie(Zt)}:ie;Go(lt,"checkout",Xt),We.useLayoutEffect(function(){if(ze.current===null&&At&&ot.current!==null){var Zt=At.create(e,T);e==="cart"&&ft&&ft(Zt),ze.current=Zt,zt(Zt),Zt.mount(ot.current)}},[At,T,ft]);var wt=t2(T);return We.useEffect(function(){if(ze.current){var Zt=Tj(T,wt,["paymentRequest"]);Zt&&ze.current.update(Zt)}},[T,wt]),We.useLayoutEffect(function(){return function(){if(ze.current&&typeof ze.current.destroy=="function")try{ze.current.destroy(),ze.current=null}catch(Zt){}}},[]),We.createElement("div",{id:g,className:_,ref:ot})},a=function(f){Qx("mounts <".concat(i,">")),H3("mounts <".concat(i,">"));var g=f.id,_=f.className;return We.createElement("div",{id:g,className:_})},d=n?a:r;return d.propTypes={id:mr.string,className:mr.string,onChange:mr.func,onBlur:mr.func,onFocus:mr.func,onReady:mr.func,onEscape:mr.func,onClick:mr.func,onLoadError:mr.func,onLoaderStart:mr.func,onNetworksChange:mr.func,onCheckout:mr.func,onLineItemClick:mr.func,onConfirm:mr.func,onCancel:mr.func,onShippingAddressChange:mr.func,onShippingRateChange:mr.func,options:mr.object},d.displayName=i,d.__elementType=e,d},Vr=typeof window>"u";jr("auBankAccount",Vr);jr("card",Vr);jr("cardNumber",Vr);jr("cardExpiry",Vr);jr("cardCvc",Vr);jr("fpxBank",Vr);jr("iban",Vr);jr("idealBank",Vr);jr("p24Bank",Vr);jr("epsBank",Vr);var ede=jr("payment",Vr);jr("expressCheckout",Vr);jr("paymentRequestButton",Vr);var tde=jr("linkAuthentication",Vr);jr("address",Vr);jr("shippingAddress",Vr);jr("cart",Vr);jr("paymentMethodMessaging",Vr);jr("affirmMessage",Vr);jr("afterpayClearpayMessage",Vr);var Ij="https://js.stripe.com/v3",nde=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,Z3="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",ide=function(){for(var e=document.querySelectorAll('script[src^="'.concat(Ij,'"]')),n=0;n<e.length;n++){var i=e[n];if(nde.test(i.src))return i}return null},rde=function(e){var n=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",i=document.createElement("script");i.src="".concat(Ij).concat(n);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(i),i},ode=function(e,n){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"1.54.1",startTime:n})},Jb=null,sde=function(e){return Jb!==null||(Jb=new Promise(function(n,i){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe&&e&&console.warn(Z3),window.Stripe){n(window.Stripe);return}try{var r=ide();r&&e?console.warn(Z3):r||(r=rde(e)),r.addEventListener("load",function(){window.Stripe?n(window.Stripe):i(new Error("Stripe.js not available"))}),r.addEventListener("error",function(){i(new Error("Failed to load Stripe.js"))})}catch(a){i(a);return}})),Jb},ade=function(e,n,i){if(e===null)return null;var r=e.apply(void 0,n);return ode(r,i),r},Aj=Promise.resolve().then(function(){return sde(null)}),Mj=!1;Aj.catch(function(t){Mj||console.warn(t)});var lde=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];Mj=!0;var r=Date.now();return Aj.then(function(a){return ade(a,n,r)})};const cde=({deal:t})=>{const e=Jue(),n=Yue(),[i,r]=et.useState(""),[a,d]=et.useState(""),[o,f]=et.useState(!1);et.useEffect(()=>{if(!e)return;const w=new URLSearchParams(window.location.search).get("payment_intent_client_secret");w&&e.retrievePaymentIntent(w).then(({paymentIntent:T})=>{switch(T==null?void 0:T.status){case"succeeded":d("Payment succeeded!");break;case"processing":d("Your payment is processing.");break;case"requires_payment_method":d("Your payment was not successful, please try again.");break;default:d("Something went wrong.");break}})},[e]);const g=async w=>{if(w.preventDefault(),!e||!n)return;f(!0);const{error:T}=await e.confirmPayment({elements:n,confirmParams:{return_url:"https://jamn.io/home"}});T.type==="card_error"||T.type==="validation_error"?d(T.message||""):d("An unexpected error occurred."),f(!1)},_={layout:"tabs"};return Qt(lh,{style:{margin:0,backgroundColor:"white",padding:10},children:[Qt("div",{style:{fontSize:24,marginBottom:10},children:["$",t.price]}),Ae(tde,{id:"link-authentication-element",onChange:w=>{var T;return r((T=w==null?void 0:w.target)==null?void 0:T.value)}}),Ae(ede,{id:"payment-element",options:_}),Ae("div",{style:{paddingTop:10},children:Ae(Rn,{disabled:o||!e||!n,onClick:g,children:Ae("span",{id:"button-text",children:o?Ae("div",{className:"spinner",id:"spinner"}):"PAY NOW"})})}),a&&Ae("div",{id:"payment-message",children:a})]})},ude=ti`
  mutation CreatePaymentIntent($price: Int!) {
    createPaymentIntent(price: $price)
  }
`,dde="pk_test_51NKshHEepGte6R38JUzw5SLrUnIZpJfotvPkvwfT6VVnMjNkRxzLFPDOJzVP8fFqMjIIOj2iZ29oFBvjSJsQNI3E00ex7nypzU",hde=lde(dde),fde=({deal:t})=>{const[e,n]=et.useState(""),[i]=Ir(ude,{onError:d=>{console.log(d)},onCompleted:d=>{console.log(d),n(d.createPaymentIntent)}});et.useEffect(()=>{i({variables:{price:t.price*100}})},[]);const a={clientSecret:e,appearance:{theme:"stripe"}};return e?Ae(Cj,{options:a,stripe:hde,children:Ae(cde,{deal:t})}):null},pde=({match:t})=>{const e=ei(Ws),n=ei(a=>tte(a,parseInt(t.params.id))),[i,r]=et.useState("");return et.useEffect(()=>{if(!n)return;const a=GA(n.image.data),d=new Blob([a],{type:"image/jpeg"}),o=URL.createObjectURL(d);return r(o),()=>{URL.revokeObjectURL(o)}},[n==null?void 0:n.id]),n?Ae(hc,{children:Qt(da,{fullscreen:!0,children:[Qt("div",{style:{display:"flex",flexDirection:"row",justifyContent:"start",marginLeft:5,marginTop:5},children:[Ae(rr,{style:{display:"inline-flex",flexDirection:"column",justifyContent:"center"},children:Ae(Rn,{routerLink:"/deal",style:{},children:Ae(yr,{icon:VJ})})}),Ae("div",{style:{display:"inline-flex",fontSize:32,fontWeight:"bold",flexDirection:"column",justifyContent:"center"},children:n.name})]}),Qt("div",{style:{margin:"auto",maxWidth:420,padding:20,paddingTop:0},children:[Ae("img",{src:i,style:{marginTop:15,width:"100%",borderRadius:5}}),Ae("h3",{style:{},children:n.detail}),(e==null?void 0:e.id)&&n.quantity>0&&n.vendorId!==(e==null?void 0:e.id)&&Ae(fde,{deal:n})]})]})}):null},mde=ti`
  mutation SetUserCam($isCamOn: Boolean!) {
    setUserCam(isCamOn: $isCamOn) {
      id
      isCamOn
    }
  }
`;function gde(){const t=ji(),[e]=Ir(mde,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t(wc([i.setUserCam]))}});async function n(i){e({variables:{isCamOn:i}})}return n}const yde=ti`
  mutation SetUserMic($isMicOn: Boolean!) {
    setUserMic(isMicOn: $isMicOn) {
      id
      isMicOn
    }
  }
`;function vde(){const t=ji(),[e]=Ir(yde,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t(wc([i.setUserMic]))}});async function n(i){e({variables:{isMicOn:i}})}return n}const bde=ti`
  mutation SetUserSound($isSoundOn: Boolean!) {
    setUserSound(isSoundOn: $isSoundOn) {
      id
      isSoundOn
    }
  }
`;function _de(){const t=ji(),[e]=Ir(bde,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t(wc([i.setUserSound]))}});async function n(i){e({variables:{isSoundOn:i}})}return n}const xde=()=>{ji();const t=bm(),e=ei(Ws),n=ei(Zu),[i,r]=et.useState(0),a=()=>{e!=null&&e.activeChannelId&&e.activeChannelId!==(n==null?void 0:n.id)&&(t.routeInfo.pathname!=="/channel/"+e.activeChannelId||t.routeInfo.pathname!=="/map/"+e.activeChannelId)&&t.push("/map/"+e.activeChannelId,"none")};et.useEffect(()=>{if(e!=null&&e.activeChannelId){r(0);const T=setInterval(()=>{r(A=>A+1)},1e3);return()=>{clearInterval(T)}}},[e==null?void 0:e.activeChannelId]);const d=gde(),o=vde(),f=_de(),g=()=>{e!=null&&e.id&&d(!e.isCamOn)},_=()=>{e&&o(!e.isMicOn)},w=()=>{e&&f(!e.isSoundOn)};return Ae(z1,{style:{},children:Qt("div",{style:{backgroundColor:"var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7))",width:"100%",height:ii("ios")&&!ii("mobileweb")?100:50,display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Ae(rr,{style:{display:"flex",flexDirection:"column",justifyContent:"end",paddingBottom:10},children:Ae(Rn,{children:Ae("img",{src:"/JAMN.png",style:{width:30,height:30,borderRadius:20,backgroundColor:"var(--ion-tab-bar-background, var(--ion-color-step-50, #f7f7f7))"}})})}),Ae("div",{style:{display:"flex",flexDirection:"column",justifyContent:"end",paddingBottom:10},children:Qt(rr,{style:{display:"flex",flexDirection:"row"},children:[Qt(Rn,{onClick:a,style:{display:e!=null&&e.activeChannelId?"block":"none",borderRadius:5,minWidth:60,backgroundColor:"green",color:"var(--ion-color-dark)",marginRight:10},children:[Math.floor(i/60).toString().padStart(2,"0"),":",(i%60).toString().padStart(2,"0")]}),Ae(Rn,{onClick:g,style:{display:e!=null&&e.id?"block":"none",color:e!=null&&e.activeChannelId&&(e!=null&&e.isCamOn)?"green":"var(--ion-color-dark)",marginRight:5},children:e!=null&&e.isCamOn?Ae(yr,{icon:tQ}):Ae(yr,{icon:eQ})}),Ae(Rn,{onClick:_,style:{display:e!=null&&e.id?"block":"none",color:e!=null&&e.activeChannelId&&(e!=null&&e.isMicOn)?"green":"var(--ion-color-dark)",marginRight:3},children:e!=null&&e.isMicOn?Ae(yr,{icon:GJ}):Ae(yr,{icon:WJ})}),Ae(Rn,{onClick:w,style:{display:e!=null&&e.id?"block":"none",color:e!=null&&e.activeChannelId&&(e!=null&&e.isSoundOn)?"green":"var(--ion-color-dark)",marginRight:10},children:e!=null&&e.isSoundOn?Ae(yr,{icon:nQ}):Ae(yr,{icon:iQ})}),Ae(Rn,{id:"auth-modal-button",style:{display:e!=null&&e.id?"none":"block"},children:Ae(yr,{icon:HJ})}),Ae(Rn,{id:"account-modal-button",style:{display:e!=null&&e.id?"block":"none"},children:Ae(L1,{style:{width:30,height:30,cursor:"pointer"},children:Ae("img",{src:`https://www.gravatar.com/avatar/${lw((e==null?void 0:e.email)||"")}?d=retro`})})})]})})]})})};/*! Capacitor: https://capacitorjs.com/ - MIT License */const wde=t=>{const e=new Map;e.set("web",{name:"web"});const n=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},i=(a,d)=>{n.platforms.set(a,d)},r=a=>{n.platforms.has(a)&&(n.currentPlatform=n.platforms.get(a))};return n.addPlatform=i,n.setPlatform=r,n},Sde=t=>t.CapacitorPlatforms=wde(t),Pj=Sde(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});Pj.addPlatform;Pj.setPlatform;var dm;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(dm||(dm={}));class zk extends Error{constructor(e,n,i){super(e),this.message=e,this.code=n,this.data=i}}const Ede=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},kde=t=>{var e,n,i,r,a;const d=t.CapacitorCustomPlatform||null,o=t.Capacitor||{},f=o.Plugins=o.Plugins||{},g=t.CapacitorPlatforms,_=()=>d!==null?d.name:Ede(t),w=((e=g==null?void 0:g.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||_,T=()=>w()!=="web",A=((n=g==null?void 0:g.currentPlatform)===null||n===void 0?void 0:n.isNativePlatform)||T,D=Q=>{const J=K.get(Q);return!!(J!=null&&J.platforms.has(w())||V(Q))},z=((i=g==null?void 0:g.currentPlatform)===null||i===void 0?void 0:i.isPluginAvailable)||D,G=Q=>{var J;return(J=o.PluginHeaders)===null||J===void 0?void 0:J.find(te=>te.name===Q)},V=((r=g==null?void 0:g.currentPlatform)===null||r===void 0?void 0:r.getPluginHeader)||G,N=Q=>t.console.error(Q),q=(Q,J,te)=>Promise.reject(`${te} does not have an implementation of "${J}".`),K=new Map,se=(Q,J={})=>{const te=K.get(Q);if(te)return console.warn(`Capacitor plugin "${Q}" already registered. Cannot register plugins twice.`),te.proxy;const me=w(),Fe=V(Q);let tt;const At=async()=>(!tt&&me in J?tt=typeof J[me]=="function"?tt=await J[me]():tt=J[me]:d!==null&&!tt&&"web"in J&&(tt=typeof J.web=="function"?tt=await J.web():tt=J.web),tt),_t=(Be,ft)=>{var gt,Nt;if(Fe){const en=Fe==null?void 0:Fe.methods.find(Xt=>ft===Xt.name);if(en)return en.rtype==="promise"?Xt=>o.nativePromise(Q,ft.toString(),Xt):(Xt,wt)=>o.nativeCallback(Q,ft.toString(),Xt,wt);if(Be)return(gt=Be[ft])===null||gt===void 0?void 0:gt.bind(Be)}else{if(Be)return(Nt=Be[ft])===null||Nt===void 0?void 0:Nt.bind(Be);throw new zk(`"${Q}" plugin is not implemented on ${me}`,dm.Unimplemented)}},xt=Be=>{let ft;const gt=(...Nt)=>{const en=At().then(Xt=>{const wt=_t(Xt,Be);if(wt){const Zt=wt(...Nt);return ft=Zt==null?void 0:Zt.remove,Zt}else throw new zk(`"${Q}.${Be}()" is not implemented on ${me}`,dm.Unimplemented)});return Be==="addListener"&&(en.remove=async()=>ft()),en};return gt.toString=()=>`${Be.toString()}() { [capacitor code] }`,Object.defineProperty(gt,"name",{value:Be,writable:!1,configurable:!1}),gt},lt=xt("addListener"),zt=xt("removeListener"),ze=(Be,ft)=>{const gt=lt({eventName:Be},ft),Nt=async()=>{const Xt=await gt;zt({eventName:Be,callbackId:Xt},ft)},en=new Promise(Xt=>gt.then(()=>Xt({remove:Nt})));return en.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await Nt()},en},ot=new Proxy({},{get(Be,ft){switch(ft){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Fe?ze:lt;case"removeListener":return zt;default:return xt(ft)}}});return f[Q]=ot,K.set(Q,{name:Q,proxy:ot,platforms:new Set([...Object.keys(J),...Fe?[me]:[]])}),ot},ie=((a=g==null?void 0:g.currentPlatform)===null||a===void 0?void 0:a.registerPlugin)||se;return o.convertFileSrc||(o.convertFileSrc=Q=>Q),o.getPlatform=w,o.handleError=N,o.isNativePlatform=A,o.isPluginAvailable=z,o.pluginMethodNoop=q,o.registerPlugin=ie,o.Exception=zk,o.DEBUG=!!o.DEBUG,o.isLoggingEnabled=!!o.isLoggingEnabled,o.platform=o.getPlatform(),o.isNative=o.isNativePlatform(),o},Tde=t=>t.Capacitor=kde(t),Pv=Tde(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Tm=Pv.registerPlugin;Pv.Plugins;class Oj{constructor(e){this.listeners={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(n);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r);const a=async()=>this.removeListener(e,n),d=Promise.resolve({remove:a});return Object.defineProperty(d,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await a()}}),d}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n){const i=this.listeners[e];i&&i.forEach(r=>r(n))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:i=>{this.notifyListeners(n,i)}}}unimplemented(e="not implemented"){return new Pv.Exception(e,dm.Unimplemented)}unavailable(e="not available"){return new Pv.Exception(e,dm.Unavailable)}async removeListener(e,n){const i=this.listeners[e];if(!i)return;const r=i.indexOf(n);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}}const X3=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),K3=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Cde extends Oj{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[r,a]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=K3(r).trim(),a=K3(a).trim(),n[r]=a}),n}async setCookie(e){try{const n=X3(e.key),i=X3(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),d=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${i||""}${r}; path=${a}; ${d};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Tm("CapacitorCookies",{web:()=>new Cde});const Ide=async t=>new Promise((e,n)=>{const i=new FileReader;i.onload=()=>{const r=i.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},i.onerror=r=>n(r),i.readAsDataURL(t)}),Ade=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(r=>r.toLocaleLowerCase()).reduce((r,a,d)=>(r[a]=t[e[d]],r),{})},Mde=(t,e=!0)=>t?Object.entries(t).reduce((i,r)=>{const[a,d]=r;let o,f;return Array.isArray(d)?(f="",d.forEach(g=>{o=e?encodeURIComponent(g):g,f+=`${a}=${o}&`}),f.slice(0,-1)):(o=e?encodeURIComponent(d):d,f=`${a}=${o}`),`${i}&${f}`},"").substr(1):null,Pde=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),r=Ade(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(r.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[d,o]of Object.entries(t.data||{}))a.set(d,o);n.body=a.toString()}else if(r.includes("multipart/form-data")){const a=new FormData;if(t.data instanceof FormData)t.data.forEach((o,f)=>{a.append(f,o)});else for(const o of Object.keys(t.data))a.append(o,t.data[o]);n.body=a;const d=new Headers(n.headers);d.delete("content-type"),n.headers=d}else(r.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class Ode extends Oj{async request(e){const n=Pde(e,e.webFetchExtra),i=Mde(e.params,e.shouldEncodeUrlParams),r=i?`${e.url}?${i}`:e.url,a=await fetch(r,n),d=a.headers.get("content-type")||"";let{responseType:o="text"}=a.ok?e:{};d.includes("application/json")&&(o="json");let f,g;switch(o){case"arraybuffer":case"blob":g=await a.blob(),f=await Ide(g);break;case"json":f=await a.json();break;case"document":case"text":default:f=await a.text()}const _={};return a.headers.forEach((w,T)=>{_[T]=w}),{data:f,headers:_,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Tm("CapacitorHttp",{web:()=>new Ode});const js=Tm("Preferences",{web:()=>Zo(()=>import("./web-ab04336d.js"),[]).then(t=>new t.PreferencesWeb)}),XA="www.jamn.io",Vh="ACCESS_TOKEN",Xv="REFRESH_TOKEN",Dde=4*60*1e3,Rde="752107153785-ii093j9qoppa2kvcifo1doqmogg0b4m3.apps.googleusercontent.com",Lde="752107153785-5tggr0pc3t5ll8vddlppkk37k83ln5j5.apps.googleusercontent.com",zde="1483086142451421",Bde=ti`
  mutation Refresh($refreshToken: String!) {
    refresh(refreshToken: $refreshToken) {
      user {
        ...UserFields
      }
      accessToken
    }
  }
  ${Yu}
`;function ww(){const t=ji(),e=ei(q5),[n]=Ir(Bde,{onError:a=>{console.log(a),e&&clearInterval(e),t(JE(!0)),t(y_(null)),t(ch(null))},onCompleted:a=>{console.log(a),t(JE(!0)),t(wc([a.refresh.user])),t(ch(a.refresh.user.id)),js.set({key:Vh,value:a.refresh.accessToken})}}),i=async()=>{const{value:a}=await js.get({key:Xv});a?n({variables:{refreshToken:a}}):(t(JE(!0)),t(y_(null)),t(ch(null)))};return{refreshToken:i,refreshTokenInterval:()=>{const a=setInterval(i,Dde);t(y_(a))}}}const Fde=ti`
  mutation GoogleAuth($credential: String!) {
    googleAuth(credential: $credential) {
      user {
        ...UserFields
      }
      accessToken
      refreshToken
    }
  }
  ${Yu}
`,Nde=()=>{const t=ji(),{authModal:e}=et.useContext(zl),{refreshTokenInterval:n}=ww(),[i]=Ir(Fde,{onError:a=>{console.error(a)},onCompleted:async a=>{var d;console.log(a),a.googleAuth.user.id&&((d=e.current)==null||d.dismiss(),t(wc([a.googleAuth.user])),t(ch(a.googleAuth.user.id)),await js.set({key:Vh,value:a.googleAuth.accessToken}),await js.set({key:Xv,value:a.googleAuth.refreshToken}),n())}});return async a=>{a&&await i({variables:{credential:a}})}};var Dj={exports:{}};(function(t,e){(function(n,i){t.exports=i(et)})(uB,function(n){return function(i){function r(d){if(a[d])return a[d].exports;var o=a[d]={exports:{},id:d,loaded:!1};return i[d].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var a={};return r.m=i,r.c=a,r.p="",r(0)}([function(i,r,a){i.exports=a(8)},function(i,r,a){i.exports=a(6)()},function(i,r){i.exports=n},function(i,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(a,d){return decodeURIComponent(a.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(d).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}},function(i,r,a){function d(ie){return ie&&ie.__esModule?ie:{default:ie}}function o(ie,Q){if(!(ie instanceof Q))throw new TypeError("Cannot call a class as a function")}function f(ie,Q){if(!ie)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!Q||typeof Q!="object"&&typeof Q!="function"?ie:Q}function g(ie,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Q);ie.prototype=Object.create(Q&&Q.prototype,{constructor:{value:ie,enumerable:!1,writable:!0,configurable:!0}}),Q&&(Object.setPrototypeOf?Object.setPrototypeOf(ie,Q):ie.__proto__=Q)}Object.defineProperty(r,"__esModule",{value:!0});var _=Object.assign||function(ie){for(var Q=1;Q<arguments.length;Q++){var J=arguments[Q];for(var te in J)Object.prototype.hasOwnProperty.call(J,te)&&(ie[te]=J[te])}return ie},w=function(){function ie(Q,J){for(var te=0;te<J.length;te++){var me=J[te];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(Q,me.key,me)}}return function(Q,J,te){return J&&ie(Q.prototype,J),te&&ie(Q,te),Q}}(),T=a(2),A=d(T),D=a(1),z=d(D),G=a(5),V=d(G),N=a(3),q=d(N),K=function(){var ie=!1;try{ie=!!(window.navigator&&window.navigator.standalone||navigator.userAgent.match("CriOS")||navigator.userAgent.match(/mobile/i))}catch(Q){}return ie},se=function(ie){function Q(){var J,te,me,Fe;o(this,Q);for(var tt=arguments.length,At=Array(tt),_t=0;_t<tt;_t++)At[_t]=arguments[_t];return te=me=f(this,(J=Q.__proto__||Object.getPrototypeOf(Q)).call.apply(J,[this].concat(At))),me.state={isSdkLoaded:!1,isProcessing:!1},me.responseApi=function(xt){window.FB.api("/me",{locale:me.props.language,fields:me.props.fields},function(lt){_(lt,xt),me.props.callback(lt)})},me.checkLoginState=function(xt){me.setStateIfMounted({isProcessing:!1}),xt.authResponse?me.responseApi(xt.authResponse):me.props.onFailure?me.props.onFailure({status:xt.status}):me.props.callback({status:xt.status})},me.checkLoginAfterRefresh=function(xt){xt.status==="connected"?me.checkLoginState(xt):window.FB.login(function(lt){return me.checkLoginState(lt)},!0)},me.click=function(xt){if(me.state.isSdkLoaded&&!me.state.isProcessing&&!me.props.isDisabled){me.setState({isProcessing:!0});var lt=me.props,zt=lt.scope,ze=lt.appId,ot=lt.onClick,Be=lt.returnScopes,ft=lt.responseType,gt=lt.redirectUri,Nt=lt.disableMobileRedirect,en=lt.authType,Xt=lt.state;if(typeof ot!="function"||(ot(xt),!xt.defaultPrevented)){var wt={client_id:ze,redirect_uri:gt,state:Xt,return_scopes:Be,scope:zt,response_type:ft,auth_type:en};if(me.props.isMobile&&!Nt)window.location.href="https://www.facebook.com/dialog/oauth"+(0,V.default)(wt);else{if(!window.FB)return void(me.props.onFailure&&me.props.onFailure({status:"facebookNotLoaded"}));window.FB.login(me.checkLoginState,{scope:zt,return_scopes:Be,auth_type:wt.auth_type})}}}},Fe=te,f(me,Fe)}return g(Q,ie),w(Q,[{key:"componentDidMount",value:function(){if(this._isMounted=!0,document.getElementById("facebook-jssdk"))return void this.sdkLoaded();this.setFbAsyncInit(),this.loadSdkAsynchronously();var J=document.getElementById("fb-root");J||(J=document.createElement("div"),J.id="fb-root",document.body.appendChild(J))}},{key:"componentWillReceiveProps",value:function(J){this.state.isSdkLoaded&&J.autoLoad&&!this.props.autoLoad&&window.FB.getLoginStatus(this.checkLoginAfterRefresh)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"setStateIfMounted",value:function(J){this._isMounted&&this.setState(J)}},{key:"setFbAsyncInit",value:function(){var J=this,te=this.props,me=te.appId,Fe=te.xfbml,tt=te.cookie,At=te.version,_t=te.autoLoad;window.fbAsyncInit=function(){window.FB.init({version:"v"+At,appId:me,xfbml:Fe,cookie:tt}),J.setStateIfMounted({isSdkLoaded:!0}),(_t||J.isRedirectedFromFb())&&window.FB.getLoginStatus(J.checkLoginAfterRefresh)}}},{key:"isRedirectedFromFb",value:function(){var J=window.location.search;return(0,q.default)(J,"code")||(0,q.default)(J,"granted_scopes")}},{key:"sdkLoaded",value:function(){this.setState({isSdkLoaded:!0})}},{key:"loadSdkAsynchronously",value:function(){var J=this.props.language;(function(te,me,Fe){var tt=te.getElementsByTagName(me)[0],At=tt,_t=tt;te.getElementById(Fe)||(_t=te.createElement(me),_t.id=Fe,_t.src="https://connect.facebook.net/"+J+"/sdk.js",At.parentNode.insertBefore(_t,At))})(document,"script","facebook-jssdk")}},{key:"render",value:function(){var te=this.props.render;if(!te)throw new Error("ReactFacebookLogin requires a render prop to render");var me={onClick:this.click,isDisabled:!!this.props.isDisabled,isProcessing:this.state.isProcessing,isSdkLoaded:this.state.isSdkLoaded};return this.props.render(me)}}]),Q}(A.default.Component);se.propTypes={isDisabled:z.default.bool,callback:z.default.func.isRequired,appId:z.default.string.isRequired,xfbml:z.default.bool,cookie:z.default.bool,authType:z.default.string,scope:z.default.string,state:z.default.string,responseType:z.default.string,returnScopes:z.default.bool,redirectUri:z.default.string,autoLoad:z.default.bool,disableMobileRedirect:z.default.bool,isMobile:z.default.bool,fields:z.default.string,version:z.default.string,language:z.default.string,onClick:z.default.func,onFailure:z.default.func,render:z.default.func.isRequired},se.defaultProps={redirectUri:typeof window<"u"?window.location.href:"/",scope:"public_profile,email",returnScopes:!1,xfbml:!1,cookie:!1,authType:"",fields:"name",version:"2.3",language:"en_US",disableMobileRedirect:!1,isMobile:K(),onFailure:null,state:"facebookdirect",responseType:"code"},r.default=se},function(i,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(a){return"?"+Object.keys(a).map(function(d){return d+"="+encodeURIComponent(a[d])}).join("&")}},function(i,r,a){function d(){}var o=a(7);i.exports=function(){function f(w,T,A,D,z,G){if(G!==o){var V=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw V.name="Invariant Violation",V}}function g(){return f}f.isRequired=f;var _={array:f,bool:f,func:f,number:f,object:f,string:f,symbol:f,any:f,arrayOf:g,element:f,instanceOf:g,node:f,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g};return _.checkPropTypes=d,_.PropTypes=_,_}},function(i,r){var a="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";i.exports=a},function(i,r,a){function d(ie){return ie&&ie.__esModule?ie:{default:ie}}function o(ie,Q){if(!(ie instanceof Q))throw new TypeError("Cannot call a class as a function")}function f(ie,Q){if(!ie)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!Q||typeof Q!="object"&&typeof Q!="function"?ie:Q}function g(ie,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Q);ie.prototype=Object.create(Q&&Q.prototype,{constructor:{value:ie,enumerable:!1,writable:!0,configurable:!0}}),Q&&(Object.setPrototypeOf?Object.setPrototypeOf(ie,Q):ie.__proto__=Q)}Object.defineProperty(r,"__esModule",{value:!0});var _=Object.assign||function(ie){for(var Q=1;Q<arguments.length;Q++){var J=arguments[Q];for(var te in J)Object.prototype.hasOwnProperty.call(J,te)&&(ie[te]=J[te])}return ie},w=function(){function ie(Q,J){for(var te=0;te<J.length;te++){var me=J[te];me.enumerable=me.enumerable||!1,me.configurable=!0,"value"in me&&(me.writable=!0),Object.defineProperty(Q,me.key,me)}}return function(Q,J,te){return J&&ie(Q.prototype,J),te&&ie(Q,te),Q}}(),T=a(2),A=d(T),D=a(1),z=d(D),G=a(9),V=d(G),N=a(4),q=d(N),K=function(ie){return["button","input","select","textarea","optgroup","option","fieldset"].indexOf((ie+"").toLowerCase())>=0},se=function(ie){function Q(){return o(this,Q),f(this,(Q.__proto__||Object.getPrototypeOf(Q)).apply(this,arguments))}return g(Q,ie),w(Q,[{key:"style",value:function(){var J=this.constructor.defaultProps.cssClass;return this.props.cssClass===J&&A.default.createElement("style",{dangerouslySetInnerHTML:{__html:V.default}})}},{key:"containerStyle",value:function(J){var te=J.isProcessing,me=J.isSdkLoaded,Fe=J.isDisabled,tt={transition:"opacity 0.5s"};return(te||!me||Fe)&&(tt.opacity=.6),_(tt,this.props.containerStyle)}},{key:"renderOwnButton",value:function(J){var te=this.props,me=te.cssClass,Fe=te.size,tt=te.icon,At=te.textButton,_t=te.typeButton,xt=te.buttonStyle,lt=J.onClick,zt=J.isDisabled,ze=typeof tt=="string",ot={};return zt&&K(this.props.tag)&&(ot.disabled=!0),A.default.createElement("span",{style:this.containerStyle(J)},ze&&A.default.createElement("link",{rel:"stylesheet",href:"https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"}),A.default.createElement(this.props.tag,_({type:_t,className:me+" "+Fe,style:xt,onClick:lt},ot),tt&&ze&&A.default.createElement("i",{className:"fa "+tt}),tt&&!ze&&tt,At),this.style())}},{key:"render",value:function(){var J=this;return A.default.createElement(q.default,_({},this.props,{render:function(te){return J.renderOwnButton(te)}}))}}]),Q}(A.default.Component);se.propTypes={textButton:z.default.string,typeButton:z.default.string,size:z.default.string,cssClass:z.default.string,icon:z.default.any,containerStyle:z.default.object,buttonStyle:z.default.object,tag:z.default.oneOfType([z.default.node,z.default.func])},se.defaultProps={textButton:"Login with Facebook",typeButton:"button",size:"metro",fields:"name",cssClass:"kep-login-facebook",tag:"button"},r.default=se},function(i,r,a){r=i.exports=a(10)(),r.push([i.id,".kep-login-facebook{font-family:Helvetica,sans-serif;font-weight:700;-webkit-font-smoothing:antialiased;color:#fff;cursor:pointer;display:inline-block;font-size:calc(.27548vw + 12.71074px);text-decoration:none;text-transform:uppercase;transition:background-color .3s,border-color .3s;background-color:#4c69ba;border:calc(.06887vw + .67769px) solid #4c69ba;padding:calc(.34435vw + 13.38843px) calc(.34435vw + 18.38843px)}.kep-login-facebook.small{padding:calc(.34435vw + 3.38843px) calc(.34435vw + 8.38843px)}.kep-login-facebook.medium{padding:calc(.34435vw + 8.38843px) calc(.34435vw + 13.38843px)}.kep-login-facebook.metro{border-radius:0}.kep-login-facebook .fa{margin-right:calc(.34435vw + 3.38843px)}",""]),r.locals={"kep-login-facebook":"kep-login-facebook",small:"small",medium:"medium",metro:"metro",fa:"fa"}},function(i,r){i.exports=function(){var a=[];return a.toString=function(){for(var d=[],o=0;o<this.length;o++){var f=this[o];f[2]?d.push("@media "+f[2]+"{"+f[1]+"}"):d.push(f[1])}return d.join("")},a.i=function(d,o){typeof d=="string"&&(d=[[null,d,""]]);for(var f={},g=0;g<this.length;g++){var _=this[g][0];typeof _=="number"&&(f[_]=!0)}for(g=0;g<d.length;g++){var w=d[g];typeof w[0]=="number"&&f[w[0]]||(o&&!w[2]?w[2]=o:o&&(w[2]="("+w[2]+") and ("+o+")"),a.push(w))}},a}}])})})(Dj);var $de=Dj.exports;const jde=_c($de),Vde=ti`
  mutation FacebookAuth($credential: String!) {
    facebookAuth(credential: $credential) {
      user {
        ...UserFields
      }
      accessToken
      refreshToken
    }
  }
  ${Yu}
`,Ude=()=>{const t=ji(),{authModal:e}=et.useContext(zl),{refreshTokenInterval:n}=ww(),[i]=Ir(Vde,{onError:a=>{console.error(a)},onCompleted:async a=>{var d;console.log(a),a.facebookAuth.user.id&&((d=e.current)==null||d.dismiss(),t(wc([a.facebookAuth.user])),t(ch(a.facebookAuth.user.id)),await js.set({key:Vh,value:a.facebookAuth.accessToken}),await js.set({key:Xv,value:a.facebookAuth.refreshToken}),n())}});return async a=>{a&&await i({variables:{credential:a}})}},qde=ti`
  mutation emailLogin($email: String!) {
    emailLogin(email: $email) {
      ...UserFields
    }
  }
  ${Yu}
`,Wde=t=>{const[e]=Ir(qde,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t(i.emailLogin)}});return i=>{e({variables:{email:i}})}},Y3=Tm("GoogleAuth",{web:()=>Zo(()=>import("./web-0c2db409.js"),[]).then(t=>new t.GoogleAuthWeb)}),Gde=({setPendingUser:t})=>{const[e,n]=et.useState(""),[i,r]=et.useState(!1),[a,d]=et.useState(!1),{authModal:o}=et.useContext(zl);et.useEffect(()=>{const z=ii("ios")&&!ii("mobileweb")?Lde:Rde;Y3.initialize({clientId:z,scopes:["email"]})},[]);const f=Nde(),g=Ude(),w=Wde(z=>{d(!1),z!=null&&z.id&&(n(""),t(z))});return Qt(da,{children:[Qt("div",{style:{padding:30,paddingTop:0},children:[Ae("div",{style:{textAlign:"center"},children:"Choose your preferred login method:"}),Ae("div",{style:{marginBottom:30,paddingTop:30,display:"flex",flexDirection:"column",justifyContent:"center"},children:Qt("div",{style:{paddingLeft:10,border:"1px solid",borderRadius:5,margin:"auto",width:250,display:"flex"},children:[Ae(wl,{type:"email",placeholder:"email@domain.com",clearInput:!0,onIonInput:z=>{const G=z.target.value;n(G),/\S+@\S+\.\S+/.test(G)?r(!0):r(!1)},value:e}),Ae(rr,{children:Ae(Rn,{disabled:!i||a,onClick:()=>{d(!0);const z=e.trim();w(z)},children:Ae(yr,{icon:XJ,size:"small"})})})]})}),Ae("div",{style:{display:"flex",justifyContent:"center"},children:Ae(rr,{children:Ae(Rn,{onClick:()=>{Y3.signIn().then(z=>{console.log(z),f(z.authentication.idToken)}).catch(z=>{console.log(z)})},children:"GOOGLE"})})}),Ae("div",{style:{display:"flex",justifyContent:"center",padding:30},children:Ae(jde,{appId:zde,autoLoad:!1,fields:"name,email,picture",scope:"public_profile, email",textButton:"Continue with Facebook",disableMobileRedirect:!0,onClick:()=>{},callback:z=>{console.log(z),g(z.accessToken)},buttonStyle:{width:250}})})]}),Ae(rr,{style:{margin:20},children:Ae(Rn,{onClick:()=>{var z;(z=o.current)==null||z.dismiss()},style:{border:"1px solid",borderRadius:5,fontSize:20,fontWeight:"bold",height:40},children:Ae("span",{style:{padding:10},children:"BACK"})})})]})},Hde=ti`
  mutation Verify($id: Int!, $code: String!) {
    verify(id: $id, code: $code) {
      user {
        ...UserFields
      }
      accessToken
      refreshToken
    }
  }
  ${Yu}
`,Zde=(t,e)=>{const n=ji(),{authModal:i}=et.useContext(zl),{refreshTokenInterval:r}=ww(),[a]=Ir(Hde,{onError:o=>{console.log(o),t(o)},onCompleted:async o=>{var f;console.log(o),o.verify.user.id&&((f=i.current)==null||f.dismiss(),n(wc([o.verify.user])),n(ch(o.verify.user.id)),await js.set({key:Vh,value:o.verify.accessToken}),await js.set({key:Xv,value:o.verify.refreshToken}),r()),e(o.verify.user)}});return(o,f)=>{a({variables:{id:o,code:f}})}},Xde=ti`
  mutation Resend($phone: String, $email: String) {
    resend(phone: $phone, email: $email) {
      ...UserFields
    }
  }
  ${Yu}
`,Kde=({pendingUser:t,setPendingUser:e})=>{const[n,i]=et.useState(""),[r,a]=et.useState(!1),d=Zde(D=>{D.message==="Invalid verification code"&&a(!0)},D=>{D!=null&&D.id&&e(null)}),[o,f]=et.useState(!1),[g]=Ir(Xde,{onError:D=>{console.log(D)},onCompleted:D=>{console.log(D),D.resend.id&&(f(!0),setTimeout(()=>{f(!1)},3e3))}}),_=D=>{const z=D.target.value;i(z),a(!1)},w=()=>{const D=n.replace(/[^0-9]/g,"").trim();d(t.id,D)},T=()=>{g({variables:{phone:t.phone,email:t.email}})},A=()=>{e(null)};return Ae(da,{children:Qt("div",{children:[Qt("div",{style:{margin:30},children:["A ",Ae("b",{children:"verification code"})," has been ",t.email?"emailed":"texted"," to"]}),Qt("div",{style:{margin:30,fontWeight:"bold",fontSize:24},children:[t.email?t.email:null,t.phone?Qt("div",{children:["+1 ",t.phone.slice(0,3)," ",t.phone.slice(3,6)," ",t.phone.slice(6-10)]}):null]}),Ae("div",{style:{margin:30},children:"Enter this code to login."}),Ae("div",{style:{margin:30,paddingLeft:10,paddingRight:10,border:"1px solid",borderRadius:5,marginTop:30,width:160},children:Ae(wl,{type:"number",placeholder:"123456",onIonInput:_,value:n,style:{fontSize:24}})}),Qt(rr,{style:{margin:30,display:"flex",flexDirection:"column",alignItems:"start"},children:[Ae(Rn,{disabled:n.length!==6,onClick:w,style:{border:"1px solid",borderRadius:5,fontSize:24,fontWeight:"bold",height:50,marginBottom:10},children:r?"INVALID CODE...":"LOGIN"}),Ae(Rn,{disabled:o,onClick:T,style:{border:"1px solid",borderRadius:5,fontSize:24,fontWeight:"bold",height:50,marginBottom:10},children:o?"CODE SENT...":"RESEND CODE"}),Ae(Rn,{onClick:A,style:{border:"1px solid",borderRadius:5,fontSize:24,fontWeight:"bold",height:50},children:"BACK"})]})]})})},Yde=()=>{const{authModal:t}=et.useContext(zl),e=ei(Ws),n=ei(Yee),{refreshToken:i,refreshTokenInterval:r}=ww(),[a,d]=et.useState(null);return et.useEffect(()=>{n?e&&r():(console.log("initializing"),i())},[n]),Qt(d5,{trigger:"auth-modal-button",ref:t,children:[Ae("div",{style:{fontWeight:"bold",fontSize:40,padding:20,paddingTop:ii("ios")&&!ii("mobileweb")?70:20,color:"inherit"},children:"LOG IN"}),a?Ae(Kde,{pendingUser:a,setPendingUser:d}):Ae(Gde,{setPendingUser:d})]})},Jde=ti`
  mutation Logout {
    logout
  }
`,Qde=()=>{const[t]=Ir(Jde,{onError:n=>{console.log(n)},onCompleted:n=>{console.log(n)}});return()=>{t()}},ehe=ti`
  mutation ChangeName($name: String!) {
    changeName(name: $name) {
      ...UserFields
    }
  }
  ${Yu}
`,the=()=>{const t=ji(),[e]=Ir(ehe,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t(wc([i.changeName]))}});return i=>{e({variables:{name:i}})}},nhe=()=>{var G;const t=ji(),e=ei(Ws),n=ei(q5),[i,r]=et.useState(!1),[a,d]=et.useState(!1),[o,f]=et.useState((e==null?void 0:e.name)||""),g=the(),_=Qde(),w=async()=>{var V;(V=z.current)==null||V.dismiss(),_(),n&&(clearInterval(n),t(y_(null))),await js.remove({key:Vh}),await js.remove({key:Xv}),t(ch(null))},T=()=>{var V;(V=z.current)==null||V.dismiss()},A=()=>{e&&(f(e.name),r(!0))},D=()=>{console.log("handleProfileSave",o),g(o),r(!1)},z=et.useRef(null);return Qt(d5,{ref:z,trigger:"account-modal-button",children:[Ae(z1,{style:{margin:20,fontWeight:"bold",fontSize:40,marginTop:ii("ios")&&!ii("mobileweb")?70:20},children:"MY ACCOUNT"}),Qt(da,{children:[Qt("div",{style:{margin:20,fontSize:24,fontWeight:"bold",display:"flex",flexDirection:"row",justifyContent:"start"},children:["PROFILE ",Qt(rr,{style:{},children:[Ae(Rn,{onClick:A,style:{border:"1px solid",borderRadius:5,display:i?"none":"block"},children:"EDIT"}),Ae(Rn,{onClick:D,style:{border:"1px solid",borderRadius:5,display:i?"block":"none"},children:"SAVE"}),Ae(Rn,{onClick:()=>r(!1),style:{border:"1px solid",borderRadius:5,display:i?"block":"none"},children:"CANCEL"})]})]}),Qt("div",{style:{marginLeft:30,display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Qt("div",{style:{display:"flex",flexDirection:"row"},children:[Ae("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:Ae(L1,{children:Ae("img",{style:{width:48,height:48,borderRadius:24},src:`https://www.gravatar.com/avatar/${lw((G=e==null?void 0:e.email)!=null?G:"")}?d=retro`})})}),Ae("div",{style:{marginLeft:20,display:i?"none":"flex",flexDirection:"column",justifyContent:"center",fontSize:22},children:e==null?void 0:e.name}),Ae("div",{style:{display:i?"flex":"none",marginLeft:10,border:"1px solid",borderRadius:5,paddingLeft:10},children:Ae(wl,{value:o,clearInput:!0,style:{display:i?"flex":"none",fontSize:22},onIonInput:V=>f(V.detail.value||"")})})]}),Ae("div",{})]}),Qt("div",{style:{margin:20,marginTop:60,fontSize:24,fontWeight:"bold",display:"flex",flexDirection:"row",justifyContent:"start"},children:["CREDENTIALS ",Ae(rr,{style:{},children:Ae(Rn,{onClick:()=>d(!0),style:{border:"1px solid",borderRadius:5,display:a?"none":"block"},children:"EDIT"})})]}),Qt("div",{style:{display:"flex"},children:[Ae("div",{style:{marginLeft:30,width:80,fontWeight:"bold"},children:"EMAIL"}),Ae("div",{children:e==null?void 0:e.email})]}),Qt("div",{style:{marginTop:20,display:"flex"},children:[Ae("div",{style:{marginLeft:30,width:80,fontWeight:"bold"},children:"PHONE"}),Ae("div",{children:e==null?void 0:e.phone})]}),Qt(rr,{style:{display:"flex",flexDirection:"column",alignItems:"start",margin:20,marginTop:60},children:[Ae(Rn,{onClick:w,style:{fontWeight:"bold",fontSize:24,border:"1px solid",borderRadius:5,height:50},children:"LOGOUT"}),Ae(Rn,{onClick:T,style:{fontWeight:"bold",fontSize:24,border:"1px solid",borderRadius:5,height:50,marginTop:10},children:"BACK"})]})]})]})};var e1;(function(t){t.Documents="DOCUMENTS",t.Data="DATA",t.Library="LIBRARY",t.Cache="CACHE",t.External="EXTERNAL",t.ExternalStorage="EXTERNAL_STORAGE"})(e1||(e1={}));var J3;(function(t){t.UTF8="utf8",t.ASCII="ascii",t.UTF16="utf16"})(J3||(J3={}));const n2=Tm("Filesystem",{web:()=>Zo(()=>import("./web-84f6d481.js"),[]).then(t=>new t.FilesystemWeb)});var i2;(function(t){t.Prompt="PROMPT",t.Camera="CAMERA",t.Photos="PHOTOS"})(i2||(i2={}));var Q3;(function(t){t.Rear="REAR",t.Front="FRONT"})(Q3||(Q3={}));var r2;(function(t){t.Uri="uri",t.Base64="base64",t.DataUrl="dataUrl"})(r2||(r2={}));const ihe=Tm("Camera",{web:()=>Zo(()=>import("./web-f183846c.js"),[]).then(t=>new t.CameraWeb)}),rhe="photos";function ohe(){const t=async(r,a)=>{let d;ii("hybrid")?d=(await n2.readFile({path:r.path})).data:d=await she(r.webPath);const o=await n2.writeFile({path:a,data:d,directory:e1.Data});return ii("hybrid")?{filepath:o.uri,webviewPath:Pv.convertFileSrc(o.uri)}:{filepath:a,webviewPath:r.webPath}},[e,n]=et.useState();return{photo:e,takePhoto:async()=>{const r=await ihe.getPhoto({resultType:r2.Uri,source:i2.Camera,quality:100}),a=new Date().getTime()+".jpeg",d=await t(r,a);n(d),js.set({key:rhe,value:JSON.stringify(d)})}}}async function she(t){const n=await(await fetch(t)).blob();return new Promise((i,r)=>{const a=new FileReader;a.onerror=r,a.onload=()=>{typeof a.result=="string"?i(a.result):r("method did not return a string")},a.readAsDataURL(n)})}const ahe=()=>{const t=bm(),[e,n]=et.useState(""),[i,r]=et.useState(""),[a,d]=et.useState(0),[o,f]=et.useState(0),{photo:g,takePhoto:_}=ohe(),w=async()=>{if(!g)return;const T=await n2.readFile({path:g.filepath,directory:e1.Data}),A=GA(T.data),D=new Blob([A],{type:"image/jpeg"}),z=new FormData;z.append("file",D),z.append("name",e),z.append("detail",i),z.append("quantity",a.toString()),z.append("price",o.toString());const G=await js.get({key:Vh});fetch(XA+"/deals/add-deal",{method:"POST",body:z,headers:{accesstoken:G.value||""}}).then(N=>{console.log(N),t.push("/deal")}).catch(N=>{console.error(N)})};return Ae(hc,{children:Ae(da,{fullscreen:!0,children:Qt("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:[Ae(z1,{style:{margin:20,alignItems:"center"},children:Ae("h1",{children:"CREATE A DEAL"})}),Qt("div",{style:{margin:20,marginTop:0,maxWidth:420},children:[Qt(qf,{style:{display:"flex",justifyContent:"space-between"},children:[Ae(hu,{children:"Photo: "}),Ae(rr,{children:Ae(Rn,{onClick:()=>_(),children:Ae(yr,{icon:UJ})})})]}),Ae(qf,{style:{display:g?"flex":"none"},children:g&&Ae("img",{src:g.webviewPath,style:{borderRadius:5}})}),Qt(qf,{style:{display:"flex"},children:[Ae(hu,{children:"Name: "}),Ae(wl,{type:"text",value:e,onIonChange:T=>n(T.target.value)})]}),Qt(qf,{style:{display:"flex"},children:[Ae(hu,{children:"Detail: "}),Ae(wl,{type:"text",value:i,onIonChange:T=>r(T.target.value)})]}),Qt(qf,{style:{display:"flex"},children:[Ae(hu,{children:"Quantity: "}),Ae(wl,{type:"number",value:a,onIonChange:T=>d(T.target.value)})]}),Qt(qf,{style:{display:"flex"},children:[Ae(hu,{children:"Price: "}),Ae(wl,{type:"number",placeholder:"Price",value:o,onIonChange:T=>f(T.target.value)})]}),Qt(rr,{style:{marginTop:20,display:"flex",flexDirection:"column",alignItems:"start"},children:[Ae(Rn,{onClick:w,style:{border:"1px solid",borderRadius:5,height:50,fontWeight:"bold",fontSize:24},children:"SUBMIT"}),Ae(Rn,{routerLink:"/deal",style:{marginTop:10,border:"1px solid",borderRadius:5,height:50,fontWeight:"bold",fontSize:24},children:"BACK"})]})]})]})})})},lhe=ti`
  mutation GetChannel($id: Int!) {
    getChannel(id: $id) {
      ...ChannelFields
    }
  }
  ${Ku}
`,che=({match:t})=>{var N,q,K;const e=bm(),n=ji(),{authModal:i,streams:r,channelMode:a,setChannelMode:d}=et.useContext(zl),o=ei(Ws),f=ei(Zu),g=ei(se=>{var ie,Q;return A5(se,(ie=f==null?void 0:f.id)!=null?ie:-1,(Q=o==null?void 0:o.id)!=null?Q:-1)}),[_,w]=et.useState(!1),T=WA(),A=()=>{g!=null&&g.id&&((g==null?void 0:g.savedIndex)===null?T(g.id,0):T(g.id,null))},D=()=>{e.push("/map/"+(f==null?void 0:f.id),"none")},z=()=>{e.push("/map","none")},[G]=Ir(lhe,{onError:se=>{console.log(se)},onCompleted:({getChannel:se})=>{console.log(se),n(Hu([se])),w(!0)}});et.useEffect(()=>{console.log(t.params.id),(f==null?void 0:f.id)===parseInt(t.params.id)?w(!0):(G({variables:{id:parseInt(t.params.id)}}),n(g_(parseInt(t.params.id))))},[t.params.id]);const V=et.useRef(null);return et.useEffect(()=>{var se;console.log((se=V.current)==null?void 0:se.clientHeight)},[(N=V.current)==null?void 0:N.clientHeight]),_?f!=null&&f.id?Qt(hc,{children:[Ae("div",{style:{height:ii("ios")&&!ii("mobileweb")?105:55}}),Qt(da,{style:{overflowY:"hidden"},children:[Qt("div",{ref:V,children:[Qt("div",{style:{fontSize:24,padding:10,fontWeight:"bold",display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Ae("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:f==null?void 0:f.name}),Qt(rr,{style:{},children:[Ae(Rn,{onClick:A,children:Ae(yr,{icon:(g==null?void 0:g.savedIndex)===null?m5:VI,size:"small",style:{color:(g==null?void 0:g.savedIndex)===null?null:"var(--ion-color-primary)"}})}),Ae(Rn,{onClick:D,children:Ae(yr,{icon:ZJ,size:"small"})}),Ae(Rn,{onClick:z,children:Ae(yr,{icon:jI,size:"small"})})]})]}),Ae("div",{style:{padding:10,textAlign:"left",fontSize:14,color:"var(--ion-color-medium)"},children:f==null?void 0:f.detail}),Qt(rr,{style:{marginTop:5,display:"flex",flexDirection:"row",justifyContent:"center"},children:[Ae(Rn,{onClick:()=>d("talk"),style:{color:a==="talk"?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:a==="talk"?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TALK"}),Ae(Rn,{onClick:()=>d("text"),style:{color:a==="text"?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:a==="text"?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"TEXT"}),Ae(Rn,{onClick:()=>d("roam"),style:{color:a==="roam"?"var(--ion-color-dark)":"var(--ion-color-medium)",borderBottom:a==="roam"?"4px solid var(--ion-color-primary)":"none",fontWeight:"bold"},children:"ROAM"})]})]}),Ae("div",{style:{paddingTop:10,height:`calc(100% - ${(K=(q=V.current)==null?void 0:q.clientHeight)!=null?K:0}px)`},children:a==="talk"?Ae(J$,{authModal:i,streams:r}):a==="text"?Ae(Sj,{}):a==="roam"?Ae(Ej,{}):null})]})]}):Ae(hc,{children:Ae(da,{fullscreen:!0,children:Ae("div",{style:{display:"flex",flexDirection:"column",marginLeft:5,marginTop:ii("ios")&&!ii("mobileweb")?105:55},children:Ae("div",{style:{display:"inline-flex",fontSize:32,fontWeight:"bold",flexDirection:"column",justifyContent:"center"},children:"NOT FOUND..."})})})}):Ae(hc,{children:Ae(da,{fullscreen:!0,children:Ae("div",{style:{display:"flex",flexDirection:"column",marginLeft:5,marginTop:ii("ios")&&!ii("mobileweb")?105:55},children:Ae("div",{style:{display:"flex",fontSize:32,fontWeight:"bold",flexDirection:"column",justifyContent:"center"},children:"LOADING..."})})})})};W.sessions=new Map;W.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){let t=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),e=33;return window.navigator.userAgent.match("Linux")&&(e=35),t>=26&&t<=e?!0:W.extension.isInstalled()}else return!0};var Rj={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return document.querySelector("#janus-extension-installed")!==null},getScreen:function(t){let e=window.setTimeout(function(){let n=new Error("NavigatorUserMediaError");return n.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',t(n)},1e3);this.cache[e]=t,window.postMessage({type:"janusGetScreen",id:e},"*")},init:function(){let t={};this.cache=t,window.addEventListener("message",function(e){if(e.origin==window.location.origin)if(e.data.type=="janusGotScreen"&&t[e.data.id]){let n=t[e.data.id];if(delete t[e.data.id],e.data.sourceId===""){let i=new Error("NavigatorUserMediaError");i.name="You cancelled the request for permission, giving up...",n(i)}else n(null,e.data.sourceId)}else e.data.type=="janusGetScreenPending"&&window.clearTimeout(e.data.id)})}};W.useDefaultDependencies=function(t){let e=t&&t.fetch||fetch,n=t&&t.Promise||Promise,i=t&&t.WebSocket||WebSocket;return{newWebSocket:function(r,a){return new i(r,a)},extension:t&&t.extension||Rj,isArray:function(r){return Array.isArray(r)},webRTCAdapter:t&&t.adapter||adapter,httpAPICall:function(r,a){let d={method:a.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};a.verb==="POST"&&(d.headers["Content-Type"]="application/json"),typeof a.withCredentials<"u"&&(d.credentials=a.withCredentials===!0?"include":a.withCredentials?a.withCredentials:"omit"),a.body&&(d.body=JSON.stringify(a.body));let o=e(r,d).catch(function(f){return n.reject({message:"Probably a network error, is the server down?",error:f})});if(a.timeout){let f=new n(function(g,_){let w=setTimeout(function(){return clearTimeout(w),_({message:"Request timed out",timeout:a.timeout})},a.timeout)});o=n.race([o,f])}return o.then(function(f){if(f.ok){if(typeof a.success==typeof W.noop)return f.json().then(function(g){try{a.success(g)}catch(_){W.error("Unhandled httpAPICall success callback error",_)}},function(g){return n.reject({message:"Failed to parse response body",error:g,response:f})})}else return n.reject({message:"API call failed",response:f})}).catch(function(f){typeof a.error==typeof W.noop&&a.error(f.message||"<< internal error >>",f)}),o}}};W.useOldDependencies=function(t){let e=t&&t.jQuery||jQuery,n=t&&t.WebSocket||WebSocket;return{newWebSocket:function(i,r){return new n(i,r)},isArray:function(i){return e.isArray(i)},extension:t&&t.extension||Rj,webRTCAdapter:t&&t.adapter||adapter,httpAPICall:function(i,r){let a=typeof r.body<"u"?{contentType:"application/json",data:JSON.stringify(r.body)}:{},d=typeof r.withCredentials<"u"?{xhrFields:{withCredentials:r.withCredentials}}:{};return e.ajax(e.extend(a,d,{url:i,type:r.verb,cache:!1,dataType:"json",async:r.async,timeout:r.timeout,success:function(o){typeof r.success==typeof W.noop&&r.success(o)},error:function(o,f,g){typeof r.error==typeof W.noop&&r.error(f,g)}}))}}};W.mediaToTracks=function(t){let e=[];if(!t)e.push({type:"audio",capture:!0,recv:!0}),e.push({type:"video",capture:!0,recv:!0});else{if(!t.keepAudio&&t.audio!==!1&&(typeof t.audio>"u"||t.audio||t.audioSend||t.audioRecv||t.addAudio||t.replaceAudio||t.removeAudio)){let n={type:"audio"};t.removeAudio?n.remove=!0:(t.addAudio?n.add=!0:t.replaceAudio&&(n.replace=!0),t.audioSend!==!1&&(n.capture=t.audio||!0),t.audioRecv!==!1&&(n.recv=!0)),(n.remove||n.capture||n.recv)&&e.push(n)}if(!t.keepVideo&&t.video!==!1&&(typeof t.video>"u"||t.video||t.videoSend||t.videoRecv||t.addVideo||t.replaceVideo||t.removeVideo)){let n={type:"video"};t.removeVideo?n.remove=!0:(t.addVideo?n.add=!0:t.replaceVideo&&(n.replace=!0),t.videoSend!==!1&&(n.capture=t.video||!0,["screen","window","desktop"].includes(n.capture)&&(n.type="screen",n.capture={video:{}},t.screenshareFrameRate&&(n.capture.frameRate=t.screenshareFrameRate),t.screenshareHeight&&(n.capture.height=t.screenshareHeight),t.screenshareWidth&&(n.capture.width=t.screenshareWidth))),t.videoRecv!==!1&&(n.recv=!0)),(n.remove||n.capture||n.recv)&&e.push(n)}t.data&&e.push({type:"data"})}return e};W.trackConstraints=function(t){let e={};if(!t||!t.capture)return e;if(t.type==="audio")e.audio=t.capture;else if(t.type==="video")if((t.simulcast||t.svc)&&t.capture===!0&&(t.capture="hires"),t.capture===!0||typeof t.capture=="object")e.video=t.capture;else{let n=0,i=0;t.capture==="lowres"?(n=320,i=240):t.capture==="lowres-16:9"?(n=320,i=180):t.capture==="hires"||t.capture==="hires-16:9"||t.capture==="hdres"?(n=1280,i=720):t.capture==="fhdres"?(n=1920,i=1080):t.capture==="4kres"?(n=3840,i=2160):t.capture==="stdres"?(n=640,i=480):t.capture==="stdres-16:9"?(n=640,i=360):(W.log("Default video setting is stdres 4:3"),n=640,i=480),e.video={width:{ideal:n},height:{ideal:i}}}else t.type==="screen"&&(e.video=t.capture);return e};W.noop=function(){};W.dataChanDefaultLabel="JanusDataChannel";W.endOfCandidates=null;W.stopAllTracks=function(t){try{let e=t.getTracks();for(let n of e)W.log(n),n&&n.dontStop!==!0&&n.stop()}catch(e){}};W.init=function(t){if(t=t||{},t.callback=typeof t.callback=="function"?t.callback:W.noop,W.initDone)t.callback();else{if(typeof console.log>"u"&&(console.log=function(){}),W.trace=W.noop,W.debug=W.noop,W.vdebug=W.noop,W.log=W.noop,W.warn=W.noop,W.error=W.noop,t.debug===!0||t.debug==="all")W.trace=console.trace.bind(console),W.debug=console.debug.bind(console),W.vdebug=console.debug.bind(console),W.log=console.log.bind(console),W.warn=console.warn.bind(console),W.error=console.error.bind(console);else if(Array.isArray(t.debug))for(let a of t.debug)switch(a){case"trace":W.trace=console.trace.bind(console);break;case"debug":W.debug=console.debug.bind(console);break;case"vdebug":W.vdebug=console.debug.bind(console);break;case"log":W.log=console.log.bind(console);break;case"warn":W.warn=console.warn.bind(console);break;case"error":W.error=console.error.bind(console);break}W.log("Initializing library");let e=t.dependencies||W.useDefaultDependencies();W.isArray=e.isArray,W.webRTCAdapter=e.webRTCAdapter,W.httpAPICall=e.httpAPICall,W.newWebSocket=e.newWebSocket,W.extension=e.extension,W.extension.init(),W.listDevices=function(a,d){a=typeof a=="function"?a:W.noop,d||(d={audio:!0,video:!0}),W.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(d).then(function(o){navigator.mediaDevices.enumerateDevices().then(function(f){W.debug(f),a(f),W.stopAllTracks(o)})}).catch(function(o){W.error(o),a([])}):(W.warn("navigator.mediaDevices unavailable"),a([]))},W.attachMediaStream=function(a,d){try{a.srcObject=d}catch(o){try{a.src=URL.createObjectURL(d)}catch(f){W.error("Error attaching stream to element",f)}}},W.reattachMediaStream=function(a,d){try{a.srcObject=d.srcObject}catch(o){try{a.src=d.src}catch(f){W.error("Error reattaching stream to element",f)}}};let i=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",r=window["on"+i];if(window.addEventListener(i,function(){W.log("Closing window");for(const[a,d]of W.sessions)d&&d.destroyOnUnload&&(W.log("Destroying session "+a),d.destroy({unload:!0,notifyDestroyed:!1}));r&&typeof r=="function"&&r()}),W.safariVp8=!1,W.safariVp9=!1,W.webRTCAdapter.browserDetails.browser==="safari"&&W.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(let a of RTCRtpSender.getCapabilities("video").codecs)a&&a.mimeType&&a.mimeType.toLowerCase()==="video/vp8"?W.safariVp8=!0:a&&a.mimeType&&a.mimeType.toLowerCase()==="video/vp9"&&(W.safariVp9=!0);W.safariVp8?W.log("This version of Safari supports VP8"):W.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{let a=new RTCPeerConnection({});a.createOffer({offerToReceiveVideo:!0}).then(function(d){W.safariVp8=d.sdp.indexOf("VP8")!==-1,W.safariVp9=d.sdp.indexOf("VP9")!==-1,W.safariVp8?W.log("This version of Safari supports VP8"):W.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),a.close(),a=null})}W.initDone=!0,t.callback()}};W.isWebrtcSupported=function(){return!!window.RTCPeerConnection};W.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia};W.randomString=function(t){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="";for(let i=0;i<t;i++){let r=Math.floor(Math.random()*e.length);n+=e.charAt(r)}return n};function W(t){if(t=t||{},t.success=typeof t.success=="function"?t.success:W.noop,t.error=typeof t.error=="function"?t.error:W.noop,t.destroyed=typeof t.destroyed=="function"?t.destroyed:W.noop,!W.initDone)return t.error("Library not initialized"),{};if(!W.isWebrtcSupported())return t.error("WebRTC not supported by this browser"),{};if(W.log("Library initialized: "+W.initDone),!t.server)return t.error("Invalid server url"),{};let e=!1,n=null,i={},r=null,a=null,d=0,o=t.server;W.isArray(o)?(W.log("Multiple servers provided ("+o.length+"), will use the first that works"),o=null,a=t.server,W.debug(a)):o.indexOf("ws")===0?(e=!0,W.log("Using WebSockets to contact Janus: "+o)):(e=!1,W.log("Using REST API to contact Janus: "+o));let f=t.iceServers||[{urls:"stun:stun.l.google.com:19302"}],g=t.iceTransportPolicy,_=t.bundlePolicy,w=!1;typeof t.withCredentials<"u"&&t.withCredentials!==null&&(w=t.withCredentials===!0);let T=10;typeof t.max_poll_events<"u"&&t.max_poll_events!==null&&(T=t.max_poll_events),T<1&&(T=1);let A=null;typeof t.token<"u"&&t.token!==null&&(A=t.token);let D=null;typeof t.apisecret<"u"&&t.apisecret!==null&&(D=t.apisecret),this.destroyOnUnload=!0,typeof t.destroyOnUnload<"u"&&t.destroyOnUnload!==null&&(this.destroyOnUnload=t.destroyOnUnload===!0);let z=25e3;typeof t.keepAlivePeriod<"u"&&t.keepAlivePeriod!==null&&(z=t.keepAlivePeriod),isNaN(z)&&(z=25e3);let G=6e4;typeof t.longPollTimeout<"u"&&t.longPollTimeout!==null&&(G=t.longPollTimeout),isNaN(G)&&(G=6e4);function V(ce){let Ee={high:9e5,medium:3e5,low:1e5};return typeof ce<"u"&&ce!==null&&(ce.high&&(Ee.high=ce.high),ce.medium&&(Ee.medium=ce.medium),ce.low&&(Ee.low=ce.low)),Ee}let N=!1,q=null,K=new Map,se=this,ie=0,Q=new Map;Fe(t),this.getServer=function(){return o},this.isConnected=function(){return N},this.reconnect=function(ce){ce=ce||{},ce.success=typeof ce.success=="function"?ce.success:W.noop,ce.error=typeof ce.error=="function"?ce.error:W.noop,ce.reconnect=!0,Fe(ce)},this.getSessionId=function(){return q},this.getInfo=function(ce){tt(ce)},this.destroy=function(ce){At(ce)},this.attach=function(ce){_t(ce)};function J(){if(q==null)return;if(W.debug("Long poll..."),!N){W.warn("Is the server down? (connected=false)");return}let ce=o+"/"+q+"?rid="+new Date().getTime();T&&(ce=ce+"&maxev="+T),A&&(ce=ce+"&token="+encodeURIComponent(A)),D&&(ce=ce+"&apisecret="+encodeURIComponent(D)),W.httpAPICall(ce,{verb:"GET",withCredentials:w,success:te,timeout:G,error:function(Ee,Oe){if(W.error(Ee+":",Oe),ie++,ie>3){N=!1,t.error("Lost connection to the server (is it down?)");return}J()}})}function te(ce,Ee){if(ie=0,!e&&typeof q<"u"&&q!==null&&Ee!==!0&&J(),!e&&W.isArray(ce)){for(let Oe=0;Oe<ce.length;Oe++)te(ce[Oe],!0);return}if(ce.janus==="keepalive"){W.vdebug("Got a keepalive on session "+q);return}else if(ce.janus==="server_info"){W.debug("Got info on the Janus instance"),W.debug(ce);const Oe=ce.transaction;if(Oe){const pe=Q.get(Oe);pe&&pe(ce),Q.delete(Oe)}return}else if(ce.janus==="ack"){W.debug("Got an ack on session "+q),W.debug(ce);const Oe=ce.transaction;if(Oe){const pe=Q.get(Oe);pe&&pe(ce),Q.delete(Oe)}return}else if(ce.janus==="success"){W.debug("Got a success on session "+q),W.debug(ce);const Oe=ce.transaction;if(Oe){const pe=Q.get(Oe);pe&&pe(ce),Q.delete(Oe)}return}else if(ce.janus==="trickle"){const Oe=ce.sender;if(!Oe){W.warn("Missing sender...");return}const pe=K.get(Oe);if(!pe){W.debug("This handle is not attached to this session");return}let Xe=ce.candidate;W.debug("Got a trickled candidate on session "+q),W.debug(Xe);let Qe=pe.webrtcStuff;Qe.pc&&Qe.remoteSdp?(W.debug("Adding remote candidate:",Xe),!Xe||Xe.completed===!0?Qe.pc.addIceCandidate(W.endOfCandidates):Qe.pc.addIceCandidate(Xe)):(W.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),Qe.candidates||(Qe.candidates=[]),Qe.candidates.push(Xe),W.debug(Qe.candidates))}else if(ce.janus==="webrtcup"){W.debug("Got a webrtcup event on session "+q),W.debug(ce);const Oe=ce.sender;if(!Oe){W.warn("Missing sender...");return}const pe=K.get(Oe);if(!pe){W.debug("This handle is not attached to this session");return}pe.webrtcState(!0);return}else if(ce.janus==="hangup"){W.debug("Got a hangup event on session "+q),W.debug(ce);const Oe=ce.sender;if(!Oe){W.warn("Missing sender...");return}const pe=K.get(Oe);if(!pe){W.debug("This handle is not attached to this session");return}pe.webrtcState(!1,ce.reason),pe.hangup()}else if(ce.janus==="detached"){W.debug("Got a detached event on session "+q),W.debug(ce);const Oe=ce.sender;if(!Oe){W.warn("Missing sender...");return}const pe=K.get(Oe);if(!pe)return;pe.ondetached(),pe.detach()}else if(ce.janus==="media"){W.debug("Got a media event on session "+q),W.debug(ce);const Oe=ce.sender;if(!Oe){W.warn("Missing sender...");return}const pe=K.get(Oe);if(!pe){W.debug("This handle is not attached to this session");return}pe.mediaState(ce.type,ce.receiving,ce.mid)}else if(ce.janus==="slowlink"){W.debug("Got a slowlink event on session "+q),W.debug(ce);const Oe=ce.sender;if(!Oe){W.warn("Missing sender...");return}const pe=K.get(Oe);if(!pe){W.debug("This handle is not attached to this session");return}pe.slowLink(ce.uplink,ce.lost,ce.mid)}else if(ce.janus==="error"){W.error("Ooops: "+ce.error.code+" "+ce.error.reason),W.debug(ce);let Oe=ce.transaction;if(Oe){let pe=Q.get(Oe);pe&&pe(ce),Q.delete(Oe)}return}else if(ce.janus==="event"){W.debug("Got a plugin event on session "+q),W.debug(ce);const Oe=ce.sender;if(!Oe){W.warn("Missing sender...");return}let pe=ce.plugindata;if(!pe){W.warn("Missing plugindata...");return}W.debug("  -- Event is coming from "+Oe+" ("+pe.plugin+")");let Xe=pe.data;W.debug(Xe);const Qe=K.get(Oe);if(!Qe){W.warn("This handle is not attached to this session");return}let $e=ce.jsep;$e&&(W.debug("Handling SDP as well..."),W.debug($e));let Ot=Qe.onmessage;Ot?(W.debug("Notifying application..."),Ot(Xe,$e)):W.debug("No provided notification callback")}else if(ce.janus==="timeout"){W.error("Timeout on session "+q),W.debug(ce),e&&n.close(3504,"Gateway timeout");return}else W.warn("Unknown message/event  '"+ce.janus+"' on session "+q),W.debug(ce)}function me(){if(!o||!e||!N)return;r=setTimeout(me,z);let ce={janus:"keepalive",session_id:q,transaction:W.randomString(12)};A&&(ce.token=A),D&&(ce.apisecret=D),n.send(JSON.stringify(ce))}function Fe(ce){let Ee=W.randomString(12),Oe={janus:"create",transaction:Ee};if(ce.reconnect&&(N=!1,Oe.janus="claim",Oe.session_id=q,n&&(n.onopen=null,n.onerror=null,n.onclose=null,r&&(clearTimeout(r),r=null))),A&&(Oe.token=A),D&&(Oe.apisecret=D),!o&&W.isArray(a)&&(o=a[d],o.indexOf("ws")===0?(e=!0,W.log("Server #"+(d+1)+": trying WebSockets to contact Janus ("+o+")")):(e=!1,W.log("Server #"+(d+1)+": trying REST API to contact Janus ("+o+")"))),e){n=W.newWebSocket(o,"janus-protocol"),i={error:function(){if(W.error("Error connecting to the Janus WebSockets server... "+o),W.isArray(a)&&!ce.reconnect){if(d++,d===a.length){ce.error("Error connecting to any of the provided Janus servers: Is the server down?");return}o=null,setTimeout(function(){Fe(ce)},200);return}ce.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){Q.set(Ee,function(pe){if(W.debug(pe),pe.janus!=="success"){W.error("Ooops: "+pe.error.code+" "+pe.error.reason),ce.error(pe.error.reason);return}r=setTimeout(me,z),N=!0,q=pe.session_id?pe.session_id:pe.data.id,ce.reconnect?W.log("Claimed session: "+q):W.log("Created session: "+q),W.sessions.set(q,se),ce.success()}),n.send(JSON.stringify(Oe))},message:function(pe){te(JSON.parse(pe.data))},close:function(){!o||!N||(N=!1,t.error("Lost connection to the server (is it down?)"))}};for(let pe in i)n.addEventListener(pe,i[pe]);return}W.httpAPICall(o,{verb:"POST",withCredentials:w,body:Oe,success:function(pe){if(W.debug(pe),pe.janus!=="success"){W.error("Ooops: "+pe.error.code+" "+pe.error.reason),ce.error(pe.error.reason);return}N=!0,q=pe.session_id?pe.session_id:pe.data.id,ce.reconnect?W.log("Claimed session: "+q):W.log("Created session: "+q),W.sessions.set(q,se),J(),ce.success()},error:function(pe,Xe){if(W.error(pe+":",Xe),W.isArray(a)&&!ce.reconnect){if(d++,d===a.length){ce.error("Error connecting to any of the provided Janus servers: Is the server down?");return}o=null,setTimeout(function(){Fe(ce)},200);return}Xe===""?ce.error(pe+": Is the server down?"):Xe&&Xe.error?ce.error(pe+": "+Xe.error.message):ce.error(pe+": "+Xe)}})}function tt(ce){if(ce=ce||{},ce.success=typeof ce.success=="function"?ce.success:W.noop,ce.error=typeof ce.error=="function"?ce.error:W.noop,W.log("Getting info on Janus instance"),!N){W.warn("Is the server down? (connected=false)"),ce.error("Is the server down? (connected=false)");return}let Ee=W.randomString(12),Oe={janus:"info",transaction:Ee};if(A&&(Oe.token=A),D&&(Oe.apisecret=D),e){Q.set(Ee,function(pe){W.log("Server info:"),W.debug(pe),pe.janus!=="server_info"&&W.error("Ooops: "+pe.error.code+" "+pe.error.reason),ce.success(pe)}),n.send(JSON.stringify(Oe));return}W.httpAPICall(o,{verb:"POST",withCredentials:w,body:Oe,success:function(pe){W.log("Server info:"),W.debug(pe),pe.janus!=="server_info"&&W.error("Ooops: "+pe.error.code+" "+pe.error.reason),ce.success(pe)},error:function(pe,Xe){W.error(pe+":",Xe),Xe===""?ce.error(pe+": Is the server down?"):ce.error(pe+": "+Xe)}})}function At(ce){ce=ce||{},ce.success=typeof ce.success=="function"?ce.success:W.noop,ce.error=typeof ce.error=="function"?ce.error:W.noop;let Ee=ce.unload===!0,Oe=!0;typeof ce.notifyDestroyed<"u"&&ce.notifyDestroyed!==null&&(Oe=ce.notifyDestroyed===!0);let pe=ce.cleanupHandles===!0;if(W.log("Destroying session "+q+" (unload="+Ee+")"),!q){W.warn("No session to destroy"),ce.success(),Oe&&t.destroyed();return}if(pe)for(const Qe of K.keys())Be(Qe,{noRequest:!0});if(!N){W.warn("Is the server down? (connected=false)"),q=null,ce.success();return}let Xe={janus:"destroy",transaction:W.randomString(12)};if(A&&(Xe.token=A),D&&(Xe.apisecret=D),Ee){e?(n.onclose=null,n.close(),n=null):navigator.sendBeacon(o+"/"+q,JSON.stringify(Xe)),W.log("Destroyed session:"),q=null,N=!1,ce.success(),Oe&&t.destroyed();return}if(e){Xe.session_id=q;let Qe=function(){for(let mt in i)n.removeEventListener(mt,i[mt]);n.removeEventListener("message",$e),n.removeEventListener("error",Ot),r&&clearTimeout(r),n.close()},$e=function(mt){let De=JSON.parse(mt.data);De.session_id==Xe.session_id&&De.transaction==Xe.transaction&&(Qe(),ce.success(),Oe&&t.destroyed())},Ot=function(){Qe(),ce.error("Failed to destroy the server: Is the server down?"),Oe&&t.destroyed()};n.addEventListener("message",$e),n.addEventListener("error",Ot),n.readyState===1?n.send(JSON.stringify(Xe)):Ot();return}W.httpAPICall(o+"/"+q,{verb:"POST",withCredentials:w,body:Xe,success:function(Qe){W.log("Destroyed session:"),W.debug(Qe),q=null,N=!1,Qe.janus!=="success"&&W.error("Ooops: "+Qe.error.code+" "+Qe.error.reason),ce.success(),Oe&&t.destroyed()},error:function(Qe,$e){W.error(Qe+":",$e),q=null,N=!1,ce.success(),Oe&&t.destroyed()}})}function _t(ce){if(ce=ce||{},ce.success=typeof ce.success=="function"?ce.success:W.noop,ce.error=typeof ce.error=="function"?ce.error:W.noop,ce.dataChannelOptions=ce.dataChannelOptions||{ordered:!0},ce.consentDialog=typeof ce.consentDialog=="function"?ce.consentDialog:W.noop,ce.iceState=typeof ce.iceState=="function"?ce.iceState:W.noop,ce.mediaState=typeof ce.mediaState=="function"?ce.mediaState:W.noop,ce.webrtcState=typeof ce.webrtcState=="function"?ce.webrtcState:W.noop,ce.slowLink=typeof ce.slowLink=="function"?ce.slowLink:W.noop,ce.onmessage=typeof ce.onmessage=="function"?ce.onmessage:W.noop,ce.onlocaltrack=typeof ce.onlocaltrack=="function"?ce.onlocaltrack:W.noop,ce.onremotetrack=typeof ce.onremotetrack=="function"?ce.onremotetrack:W.noop,ce.ondata=typeof ce.ondata=="function"?ce.ondata:W.noop,ce.ondataopen=typeof ce.ondataopen=="function"?ce.ondataopen:W.noop,ce.oncleanup=typeof ce.oncleanup=="function"?ce.oncleanup:W.noop,ce.ondetached=typeof ce.ondetached=="function"?ce.ondetached:W.noop,!N){W.warn("Is the server down? (connected=false)"),ce.error("Is the server down? (connected=false)");return}let Ee=ce.plugin;if(!Ee){W.error("Invalid plugin"),ce.error("Invalid plugin");return}let Oe=ce.opaqueId,pe=ce.loopIndex,Xe=ce.token?ce.token:A,Qe=W.randomString(12),$e={janus:"attach",plugin:Ee,opaque_id:Oe,loop_index:pe,transaction:Qe};if(Xe&&($e.token=Xe),D&&($e.apisecret=D),e){Q.set(Qe,function(Ot){if(W.debug(Ot),Ot.janus!=="success"){W.error("Ooops: "+Ot.error.code+" "+Ot.error.reason),ce.error("Ooops: "+Ot.error.code+" "+Ot.error.reason);return}let mt=Ot.data.id;W.log("Created handle: "+mt);let De={session:se,plugin:Ee,id:mt,token:Xe,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:ce.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return mt},getPlugin:function(){return Ee},getVolume:function(Ke,Lt){return gn(mt,Ke,!0,Lt)},getRemoteVolume:function(Ke,Lt){return gn(mt,Ke,!0,Lt)},getLocalVolume:function(Ke,Lt){return gn(mt,Ke,!1,Lt)},isAudioMuted:function(Ke){return sr(mt,Ke,!1)},muteAudio:function(Ke){return fi(mt,Ke,!1,!0)},unmuteAudio:function(Ke){return fi(mt,Ke,!1,!1)},isVideoMuted:function(Ke){return sr(mt,Ke,!0)},muteVideo:function(Ke){return fi(mt,Ke,!0,!0)},unmuteVideo:function(Ke){return fi(mt,Ke,!0,!1)},getBitrate:function(Ke){return wo(mt,Ke)},setMaxBitrate:function(Ke,Lt){return ni(mt,Ke,Lt)},send:function(Ke){xt(mt,Ke)},data:function(Ke){ze(mt,Ke)},dtmf:function(Ke){ot(mt,Ke)},consentDialog:ce.consentDialog,iceState:ce.iceState,mediaState:ce.mediaState,webrtcState:ce.webrtcState,slowLink:ce.slowLink,onmessage:ce.onmessage,createOffer:function(Ke){gt(mt,!0,Ke)},createAnswer:function(Ke){gt(mt,!1,Ke)},handleRemoteJsep:function(Ke){Nt(mt,Ke)},replaceTracks:function(Ke){Zt(mt,Ke)},getLocalTracks:function(){return Ci(mt)},getRemoteTracks:function(){return Vi(mt)},onlocaltrack:ce.onlocaltrack,onremotetrack:ce.onremotetrack,ondata:ce.ondata,ondataopen:ce.ondataopen,oncleanup:ce.oncleanup,ondetached:ce.ondetached,hangup:function(Ke){Hs(mt,Ke===!0)},detach:function(Ke){Be(mt,Ke)}};K.set(mt,De),ce.success(De)}),$e.session_id=q,n.send(JSON.stringify($e));return}W.httpAPICall(o+"/"+q,{verb:"POST",withCredentials:w,body:$e,success:function(Ot){if(W.debug(Ot),Ot.janus!=="success"){W.error("Ooops: "+Ot.error.code+" "+Ot.error.reason),ce.error("Ooops: "+Ot.error.code+" "+Ot.error.reason);return}let mt=Ot.data.id;W.log("Created handle: "+mt);let De={session:se,plugin:Ee,id:mt,token:Xe,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,mySdp:null,mediaConstraints:null,pc:null,dataChannelOptions:ce.dataChannelOptions,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,bitrate:{}},getId:function(){return mt},getPlugin:function(){return Ee},getVolume:function(Ke,Lt){return gn(mt,Ke,!0,Lt)},getRemoteVolume:function(Ke,Lt){return gn(mt,Ke,!0,Lt)},getLocalVolume:function(Ke,Lt){return gn(mt,Ke,!1,Lt)},isAudioMuted:function(Ke){return sr(mt,Ke,!1)},muteAudio:function(Ke){return fi(mt,Ke,!1,!0)},unmuteAudio:function(Ke){return fi(mt,Ke,!1,!1)},isVideoMuted:function(Ke){return sr(mt,Ke,!0)},muteVideo:function(Ke){return fi(mt,Ke,!0,!0)},unmuteVideo:function(Ke){return fi(mt,Ke,!0,!1)},getBitrate:function(Ke){return wo(mt,Ke)},setMaxBitrate:function(Ke,Lt){return ni(mt,Ke,Lt)},send:function(Ke){xt(mt,Ke)},data:function(Ke){ze(mt,Ke)},dtmf:function(Ke){ot(mt,Ke)},consentDialog:ce.consentDialog,iceState:ce.iceState,mediaState:ce.mediaState,webrtcState:ce.webrtcState,slowLink:ce.slowLink,onmessage:ce.onmessage,createOffer:function(Ke){gt(mt,!0,Ke)},createAnswer:function(Ke){gt(mt,!1,Ke)},handleRemoteJsep:function(Ke){Nt(mt,Ke)},replaceTracks:function(Ke){Zt(mt,Ke)},getLocalTracks:function(){return Ci(mt)},getRemoteTracks:function(){return Vi(mt)},onlocaltrack:ce.onlocaltrack,onremotetrack:ce.onremotetrack,ondata:ce.ondata,ondataopen:ce.ondataopen,oncleanup:ce.oncleanup,ondetached:ce.ondetached,hangup:function(Ke){Hs(mt,Ke===!0)},detach:function(Ke){Be(mt,Ke)}};K.set(mt,De),ce.success(De)},error:function(Ot,mt){W.error(Ot+":",mt),mt===""?ce.error(Ot+": Is the server down?"):ce.error(Ot+": "+mt)}})}function xt(ce,Ee){if(Ee=Ee||{},Ee.success=typeof Ee.success=="function"?Ee.success:W.noop,Ee.error=typeof Ee.error=="function"?Ee.error:W.noop,!N){W.warn("Is the server down? (connected=false)"),Ee.error("Is the server down? (connected=false)");return}let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff){W.warn("Invalid handle"),Ee.error("Invalid handle");return}let pe=Ee.message,Xe=Ee.jsep,Qe=W.randomString(12),$e={janus:"message",body:pe,transaction:Qe};if(Oe.token&&($e.token=Oe.token),D&&($e.apisecret=D),Xe){$e.jsep={type:Xe.type,sdp:Xe.sdp},Xe.e2ee&&($e.jsep.e2ee=!0),(Xe.rid_order==="hml"||Xe.rid_order==="lmh")&&($e.jsep.rid_order=Xe.rid_order),Xe.force_relay&&($e.jsep.force_relay=!0);let Ot=null,mt=Oe.webrtcStuff;if(mt.pc){let De=mt.pc.getTransceivers();if(De&&De.length>0)for(let Ke in De){let Lt=De[Ke];if(Lt&&Lt.sender&&Lt.sender.track&&Lt.sender.track.kind==="video"){let mn=Lt.sender.getParameters();mn&&mn.encodings&&mn.encodings[0]&&mn.encodings[0].scalabilityMode&&(Ot||(Ot=[]),Ot.push({mindex:parseInt(Ke),mid:Lt.mid,svc:mn.encodings[0].scalabilityMode}))}}}Ot&&($e.jsep.svc=Ot)}if(W.debug("Sending message to plugin (handle="+ce+"):"),W.debug($e),e){$e.session_id=q,$e.handle_id=ce,Q.set(Qe,function(Ot){if(W.debug("Message sent!"),W.debug(Ot),Ot.janus==="success"){let mt=Ot.plugindata;if(!mt){W.warn("Request succeeded, but missing plugindata..."),Ee.success();return}W.log("Synchronous transaction successful ("+mt.plugin+")");let De=mt.data;W.debug(De),Ee.success(De);return}else if(Ot.janus!=="ack"){Ot.error?(W.error("Ooops: "+Ot.error.code+" "+Ot.error.reason),Ee.error(Ot.error.code+" "+Ot.error.reason)):(W.error("Unknown error"),Ee.error("Unknown error"));return}Ee.success()}),n.send(JSON.stringify($e));return}W.httpAPICall(o+"/"+q+"/"+ce,{verb:"POST",withCredentials:w,body:$e,success:function(Ot){if(W.debug("Message sent!"),W.debug(Ot),Ot.janus==="success"){let mt=Ot.plugindata;if(!mt){W.warn("Request succeeded, but missing plugindata..."),Ee.success();return}W.log("Synchronous transaction successful ("+mt.plugin+")");let De=mt.data;W.debug(De),Ee.success(De);return}else if(Ot.janus!=="ack"){Ot.error?(W.error("Ooops: "+Ot.error.code+" "+Ot.error.reason),Ee.error(Ot.error.code+" "+Ot.error.reason)):(W.error("Unknown error"),Ee.error("Unknown error"));return}Ee.success()},error:function(Ot,mt){W.error(Ot+":",mt),Ee.error(Ot+": "+mt)}})}function lt(ce,Ee){if(!N){W.warn("Is the server down? (connected=false)");return}let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff){W.warn("Invalid handle");return}let pe={janus:"trickle",candidate:Ee,transaction:W.randomString(12)};if(Oe.token&&(pe.token=Oe.token),D&&(pe.apisecret=D),W.vdebug("Sending trickle candidate (handle="+ce+"):"),W.vdebug(pe),e){pe.session_id=q,pe.handle_id=ce,n.send(JSON.stringify(pe));return}W.httpAPICall(o+"/"+q+"/"+ce,{verb:"POST",withCredentials:w,body:pe,success:function(Xe){if(W.vdebug("Candidate sent!"),W.vdebug(Xe),Xe.janus!=="ack"){W.error("Ooops: "+Xe.error.code+" "+Xe.error.reason);return}},error:function(Xe,Qe){W.error(Xe+":",Qe)}})}function zt(ce,Ee,Oe,pe,Xe){let Qe=K.get(ce);if(!Qe||!Qe.webrtcStuff){W.warn("Invalid handle");return}let $e=Qe.webrtcStuff;if(!$e.pc){W.warn("Invalid PeerConnection");return}let Ot=function(Ke){W.log("Received message on data channel:",Ke);let Lt=Ke.target.label;Qe.ondata(Ke.data,Lt)},mt=function(Ke){W.log("Received state change on data channel:",Ke);let Lt=Ke.target.label,mn=Ke.target.protocol,An=$e.dataChannel[Lt]?$e.dataChannel[Lt].readyState:"null";if(W.log("State change on <"+Lt+"> data channel: "+An),An==="open"){if($e.dataChannel[Lt].pending&&$e.dataChannel[Lt].pending.length>0){W.log("Sending pending messages on <"+Lt+">:",$e.dataChannel[Lt].pending.length);for(let Xi of $e.dataChannel[Lt].pending)W.log("Sending data on data channel <"+Lt+">"),W.debug(Xi),$e.dataChannel[Lt].send(Xi);$e.dataChannel[Lt].pending=[]}Qe.ondataopen(Lt,mn)}},De=function(Ke){W.error("Got error on data channel:",Ke)};if(pe)$e.dataChannel[Ee]=pe;else{let Ke=$e.dataChannelOptions;Oe&&(Ke.protocol=Oe),$e.dataChannel[Ee]=$e.pc.createDataChannel(Ee,Ke)}$e.dataChannel[Ee].onmessage=Ot,$e.dataChannel[Ee].onopen=mt,$e.dataChannel[Ee].onclose=mt,$e.dataChannel[Ee].onerror=De,$e.dataChannel[Ee].pending=[],Xe&&$e.dataChannel[Ee].pending.push(Xe)}function ze(ce,Ee){Ee=Ee||{},Ee.success=typeof Ee.success=="function"?Ee.success:W.noop,Ee.error=typeof Ee.error=="function"?Ee.error:W.noop;let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff){W.warn("Invalid handle"),Ee.error("Invalid handle");return}let pe=Oe.webrtcStuff,Xe=Ee.text||Ee.data;if(!Xe){W.warn("Invalid data"),Ee.error("Invalid data");return}let Qe=Ee.label?Ee.label:W.dataChanDefaultLabel;if(!pe.dataChannel[Qe]){zt(ce,Qe,Ee.protocol,!1,Xe,Ee.protocol),Ee.success();return}if(pe.dataChannel[Qe].readyState!=="open"){pe.dataChannel[Qe].pending.push(Xe),Ee.success();return}W.log("Sending data on data channel <"+Qe+">"),W.debug(Xe),pe.dataChannel[Qe].send(Xe),Ee.success()}function ot(ce,Ee){Ee=Ee||{},Ee.success=typeof Ee.success=="function"?Ee.success:W.noop,Ee.error=typeof Ee.error=="function"?Ee.error:W.noop;let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff){W.warn("Invalid handle"),Ee.error("Invalid handle");return}let pe=Oe.webrtcStuff;if(!pe.dtmfSender){if(pe.pc){let De=pe.pc.getSenders().find(function(Ke){return Ke.track&&Ke.track.kind==="audio"});if(!De){W.warn("Invalid DTMF configuration (no audio track)"),Ee.error("Invalid DTMF configuration (no audio track)");return}pe.dtmfSender=De.dtmf,pe.dtmfSender&&(W.log("Created DTMF Sender"),pe.dtmfSender.ontonechange=function(Ke){W.debug("Sent DTMF tone: "+Ke.tone)})}if(!pe.dtmfSender){W.warn("Invalid DTMF configuration"),Ee.error("Invalid DTMF configuration");return}}let Xe=Ee.dtmf;if(!Xe){W.warn("Invalid DTMF parameters"),Ee.error("Invalid DTMF parameters");return}let Qe=Xe.tones;if(!Qe){W.warn("Invalid DTMF string"),Ee.error("Invalid DTMF string");return}let $e=typeof Xe.duration=="number"?Xe.duration:500,Ot=typeof Xe.gap=="number"?Xe.gap:50;W.debug("Sending DTMF string "+Qe+" (duration "+$e+"ms, gap "+Ot+"ms)"),pe.dtmfSender.insertDTMF(Qe,$e,Ot),Ee.success()}function Be(ce,Ee){Ee=Ee||{},Ee.success=typeof Ee.success=="function"?Ee.success:W.noop,Ee.error=typeof Ee.error=="function"?Ee.error:W.noop;let Oe=Ee.noRequest===!0;W.log("Destroying handle "+ce+" (only-locally="+Oe+")"),Hs(ce);let pe=K.get(ce);if(!pe||pe.detached){K.delete(ce),Ee.success();return}if(pe.detached=!0,Oe){K.delete(ce),Ee.success();return}if(!N){W.warn("Is the server down? (connected=false)"),Ee.error("Is the server down? (connected=false)");return}let Xe={janus:"detach",transaction:W.randomString(12)};if(pe.token&&(Xe.token=pe.token),D&&(Xe.apisecret=D),e){Xe.session_id=q,Xe.handle_id=ce,n.send(JSON.stringify(Xe)),K.delete(ce),Ee.success();return}W.httpAPICall(o+"/"+q+"/"+ce,{verb:"POST",withCredentials:w,body:Xe,success:function(Qe){W.log("Destroyed handle:"),W.debug(Qe),Qe.janus!=="success"&&W.error("Ooops: "+Qe.error.code+" "+Qe.error.reason),K.delete(ce),Ee.success()},error:function(Qe,$e){W.error(Qe+":",$e),K.delete(ce),Ee.success()}})}function ft(ce,Ee){let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff)throw W.warn("Invalid handle"),"Invalid handle";let pe=Oe.webrtcStuff;if(pe.pc)return;let Xe={iceServers:f,iceTransportPolicy:g,bundlePolicy:_};Xe.sdpSemantics="unified-plan";let Qe=!1;if(Ee.tracks){for(let $e of Ee.tracks)if($e.transforms&&($e.transforms.sender||$e.transforms.receiver)){Qe=!0;break}}RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&Qe&&(pe.insertableStreams=!0,Xe.forceEncodedAudioInsertableStreams=!0,Xe.forceEncodedVideoInsertableStreams=!0,Xe.encodedInsertableStreams=!0),W.log("Creating PeerConnection"),pe.pc=new RTCPeerConnection(Xe),W.debug(pe.pc),pe.pc.getStats&&(pe.volume={},pe.bitrate.value="0 kbits/sec"),W.log("Preparing local SDP and gathering candidates (trickle="+pe.trickle+")"),pe.pc.oniceconnectionstatechange=function(){pe.pc&&Oe.iceState(pe.pc.iceConnectionState)},pe.pc.onicecandidate=function($e){if(!$e.candidate||$e.candidate.candidate&&$e.candidate.candidate.indexOf("endOfCandidates")>0)W.log("End of candidates."),pe.iceDone=!0,pe.trickle===!0?lt(ce,{completed:!0}):wt(ce,Ee);else{let Ot={candidate:$e.candidate.candidate,sdpMid:$e.candidate.sdpMid,sdpMLineIndex:$e.candidate.sdpMLineIndex};pe.trickle===!0&&lt(ce,Ot)}},pe.pc.ontrack=function($e){if(W.log("Handling Remote Track",$e),!$e.streams||!$e.track)return;let Ot=$e.transceiver?$e.transceiver.mid:$e.track.id;try{Oe.onremotetrack($e.track,Ot,!0,{reason:"created"})}catch(De){W.error("Error calling onremotetrack",De)}if($e.track.onended)return;let mt=null;W.log("Adding onended callback to track:",$e.track),$e.track.onended=function(De){W.log("Remote track removed:",De),clearTimeout(mt);let Ke=pe.pc?pe.pc.getTransceivers():null,Lt=Ke?Ke.find(An=>An.receiver.track===De.target):null,mn=Lt?Lt.mid:De.target.id;try{Oe.onremotetrack(De.target,mn,!1,{reason:"ended"})}catch(An){W.error("Error calling onremotetrack on removal",An)}},$e.track.onmute=function(De){W.log("Remote track muted:",De),mt||(mt=setTimeout(function(){W.log("Removing remote track");let Ke=pe.pc?pe.pc.getTransceivers():null,Lt=Ke?Ke.find(An=>An.receiver.track===De.target):null,mn=Lt?Lt.mid:De.target.id;try{Oe.onremotetrack(De.target,mn,!1,{reason:"mute"})}catch(An){W.error("Error calling onremotetrack on mute",An)}mt=null},3*840))},$e.track.onunmute=function(De){if(W.log("Remote track flowing again:",De),mt!=null)clearTimeout(mt),mt=null;else try{let Ke=pe.pc?pe.pc.getTransceivers():null,Lt=Ke?Ke.find(An=>An.receiver.track===De.target):null,mn=Lt?Lt.mid:De.target.id;Oe.onremotetrack(De.target,mn,!0,{reason:"unmute"})}catch(Ke){W.error("Error calling onremotetrack on unmute",Ke)}}}}async function gt(ce,Ee,Oe){Oe=Oe||{},Oe.success=typeof Oe.success=="function"?Oe.success:W.noop,Oe.error=typeof Oe.error=="function"?Oe.error:Ur;let pe=Oe.jsep;if(Ee&&pe){W.error("Provided a JSEP to a createOffer"),Oe.error("Provided a JSEP to a createOffer");return}else if(!Ee&&(!pe||!pe.type||!pe.sdp)){W.error("A valid JSEP is required for createAnswer"),Oe.error("A valid JSEP is required for createAnswer");return}if(Oe.media&&!Oe.tracks){if(Oe.tracks=W.mediaToTracks(Oe.media),Oe.simulcast===!0||Oe.simulcast2===!0||Oe.svc){for(let $e of Oe.tracks)if($e.type==="video"){Oe.simulcast===!0||Oe.simulcast2===!0?$e.simulcast=!0:Oe.svc&&($e.svc=Oe.svc);break}}W.warn("Deprecated media object passed, use tracks instead. Automatically translated to:",Oe.tracks)}if(Oe.tracks&&!Array.isArray(Oe.tracks)){W.error("Tracks must be an array"),Oe.error("Tracks must be an array");return}let Xe=K.get(ce);if(!Xe||!Xe.webrtcStuff){W.warn("Invalid handle"),Oe.error("Invalid handle");return}let Qe=Xe.webrtcStuff;Qe.trickle=jo(Oe.trickle);try{if(ft(ce,Oe),Ee&&await Fn(ce,Oe),pe){if(await Qe.pc.setRemoteDescription(pe),W.log("Remote description accepted!"),Qe.remoteSdp=pe.sdp,Qe.candidates&&Qe.candidates.length>0){for(let Ot=0;Ot<Qe.candidates.length;Ot++){let mt=Qe.candidates[Ot];W.debug("Adding remote candidate:",mt),!mt||mt.completed===!0?Qe.pc.addIceCandidate(W.endOfCandidates):Qe.pc.addIceCandidate(mt)}Qe.candidates=[]}await Fn(ce,Oe);let $e=await Xt(ce,Oe);Oe.success($e)}else{let $e=await en(ce,Oe);Oe.success($e)}}catch($e){W.error($e),Oe.error($e)}}function Nt(ce,Ee){Ee=Ee||{},Ee.success=typeof Ee.success=="function"?Ee.success:W.noop,Ee.error=typeof Ee.error=="function"?Ee.error:Ur,Ee.customizeSdp=typeof Ee.customizeSdp=="function"?Ee.customizeSdp:W.noop;let Oe=Ee.jsep,pe=K.get(ce);if(!pe||!pe.webrtcStuff){W.warn("Invalid handle"),Ee.error("Invalid handle");return}let Xe=pe.webrtcStuff;if(Oe){if(!Xe.pc){W.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),Ee.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");return}Ee.customizeSdp(Oe),Xe.pc.setRemoteDescription(Oe).then(function(){if(W.log("Remote description accepted!"),Xe.remoteSdp=Oe.sdp,Xe.candidates&&Xe.candidates.length>0){for(let Qe=0;Qe<Xe.candidates.length;Qe++){let $e=Xe.candidates[Qe];W.debug("Adding remote candidate:",$e),!$e||$e.completed===!0?Xe.pc.addIceCandidate(W.endOfCandidates):Xe.pc.addIceCandidate($e)}Xe.candidates=[]}Ee.success()},Ee.error)}else Ee.error("Invalid JSEP")}async function en(ce,Ee){Ee=Ee||{},Ee.customizeSdp=typeof Ee.customizeSdp=="function"?Ee.customizeSdp:W.noop;let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff)throw W.warn("Invalid handle"),"Invalid handle";let pe=Oe.webrtcStuff;W.log("Creating offer (iceDone="+pe.iceDone+")");let Xe={};Ee.iceRestart===!0&&(Xe.iceRestart=!0),W.debug(Xe);let $e=await pe.pc.createOffer(Xe);W.debug($e);let Ot={type:"offer",sdp:$e.sdp};return Ee.customizeSdp(Ot),$e.sdp=Ot.sdp,W.log("Setting local description"),pe.mySdp={type:"offer",sdp:$e.sdp},await pe.pc.setLocalDescription($e),pe.mediaConstraints=Xe,!pe.iceDone&&!pe.trickle?(W.log("Waiting for all candidates..."),null):(pe.insertableStreams&&($e.e2ee=!0),$e)}async function Xt(ce,Ee){Ee=Ee||{},Ee.customizeSdp=typeof Ee.customizeSdp=="function"?Ee.customizeSdp:W.noop;let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff)throw W.warn("Invalid handle"),"Invalid handle";let pe=Oe.webrtcStuff;W.log("Creating answer (iceDone="+pe.iceDone+")");let Xe=await pe.pc.createAnswer();W.debug(Xe);let Qe={type:"answer",sdp:Xe.sdp};return Ee.customizeSdp(Qe),Xe.sdp=Qe.sdp,W.log("Setting local description"),pe.mySdp={type:"answer",sdp:Xe.sdp},await pe.pc.setLocalDescription(Xe),!pe.iceDone&&!pe.trickle?(W.log("Waiting for all candidates..."),null):(pe.insertableStreams&&(Xe.e2ee=!0),Xe)}function wt(ce,Ee){Ee=Ee||{},Ee.success=typeof Ee.success=="function"?Ee.success:W.noop,Ee.error=typeof Ee.error=="function"?Ee.error:W.noop;let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff){W.warn("Invalid handle, not sending anything");return}let pe=Oe.webrtcStuff;if(W.log("Sending offer/answer SDP..."),!pe.mySdp){W.warn("Local SDP instance is invalid, not sending anything...");return}pe.mySdp={type:pe.pc.localDescription.type,sdp:pe.pc.localDescription.sdp},pe.trickle===!1&&(pe.mySdp.trickle=!1),W.debug(Ee),pe.sdpSent=!0,Ee.success(pe.mySdp)}async function Zt(ce,Ee){if(Ee=Ee||{},Ee.success=typeof Ee.success=="function"?Ee.success:W.noop,Ee.error=typeof Ee.error=="function"?Ee.error:W.noop,Ee.tracks&&!Array.isArray(Ee.tracks)){W.error("Tracks must be an array"),Ee.error("Tracks must be an array");return}for(let Oe of Ee.tracks)(Oe.add||!Oe.replace&&!Oe.remove)&&(Oe.replace=!0);try{await Fn(ce,Ee),Ee.success()}catch(Oe){W.error(Oe),Ee.error(Oe)}}async function Fn(ce,Ee){let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff)throw W.warn("Invalid handle, not sending anything"),"Invalid handle";let pe=Oe.webrtcStuff;if(!pe.pc)throw W.warn("Invalid PeerConnection"),"Invalid PeerConnection";let Xe=Ee.tracks;if(!Xe||!Array.isArray(Xe)||Xe.length===0)return;let Qe=!1,$e={};for(let De of Xe){if(delete De.gumGroup,!De.type||!["audio","video"].includes(De.type)||!De.capture||De.capture instanceof MediaStreamTrack)continue;let Ke=De.group?De.group:"default";$e[Ke]||($e[Ke]={}),!$e[Ke][De.type]&&(De.gumGroup=Ke,$e[Ke][De.type]=De)}let Ot=Object.keys($e);for(let De of Ot){let Ke=$e[De];(!Ke.audio||!Ke.video)&&(Ke.audio&&delete Ke.audio.gumGroup,Ke.video&&delete Ke.video.gumGroup,delete $e[De])}let mt=!!Ee.jsep;for(let De of Xe){if(!De.type){W.warn("Missing track type:",De);continue}if(De.type==="data"){if(pe.pc.ondatachannel){W.warn("Data channel exists already, not creating another one");continue}W.log("Creating default data channel"),zt(ce,W.dataChanDefaultLabel,null,!1),pe.pc.ondatachannel=function(yt){W.log("Data channel created by Janus:",yt),zt(ce,yt.channel.label,yt.channel.protocol,yt.channel)};continue}if((typeof De.add>"u"||De.add===null)&&(typeof De.remove>"u"||De.remove===null)&&(typeof De.replace>"u"||De.replace===null)&&(De.add=!0),De.add&&De.remove||De.add&&De.remove&&De.replace){W.warn("Conflicting actions for track, ignoring:",De);continue}De.add&&De.replace?(W.warn("Both add and replace provided, falling back to replace:",De),delete De.add):De.remove&&De.replace&&(W.warn("Both remove and replace provided, falling back to remove:",De),delete De.replace);let Ke=De.type;De.type==="screen"&&(Ke="video");let Lt=null,mn=null;if(De.mid?Lt=pe.pc.getTransceivers().find(yt=>yt.mid===De.mid&&yt.receiver.track.kind===Ke):Lt=pe.pc.getTransceivers().find(yt=>yt.receiver.track.kind===Ke),De.replace||De.remove){if(!Lt){W.warn("Couldn't find a transceiver for track:",De);continue}if(!Lt.sender){W.warn("No sender in the transceiver for track:",De);continue}mn=Lt.sender}if(mt&&!Lt&&(Lt=pe.pc.getTransceivers().find(yt=>yt.receiver.track.kind===Ke),!Lt)){W.warn("Couldn't find a transceiver for track:",De);continue}let An=null,Xi=null;if((De.remove||De.replace)&&(W.log("Removing track from PeerConnection",De),Xi=mn.track?mn.track.id:null,await mn.replaceTrack(null),Xi&&pe.myStream)){let yt=null;if(Ke==="audio"&&pe.myStream.getAudioTracks()&&pe.myStream.getAudioTracks().length)for(let En of pe.myStream.getAudioTracks())En.id===Xi&&(yt=En,W.log("Removing audio track:",yt));else if(Ke==="video"&&pe.myStream.getVideoTracks()&&pe.myStream.getVideoTracks().length)for(let En of pe.myStream.getVideoTracks())En.id===Xi&&(yt=En,W.log("Removing video track:",yt));if(yt){try{pe.myStream.removeTrack(yt),Oe.onlocaltrack(yt,!1)}catch(En){W.error("Error calling onlocaltrack on removal for renegotiation",En)}if(yt.dontStop!==!0)try{yt.stop()}catch(En){}}}if(De.capture){if(De.gumGroup&&$e[De.gumGroup]&&$e[De.gumGroup].stream){let yt=$e[De.gumGroup].stream;An=De.type==="audio"?yt.getAudioTracks()[0]:yt.getVideoTracks()[0],delete $e[De.gumGroup].stream,delete $e[De.gumGroup],delete De.gumGroup}else if(De.capture instanceof MediaStreamTrack)An=De.capture;else{Qe||(Qe=!0,Oe.consentDialog(!0));let yt=W.trackConstraints(De),En=null;if(De.type==="audio"||De.type==="video"){if(De.gumGroup){let xi=De.type==="audio"?"video":"audio";if($e[De.gumGroup]&&$e[De.gumGroup][xi]){let fo=$e[De.gumGroup][xi],nl=W.trackConstraints(fo);yt[xi]=nl[xi]}}En=await navigator.mediaDevices.getUserMedia(yt),De.gumGroup&&yt.audio&&yt.video&&($e[De.gumGroup].stream=En,delete De.gumGroup)}else En=await navigator.mediaDevices.getDisplayMedia(yt);An=De.type==="audio"?En.getAudioTracks()[0]:En.getVideoTracks()[0]}if(De.replace){await mn.replaceTrack(An);let yt="sendrecv";(De.recv===!1||Lt.direction==="inactive"||Lt.direction==="sendonly")&&(yt="sendonly"),Lt.setDirection?Lt.setDirection(yt):Lt.direction=yt}else{if(pe.myStream||(pe.myStream=new MediaStream),Ke==="audio"||!De.simulcast&&!De.svc)mn=pe.pc.addTrack(An,pe.myStream),Lt=pe.pc.getTransceivers().find(yt=>yt.sender===mn);else if(De.simulcast){if(W.webRTCAdapter.browserDetails.browser!=="firefox"){W.log("Enabling rid-based simulcasting:",An);let yt=V(De.simulcastMaxBitrates);Lt=pe.pc.addTransceiver(An,{direction:"sendrecv",streams:[pe.myStream],sendEncodings:De.sendEncodings||[{rid:"h",active:!0,scalabilityMode:"L1T2",maxBitrate:yt.high},{rid:"m",active:!0,scalabilityMode:"L1T2",maxBitrate:yt.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,scalabilityMode:"L1T2",maxBitrate:yt.low,scaleResolutionDownBy:4}]})}else if(W.log("Enabling Simulcasting for Firefox (RID)"),Lt=pe.pc.addTransceiver(An,{direction:"sendrecv",streams:[pe.myStream]}),mn=Lt?Lt.sender:null,mn){let yt=mn.getParameters();yt||(yt={});let En=V(De.simulcastMaxBitrates);yt.encodings=De.sendEncodings||[{rid:"h",active:!0,maxBitrate:En.high},{rid:"m",active:!0,maxBitrate:En.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:En.low,scaleResolutionDownBy:4}],mn.setParameters(yt)}}else W.log("Enabling SVC ("+De.svc+"):",An),Lt=pe.pc.addTransceiver(An,{direction:"sendrecv",streams:[pe.myStream],sendEncodings:[{scalabilityMode:De.svc}]});if(mn||(mn=Lt?Lt.sender:null),De.codec)if(W.webRTCAdapter.browserDetails.browser==="firefox")W.warn("setCodecPreferences not supported in Firefox, ignoring codec for track:",De);else if(typeof De.codec!="string")W.warn("Invalid codec value, ignoring for track:",De);else{let yt=Ke+"/"+De.codec.toLowerCase(),En=RTCRtpReceiver.getCapabilities(Ke).codecs.filter(function(xi){return xi.mimeType.toLowerCase()===yt});if(!En||En.length===0)W.warn("Codec not supported in this browser for this track, ignoring:",De);else if(Lt)try{Lt.setCodecPreferences(En)}catch(xi){W.warn("Failed enforcing codec for this "+Ke+" track:",xi)}}if(De.bitrate){if(De.simulcast||De.svc)W.warn("Ignoring bitrate for simulcast/SVC track, use sendEncodings for that");else if(isNaN(De.bitrate)||De.bitrate<0)W.warn("Ignoring invalid bitrate for track:",De);else if(mn){let yt=mn.getParameters();!yt||!yt.encodings||yt.encodings.length===0?W.warn("No encodings in the sender parameters, ignoring bitrate for track:",De):(yt.encodings[0].maxBitrate=De.bitrate,await mn.setParameters(yt))}}if(Ke==="video"&&De.framerate){if(De.simulcast||De.svc)W.warn("Ignoring framerate for simulcast/SVC track, use sendEncodings for that");else if(isNaN(De.framerate)||De.framerate<0)W.warn("Ignoring invalid framerate for track:",De);else if(mn){let yt=mn.getParameters();!yt||!yt.encodings||yt.encodings.length===0?W.warn("No encodings in the sender parameters, ignoring framerate for track:",De):(yt.encodings[0].maxFramerate=De.framerate,await mn.setParameters(yt))}}if(De.transforms){if(mn&&De.transforms.sender){let yt=null;RTCRtpSender.prototype.createEncodedStreams?yt=mn.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&(Ke==="audio"?yt=mn.createEncodedAudioStreams():Ke==="video"&&(yt=mn.createEncodedVideoStreams())),yt&&(yt.readableStream&&yt.writableStream?yt.readableStream.pipeThrough(De.transforms.sender).pipeTo(yt.writableStream):yt.readable&&yt.writable&&yt.readable.pipeThrough(De.transforms.sender).pipeTo(yt.writable))}if(Lt&&Lt.receiver&&De.transforms.receiver){let yt=null;RTCRtpReceiver.prototype.createEncodedStreams?yt=Lt.receiver.createEncodedStreams():(RTCRtpReceiver.prototype.createAudioEncodedStreams||RTCRtpReceiver.prototype.createEncodedVideoStreams)&&(Ke==="audio"?yt=Lt.receiver.createEncodedAudioStreams():Ke==="video"&&(yt=Lt.receiver.createEncodedVideoStreams())),yt&&(yt.readableStream&&yt.writableStream?yt.readableStream.pipeThrough(De.transforms.receiver).pipeTo(yt.writableStream):yt.readable&&yt.writable&&yt.readable.pipeThrough(De.transforms.receiver).pipeTo(yt.writable))}}}An&&De.dontStop===!0&&(An.dontStop=!0)}else if(De.recv&&(Lt||(Lt=pe.pc.addTransceiver(Ke)),Lt)){if(De.codec)if(W.webRTCAdapter.browserDetails.browser==="firefox")W.warn("setCodecPreferences not supported in Firefox, ignoring codec for track:",De);else if(typeof De.codec!="string")W.warn("Invalid codec value, ignoring for track:",De);else{let yt=Ke+"/"+De.codec.toLowerCase(),En=RTCRtpReceiver.getCapabilities(Ke).codecs.filter(function(xi){return xi.mimeType.toLowerCase()===yt});if(!En||En.length===0)W.warn("Codec not supported in this browser for this track, ignoring:",De);else try{Lt.setCodecPreferences(En)}catch(xi){W.warn("Failed enforcing codec for this "+Ke+" track:",xi)}}if(Lt.receiver&&De.transforms&&De.transforms.receiver){let yt=null;RTCRtpReceiver.prototype.createEncodedStreams?yt=Lt.receiver.createEncodedStreams():(RTCRtpReceiver.prototype.createAudioEncodedStreams||RTCRtpReceiver.prototype.createEncodedVideoStreams)&&(Ke==="audio"?yt=Lt.receiver.createEncodedAudioStreams():Ke==="video"&&(yt=Lt.receiver.createEncodedVideoStreams())),yt&&(yt.readableStream&&yt.writableStream?yt.readableStream.pipeThrough(De.transforms.receiver).pipeTo(yt.writableStream):yt.readable&&yt.writable&&yt.readable.pipeThrough(De.transforms.receiver).pipeTo(yt.writable))}}if(An){pe.myStream.addTrack(An),An.onended=function(yt){W.log("Local track removed:",yt);try{Oe.onlocaltrack(yt.target,!1)}catch(En){W.error("Error calling onlocaltrack following end",En)}};try{Oe.onlocaltrack(An,!0)}catch(yt){W.error("Error calling onlocaltrack for track add",yt)}}if(Lt){let yt=Lt.direction,En=null,xi=An&&Lt.sender.track,fo=De.recv!==!1&&Lt.receiver.track;xi&&fo?En="sendrecv":xi&&!fo?En="sendonly":!xi&&fo?En="recvonly":!xi&&!fo&&(En="inactive"),En&&En!==yt&&(W.warn("Changing direction of transceiver to "+En+" (was "+yt+")",De),Lt.setDirection?Lt.setDirection(En):Lt.direction=En)}}Qe&&Oe.consentDialog(!1)}function Ci(ce){let Ee=K.get(ce);if(!Ee||!Ee.webrtcStuff)return W.warn("Invalid handle"),null;let Oe=Ee.webrtcStuff;if(!Oe.pc)return W.warn("Invalid PeerConnection"),null;let pe=[],Xe=Oe.pc.getTransceivers();for(let Qe of Xe){let $e=null;Qe.sender&&Qe.sender.track&&($e={mid:Qe.mid},$e.type=Qe.sender.track.kind,$e.id=Qe.sender.track.id,$e.label=Qe.sender.track.label),$e&&pe.push($e)}return pe}function Vi(ce){let Ee=K.get(ce);if(!Ee||!Ee.webrtcStuff)return W.warn("Invalid handle"),null;let Oe=Ee.webrtcStuff;if(!Oe.pc)return W.warn("Invalid PeerConnection"),null;let pe=[],Xe=Oe.pc.getTransceivers();for(let Qe of Xe){let $e=null;Qe.receiver&&Qe.receiver.track&&($e={mid:Qe.mid},$e.type=Qe.receiver.track.kind,$e.id=Qe.receiver.track.id,$e.label=Qe.receiver.track.label),$e&&pe.push($e)}return pe}function gn(ce,Ee,Oe,pe){pe=typeof pe=="function"?pe:W.noop;let Xe=K.get(ce);if(!Xe||!Xe.webrtcStuff){W.warn("Invalid handle"),pe(0);return}let Qe=Oe?"remote":"local",$e=Xe.webrtcStuff;if($e.volume[Qe]||($e.volume[Qe]={value:0}),$e.pc&&$e.pc.getStats&&(W.webRTCAdapter.browserDetails.browser==="chrome"||W.webRTCAdapter.browserDetails.browser==="safari")){let Ot=$e.pc;if(Ee){let mt=$e.pc.getTransceivers().find(De=>De.mid===Ee&&De.receiver.track.kind==="audio");if(!mt){W.warn("No audio transceiver with mid "+Ee),pe(0);return}if(Oe&&!mt.receiver){W.warn("Remote transceiver track unavailable"),pe(0);return}else if(!Oe&&!mt.sender){W.warn("Local transceiver track unavailable"),pe(0);return}Ot=Oe?mt.receiver:mt.sender}return Ot.getStats().then(function(mt){mt.forEach(function(De){!De||De.kind!=="audio"||Oe&&!De.remoteSource||!Oe&&De.type!=="media-source"||pe(De.audioLevel?De.audioLevel:0)})}),$e.volume[Qe].value}else{W.warn("Getting the "+Qe+" volume unsupported by browser"),pe(0);return}}function sr(ce,Ee,Oe){let pe=K.get(ce);if(!pe||!pe.webrtcStuff)return W.warn("Invalid handle"),!0;let Xe=pe.webrtcStuff;if(!Xe.pc)return W.warn("Invalid PeerConnection"),!0;if(!Xe.myStream)return W.warn("Invalid local MediaStream"),!0;if(Oe){if(!Xe.myStream.getVideoTracks()||Xe.myStream.getVideoTracks().length===0)return W.warn("No video track"),!0;if(Ee){let Qe=Xe.pc.getTransceivers().find($e=>$e.mid===Ee&&$e.receiver.track.kind==="video");return Qe?!Qe.sender||!Qe.sender.track?(W.warn("No video sender with mid "+Ee),!0):!Qe.sender.track.enabled:(W.warn("No video transceiver with mid "+Ee),!0)}else return!Xe.myStream.getVideoTracks()[0].enabled}else{if(!Xe.myStream.getAudioTracks()||Xe.myStream.getAudioTracks().length===0)return W.warn("No audio track"),!0;if(Ee){let Qe=Xe.pc.getTransceivers().find($e=>$e.mid===Ee&&$e.receiver.track.kind==="audio");return Qe?!Qe.sender||!Qe.sender.track?(W.warn("No audio sender with mid "+Ee),!0):!Qe.sender.track.enabled:(W.warn("No audio transceiver with mid "+Ee),!0)}else return!Xe.myStream.getAudioTracks()[0].enabled}}function fi(ce,Ee,Oe,pe){let Xe=K.get(ce);if(!Xe||!Xe.webrtcStuff)return W.warn("Invalid handle"),!1;let Qe=Xe.webrtcStuff;if(!Qe.pc)return W.warn("Invalid PeerConnection"),!1;if(!Qe.myStream)return W.warn("Invalid local MediaStream"),!1;if(Oe){if(!Qe.myStream.getVideoTracks()||Qe.myStream.getVideoTracks().length===0)return W.warn("No video track"),!1;if(Ee){let $e=Qe.pc.getTransceivers().find(Ot=>Ot.mid===Ee&&Ot.receiver.track.kind==="video");if(!$e)return W.warn("No video transceiver with mid "+Ee),!1;if(!$e.sender||!$e.sender.track)return W.warn("No video sender with mid "+Ee),!1;$e.sender.track.enabled=!pe}else for(const $e of Qe.myStream.getVideoTracks())$e.enabled=!pe}else{if(!Qe.myStream.getAudioTracks()||Qe.myStream.getAudioTracks().length===0)return W.warn("No audio track"),!1;if(Ee){let $e=Qe.pc.getTransceivers().find(Ot=>Ot.mid===Ee&&Ot.receiver.track.kind==="audio");if(!$e)return W.warn("No audio transceiver with mid "+Ee),!1;if(!$e.sender||!$e.sender.track)return W.warn("No audio sender with mid "+Ee),!1;$e.sender.track.enabled=!pe}else for(const $e of Qe.myStream.getAudioTracks())$e.enabled=!pe}return!0}function wo(ce,Ee){let Oe=K.get(ce);if(!Oe||!Oe.webrtcStuff)return W.warn("Invalid handle"),"Invalid handle";let pe=Oe.webrtcStuff;if(!pe.pc)return"Invalid PeerConnection";if(pe.pc.getStats){let Xe=pe.pc,Qe=Ee||"default";if(Ee){let $e=pe.pc.getTransceivers().find(Ot=>Ot.mid===Ee&&Ot.receiver.track.kind==="video");if(!$e)return W.warn("No video transceiver with mid "+Ee),"No video transceiver with mid "+Ee;if(!$e.receiver)return W.warn("No video receiver with mid "+Ee),"No video receiver with mid "+Ee;Xe=$e.receiver}return pe.bitrate[Qe]||(pe.bitrate[Qe]={timer:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,value:"0 kbits/sec"}),pe.bitrate[Qe].timer?pe.bitrate[Qe].value:(W.log("Starting bitrate timer"+(Ee?" for mid "+Ee:"")+" (via getStats)"),pe.bitrate[Qe].timer=setInterval(function(){Xe.getStats().then(function($e){$e.forEach(function(Ot){if(!Ot)return;let mt=!1;if(((Ot.mediaType==="video"||Ot.id.toLowerCase().indexOf("video")>-1)&&Ot.type==="inbound-rtp"&&Ot.id.indexOf("rtcp")<0||Ot.type=="ssrc"&&Ot.bytesReceived&&(Ot.googCodecName==="VP8"||Ot.googCodecName===""))&&(mt=!0),mt)if(pe.bitrate[Qe].bsnow=Ot.bytesReceived,pe.bitrate[Qe].tsnow=Ot.timestamp,pe.bitrate[Qe].bsbefore===null||pe.bitrate[Qe].tsbefore===null)pe.bitrate[Qe].bsbefore=pe.bitrate[Qe].bsnow,pe.bitrate[Qe].tsbefore=pe.bitrate[Qe].tsnow;else{let De=pe.bitrate[Qe].tsnow-pe.bitrate[Qe].tsbefore;W.webRTCAdapter.browserDetails.browser==="safari"&&(De=De/1e3);let Ke=Math.round((pe.bitrate[Qe].bsnow-pe.bitrate[Qe].bsbefore)*8/De);W.webRTCAdapter.browserDetails.browser==="safari"&&(Ke=parseInt(Ke/1e3)),pe.bitrate[Qe].value=Ke+" kbits/sec",pe.bitrate[Qe].bsbefore=pe.bitrate[Qe].bsnow,pe.bitrate[Qe].tsbefore=pe.bitrate[Qe].tsnow}})})},1e3),"0 kbits/sec")}else return W.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"}function ni(ce,Ee,Oe){let pe=K.get(ce);if(!pe||!pe.webrtcStuff){W.warn("Invalid handle");return}let Xe=pe.webrtcStuff;if(!Xe.pc){W.warn("Invalid PeerConnection");return}let Qe=Xe.pc.getTransceivers().find(Ot=>Ot.mid===Ee);if(!Qe){W.warn("No transceiver with mid",Ee);return}if(!Qe.sender){W.warn("No sender for transceiver with mid",Ee);return}let $e=Qe.sender.getParameters();!$e||!$e.encodings||$e.encodings.length===0?W.warn("No parameters encodings"):$e.encodings.length>1?W.warn("Ignoring bitrate for simulcast track, use sendEncodings for that"):isNaN(Oe)||Oe<0?W.warn("Invalid bitrate (must be a positive integer)"):($e.encodings[0].maxBitrate=Oe,Qe.sender.setParameters($e))}function Ur(ce){W.error("WebRTC error:",ce)}function Hs(ce,Ee){W.log("Cleaning WebRTC stuff");let Oe=K.get(ce);if(!Oe)return;let pe=Oe.webrtcStuff;if(pe){if(Ee===!0){let Xe={janus:"hangup",transaction:W.randomString(12)};Oe.token&&(Xe.token=Oe.token),D&&(Xe.apisecret=D),W.debug("Sending hangup request (handle="+ce+"):"),W.debug(Xe),e?(Xe.session_id=q,Xe.handle_id=ce,n.send(JSON.stringify(Xe))):W.httpAPICall(o+"/"+q+"/"+ce,{verb:"POST",withCredentials:w,body:Xe})}pe.volume&&(pe.volume.local&&pe.volume.local.timer&&clearInterval(pe.volume.local.timer),pe.volume.remote&&pe.volume.remote.timer&&clearInterval(pe.volume.remote.timer));for(let Xe in pe.bitrate)pe.bitrate[Xe].timer&&clearInterval(pe.bitrate[Xe].timer);pe.bitrate={},!pe.streamExternal&&pe.myStream&&(W.log("Stopping local stream tracks"),W.stopAllTracks(pe.myStream)),pe.streamExternal=!1,pe.myStream=null;try{pe.pc.close()}catch(Xe){}pe.pc=null,pe.candidates=null,pe.mySdp=null,pe.remoteSdp=null,pe.iceDone=!1,pe.dataChannel={},pe.dtmfSender=null,pe.insertableStreams=!1}Oe.oncleanup()}function jo(ce){return W.debug("isTrickleEnabled:",ce),ce!==!1}}let Lj=!0,zj=!0;function M_(t,e,n){const i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}function Uh(t,e,n){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(d,o){if(d!==e)return r.apply(this,arguments);const f=g=>{const _=n(g);_&&(o.handleEvent?o.handleEvent(_):o(_))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,f),r.apply(this,[d,f])};const a=i.removeEventListener;i.removeEventListener=function(d,o){if(d!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(o))return a.apply(this,arguments);const f=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[d,f])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(d){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),d&&this.addEventListener(e,this["_on"+e]=d)},enumerable:!0,configurable:!0})}function uhe(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(Lj=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function dhe(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(zj=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function Bj(){if(typeof window=="object"){if(Lj)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function KA(t,e){zj&&console.warn(t+" is deprecated, please use "+e+" instead.")}function hhe(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=M_(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=M_(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=M_(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function eB(t){return Object.prototype.toString.call(t)==="[object Object]"}function Fj(t){return eB(t)?Object.keys(t).reduce(function(e,n){const i=eB(t[n]),r=i?Fj(t[n]):t[n],a=i&&!Object.keys(r).length;return r===void 0||a?e:Object.assign(e,{[n]:r})},{}):t}function o2(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?o2(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach(r=>{o2(t,t.get(r),n)})}))}function tB(t,e,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(e===null)return r;const a=[];return t.forEach(d=>{d.type==="track"&&d.trackIdentifier===e.id&&a.push(d)}),a.forEach(d=>{t.forEach(o=>{o.type===i&&o.trackId===d.id&&o2(t,o,r)})}),r}const nB=Bj;function Nj(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const i=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const f={};return Object.keys(o).forEach(g=>{if(g==="require"||g==="advanced"||g==="mediaSource")return;const _=typeof o[g]=="object"?o[g]:{ideal:o[g]};_.exact!==void 0&&typeof _.exact=="number"&&(_.min=_.max=_.exact);const w=function(T,A){return T?T+A.charAt(0).toUpperCase()+A.slice(1):A==="deviceId"?"sourceId":A};if(_.ideal!==void 0){f.optional=f.optional||[];let T={};typeof _.ideal=="number"?(T[w("min",g)]=_.ideal,f.optional.push(T),T={},T[w("max",g)]=_.ideal,f.optional.push(T)):(T[w("",g)]=_.ideal,f.optional.push(T))}_.exact!==void 0&&typeof _.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[w("",g)]=_.exact):["min","max"].forEach(T=>{_[T]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[w(T,g)]=_[T])})}),o.advanced&&(f.optional=(f.optional||[]).concat(o.advanced)),f},r=function(o,f){if(e.version>=61)return f(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const g=function(_,w,T){w in _&&!(T in _)&&(_[T]=_[w],delete _[w])};o=JSON.parse(JSON.stringify(o)),g(o.audio,"autoGainControl","googAutoGainControl"),g(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=i(o.audio)}if(o&&typeof o.video=="object"){let g=o.video.facingMode;g=g&&(typeof g=="object"?g:{ideal:g});const _=e.version<66;if(g&&(g.exact==="user"||g.exact==="environment"||g.ideal==="user"||g.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!_)){delete o.video.facingMode;let w;if(g.exact==="environment"||g.ideal==="environment"?w=["back","rear"]:(g.exact==="user"||g.ideal==="user")&&(w=["front"]),w)return n.mediaDevices.enumerateDevices().then(T=>{T=T.filter(D=>D.kind==="videoinput");let A=T.find(D=>w.some(z=>D.label.toLowerCase().includes(z)));return!A&&T.length&&w.includes("back")&&(A=T[T.length-1]),A&&(o.video.deviceId=g.exact?{exact:A.deviceId}:{ideal:A.deviceId}),o.video=i(o.video),nB("chrome: "+JSON.stringify(o)),f(o)})}o.video=i(o.video)}return nB("chrome: "+JSON.stringify(o)),f(o)},a=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},d=function(o,f,g){r(o,_=>{n.webkitGetUserMedia(_,f,w=>{g&&g(a(w))})})};if(n.getUserMedia=d.bind(n),n.mediaDevices.getUserMedia){const o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(f){return r(f,g=>o(g).then(_=>{if(g.audio&&!_.getAudioTracks().length||g.video&&!_.getVideoTracks().length)throw _.getTracks().forEach(w=>{w.stop()}),new DOMException("","NotFoundError");return _},_=>Promise.reject(a(_))))}}}function fhe(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(r=>{const a=i.video&&i.video.width,d=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxFrameRate:o||3}},a&&(i.video.mandatory.maxWidth=a),d&&(i.video.mandatory.maxHeight=d),t.navigator.mediaDevices.getUserMedia(i)})}}}function $j(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function jj(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",r=>{let a;t.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(o=>o.track&&o.track.id===r.track.id):a={track:r.track};const d=new Event("track");d.track=r.track,d.receiver=a,d.transceiver={receiver:a},d.streams=[i.stream],this.dispatchEvent(d)}),i.stream.getTracks().forEach(r=>{let a;t.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(o=>o.track&&o.track.id===r.id):a={track:r};const d=new Event("track");d.track=r,d.receiver=a,d.transceiver={receiver:a},d.streams=[i.stream],this.dispatchEvent(d)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Uh(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Vj(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(r,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=r.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:r}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,f){let g=r.apply(this,arguments);return g||(g=e(this,o),this._senders.push(g)),g};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){a.apply(this,arguments);const f=this._senders.indexOf(o);f!==-1&&this._senders.splice(f,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(d=>{this._senders.push(e(this,d))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],i.apply(this,[a]),a.getTracks().forEach(d=>{const o=this._senders.find(f=>f.track===d);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Uj(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,r,a]=arguments;if(arguments.length>0&&typeof i=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof i!="function"))return e.apply(this,[]);const d=function(f){const g={};return f.result().forEach(w=>{const T={id:w.id,timestamp:w.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[w.type]||w.type};w.names().forEach(A=>{T[A]=w.stat(A)}),g[T.id]=T}),g},o=function(f){return new Map(Object.keys(f).map(g=>[g,f[g]]))};if(arguments.length>=2){const f=function(g){r(o(d(g)))};return e.apply(this,[f,i])}return new Promise((f,g)=>{e.apply(this,[function(_){f(o(d(_)))},g])}).then(r,a)}}function qj(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=n.apply(this,[]);return a.forEach(d=>d._pc=this),a});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=i.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(d=>tB(d,a.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(a=>a._pc=this),r}),Uh(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(a=>tB(a,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let r,a,d;return this.getSenders().forEach(o=>{o.track===i&&(r?d=!0:r=o)}),this.getReceivers().forEach(o=>(o.track===i&&(a?d=!0:a=o),o.track===i)),d||r&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Wj(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(d=>this._shimmedLocalStreams[d][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(d,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(f)===-1&&this._shimmedLocalStreams[o.id].push(f):this._shimmedLocalStreams[o.id]=[o,f],f};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(d){this._shimmedLocalStreams=this._shimmedLocalStreams||{},d.getTracks().forEach(g=>{if(this.getSenders().find(w=>w.track===g))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();n.apply(this,arguments);const f=this.getSenders().filter(g=>o.indexOf(g)===-1);this._shimmedLocalStreams[d.id]=[d].concat(f)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[d.id],i.apply(this,arguments)};const r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},d&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const f=this._shimmedLocalStreams[o].indexOf(d);f!==-1&&this._shimmedLocalStreams[o].splice(f,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),r.apply(this,arguments)}}function Gj(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Wj(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const _=n.apply(this);return this._reverseStreams=this._reverseStreams||{},_.map(w=>this._reverseStreams[w.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(_){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_.getTracks().forEach(w=>{if(this.getSenders().find(A=>A.track===w))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_.id]){const w=new t.MediaStream(_.getTracks());this._streams[_.id]=w,this._reverseStreams[w.id]=_,_=w}i.apply(this,[_])};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(_){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[_.id]||_]),delete this._reverseStreams[this._streams[_.id]?this._streams[_.id].id:_.id],delete this._streams[_.id]},t.RTCPeerConnection.prototype.addTrack=function(_,w){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const T=[].slice.call(arguments,1);if(T.length!==1||!T[0].getTracks().find(z=>z===_))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(z=>z.track===_))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const D=this._streams[w.id];if(D)D.addTrack(_),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const z=new t.MediaStream([_]);this._streams[w.id]=z,this._reverseStreams[z.id]=w,this.addStream(z)}return this.getSenders().find(z=>z.track===_)};function a(g,_){let w=_.sdp;return Object.keys(g._reverseStreams||[]).forEach(T=>{const A=g._reverseStreams[T],D=g._streams[A.id];w=w.replace(new RegExp(D.id,"g"),A.id)}),new RTCSessionDescription({type:_.type,sdp:w})}function d(g,_){let w=_.sdp;return Object.keys(g._reverseStreams||[]).forEach(T=>{const A=g._reverseStreams[T],D=g._streams[A.id];w=w.replace(new RegExp(A.id,"g"),D.id)}),new RTCSessionDescription({type:_.type,sdp:w})}["createOffer","createAnswer"].forEach(function(g){const _=t.RTCPeerConnection.prototype[g],w={[g](){const T=arguments;return arguments.length&&typeof arguments[0]=="function"?_.apply(this,[D=>{const z=a(this,D);T[0].apply(null,[z])},D=>{T[1]&&T[1].apply(null,D)},arguments[2]]):_.apply(this,arguments).then(D=>a(this,D))}};t.RTCPeerConnection.prototype[g]=w[g]});const o=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=d(this,arguments[0]),o.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const g=f.get.apply(this);return g.type===""?g:a(this,g)}}),t.RTCPeerConnection.prototype.removeTrack=function(_){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(_._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let T;Object.keys(this._streams).forEach(A=>{this._streams[A].getTracks().find(z=>_.track===z)&&(T=this._streams[A])}),T&&(T.getTracks().length===1?this.removeStream(this._reverseStreams[T.id]):T.removeTrack(_.track),this.dispatchEvent(new Event("negotiationneeded")))}}function s2(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=t.RTCPeerConnection.prototype[n],r={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=r[n]})}function Hj(t,e){Uh(t,"negotiationneeded",n=>{const i=n.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return n})}const iB=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Hj,shimAddTrackRemoveTrack:Gj,shimAddTrackRemoveTrackWithNative:Wj,shimGetDisplayMedia:fhe,shimGetSendersWithDtmf:Vj,shimGetStats:Uj,shimGetUserMedia:Nj,shimMediaStream:$j,shimOnTrack:jj,shimPeerConnection:s2,shimSenderReceiverGetStats:qj},Symbol.toStringTag,{value:"Module"}));function Zj(t,e){const n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(r,a,d){KA("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(r).then(a,d)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const r=function(d,o,f){o in d&&!(f in d)&&(d[f]=d[o],delete d[o])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(d){return typeof d=="object"&&typeof d.audio=="object"&&(d=JSON.parse(JSON.stringify(d)),r(d.audio,"autoGainControl","mozAutoGainControl"),r(d.audio,"noiseSuppression","mozNoiseSuppression")),a(d)},i&&i.prototype.getSettings){const d=i.prototype.getSettings;i.prototype.getSettings=function(){const o=d.apply(this,arguments);return r(o,"mozAutoGainControl","autoGainControl"),r(o,"mozNoiseSuppression","noiseSuppression"),o}}if(i&&i.prototype.applyConstraints){const d=i.prototype.applyConstraints;i.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),r(o,"autoGainControl","mozAutoGainControl"),r(o,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[o])}}}}function phe(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function Xj(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function a2(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const a=t.RTCPeerConnection.prototype[r],d={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=d[r]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[a,d,o]=arguments;return i.apply(this,[a||null]).then(f=>{if(e.version<53&&!d)try{f.forEach(g=>{g.type=n[g.type]||g.type})}catch(g){if(g.name!=="TypeError")throw g;f.forEach((_,w)=>{f.set(w,Object.assign({},_,{type:n[_.type]||_.type}))})}return f}).then(d,o)}}function Kj(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(a=>a._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Yj(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i}),Uh(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Jj(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){KA("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&n.getTracks().includes(i.track)&&this.removeTrack(i)})})}function Qj(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function eV(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const r=i.length>0;r&&i.forEach(d=>{if("rid"in d&&!/^[a-z0-9]{0,16}$/i.test(d.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in d&&!(parseFloat(d.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in d&&!(parseFloat(d.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(r){const{sender:d}=a,o=d.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=i,d.sendEncodings=i,this.setParametersPromises.push(d.setParameters(o).then(()=>{delete d.sendEncodings}).catch(()=>{delete d.sendEncodings})))}return a})}function tV(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function nV(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function iV(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const rB=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:eV,shimCreateAnswer:iV,shimCreateOffer:nV,shimGetDisplayMedia:phe,shimGetParameters:tV,shimGetUserMedia:Zj,shimOnTrack:Xj,shimPeerConnection:a2,shimRTCDataChannel:Qj,shimReceiverGetStats:Yj,shimRemoveStream:Jj,shimSenderGetStats:Kj},Symbol.toStringTag,{value:"Module"}));function rV(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(r=>e.call(this,r,i)),i.getVideoTracks().forEach(r=>e.call(this,r,i))},t.RTCPeerConnection.prototype.addTrack=function(i,...r){return r&&r.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(n);if(i===-1)return;this._localStreams.splice(i,1);const r=n.getTracks();this.getSenders().forEach(a=>{r.includes(a.track)&&this.removeTrack(a)})})}}function oV(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(r=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(r))return;this._remoteStreams.push(r);const a=new Event("addstream");a.stream=r,this.dispatchEvent(a)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(a=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(a)>=0)return;i._remoteStreams.push(a);const d=new Event("addstream");d.stream=a,i.dispatchEvent(d)})}),e.apply(i,arguments)}}}function sV(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,a=e.setRemoteDescription,d=e.addIceCandidate;e.createOffer=function(g,_){const w=arguments.length>=2?arguments[2]:arguments[0],T=n.apply(this,[w]);return _?(T.then(g,_),Promise.resolve()):T},e.createAnswer=function(g,_){const w=arguments.length>=2?arguments[2]:arguments[0],T=i.apply(this,[w]);return _?(T.then(g,_),Promise.resolve()):T};let o=function(f,g,_){const w=r.apply(this,[f]);return _?(w.then(g,_),Promise.resolve()):w};e.setLocalDescription=o,o=function(f,g,_){const w=a.apply(this,[f]);return _?(w.then(g,_),Promise.resolve()):w},e.setRemoteDescription=o,o=function(f,g,_){const w=d.apply(this,[f]);return _?(w.then(g,_),Promise.resolve()):w},e.addIceCandidate=o}function aV(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=r=>i(lV(r))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,r,a){e.mediaDevices.getUserMedia(i).then(r,a)}).bind(e))}function lV(t){return t&&t.video!==void 0?Object.assign({},t,{video:Fj(t.video)}):t}function cV(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,r){if(i&&i.iceServers){const a=[];for(let d=0;d<i.iceServers.length;d++){let o=i.iceServers[d];o.urls===void 0&&o.url?(KA("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,a.push(o)):a.push(i.iceServers[d])}i.iceServers=a}return new e(i,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function uV(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function dV(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const r=this.getTransceivers().find(d=>d.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):i.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const a=this.getTransceivers().find(d=>d.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):i.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function hV(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const oB=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:hV,shimCallbacksAPI:sV,shimConstraints:lV,shimCreateOfferLegacy:dV,shimGetUserMedia:aV,shimLocalStreamsAPI:rV,shimRTCIceServerUrls:cV,shimRemoteStreamsAPI:oV,shimTrackEventTransceiver:uV},Symbol.toStringTag,{value:"Module"}));var fV={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,a)=>(a>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const i=e.splitSections(n);return i&&i[0]},e.getMediaSections=function(n){const i=e.splitSections(n);return i.shift(),i},e.matchPrefix=function(n,i){return e.splitLines(n).filter(r=>r.indexOf(i)===0)},e.parseCandidate=function(n){let i;n.indexOf("a=candidate:")===0?i=n.substring(12).split(" "):i=n.substring(10).split(" ");const r={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let a=8;a<i.length;a+=2)switch(i[a]){case"raddr":r.relatedAddress=i[a+1];break;case"rport":r.relatedPort=parseInt(i[a+1],10);break;case"tcptype":r.tcpType=i[a+1];break;case"ufrag":r.ufrag=i[a+1],r.usernameFragment=i[a+1];break;default:r[i[a]]===void 0&&(r[i[a]]=i[a+1]);break}return r},e.writeCandidate=function(n){const i=[];i.push(n.foundation);const r=n.component;r==="rtp"?i.push(1):r==="rtcp"?i.push(2):i.push(r),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const a=n.type;return i.push("typ"),i.push(a),a!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let i=n.substring(9).split(" ");const r={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),r.name=i[0],r.clockRate=parseInt(i[1],10),r.channels=i.length===3?parseInt(i[2],10):1,r.numChannels=r.channels,r},e.writeRtpMap=function(n){let i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);const r=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(r!==1?"/"+r:"")+`\r
`},e.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const i={};let r;const a=n.substring(n.indexOf(" ")+1).split(";");for(let d=0;d<a.length;d++)r=a[d].trim().split("="),i[r[0].trim()]=r[1];return i},e.writeFmtp=function(n){let i="",r=n.payloadType;if(n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const a=[];Object.keys(n.parameters).forEach(d=>{n.parameters[d]!==void 0?a.push(d+"="+n.parameters[d]):a.push(d)}),i+="a=fmtp:"+r+" "+a.join(";")+`\r
`}return i},e.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(n){let i="",r=n.payloadType;return n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(a=>{i+="a=rtcp-fb:"+r+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(n){const i=n.indexOf(" "),r={ssrc:parseInt(n.substring(7,i),10)},a=n.indexOf(":",i);return a>-1?(r.attribute=n.substring(i+1,a),r.value=n.substring(a+1)):r.attribute=n.substring(i+1),r},e.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(r=>parseInt(r,10))}},e.getMid=function(n){const i=e.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:e.matchPrefix(n+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,i){let r="a=setup:"+i+`\r
`;return n.fingerprints.forEach(a=>{r+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),r},e.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,i){return e.matchPrefix(n+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,i){const r=e.matchPrefix(n+i,"a=ice-ufrag:")[0],a=e.matchPrefix(n+i,"a=ice-pwd:")[0];return r&&a?{usernameFragment:r.substring(12),password:a.substring(10)}:null},e.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(n)[0].split(" ");i.profile=a[2];for(let o=3;o<a.length;o++){const f=a[o],g=e.matchPrefix(n,"a=rtpmap:"+f+" ")[0];if(g){const _=e.parseRtpMap(g),w=e.matchPrefix(n,"a=fmtp:"+f+" ");switch(_.parameters=w.length?e.parseFmtp(w[0]):{},_.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+f+" ").map(e.parseRtcpFb),i.codecs.push(_),_.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(_.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(o=>{i.headerExtensions.push(e.parseExtmap(o))});const d=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(o=>{d.forEach(f=>{o.rtcpFeedback.find(_=>_.type===f.type&&_.parameter===f.parameter)||o.rtcpFeedback.push(f)})}),i},e.writeRtpDescription=function(n,i){let r="";r+="m="+n+" ",r+=i.codecs.length>0?"9":"0",r+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=i.codecs.map(d=>d.preferredPayloadType!==void 0?d.preferredPayloadType:d.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(d=>{r+=e.writeRtpMap(d),r+=e.writeFmtp(d),r+=e.writeRtcpFb(d)});let a=0;return i.codecs.forEach(d=>{d.maxptime>a&&(a=d.maxptime)}),a>0&&(r+="a=maxptime:"+a+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(d=>{r+=e.writeExtmap(d)}),r},e.parseRtpEncodingParameters=function(n){const i=[],r=e.parseRtpParameters(n),a=r.fecMechanisms.indexOf("RED")!==-1,d=r.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(n,"a=ssrc:").map(T=>e.parseSsrcMedia(T)).filter(T=>T.attribute==="cname"),f=o.length>0&&o[0].ssrc;let g;const _=e.matchPrefix(n,"a=ssrc-group:FID").map(T=>T.substring(17).split(" ").map(D=>parseInt(D,10)));_.length>0&&_[0].length>1&&_[0][0]===f&&(g=_[0][1]),r.codecs.forEach(T=>{if(T.name.toUpperCase()==="RTX"&&T.parameters.apt){let A={ssrc:f,codecPayloadType:parseInt(T.parameters.apt,10)};f&&g&&(A.rtx={ssrc:g}),i.push(A),a&&(A=JSON.parse(JSON.stringify(A)),A.fec={ssrc:f,mechanism:d?"red+ulpfec":"red"},i.push(A))}}),i.length===0&&f&&i.push({ssrc:f});let w=e.matchPrefix(n,"b=");return w.length&&(w[0].indexOf("b=TIAS:")===0?w=parseInt(w[0].substring(7),10):w[0].indexOf("b=AS:")===0?w=parseInt(w[0].substring(5),10)*1e3*.95-50*40*8:w=void 0,i.forEach(T=>{T.maxBitrate=w})),i},e.parseRtcpParameters=function(n){const i={},r=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];r&&(i.cname=r.value,i.ssrc=r.ssrc);const a=e.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=a.length>0,i.compound=a.length===0;const d=e.matchPrefix(n,"a=rtcp-mux");return i.mux=d.length>0,i},e.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+=`a=rtcp-rsize\r
`),n.mux&&(i+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),i},e.parseMsid=function(n){let i;const r=e.matchPrefix(n,"a=msid:");if(r.length===1)return i=r[0].substring(7).split(" "),{stream:i[0],track:i[1]};const a=e.matchPrefix(n,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="msid");if(a.length>0)return i=a[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(n){const i=e.parseMLine(n),r=e.matchPrefix(n,"a=max-message-size:");let a;r.length>0&&(a=parseInt(r[0].substring(19),10)),isNaN(a)&&(a=65536);const d=e.matchPrefix(n,"a=sctp-port:");if(d.length>0)return{port:parseInt(d[0].substring(12),10),protocol:i.fmt,maxMessageSize:a};const o=e.matchPrefix(n,"a=sctpmap:");if(o.length>0){const f=o[0].substring(10).split(" ");return{port:parseInt(f[0],10),protocol:f[1],maxMessageSize:a}}},e.writeSctpDescription=function(n,i){let r=[];return n.protocol!=="DTLS/SCTP"?r=["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:r=["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&r.push("a=max-message-size:"+i.maxMessageSize+`\r
`),r.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,i,r){let a;const d=i!==void 0?i:2;return n?a=n:a=e.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+a+" "+d+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,i){const r=e.splitLines(n);for(let a=0;a<r.length;a++)switch(r[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[a].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const i=e.splitLines(n);for(let r=0;r<i.length;r++)if(i[r].length<2||i[r].charAt(1)!=="=")return!1;return!0},t.exports=e})(fV);var pV=fV.exports;const jp=_c(pV),mhe=q8({__proto__:null,default:jp},[pV]);function P_(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const r=new e(i),a=jp.parseCandidate(i.candidate);for(const d in a)d in r||Object.defineProperty(r,d,{value:a[d]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,Uh(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function l2(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Uh(t,"icecandidate",e=>{if(e.candidate){const n=jp.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function O_(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(o){if(!o||!o.sdp)return!1;const f=jp.splitSections(o.sdp);return f.shift(),f.some(g=>{const _=jp.parseMLine(g);return _&&_.kind==="application"&&_.protocol.indexOf("SCTP")!==-1})},i=function(o){const f=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const g=parseInt(f[1],10);return g!==g?-1:g},r=function(o){let f=65536;return e.browser==="firefox"&&(e.version<57?o===-1?f=16384:f=2147483637:e.version<60?f=e.version===57?65535:65536:f=2147483637),f},a=function(o,f){let g=65536;e.browser==="firefox"&&e.version===57&&(g=65535);const _=jp.matchPrefix(o.sdp,"a=max-message-size:");return _.length>0?g=parseInt(_[0].substring(19),10):e.browser==="firefox"&&f!==-1&&(g=2147483637),g},d=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const f=i(arguments[0]),g=r(f),_=a(arguments[0],f);let w;g===0&&_===0?w=Number.POSITIVE_INFINITY:g===0||_===0?w=Math.max(g,_):w=Math.min(g,_);const T={};Object.defineProperty(T,"maxMessageSize",{get(){return w}}),this._sctp=T}return d.apply(this,arguments)}}function D_(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,r){const a=i.send;i.send=function(){const o=arguments[0],f=o.length||o.size||o.byteLength;if(i.readyState==="open"&&r.sctp&&f>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return a.apply(i,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},Uh(t,"datachannel",i=>(e(i.channel,i.target),i))}function c2(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const a=r.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const d=new Event("connectionstatechange",r);a.dispatchEvent(d)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function u2(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=r.sdp.split(`
`).filter(d=>d.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:a}):r.sdp=a}return n.apply(this,arguments)}}function R_(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function L_(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(d=>n.apply(this,[d]))})}const ghe=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:u2,shimAddIceCandidateNullOrEmpty:R_,shimConnectionState:c2,shimMaxMessageSize:O_,shimParameterlessSetLocalDescription:L_,shimRTCIceCandidate:P_,shimRTCIceCandidateRelayProtocol:l2,shimSendThrowTypeError:D_},Symbol.toStringTag,{value:"Module"}));function yhe({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=Bj,i=hhe(t),r={browserDetails:i,commonShim:ghe,extractVersion:M_,disableLog:uhe,disableWarnings:dhe,sdp:mhe};switch(i.browser){case"chrome":if(!iB||!s2||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=iB,R_(t,i),L_(t),Nj(t,i),$j(t),s2(t,i),jj(t),Gj(t,i),Vj(t),Uj(t),qj(t),Hj(t,i),P_(t),l2(t),c2(t),O_(t,i),D_(t),u2(t,i);break;case"firefox":if(!rB||!a2||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=rB,R_(t,i),L_(t),Zj(t,i),a2(t,i),Xj(t),Jj(t),Kj(t),Yj(t),Qj(t),eV(t),tV(t),nV(t),iV(t),P_(t),c2(t),O_(t,i),D_(t);break;case"safari":if(!oB||!e.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=oB,R_(t,i),L_(t),cV(t),dV(t),sV(t),rV(t),oV(t),uV(t),aV(t),hV(t),P_(t),l2(t),O_(t,i),D_(t),u2(t,i);break;default:n("Unsupported browser!");break}return r}const vhe=yhe({window:typeof window>"u"?void 0:window});let yl=null,bn=null,bhe="videoroomtest-"+W.randomString(12),qd=null,Qb=null,Qc=null,Wd=null,sB=null,fs=null,gy={},Mi={},aB={},Hf={},Bk={},Ps={},yy={},e_={},Zf=[],Fk={},Nk={},_he=!1,lB="h264",xhe=!1,$k=!1;const whe=()=>{ji();const t=ei(Ws),[e,n]=et.useState(!1),[i,r]=et.useState(null),[a,d]=et.useState(null),[o,f]=et.useState({}),g=Z$();et.useEffect(()=>{if(!(t!=null&&t.id))return;W.init({debug:!0,dependencies:W.useDefaultDependencies({adapter:vhe}),callback:()=>{W.log("Janus initialized")}}),yl=new W({server:"wss://viaweaver.com:8989",apisecret:"jamnrocks",success:()=>{W.log("Janus session connected")},error:N=>{W.error(N)},destroyed:()=>{n(N=>!N),console.log("Janus session destroyed")}});const V=()=>{g(null)};return window.addEventListener("beforeunload",V),()=>{window.removeEventListener("beforeunload",V),yl==null||yl.destroy({})}},[t==null?void 0:t.id]),et.useEffect(()=>{console.log(t==null?void 0:t.activeChannelId,i,a),i==="connected"||a==="connected"?(t==null?void 0:t.activeChannelId)===null&&G():i!=="connected"&&a!=="connected"&&t!=null&&t.activeChannelId&&_(t.activeChannelId,t.id,t.name)},[t==null?void 0:t.activeChannelId,i,a]),et.useEffect(()=>{const V={request:"configure",audio:t==null?void 0:t.isMicOn,video:t==null?void 0:t.isCamOn};bn==null||bn.send({message:V,success:N=>{W.log("Reconfig success",N)},error:N=>{W.error("Reconfig error",N)}})},[t==null?void 0:t.isCamOn,t==null?void 0:t.isMicOn]);const _=(V,N,q)=>{if(!(t!=null&&t.id))return;qd=V,Qc=N,Qb=q;const K=()=>{let se={request:"join",id:Qc,room:qd,ptype:"publisher",display:Qb},ie={request:"exists",room:qd};bn==null||bn.send({message:ie,success:Q=>{if(W.log("Exists",Q),Q.exists)bn==null||bn.send({message:se,success:J=>{W.log("Register success",J)}});else{let J={request:"create",room:qd};J.videocodec=lB,J.h264_profile="42e01f",bn==null||bn.send({message:J,success:te=>{W.log("Create success",te),bn==null||bn.send({message:se,success:me=>{W.log("Register success",me)}})}})}},error:Q=>{W.error("Exists error",Q)}})};bn&&bn.hangup(),yl==null||yl.attach({plugin:"janus.plugin.videoroom",opaqueId:"videoroomtest",success:se=>{n(ie=>!ie),bn=se,W.log("Plugin attached! ("+bn.getPlugin()+", id="+bn.getId()+")"),W.log("  -- This is a publisher/manager"),K()},error:se=>{W.error("Janus plugin error",se)},consentDialog:se=>{W.debug("Consent dialog should be "+(se?"on":"off")+" now")},iceState:se=>{W.log("ICE state changed to",se)},mediaState:(se,ie,Q)=>{W.log("Janus "+(ie?"started":"stopped")+" receiving our "+se+" (mid="+Q+")"),se==="audio"?r(ie?"connected":"disconnected"):se==="video"&&d(ie?"connected":"disconnected")},webrtcState:se=>{W.log("Janus says our WebRTC PeerConnection is "+(se?"up":"down")+" now")},slowLink:(se,ie,Q)=>{W.warn("Janus reports problems "+(se?"sending":"receiving")+" packets on mid "+Q+" ("+ie+" lost packets)")},onmessage:(se,ie)=>{var J,te;n(me=>!me),W.debug(" ::: Got a message (publisher) :::",se);let Q=se.videoroom;if(W.debug("Event: "+Q),Q!=null&&Q!=null){if(Q==="joined"){if(Qc=se.id,sB=se.private_id,W.log("Successfully joined room "+se.room+" with ID "+Qc),w(t==null?void 0:t.isMicOn,t==null?void 0:t.isCamOn),se.publishers){let me=se.publishers;W.debug("Got a list of available publishers/feeds:",me);let Fe=null;for(let tt in me){if(me[tt].dummy)continue;let At=me[tt].id,_t=me[tt].display,xt=me[tt].streams;for(let ze in xt){let ot=xt[ze];ot.id=At,ot.display=_t}let lt=Mi[At]?(J=Mi[At])==null?void 0:J.slot:null,zt=Mi[At]?(te=Mi[At])==null?void 0:te.remoteVideos:0;Mi[At]={id:At,display:_t,streams:xt,slot:lt,remoteVideos:zt},W.debug("  >> ["+At+"] "+_t+":",xt),Fe||(Fe=[]),Fe.push(xt)}console.log("feedStreams",Mi),Fe&&D(Fe)}}else if(Q==="destroyed")W.warn("The room has been destroyed!"),g(null);else if(Q==="event")if(se.streams){let me=se.streams;for(let Fe in me){let tt=me[Fe];tt.id=Qc,tt.display=Qb}Mi[Qc]={id:Qc,display:Qb,streams:me},console.log("feedStreams",Mi)}else if(se.publishers){let me=se.publishers;W.debug("Got a list of available publishers/feeds:",me);let Fe=null;for(let tt in me){if(me[tt].dummy)continue;let At=me[tt].id,_t=me[tt].display,xt=me[tt].streams;for(let ze in xt){let ot=xt[ze];ot.id=At,ot.display=_t}let lt=Mi[At]?Mi[At].slot:null,zt=Mi[At]?Mi[At].remoteVideos:0;Mi[At]={id:At,display:_t,streams:xt,slot:lt,remoteVideos:zt},W.debug("  >> ["+At+"] "+_t+":",xt),Fe||(Fe=[]),Fe.push(xt)}Fe&&D(Fe)}else if(se.leaving){let me=se.leaving;W.log("Publisher left: "+me),z(me)}else if(se.unpublished){let me=se.unpublished;if(W.log("Publisher left: "+me),me==="ok"){bn==null||bn.hangup(),bn=null,qd=null;return}z(me)}else se.error&&(se.error_code===426?console.warn("No such room exists"):console.error(se.error))}if(ie){W.debug("Handling SDP as well...",ie),bn==null||bn.handleRemoteJsep({jsep:ie});let me=se.audio_codec;Wd&&Wd.getAudioTracks()&&Wd.getAudioTracks().length>0&&!me&&console.warn("Our audio stream has been rejected, viewers won't hear us");let Fe=se.video_codec;Wd&&Wd.getVideoTracks()&&Wd.getVideoTracks().length>0&&!Fe&&console.warn("Our video stream has been rejected, viewers won't see us")}},onlocaltrack:(se,ie)=>{n(te=>!te),W.debug(" ::: Got a local track event :::"),W.debug("Local track "+(ie?"added":"removed")+":",se);let Q=se.id;if(!ie){let te=yy[Q];if(te)try{let me=te.getTracks();for(let Fe in me){let tt=me[Fe];tt&&tt.stop()}}catch(me){console.warn(me)}se.kind,delete yy[Q],f(me=>{const Fe={...me};return delete Fe[t==null?void 0:t.id],Fe});return}if(!yy[Q]){if(se.kind!=="audio"){let te=new MediaStream([se]);yy[Q]=te,f(me=>{const Fe={...me};return Fe[t==null?void 0:t.id]={video:te},Fe}),W.log("Created local video stream:",te),W.log(te.getTracks()),W.log(te.getVideoTracks())}(bn==null?void 0:bn.webrtcStuff.pc.iceConnectionState)!=="completed"&&(bn==null?void 0:bn.webrtcStuff.pc.iceConnectionState)!=="connected"&&console.log("Publishing...")}},onremotetrack:(se,ie,Q)=>{},oncleanup:()=>{n(se=>!se),W.log(" ::: Got a cleanup notification; we are unpublished now :::"),Wd=null,delete Mi[Qc],yy={}}})},w=(V,N)=>{let q=[];V&&q.push({type:"audio",capture:!0,recv:!1}),q.push({type:"video",capture:!0,recv:!1,simulcast:_he,svc:void 0}),bn==null||bn.createOffer({tracks:q,success:K=>{W.debug("Got publisher SDP!"),W.debug(K);let se={request:"configure",audio:V,video:N};se.videocodec=lB,bn==null||bn.send({message:se,jsep:K})},error:function(K){W.error("WebRTC error:",K),V?w(!1,!0):console.warn("WebRTC error... "+K.message)}})};function T(){let V=bn==null?void 0:bn.isAudioMuted();W.log((V?"Unmuting":"Muting")+" local stream..."),V?bn==null||bn.unmuteAudio():bn==null||bn.muteAudio()}const A=()=>{let V={request:"unpublish"};bn==null||bn.send({message:V})},D=V=>{if($k){setTimeout(()=>{D(V)},500);return}if(fs){let N=null,q=null;console.log("sources1",V);for(let se in V){let ie=V[se];for(let Q in ie){let J=ie[Q];if(J.type==="video"&&W.webRTCAdapter.browserDetails.browser==="safari"&&J.codec==="vp8"&&W.safariVp8){console.warn("Publisher is using VP8 and Safari does not support it, disabling video");continue}if(J.disabled){W.log("Disabled stream:",J),q||(q=[]),q.push({feed:J.id,mid:J}),delete Ps[J.id][J.mid];continue}if(Ps[J.id]&&Ps[J.id][J.mid]){W.log("Already subscribed to stream:",J);continue}if(!Mi[J.id].slot){let te;for(let me=1;me<=6;me++)if(!gy[me]){te=me,gy[te]=J.id,Mi[J.id].slot=te,Mi[J.id].remoteVideos=0;break}}N||(N=[]),N.push({feed:J.id,mid:J.mid}),Ps[J.id]||(Ps[J.id]={}),Ps[J.id][J.mid]=!0}}if((!N||N.length===0)&&(!q||q.length===0))return;let K={request:"update"};N&&(K.subscribe=N),q&&(K.unsubscribe=q),fs.send({message:K});return}$k=!0,yl==null||yl.attach({plugin:"janus.plugin.videoroom",opaqueId:bhe,success:N=>{fs=N,e_={},W.log("Plugin attached! ("+fs.getPlugin()+", id="+fs.getId()+")"),W.log("  -- This is a multistream subscriber");let q=[];console.log("sources",V);for(let se in V){let ie=V[se];console.log("streams",ie);for(let Q in ie){let J=ie[Q];if(J.type==="video"&&W.webRTCAdapter.browserDetails.browser==="safari"&&J.codec==="vp8"&&W.safariVp8){console.warn("Publisher is using VP8 and Safari does not support it, disabling video");continue}if(J.disabled){W.log("Disabled stream:",J);continue}if(W.log("Subscribed to "+J.id+"/"+J.mid+"?",Ps),Ps[J.id]&&Ps[J.id][J.mid]){W.log("Already subscribed to stream, skipping: ",J);continue}if(!Mi[J.id].slot){let te;for(let me=1;me<=6;me++)if(!gy[me]){te=me,gy[te]=J.id,Mi[J.id].slot=te,Mi[J.id].remoteVideos=0;break}}q.push({feed:J.id,mid:J.mid}),Ps[J.id]||(Ps[J.id]={}),Ps[J.id][J.mid]=!0}}let K={request:"join",room:qd,ptype:"subscriber",streams:q,use_msid:xhe,private_id:sB};fs.send({message:K})},error:N=>{W.error("  -- Error attaching plugin...",N)},iceState:N=>{W.log("ICE state (remote feed) changed to "+N)},webrtcState:N=>{W.log("Janus says this WebRTC PeerConnection (remote feed) is "+(N?"up":"down")+" now")},slowLink:(N,q,K)=>{W.warn("Janus reports problems "+(N?"sending":"receiving")+" packets on mid "+K+" ("+q+" lost packets)")},onmessage:(N,q)=>{n(se=>!se),W.debug(" ::: Got a message (subscriber) :::",N);let K=N.videoroom;if(W.debug("Event: "+K),N.error)console.warn(N.error);else if(K){if(K==="attached")$k=!1,W.log("Successfully attached to feed in room "+N.room);else if(K==="event"){let se=N.mid,ie=N.substream,Q=N.temporal;if(ie!=null||Q!=null){let te=Hf[se];Fk[te]||(Fk[te]=!0)}let J=N.spatial_layer;if(Q=N.temporal_layer,J!=null||Q!=null){let te=Hf[se];Nk[te]||(Nk[te]=!0)}}}if(N.streams)for(let se in N.streams){let ie=N.streams[se].mid;aB[ie]=N.streams[se];let Q=Mi[N.streams[se].feed_id];Q&&Q.slot&&(Hf[ie]=Q.slot,Bk[Q.slot]=ie)}q&&(W.debug("Handling SDP as well...",q),fs==null||fs.createAnswer({jsep:q,tracks:[{type:"data",capture:!0}],success:se=>{W.debug("Got SDP!"),W.debug(se);let ie={request:"start",room:qd};fs==null||fs.send({message:ie,jsep:se})},error:function(se){W.error("WebRTC error:",se)}}))},onlocaltrack:(N,q)=>{},onremotetrack:(N,q,K)=>{n(J=>!J),W.debug("Remote track (mid="+q+") "+(K?"added":"removed")+":",N);let se=aB[q],ie=Mi[se.feed_id];W.debug(" >> This track is coming from feed "+se.feed_id+":",ie);let Q=Hf[q];if(ie&&!Q&&(Q=ie.slot,Hf[q]=ie.slot,Bk[ie.slot]=q),W.debug(" >> mid "+q+" is in slot "+Q),!K){N.kind==="video"&&ie&&(ie.remoteVideos--,ie.remoteVideos),f(J=>{const te={...J};return te[se==null?void 0:se.feed_id]&&(delete te[se==null?void 0:se.feed_id][N==null?void 0:N.kind],Object.keys(te[se==null?void 0:se.feed_id]).length===0&&delete te[se==null?void 0:se.feed_id]),te}),delete e_[q],delete Hf[q],delete Bk[Q];return}if(ie.spinner&&(ie.spinner.stop(),ie.spinner=null),N.kind==="audio"){let J=new MediaStream([N]);e_[q]=J,f(te=>{const me={...te};return me[ie.id]={...me[ie.id],audio:J},me}),W.log("Created remote audio stream:",J),ie.remoteVideos}else{ie.remoteVideos++;let J=new MediaStream([N]);e_[q]=J,f(te=>{const me={...te};return me[ie.id]={...me[ie.id],video:J},me}),W.log("Created remote video stream:",J)}},oncleanup:()=>{n(N=>!N),W.log(" ::: Got a cleanup notification (remote feed) :::");for(let N=1;N<6;N++)Zf[N]&&clearInterval(Zf[N]),Zf[N]=null,Mi[N].simulcastStarted=!1,Mi[N].svcStarted=!1,Mi[N].remoteVideos=0;f(N=>t!=null&&t.id&&N[t.id]?{[t.id]:N[t.id]}:{})}})},z=V=>{let N=Mi[V];if(!N)return;W.debug("Feed "+V+" ("+N.display+") has left the room, detaching"),Zf[N.slot]&&clearInterval(Zf[N.slot]),Zf[N.slot]=null,delete Fk[N.slot],delete Nk[N.slot],delete gy[N.slot],delete Mi[V];let q={request:"unsubscribe",streams:[{feed:parseInt(V)}]};fs!=null&&fs.send({message:q}),delete Ps[V]},G=()=>{A();const V={request:"leave"};bn==null||bn.send({message:V}),Object.keys(Mi).forEach(N=>{z(N)})};return{refresh:e,streams:o,toggleMute:T,publishOwnFeed:w,unpublishOwnFeed:A,joinRoom:_,subscribeTo:D,unsubscribeFrom:z,disconnect:G}},She=ti`
  mutation CreateChannel($lng: Float!, $lat: Float!, $name: String!, $url: String!, $desc: String!) {
    createChannel(lng: $lng, lat: $lat, name: $name, url: $url, desc: $desc) {
      channel {
        ...ChannelFields
      }
      membership {
        ...MembershipFields
      }
    }
  }
  ${Ku}
  ${Em}
`,Ehe=(t,e)=>{const n=bm(),i=ji(),{setShouldUpdateMapData:r,newChannelLngLat:a}=et.useContext(zl),[d]=Ir(She,{onError:f=>{console.log(f),t(f)},onCompleted:f=>{console.log(f),i(Hu([f.createChannel.channel])),i($h([f.createChannel.membership])),n.push("/channel/"+f.createChannel.membership.channelId+"/talk"),r(!0),e()}});return(f,g,_)=>{if(!a)return;const{lng:w,lat:T}=a;d({variables:{lng:w,lat:T,name:f,url:g,desc:_}})}},khe=()=>{const[t,e]=et.useState(""),[n,i]=et.useState(""),[r,a]=et.useState(!1),[d,o]=et.useState(""),[f,g]=et.useState(""),_=Ehe(N=>{N.message==="URL already in use"?g("URL already in use"):g("Error creating channel")},()=>{e(""),i(""),o("")}),w=N=>N.toLowerCase().replace(/\s/g,"-").replace(/[^a-zA-Z0-9-]/g,"").slice(0,40);return Ae(hc,{children:Qt("div",{style:{marginTop:50,height:"calc(100% - 50px)",backgroundColor:"var(--ion-color-light)",display:"flex",flexDirection:"column",justifyContent:"stretch"},children:[Qt(rr,{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[Ae(Rn,{routerLink:"/map",style:{margin:20,border:"1px solid",borderRadius:5},children:"BACK"}),Ae(Rn,{onClick:()=>{!t||!n||_(t,n,d)},disabled:!t||!n,style:{margin:20,border:"1px solid",borderRadius:5,fontWeight:"bold",backgroundColor:"var(--ion-color-primary)",color:"var(--ion-color-light)"},children:"CREATE"})]}),Qt(lh,{style:{position:"relative",marginTop:0},children:[Ae(wl,{autofocus:!0,clearInput:!0,value:t,onIonInput:N=>{e(N.target.value),g("")},onIonBlur:()=>{r||i(w(t))},style:{margin:10,fontSize:32,fontWeight:"bold",width:"calc(100% - 20px)"},placeholder:"NAME"}),Ae(wl,{clearInput:!0,value:n,onIonChange:N=>console.log(N.target.value),onIonInput:N=>{N.target.value!==n&&a(!0),i(w(N.target.value)),g("")},onIonBlur:()=>{n||(i(w(t)),a(!1))},style:{margin:10,fontSize:20,width:"calc(100% - 20px)"},placeholder:"URL"}),Ae(wl,{clearInput:!0,value:d,onIonInput:N=>{o(N.target.value),g("")},style:{margin:10,fontSize:20,width:"calc(100% - 20px)"},placeholder:"DESCRIPTION"})]}),Ae("div",{style:{margin:15,color:"red"},children:f})]})})},The=ti`
  mutation GetMemberships {
    getMemberships {
      ...MembershipFields
      channel {
        ...ChannelFields
      }
    }
  }
  ${Em}
  ${Ku}
`,Che=t=>{const e=ji(),[n]=Ir(The,{onError:r=>{console.log(r)},onCompleted:r=>{console.log(r),e($h(r.getMemberships)),t(!0)}});return()=>{n()}},Ihe=ti`
  subscription MembershipUpdated($channelIds: [Int!]!) {
    membershipUpdated(channelIds: $channelIds) {
      ...MembershipFields
      user {
        id
        name
        email
      }
    }
  }
  ${Em}
`;function Ahe(t){const e=ji();SA(Ihe,{variables:{channelIds:t},shouldResubscribe:!0,onData:({data:{data:{membershipUpdated:n}}})=>{console.log(n),e($h([n]))}})}const Mhe=ti`
  mutation JoinChannel($channelId: Int!) {
    joinChannel(channelId: $channelId) {
      ...ChannelFields
      memberships {
        ...MembershipFields
        user {
          id
          name
        }
      }
    }
  }
  ${Ku}
  ${Em}
`,Phe=()=>{const t=ji(),[e]=Ir(Mhe,{onError:i=>{console.log(i)},onCompleted:i=>{console.log(i),t(Hu([i.joinChannel]))}});return i=>{e({variables:{channelId:i}})}},Ohe=ti`
  subscription ChannelUpdated($minLat: Float!, $maxLat: Float!, $minLng: Float!, $maxLng: Float!) {
    channelUpdated(minLat: $minLat, maxLat: $maxLat, minLng: $minLng, maxLng: $maxLng) {
      ...ChannelFields
    }
  }
  ${Ku}
`;function Dhe(t,e,n,i,r){const a=ji();SA(Ohe,{variables:{minLat:e,maxLat:n,minLng:i,maxLng:r},shouldResubscribe:!0,onData:({data:{data:{channelUpdated:d}}})=>{console.log(d),a(Hu([d])),t(!0)}})}const Rhe=ti`
  subscription PostUpdated($channelIds: [Int!]!) {
    postUpdated(channelIds: $channelIds) {
      ...PostFields
      user {
        id
        name
        email
      }
    }
  }
  ${EA}
`;function Lhe(t){const e=ji();SA(Rhe,{variables:{channelIds:t},shouldResubscribe:!0,onData:({data:{data:{postUpdated:n}}})=>{console.log(n),e($1([n]))}})}AJ();const zl=et.createContext({}),zhe=()=>{var T,A;const t=ei(Ws),e=ei(Zu),[n,i]=et.useState(!1),[r,a]=et.useState(null),[d,o]=et.useState("talk"),{streams:f}=whe(),g=et.useRef(null),_=Che(i),w=Phe();return et.useEffect(()=>{t!=null&&t.id&&_()},[t==null?void 0:t.id]),et.useEffect(()=>{e!=null&&e.id&&w(e.id)},[e==null?void 0:e.id]),Dhe(i,-90,90,-180,180),Ahe([(T=e==null?void 0:e.id)!=null?T:-1]),Lhe([(A=e==null?void 0:e.id)!=null?A:-1]),Ae(pJ,{children:Ae(zl.Provider,{value:{authModal:g,streams:f,shouldUpdateMapData:n,setShouldUpdateMapData:i,newChannelLngLat:r,setNewChannelLngLat:a,channelMode:d,setChannelMode:o},children:Qt($J,{children:[Ae(xde,{}),Ae(Yde,{}),Ae(nhe,{}),Qt(TJ,{children:[Qt(KT,{children:[Ae(tc,{exact:!0,path:"/channel/:id",component:che}),Ae(tc,{exact:!0,path:"/create-channel",component:khe}),Ae(tc,{exact:!0,path:"/create-deal",component:ahe}),Ae(tc,{exact:!0,path:"/deal/:id",component:pde}),Ae(tc,{exact:!0,path:"/trade",component:Nue}),Ae(tc,{path:"/map",component:zue}),Ae(tc,{exact:!0,path:"/meme",component:rQ}),Ae(tc,{exact:!0,path:"/",children:Ae(g7,{to:"/map"})})]}),Qt(YT,{slot:"bottom",children:[Qt(Pp,{tab:"meme",href:"/meme",children:[Ae(yr,{"aria-hidden":"true",icon:QJ}),Ae(hu,{children:"MEME"})]}),Qt(Pp,{tab:"map",href:"/map",children:[Ae(yr,{"aria-hidden":"true",icon:qJ}),Ae(hu,{children:"MAP"})]}),Qt(Pp,{tab:"trade",href:"/trade",children:[Ae(yr,{"aria-hidden":"true",icon:YJ}),Ae(hu,{children:"TRADE"})]})]})]})]})})})};function Bhe(t){return new Xu(function(e,n){var i=or(e,[]);return new Bi(function(r){var a,d=!1;return Promise.resolve(i).then(function(o){return t(o,e.getContext())}).then(e.setContext).then(function(){d||(a=n(e).subscribe({next:r.next.bind(r),error:r.error.bind(r),complete:r.complete.bind(r)}))}).catch(r.error.bind(r)),function(){d=!0,a&&a.unsubscribe()}})})}function Fhe(t){return $i(t)&&"code"in t&&"reason"in t}function Nhe(t){var e;return $i(t)&&((e=t.target)===null||e===void 0?void 0:e.readyState)===WebSocket.CLOSED}var $he=function(t){ma(e,t);function e(n){var i=t.call(this)||this;return i.client=n,i}return e.prototype.request=function(n){var i=this;return new Bi(function(r){return i.client.subscribe(rt(rt({},n),{query:r$(n.query)}),{next:r.next.bind(r),complete:r.complete.bind(r),error:function(a){if(a instanceof Error)return r.error(a);var d=Fhe(a);return d||Nhe(a)?r.error(new Error("Socket closed".concat(d?" with event ".concat(a.code):"").concat(d?" ".concat(a.reason):""))):r.error(new au({graphQLErrors:Array.isArray(a)?a:[a]}))}})})},e}(Xu);function ps(t){return t===null?"null":Array.isArray(t)?"array":typeof t}function Xd(t){return ps(t)==="object"}function jhe(t){return Array.isArray(t)&&t.length>0&&t.every(e=>"message"in e)}function cB(t,e){return t.length<124?t:e}const Vhe="graphql-transport-ws";var Os;(function(t){t[t.InternalServerError=4500]="InternalServerError",t[t.InternalClientError=4005]="InternalClientError",t[t.BadRequest=4400]="BadRequest",t[t.BadResponse=4004]="BadResponse",t[t.Unauthorized=4401]="Unauthorized",t[t.Forbidden=4403]="Forbidden",t[t.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",t[t.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",t[t.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",t[t.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",t[t.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"})(Os||(Os={}));var Pr;(function(t){t.ConnectionInit="connection_init",t.ConnectionAck="connection_ack",t.Ping="ping",t.Pong="pong",t.Subscribe="subscribe",t.Next="next",t.Error="error",t.Complete="complete"})(Pr||(Pr={}));function mV(t){if(!Xd(t))throw new Error(`Message is expected to be an object, but got ${ps(t)}`);if(!t.type)throw new Error("Message is missing the 'type' property");if(typeof t.type!="string")throw new Error(`Message is expects the 'type' property to be a string, but got ${ps(t.type)}`);switch(t.type){case Pr.ConnectionInit:case Pr.ConnectionAck:case Pr.Ping:case Pr.Pong:{if(t.payload!=null&&!Xd(t.payload))throw new Error(`"${t.type}" message expects the 'payload' property to be an object or nullish or missing, but got "${t.payload}"`);break}case Pr.Subscribe:{if(typeof t.id!="string")throw new Error(`"${t.type}" message expects the 'id' property to be a string, but got ${ps(t.id)}`);if(!t.id)throw new Error(`"${t.type}" message requires a non-empty 'id' property`);if(!Xd(t.payload))throw new Error(`"${t.type}" message expects the 'payload' property to be an object, but got ${ps(t.payload)}`);if(typeof t.payload.query!="string")throw new Error(`"${t.type}" message payload expects the 'query' property to be a string, but got ${ps(t.payload.query)}`);if(t.payload.variables!=null&&!Xd(t.payload.variables))throw new Error(`"${t.type}" message payload expects the 'variables' property to be a an object or nullish or missing, but got ${ps(t.payload.variables)}`);if(t.payload.operationName!=null&&ps(t.payload.operationName)!=="string")throw new Error(`"${t.type}" message payload expects the 'operationName' property to be a string or nullish or missing, but got ${ps(t.payload.operationName)}`);if(t.payload.extensions!=null&&!Xd(t.payload.extensions))throw new Error(`"${t.type}" message payload expects the 'extensions' property to be a an object or nullish or missing, but got ${ps(t.payload.extensions)}`);break}case Pr.Next:{if(typeof t.id!="string")throw new Error(`"${t.type}" message expects the 'id' property to be a string, but got ${ps(t.id)}`);if(!t.id)throw new Error(`"${t.type}" message requires a non-empty 'id' property`);if(!Xd(t.payload))throw new Error(`"${t.type}" message expects the 'payload' property to be an object, but got ${ps(t.payload)}`);break}case Pr.Error:{if(typeof t.id!="string")throw new Error(`"${t.type}" message expects the 'id' property to be a string, but got ${ps(t.id)}`);if(!t.id)throw new Error(`"${t.type}" message requires a non-empty 'id' property`);if(!jhe(t.payload))throw new Error(`"${t.type}" message expects the 'payload' property to be an array of GraphQL errors, but got ${JSON.stringify(t.payload)}`);break}case Pr.Complete:{if(typeof t.id!="string")throw new Error(`"${t.type}" message expects the 'id' property to be a string, but got ${ps(t.id)}`);if(!t.id)throw new Error(`"${t.type}" message requires a non-empty 'id' property`);break}default:throw new Error(`Invalid message 'type' property "${t.type}"`)}return t}function Uhe(t,e){return mV(typeof t=="string"?JSON.parse(t,e):t)}function vy(t,e){return mV(t),JSON.stringify(t,e)}var Vp=globalThis&&globalThis.__await||function(t){return this instanceof Vp?(this.v=t,this):new Vp(t)},qhe=globalThis&&globalThis.__asyncGenerator||function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,a=[];return r={},d("next"),d("throw"),d("return"),r[Symbol.asyncIterator]=function(){return this},r;function d(T){i[T]&&(r[T]=function(A){return new Promise(function(D,z){a.push([T,A,D,z])>1||o(T,A)})})}function o(T,A){try{f(i[T](A))}catch(D){w(a[0][3],D)}}function f(T){T.value instanceof Vp?Promise.resolve(T.value.v).then(g,_):w(a[0][2],T)}function g(T){o("next",T)}function _(T){o("throw",T)}function w(T,A){T(A),a.shift(),a.length&&o(a[0][0],a[0][1])}};function Whe(t){const{url:e,connectionParams:n,lazy:i=!0,onNonLazyError:r=console.error,lazyCloseTimeout:a=0,keepAlive:d=0,disablePong:o,connectionAckWaitTimeout:f=0,retryAttempts:g=5,retryWait:_=async function(xt){let lt=1e3;for(let zt=0;zt<xt;zt++)lt*=2;await new Promise(zt=>setTimeout(zt,lt+Math.floor(Math.random()*(3e3-300)+300)))},shouldRetry:w=t_,isFatalConnectionProblem:T,on:A,webSocketImpl:D,generateID:z=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,xt=>{const lt=Math.random()*16|0;return(xt=="x"?lt:lt&3|8).toString(16)})},jsonMessageReplacer:G,jsonMessageReviver:V}=t;let N;if(D){if(!Hhe(D))throw new Error("Invalid WebSocket implementation provided");N=D}else typeof WebSocket<"u"?N=WebSocket:typeof global<"u"?N=global.WebSocket||global.MozWebSocket:typeof window<"u"&&(N=window.WebSocket||window.MozWebSocket);if(!N)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const q=N,K=(()=>{const _t=(()=>{const lt={};return{on(zt,ze){return lt[zt]=ze,()=>{delete lt[zt]}},emit(zt){var ze;"id"in zt&&((ze=lt[zt.id])===null||ze===void 0||ze.call(lt,zt))}}})(),xt={connecting:A!=null&&A.connecting?[A.connecting]:[],opened:A!=null&&A.opened?[A.opened]:[],connected:A!=null&&A.connected?[A.connected]:[],ping:A!=null&&A.ping?[A.ping]:[],pong:A!=null&&A.pong?[A.pong]:[],message:A!=null&&A.message?[_t.emit,A.message]:[_t.emit],closed:A!=null&&A.closed?[A.closed]:[],error:A!=null&&A.error?[A.error]:[]};return{onMessage:_t.on,on(lt,zt){const ze=xt[lt];return ze.push(zt),()=>{ze.splice(ze.indexOf(zt),1)}},emit(lt,...zt){for(const ze of[...xt[lt]])ze(...zt)}}})();function se(_t){const xt=[K.on("error",lt=>{xt.forEach(zt=>zt()),_t(lt)}),K.on("closed",lt=>{xt.forEach(zt=>zt()),_t(lt)})]}let ie,Q=0,J,te=!1,me=0,Fe=!1;async function tt(){clearTimeout(J);const[_t,xt]=await(ie!=null?ie:ie=new Promise((ze,ot)=>(async()=>{if(te){if(await _(me),!Q)return ie=void 0,ot({code:1e3,reason:"All Subscriptions Gone"});me++}K.emit("connecting");const Be=new q(typeof e=="function"?await e():e,Vhe);let ft,gt;function Nt(){isFinite(d)&&d>0&&(clearTimeout(gt),gt=setTimeout(()=>{Be.readyState===q.OPEN&&(Be.send(vy({type:Pr.Ping})),K.emit("ping",!1,void 0))},d))}se(Xt=>{ie=void 0,clearTimeout(ft),clearTimeout(gt),ot(Xt),t_(Xt)&&Xt.code===4499&&(Be.close(4499,"Terminated"),Be.onerror=null,Be.onclose=null)}),Be.onerror=Xt=>K.emit("error",Xt),Be.onclose=Xt=>K.emit("closed",Xt),Be.onopen=async()=>{try{K.emit("opened",Be);const Xt=typeof n=="function"?await n():n;if(Be.readyState!==q.OPEN)return;Be.send(vy(Xt?{type:Pr.ConnectionInit,payload:Xt}:{type:Pr.ConnectionInit},G)),isFinite(f)&&f>0&&(ft=setTimeout(()=>{Be.close(Os.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")},f)),Nt()}catch(Xt){K.emit("error",Xt),Be.close(Os.InternalClientError,cB(Xt instanceof Error?Xt.message:new Error(Xt).message,"Internal client error"))}};let en=!1;Be.onmessage=({data:Xt})=>{try{const wt=Uhe(Xt,V);if(K.emit("message",wt),wt.type==="ping"||wt.type==="pong"){K.emit(wt.type,!0,wt.payload),wt.type==="pong"?Nt():o||(Be.send(vy(wt.payload?{type:Pr.Pong,payload:wt.payload}:{type:Pr.Pong})),K.emit("pong",!1,wt.payload));return}if(en)return;if(wt.type!==Pr.ConnectionAck)throw new Error(`First message cannot be of type ${wt.type}`);clearTimeout(ft),en=!0,K.emit("connected",Be,wt.payload),te=!1,me=0,ze([Be,new Promise((Zt,Fn)=>se(Fn))])}catch(wt){Be.onmessage=null,K.emit("error",wt),Be.close(Os.BadResponse,cB(wt instanceof Error?wt.message:new Error(wt).message,"Bad response"))}}})()));_t.readyState===q.CLOSING&&await xt;let lt=()=>{};const zt=new Promise(ze=>lt=ze);return[_t,lt,Promise.race([zt.then(()=>{if(!Q){const ze=()=>_t.close(1e3,"Normal Closure");isFinite(a)&&a>0?J=setTimeout(()=>{_t.readyState===q.OPEN&&ze()},a):ze()}}),xt])]}function At(_t){if(t_(_t)&&(Ghe(_t.code)||[Os.InternalServerError,Os.InternalClientError,Os.BadRequest,Os.BadResponse,Os.Unauthorized,Os.SubprotocolNotAcceptable,Os.SubscriberAlreadyExists,Os.TooManyInitialisationRequests].includes(_t.code)))throw _t;if(Fe)return!1;if(t_(_t)&&_t.code===1e3)return Q>0;if(!g||me>=g||!w(_t)||T!=null&&T(_t))throw _t;return te=!0}return i||(async()=>{for(Q++;;)try{const[,,_t]=await tt();await _t}catch(_t){try{if(!At(_t))return}catch(xt){return r==null?void 0:r(xt)}}})(),{on:K.on,subscribe(_t,xt){const lt=z(_t);let zt=!1,ze=!1,ot=()=>{Q--,zt=!0};return(async()=>{for(Q++;;)try{const[Be,ft,gt]=await tt();if(zt)return ft();const Nt=K.onMessage(lt,en=>{switch(en.type){case Pr.Next:{xt.next(en.payload);return}case Pr.Error:{ze=!0,zt=!0,xt.error(en.payload),ot();return}case Pr.Complete:{zt=!0,ot();return}}});Be.send(vy({id:lt,type:Pr.Subscribe,payload:_t},G)),ot=()=>{!zt&&Be.readyState===q.OPEN&&Be.send(vy({id:lt,type:Pr.Complete},G)),Q--,zt=!0,ft()},await gt.finally(Nt);return}catch(Be){if(!At(Be))return}})().then(()=>{ze||xt.complete()}).catch(Be=>{xt.error(Be)}),()=>{zt||ot()}},iterate(_t){const xt=[],lt={done:!1,error:null,resolve:()=>{}},zt=this.subscribe(_t,{next(ot){xt.push(ot),lt.resolve()},error(ot){lt.done=!0,lt.error=ot,lt.resolve()},complete(){lt.done=!0,lt.resolve()}}),ze=function(){return qhe(this,arguments,function*(){for(;;){for(xt.length||(yield Vp(new Promise(ft=>lt.resolve=ft)));xt.length;)yield yield Vp(xt.shift());if(lt.error)throw lt.error;if(lt.done)return yield Vp(void 0)}})}();return ze.throw=async ot=>(lt.done||(lt.done=!0,lt.error=ot,lt.resolve()),{done:!0,value:void 0}),ze.return=async()=>(zt(),{done:!0,value:void 0}),ze},async dispose(){if(Fe=!0,ie){const[_t]=await ie;_t.close(1e3,"Normal Closure")}},terminate(){ie&&K.emit("closed",{code:4499,reason:"Terminated",wasClean:!1})}}}function t_(t){return Xd(t)&&"code"in t&&"reason"in t}function Ghe(t){return[1e3,1001,1006,1005,1012,1013,1013].includes(t)?!1:t>=1e3&&t<=1999}function Hhe(t){return typeof t=="function"&&"constructor"in t&&"CLOSED"in t&&"CLOSING"in t&&"CONNECTING"in t&&"OPEN"in t}window.EXCALIDRAW_ASSET_PATH="/excalidraw-assets";const Zhe=new $he(Whe({url:(ii("android")||ii("ios"))&&!ii("mobileweb")?`ws://${XA}/graphql`:window.location.origin.replace(/^http/,"ws")+"/graphql"})),Xhe=m$({uri:(ii("ios")||ii("android"))&&!ii("mobileweb")?`https://${XA}/graphql`:window.location.origin+"/graphql",credentials:(ii("ios")||ii("android"))&&!ii("mobileweb")?"include":"same-origin"}),Khe=Bhe(async(t,{headers:e})=>{const n=await js.get({key:Vh});return{headers:{...e,accesstoken:n.value}}}),Yhe=$ne(({query:t})=>{const e=Gv(t);return e.kind==="OperationDefinition"&&e.operation==="subscription"},Zhe,Khe.concat(Xhe)),d2=new pre({link:Yhe,cache:new lre}),Jhe=document.getElementById("root"),Qhe=sx(Jhe);Qhe.render(Ae(We.StrictMode,{children:Ae(OC,{client:d2,children:Ae(iC,{store:rC,children:Ae(zhe,{})})})}));export{i2 as C,J3 as E,RN as K,Oj as W,efe as __vite_legacy_guard,Eh as a,Sh as b,wI as c,g9 as d,y9 as e,KZ as f,UT as g,ro as h,CZ as i,kR as j,mfe as k,Di as l,ife as m,tfe as n,Q3 as o,nfe as p,zk as q,fv as r,pfe as s,Al as w};
